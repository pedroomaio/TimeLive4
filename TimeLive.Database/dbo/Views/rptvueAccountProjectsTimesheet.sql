
CREATE VIEW dbo.rptvueAccountProjectsTimesheet
AS
SELECT     dbo.rptvueAccountProjectsforReport.AccountProjectId, dbo.rptvueAccountProjectsforReport.AccountId, dbo.rptvueAccountProjectsforReport.AccountProjectTypeId, dbo.rptvueAccountProjectsforReport.AccountClientId, 
                      dbo.rptvueAccountProjectsforReport.ProjectBillingTypeId, dbo.rptvueAccountProjectsforReport.ProjectName, dbo.rptvueAccountProjectsforReport.ProjectDescription, dbo.rptvueAccountProjectsforReport.StartDate, 
                      dbo.rptvueAccountProjectsforReport.AccountMilestoneId, dbo.rptvueAccountProjectsforReport.Deadline, dbo.rptvueAccountProjectsforReport.LeaderEmployeeId, dbo.rptvueAccountProjectsforReport.ProjectManagerEmployeeId, 
                      dbo.rptvueAccountProjectsforReport.EstimatedTime, dbo.rptvueAccountProjectsforReport.EstimatedDurationUnit, dbo.rptvueAccountProjectsforReport.ProjectCode, dbo.rptvueAccountProjectsforReport.DefaultBillingRate, dbo.rptvueAccountProjectsforReport.IsActive, 
                      dbo.rptvueAccountProjectsforReport.ProjectStatusId, dbo.rptvueAccountProjectsforReport.AccountPriorityId, dbo.rptvueAccountProjectsforReport.CreatedOn, dbo.rptvueAccountProjectsforReport.CreatedByEmployeeId, 
                      dbo.rptvueAccountProjectsforReport.ModifiedOn, dbo.rptvueAccountProjectsforReport.ModifiedByEmployeeId, dbo.rptvueAccountProjectsforReport.ProjectBillingRateTypeId, dbo.rptvueAccountProjectsforReport.TimeSheetApprovalTypeId, 
                      dbo.rptvueAccountProjectsforReport.ExpenseApprovalTypeId, dbo.rptvueAccountProjectsforReport.IsDisabled, dbo.rptvueAccountProjectsforReport.IsTemplate, dbo.rptvueAccountProjectsforReport.IsProject, 
                      dbo.rptvueAccountProjectsforReport.AccountProjectTemplateId, dbo.rptvueAccountProjectsforReport.ClientNick, dbo.rptvueAccountProjectsforReport.ClientName, dbo.rptvueAccountProjectsforReport.ProjectType, dbo.rptvueAccountProjectsforReport.BillingType, 
                      dbo.rptvueAccountProjectsforReport.Status, dbo.rptvueAccountProjectsforReport.EstimatedDuration, dbo.rptvueAccountProjectsforReport.AccountClientContactId, dbo.rptvueAccountProjectsforReport.AccountClientDepartmentId, 
                      dbo.rptvueAccountProjectsforReport.ClientDepartmentCode, dbo.rptvueAccountProjectsforReport.ClientDepartmentName, dbo.rptvueAccountProjectsforReport.ClientDepartmentLocation, dbo.rptvueAccountProjectsforReport.ExpenseApprovalTypeName, 
                      dbo.rptvueAccountProjectsforReport.TimesheetApprovalTypeName, dbo.rptvueAccountProjectsforReport.ClientContactName, dbo.rptvueAccountProjectsforReport.TeamLead, dbo.rptvueAccountProjectsforReport.ProjectManager, 
                      dbo.rptvueAccountProjectsforReport.ProjectBillingRateType, dbo.rptvueAccountProjectsforReport.BillableTotalHours, dbo.rptvueAccountProjectsforReport.NonBillableTotalHours, dbo.rptvueAccountProjectsforReport.TotalEmployeeCost, 
                      dbo.rptvueAccountProjectsforReport.TotalTimeAmount, dbo.rptvueAccountProjectsforReport.TotalTaskEstimatedCost, dbo.rptvueAccountProjectsforReport.TotalBillableExpense, dbo.rptvueAccountProjectsforReport.TotalNonBillableExpense, 
                      dbo.rptvueAccountProjectsforReport.NetAmount, dbo.rptvueAccountProjectsforReport.TotalTaskEstimatedHours, dbo.rptvueAccountProjectsforReport.TotalHours, dbo.rptvueAccountProjectsforReport.BillableTimeAmount, 
                      dbo.rptvueAccountProjectsforReport.NonBillableTimeAmount, SUM(dbo.vueBillingTimesheet.TotalAmount) AS BilledTimeAmount, ISNULL(dbo.rptvueAccountProjectsforReport.NetAmounts, 0) AS CurrencyNetAmount, dbo.rptvueAccountProjectsforReport.CustomField1, 
                      dbo.rptvueAccountProjectsforReport.CustomField2, dbo.rptvueAccountProjectsforReport.CustomField3, dbo.rptvueAccountProjectsforReport.CustomField4, dbo.rptvueAccountProjectsforReport.CustomField5, 
                      dbo.rptvueAccountProjectsforReport.CustomField6, dbo.rptvueAccountProjectsforReport.CustomField7, dbo.rptvueAccountProjectsforReport.CustomField8, dbo.rptvueAccountProjectsforReport.CustomField9, 
                      dbo.rptvueAccountProjectsforReport.CustomField10, dbo.rptvueAccountProjectsforReport.CustomField11, dbo.rptvueAccountProjectsforReport.CustomField12, dbo.rptvueAccountProjectsforReport.CustomField13, 
                      dbo.rptvueAccountProjectsforReport.CustomField14, dbo.rptvueAccountProjectsforReport.CustomField15, dbo.rptvueAccountProjectsforReport.ProjectEstimatedCost
FROM         dbo.rptvueAccountProjectsforReport LEFT OUTER JOIN
                      dbo.vueBillingTimesheet ON dbo.rptvueAccountProjectsforReport.AccountProjectId = dbo.vueBillingTimesheet.AccountProjectId
GROUP BY dbo.rptvueAccountProjectsforReport.AccountProjectId, dbo.rptvueAccountProjectsforReport.AccountId, dbo.rptvueAccountProjectsforReport.AccountProjectTypeId, dbo.rptvueAccountProjectsforReport.AccountClientId, 
                      dbo.rptvueAccountProjectsforReport.ProjectBillingTypeId, dbo.rptvueAccountProjectsforReport.ProjectName, dbo.rptvueAccountProjectsforReport.ProjectDescription, dbo.rptvueAccountProjectsforReport.StartDate, 
                      dbo.rptvueAccountProjectsforReport.AccountMilestoneId, dbo.rptvueAccountProjectsforReport.Deadline, dbo.rptvueAccountProjectsforReport.LeaderEmployeeId, dbo.rptvueAccountProjectsforReport.ProjectManagerEmployeeId, 
                      dbo.rptvueAccountProjectsforReport.EstimatedTime, dbo.rptvueAccountProjectsforReport.EstimatedDurationUnit, dbo.rptvueAccountProjectsforReport.ProjectCode, dbo.rptvueAccountProjectsforReport.DefaultBillingRate, dbo.rptvueAccountProjectsforReport.IsActive, 
                      dbo.rptvueAccountProjectsforReport.ProjectStatusId, dbo.rptvueAccountProjectsforReport.AccountPriorityId, dbo.rptvueAccountProjectsforReport.CreatedOn, dbo.rptvueAccountProjectsforReport.CreatedByEmployeeId, 
                      dbo.rptvueAccountProjectsforReport.ModifiedOn, dbo.rptvueAccountProjectsforReport.ModifiedByEmployeeId, dbo.rptvueAccountProjectsforReport.ProjectBillingRateTypeId, dbo.rptvueAccountProjectsforReport.TimeSheetApprovalTypeId, 
                      dbo.rptvueAccountProjectsforReport.ExpenseApprovalTypeId, dbo.rptvueAccountProjectsforReport.IsDisabled, dbo.rptvueAccountProjectsforReport.IsTemplate, dbo.rptvueAccountProjectsforReport.IsProject, 
                      dbo.rptvueAccountProjectsforReport.AccountProjectTemplateId, dbo.rptvueAccountProjectsforReport.ClientNick, dbo.rptvueAccountProjectsforReport.ClientName, dbo.rptvueAccountProjectsforReport.ProjectType, dbo.rptvueAccountProjectsforReport.BillingType, 
                      dbo.rptvueAccountProjectsforReport.Status, dbo.rptvueAccountProjectsforReport.EstimatedDuration, dbo.rptvueAccountProjectsforReport.AccountClientContactId, dbo.rptvueAccountProjectsforReport.AccountClientDepartmentId, 
                      dbo.rptvueAccountProjectsforReport.ClientDepartmentCode, dbo.rptvueAccountProjectsforReport.ClientDepartmentName, dbo.rptvueAccountProjectsforReport.ClientDepartmentLocation, dbo.rptvueAccountProjectsforReport.ExpenseApprovalTypeName, 
                      dbo.rptvueAccountProjectsforReport.TimesheetApprovalTypeName, dbo.rptvueAccountProjectsforReport.ClientContactName, dbo.rptvueAccountProjectsforReport.TeamLead, dbo.rptvueAccountProjectsforReport.ProjectManager, 
                      dbo.rptvueAccountProjectsforReport.ProjectBillingRateType, dbo.rptvueAccountProjectsforReport.BillableTotalHours, dbo.rptvueAccountProjectsforReport.NonBillableTotalHours, dbo.rptvueAccountProjectsforReport.TotalEmployeeCost, 
                      dbo.rptvueAccountProjectsforReport.TotalTimeAmount, dbo.rptvueAccountProjectsforReport.TotalTaskEstimatedCost, dbo.rptvueAccountProjectsforReport.TotalBillableExpense, dbo.rptvueAccountProjectsforReport.TotalNonBillableExpense, 
                      dbo.rptvueAccountProjectsforReport.NetAmount, dbo.rptvueAccountProjectsforReport.TotalTaskEstimatedHours, dbo.rptvueAccountProjectsforReport.TotalHours, dbo.rptvueAccountProjectsforReport.BillableTimeAmount, 
                      dbo.rptvueAccountProjectsforReport.NonBillableTimeAmount, ISNULL(dbo.rptvueAccountProjectsforReport.NetAmounts, 0), 
                      dbo.rptvueAccountProjectsforReport.CustomField1, dbo.rptvueAccountProjectsforReport.CustomField2, dbo.rptvueAccountProjectsforReport.CustomField3, dbo.rptvueAccountProjectsforReport.CustomField4, 
                      dbo.rptvueAccountProjectsforReport.CustomField5, dbo.rptvueAccountProjectsforReport.CustomField6, dbo.rptvueAccountProjectsforReport.CustomField7, dbo.rptvueAccountProjectsforReport.CustomField8, 
                      dbo.rptvueAccountProjectsforReport.CustomField9, dbo.rptvueAccountProjectsforReport.CustomField10, dbo.rptvueAccountProjectsforReport.CustomField11, dbo.rptvueAccountProjectsforReport.CustomField12, 
                      dbo.rptvueAccountProjectsforReport.CustomField13, dbo.rptvueAccountProjectsforReport.CustomField14, dbo.rptvueAccountProjectsforReport.CustomField15, dbo.rptvueAccountProjectsforReport.ProjectEstimatedCost
--Start 3.2.1
-- Drop View vueAccountParty
if exists (select * from information_schema.tables where table_name = 'vueAccountParty' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountParty]
GO
-- Drop Foreign Key FK_AccountParty_SystemCurrency from AccountParty
Print 'Drop Foreign Key FK_AccountParty_SystemCurrency from AccountParty'
GO
IF EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_SCHEMA='dbo' AND CONSTRAINT_NAME='FK_AccountParty_SystemCurrency' AND TABLE_NAME='AccountParty')
BEGIN
	ALTER TABLE [dbo].[AccountParty] DROP CONSTRAINT [FK_AccountParty_SystemCurrency]
END
GO
-- Alter Column DefaultCurrencyId on AccountParty
Print 'Alter Column DefaultCurrencyId on AccountParty'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountParty' AND TABLE_TYPE='BASE TABLE')) AND (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='DefaultCurrencyId' AND TABLE_NAME='AccountParty'))
ALTER TABLE [dbo].[AccountParty]
	 ALTER COLUMN [DefaultCurrencyId] smallint NULL
GO
-- Create View vueAccountParty
Print 'Create View vueAccountParty'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountParty' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountParty
AS
SELECT     dbo.AccountParty.AccountPartyId, dbo.AccountParty.PartyTypeId, dbo.AccountParty.AccountId, dbo.AccountParty.PartyName, 
                      dbo.AccountParty.PartyNick, dbo.AccountParty.EMailAddress, dbo.AccountParty.Address1, dbo.AccountParty.Address2, dbo.AccountParty.CountryId, 
                      dbo.AccountParty.State, dbo.AccountParty.City, dbo.AccountParty.ZipCode, dbo.AccountParty.Telephone1, dbo.AccountParty.Telephone2, 
                      dbo.AccountParty.Fax, dbo.AccountParty.DefaultBillingRate, dbo.AccountParty.Website, dbo.AccountParty.Notes, dbo.AccountParty.IsDisabled, 
                      dbo.AccountParty.IsDeleted, dbo.AccountParty.CreatedOn, dbo.AccountParty.CreatedByEmployeeId, dbo.AccountParty.ModifiedOn, 
                      dbo.AccountParty.ModifiedByEmployeeId, dbo.SystemCountry.Country
FROM         dbo.SystemCountry INNER JOIN
                      dbo.AccountParty ON dbo.SystemCountry.CountryId = dbo.AccountParty.CountryId'
GO
-- Alter Column ModuleName on AccountTerminology
Print 'Alter Column ModuleName on AccountTerminology'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountTerminology' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='ModuleName' AND TABLE_NAME='AccountTerminology'))
ALTER TABLE [dbo].[AccountTerminology]
	 ADD [ModuleName] nvarchar(100) NULL
GO
-- Add Column TerminologyName to AccountTerminology
Print 'Add Column TerminologyName to AccountTerminology'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountTerminology' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='TerminologyName' AND TABLE_NAME='AccountTerminology'))
ALTER TABLE [dbo].[AccountTerminology]
	ADD [TerminologyName] nvarchar(100) NULL
GO
Update SystemData Set Version = '3.1.7' Where Version = '3.1.6' And SystemDataId = 1
GO
-- Drop View vueAccountWorkingDayType
Print 'Drop View vueAccountWorkingDayType'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountWorkingDayType' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountWorkingDayType]
GO

-- Drop View vueAccountEmployee
Print 'Drop View vueAccountEmployee'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployee]
GO
-- Drop View vueAccountEmployeeTimeEntryApprovalPending
Print 'Drop View vueAccountEmployeeTimeEntryApprovalPending'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryApprovalPending' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryApprovalPending]
GO
-- Add Column AccountTimesheetPeriodTypeId to AccountWorkingDayType
Print 'Add Column AccountTimesheetPeriodTypeId to AccountWorkingDayType'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountWorkingDayType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='AccountTimesheetPeriodTypeId' AND TABLE_NAME='AccountWorkingDayType'))
ALTER TABLE [dbo].[AccountWorkingDayType]
	ADD [AccountTimesheetPeriodTypeId] uniqueidentifier NULL
GO

-- Create Index IX_AccountTimesheetPeriodTypeId on AccountWorkingDayType
Print 'Create Index IX_AccountTimesheetPeriodTypeId on AccountWorkingDayType'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountWorkingDayType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountWorkingDayType]') AND name = N'IX_AccountTimesheetPeriodTypeId'))
CREATE INDEX [IX_AccountTimesheetPeriodTypeId]
	ON [dbo].[AccountWorkingDayType] ([AccountTimesheetPeriodTypeId])
GO

-- Create Table SystemInitialDaysOfThePeriod
Print 'Create Table SystemInitialDaysOfThePeriod'
GO
IF NOT EXISTS (select * from information_schema.tables where table_name = 'SystemInitialDaysOfThePeriod' and table_type = 'BASE TABLE') 
CREATE TABLE [dbo].[SystemInitialDaysOfThePeriod] (
		[SystemInitialDaysOfThePeriodId]     smallint NOT NULL,
		[SystemInitialDaysOfThePeriod]       nvarchar(20) NOT NULL,
		[SystemInitialDayOfFirstPeriod]      smallint NOT NULL,
		[SystemInitialDayOfLastPeriod]       smallint NOT NULL
)
GO

-- Add Primary Key PK_SystemInitialDaysOfThePeriod to SystemInitialDaysOfThePeriod
Print 'Add Primary Key PK_SystemInitialDaysOfThePeriod to SystemInitialDaysOfThePeriod'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'SystemInitialDaysOfThePeriod' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_NAME='PK_SystemInitialDaysOfThePeriod' AND TABLE_NAME='SystemInitialDaysOfThePeriod'))
ALTER TABLE [dbo].[SystemInitialDaysOfThePeriod]
	ADD
	CONSTRAINT [PK_SystemInitialDaysOfThePeriod]
	PRIMARY KEY
	([SystemInitialDaysOfThePeriodId])
GO

-- Create Table SystemTimesheetPeriodType
Print 'Create Table SystemTimesheetPeriodType'
GO
IF NOT EXISTS (select * from information_schema.tables where table_name = 'SystemTimesheetPeriodType' and table_type = 'BASE TABLE') 
CREATE TABLE [dbo].[SystemTimesheetPeriodType] (
		[SystemTimesheetPeriodTypeId]     smallint NOT NULL,
		[SystemTimesheetPeriodType]       nvarchar(100) NOT NULL
)
GO

-- Add Primary Key PK_SystemTimesheetType to SystemTimesheetPeriodType
Print 'Add Primary Key PK_SystemTimesheetType to SystemTimesheetPeriodType'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'SystemTimesheetPeriodType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_NAME='PK_SystemTimesheetType' AND TABLE_NAME='SystemTimesheetPeriodType'))
ALTER TABLE [dbo].[SystemTimesheetPeriodType]
	ADD
	CONSTRAINT [PK_SystemTimesheetType]
	PRIMARY KEY
	([SystemTimesheetPeriodTypeId])
GO

-- Create Table AccountTimesheetPeriodType
Print 'Create Table AccountTimesheetPeriodType'
GO
IF NOT EXISTS (select * from information_schema.tables where table_name = 'AccountTimesheetPeriodType' and table_type = 'BASE TABLE') 
CREATE TABLE [dbo].[AccountTimesheetPeriodType] (
		[AccountTimesheetPeriodTypeId]       uniqueidentifier NOT NULL,
		[AccountId]                          int NOT NULL,
		[SystemTimesheetPeriodTypeId]        smallint NOT NULL,
		[SystemInitialDaysOfThePeriodId]     smallint NULL,
		[InitialDayOfTheMonth]               smallint NULL,
		[CreatedOn]                          datetime NOT NULL,
		[CreatedByEmployeeId]                int NOT NULL,
		[ModifiedOn]                         datetime NOT NULL,
		[ModifiedByEmployeeId]               int NOT NULL,
		[IsDisabled]                         bit NOT NULL,
		[MasterTimesheetPeriodTypeId]        smallint NOT NULL
)
GO

-- Add Primary Key PK_AccountTimesheetType to AccountTimesheetPeriodType
Print 'Add Primary Key PK_AccountTimesheetType to AccountTimesheetPeriodType'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountTimesheetPeriodType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_NAME='PK_AccountTimesheetType' AND TABLE_NAME='AccountTimesheetPeriodType'))
ALTER TABLE [dbo].[AccountTimesheetPeriodType]
	ADD
	CONSTRAINT [PK_AccountTimesheetType]
	PRIMARY KEY
	([AccountTimesheetPeriodTypeId])
GO

-- Add Default Constraint DF_AccountTimesheetType_AccountTimesheetTypeId to AccountTimesheetPeriodType
Print 'Add Default Constraint DF_AccountTimesheetType_AccountTimesheetTypeId to AccountTimesheetPeriodType'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountTimesheetPeriodType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM sysobjects WHERE name= N'DF_AccountTimesheetType_AccountTimesheetTypeId'))
ALTER TABLE [dbo].[AccountTimesheetPeriodType]
	ADD
	CONSTRAINT [DF_AccountTimesheetType_AccountTimesheetTypeId]
	DEFAULT (newid()) FOR [AccountTimesheetPeriodTypeId]
GO

-- Create Index IX_AccountTimesheetPeriodType_AccountId on AccountTimesheetPeriodType
Print 'Create Index IX_AccountTimesheetPeriodType_AccountId on AccountTimesheetPeriodType'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountTimesheetPeriodType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountTimesheetPeriodType]') AND name = N'IX_AccountTimesheetPeriodType_AccountId'))
CREATE INDEX [IX_AccountTimesheetPeriodType_AccountId]
	ON [dbo].[AccountTimesheetPeriodType] ([AccountId])
GO

-- Create Index IX_InitialDayOfTheMonth on AccountTimesheetPeriodType
Print 'Create Index IX_InitialDayOfTheMonth on AccountTimesheetPeriodType'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountTimesheetPeriodType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountTimesheetPeriodType]') AND name = N'IX_InitialDayOfTheMonth'))
CREATE INDEX [IX_InitialDayOfTheMonth]
	ON [dbo].[AccountTimesheetPeriodType] ([InitialDayOfTheMonth])
GO

-- Create Index IX_MasterTimesheetPeriodTypeId on AccountTimesheetPeriodType
Print 'Create Index IX_MasterTimesheetPeriodTypeId on AccountTimesheetPeriodType'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountTimesheetPeriodType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountTimesheetPeriodType]') AND name = N'IX_MasterTimesheetPeriodTypeId'))
CREATE INDEX [IX_MasterTimesheetPeriodTypeId]
	ON [dbo].[AccountTimesheetPeriodType] ([MasterTimesheetPeriodTypeId])
GO

-- Create Index IX_SystemInitialDaysOfThePeriodId on AccountTimesheetPeriodType
Print 'Create Index IX_SystemInitialDaysOfThePeriodId on AccountTimesheetPeriodType'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountTimesheetPeriodType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountTimesheetPeriodType]') AND name = N'IX_SystemInitialDaysOfThePeriodId'))
CREATE INDEX [IX_SystemInitialDaysOfThePeriodId]
	ON [dbo].[AccountTimesheetPeriodType] ([SystemInitialDaysOfThePeriodId])
GO

-- Create Index IX_SystemTimesheetPeriodTypeId on AccountTimesheetPeriodType
Print 'Create Index IX_SystemTimesheetPeriodTypeId on AccountTimesheetPeriodType'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountTimesheetPeriodType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountTimesheetPeriodType]') AND name = N'IX_SystemTimesheetPeriodTypeId'))
CREATE INDEX [IX_SystemTimesheetPeriodTypeId]
	ON [dbo].[AccountTimesheetPeriodType] ([SystemTimesheetPeriodTypeId])
GO

-- Create View vueAccountTimesheetPeriodType
Print 'Create View vueAccountTimesheetPeriodType'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountTimesheetPeriodType' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW [dbo].[vueAccountTimesheetPeriodType]
AS
SELECT     dbo.AccountTimesheetPeriodType.AccountTimesheetPeriodTypeId, dbo.AccountTimesheetPeriodType.AccountId, 
                      dbo.AccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, dbo.AccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, 
                      dbo.AccountTimesheetPeriodType.InitialDayOfTheMonth, dbo.AccountTimesheetPeriodType.CreatedOn, 
                      dbo.AccountTimesheetPeriodType.CreatedByEmployeeId, dbo.AccountTimesheetPeriodType.ModifiedOn, 
                      dbo.AccountTimesheetPeriodType.ModifiedByEmployeeId, dbo.AccountTimesheetPeriodType.IsDisabled, 
                      dbo.SystemTimesheetPeriodType.SystemTimesheetPeriodType, dbo.SystemInitialDaysOfThePeriod.SystemInitialDaysOfThePeriod, 
                      dbo.SystemInitialDaysOfThePeriod.SystemInitialDayOfFirstPeriod, dbo.SystemInitialDaysOfThePeriod.SystemInitialDayOfLastPeriod
FROM         dbo.SystemTimesheetPeriodType RIGHT OUTER JOIN
                      dbo.AccountTimesheetPeriodType ON 
                      dbo.SystemTimesheetPeriodType.SystemTimesheetPeriodTypeId = dbo.AccountTimesheetPeriodType.SystemTimesheetPeriodTypeId LEFT OUTER JOIN
                      dbo.SystemInitialDaysOfThePeriod ON 
                      dbo.AccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId = dbo.SystemInitialDaysOfThePeriod.SystemInitialDaysOfThePeriodId'

GO

-- Create View vueAccountEmployeeTimeEntryApprovalPending
Print 'Create View vueAccountEmployeeTimeEntryApprovalPending'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryApprovalPending' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryApprovalPending
AS
SELECT     dbo.vueAccountEmployeeTimeEntryApproval.AccountProjectId, dbo.vueAccountEmployeeTimeEntryApproval.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApproval.ProjectManagerEmployeeId, dbo.vueAccountEmployeeTimeEntryApproval.ApprovalTypeName, 
                      dbo.vueAccountEmployeeTimeEntryApproval.AccountApprovalPathId, dbo.vueAccountEmployeeTimeEntryApproval.AccountApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApproval.SystemApproverTypeId, dbo.vueAccountEmployeeTimeEntryApproval.AccountExternalUserId, 
                      dbo.vueAccountEmployeeTimeEntryApproval.AccountEmployeeId, dbo.vueAccountEmployeeTimeEntryApproval.ApprovalPathSequence, 
                      dbo.vueAccountEmployeeTimeEntryApproval.AccountEmployeeTimeEntryId, MAX(dbo.vueAccountEmployeeTimeEntryApproval.TimeSheetApprovalId) 
                      AS TimeSheetApprovalId, dbo.vueAccountEmployeeTimeEntryApproval.TimeSheetApprovalPathId, 
                      dbo.vueAccountEmployeeTimeEntryApproval.ProjectName, dbo.vueAccountEmployeeTimeEntryApproval.ProjectDescription, 
                      dbo.vueAccountEmployeeTimeEntryApproval.ProjectCode, dbo.vueAccountEmployeeTimeEntryApproval.TaskName, 
                      dbo.vueAccountEmployeeTimeEntryApproval.AccountProjectTaskId, dbo.vueAccountEmployeeTimeEntryApproval.TaskDescription, 
                      dbo.vueAccountEmployeeTimeEntryApproval.EmployeeName, dbo.vueAccountEmployeeTimeEntryApproval.Approved, 
                      dbo.vueAccountEmployeeTimeEntryApproval.TimeSheetApprovalTypeId, dbo.vueAccountEmployeeTimeEntryApproval.TotalTime, 
                      dbo.vueAccountEmployeeTimeEntryApproval.TimeEntryDate, dbo.vueAccountEmployeeTimeEntryApproval.Comments, 
                      dbo.vueAccountEmployeeTimeEntryApproval.IsReject, dbo.vueAccountEmployeeTimeEntryApproval.IsApproved, 
                      dbo.vueAccountApproverType.MaxApprovalPathSequence, dbo.vueAccountEmployeeTimeEntryApproval.TimeEntryAccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApproval.AccountId, dbo.vueAccountEmployeeTimeEntryApproval.EMailAddress, 
                      dbo.vueAccountEmployeeTimeEntryApproval.Description, dbo.vueAccountEmployeeTimeEntryApproval.Submitted, 
                      dbo.vueAccountEmployeeTimeEntryApproval.EmployeeManagerId, dbo.vueAccountEmployeeTimeEntryApproval.TotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntryApproval.IsBillable, dbo.vueAccountEmployeeTimeEntryApproval.BillableTotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntryApproval.NonBillableTotalMinutes, dbo.vueAccountEmployeeTimeEntryApproval.Rejected, 
                      dbo.vueAccountEmployeeTimeEntryApproval.AccountEmployeeTimeEntryPeriodId, CONVERT(nvarchar(10), 
                      19000100 + ISNULL(dbo.vueAccountWorkingDay.WeekStartDay, 1)) AS EmployeeWeekStartDay, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType
FROM         dbo.AccountEmployeeTimeEntryPeriod INNER JOIN
                      dbo.vueAccountEmployeeTimeEntryApproval INNER JOIN
                      dbo.vueAccountApproverType ON 
                      dbo.vueAccountEmployeeTimeEntryApproval.AccountApprovalTypeId = dbo.vueAccountApproverType.AccountApprovalTypeId ON 
                      dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId = dbo.vueAccountEmployeeTimeEntryApproval.AccountEmployeeTimeEntryPeriodId
                       LEFT OUTER JOIN
                      dbo.vueAccountWorkingDay INNER JOIN
                      dbo.AccountEmployee ON dbo.vueAccountWorkingDay.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId ON 
                      dbo.vueAccountEmployeeTimeEntryApproval.TimeEntryAccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId
WHERE     (dbo.vueAccountEmployeeTimeEntryApproval.AccountApprovalPathId IN
                          (SELECT     TOP 1 AccountApprovalPathId
                            FROM          dbo.vueTimesheetApprovalSequence
                            WHERE      (TimeSheetApprovalId IS NULL) AND 
                                                   (AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryApproval.AccountEmployeeTimeEntryId))) AND 
                      (dbo.vueAccountEmployeeTimeEntryApproval.Approved = 0) AND (dbo.vueAccountEmployeeTimeEntryApproval.Submitted = 1) AND 
                      (dbo.vueAccountEmployeeTimeEntryApproval.Rejected IS NULL OR
                      dbo.vueAccountEmployeeTimeEntryApproval.Rejected = 0) AND 
                      (dbo.vueAccountEmployeeTimeEntryApproval.AccountEmployeeTimeEntryPeriodId IS NOT NULL)
GROUP BY dbo.vueAccountEmployeeTimeEntryApproval.AccountProjectId, dbo.vueAccountEmployeeTimeEntryApproval.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApproval.ProjectManagerEmployeeId, dbo.vueAccountEmployeeTimeEntryApproval.ApprovalTypeName, 
                      dbo.vueAccountEmployeeTimeEntryApproval.AccountApprovalTypeId, dbo.vueAccountEmployeeTimeEntryApproval.SystemApproverTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApproval.AccountExternalUserId, dbo.vueAccountEmployeeTimeEntryApproval.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApproval.ApprovalPathSequence, dbo.vueAccountEmployeeTimeEntryApproval.TimeSheetApprovalPathId, 
                      dbo.vueAccountEmployeeTimeEntryApproval.ProjectName, dbo.vueAccountEmployeeTimeEntryApproval.ProjectDescription, 
                      dbo.vueAccountEmployeeTimeEntryApproval.ProjectCode, dbo.vueAccountEmployeeTimeEntryApproval.TaskName, 
                      dbo.vueAccountEmployeeTimeEntryApproval.AccountProjectTaskId, dbo.vueAccountEmployeeTimeEntryApproval.TaskDescription, 
                      dbo.vueAccountEmployeeTimeEntryApproval.EmployeeName, dbo.vueAccountEmployeeTimeEntryApproval.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApproval.TotalTime, dbo.vueAccountEmployeeTimeEntryApproval.TimeEntryDate, 
                      dbo.vueAccountEmployeeTimeEntryApproval.Comments, dbo.vueAccountEmployeeTimeEntryApproval.IsReject, 
                      dbo.vueAccountEmployeeTimeEntryApproval.IsApproved, dbo.vueAccountApproverType.MaxApprovalPathSequence, 
                      dbo.vueAccountEmployeeTimeEntryApproval.TimeEntryAccountEmployeeId, dbo.vueAccountEmployeeTimeEntryApproval.AccountId, 
                      dbo.vueAccountEmployeeTimeEntryApproval.EMailAddress, dbo.vueAccountEmployeeTimeEntryApproval.Description, 
                      dbo.vueAccountEmployeeTimeEntryApproval.EmployeeManagerId, dbo.vueAccountEmployeeTimeEntryApproval.TotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntryApproval.IsBillable, dbo.vueAccountEmployeeTimeEntryApproval.BillableTotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntryApproval.NonBillableTotalMinutes, dbo.vueAccountEmployeeTimeEntryApproval.Rejected, 
                      dbo.vueAccountEmployeeTimeEntryApproval.AccountApprovalPathId, dbo.vueAccountEmployeeTimeEntryApproval.AccountEmployeeTimeEntryId, 
                      dbo.vueAccountEmployeeTimeEntryApproval.Approved, dbo.vueAccountEmployeeTimeEntryApproval.Submitted, 
                      dbo.vueAccountEmployeeTimeEntryApproval.AccountEmployeeTimeEntryPeriodId, dbo.vueAccountWorkingDay.WeekStartDay, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType'
GO

-- Create View vueAccountEmployee
Print 'Create View vueAccountEmployee'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployee
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountEmployee.AccountId, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.Password, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountLocationId, 
                      dbo.AccountEmployee.BillingTypeId, dbo.AccountBillingType.BillingType, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountPreferences.ShowClockStartEnd, 
                      dbo.Account.TimeZoneId, dbo.AccountRole.MasterAccountRoleId, dbo.Account.DefaultCurrencyId, dbo.Account.CountryId, 
                      dbo.AccountPreferences.CultureInfoName, dbo.AccountPreferences.TimeEntryFormat, dbo.AccountEmployee.AllowedAccessFromIP, 
                      dbo.AccountRole.AccountRoleId, dbo.AccountPreferences.AccountSessionTimeout, dbo.AccountPreferences.ShowCompletedTasksInTimeSheet, 
                      dbo.AccountPreferences.CurrencySymbol, dbo.AccountPreferences.IsCompanyOwnLogo, dbo.Account.AccountExpiryActivation, 
                      dbo.Account.LicenseActivation, dbo.AccountEmployee.EmployeeTypeId, dbo.AccountEmployee.ExternalUserClientId, 
                      dbo.AccountEmployee.AccountBillingRateId, dbo.AccountPreferences.ScheduledEmailSendTime, 
                      dbo.AccountPreferences.LastScheduledEmailSentTime, dbo.AccountEmployee.Username, dbo.AccountEmployee.IsDisabled, 
                      dbo.AccountPreferences.FromEmailAddress, dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.AccountEmployee.EmployeeCode, 
                      dbo.AccountPreferences.Version, dbo.AccountPreferences.LockSubmittedRecords, dbo.AccountPreferences.LockApprovedRecords, 
                      ISNULL(dbo.AccountEmployee.EmployeeCode + '' - '', '''') 
                      + dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeNameWithCode, 
                      dbo.AccountPreferences.ShowWorkTypeInTimeSheet, dbo.AccountPreferences.NumberOfBlankRowsInTimeEntry, 
                      dbo.AccountPreferences.ShowCostCenterInTimeSheet, dbo.AccountPreferences.WeekStartDay, dbo.AccountPreferences.AccountBaseCurrencyId, 
                      dbo.AccountPreferences.UserInterfaceLanguage, dbo.AccountEmployee.EmployeeManagerId, dbo.AccountPreferences.DefaultTimeEntryMode, 
                      dbo.AccountPreferences.PageSize, dbo.AccountEmployee.TimeZoneId AS EmployeeTimeZoneId, dbo.AccountEmployee.TerminationDate, 
                      dbo.AccountEmployee.StatusId, dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.EmployeePayTypeId, dbo.AccountEmployee.HiredDate, 
                      dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountWorkingDayType, dbo.AccountWorkingDayType.HoursPerDay, 
                      dbo.AccountWorkingDayType.WeekStartDay AS EmployeeWeekStartDay, dbo.AccountPreferences.ShowClientInTimesheet, 
                      dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, 
                      dbo.AccountPreferences.ShowDescriptionInWeekView, dbo.AccountPreferences.InvoiceNoPrefix, 
                      dbo.AccountPreferences.ShowAdditionalTaskInformationType, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, 
                      dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod
FROM         dbo.vueAccountTimesheetPeriodType INNER JOIN
                      dbo.AccountWorkingDayType ON 
                      dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId = dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId RIGHT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.Account ON dbo.AccountEmployee.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId ON 
                      dbo.AccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployee.AccountId = dbo.AccountPreferences.AccountId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId'
GO

-- Create Table MasterTimesheetPeriodType
Print 'Create Table MasterTimesheetPeriodType'
GO
IF NOT EXISTS (select * from information_schema.tables where table_name = 'MasterTimesheetPeriodType' and table_type = 'BASE TABLE') 
CREATE TABLE [dbo].[MasterTimesheetPeriodType] (
		[MasterTimesheetPeriodTypeId]        smallint NOT NULL,
		[SystemTimesheetPeriodTypeId]        smallint NOT NULL,
		[SystemInitialDaysOfThePeriodId]     smallint NULL,
		[InitialDayOfTheMonth]               smallint NULL
)
GO

-- Add Primary Key PK_MasterTimesheetType to MasterTimesheetPeriodType
Print 'Add Primary Key PK_MasterTimesheetType to MasterTimesheetPeriodType'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'MasterTimesheetPeriodType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_NAME='PK_MasterTimesheetType' AND TABLE_NAME='MasterTimesheetPeriodType'))
ALTER TABLE [dbo].[MasterTimesheetPeriodType]
	ADD
	CONSTRAINT [PK_MasterTimesheetType]
	PRIMARY KEY
	([MasterTimesheetPeriodTypeId])
GO

-- Create View vueAccountWorkingDayType
Print 'Create View vueAccountWorkingDayType'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountWorkingDayType' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountWorkingDayType
AS
SELECT     dbo.AccountWorkingDayType.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountId, 
                      dbo.AccountWorkingDayType.AccountWorkingDayType, dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay, 
                      dbo.AccountWorkingDayType.CreatedByEmployeeId, dbo.AccountWorkingDayType.CreatedOn, dbo.AccountWorkingDayType.ModifiedByEmployeeId, 
                      dbo.AccountWorkingDayType.ModifiedOn, dbo.AccountWorkingDayType.IsDisabled, dbo.SystemWorkingDay.WorkingDay, 
                      dbo.AccountWorkingDayType.MasterWorkingDayTypeId, dbo.SystemWorkingDay.SQLServerWeekDayNo, 
                      dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, 
                      dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, 
                      dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod, dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId
FROM         dbo.AccountWorkingDayType LEFT OUTER JOIN
                      dbo.vueAccountTimesheetPeriodType ON 
                      dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId = dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId LEFT OUTER JOIN
                      dbo.SystemWorkingDay ON dbo.AccountWorkingDayType.WeekStartDay = dbo.SystemWorkingDay.WorkingDayNo'
GO

-- Create Foreign Key FK_AccountWorkingDayType_AccountTimesheetPeriodType on AccountWorkingDayType
Print 'Create Foreign Key FK_AccountWorkingDayType_AccountTimesheetPeriodType on AccountWorkingDayType'
GO
IF NOT EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_SCHEMA='dbo' AND CONSTRAINT_NAME='FK_AccountWorkingDayType_AccountTimesheetPeriodType' AND TABLE_NAME='AccountWorkingDayType')
BEGIN
		ALTER TABLE [dbo].[AccountWorkingDayType]
			ADD CONSTRAINT [FK_AccountWorkingDayType_AccountTimesheetPeriodType]
			FOREIGN KEY ([AccountTimesheetPeriodTypeId]) REFERENCES [dbo].[AccountTimesheetPeriodType] ([AccountTimesheetPeriodTypeId])
END
GO

-- Create Foreign Key FK_AccountTimesheetPeriodType_Account on AccountTimesheetPeriodType
Print 'Create Foreign Key FK_AccountTimesheetPeriodType_Account on AccountTimesheetPeriodType'
GO
IF NOT EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_SCHEMA='dbo' AND CONSTRAINT_NAME='FK_AccountTimesheetPeriodType_Account' AND TABLE_NAME='AccountTimesheetPeriodType')
BEGIN
		ALTER TABLE [dbo].[AccountTimesheetPeriodType]
			ADD CONSTRAINT [FK_AccountTimesheetPeriodType_Account]
			FOREIGN KEY ([AccountId]) REFERENCES [dbo].[Account] ([AccountId])
END
GO

-- Create Foreign Key FK_AccountTimesheetPeriodType_MasterTimesheetPeriodType on AccountTimesheetPeriodType
Print 'Create Foreign Key FK_AccountTimesheetPeriodType_MasterTimesheetPeriodType on AccountTimesheetPeriodType'
GO
IF NOT EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_SCHEMA='dbo' AND CONSTRAINT_NAME='FK_AccountTimesheetPeriodType_MasterTimesheetPeriodType' AND TABLE_NAME='AccountTimesheetPeriodType')
BEGIN
		ALTER TABLE [dbo].[AccountTimesheetPeriodType]
			ADD CONSTRAINT [FK_AccountTimesheetPeriodType_MasterTimesheetPeriodType]
			FOREIGN KEY ([MasterTimesheetPeriodTypeId]) REFERENCES [dbo].[MasterTimesheetPeriodType] ([MasterTimesheetPeriodTypeId])
END
GO

-- Create Foreign Key FK_AccountTimesheetPeriodType_SystemInitialDaysOfThePeriod on AccountTimesheetPeriodType
Print 'Create Foreign Key FK_AccountTimesheetPeriodType_SystemInitialDaysOfThePeriod on AccountTimesheetPeriodType'
GO
IF NOT EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_SCHEMA='dbo' AND CONSTRAINT_NAME='FK_AccountTimesheetPeriodType_SystemInitialDaysOfThePeriod' AND TABLE_NAME='AccountTimesheetPeriodType')
BEGIN
		ALTER TABLE [dbo].[AccountTimesheetPeriodType]
			ADD CONSTRAINT [FK_AccountTimesheetPeriodType_SystemInitialDaysOfThePeriod]
			FOREIGN KEY ([SystemInitialDaysOfThePeriodId]) REFERENCES [dbo].[SystemInitialDaysOfThePeriod] ([SystemInitialDaysOfThePeriodId])
END
GO

-- Create Foreign Key FK_AccountTimesheetPeriodType_SystemTimesheetPeriodType on AccountTimesheetPeriodType
Print 'Create Foreign Key FK_AccountTimesheetPeriodType_SystemTimesheetPeriodType on AccountTimesheetPeriodType'
GO
IF NOT EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_SCHEMA='dbo' AND CONSTRAINT_NAME='FK_AccountTimesheetPeriodType_SystemTimesheetPeriodType' AND TABLE_NAME='AccountTimesheetPeriodType')
BEGIN
		ALTER TABLE [dbo].[AccountTimesheetPeriodType]
			ADD CONSTRAINT [FK_AccountTimesheetPeriodType_SystemTimesheetPeriodType]
			FOREIGN KEY ([SystemTimesheetPeriodTypeId]) REFERENCES [dbo].[SystemTimesheetPeriodType] ([SystemTimesheetPeriodTypeId])
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[MasterTimesheetPeriodType]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[MasterTimesheetPeriodType]'

if not exists(Select * from [dbo].[MasterTimesheetPeriodType] where [MasterTimesheetPeriodTypeId] = 1)
BEGIN
INSERT INTO [dbo].[MasterTimesheetPeriodType] ([MasterTimesheetPeriodTypeId], [SystemTimesheetPeriodTypeId], [SystemInitialDaysOfThePeriodId], [InitialDayOfTheMonth]) VALUES (1, 1, NULL, NULL)
INSERT INTO [dbo].[MasterTimesheetPeriodType] ([MasterTimesheetPeriodTypeId], [SystemTimesheetPeriodTypeId], [SystemInitialDaysOfThePeriodId], [InitialDayOfTheMonth]) VALUES (2, 2, NULL, NULL)
INSERT INTO [dbo].[MasterTimesheetPeriodType] ([MasterTimesheetPeriodTypeId], [SystemTimesheetPeriodTypeId], [SystemInitialDaysOfThePeriodId], [InitialDayOfTheMonth]) VALUES (3, 3, NULL, NULL)
INSERT INTO [dbo].[MasterTimesheetPeriodType] ([MasterTimesheetPeriodTypeId], [SystemTimesheetPeriodTypeId], [SystemInitialDaysOfThePeriodId], [InitialDayOfTheMonth]) VALUES (4, 4, 1, NULL)
INSERT INTO [dbo].[MasterTimesheetPeriodType] ([MasterTimesheetPeriodTypeId], [SystemTimesheetPeriodTypeId], [SystemInitialDaysOfThePeriodId], [InitialDayOfTheMonth]) VALUES (5, 5, NULL, 1)
END
GO

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemInitialDaysOfThePeriod]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemInitialDaysOfThePeriod]'

if not exists(Select * from [dbo].[SystemInitialDaysOfThePeriod] where [SystemInitialDaysOfThePeriodId] = 1)
BEGIN
INSERT INTO [dbo].[SystemInitialDaysOfThePeriod] ([SystemInitialDaysOfThePeriodId], [SystemInitialDaysOfThePeriod], [SystemInitialDayOfFirstPeriod], [SystemInitialDayOfLastPeriod]) VALUES (1, N'1st And 16th', 1, 16)
INSERT INTO [dbo].[SystemInitialDaysOfThePeriod] ([SystemInitialDaysOfThePeriodId], [SystemInitialDaysOfThePeriod], [SystemInitialDayOfFirstPeriod], [SystemInitialDayOfLastPeriod]) VALUES (2, N'2nd And 17th', 2, 17)
INSERT INTO [dbo].[SystemInitialDaysOfThePeriod] ([SystemInitialDaysOfThePeriodId], [SystemInitialDaysOfThePeriod], [SystemInitialDayOfFirstPeriod], [SystemInitialDayOfLastPeriod]) VALUES (3, N'3rd And 18th', 3, 18)
INSERT INTO [dbo].[SystemInitialDaysOfThePeriod] ([SystemInitialDaysOfThePeriodId], [SystemInitialDaysOfThePeriod], [SystemInitialDayOfFirstPeriod], [SystemInitialDayOfLastPeriod]) VALUES (4, N'4th And 19th', 4, 19)
INSERT INTO [dbo].[SystemInitialDaysOfThePeriod] ([SystemInitialDaysOfThePeriodId], [SystemInitialDaysOfThePeriod], [SystemInitialDayOfFirstPeriod], [SystemInitialDayOfLastPeriod]) VALUES (5, N'5th And 20th', 5, 20)
INSERT INTO [dbo].[SystemInitialDaysOfThePeriod] ([SystemInitialDaysOfThePeriodId], [SystemInitialDaysOfThePeriod], [SystemInitialDayOfFirstPeriod], [SystemInitialDayOfLastPeriod]) VALUES (6, N'6th And 21st', 6, 21)
INSERT INTO [dbo].[SystemInitialDaysOfThePeriod] ([SystemInitialDaysOfThePeriodId], [SystemInitialDaysOfThePeriod], [SystemInitialDayOfFirstPeriod], [SystemInitialDayOfLastPeriod]) VALUES (7, N'7th And 22nd', 7, 22)
INSERT INTO [dbo].[SystemInitialDaysOfThePeriod] ([SystemInitialDaysOfThePeriodId], [SystemInitialDaysOfThePeriod], [SystemInitialDayOfFirstPeriod], [SystemInitialDayOfLastPeriod]) VALUES (8, N'8th And 23rd', 8, 23)
INSERT INTO [dbo].[SystemInitialDaysOfThePeriod] ([SystemInitialDaysOfThePeriodId], [SystemInitialDaysOfThePeriod], [SystemInitialDayOfFirstPeriod], [SystemInitialDayOfLastPeriod]) VALUES (9, N'9th And 24th', 9, 24)
INSERT INTO [dbo].[SystemInitialDaysOfThePeriod] ([SystemInitialDaysOfThePeriodId], [SystemInitialDaysOfThePeriod], [SystemInitialDayOfFirstPeriod], [SystemInitialDayOfLastPeriod]) VALUES (10, N'10th And 25th', 10, 25)
INSERT INTO [dbo].[SystemInitialDaysOfThePeriod] ([SystemInitialDaysOfThePeriodId], [SystemInitialDaysOfThePeriod], [SystemInitialDayOfFirstPeriod], [SystemInitialDayOfLastPeriod]) VALUES (11, N'11th And 26th', 11, 26)
INSERT INTO [dbo].[SystemInitialDaysOfThePeriod] ([SystemInitialDaysOfThePeriodId], [SystemInitialDaysOfThePeriod], [SystemInitialDayOfFirstPeriod], [SystemInitialDayOfLastPeriod]) VALUES (12, N'12th And 27th', 12, 27)
INSERT INTO [dbo].[SystemInitialDaysOfThePeriod] ([SystemInitialDaysOfThePeriodId], [SystemInitialDaysOfThePeriod], [SystemInitialDayOfFirstPeriod], [SystemInitialDayOfLastPeriod]) VALUES (13, N'13th And 28th', 13, 28)
END
GO

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemTimesheetPeriodType]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemTimesheetPeriodType]'

if not exists(Select * from [dbo].[SystemTimesheetPeriodType] where [SystemTimesheetPeriodTypeId] = 1)
BEGIN
INSERT INTO [dbo].[SystemTimesheetPeriodType] ([SystemTimesheetPeriodTypeId], [SystemTimesheetPeriodType]) VALUES (1, N'Daily')
INSERT INTO [dbo].[SystemTimesheetPeriodType] ([SystemTimesheetPeriodTypeId], [SystemTimesheetPeriodType]) VALUES (2, N'Weekly')
INSERT INTO [dbo].[SystemTimesheetPeriodType] ([SystemTimesheetPeriodTypeId], [SystemTimesheetPeriodType]) VALUES (3, N'BiWeekly')
INSERT INTO [dbo].[SystemTimesheetPeriodType] ([SystemTimesheetPeriodTypeId], [SystemTimesheetPeriodType]) VALUES (4, N'Semi-Monthly')
INSERT INTO [dbo].[SystemTimesheetPeriodType] ([SystemTimesheetPeriodTypeId], [SystemTimesheetPeriodType]) VALUES (5, N'Monthly')
INSERT INTO [dbo].[SystemTimesheetPeriodType] ([SystemTimesheetPeriodTypeId], [SystemTimesheetPeriodType]) VALUES (6, N'Manual')
INSERT INTO [dbo].[SystemTimesheetPeriodType] ([SystemTimesheetPeriodTypeId], [SystemTimesheetPeriodType]) VALUES (7, N'Weekly End-of-Month')
END
GO
-- =======================================================
-- Foreign Key Constraint Nochecks's for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print ' Foreign Key Constraint Nochecks''s for Table: [dbo].[SystemSecurityCategoryPage]'

ALTER TABLE [dbo].[SystemSecurityCategoryPage] NOCHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory]
ALTER TABLE [dbo].[SystemSecurityCategoryPage] NOCHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory1]

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemSecurityCategoryPage]'
IF NOT EXISTS (SELECT * FROM [dbo].[SystemSecurityCategoryPage] WHERE [SystemSecurityCategoryPageId] = 136)
BEGIN
INSERT INTO [dbo].[SystemSecurityCategoryPage] ([SystemSecurityCategoryPageId], [SystemSecurityCategoryId], [SequenceNumber], [Folder], [SystemCategoryPage], [SystemCategoryPageDescription], [ParentSystemSecurityCateogoryPageId], [IsSiteMapPage], [IsCustomizeable], [IsAllowAdd], [IsAllowEdit], [IsAllowDelete], [IsAllowList], [IsShowDataOptions], [IsShowTillOptions], [IsSystemPage], [ControlLevelPermission], [NotShowInPermission]) VALUES (136, 1, N'2184012856', N'AccountAdmin', 'AccountTimesheetPeriodTypes.aspx', 'Timesheet Period Types', 15, 1, 1, NULL, 1, NULL, 1, NULL, NULL, NULL, NULL, NULL)
END
-- =======================================================
-- Foreign Key Constraint Check's for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print ' Foreign Key Constraint Check''s for Table: [dbo].[SystemSecurityCategoryPage]'

ALTER TABLE [dbo].[SystemSecurityCategoryPage] CHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory]
ALTER TABLE [dbo].[SystemSecurityCategoryPage] CHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory1]

GO
If exists (select * from AccountEmployeeTimeEntryPeriod where TimeEntryViewType = 'WeekView')
Update AccountEmployeeTimeEntryPeriod Set TimeEntryViewType = 'Weekly' Where TimeEntryViewType = 'WeekView'
GO
-- Drop View vueAccountEmployee
Print 'Drop View vueAccountEmployee'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployee]
GO

-- Create Index IX_MasterWorkingDayTypeId on AccountWorkingDayType
Print 'Create Index IX_MasterWorkingDayTypeId on AccountWorkingDayType'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountWorkingDayType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountWorkingDayType]') AND name = N'IX_MasterWorkingDayTypeId'))
CREATE INDEX [IX_MasterWorkingDayTypeId]
	ON [dbo].[AccountWorkingDayType] ([MasterWorkingDayTypeId])
GO

-- Create View vueAccountEmployee
Print 'Create View vueAccountEmployee'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployee
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountEmployee.AccountId, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.Password, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountLocationId, 
                      dbo.AccountEmployee.BillingTypeId, dbo.AccountBillingType.BillingType, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountPreferences.ShowClockStartEnd, 
                      dbo.Account.TimeZoneId, dbo.AccountRole.MasterAccountRoleId, dbo.Account.DefaultCurrencyId, dbo.Account.CountryId, 
                      dbo.AccountPreferences.CultureInfoName, dbo.AccountPreferences.TimeEntryFormat, dbo.AccountEmployee.AllowedAccessFromIP, 
                      dbo.AccountRole.AccountRoleId, dbo.AccountPreferences.AccountSessionTimeout, dbo.AccountPreferences.ShowCompletedTasksInTimeSheet, 
                      dbo.AccountPreferences.CurrencySymbol, dbo.AccountPreferences.IsCompanyOwnLogo, dbo.Account.AccountExpiryActivation, 
                      dbo.Account.LicenseActivation, dbo.AccountEmployee.EmployeeTypeId, dbo.AccountEmployee.ExternalUserClientId, 
                      dbo.AccountEmployee.AccountBillingRateId, dbo.AccountPreferences.ScheduledEmailSendTime, 
                      dbo.AccountPreferences.LastScheduledEmailSentTime, dbo.AccountEmployee.Username, dbo.AccountEmployee.IsDisabled, 
                      dbo.AccountPreferences.FromEmailAddress, dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.AccountEmployee.EmployeeCode, 
                      dbo.AccountPreferences.Version, dbo.AccountPreferences.LockSubmittedRecords, dbo.AccountPreferences.LockApprovedRecords, 
                      ISNULL(dbo.AccountEmployee.EmployeeCode + '' - '', '''') 
                      + dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeNameWithCode, 
                      dbo.AccountPreferences.ShowWorkTypeInTimeSheet, dbo.AccountPreferences.NumberOfBlankRowsInTimeEntry, 
                      dbo.AccountPreferences.ShowCostCenterInTimeSheet, dbo.AccountPreferences.WeekStartDay, dbo.AccountPreferences.AccountBaseCurrencyId, 
                      dbo.AccountPreferences.UserInterfaceLanguage, dbo.AccountEmployee.EmployeeManagerId, dbo.AccountPreferences.DefaultTimeEntryMode, 
                      dbo.AccountPreferences.PageSize, dbo.AccountEmployee.TimeZoneId AS EmployeeTimeZoneId, dbo.AccountEmployee.TerminationDate, 
                      dbo.AccountEmployee.StatusId, dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.EmployeePayTypeId, dbo.AccountEmployee.HiredDate, 
                      dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountWorkingDayType, dbo.AccountWorkingDayType.HoursPerDay, 
                      dbo.AccountWorkingDayType.WeekStartDay AS EmployeeWeekStartDay, dbo.AccountPreferences.ShowClientInTimesheet, 
                      dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, 
                      dbo.AccountPreferences.ShowDescriptionInWeekView, dbo.AccountPreferences.InvoiceNoPrefix, 
                      dbo.AccountPreferences.ShowAdditionalTaskInformationType, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, ISNULL(dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, 1) 
                      AS InitialDayOfTheMonth, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, 1) 
                      AS SystemInitialDayOfFirstPeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod, 16) 
                      AS SystemInitialDayOfLastPeriod
FROM         dbo.vueAccountTimesheetPeriodType RIGHT OUTER JOIN
                      dbo.AccountWorkingDayType ON 
                      dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId = dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId RIGHT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.Account ON dbo.AccountEmployee.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId ON 
                      dbo.AccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployee.AccountId = dbo.AccountPreferences.AccountId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId'
GO

-- Create View vueAccountEmployeeWorkingDays
Print 'Create View vueAccountEmployeeWorkingDays'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeWorkingDays' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeWorkingDays
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountWorkingDay.WorkingDayNo, dbo.SystemWorkingDay.WorkingDay
FROM         dbo.AccountEmployee INNER JOIN
                      dbo.AccountWorkingDayType ON 
                      dbo.AccountEmployee.AccountWorkingDayTypeId = dbo.AccountWorkingDayType.AccountWorkingDayTypeId INNER JOIN
                      dbo.AccountWorkingDay ON dbo.AccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountWorkingDay.AccountWorkingDayTypeId INNER JOIN
                      dbo.SystemWorkingDay ON dbo.AccountWorkingDay.WorkingDayNo = dbo.SystemWorkingDay.WorkingDayNo'
GO
-- Drop View vueAccountEmployeeTimeEntry
Print 'Drop View vueAccountEmployeeTimeEntry'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntry' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntry]
GO
-- Create View vueAccountEmployeeTimeEntry
Print 'Create View vueAccountEmployeeTimeEntry'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntry' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntry
AS
SELECT     dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountProject.ProjectName, 
                      dbo.AccountProjectTask.TaskName, dbo.AccountEmployeeTimeEntry.TotalTime, dbo.AccountEmployeeTimeEntry.Approved, 
                      dbo.AccountEmployee.AccountEmployeeId, dbo.AccountProject.AccountProjectId, dbo.AccountEmployeeTimeEntry.TeamLeadApproved, 
                      dbo.AccountEmployeeTimeEntry.ProjectManagerApproved, dbo.AccountEmployeeTimeEntry.AdministratorApproved, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, dbo.AccountEmployeeTimeEntry.StartTime, dbo.AccountEmployeeTimeEntry.EndTime, 
                      dbo.AccountEmployeeTimeEntry.TimeEntryDate, dbo.AccountEmployeeTimeEntry.Description, dbo.AccountProject.AccountId, DATEPART(hh, 
                      dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime) AS TotalMinutes, DATEPART(dw, 
                      dbo.AccountEmployeeTimeEntry.TimeEntryDate) AS WeekDay, dbo.AccountParty.AccountPartyId, dbo.AccountParty.PartyName, 
                      dbo.AccountProjectTask.AccountProjectTaskId, dbo.AccountBillingType.BillingType, dbo.AccountProject.LeaderEmployeeId, 
                      dbo.AccountProject.ProjectManagerEmployeeId, dbo.AccountProject.TimeSheetApprovalTypeId, dbo.AccountProject.ExpenseApprovalTypeId, 
                      dbo.AccountProjectTask.IsBillable, dbo.AccountEmployeeTimeEntry.Rejected, dbo.AccountEmployeeTimeEntry.BillingRate, 
                      dbo.AccountProject.ProjectBillingRateTypeId, dbo.AccountEmployee.EmployeeCode, dbo.AccountEmployee.AccountDepartmentId, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountProjectTask.EstimatedCost, dbo.AccountProjectTask.EstimatedTimeSpent, 
                      dbo.AccountEmployeeTimeEntry.Submitted, dbo.AccountWorkType.AccountWorkType, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountLocation.AccountLocation, dbo.AccountCostCenter.AccountCostCenter, dbo.AccountCostCenter.AccountCostCenterCode, 
                      dbo.AccountWorkType.AccountWorkTypeCode, dbo.AccountProject.ProjectCode, dbo.AccountProjectTask.TaskCode, 
                      dbo.AccountLocation.AccountLocationId, dbo.vueAccountEmployeeTimeEntryApprovalLastAction.Comments, 
                      dbo.AccountEmployeeTimeEntry.BillingRateCurrencyId, dbo.AccountEmployeeTimeEntry.EmployeeRateCurrencyId, 
                      dbo.AccountEmployeeTimeEntry.BillingRateExchangeRate, dbo.AccountEmployeeTimeEntry.EmployeeRateExchangeRate, 
                      dbo.AccountEmployeeTimeEntry.AccountBaseCurrencyId, dbo.AccountProjectTask.AccountTaskTypeId, dbo.AccountProjectTask.TaskStatusId, 
                      dbo.AccountProjectTask.AccountPriorityId, dbo.AccountProjectTask.AccountProjectMilestoneId, dbo.AccountDepartment.DepartmentCode, 
                      dbo.AccountParty.PartyNick, dbo.AccountProjectTask.EstimatedCurrencyId, dbo.vueAccountEmployeeTimeEntryApprovalLastAction.ApprovedOn, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRate, dbo.AccountRole.AccountRoleId, dbo.AccountRole.Role, dbo.AccountProject.AccountProjectTypeId, 
                      dbo.AccountProject.ProjectDescription, dbo.AccountProjectTask.TaskDescription, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeExpenseBillingTimesheetId, dbo.AccountEmployeeTimeEntry.Billed, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Submitted = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS SubmittedHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Approved = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS ApprovedHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Rejected = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS RejectedHours, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType
FROM         dbo.AccountEmployeeTimeEntry INNER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeEntry.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId INNER JOIN
                      dbo.AccountProjectTask ON dbo.AccountEmployeeTimeEntry.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryPeriod ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId LEFT
                       OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId LEFT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryApprovalLastAction.AccountEmployeeTimeEntryId LEFT
                       OUTER JOIN
                      dbo.AccountCostCenter ON dbo.AccountEmployeeTimeEntry.AccountCostCenterId = dbo.AccountCostCenter.AccountCostCenterId LEFT OUTER JOIN
                      dbo.AccountWorkType ON dbo.AccountEmployeeTimeEntry.AccountWorkTypeId = dbo.AccountWorkType.AccountWorkTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId LEFT OUTER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId'

GO
-- Drop View vueAccountEmployeeTimeEntry
Print 'Drop View vueAccountEmployeeTimeEntry'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntry' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntry]

GO
-- Create View vueAccountEmployeeTimeEntry
Print 'Create View vueAccountEmployeeTimeEntry'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntry' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntry
AS
SELECT     dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountProject.ProjectName, dbo.AccountProjectTask.TaskName, 
                      dbo.AccountEmployeeTimeEntry.TotalTime, dbo.AccountEmployeeTimeEntry.Approved, dbo.AccountEmployee.AccountEmployeeId, 
                      dbo.AccountProject.AccountProjectId, dbo.AccountEmployeeTimeEntry.TeamLeadApproved, dbo.AccountEmployeeTimeEntry.ProjectManagerApproved, 
                      dbo.AccountEmployeeTimeEntry.AdministratorApproved, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, dbo.AccountEmployeeTimeEntry.StartTime, 
                      dbo.AccountEmployeeTimeEntry.EndTime, dbo.AccountEmployeeTimeEntry.TimeEntryDate, dbo.AccountEmployeeTimeEntry.Description, 
                      dbo.AccountProject.AccountId, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      AS TotalMinutes, DATEPART(dw, dbo.AccountEmployeeTimeEntry.TimeEntryDate) AS WeekDay, dbo.AccountParty.AccountPartyId, dbo.AccountParty.PartyName, 
                      dbo.AccountProjectTask.AccountProjectTaskId, dbo.AccountBillingType.BillingType, dbo.AccountProject.LeaderEmployeeId, 
                      dbo.AccountProject.ProjectManagerEmployeeId, dbo.AccountProject.TimeSheetApprovalTypeId, dbo.AccountProject.ExpenseApprovalTypeId, 
                      dbo.AccountProjectTask.IsBillable, dbo.AccountEmployeeTimeEntry.Rejected, dbo.AccountEmployeeTimeEntry.BillingRate, 
                      dbo.AccountProject.ProjectBillingRateTypeId, dbo.AccountEmployee.EmployeeCode, dbo.AccountEmployee.AccountDepartmentId, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountProjectTask.EstimatedCost, dbo.AccountProjectTask.EstimatedTimeSpent, 
                      dbo.AccountEmployeeTimeEntry.Submitted, dbo.AccountWorkType.AccountWorkType, dbo.AccountEmployee.EMailAddress, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountCostCenter.AccountCostCenter, dbo.AccountCostCenter.AccountCostCenterCode, dbo.AccountWorkType.AccountWorkTypeCode, 
                      dbo.AccountProject.ProjectCode, dbo.AccountProjectTask.TaskCode, dbo.AccountLocation.AccountLocationId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction.Comments, dbo.AccountEmployeeTimeEntry.BillingRateCurrencyId, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateCurrencyId, dbo.AccountEmployeeTimeEntry.BillingRateExchangeRate, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateExchangeRate, dbo.AccountEmployeeTimeEntry.AccountBaseCurrencyId, dbo.AccountProjectTask.AccountTaskTypeId, 
                      dbo.AccountProjectTask.TaskStatusId, dbo.AccountProjectTask.AccountPriorityId, dbo.AccountProjectTask.AccountProjectMilestoneId, 
                      dbo.AccountDepartment.DepartmentCode, dbo.AccountParty.PartyNick, dbo.AccountProjectTask.EstimatedCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction.ApprovedOn, dbo.AccountEmployeeTimeEntry.EmployeeRate, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountRole.Role, dbo.AccountProject.AccountProjectTypeId, dbo.AccountProject.ProjectDescription, dbo.AccountProjectTask.TaskDescription, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeExpenseBillingTimesheetId, dbo.AccountEmployeeTimeEntry.Billed, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Submitted = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS SubmittedHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Approved = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS ApprovedHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Rejected = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS RejectedHours, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, 
                      dbo.AccountPartyContact.FirstName + N'' '' + dbo.AccountPartyContact.LastName AS ClientContactName, 
                      dbo.AccountPartyDepartment.PartyDepartmentCode AS ClientDepartmentCode, dbo.AccountPartyDepartment.PartyDepartmentName AS ClientDepartmentName, 
                      dbo.AccountPartyDepartment.PartyDepartmentLocation AS ClientDepartmentLocation
FROM         dbo.AccountEmployeeTimeEntry INNER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeEntry.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId INNER JOIN
                      dbo.AccountProjectTask ON dbo.AccountEmployeeTimeEntry.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId LEFT OUTER JOIN
                      dbo.AccountPartyDepartment ON dbo.AccountProject.AccountPartyDepartmentId = dbo.AccountPartyDepartment.AccountPartyDepartmentId LEFT OUTER JOIN
                      dbo.AccountPartyContact ON dbo.AccountProject.AccountPartyContactId = dbo.AccountPartyContact.AccountPartyContactId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryPeriod ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId LEFT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryApprovalLastAction.AccountEmployeeTimeEntryId LEFT OUTER JOIN
                      dbo.AccountCostCenter ON dbo.AccountEmployeeTimeEntry.AccountCostCenterId = dbo.AccountCostCenter.AccountCostCenterId LEFT OUTER JOIN
                      dbo.AccountWorkType ON dbo.AccountEmployeeTimeEntry.AccountWorkTypeId = dbo.AccountWorkType.AccountWorkTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId LEFT OUTER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId'

GO
-- Drop View vueAccountProjectsOnlyForReport
Print 'Drop View vueAccountProjectsOnlyForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountProjectsOnlyForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountProjectsOnlyForReport]
GO
-- Drop View vueAccountProjectsForReport
Print 'Drop View vueAccountProjectsForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountProjectsForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountProjectsForReport]
GO
-- Drop View rptvueAccountProjects
Print 'Drop View rptvueAccountProjects'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountProjects' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountProjects]
GO
-- Create View vueAccountProjectsOnlyForReport
Print 'Create View vueAccountProjectsOnlyForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountProjectsOnlyForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountProjectsOnlyForReport
AS
SELECT     dbo.AccountProject.AccountProjectId, dbo.AccountProject.AccountId, dbo.AccountProject.AccountProjectTypeId, dbo.AccountProject.AccountClientId, 
                      dbo.AccountProject.ProjectBillingTypeId, dbo.AccountProject.ProjectName, dbo.AccountProject.ProjectDescription, dbo.AccountProject.StartDate, 
                      dbo.AccountProject.AccountMilestoneId, dbo.AccountProject.Deadline, dbo.AccountProject.LeaderEmployeeId, dbo.AccountProject.ProjectManagerEmployeeId, 
                      dbo.AccountProject.EstimatedTime, dbo.AccountProject.EstimatedDurationUnit, dbo.AccountProject.ProjectCode, dbo.AccountProject.DefaultBillingRate, 
                      dbo.AccountProject.IsActive, dbo.AccountProject.ProjectStatusId, dbo.AccountProject.AccountPriorityId, dbo.AccountProject.CreatedOn, 
                      dbo.AccountProject.CreatedByEmployeeId, dbo.AccountProject.ModifiedOn, dbo.AccountProject.ModifiedByEmployeeId, dbo.AccountProject.ProjectBillingRateTypeId, 
                      dbo.AccountProject.TimeSheetApprovalTypeId, dbo.AccountProject.ExpenseApprovalTypeId, dbo.AccountProject.AccountPartyContactId AS AccountClientContactId, 
                      dbo.AccountProject.AccountPartyDepartmentId AS AccountClientDepartmentId, dbo.AccountProject.IsDisabled, dbo.AccountProject.IsTemplate, 
                      dbo.AccountProject.IsProject, dbo.AccountProject.AccountProjectTemplateId, dbo.AccountParty.PartyNick AS ClientNick, dbo.AccountParty.PartyName AS ClientName, 
                      dbo.AccountProjectType.ProjectType, dbo.AccountBillingType.BillingType, dbo.AccountStatus.Status, CONVERT(nvarchar(200), dbo.AccountProject.EstimatedDuration) 
                      AS EstimatedDuration, dbo.AccountPartyDepartment.PartyDepartmentCode AS ClientDepartmentCode, 
                      dbo.AccountPartyDepartment.PartyDepartmentName AS ClientDepartmentName, dbo.AccountPartyDepartment.PartyDepartmentLocation AS ClientDepartmentLocation, 
                      dbo.AccountPartyContact.FirstName + '' '' + dbo.AccountPartyContact.LastName AS ClientContactName, 
                      AccountApprovalType_1.ApprovalTypeName AS ExpenseApprovalTypeName, dbo.AccountApprovalType.ApprovalTypeName AS TimesheetApprovalTypeName, 
                      AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName AS TeamLead, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS ProjectManager, 
                      dbo.SystemProjectBillingRateType.SystemProjectBillingRateType AS ProjectBillingRateType
FROM         dbo.AccountPartyContact RIGHT OUTER JOIN
                      dbo.AccountProject INNER JOIN
                      dbo.Account ON dbo.AccountProject.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId AND dbo.Account.AccountId = dbo.AccountParty.AccountId INNER JOIN
                      dbo.AccountProjectType ON dbo.AccountProject.AccountProjectTypeId = dbo.AccountProjectType.AccountProjectTypeId AND 
                      dbo.Account.AccountId = dbo.AccountProjectType.AccountId INNER JOIN
                      dbo.AccountBillingType ON dbo.AccountProject.ProjectBillingTypeId = dbo.AccountBillingType.AccountBillingTypeId AND 
                      dbo.Account.AccountId = dbo.AccountBillingType.AccountId INNER JOIN
                      dbo.AccountStatus ON dbo.AccountProject.ProjectStatusId = dbo.AccountStatus.AccountStatusId AND 
                      dbo.Account.AccountId = dbo.AccountStatus.AccountId LEFT OUTER JOIN
                      dbo.SystemProjectBillingRateType ON 
                      dbo.AccountProject.ProjectBillingRateTypeId = dbo.SystemProjectBillingRateType.SystemProjectBillingRateTypeId LEFT OUTER JOIN
                      dbo.AccountEmployee ON dbo.AccountProject.ProjectManagerEmployeeId = dbo.AccountEmployee.AccountEmployeeId AND 
                      dbo.Account.AccountId = dbo.AccountEmployee.AccountId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON dbo.AccountProject.LeaderEmployeeId = AccountEmployee_1.AccountEmployeeId AND 
                      dbo.Account.AccountId = AccountEmployee_1.AccountId LEFT OUTER JOIN
                      dbo.AccountApprovalType ON dbo.AccountProject.TimeSheetApprovalTypeId = dbo.AccountApprovalType.AccountApprovalTypeId AND 
                      dbo.Account.AccountId = dbo.AccountApprovalType.AccountId LEFT OUTER JOIN
                      dbo.AccountApprovalType AS AccountApprovalType_1 ON dbo.AccountProject.ExpenseApprovalTypeId = AccountApprovalType_1.AccountApprovalTypeId AND 
                      dbo.Account.AccountId = AccountApprovalType_1.AccountId LEFT OUTER JOIN
                      dbo.AccountPartyDepartment ON dbo.AccountProject.AccountPartyDepartmentId = dbo.AccountPartyDepartment.AccountPartyDepartmentId ON 
                      dbo.AccountPartyContact.AccountPartyContactId = dbo.AccountProject.AccountPartyContactId
WHERE     (dbo.AccountProject.IsTemplate <> 1)'

GO
-- Create View vueAccountProjectsForReport
Print 'Create View vueAccountProjectsForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountProjectsForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountProjectsForReport
AS
SELECT     dbo.vueAccountProjectsOnlyForReport.AccountProjectId, dbo.vueAccountProjectsOnlyForReport.AccountId, 
                      dbo.vueAccountProjectsOnlyForReport.AccountProjectTypeId, dbo.vueAccountProjectsOnlyForReport.AccountClientId, 
                      dbo.vueAccountProjectsOnlyForReport.ProjectBillingTypeId, dbo.vueAccountProjectsOnlyForReport.ProjectName, 
                      dbo.vueAccountProjectsOnlyForReport.ProjectDescription, dbo.vueAccountProjectsOnlyForReport.StartDate, 
                      dbo.vueAccountProjectsOnlyForReport.AccountMilestoneId, dbo.vueAccountProjectsOnlyForReport.Deadline, 
                      dbo.vueAccountProjectsOnlyForReport.LeaderEmployeeId, dbo.vueAccountProjectsOnlyForReport.ProjectManagerEmployeeId, 
                      dbo.vueAccountProjectsOnlyForReport.EstimatedTime, dbo.vueAccountProjectsOnlyForReport.EstimatedDurationUnit, 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.ProjectCode, N'''') AS ProjectCode, dbo.vueAccountProjectsOnlyForReport.DefaultBillingRate, 
                      dbo.vueAccountProjectsOnlyForReport.IsActive, dbo.vueAccountProjectsOnlyForReport.ProjectStatusId, 
                      dbo.vueAccountProjectsOnlyForReport.AccountPriorityId, dbo.vueAccountProjectsOnlyForReport.CreatedOn, 
                      dbo.vueAccountProjectsOnlyForReport.CreatedByEmployeeId, dbo.vueAccountProjectsOnlyForReport.ModifiedOn, 
                      dbo.vueAccountProjectsOnlyForReport.ModifiedByEmployeeId, dbo.vueAccountProjectsOnlyForReport.ProjectBillingRateTypeId, 
                      dbo.vueAccountProjectsOnlyForReport.TimeSheetApprovalTypeId, dbo.vueAccountProjectsOnlyForReport.ExpenseApprovalTypeId, 
                      dbo.vueAccountProjectsOnlyForReport.IsDisabled, dbo.vueAccountProjectsOnlyForReport.IsTemplate, dbo.vueAccountProjectsOnlyForReport.IsProject, 
                      dbo.vueAccountProjectsOnlyForReport.AccountProjectTemplateId, ISNULL(dbo.vueAccountProjectsOnlyForReport.ClientNick, N'''') AS ClientNick, 
                      dbo.vueAccountProjectsOnlyForReport.ClientName, dbo.vueAccountProjectsOnlyForReport.ProjectType, 
                      dbo.vueAccountProjectsOnlyForReport.BillingType, dbo.vueAccountProjectsOnlyForReport.Status, 
                      dbo.vueAccountProjectsOnlyForReport.EstimatedDuration + '' - '' + dbo.vueAccountProjectsOnlyForReport.EstimatedDurationUnit AS EstimatedDuration, 
                      dbo.vueAccountProjectsOnlyForReport.AccountClientContactId, dbo.vueAccountProjectsOnlyForReport.AccountClientDepartmentId, 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.ClientDepartmentCode, N'''') AS ClientDepartmentCode, 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.ClientDepartmentName, N'''') AS ClientDepartmentName, 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.ClientDepartmentLocation, N'''') AS ClientDepartmentLocation, 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.ExpenseApprovalTypeName, N'''') AS ExpenseApprovalTypeName, 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.TimesheetApprovalTypeName, N'''') AS TimesheetApprovalTypeName, 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.ClientContactName, N'''') AS ClientContactName, dbo.vueAccountProjectsOnlyForReport.TeamLead, 
                      dbo.vueAccountProjectsOnlyForReport.ProjectManager, dbo.vueAccountProjectsOnlyForReport.ProjectBillingRateType, 
                      SUM(dbo.rptvueAccountEmployeeTimeEntry.BillableTotalHours) AS BillableTotalHours, 
                      SUM(dbo.rptvueAccountEmployeeTimeEntry.NonBillableTotalHours) AS NonBillableTotalHours, 
                      SUM(dbo.rptvueAccountEmployeeTimeEntry.EmployeeCost) AS TotalEmployeeCost, SUM(dbo.rptvueAccountEmployeeTimeEntry.Amount) 
                      AS TotalTimeBillingAmount
FROM         dbo.vueAccountProjectsOnlyForReport LEFT OUTER JOIN
                      dbo.rptvueAccountEmployeeTimeEntry ON 
                      dbo.vueAccountProjectsOnlyForReport.AccountProjectId = dbo.rptvueAccountEmployeeTimeEntry.AccountProjectId
GROUP BY dbo.vueAccountProjectsOnlyForReport.AccountProjectId, dbo.vueAccountProjectsOnlyForReport.AccountId, 
                      dbo.vueAccountProjectsOnlyForReport.AccountProjectTypeId, dbo.vueAccountProjectsOnlyForReport.AccountClientId, 
                      dbo.vueAccountProjectsOnlyForReport.ProjectBillingTypeId, dbo.vueAccountProjectsOnlyForReport.ProjectName, 
                      dbo.vueAccountProjectsOnlyForReport.ProjectDescription, dbo.vueAccountProjectsOnlyForReport.StartDate, 
                      dbo.vueAccountProjectsOnlyForReport.AccountMilestoneId, dbo.vueAccountProjectsOnlyForReport.Deadline, 
                      dbo.vueAccountProjectsOnlyForReport.LeaderEmployeeId, dbo.vueAccountProjectsOnlyForReport.ProjectManagerEmployeeId, 
                      dbo.vueAccountProjectsOnlyForReport.EstimatedTime, dbo.vueAccountProjectsOnlyForReport.EstimatedDurationUnit, 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.ProjectCode, N''''), dbo.vueAccountProjectsOnlyForReport.DefaultBillingRate, 
                      dbo.vueAccountProjectsOnlyForReport.IsActive, dbo.vueAccountProjectsOnlyForReport.ProjectStatusId, 
                      dbo.vueAccountProjectsOnlyForReport.AccountPriorityId, dbo.vueAccountProjectsOnlyForReport.CreatedOn, 
                      dbo.vueAccountProjectsOnlyForReport.CreatedByEmployeeId, dbo.vueAccountProjectsOnlyForReport.ModifiedOn, 
                      dbo.vueAccountProjectsOnlyForReport.ModifiedByEmployeeId, dbo.vueAccountProjectsOnlyForReport.ProjectBillingRateTypeId, 
                      dbo.vueAccountProjectsOnlyForReport.TimeSheetApprovalTypeId, dbo.vueAccountProjectsOnlyForReport.ExpenseApprovalTypeId, 
                      dbo.vueAccountProjectsOnlyForReport.IsDisabled, dbo.vueAccountProjectsOnlyForReport.IsTemplate, dbo.vueAccountProjectsOnlyForReport.IsProject, 
                      dbo.vueAccountProjectsOnlyForReport.AccountProjectTemplateId, ISNULL(dbo.vueAccountProjectsOnlyForReport.ClientNick, N''''), 
                      dbo.vueAccountProjectsOnlyForReport.ClientName, dbo.vueAccountProjectsOnlyForReport.ProjectType, 
                      dbo.vueAccountProjectsOnlyForReport.BillingType, dbo.vueAccountProjectsOnlyForReport.Status, 
                      dbo.vueAccountProjectsOnlyForReport.EstimatedDuration + '' - '' + dbo.vueAccountProjectsOnlyForReport.EstimatedDurationUnit, 
                      dbo.vueAccountProjectsOnlyForReport.AccountClientContactId, dbo.vueAccountProjectsOnlyForReport.AccountClientDepartmentId, 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.ClientDepartmentCode, N''''), ISNULL(dbo.vueAccountProjectsOnlyForReport.ClientDepartmentName, N''''), 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.ClientDepartmentLocation, N''''), 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.ExpenseApprovalTypeName, N''''), 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.TimesheetApprovalTypeName, N''''), ISNULL(dbo.vueAccountProjectsOnlyForReport.ClientContactName, 
                      N''''), dbo.vueAccountProjectsOnlyForReport.TeamLead, dbo.vueAccountProjectsOnlyForReport.ProjectManager, 
                      dbo.vueAccountProjectsOnlyForReport.ProjectBillingRateType'
GO
-- Create View rptvueAccountProjects
Print 'Create View rptvueAccountProjects'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountProjects' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountProjects
AS
SELECT     dbo.vueAccountProjectsForReport.AccountProjectId, dbo.vueAccountProjectsForReport.AccountId, 
                      dbo.vueAccountProjectsForReport.AccountProjectTypeId, dbo.vueAccountProjectsForReport.AccountClientId, 
                      dbo.vueAccountProjectsForReport.ProjectBillingTypeId, dbo.vueAccountProjectsForReport.ProjectName, 
                      dbo.vueAccountProjectsForReport.ProjectDescription, dbo.vueAccountProjectsForReport.StartDate, 
                      dbo.vueAccountProjectsForReport.AccountMilestoneId, dbo.vueAccountProjectsForReport.Deadline, 
                      dbo.vueAccountProjectsForReport.LeaderEmployeeId, dbo.vueAccountProjectsForReport.ProjectManagerEmployeeId, 
                      dbo.vueAccountProjectsForReport.EstimatedTime, dbo.vueAccountProjectsForReport.EstimatedDurationUnit, 
                      dbo.vueAccountProjectsForReport.ProjectCode, dbo.vueAccountProjectsForReport.DefaultBillingRate, dbo.vueAccountProjectsForReport.IsActive, 
                      dbo.vueAccountProjectsForReport.ProjectStatusId, dbo.vueAccountProjectsForReport.AccountPriorityId, dbo.vueAccountProjectsForReport.CreatedOn, 
                      dbo.vueAccountProjectsForReport.CreatedByEmployeeId, dbo.vueAccountProjectsForReport.ModifiedOn, 
                      dbo.vueAccountProjectsForReport.ModifiedByEmployeeId, dbo.vueAccountProjectsForReport.ProjectBillingRateTypeId, 
                      dbo.vueAccountProjectsForReport.TimeSheetApprovalTypeId, dbo.vueAccountProjectsForReport.ExpenseApprovalTypeId, 
                      dbo.vueAccountProjectsForReport.IsDisabled, dbo.vueAccountProjectsForReport.IsTemplate, dbo.vueAccountProjectsForReport.IsProject, 
                      dbo.vueAccountProjectsForReport.AccountProjectTemplateId, dbo.vueAccountProjectsForReport.ClientNick, 
                      dbo.vueAccountProjectsForReport.ClientName, dbo.vueAccountProjectsForReport.ProjectType, dbo.vueAccountProjectsForReport.BillingType, 
                      dbo.vueAccountProjectsForReport.Status, dbo.vueAccountProjectsForReport.EstimatedDuration, 
                      dbo.vueAccountProjectsForReport.AccountClientContactId, dbo.vueAccountProjectsForReport.AccountClientDepartmentId, 
                      dbo.vueAccountProjectsForReport.ClientDepartmentCode, dbo.vueAccountProjectsForReport.ClientDepartmentName, 
                      dbo.vueAccountProjectsForReport.ClientDepartmentLocation, dbo.vueAccountProjectsForReport.ExpenseApprovalTypeName, 
                      dbo.vueAccountProjectsForReport.TimesheetApprovalTypeName, dbo.vueAccountProjectsForReport.ClientContactName, 
                      dbo.vueAccountProjectsForReport.TeamLead, dbo.vueAccountProjectsForReport.ProjectManager, 
                      dbo.vueAccountProjectsForReport.ProjectBillingRateType, dbo.vueAccountProjectsForReport.BillableTotalHours, 
                      dbo.vueAccountProjectsForReport.NonBillableTotalHours, dbo.vueAccountProjectsForReport.TotalEmployeeCost, 
                      dbo.vueAccountProjectsForReport.TotalTimeBillingAmount, SUM(dbo.rptvueAccountProjectTasks.EstimatedCost) AS TotalTaskEstimatedCost, 
                      SUM(dbo.rptvueAccountProjectTasks.EstimatedHours) AS TotalTaskEstimatedHours
FROM         dbo.vueAccountProjectsForReport LEFT OUTER JOIN
                      dbo.rptvueAccountProjectTasks ON dbo.vueAccountProjectsForReport.AccountProjectId = dbo.rptvueAccountProjectTasks.AccountProjectId
GROUP BY dbo.vueAccountProjectsForReport.AccountProjectId, dbo.vueAccountProjectsForReport.AccountId, 
                      dbo.vueAccountProjectsForReport.AccountProjectTypeId, dbo.vueAccountProjectsForReport.AccountClientId, 
                      dbo.vueAccountProjectsForReport.ProjectBillingTypeId, dbo.vueAccountProjectsForReport.ProjectName, 
                      dbo.vueAccountProjectsForReport.ProjectDescription, dbo.vueAccountProjectsForReport.StartDate, 
                      dbo.vueAccountProjectsForReport.AccountMilestoneId, dbo.vueAccountProjectsForReport.Deadline, 
                      dbo.vueAccountProjectsForReport.LeaderEmployeeId, dbo.vueAccountProjectsForReport.ProjectManagerEmployeeId, 
                      dbo.vueAccountProjectsForReport.EstimatedTime, dbo.vueAccountProjectsForReport.EstimatedDurationUnit, 
                      dbo.vueAccountProjectsForReport.ProjectCode, dbo.vueAccountProjectsForReport.IsActive, dbo.vueAccountProjectsForReport.ProjectStatusId, 
                      dbo.vueAccountProjectsForReport.DefaultBillingRate, dbo.vueAccountProjectsForReport.AccountPriorityId, 
                      dbo.vueAccountProjectsForReport.CreatedOn, dbo.vueAccountProjectsForReport.CreatedByEmployeeId, dbo.vueAccountProjectsForReport.ModifiedOn, 
                      dbo.vueAccountProjectsForReport.ModifiedByEmployeeId, dbo.vueAccountProjectsForReport.ProjectBillingRateTypeId, 
                      dbo.vueAccountProjectsForReport.TimeSheetApprovalTypeId, dbo.vueAccountProjectsForReport.ExpenseApprovalTypeId, 
                      dbo.vueAccountProjectsForReport.IsDisabled, dbo.vueAccountProjectsForReport.IsTemplate, dbo.vueAccountProjectsForReport.IsProject, 
                      dbo.vueAccountProjectsForReport.AccountProjectTemplateId, dbo.vueAccountProjectsForReport.ClientNick, 
                      dbo.vueAccountProjectsForReport.ClientName, dbo.vueAccountProjectsForReport.ProjectType, dbo.vueAccountProjectsForReport.BillingType, 
                      dbo.vueAccountProjectsForReport.Status, dbo.vueAccountProjectsForReport.EstimatedDuration, 
                      dbo.vueAccountProjectsForReport.AccountClientContactId, dbo.vueAccountProjectsForReport.AccountClientDepartmentId, 
                      dbo.vueAccountProjectsForReport.ClientDepartmentCode, dbo.vueAccountProjectsForReport.ClientDepartmentName, 
                      dbo.vueAccountProjectsForReport.ClientDepartmentLocation, dbo.vueAccountProjectsForReport.ExpenseApprovalTypeName, 
                      dbo.vueAccountProjectsForReport.TimesheetApprovalTypeName, dbo.vueAccountProjectsForReport.ClientContactName, 
                      dbo.vueAccountProjectsForReport.TeamLead, dbo.vueAccountProjectsForReport.ProjectManager, 
                      dbo.vueAccountProjectsForReport.ProjectBillingRateType, dbo.vueAccountProjectsForReport.BillableTotalHours, 
                      dbo.vueAccountProjectsForReport.NonBillableTotalHours, dbo.vueAccountProjectsForReport.TotalEmployeeCost, 
                      dbo.vueAccountProjectsForReport.TotalTimeBillingAmount'
GO
-- Create View rptvueAccountProjectsReport
Print 'Create View rptvueAccountProjectsReport'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectsReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountProjectsReport
AS
SELECT     dbo.rptvueAccountProjects.AccountProjectId, dbo.rptvueAccountProjects.AccountId, dbo.rptvueAccountProjects.AccountProjectTypeId, 
                      dbo.rptvueAccountProjects.AccountClientId, dbo.rptvueAccountProjects.ProjectBillingTypeId, dbo.rptvueAccountProjects.ProjectName, 
                      dbo.rptvueAccountProjects.ProjectDescription, dbo.rptvueAccountProjects.StartDate, dbo.rptvueAccountProjects.AccountMilestoneId, 
                      dbo.rptvueAccountProjects.Deadline, dbo.rptvueAccountProjects.LeaderEmployeeId, dbo.rptvueAccountProjects.ProjectManagerEmployeeId, 
                      dbo.rptvueAccountProjects.EstimatedTime, dbo.rptvueAccountProjects.EstimatedDurationUnit, dbo.rptvueAccountProjects.ProjectCode, 
                      dbo.rptvueAccountProjects.DefaultBillingRate, dbo.rptvueAccountProjects.IsActive, dbo.rptvueAccountProjects.ProjectStatusId, 
                      dbo.rptvueAccountProjects.AccountPriorityId, dbo.rptvueAccountProjects.CreatedOn, dbo.rptvueAccountProjects.CreatedByEmployeeId, 
                      dbo.rptvueAccountProjects.ModifiedOn, dbo.rptvueAccountProjects.ModifiedByEmployeeId, dbo.rptvueAccountProjects.ProjectBillingRateTypeId, 
                      dbo.rptvueAccountProjects.TimeSheetApprovalTypeId, dbo.rptvueAccountProjects.ExpenseApprovalTypeId, dbo.rptvueAccountProjects.IsDisabled, 
                      dbo.rptvueAccountProjects.IsTemplate, dbo.rptvueAccountProjects.IsProject, dbo.rptvueAccountProjects.AccountProjectTemplateId, 
                      dbo.rptvueAccountProjects.ClientNick, dbo.rptvueAccountProjects.ClientName, dbo.rptvueAccountProjects.ProjectType, 
                      dbo.rptvueAccountProjects.BillingType, dbo.rptvueAccountProjects.Status, dbo.rptvueAccountProjects.EstimatedDuration, 
                      dbo.rptvueAccountProjects.AccountClientContactId, dbo.rptvueAccountProjects.AccountClientDepartmentId, 
                      dbo.rptvueAccountProjects.ClientDepartmentCode, dbo.rptvueAccountProjects.ClientDepartmentName, 
                      dbo.rptvueAccountProjects.ClientDepartmentLocation, dbo.rptvueAccountProjects.ExpenseApprovalTypeName, 
                      dbo.rptvueAccountProjects.TimesheetApprovalTypeName, dbo.rptvueAccountProjects.ClientContactName, dbo.rptvueAccountProjects.TeamLead, 
                      dbo.rptvueAccountProjects.ProjectManager, dbo.rptvueAccountProjects.ProjectBillingRateType, dbo.rptvueAccountProjects.BillableTotalHours, 
                      dbo.rptvueAccountProjects.NonBillableTotalHours, dbo.rptvueAccountProjects.TotalEmployeeCost, dbo.rptvueAccountProjects.TotalTimeBillingAmount, 
                      ISNULL(dbo.rptvueAccountProjects.TotalTaskEstimatedCost, 0) AS TotalTaskEstimatedCost, 
                      SUM(CASE WHEN dbo.rptvueAccountExpenseEntry.IsBillable = 1 THEN dbo.rptvueAccountExpenseEntry.NetAmount ELSE 0 END) 
                      AS TotalBillableExpense, SUM(CASE WHEN dbo.rptvueAccountExpenseEntry.IsBillable = 0 THEN dbo.rptvueAccountExpenseEntry.NetAmount ELSE 0 END) 
                      AS TotalNonBillableExpense, SUM(dbo.rptvueAccountExpenseEntry.NetAmount) AS NetAmount, 
                      ISNULL(dbo.rptvueAccountProjects.TotalTaskEstimatedHours, 0) AS TotalTaskEstimatedHours
FROM         dbo.rptvueAccountProjects LEFT OUTER JOIN
                      dbo.rptvueAccountExpenseEntry ON dbo.rptvueAccountProjects.AccountProjectId = dbo.rptvueAccountExpenseEntry.AccountProjectId
GROUP BY dbo.rptvueAccountProjects.AccountProjectId, dbo.rptvueAccountProjects.AccountId, dbo.rptvueAccountProjects.AccountProjectTypeId, 
                      dbo.rptvueAccountProjects.AccountClientId, dbo.rptvueAccountProjects.ProjectName, dbo.rptvueAccountProjects.ProjectBillingTypeId, 
                      dbo.rptvueAccountProjects.ProjectDescription, dbo.rptvueAccountProjects.StartDate, dbo.rptvueAccountProjects.AccountMilestoneId, 
                      dbo.rptvueAccountProjects.Deadline, dbo.rptvueAccountProjects.LeaderEmployeeId, dbo.rptvueAccountProjects.ProjectManagerEmployeeId, 
                      dbo.rptvueAccountProjects.EstimatedTime, dbo.rptvueAccountProjects.EstimatedDurationUnit, dbo.rptvueAccountProjects.ProjectCode, 
                      dbo.rptvueAccountProjects.DefaultBillingRate, dbo.rptvueAccountProjects.IsActive, dbo.rptvueAccountProjects.ProjectStatusId, 
                      dbo.rptvueAccountProjects.AccountPriorityId, dbo.rptvueAccountProjects.CreatedOn, dbo.rptvueAccountProjects.CreatedByEmployeeId, 
                      dbo.rptvueAccountProjects.ModifiedOn, dbo.rptvueAccountProjects.ModifiedByEmployeeId, dbo.rptvueAccountProjects.ProjectBillingRateTypeId, 
                      dbo.rptvueAccountProjects.TimeSheetApprovalTypeId, dbo.rptvueAccountProjects.ExpenseApprovalTypeId, dbo.rptvueAccountProjects.IsDisabled, 
                      dbo.rptvueAccountProjects.IsTemplate, dbo.rptvueAccountProjects.IsProject, dbo.rptvueAccountProjects.AccountProjectTemplateId, 
                      dbo.rptvueAccountProjects.ClientNick, dbo.rptvueAccountProjects.ClientName, dbo.rptvueAccountProjects.ProjectType, 
                      dbo.rptvueAccountProjects.BillingType, dbo.rptvueAccountProjects.Status, dbo.rptvueAccountProjects.EstimatedDuration, 
                      dbo.rptvueAccountProjects.AccountClientContactId, dbo.rptvueAccountProjects.AccountClientDepartmentId, 
                      dbo.rptvueAccountProjects.ClientDepartmentCode, dbo.rptvueAccountProjects.ClientDepartmentName, 
                      dbo.rptvueAccountProjects.ClientDepartmentLocation, dbo.rptvueAccountProjects.ExpenseApprovalTypeName, 
                      dbo.rptvueAccountProjects.TimesheetApprovalTypeName, dbo.rptvueAccountProjects.ClientContactName, dbo.rptvueAccountProjects.TeamLead, 
                      dbo.rptvueAccountProjects.ProjectManager, dbo.rptvueAccountProjects.ProjectBillingRateType, dbo.rptvueAccountProjects.BillableTotalHours, 
                      dbo.rptvueAccountProjects.NonBillableTotalHours, dbo.rptvueAccountProjects.TotalEmployeeCost, dbo.rptvueAccountProjects.TotalTimeBillingAmount, 
                      dbo.rptvueAccountProjects.TotalTaskEstimatedCost, ISNULL(dbo.rptvueAccountProjects.TotalTaskEstimatedHours, 0)'
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'
if not exists(Select * from [dbo].[SystemReportDataSourceField] where [SystemReportDataSourceFieldId] = '9f660d3d-b0ff-4767-8ca6-a62dbffe1173')
BEGIN
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('9f660d3d-b0ff-4767-8ca6-a62dbffe1173', '7e5678a3-d1bc-4bb4-8fd1-75cab80388ba', N'TotalTaskEstimatedCost', 125, 0, NULL, NULL, 22, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Total Task Estimated Cost', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('515e6355-4c97-416e-b708-4b11da92b40f', '7e5678a3-d1bc-4bb4-8fd1-75cab80388ba', N'BillableTotalHours', 125, 0, NULL, NULL, 18, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Billable Total Hours', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('cc1f098c-f117-487d-9a90-05ebc4d80fcd', '7e5678a3-d1bc-4bb4-8fd1-75cab80388ba', N'NonBillableTotalHours', 125, 0, NULL, NULL, 19, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Non Billable Total Hours', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('ffec529a-f0cb-4ac9-b182-939ca9172255', '7e5678a3-d1bc-4bb4-8fd1-75cab80388ba', N'TotalBillableExpense', 125, 0, NULL, NULL, 23, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Total Billable Expense', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('635e31aa-6fc0-4c6b-a6e5-8ed998cc711c', '7e5678a3-d1bc-4bb4-8fd1-75cab80388ba', N'TotalNonBillableExpense', 125, 0, NULL, NULL, 24, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Total Non Billable Expense', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('7d4af8e8-5197-4178-90f4-0dcd70e78cb9', '7e5678a3-d1bc-4bb4-8fd1-75cab80388ba', N'TotalEmployeeCost', 125, 0, NULL, NULL, 20, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Total Employee Cost', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('7cd392f9-dc9d-4653-b681-49b1a2a7d9c2', '7e5678a3-d1bc-4bb4-8fd1-75cab80388ba', N'TotalTimeBillingAmount', 125, 0, NULL, NULL, 21, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Total Time Billing Amount', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('ff752f93-9c67-469c-9946-62ba99f9f935', '7e5678a3-d1bc-4bb4-8fd1-75cab80388ba', N'TotalTaskEstimatedHours', 105, 0, NULL, NULL, 25, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Total Task Estimated Hours', 0, 0)
END

if exists(Select * from systemdata where Version = '3.1.7')
BEGIN
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSource]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSource]'

UPDATE [dbo].[SystemReportDataSource] SET [ReportDatasource]=N'rptvueAccountProjectsReport' WHERE [SystemReportDataSourceId]='7e5678a3-d1bc-4bb4-8fd1-75cab80388ba'

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'

UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=199 WHERE [SystemReportDataSourceFieldId]='ca7cbd0b-b3ce-419c-81f7-9502b68c74f8'
UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=29 WHERE [SystemReportDataSourceFieldId]='daf2b619-50fd-4afe-9e3b-4f48587ac18b'
UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=199 WHERE [SystemReportDataSourceFieldId]='a2ba3c2f-5ecf-4261-bfa4-e4478d6788b3'
UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=28 WHERE [SystemReportDataSourceFieldId]='bbf83e4a-27b4-46b6-900d-21f377d460ed'
UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=26 WHERE [SystemReportDataSourceFieldId]='a5b9e183-e9e0-46b8-a721-294e543579f5'
UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=27 WHERE [SystemReportDataSourceFieldId]='2710bbd5-66b0-44ba-bf41-17fbadeac5e3'
UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=30 WHERE [SystemReportDataSourceFieldId]='5d920bfb-b7f7-4bec-a6d6-13862db32199'
END
GO
Update SystemData Set Version = '3.1.8' Where Version = '3.1.7' And SystemDataId = 1
GO
-- =======================================================
-- Foreign Key Constraint Nochecks's for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print ' Foreign Key Constraint Nochecks''s for Table: [dbo].[SystemSecurityCategoryPage]'

ALTER TABLE [dbo].[SystemSecurityCategoryPage] NOCHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory]
ALTER TABLE [dbo].[SystemSecurityCategoryPage] NOCHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory1]
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemSecurityCategoryPage]'

UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemCategoryPage]=N'AccountEmployeeTimeEntryPeriodView.aspx', [SystemCategoryPageDescription]=N'Time Entry Period View' WHERE [SystemSecurityCategoryPageId]=19
GO
-- =======================================================
-- Foreign Key Constraint Check's for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print ' Foreign Key Constraint Check''s for Table: [dbo].[SystemSecurityCategoryPage]'

ALTER TABLE [dbo].[SystemSecurityCategoryPage] CHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory]
ALTER TABLE [dbo].[SystemSecurityCategoryPage] CHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory1]
GO
Update AccountPreferences Set DefaultTimeEntryMode = 'Period View'
Where DefaultTimeEntryMode = 'Week View'
GO
-- Drop View rptvueAccountEmployeeAttendance
Print 'Drop View rptvueAccountEmployeeAttendance'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeAttendance' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountEmployeeAttendance]
GO
-- Create View rptvueAccountEmployeeAttendance
Print 'Create View rptvueAccountEmployeeAttendance'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeAttendance' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountEmployeeAttendance
AS
SELECT     AbsenceDescription, AttendanceDate, [In], TimeIn, Out, TimeOut, EmployeeName, EmployeeCode, AccountEmployeeId, AccountId, 
                      REPLACE(TotalMinutes / 60, '''', ''.00'') + '':'' + RIGHT(''0'' + REPLACE(TotalMinutes - TotalMinutes / 60 * 60, '''', ''.00''), 2) AS TotalTime
FROM         dbo.vueAccountEmployeeAttendanceForReport'

GO
-- Drop Foreign Key FK_AccountTerminology_SystemTerminology from AccountTerminology
Print 'Drop Foreign Key FK_AccountTerminology_SystemTerminology from AccountTerminology'
GO
IF EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_SCHEMA='dbo' AND 

CONSTRAINT_NAME='FK_AccountTerminology_SystemTerminology' AND TABLE_NAME='AccountTerminology')
BEGIN
	ALTER TABLE [dbo].[AccountTerminology] DROP CONSTRAINT [FK_AccountTerminology_SystemTerminology]
END

GO
if exists(Select * from systemdata where Version = '3.1.8')
BEGIN
print 'delete all data from accountterminology'
Delete From AccountTerminology
END
GO
Update SystemData Set Version = '3.1.9' Where Version = '3.1.8' And SystemDataId = 1
GO

-- Drop View vueAccountEmployeeTimeEntryApprovalPendingEmailWithPreference
Print 'Drop View vueAccountEmployeeTimeEntryApprovalPendingEmailWithPreference'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryApprovalPendingEmailWithPreference' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryApprovalPendingEmailWithPreference]
GO
-- Drop View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreference
Print 'Drop View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreference'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreference' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreference]
GO
-- Drop View vueAccountEmployee
Print 'Drop View vueAccountEmployee'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployee]
GO
-- Add Column LastScheduledEmailSentTime to AccountEmployee
Print 'Add Column LastScheduledEmailSentTime to AccountEmployee'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployee' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='LastScheduledEmailSentTime' AND TABLE_NAME='AccountEmployee'))
ALTER TABLE [dbo].[AccountEmployee]
	ADD [LastScheduledEmailSentTime] datetime NULL
GO
-- Create View vueAccountEmployee
Print 'Create View vueAccountEmployee'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployee
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountEmployee.AccountId, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.Password, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountLocationId, 
                      dbo.AccountEmployee.BillingTypeId, dbo.AccountBillingType.BillingType, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountPreferences.ShowClockStartEnd, 
                      dbo.Account.TimeZoneId, dbo.AccountRole.MasterAccountRoleId, dbo.Account.DefaultCurrencyId, dbo.Account.CountryId, 
                      dbo.AccountPreferences.CultureInfoName, dbo.AccountPreferences.TimeEntryFormat, dbo.AccountEmployee.AllowedAccessFromIP, 
                      dbo.AccountRole.AccountRoleId, dbo.AccountPreferences.AccountSessionTimeout, dbo.AccountPreferences.ShowCompletedTasksInTimeSheet, 
                      dbo.AccountPreferences.CurrencySymbol, dbo.AccountPreferences.IsCompanyOwnLogo, dbo.Account.AccountExpiryActivation, 
                      dbo.Account.LicenseActivation, dbo.AccountEmployee.EmployeeTypeId, dbo.AccountEmployee.ExternalUserClientId, 
                      dbo.AccountEmployee.AccountBillingRateId, dbo.AccountPreferences.ScheduledEmailSendTime, dbo.AccountEmployee.Username, 
                      dbo.AccountEmployee.IsDisabled, dbo.AccountPreferences.FromEmailAddress, dbo.AccountPreferences.FromEmailAddressDisplayName, 
                      dbo.AccountEmployee.EmployeeCode, dbo.AccountPreferences.Version, dbo.AccountPreferences.LockSubmittedRecords, 
                      dbo.AccountPreferences.LockApprovedRecords, ISNULL(dbo.AccountEmployee.EmployeeCode + '' - '', '''') 
                      + dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeNameWithCode, 
                      dbo.AccountPreferences.ShowWorkTypeInTimeSheet, dbo.AccountPreferences.NumberOfBlankRowsInTimeEntry, 
                      dbo.AccountPreferences.ShowCostCenterInTimeSheet, dbo.AccountPreferences.WeekStartDay, dbo.AccountPreferences.AccountBaseCurrencyId, 
                      dbo.AccountPreferences.UserInterfaceLanguage, dbo.AccountEmployee.EmployeeManagerId, dbo.AccountPreferences.DefaultTimeEntryMode, 
                      dbo.AccountPreferences.PageSize, dbo.AccountEmployee.TimeZoneId AS EmployeeTimeZoneId, dbo.AccountEmployee.TerminationDate, 
                      dbo.AccountEmployee.StatusId, dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.EmployeePayTypeId, dbo.AccountEmployee.HiredDate, 
                      dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountWorkingDayType, dbo.AccountWorkingDayType.HoursPerDay, 
                      dbo.AccountWorkingDayType.WeekStartDay AS EmployeeWeekStartDay, dbo.AccountPreferences.ShowClientInTimesheet, 
                      dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, 
                      dbo.AccountPreferences.ShowDescriptionInWeekView, dbo.AccountPreferences.InvoiceNoPrefix, 
                      dbo.AccountPreferences.ShowAdditionalTaskInformationType, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, ISNULL(dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, 1) 
                      AS InitialDayOfTheMonth, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, 1) 
                      AS SystemInitialDayOfFirstPeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod, 16) AS SystemInitialDayOfLastPeriod, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime
FROM         dbo.vueAccountTimesheetPeriodType RIGHT OUTER JOIN
                      dbo.AccountWorkingDayType ON 
                      dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId = dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId RIGHT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.Account ON dbo.AccountEmployee.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId ON 
                      dbo.AccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployee.AccountId = dbo.AccountPreferences.AccountId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId'
GO
-- Create View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreference
Print 'Create View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreference'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreference' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreference
AS
SELECT     dbo.AccountPreferences.ScheduledEmailSendTime, dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, 
                      dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.AccountId, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime
FROM         dbo.AccountEMailNotificationPreference RIGHT OUTER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_2 RIGHT OUTER JOIN
                      dbo.AccountEmployee ON AccountEMailNotificationPreference_2.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId ON 
                      dbo.AccountEMailNotificationPreference.AccountId = dbo.AccountEmployee.AccountId LEFT OUTER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployee.AccountId = dbo.AccountPreferences.AccountId
WHERE     (AccountEMailNotificationPreference_2.SystemEMailNotificationId = 30) AND (AccountEMailNotificationPreference_2.Enabled = 1) AND 
                      (dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = 29) AND (dbo.AccountEMailNotificationPreference.Enabled = 1) AND 
                      (dbo.AccountEmployee.EmployeeTypeId <> 2 OR
                      dbo.AccountEmployee.EmployeeTypeId IS NULL)'
GO
-- Create View vueAccountEmployeeTimeEntryApprovalPendingEmailWithPreference
Print 'Create View vueAccountEmployeeTimeEntryApprovalPendingEmailWithPreference'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryApprovalPendingEmailWithPreference' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailWithPreference
AS
SELECT     dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountProjectId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.ProjectManagerEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.ApprovalTypeName, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountApprovalPathId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.SystemApproverTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountExternalUserId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.ApprovalPathSequence, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountEmployeeTimeEntryId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TimeSheetApprovalId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TimeSheetApprovalPathId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.ProjectName, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.ProjectDescription, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.ProjectCode, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TaskName, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountProjectTaskId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TaskDescription, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.EmployeeName, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.Approved, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TotalTime, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TimeEntryDate, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.Comments, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.IsReject, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.IsApproved, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.MaxApprovalPathSequence, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TimeEntryAccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountId, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.EMailAddress, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.ApproverEmployeeId, dbo.AccountPreferences.ScheduledEmailSendTime, 
                      dbo.AccountEmployee.EMailAddress AS ApproverEMailAddress, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.Description, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.EmployeeManagerId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.NonBillableTotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.BillableTotalMinutes, dbo.AccountPreferences.CultureInfoName, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime
FROM         dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail LEFT OUTER JOIN
                      dbo.AccountEmployee ON 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.ApproverEmployeeId = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountPreferences ON dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountId = dbo.AccountPreferences.AccountId'
GO
if exists(Select * from systemdata where Version = '3.1.9')
BEGIN
Print 'update accountreportsummary'
Update AccountReportSummary Set AccountReportGroupId = 'D48714D7-CCCA-4E7F-82DE-AD574FB9E274', IsShowGroupTotal = 1
Where AccountReportId = '4DB8FC6F-0BB7-46C9-A80A-11089EB0AEBC'
END
GO
if exists(Select * from systemdata where Version = '3.1.9')
BEGIN
Print 'update employee field LastScheduledEmailSentTime'
update accountemployee set LastScheduledEmailSentTime  = accountpreferences.lastscheduledEmailSentTime from 
accountemployee inner join accountpreferences on accountemployee.accountid = accountpreferences.accountid
where accountpreferences.lastscheduledEmailSentTime is not null
and accountemployee.LastScheduledEmailSentTime is null
END
GO
Update SystemData Set Version = '3.2.0' Where Version = '3.1.9' And SystemDataId = 1


GO
-- Drop View vueAccountTerminology
Print 'Drop View vueAccountTerminology'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountTerminology' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountTerminology]
GO
-- Drop Primary Key PK_SystemTerminology from SystemTerminology
Print 'Drop Primary Key PK_SystemTerminology from SystemTerminology'
GO
IF EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_SCHEMA='dbo' AND CONSTRAINT_NAME='PK_SystemTerminology' AND TABLE_NAME='SystemTerminology')
BEGIN
ALTER TABLE [dbo].[SystemTerminology] DROP CONSTRAINT [PK_SystemTerminology]
END
GO
-- Drop Index IX_SystemTerminologyId from AccountTerminology
Print 'Drop Index IX_SystemTerminologyId from AccountTerminology'
GO
IF (EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountTerminology' AND TABLE_TYPE='BASE TABLE')) AND (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID (N'[dbo].[AccountTerminology]') AND name = N'IX_SystemTerminologyId'))
DROP INDEX [dbo].[AccountTerminology].[IX_SystemTerminologyId]
GO
-- Drop Column ModuleName from AccountTerminology
Print 'Drop Column ModuleName from AccountTerminology'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountTerminology' AND TABLE_TYPE='BASE TABLE')) AND (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='ModuleName' AND TABLE_NAME='AccountTerminology'))
ALTER TABLE [dbo].[AccountTerminology] DROP COLUMN [ModuleName]
GO
-- Drop Column SystemTerminologyId from AccountTerminology
Print 'Drop Column SystemTerminologyId from AccountTerminology'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountTerminology' AND TABLE_TYPE='BASE TABLE')) AND (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='SystemTerminologyId' AND TABLE_NAME='AccountTerminology'))
ALTER TABLE [dbo].[AccountTerminology] DROP COLUMN [SystemTerminologyId]
GO
-- Create View vueAccountTerminology
Print 'Create View vueAccountTerminology'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountTerminology' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountTerminology
AS
SELECT     AccountTerminologyId, UserDefinedName, AccountId, CreatedByEmployeeId, ModifiedByEmployeeId, CreatedOn, ModifiedOn, TerminologyName
FROM         dbo.AccountTerminology'
GO
-- Create Index IX_UserDefinedName on AccountTerminology
Print 'Create Index IX_UserDefinedName on AccountTerminology'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountTerminology' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountTerminology]') AND name = N'IX_UserDefinedName'))
CREATE INDEX [IX_UserDefinedName]
	ON [dbo].[AccountTerminology] ([UserDefinedName])
GO
-- Create Index IX_AccountTerminologyName on AccountTerminology
Print 'Create Index IX_AccountTerminologyName on AccountTerminology'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountTerminology' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountTerminology]') AND name = N'IX_AccountTerminologyName'))
CREATE INDEX [IX_AccountTerminologyName]
	ON [dbo].[AccountTerminology] ([TerminologyName])
GO
-- Create Foreign Key FK_AccountTerminology_Account on AccountTerminology
Print 'Create Foreign Key FK_AccountTerminology_Account on AccountTerminology'
GO
IF NOT EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_SCHEMA='dbo' AND CONSTRAINT_NAME='FK_AccountTerminology_Account' AND TABLE_NAME='AccountTerminology')
BEGIN
		ALTER TABLE [dbo].[AccountTerminology]
			ADD CONSTRAINT [FK_AccountTerminology_Account]
			FOREIGN KEY ([AccountId]) REFERENCES [dbo].[Account] ([AccountId])
			ON DELETE CASCADE
END
GO
-- Drop Foreign Key FK_AccountEmployeeTimeEntryPeriod_AccountEmployee from AccountEmployeeTimeEntryPeriod
Print 'Drop Foreign Key FK_AccountEmployeeTimeEntryPeriod_AccountEmployee from AccountEmployeeTimeEntryPeriod'
GO
IF EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_SCHEMA='dbo' AND CONSTRAINT_NAME='FK_AccountEmployeeTimeEntryPeriod_AccountEmployee' AND TABLE_NAME='AccountEmployeeTimeEntryPeriod')
ALTER TABLE [dbo].[AccountEmployeeTimeEntryPeriod] DROP CONSTRAINT [FK_AccountEmployeeTimeEntryPeriod_AccountEmployee]
GO
-- Add Column ApprovedOn to AccountEmployeeTimeEntryPeriod
Print 'Add Column ApprovedOn to AccountEmployeeTimeEntryPeriod'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntryPeriod' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='ApprovedOn' AND TABLE_NAME='AccountEmployeeTimeEntryPeriod'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntryPeriod]
	ADD [ApprovedOn] datetime NULL

GO
-- Add Column ApprovedByEmployeeId to AccountEmployeeTimeEntryPeriod
Print 'Add Column ApprovedByEmployeeId to AccountEmployeeTimeEntryPeriod'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntryPeriod' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='ApprovedByEmployeeId' AND TABLE_NAME='AccountEmployeeTimeEntryPeriod'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntryPeriod]
	ADD [ApprovedByEmployeeId] int NULL

GO
-- Add Column RejectedOn to AccountEmployeeTimeEntryPeriod
Print 'Add Column RejectedOn to AccountEmployeeTimeEntryPeriod'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntryPeriod' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='RejectedOn' AND TABLE_NAME='AccountEmployeeTimeEntryPeriod'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntryPeriod]
	ADD [RejectedOn] datetime NULL

GO
-- Add Column RejectedByEmployeeId to AccountEmployeeTimeEntryPeriod
Print 'Add Column RejectedByEmployeeId to AccountEmployeeTimeEntryPeriod'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntryPeriod' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='RejectedByEmployeeId' AND TABLE_NAME='AccountEmployeeTimeEntryPeriod'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntryPeriod]
	ADD [RejectedByEmployeeId] int NULL

GO
-- Create Index IX_AccountEmployeeTimeEntryPeriod_ApprovedOn on AccountEmployeeTimeEntryPeriod
Print 'Create Index IX_AccountEmployeeTimeEntryPeriod_ApprovedOn on AccountEmployeeTimeEntryPeriod'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntryPeriod' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountEmployeeTimeEntryPeriod]') AND name = N'IX_AccountEmployeeTimeEntryPeriod_ApprovedOn'))
CREATE INDEX [IX_AccountEmployeeTimeEntryPeriod_ApprovedOn]
	ON [dbo].[AccountEmployeeTimeEntryPeriod] ([ApprovedOn])
GO
-- Create Index IX_AccountEmployeeTimeEntryPeriod_RejectedOn on AccountEmployeeTimeEntryPeriod
Print 'Create Index IX_AccountEmployeeTimeEntryPeriod_RejectedOn on AccountEmployeeTimeEntryPeriod'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntryPeriod' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountEmployeeTimeEntryPeriod]') AND name = N'IX_AccountEmployeeTimeEntryPeriod_RejectedOn'))
CREATE INDEX [IX_AccountEmployeeTimeEntryPeriod_RejectedOn]
	ON [dbo].[AccountEmployeeTimeEntryPeriod] ([RejectedOn])
GO
-- Create Index IX_AccountEmployeeTimeEntryPeriod_RejectedByEmployeeId on AccountEmployeeTimeEntryPeriod
Print 'Create Index IX_AccountEmployeeTimeEntryPeriod_RejectedByEmployeeId on AccountEmployeeTimeEntryPeriod'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntryPeriod' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountEmployeeTimeEntryPeriod]') AND name = N'IX_AccountEmployeeTimeEntryPeriod_RejectedByEmployeeId'))
CREATE INDEX [IX_AccountEmployeeTimeEntryPeriod_RejectedByEmployeeId]
	ON [dbo].[AccountEmployeeTimeEntryPeriod] ([RejectedByEmployeeId])
GO
-- Create Index IX_AccountEmployeeTimeEntryPeriod_ApprovedByEmployeeId on AccountEmployeeTimeEntryPeriod
Print 'Create Index IX_AccountEmployeeTimeEntryPeriod_ApprovedByEmployeeId on AccountEmployeeTimeEntryPeriod'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntryPeriod' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountEmployeeTimeEntryPeriod]') AND name = N'IX_AccountEmployeeTimeEntryPeriod_ApprovedByEmployeeId'))
CREATE INDEX [IX_AccountEmployeeTimeEntryPeriod_ApprovedByEmployeeId]
	ON [dbo].[AccountEmployeeTimeEntryPeriod] ([ApprovedByEmployeeId])
GO
-- Create Foreign Key FK_AccountEmployeeTimeEntryPeriod_AccountEmployee on AccountEmployeeTimeEntryPeriod
Print 'Create Foreign Key FK_AccountEmployeeTimeEntryPeriod_AccountEmployee on AccountEmployeeTimeEntryPeriod'
GO
IF NOT EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_SCHEMA='dbo' AND CONSTRAINT_NAME='FK_AccountEmployeeTimeEntryPeriod_AccountEmployee' AND TABLE_NAME='AccountEmployeeTimeEntryPeriod')
BEGIN
		ALTER TABLE [dbo].[AccountEmployeeTimeEntryPeriod]
			ADD CONSTRAINT [FK_AccountEmployeeTimeEntryPeriod_AccountEmployee]
			FOREIGN KEY ([AccountEmployeeId]) REFERENCES [dbo].[AccountEmployee] ([AccountEmployeeId])
			ON DELETE CASCADE
END
GO
-- Drop View vueAccountTimeExpenseBillingExpense
Print 'Drop View vueAccountTimeExpenseBillingExpense'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountTimeExpenseBillingExpense' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountTimeExpenseBillingExpense]
GO
-- Drop View vueAccountTimeExpenseBillingTimesheet
Print 'Drop View vueAccountTimeExpenseBillingTimesheet'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountTimeExpenseBillingTimesheet' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountTimeExpenseBillingTimesheet]
GO
-- Create View vueAccountTimeExpenseBillingTimesheet
Print 'Create View vueAccountTimeExpenseBillingTimesheet'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountTimeExpenseBillingTimesheet' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountTimeExpenseBillingTimesheet
AS
SELECT     dbo.AccountProject.AccountClientId, dbo.AccountProject.ProjectName, dbo.AccountProjectTask.TaskName, 
                      dbo.AccountProjectTask.AccountProjectTaskId, dbo.AccountProject.AccountProjectId, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeExpenseBillingTimesheetId, dbo.AccountEmployeeTimeEntry.BillingRate, 
                      dbo.AccountEmployeeTimeEntry.BillingRateCurrencyId, dbo.AccountTimeExpenseBillingTimesheet.Description, 
                      dbo.AccountEmployeeTimeEntry.Approved, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, 
                      dbo.AccountEmployeeTimeEntry.TotalTime) AS TotalMinutes, ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) AS TotalHours, dbo.AccountEmployeeTimeEntry.BillingRate * DATEPART(hh, 
                      dbo.AccountEmployeeTimeEntry.TotalTime) AS Amount, dbo.AccountEmployeeTimeEntry.TimeEntryDate, 
                      dbo.AccountTimeExpenseBillingTimesheet.BillHours, dbo.AccountTimeExpenseBillingTimesheet.ActualBillingRate, 
                      dbo.AccountTimeExpenseBillingTimesheet.TotalAmount, dbo.AccountTimeExpenseBillingTimesheet.AccountTaxCodeId1, 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountTaxCodeId2, dbo.AccountTimeExpenseBilling.SubTotal, dbo.AccountTimeExpenseBilling.TaxCode1, 
                      dbo.AccountTimeExpenseBilling.TaxCode2, dbo.AccountTimeExpenseBilling.GrandTotal, dbo.AccountParty.PartyNick, 
                      dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId, dbo.AccountEmployeeTimeEntry.Billed, 
                      dbo.AccountEmployeeTimeEntry.BillingRateExchangeRate, dbo.AccountProjectTask.IsBillable
FROM         dbo.AccountTimeExpenseBillingTimesheet RIGHT OUTER JOIN
                      dbo.AccountTimeExpenseBilling ON 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingId = dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId RIGHT OUTER
                       JOIN
                      dbo.AccountProjectTask INNER JOIN
                      dbo.AccountProject ON dbo.AccountProjectTask.AccountProjectId = dbo.AccountProject.AccountProjectId INNER JOIN
                      dbo.AccountEmployeeTimeEntry ON dbo.AccountProjectTask.AccountProjectTaskId = dbo.AccountEmployeeTimeEntry.AccountProjectTaskId AND 
                      dbo.AccountProject.AccountProjectId = dbo.AccountEmployeeTimeEntry.AccountProjectId ON 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingTimesheetId = dbo.AccountEmployeeTimeEntry.AccountTimeExpenseBillingTimesheetId
                       AND dbo.AccountTimeExpenseBillingTimesheet.AccountProjectId = dbo.AccountEmployeeTimeEntry.AccountProjectId AND 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountProjectTaskId = dbo.AccountEmployeeTimeEntry.AccountProjectTaskId RIGHT OUTER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId
WHERE     (dbo.AccountEmployeeTimeEntry.Approved = 1) AND (dbo.AccountEmployeeTimeEntry.Billed <> 1)'
GO
-- Create View vueAccountTimeExpenseBillingExpense
Print 'Create View vueAccountTimeExpenseBillingExpense'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountTimeExpenseBillingExpense' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountTimeExpenseBillingExpense
AS
SELECT     dbo.AccountExpenseEntry.Billed, dbo.AccountProject.ProjectName, dbo.AccountProject.AccountClientId, dbo.AccountProject.AccountProjectId, 
                      dbo.AccountExpense.AccountExpenseName, dbo.AccountExpenseType.ExpenseType, 
                      dbo.AccountExpenseEntry.AccountTimeExpenseBillingExpenseId, dbo.AccountExpenseEntry.AccountExpenseEntryDate, 
                      dbo.AccountExpenseType.AccountExpenseTypeId, dbo.AccountExpense.AccountExpenseId, 
                      dbo.AccountTimeExpenseBillingExpense.BilledExpenseAmount, dbo.AccountTimeExpenseBillingExpense.Description, 
                      dbo.AccountExpenseEntry.Approved, dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId, dbo.AccountExpenseEntry.Amount, 
                      dbo.AccountExpenseEntry.ExchangeRate, dbo.AccountTimeExpenseBillingExpense.ActualExpenseAmount, 
                      dbo.AccountTimeExpenseBillingExpense.AccountTaxCodeId1, dbo.AccountTimeExpenseBillingExpense.AccountTaxCodeId2, 
                      dbo.AccountTimeExpenseBillingExpense.TaxCode1, dbo.AccountTimeExpenseBillingExpense.TaxCode2, dbo.AccountExpenseEntry.IsBillable
FROM         dbo.AccountTimeExpenseBillingExpense INNER JOIN
                      dbo.AccountTimeExpenseBilling ON 
                      dbo.AccountTimeExpenseBillingExpense.AccountTimeExpenseBillingId = dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId RIGHT OUTER
                       JOIN
                      dbo.AccountExpenseEntry INNER JOIN
                      dbo.AccountProject ON dbo.AccountExpenseEntry.AccountProjectId = dbo.AccountProject.AccountProjectId INNER JOIN
                      dbo.AccountExpense ON dbo.AccountExpenseEntry.AccountExpenseId = dbo.AccountExpense.AccountExpenseId INNER JOIN
                      dbo.AccountExpenseType ON dbo.AccountExpenseType.AccountExpenseTypeId = dbo.AccountExpense.AccountExpenseTypeId RIGHT OUTER JOIN
                      dbo.AccountParty ON dbo.AccountParty.AccountPartyId = dbo.AccountProject.AccountClientId ON 
                      dbo.AccountTimeExpenseBillingExpense.AccountTimeExpenseBillingExpenseId = dbo.AccountExpenseEntry.AccountTimeExpenseBillingExpenseId AND
                       dbo.AccountTimeExpenseBillingExpense.AccountProjectId = dbo.AccountExpenseEntry.AccountProjectId AND 
                      dbo.AccountTimeExpenseBillingExpense.AccountExpenseId = dbo.AccountExpenseEntry.AccountExpenseId
WHERE     (dbo.AccountExpenseEntry.Approved = 1) AND (dbo.AccountExpenseEntry.Billed <> 1)'
GO
-- Drop View vueTimeBillingWorksheet
Print 'Drop View vueTimeBillingWorksheet'
GO
if exists (select * from information_schema.tables where table_name = 'vueTimeBillingWorksheet' and table_type = 'VIEW')
DROP VIEW [dbo].[vueTimeBillingWorksheet]
GO
-- Drop View vueExpenseBillingWorksheet
Print 'Drop View vueExpenseBillingWorksheet'
GO
if exists (select * from information_schema.tables where table_name = 'vueExpenseBillingWorksheet' and table_type = 'VIEW')
DROP VIEW [dbo].[vueExpenseBillingWorksheet]
GO
-- Create View vueExpenseBillingWorksheet
Print 'Create View vueExpenseBillingWorksheet'
GO
if not exists (select * from information_schema.tables where table_name = 'vueExpenseBillingWorksheet' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueExpenseBillingWorksheet
AS
SELECT     dbo.vueAccountExpenseEntry.EmployeeName, dbo.vueAccountExpenseEntry.AccountExpenseName, dbo.vueAccountExpenseEntry.ProjectName, 
                      dbo.vueAccountExpenseEntry.AccountExpenseEntryId, dbo.vueAccountExpenseEntry.AccountExpenseEntryDate, 
                      dbo.vueAccountExpenseEntry.AccountId, dbo.vueAccountExpenseEntry.AccountEmployeeId, dbo.vueAccountExpenseEntry.AccountProjectId, 
                      dbo.vueAccountExpenseEntry.AccountExpenseId, dbo.vueAccountExpenseEntry.Amount AS ExpenseAmount, 
                      dbo.vueAccountExpenseEntry.TeamLeadApproved, dbo.vueAccountExpenseEntry.ProjectManagerApproved, 
                      dbo.vueAccountExpenseEntry.AdministratorApproved, dbo.vueAccountExpenseEntry.Approved, dbo.vueAccountExpenseEntry.CreatedOn, 
                      dbo.vueAccountExpenseEntry.CreatedByEmployeeId, dbo.vueAccountExpenseEntry.ModifiedOn, dbo.vueAccountExpenseEntry.ModifiedByEmployeeId,
                       dbo.vueAccountExpenseEntry.PartyName, dbo.vueAccountExpenseEntry.AccountClientId, dbo.vueAccountExpenseEntry.Description, 
                      dbo.vueAccountExpenseEntry.ExpenseType, dbo.vueAccountExpenseEntry.AccountExpenseTypeId, dbo.vueAccountExpenseEntry.LeaderEmployeeId, 
                      dbo.vueAccountExpenseEntry.IsBillable, dbo.vueAccountExpenseEntry.Rejected, dbo.vueAccountExpenseEntry.EmployeeCode, 
                      dbo.vueAccountExpenseEntry.Reimburse, dbo.vueAccountExpenseEntry.AccountCurrencyId, dbo.vueAccountExpenseEntry.CurrencyCode, 
                      dbo.vueAccountExpenseEntry.IsQuantityField, dbo.vueAccountExpenseEntry.QuantityFieldCaption, 
                      dbo.vueAccountExpenseEntry.AccountBaseCurrencyId, dbo.vueAccountExpenseEntry.ExchangeRate, dbo.vueAccountExpenseEntry.TaxAmount, 
                      dbo.vueAccountExpenseEntry.NetAmount, dbo.vueAccountExpenseEntry.Submitted, dbo.vueAccountExpenseEntry.TimeSheetApprovalTypeId, 
                      dbo.vueAccountExpenseEntry.ExpenseApprovalTypeId, dbo.vueAccountExpenseEntry.ProjectManagerEmployeeId, 
                      dbo.vueAccountExpenseEntry.TimeSheetApprovalPathId, dbo.vueAccountExpenseEntry.EMailAddress, dbo.vueAccountExpenseEntry.DepartmentName,
                       dbo.vueAccountExpenseEntry.AccountLocation, dbo.vueAccountExpenseEntry.AccountTaxZone, dbo.vueAccountExpenseEntry.Quantity, 
                      dbo.vueAccountExpenseEntry.Rate, dbo.vueAccountExpenseEntry.PaymentMethod, dbo.vueAccountExpenseEntry.AccountLocationId, 
                      dbo.vueAccountExpenseEntry.Billed, dbo.vueAccountExpenseEntry.AccountTimeExpenseBillingExpenseId, 
                      dbo.AccountTimeExpenseBilling.InvoiceNumber, dbo.AccountTimeExpenseBilling.InvoiceDate, dbo.AccountTimeExpenseBilling.PONumber, 
                      dbo.AccountTimeExpenseBilling.SubTotal, dbo.AccountTimeExpenseBilling.TaxCode1, dbo.AccountTimeExpenseBilling.TaxCode2, 
                      dbo.AccountTimeExpenseBilling.GrandTotal, dbo.AccountTimeExpenseBilling.BillingCycleStartDate, 
                      dbo.AccountTimeExpenseBilling.BillingCycleEndDate
FROM         dbo.AccountProject INNER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId RIGHT OUTER JOIN
                      dbo.vueAccountExpenseEntry ON dbo.AccountProject.AccountProjectId = dbo.vueAccountExpenseEntry.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountTimeExpenseBilling INNER JOIN
                      dbo.AccountTimeExpenseBillingExpense ON 
                      dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId = dbo.AccountTimeExpenseBillingExpense.AccountTimeExpenseBillingId ON 
                      dbo.vueAccountExpenseEntry.AccountTimeExpenseBillingExpenseId = dbo.AccountTimeExpenseBillingExpense.AccountTimeExpenseBillingExpenseId
WHERE     (dbo.vueAccountExpenseEntry.IsBillable = 1) AND (dbo.vueAccountExpenseEntry.Approved = 1)'
GO
-- Create View vueTimeBillingWorksheet
Print 'Create View vueTimeBillingWorksheet'
GO
if not exists (select * from information_schema.tables where table_name = 'vueTimeBillingWorksheet' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueTimeBillingWorksheet
AS
SELECT     dbo.vueAccountEmployeeTimeEntry.EmployeeName, dbo.vueAccountEmployeeTimeEntry.ProjectName, 
                      dbo.vueAccountEmployeeTimeEntry.TaskName, dbo.vueAccountEmployeeTimeEntry.TotalTime, dbo.vueAccountEmployeeTimeEntry.Approved, 
                      dbo.vueAccountEmployeeTimeEntry.AccountEmployeeId, dbo.vueAccountEmployeeTimeEntry.AccountProjectId, 
                      dbo.vueAccountEmployeeTimeEntry.TeamLeadApproved, dbo.vueAccountEmployeeTimeEntry.ProjectManagerApproved, 
                      dbo.vueAccountEmployeeTimeEntry.AdministratorApproved, dbo.vueAccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, 
                      dbo.vueAccountEmployeeTimeEntry.StartTime, dbo.vueAccountEmployeeTimeEntry.EndTime, dbo.vueAccountEmployeeTimeEntry.TimeEntryDate, 
                      dbo.vueAccountEmployeeTimeEntry.Description, dbo.vueAccountEmployeeTimeEntry.AccountId, dbo.vueAccountEmployeeTimeEntry.TotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntry.WeekDay, dbo.vueAccountEmployeeTimeEntry.AccountProjectTaskId, 
                      dbo.vueAccountEmployeeTimeEntry.BillingType, dbo.vueAccountEmployeeTimeEntry.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntry.ProjectManagerEmployeeId, dbo.vueAccountEmployeeTimeEntry.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntry.ExpenseApprovalTypeId, dbo.vueAccountEmployeeTimeEntry.IsBillable, 
                      dbo.vueAccountEmployeeTimeEntry.Rejected, dbo.vueAccountEmployeeTimeEntry.BillingRate, 
                      dbo.vueAccountEmployeeTimeEntry.ProjectBillingRateTypeId, dbo.vueAccountEmployeeTimeEntry.EmployeeCode, 
                      dbo.vueAccountEmployeeTimeEntry.AccountDepartmentId, dbo.vueAccountEmployeeTimeEntry.DepartmentName, 
                      dbo.vueAccountEmployeeTimeEntry.EstimatedCost, dbo.vueAccountEmployeeTimeEntry.EstimatedTimeSpent, 
                      dbo.vueAccountEmployeeTimeEntry.Submitted, dbo.vueAccountEmployeeTimeEntry.AccountWorkType, 
                      dbo.vueAccountEmployeeTimeEntry.EMailAddress, dbo.vueAccountEmployeeTimeEntry.AccountLocation, 
                      dbo.vueAccountEmployeeTimeEntry.AccountCostCenter, dbo.vueAccountEmployeeTimeEntry.AccountCostCenterCode, 
                      dbo.vueAccountEmployeeTimeEntry.AccountWorkTypeCode, dbo.vueAccountEmployeeTimeEntry.ProjectCode, 
                      dbo.vueAccountEmployeeTimeEntry.TaskCode, dbo.vueAccountEmployeeTimeEntry.AccountLocationId, dbo.vueAccountEmployeeTimeEntry.Comments,
                       dbo.vueAccountEmployeeTimeEntry.Billed, dbo.vueAccountEmployeeTimeEntry.AccountTimeExpenseBillingTimesheetId, 
                      dbo.AccountTimeExpenseBilling.InvoiceNumber, dbo.AccountTimeExpenseBilling.InvoiceDate, dbo.AccountTimeExpenseBilling.PONumber, 
                      dbo.AccountTimeExpenseBilling.SubTotal, dbo.AccountTimeExpenseBilling.TaxCode1, dbo.AccountTimeExpenseBilling.TaxCode2, 
                      dbo.AccountTimeExpenseBilling.GrandTotal, dbo.AccountTimeExpenseBilling.BillingCycleStartDate, 
                      dbo.AccountTimeExpenseBilling.BillingCycleEndDate, dbo.AccountParty.PartyNick, dbo.AccountParty.AccountPartyId AS AccountClientId, 
                      dbo.AccountParty.PartyName
FROM         dbo.AccountProject INNER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId RIGHT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntry ON dbo.AccountProject.AccountProjectId = dbo.vueAccountEmployeeTimeEntry.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountTimeExpenseBilling INNER JOIN
                      dbo.AccountTimeExpenseBillingTimesheet ON 
                      dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId = dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingId ON 
                      dbo.vueAccountEmployeeTimeEntry.AccountTimeExpenseBillingTimesheetId = dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingTimesheetId
WHERE     (dbo.vueAccountEmployeeTimeEntry.IsBillable = 1) AND (dbo.vueAccountEmployeeTimeEntry.Approved = 1)'
GO
-- Create View vueAccountProjectTaskTimesheet
Print 'Create View vueAccountProjectTaskTimesheet'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountProjectTaskTimesheet' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountProjectTaskTimesheet
AS
SELECT     dbo.AccountProjectTask.*, dbo.AccountProject.AccountId, dbo.AccountProject.IsTemplate
FROM         dbo.AccountProjectTask INNER JOIN
                      dbo.AccountProject ON dbo.AccountProjectTask.AccountProjectId = dbo.AccountProject.AccountProjectId'
GO
Print 'delete currency exchange rate where currency not exists'
if exists(Select * from AccountCurrencyExchangeRate where AccountCurrencyId not in (Select AccountCurrencyId from AccountCurrency))
BEGIN
Delete from AccountCurrencyExchangeRate where AccountCurrencyId not in (Select AccountCurrencyId from AccountCurrency)
END
GO
-- Create Index IX_AccountId on AccountCurrency
Print 'Create Index IX_AccountId on AccountCurrency'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountCurrency' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountCurrency]') AND name = N'IX_AccountId'))
CREATE INDEX [IX_AccountId]
	ON [dbo].[AccountCurrency] ([AccountId])
GO
-- Create Index IX_AccountCurrencyId on AccountCurrencyExchangeRate
Print 'Create Index IX_AccountCurrencyId on AccountCurrencyExchangeRate'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountCurrencyExchangeRate' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountCurrencyExchangeRate]') AND name = N'IX_AccountCurrencyId'))
CREATE INDEX [IX_AccountCurrencyId]
	ON [dbo].[AccountCurrencyExchangeRate] ([AccountCurrencyId])
GO
-- Create Index IX_AccountId on AccountCurrencyExchangeRate
Print 'Create Index IX_AccountId on AccountCurrencyExchangeRate'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountCurrencyExchangeRate' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountCurrencyExchangeRate]') AND name = N'IX_AccountId'))
CREATE INDEX [IX_AccountId]
	ON [dbo].[AccountCurrencyExchangeRate] ([AccountId])
GO
-- Create Index IX_MasterAccountCurrencyExchangeRateId on AccountCurrencyExchangeRate
Print 'Create Index IX_MasterAccountCurrencyExchangeRateId on AccountCurrencyExchangeRate'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountCurrencyExchangeRate' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountCurrencyExchangeRate]') AND name = N'IX_MasterAccountCurrencyExchangeRateId'))
CREATE INDEX [IX_MasterAccountCurrencyExchangeRateId]
	ON [dbo].[AccountCurrencyExchangeRate] ([MasterAccountCurrencyExchangeRateId])
GO
-- Create Index IX_ExchangeRateEffectiveEndDate on AccountCurrencyExchangeRate
Print 'Create Index IX_ExchangeRateEffectiveEndDate on AccountCurrencyExchangeRate'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountCurrencyExchangeRate' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountCurrencyExchangeRate]') AND name = N'IX_ExchangeRateEffectiveEndDate'))
CREATE INDEX [IX_ExchangeRateEffectiveEndDate]
	ON [dbo].[AccountCurrencyExchangeRate] ([ExchangeRateEffectiveEndDate])
GO
-- Create Index IX_ExchangeRateEffectiveStartDate on AccountCurrencyExchangeRate
Print 'Create Index IX_ExchangeRateEffectiveStartDate on AccountCurrencyExchangeRate'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountCurrencyExchangeRate' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountCurrencyExchangeRate]') AND name = N'IX_ExchangeRateEffectiveStartDate'))
CREATE INDEX [IX_ExchangeRateEffectiveStartDate]
	ON [dbo].[AccountCurrencyExchangeRate] ([ExchangeRateEffectiveStartDate])
GO
-- Create Foreign Key FK_AccountCurrencyExchangeRate_AccountCurrency on AccountCurrencyExchangeRate
Print 'Create Foreign Key FK_AccountCurrencyExchangeRate_AccountCurrency on AccountCurrencyExchangeRate'
GO
IF NOT EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_SCHEMA='dbo' AND CONSTRAINT_NAME='FK_AccountCurrencyExchangeRate_AccountCurrency' AND TABLE_NAME='AccountCurrencyExchangeRate')
BEGIN
		ALTER TABLE [dbo].[AccountCurrencyExchangeRate]
			ADD CONSTRAINT [FK_AccountCurrencyExchangeRate_AccountCurrency]
			FOREIGN KEY ([AccountCurrencyId]) REFERENCES [dbo].[AccountCurrency] ([AccountCurrencyId])
			ON DELETE CASCADE
END
GO
Update SystemData Set Version = '3.2.1' Where Version = '3.2.0' And SystemDataId = 1
GO
-- Drop View vueAccountEmployeeTimeEntryPeriodForReport
Print 'Drop View vueAccountEmployeeTimeEntryPeriodForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPeriodForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryPeriodForReport]
GO
-- Create View vueAccountEmployeeTimeEntryPeriodForReport
Print 'Create View vueAccountEmployeeTimeEntryPeriodForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPeriodForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryPeriodForReport
AS
SELECT     dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId, dbo.AccountEmployeeTimeEntryPeriod.AccountId, 
                      dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeId, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, 
                      dbo.AccountEmployeeTimeEntryPeriod.Submitted, dbo.AccountEmployeeTimeEntryPeriod.Approved, dbo.AccountEmployeeTimeEntryPeriod.Rejected, 
                      dbo.AccountEmployeeTimeEntryPeriod.InApproval, dbo.AccountEmployeeTimeEntryPeriod.SubmittedDate, dbo.vueAccountEmployee.EmployeeName, 
                      dbo.vueAccountEmployee.AccountLocationId, dbo.vueAccountEmployee.AccountDepartmentId, dbo.vueAccountEmployee.AccountLocation, 
                      dbo.vueAccountEmployee.Role, dbo.vueAccountEmployee.DepartmentName, dbo.vueAccountEmployee.EMailAddress, 
                      dbo.vueAccountEmployee.AccountRoleId, CASE WHEN AccountEmployeeTimeEntryPeriod.Submitted = 1 AND 
                      AccountEmployeeTimeEntryPeriod.Approved = 0 THEN ''Submitted'' WHEN AccountEmployeeTimeEntryPeriod.Approved = 1 THEN ''Approved'' WHEN AccountEmployeeTimeEntryPeriod.Rejected
                       = 1 THEN ''Rejected'' WHEN AccountEmployeeTimeEntryPeriod.Submitted = 0 AND AccountEmployeeTimeEntryPeriod.Approved = 0 AND 
                      AccountEmployeeTimeEntryPeriod.Rejected = 0 THEN ''Not Submitted'' END AS ApprovalStatus, 
                      { fn DAYOFMONTH(dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate) } AS DayNo, 
                      MONTH(dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate) AS MonthNo, DATEPART(week, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate) - DATEPART(week, DATEADD(month, DATEDIFF(month, 0, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate), 0)) + 1 AS WeekNo, YEAR(dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate) 
                      AS Year, LEFT({ fn MONTHNAME(dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate) }, 3) + '' - '' + CONVERT(nvarchar(10), 
                      YEAR(dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate)) AS Period, 
                      { fn DAYNAME(dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate) } AS WeekDayName, SUM(ROUND(CONVERT(float, 
                      dbo.vueAccountEmployeeTimeEntry.TotalMinutes) / 60, 2)) AS TotalHours, 
                      SUM(ISNULL(dbo.vueAccountEmployeeTimeEntry.TotalMinutes * dbo.vueAccountEmployeeTimeEntry.BillingRate / 60, 0)) AS Amount, 
                      SUM(ISNULL(dbo.vueAccountEmployeeTimeEntry.BillingRate, 0)) AS BillingRate, SUM(ISNULL(dbo.vueAccountEmployeeTimeEntry.SubmittedHours, 0)) 
                      AS SubmittedHours, SUM(ISNULL(dbo.vueAccountEmployeeTimeEntry.ApprovedHours, 0)) AS ApprovedHours, 
                      SUM(ISNULL(dbo.vueAccountEmployeeTimeEntry.RejectedHours, 0)) AS RejectedHours, ISNULL(dbo.vueAccountEmployee.EmployeeCode, '''') 
                      AS EmployeeCode, SUM(ISNULL(dbo.vueAccountEmployeeTimeEntry.BillingRateExchangeRate, 0)) AS BillingRateExchangeRate, 
                      dbo.AccountEmployeeTimeEntryPeriod.ApprovedOn, dbo.AccountEmployeeTimeEntryPeriod.RejectedOn, 
                      dbo.AccountEmployeeTimeEntryPeriod.ApprovedByEmployeeId, dbo.AccountEmployeeTimeEntryPeriod.RejectedByEmployeeId
FROM         dbo.AccountEmployeeTimeEntryPeriod INNER JOIN
                      dbo.vueAccountEmployee ON 
                      dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeId = dbo.vueAccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntry ON 
                      dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId = dbo.vueAccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId
GROUP BY dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId, dbo.AccountEmployeeTimeEntryPeriod.AccountId, 
                      dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeId, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, 
                      dbo.AccountEmployeeTimeEntryPeriod.Submitted, dbo.AccountEmployeeTimeEntryPeriod.Approved, dbo.AccountEmployeeTimeEntryPeriod.Rejected, 
                      dbo.AccountEmployeeTimeEntryPeriod.InApproval, dbo.AccountEmployeeTimeEntryPeriod.SubmittedDate, dbo.vueAccountEmployee.EmployeeName, 
                      dbo.vueAccountEmployee.AccountLocationId, dbo.vueAccountEmployee.AccountDepartmentId, dbo.vueAccountEmployee.AccountLocation, 
                      dbo.vueAccountEmployee.Role, dbo.vueAccountEmployee.DepartmentName, dbo.vueAccountEmployee.EMailAddress, 
                      dbo.vueAccountEmployee.AccountRoleId, dbo.vueAccountEmployee.EmployeeCode, dbo.AccountEmployeeTimeEntryPeriod.ApprovedOn, 
                      dbo.AccountEmployeeTimeEntryPeriod.RejectedOn, dbo.AccountEmployeeTimeEntryPeriod.ApprovedByEmployeeId, 
                      dbo.AccountEmployeeTimeEntryPeriod.RejectedByEmployeeId'
GO
-- Drop View rptvueAccountEmployeeTimeEntryPeriod
Print 'Drop View rptvueAccountEmployeeTimeEntryPeriod'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeEntryPeriod' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountEmployeeTimeEntryPeriod]
GO
-- Create View rptvueAccountEmployeeTimeEntryPeriod
Print 'Create View rptvueAccountEmployeeTimeEntryPeriod'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeEntryPeriod' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountEmployeeTimeEntryPeriod
AS
SELECT     dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountEmployeeTimeEntryPeriodId, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountId, dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.TimeEntryStartDate, dbo.vueAccountEmployeeTimeEntryPeriodForReport.TimeEntryEndDate, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.TimeEntryViewType, dbo.vueAccountEmployeeTimeEntryPeriodForReport.Submitted, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.Approved, dbo.vueAccountEmployeeTimeEntryPeriodForReport.Rejected, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.InApproval, dbo.vueAccountEmployeeTimeEntryPeriodForReport.SubmittedDate, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.EmployeeName, dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountLocationId, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountDepartmentId, dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountLocation, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.Role, dbo.vueAccountEmployeeTimeEntryPeriodForReport.DepartmentName, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.EMailAddress, dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountRoleId, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.ApprovalStatus, dbo.vueAccountEmployeeTimeEntryPeriodForReport.DayNo, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.MonthNo, dbo.vueAccountEmployeeTimeEntryPeriodForReport.WeekNo, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.Year, dbo.vueAccountEmployeeTimeEntryPeriodForReport.Period, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.WeekDayName, dbo.vueAccountEmployeeTimeEntryPeriodForReport.TotalHours, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.Amount, dbo.vueAccountEmployeeTimeEntryPeriodForReport.BillingRate, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.SubmittedHours, dbo.vueAccountEmployeeTimeEntryPeriodForReport.ApprovedHours, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.RejectedHours, dbo.vueAccountEmployeeTimeEntryPeriodForReport.EmployeeCode, 
                      CASE WHEN BillingRateExchangeRate > 0 THEN Amount / BillingRateExchangeRate ELSE 0 END AS CurrencyAmount, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryPeriodForReport.Approved = 1 THEN dbo.vueAccountEmployeeTimeEntryPeriodForReport.ApprovedOn
                       ELSE NULL END AS ApprovedDate, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryPeriodForReport.Rejected = 1 THEN dbo.vueAccountEmployeeTimeEntryPeriodForReport.RejectedOn ELSE
                       NULL END AS RejectedDate, AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName AS ApprovedByEmployeeName, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS RejectedByEmployeeName
FROM         dbo.vueAccountEmployeeTimeEntryPeriodForReport LEFT OUTER JOIN
                      dbo.AccountEmployee ON 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.RejectedByEmployeeId = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.ApprovedByEmployeeId = AccountEmployee_1.AccountEmployeeId'

GO
-- =======================================================
-- Foreign Key Constraint Nochecks's for Table: [dbo].[AccountReportColumn]
-- =======================================================
Print ' Foreign Key Constraint Nochecks''s for Table: [dbo].[AccountReportColumn]'

ALTER TABLE [dbo].[AccountReportColumn] NOCHECK CONSTRAINT [FK_AccountReportColumn_AccountReport]

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'
if not exists(Select * from [dbo].[SystemReportDataSourceField] where [SystemReportDataSourceFieldId] = '0e0e174e-c26a-4778-8787-ff1b84620e20')
BEGIN
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('0e0e174e-c26a-4778-8787-ff1b84620e20', '18966956-9937-4da0-a6f3-465e6066d433', N'ApprovedByEmployeeName', 175, 1, NULL, NULL, 28, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Approved By Employee Name', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('ff71ad97-c80b-4258-ab3e-9008c5bf32d1', '18966956-9937-4da0-a6f3-465e6066d433', N'RejectedByEmployeeName', 175, 1, NULL, NULL, 28, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Rejected By Employee Name', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('e1e47ba5-cfaa-4520-a9b2-316961a059aa', '18966956-9937-4da0-a6f3-465e6066d433', N'RejectedDate', 90, 1, NULL, NULL, 28, '48b9ef68-b4f6-4c75-b8de-c547939179ce', N'Rejected Date', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('82755af1-6630-4ea5-a54b-c950c0b49fea', '18966956-9937-4da0-a6f3-465e6066d433', N'ApprovedDate', 90, 1, NULL, NULL, 28, '48b9ef68-b4f6-4c75-b8de-c547939179ce', N'Approved Date', 0, 0)
END
-- =======================================================
-- Synchronization Script for Table: [dbo].[AccountReportColumn]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[AccountReportColumn]'
if not exists(Select * from [dbo].[AccountReportColumn] where AccountReportColumnId = '4e28c707-bb0a-4e04-a16c-554f8313e499')
BEGIN
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('4e28c707-bb0a-4e04-a16c-554f8313e499', '07cf48a8-c92c-432a-8a14-f0f5d931ba0a', N'Rejected Date', 'e1e47ba5-cfaa-4520-a9b2-316961a059aa', 11, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('7bcb6f26-063d-4275-8b6a-ca86999f31b1', '07cf48a8-c92c-432a-8a14-f0f5d931ba0a', N'Approved By Employee Name', '0e0e174e-c26a-4778-8787-ff1b84620e20', 10, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('bb399639-8c4c-4b91-9331-ab453f41ce57', '07cf48a8-c92c-432a-8a14-f0f5d931ba0a', N'Rejected By Employee Name', 'ff71ad97-c80b-4258-ab3e-9008c5bf32d1', 12, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('2961dcba-b553-497d-ab2a-f3e0166a7b40', '07cf48a8-c92c-432a-8a14-f0f5d931ba0a', N'Approved Date', '82755af1-6630-4ea5-a54b-c950c0b49fea', 9, NULL, NULL)
END
-- =======================================================
-- Synchronization Script for Table: [dbo].[AccountReportColumn]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[AccountReportColumn]'

UPDATE [dbo].[AccountReportColumn] SET [ColumnOrder]=16 WHERE [AccountReportColumnId]='194f3414-bb42-4de2-aec9-f1fb864fe8c1'
UPDATE [dbo].[AccountReportColumn] SET [ColumnOrder]=15 WHERE [AccountReportColumnId]='bef2ea1d-33be-47ab-9353-59f30596454f'
UPDATE [dbo].[AccountReportColumn] SET [ColumnOrder]=18 WHERE [AccountReportColumnId]='56aa3d73-0bee-4467-a40f-195788b42ae4'
UPDATE [dbo].[AccountReportColumn] SET [ColumnOrder]=17 WHERE [AccountReportColumnId]='cf13a2e1-23db-4a7a-b430-d96859895230'
UPDATE [dbo].[AccountReportColumn] SET [ColumnOrder]=14 WHERE [AccountReportColumnId]='6f437ae7-d7c9-4b27-b9fe-dc5d41e38ba2'

-- =======================================================
-- Foreign Key Constraint Check's for Table: [dbo].[AccountReportColumn]
-- =======================================================
Print ' Foreign Key Constraint Check''s for Table: [dbo].[AccountReportColumn]'

ALTER TABLE [dbo].[AccountReportColumn] CHECK CONSTRAINT [FK_AccountReportColumn_AccountReport]
GO
-- Drop View rptvueAccountEmployeeExpenseSheet
Print 'Drop View rptvueAccountEmployeeExpenseSheet'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeExpenseSheet' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountEmployeeExpenseSheet]
GO
-- Create View rptvueAccountEmployeeExpenseSheet
Print 'Create View rptvueAccountEmployeeExpenseSheet'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeExpenseSheet' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountEmployeeExpenseSheet
AS
SELECT     AccountEmployeeExpenseSheetId, AccountId, AccountEmployeeId, Description, ExpenseSheetDate, ISNULL(Amount, 0) AS Amount, Currency, 
                      CurrencyCode, AccountCurrencyId, Status, InApproval, Submitted, Rejected, Approved, SubmittedDate, EmployeeName, EMailAddress, DayNo, 
                      MonthNo, WeekNo, Year, Period, WeekDayName, DepartmentName, Role, AccountLocation, AccountDepartmentId, AccountLocationId, AccountRoleId, 
                      EmployeeCode, DepartmentCode, ExchangeRate, ISNULL(CurrencyAmount, 0) AS CurrencyAmount
FROM         dbo.vueAccountEmployeeExpenseSheetForReport'
GO
-- Drop View vueAccountEmployeeExpenseSheet
Print 'Drop View vueAccountEmployeeExpenseSheet'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeExpenseSheet' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeExpenseSheet]
GO
-- Add Column ApprovedOn to AccountEmployeeExpenseSheet
Print 'Add Column ApprovedOn to AccountEmployeeExpenseSheet'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeExpenseSheet' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='ApprovedOn' AND TABLE_NAME='AccountEmployeeExpenseSheet'))
ALTER TABLE [dbo].[AccountEmployeeExpenseSheet]
	ADD [ApprovedOn] datetime NULL
GO
-- Add Column ApprovedByEmployeeId to AccountEmployeeExpenseSheet
Print 'Add Column ApprovedByEmployeeId to AccountEmployeeExpenseSheet'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeExpenseSheet' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='ApprovedByEmployeeId' AND TABLE_NAME='AccountEmployeeExpenseSheet'))
ALTER TABLE [dbo].[AccountEmployeeExpenseSheet]
	ADD [ApprovedByEmployeeId] int NULL
GO
-- Add Column RejectedOn to AccountEmployeeExpenseSheet
Print 'Add Column RejectedOn to AccountEmployeeExpenseSheet'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeExpenseSheet' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='RejectedOn' AND TABLE_NAME='AccountEmployeeExpenseSheet'))
ALTER TABLE [dbo].[AccountEmployeeExpenseSheet]
	ADD [RejectedOn] datetime NULL
GO
-- Add Column RejectedByEmployeeId to AccountEmployeeExpenseSheet
Print 'Add Column RejectedByEmployeeId to AccountEmployeeExpenseSheet'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeExpenseSheet' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='RejectedByEmployeeId' AND TABLE_NAME='AccountEmployeeExpenseSheet'))
ALTER TABLE [dbo].[AccountEmployeeExpenseSheet]
	ADD [RejectedByEmployeeId] int NULL
GO
-- Create View vueAccountEmployeeExpenseSheet
Print 'Create View vueAccountEmployeeExpenseSheet'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeExpenseSheet' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeExpenseSheet
AS
SELECT     dbo.AccountEmployeeExpenseSheet.AccountEmployeeExpenseSheetId, dbo.AccountEmployeeExpenseSheet.AccountId, 
                      dbo.AccountEmployeeExpenseSheet.AccountEmployeeId, dbo.AccountEmployeeExpenseSheet.Description, 
                      dbo.AccountEmployeeExpenseSheet.ExpenseSheetDate, SUM(dbo.AccountExpenseEntry.Amount) AS Amount, MAX(dbo.vueAccountCurrency.Currency) 
                      AS Currency, MAX(dbo.vueAccountCurrency.CurrencyCode) AS CurrencyCode, MAX(dbo.vueAccountCurrency.AccountCurrencyId) AS AccountCurrencyId, 
                      CASE WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 0 AND dbo.AccountEmployeeExpenseSheet.Approved = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.Rejected = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.InApproval = 0 THEN ''Not Submitted'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Rejected = 0 THEN ''Approved'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.Rejected = 1 THEN ''Rejected'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 0 AND dbo.AccountEmployeeExpenseSheet.Rejected = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.InApproval = 1 THEN ''Submitted'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 0 AND dbo.AccountEmployeeExpenseSheet.Rejected = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.InApproval = 0 THEN ''Submitted'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 1 THEN ''Not Submitted'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.InApproval = 1 THEN ''Not Submitted'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 1 AND dbo.AccountEmployeeExpenseSheet.Rejected = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.InApproval = 1 THEN ''Approved'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Rejected = 1 THEN ''Submitted'' END AS Status, dbo.AccountEmployeeExpenseSheet.InApproval, 
                      dbo.AccountEmployeeExpenseSheet.Submitted, dbo.AccountEmployeeExpenseSheet.Rejected, dbo.AccountEmployeeExpenseSheet.Approved, 
                      dbo.AccountEmployeeExpenseSheet.SubmittedDate, dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, 
                      dbo.AccountEmployee.EMailAddress, MAX(dbo.vueAccountCurrency.ExchangeRate) AS ExchangeRate, 
                      dbo.AccountEmployeeExpenseSheet.ApprovedOn, dbo.AccountEmployeeExpenseSheet.ApprovedByEmployeeId, 
                      dbo.AccountEmployeeExpenseSheet.RejectedOn, dbo.AccountEmployeeExpenseSheet.RejectedByEmployeeId
FROM         dbo.AccountEmployeeExpenseSheet INNER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployeeExpenseSheet.AccountId = dbo.AccountPreferences.AccountId INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeExpenseSheet.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.vueAccountCurrency ON dbo.AccountPreferences.AccountBaseCurrencyId = dbo.vueAccountCurrency.AccountCurrencyId LEFT OUTER JOIN
                      dbo.AccountExpenseEntry ON 
                      dbo.AccountEmployeeExpenseSheet.AccountEmployeeExpenseSheetId = dbo.AccountExpenseEntry.AccountEmployeeExpenseSheetId
GROUP BY dbo.AccountEmployeeExpenseSheet.AccountEmployeeExpenseSheetId, dbo.AccountEmployeeExpenseSheet.AccountId, 
                      dbo.AccountEmployeeExpenseSheet.AccountEmployeeId, dbo.AccountEmployeeExpenseSheet.Description, 
                      dbo.AccountEmployeeExpenseSheet.ExpenseSheetDate, dbo.AccountEmployeeExpenseSheet.InApproval, 
                      dbo.AccountEmployeeExpenseSheet.Submitted, dbo.AccountEmployeeExpenseSheet.Rejected, dbo.AccountEmployeeExpenseSheet.Approved, 
                      dbo.AccountEmployeeExpenseSheet.SubmittedDate, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, 
                      dbo.AccountEmployee.EMailAddress, dbo.AccountEmployeeExpenseSheet.ApprovedOn, dbo.AccountEmployeeExpenseSheet.ApprovedByEmployeeId, 
                      dbo.AccountEmployeeExpenseSheet.RejectedOn, dbo.AccountEmployeeExpenseSheet.RejectedByEmployeeId'
GO
-- Drop View rptvueAccountEmployeeExpenseSheet
Print 'Drop View rptvueAccountEmployeeExpenseSheet'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeExpenseSheet' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountEmployeeExpenseSheet]
GO
-- Drop View vueAccountEmployeeExpenseSheetForReport
Print 'Drop View vueAccountEmployeeExpenseSheetForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeExpenseSheetForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeExpenseSheetForReport]
GO
-- Create View vueAccountEmployeeExpenseSheetForReport
Print 'Create View vueAccountEmployeeExpenseSheetForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeExpenseSheetForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeExpenseSheetForReport
AS
SELECT     dbo.vueAccountEmployeeExpenseSheet.AccountEmployeeExpenseSheetId, dbo.vueAccountEmployeeExpenseSheet.AccountId, 
                      dbo.vueAccountEmployeeExpenseSheet.AccountEmployeeId, dbo.vueAccountEmployeeExpenseSheet.Description, 
                      dbo.vueAccountEmployeeExpenseSheet.ExpenseSheetDate, dbo.vueAccountEmployeeExpenseSheet.Amount, 
                      dbo.vueAccountEmployeeExpenseSheet.Currency, dbo.vueAccountEmployeeExpenseSheet.CurrencyCode, 
                      dbo.vueAccountEmployeeExpenseSheet.AccountCurrencyId, dbo.vueAccountEmployeeExpenseSheet.Status, 
                      dbo.vueAccountEmployeeExpenseSheet.InApproval, dbo.vueAccountEmployeeExpenseSheet.Submitted, 
                      dbo.vueAccountEmployeeExpenseSheet.Rejected, dbo.vueAccountEmployeeExpenseSheet.Approved, 
                      dbo.vueAccountEmployeeExpenseSheet.SubmittedDate, dbo.vueAccountEmployeeExpenseSheet.EmployeeName, 
                      dbo.vueAccountEmployeeExpenseSheet.EMailAddress, { fn DAYOFMONTH(dbo.vueAccountEmployeeExpenseSheet.ExpenseSheetDate) } AS DayNo, 
                      MONTH(dbo.vueAccountEmployeeExpenseSheet.ExpenseSheetDate) AS MonthNo, DATEPART(week, 
                      dbo.vueAccountEmployeeExpenseSheet.ExpenseSheetDate) - DATEPART(week, DATEADD(month, DATEDIFF(month, 0, 
                      dbo.vueAccountEmployeeExpenseSheet.ExpenseSheetDate), 0)) + 1 AS WeekNo, YEAR(dbo.vueAccountEmployeeExpenseSheet.ExpenseSheetDate) 
                      AS Year, LEFT({ fn MONTHNAME(dbo.vueAccountEmployeeExpenseSheet.ExpenseSheetDate) }, 3) + '' - '' + CONVERT(nvarchar(10), 
                      YEAR(dbo.vueAccountEmployeeExpenseSheet.ExpenseSheetDate)) AS Period, 
                      { fn DAYNAME(dbo.vueAccountEmployeeExpenseSheet.ExpenseSheetDate) } AS WeekDayName, dbo.vueAccountEmployee.DepartmentName, 
                      dbo.vueAccountEmployee.Role, dbo.vueAccountEmployee.AccountLocation, dbo.vueAccountEmployee.AccountDepartmentId, 
                      dbo.vueAccountEmployee.AccountLocationId, dbo.vueAccountEmployee.AccountRoleId, dbo.vueAccountEmployee.EmployeeCode, 
                      dbo.AccountDepartment.DepartmentCode, dbo.vueAccountEmployeeExpenseSheet.ExchangeRate, 
                      CASE WHEN dbo.vueAccountEmployeeExpenseSheet.ExchangeRate > 0 THEN dbo.vueAccountEmployeeExpenseSheet.Amount / dbo.vueAccountEmployeeExpenseSheet.ExchangeRate
                       ELSE 0 END AS CurrencyAmount, dbo.vueAccountEmployeeExpenseSheet.ApprovedOn, 
                      dbo.vueAccountEmployeeExpenseSheet.ApprovedByEmployeeId, dbo.vueAccountEmployeeExpenseSheet.RejectedOn, 
                      dbo.vueAccountEmployeeExpenseSheet.RejectedByEmployeeId
FROM         dbo.vueAccountEmployeeExpenseSheet INNER JOIN
                      dbo.vueAccountEmployee ON dbo.vueAccountEmployeeExpenseSheet.AccountEmployeeId = dbo.vueAccountEmployee.AccountEmployeeId INNER JOIN
                      dbo.AccountDepartment ON dbo.vueAccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId'
GO
-- Create View rptvueAccountEmployeeExpenseSheet
Print 'Create View rptvueAccountEmployeeExpenseSheet'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeExpenseSheet' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountEmployeeExpenseSheet
AS
SELECT     dbo.vueAccountEmployeeExpenseSheetForReport.AccountEmployeeExpenseSheetId, dbo.vueAccountEmployeeExpenseSheetForReport.AccountId, 
                      dbo.vueAccountEmployeeExpenseSheetForReport.AccountEmployeeId, dbo.vueAccountEmployeeExpenseSheetForReport.Description, 
                      dbo.vueAccountEmployeeExpenseSheetForReport.ExpenseSheetDate, ISNULL(dbo.vueAccountEmployeeExpenseSheetForReport.Amount, 0) 
                      AS Amount, dbo.vueAccountEmployeeExpenseSheetForReport.Currency, dbo.vueAccountEmployeeExpenseSheetForReport.CurrencyCode, 
                      dbo.vueAccountEmployeeExpenseSheetForReport.AccountCurrencyId, dbo.vueAccountEmployeeExpenseSheetForReport.Status, 
                      dbo.vueAccountEmployeeExpenseSheetForReport.InApproval, dbo.vueAccountEmployeeExpenseSheetForReport.Submitted, 
                      dbo.vueAccountEmployeeExpenseSheetForReport.Rejected, dbo.vueAccountEmployeeExpenseSheetForReport.Approved, 
                      dbo.vueAccountEmployeeExpenseSheetForReport.SubmittedDate, dbo.vueAccountEmployeeExpenseSheetForReport.EmployeeName, 
                      dbo.vueAccountEmployeeExpenseSheetForReport.EMailAddress, dbo.vueAccountEmployeeExpenseSheetForReport.DayNo, 
                      dbo.vueAccountEmployeeExpenseSheetForReport.MonthNo, dbo.vueAccountEmployeeExpenseSheetForReport.WeekNo, 
                      dbo.vueAccountEmployeeExpenseSheetForReport.Year, dbo.vueAccountEmployeeExpenseSheetForReport.Period, 
                      dbo.vueAccountEmployeeExpenseSheetForReport.WeekDayName, dbo.vueAccountEmployeeExpenseSheetForReport.DepartmentName, 
                      dbo.vueAccountEmployeeExpenseSheetForReport.Role, dbo.vueAccountEmployeeExpenseSheetForReport.AccountLocation, 
                      dbo.vueAccountEmployeeExpenseSheetForReport.AccountDepartmentId, dbo.vueAccountEmployeeExpenseSheetForReport.AccountLocationId, 
                      dbo.vueAccountEmployeeExpenseSheetForReport.AccountRoleId, dbo.vueAccountEmployeeExpenseSheetForReport.EmployeeCode, 
                      dbo.vueAccountEmployeeExpenseSheetForReport.DepartmentCode, dbo.vueAccountEmployeeExpenseSheetForReport.ExchangeRate, 
                      ISNULL(dbo.vueAccountEmployeeExpenseSheetForReport.CurrencyAmount, 0) AS CurrencyAmount, 
                      CASE WHEN dbo.vueAccountEmployeeExpenseSheetForReport.Approved = 1 THEN dbo.vueAccountEmployeeExpenseSheetForReport.ApprovedOn ELSE
                       NULL END AS ApprovedDate, 
                      CASE WHEN dbo.vueAccountEmployeeExpenseSheetForReport.Rejected = 1 THEN dbo.vueAccountEmployeeExpenseSheetForReport.RejectedOn ELSE
                       NULL END AS RejectedDate, dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS ApprovedByEmployeeName, 
                      AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName AS RejectedByEmployeeName
FROM         dbo.vueAccountEmployeeExpenseSheetForReport LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON 
                      dbo.vueAccountEmployeeExpenseSheetForReport.RejectedByEmployeeId = AccountEmployee_1.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee ON dbo.vueAccountEmployeeExpenseSheetForReport.ApprovedByEmployeeId = dbo.AccountEmployee.AccountEmployeeId'
GO
-- =======================================================
-- Foreign Key Constraint Nochecks's for Table: [dbo].[AccountReportColumn]
-- =======================================================
Print ' Foreign Key Constraint Nochecks''s for Table: [dbo].[AccountReportColumn]'

ALTER TABLE [dbo].[AccountReportColumn] NOCHECK CONSTRAINT [FK_AccountReportColumn_AccountReport]

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'
if not exists(Select * from [dbo].[SystemReportDataSourceField] where [SystemReportDataSourceFieldId] = '2ffa830f-aad8-4331-aad7-5aa76bc176db')
BEGIN
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('2ffa830f-aad8-4331-aad7-5aa76bc176db', 'ee5f3316-3a5e-484e-ae9e-9b11f0380997', N'ApprovedByEmployeeName', 175, 1, NULL, NULL, 25, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Approved By Employee Name', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('6f1ab610-2b14-479f-9a4e-cedfc68c71cb', 'ee5f3316-3a5e-484e-ae9e-9b11f0380997', N'RejectedDate', 90, 1, NULL, NULL, 26, '48b9ef68-b4f6-4c75-b8de-c547939179ce', N'Rejected Date', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('3c91f498-7169-4ae9-8166-88729f863e94', 'ee5f3316-3a5e-484e-ae9e-9b11f0380997', N'ApprovedDate', 90, 1, NULL, NULL, 24, '48b9ef68-b4f6-4c75-b8de-c547939179ce', N'Approved Date', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('11c3e7ae-e218-403a-bfb2-13c92c0fa925', 'ee5f3316-3a5e-484e-ae9e-9b11f0380997', N'RejectedByEmployeeName', 175, 1, NULL, NULL, 27, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Rejected By Employee Name', 0, 0)
END
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'

UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=31 WHERE [SystemReportDataSourceFieldId]='0f695706-c3ca-4e9c-b2e6-6489642d065b'
UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=29 WHERE [SystemReportDataSourceFieldId]='9ad16b77-2668-4bd4-b8b2-f4da034b8322'
UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=32 WHERE [SystemReportDataSourceFieldId]='0b5d0d84-43e6-42f9-b673-b7bf4ce474fb'
UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=28 WHERE [SystemReportDataSourceFieldId]='9579e2c6-bb6c-4e03-ba64-c9e94fb31a09'
UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=30 WHERE [SystemReportDataSourceFieldId]='da1e85d1-0a97-4e29-b1dd-e121d5cc502e'


-- =======================================================
-- Synchronization Script for Table: [dbo].[AccountReportColumn]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[AccountReportColumn]'
if not exists(Select * from [dbo].[AccountReportColumn] where AccountReportColumnId = 'c86a2338-e0b4-41cd-9216-e17fbf6380d3')
BEGIN
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('c86a2338-e0b4-41cd-9216-e17fbf6380d3', '9dfe73b0-33b2-4879-89c5-859fa40c385d', N'Rejected Date', '6f1ab610-2b14-479f-9a4e-cedfc68c71cb', 13, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('9ea58b66-7105-4937-99f8-b4fa1656b6e5', '9dfe73b0-33b2-4879-89c5-859fa40c385d', N'Approved Date', '3c91f498-7169-4ae9-8166-88729f863e94', 11, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('893b6179-4e48-4992-a276-a704ee791ff6', '9dfe73b0-33b2-4879-89c5-859fa40c385d', N'Approved By Employee Name', '2ffa830f-aad8-4331-aad7-5aa76bc176db', 12, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('fbbd61a4-9cf0-4d3f-8382-a86e336e37dd', '9dfe73b0-33b2-4879-89c5-859fa40c385d', N'Rejected By Employee Name', '11c3e7ae-e218-403a-bfb2-13c92c0fa925', 14, NULL, NULL)
END
-- =======================================================
-- Foreign Key Constraint Check's for Table: [dbo].[AccountReportColumn]
-- =======================================================
Print ' Foreign Key Constraint Check''s for Table: [dbo].[AccountReportColumn]'

ALTER TABLE [dbo].[AccountReportColumn] CHECK CONSTRAINT [FK_AccountReportColumn_AccountReport]
GO
-- Drop View rptvueAccountEmployeeTimeEntryPeriod
Print 'Drop View rptvueAccountEmployeeTimeEntryPeriod'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeEntryPeriod' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountEmployeeTimeEntryPeriod]
GO
-- Create View rptvueAccountEmployeeTimeEntryPeriod
Print 'Create View rptvueAccountEmployeeTimeEntryPeriod'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeEntryPeriod' and table_type = 'VIEW') 
EXEC sp_executesql N'CREATE VIEW dbo.rptvueAccountEmployeeTimeEntryPeriod
AS
SELECT     dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountEmployeeTimeEntryPeriodId, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountId, dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.TimeEntryStartDate, dbo.vueAccountEmployeeTimeEntryPeriodForReport.TimeEntryEndDate, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.TimeEntryViewType, dbo.vueAccountEmployeeTimeEntryPeriodForReport.Submitted, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.Approved, dbo.vueAccountEmployeeTimeEntryPeriodForReport.Rejected, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.InApproval, dbo.vueAccountEmployeeTimeEntryPeriodForReport.SubmittedDate, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.EmployeeName, dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountLocationId, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountDepartmentId, dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountLocation, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.Role, dbo.vueAccountEmployeeTimeEntryPeriodForReport.DepartmentName, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.EMailAddress, dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountRoleId, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.ApprovalStatus, dbo.vueAccountEmployeeTimeEntryPeriodForReport.DayNo, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.MonthNo, dbo.vueAccountEmployeeTimeEntryPeriodForReport.WeekNo, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.Year, dbo.vueAccountEmployeeTimeEntryPeriodForReport.Period, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.WeekDayName, ISNULL(dbo.vueAccountEmployeeTimeEntryPeriodForReport.TotalHours, 0) 
                      AS TotalHours, dbo.vueAccountEmployeeTimeEntryPeriodForReport.Amount, dbo.vueAccountEmployeeTimeEntryPeriodForReport.BillingRate, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.SubmittedHours, dbo.vueAccountEmployeeTimeEntryPeriodForReport.ApprovedHours, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.RejectedHours, dbo.vueAccountEmployeeTimeEntryPeriodForReport.EmployeeCode, 
                      CASE WHEN BillingRateExchangeRate > 0 THEN Amount / BillingRateExchangeRate ELSE 0 END AS CurrencyAmount, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryPeriodForReport.Approved = 1 THEN dbo.vueAccountEmployeeTimeEntryPeriodForReport.ApprovedOn
                       ELSE NULL END AS ApprovedDate, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryPeriodForReport.Rejected = 1 THEN dbo.vueAccountEmployeeTimeEntryPeriodForReport.RejectedOn ELSE
                       NULL END AS RejectedDate, AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName AS ApprovedByEmployeeName, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS RejectedByEmployeeName
FROM         dbo.vueAccountEmployeeTimeEntryPeriodForReport LEFT OUTER JOIN
                      dbo.AccountEmployee ON 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.RejectedByEmployeeId = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.ApprovedByEmployeeId = AccountEmployee_1.AccountEmployeeId'
GO
-- Drop View vueAccountEmployee
Print 'Drop View vueAccountEmployee'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployee]
GO
-- Add Column TimesheetPrintFooter to AccountPreferences
Print 'Add Column TimesheetPrintFooter to AccountPreferences'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountPreferences' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='TimesheetPrintFooter' AND TABLE_NAME='AccountPreferences'))
ALTER TABLE [dbo].[AccountPreferences]
	ADD [TimesheetPrintFooter] nvarchar(4000) NULL
GO
-- Add Column ExpenseSheetPrintFooter to AccountPreferences
Print 'Add Column ExpenseSheetPrintFooter to AccountPreferences'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountPreferences' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='ExpenseSheetPrintFooter' AND TABLE_NAME='AccountPreferences'))
ALTER TABLE [dbo].[AccountPreferences]
	ADD [ExpenseSheetPrintFooter] nvarchar(4000) NULL
GO
-- Create View vueAccountEmployee
Print 'Create View vueAccountEmployee'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'CREATE VIEW dbo.vueAccountEmployee
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountEmployee.AccountId, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.Password, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountLocationId, 
                      dbo.AccountEmployee.BillingTypeId, dbo.AccountBillingType.BillingType, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountPreferences.ShowClockStartEnd, 
                      dbo.Account.TimeZoneId, dbo.AccountRole.MasterAccountRoleId, dbo.Account.DefaultCurrencyId, dbo.Account.CountryId, 
                      dbo.AccountPreferences.CultureInfoName, dbo.AccountPreferences.TimeEntryFormat, dbo.AccountEmployee.AllowedAccessFromIP, 
                      dbo.AccountRole.AccountRoleId, dbo.AccountPreferences.AccountSessionTimeout, dbo.AccountPreferences.ShowCompletedTasksInTimeSheet, 
                      dbo.AccountPreferences.CurrencySymbol, dbo.AccountPreferences.IsCompanyOwnLogo, dbo.Account.AccountExpiryActivation, 
                      dbo.Account.LicenseActivation, dbo.AccountEmployee.EmployeeTypeId, dbo.AccountEmployee.ExternalUserClientId, 
                      dbo.AccountEmployee.AccountBillingRateId, dbo.AccountPreferences.ScheduledEmailSendTime, dbo.AccountEmployee.Username, 
                      dbo.AccountEmployee.IsDisabled, dbo.AccountPreferences.FromEmailAddress, dbo.AccountPreferences.FromEmailAddressDisplayName, 
                      dbo.AccountEmployee.EmployeeCode, dbo.AccountPreferences.Version, dbo.AccountPreferences.LockSubmittedRecords, 
                      dbo.AccountPreferences.LockApprovedRecords, ISNULL(dbo.AccountEmployee.EmployeeCode + '' - '', '''') 
                      + dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeNameWithCode, 
                      dbo.AccountPreferences.ShowWorkTypeInTimeSheet, dbo.AccountPreferences.NumberOfBlankRowsInTimeEntry, 
                      dbo.AccountPreferences.ShowCostCenterInTimeSheet, dbo.AccountPreferences.WeekStartDay, dbo.AccountPreferences.AccountBaseCurrencyId, 
                      dbo.AccountPreferences.UserInterfaceLanguage, dbo.AccountEmployee.EmployeeManagerId, dbo.AccountPreferences.DefaultTimeEntryMode, 
                      dbo.AccountPreferences.PageSize, dbo.AccountEmployee.TimeZoneId AS EmployeeTimeZoneId, dbo.AccountEmployee.TerminationDate, 
                      dbo.AccountEmployee.StatusId, dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.EmployeePayTypeId, dbo.AccountEmployee.HiredDate, 
                      dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountWorkingDayType, dbo.AccountWorkingDayType.HoursPerDay, 
                      dbo.AccountWorkingDayType.WeekStartDay AS EmployeeWeekStartDay, dbo.AccountPreferences.ShowClientInTimesheet, 
                      dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, 
                      dbo.AccountPreferences.ShowDescriptionInWeekView, dbo.AccountPreferences.InvoiceNoPrefix, 
                      dbo.AccountPreferences.ShowAdditionalTaskInformationType, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, ISNULL(dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, 1) 
                      AS InitialDayOfTheMonth, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, 1) 
                      AS SystemInitialDayOfFirstPeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod, 16) AS SystemInitialDayOfLastPeriod, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountPreferences.TimesheetPrintFooter, 
                      dbo.AccountPreferences.ExpenseSheetPrintFooter
FROM         dbo.vueAccountTimesheetPeriodType RIGHT OUTER JOIN
                      dbo.AccountWorkingDayType ON 
                      dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId = dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId RIGHT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.Account ON dbo.AccountEmployee.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId ON 
                      dbo.AccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployee.AccountId = dbo.AccountPreferences.AccountId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId'
GO
-- Drop View vueAccountTimeExpenseBillingTimesheet
Print 'Drop View vueAccountTimeExpenseBillingTimesheet'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountTimeExpenseBillingTimesheet' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountTimeExpenseBillingTimesheet]
GO
-- Create View vueAccountTimeExpenseBillingTimesheet
Print 'Create View vueAccountTimeExpenseBillingTimesheet'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountTimeExpenseBillingTimesheet' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountTimeExpenseBillingTimesheet
AS
SELECT     dbo.AccountProject.AccountClientId, dbo.AccountProject.ProjectName, dbo.AccountProjectTask.TaskName, 
                      dbo.AccountProjectTask.AccountProjectTaskId, dbo.AccountProject.AccountProjectId, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeExpenseBillingTimesheetId, dbo.AccountEmployeeTimeEntry.BillingRate, 
                      dbo.AccountEmployeeTimeEntry.BillingRateCurrencyId, dbo.AccountTimeExpenseBillingTimesheet.Description, 
                      dbo.AccountEmployeeTimeEntry.Approved, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, 
                      dbo.AccountEmployeeTimeEntry.TotalTime) AS TotalMinutes, ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) AS TotalHours, dbo.AccountEmployeeTimeEntry.BillingRate * DATEPART(hh, 
                      dbo.AccountEmployeeTimeEntry.TotalTime) AS Amount, dbo.AccountEmployeeTimeEntry.TimeEntryDate, 
                      dbo.AccountTimeExpenseBillingTimesheet.BillHours, dbo.AccountTimeExpenseBillingTimesheet.ActualBillingRate, 
                      dbo.AccountTimeExpenseBillingTimesheet.TotalAmount, dbo.AccountTimeExpenseBillingTimesheet.AccountTaxCodeId1, 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountTaxCodeId2, dbo.AccountTimeExpenseBilling.SubTotal, dbo.AccountTimeExpenseBilling.TaxCode1, 
                      dbo.AccountTimeExpenseBilling.TaxCode2, dbo.AccountTimeExpenseBilling.GrandTotal, dbo.AccountParty.PartyNick, 
                      dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId, dbo.AccountEmployeeTimeEntry.Billed, 
                      dbo.AccountEmployeeTimeEntry.BillingRateExchangeRate, dbo.AccountProjectTask.IsBillable
FROM         dbo.AccountTimeExpenseBillingTimesheet RIGHT OUTER JOIN
                      dbo.AccountTimeExpenseBilling ON 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingId = dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId RIGHT OUTER
                       JOIN
                      dbo.AccountProjectTask INNER JOIN
                      dbo.AccountEmployeeTimeEntry ON dbo.AccountProjectTask.AccountProjectTaskId = dbo.AccountEmployeeTimeEntry.AccountProjectTaskId INNER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId ON 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingTimesheetId = dbo.AccountEmployeeTimeEntry.AccountTimeExpenseBillingTimesheetId
                       AND dbo.AccountTimeExpenseBillingTimesheet.AccountProjectId = dbo.AccountEmployeeTimeEntry.AccountProjectId AND 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountProjectTaskId = dbo.AccountEmployeeTimeEntry.AccountProjectTaskId RIGHT OUTER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId
WHERE     (dbo.AccountEmployeeTimeEntry.Approved = 1) AND (dbo.AccountEmployeeTimeEntry.Billed <> 1)'

GO
-- Drop View vueAccountEmployee
Print 'Drop View vueAccountEmployee'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployee]
GO
-- Add Column Completed to AccountProject
Print 'Add Column Completed to AccountProject'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProject' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='Completed' AND TABLE_NAME='AccountProject'))

ALTER TABLE [dbo].[AccountProject]
	ADD [Completed] bit NOT NULL
	CONSTRAINT [DF_AccountProject_Completed] DEFAULT ((0))

GO
-- Add Column ShowCompletedProjectsInTimeSheet to AccountPreferences
Print 'Add Column ShowCompletedProjectsInTimeSheet to AccountPreferences'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountPreferences' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='ShowCompletedProjectsInTimeSheet' AND TABLE_NAME='AccountPreferences'))

ALTER TABLE [dbo].[AccountPreferences]
	ADD [ShowCompletedProjectsInTimeSheet] bit NULL

GO
-- Create View vueAccountEmployee
Print 'Create View vueAccountEmployee'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployee
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountEmployee.AccountId, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.Password, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountLocationId, 
                      dbo.AccountEmployee.BillingTypeId, dbo.AccountBillingType.BillingType, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountPreferences.ShowClockStartEnd, 
                      dbo.Account.TimeZoneId, dbo.AccountRole.MasterAccountRoleId, dbo.Account.DefaultCurrencyId, dbo.Account.CountryId, 
                      dbo.AccountPreferences.CultureInfoName, dbo.AccountPreferences.TimeEntryFormat, dbo.AccountEmployee.AllowedAccessFromIP, 
                      dbo.AccountRole.AccountRoleId, dbo.AccountPreferences.AccountSessionTimeout, dbo.AccountPreferences.ShowCompletedTasksInTimeSheet, 
                      dbo.AccountPreferences.CurrencySymbol, dbo.AccountPreferences.IsCompanyOwnLogo, dbo.Account.AccountExpiryActivation, 
                      dbo.Account.LicenseActivation, dbo.AccountEmployee.EmployeeTypeId, dbo.AccountEmployee.ExternalUserClientId, 
                      dbo.AccountEmployee.AccountBillingRateId, dbo.AccountPreferences.ScheduledEmailSendTime, dbo.AccountEmployee.Username, 
                      dbo.AccountEmployee.IsDisabled, dbo.AccountPreferences.FromEmailAddress, dbo.AccountPreferences.FromEmailAddressDisplayName, 
                      dbo.AccountEmployee.EmployeeCode, dbo.AccountPreferences.Version, dbo.AccountPreferences.LockSubmittedRecords, 
                      dbo.AccountPreferences.LockApprovedRecords, ISNULL(dbo.AccountEmployee.EmployeeCode + '' - '', '''') 
                      + dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeNameWithCode, 
                      dbo.AccountPreferences.ShowWorkTypeInTimeSheet, dbo.AccountPreferences.NumberOfBlankRowsInTimeEntry, 
                      dbo.AccountPreferences.ShowCostCenterInTimeSheet, dbo.AccountPreferences.WeekStartDay, dbo.AccountPreferences.AccountBaseCurrencyId, 
                      dbo.AccountPreferences.UserInterfaceLanguage, dbo.AccountEmployee.EmployeeManagerId, dbo.AccountPreferences.DefaultTimeEntryMode, 
                      dbo.AccountPreferences.PageSize, dbo.AccountEmployee.TimeZoneId AS EmployeeTimeZoneId, dbo.AccountEmployee.TerminationDate, 
                      dbo.AccountEmployee.StatusId, dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.EmployeePayTypeId, dbo.AccountEmployee.HiredDate, 
                      dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountWorkingDayType, dbo.AccountWorkingDayType.HoursPerDay, 
                      dbo.AccountWorkingDayType.WeekStartDay AS EmployeeWeekStartDay, dbo.AccountPreferences.ShowClientInTimesheet, 
                      dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, 
                      dbo.AccountPreferences.ShowDescriptionInWeekView, dbo.AccountPreferences.InvoiceNoPrefix, 
                      dbo.AccountPreferences.ShowAdditionalTaskInformationType, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, ISNULL(dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, 1) 
                      AS InitialDayOfTheMonth, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, 1) 
                      AS SystemInitialDayOfFirstPeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod, 16) AS SystemInitialDayOfLastPeriod, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountPreferences.TimesheetPrintFooter, 
                      dbo.AccountPreferences.ExpenseSheetPrintFooter, dbo.AccountPreferences.ShowCompletedProjectsInTimeSheet
FROM         dbo.vueAccountTimesheetPeriodType RIGHT OUTER JOIN
                      dbo.AccountWorkingDayType ON 
                      dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId = dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId RIGHT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.Account ON dbo.AccountEmployee.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId ON 
                      dbo.AccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployee.AccountId = dbo.AccountPreferences.AccountId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId'
GO
Update SystemData Set Version = '3.2.2' Where Version = '3.2.1' And SystemDataId = 1
GO
If exists(Select * from SystemData where version = '3.2.2')
BEGIN
Update AccountEmployeeTimeEntryApproval Set AccountEmployeeTimeEntryPeriodId = NULL 
Where AccountEmployeeTimeEntryId In (Select AccountEmployeeTimeEntryId From AccountEmployeeTimeEntry
Where AccountEmployeeTimeEntryPeriodId Not In (Select AccountEmployeeTimeEntryPeriodId 
From AccountEmployeeTimeEntryPeriod Where TimeEntryDate >= TimeEntryStartDate 
And TimeEntryDate <=TimeEntryEndDate) And AccountEMployeeTimeEntryPeriodID is not null)
END
GO
If exists(Select * from SystemData where version = '3.2.2')
BEGIN
Update AccountEmployeeTimeEntry Set AccountEmployeeTimeEntryPeriodId = NULL, 
AccountEmployeeTimeEntryApprovalProjectId = NULL
Where AccountEmployeeTimeEntryPeriodId Not In (Select AccountEmployeeTimeEntryPeriodId 
From AccountEmployeeTimeEntryPeriod Where TimeEntryDate >= TimeEntryStartDate 
And TimeEntryDate <=TimeEntryEndDate) And AccountEMployeeTimeEntryPeriodID is not null
END
GO
If exists(Select * from SystemData where version = '3.2.2')
BEGIN
Delete From AccountEmployeeTimeEntryApprovalProject
Where AccountEmployeeTimeEntryApprovalProjectId Not In 
(Select AccountEmployeeTimeEntryApprovalProjectId From AccountEmployeeTimeEntry
Where AccountEmployeeTimeEntryApprovalProjectId Is Not NULL)
END
GO
If exists(Select * from SystemData where version = '3.2.2')
BEGIN
Delete From AccountEmployeeTimeEntryPeriod
Where AccountEmployeeTimeEntryPeriodId Not In (Select AccountEmployeeTimeEntryPeriodId From AccountEmployeeTimeEntry
Where AccountEmployeeTimeEntryPeriodId Is Not NULL) 
And AccountEmployeeTimeEntryPeriodId Not In (Select AccountEmployeeTimeEntryPeriodId
From AccountEmployeeTimeEntryApprovalProject)
END
GO
If exists(Select * from SystemData where version = '3.2.2')
BEGIN
Update AccountEmployeeTimeEntry Set AccountEmployeeTimeEntry.Submitted =
(Select AccountEmployeeTimeEntryPeriod.Submitted From AccountEmployeeTimeEntryPeriod
Where AccountEmployeeTimeEntry.TimeEntryDate >= AccountEmployeeTimeEntryPeriod.TimeEntryStartDate 
And AccountEmployeeTimeEntry.TimeEntryDate <= AccountEmployeeTimeEntryPeriod.TimeEntryEndDate
And AccountEmployeeTimeEntry.AccountEmployeeId = AccountEmployeeTimeEntryPeriod.AccountEmployeeId) Where
AccountEmployeeTimeEntryPeriodId Is NULL
END
GO
If exists(Select * from SystemData where version = '3.2.2')
BEGIN
Update AccountEmployeeTimeEntry Set AccountEmployeeTimeEntry.Approved =
(Select AccountEmployeeTimeEntryPeriod.Approved From AccountEmployeeTimeEntryPeriod
Where AccountEmployeeTimeEntry.TimeEntryDate >= AccountEmployeeTimeEntryPeriod.TimeEntryStartDate 
And AccountEmployeeTimeEntry.TimeEntryDate <= AccountEmployeeTimeEntryPeriod.TimeEntryEndDate
And AccountEmployeeTimeEntry.AccountEmployeeId = AccountEmployeeTimeEntryPeriod.AccountEmployeeId) Where
AccountEmployeeTimeEntryPeriodId Is NULL
END
GO
If exists(Select * from SystemData where version = '3.2.2')
BEGIN
Update AccountEmployeeTimeEntry Set AccountEmployeeTimeEntry.Rejected =
(Select AccountEmployeeTimeEntryPeriod.Rejected From AccountEmployeeTimeEntryPeriod
Where AccountEmployeeTimeEntry.TimeEntryDate >= AccountEmployeeTimeEntryPeriod.TimeEntryStartDate 
And AccountEmployeeTimeEntry.TimeEntryDate <= AccountEmployeeTimeEntryPeriod.TimeEntryEndDate
And AccountEmployeeTimeEntry.AccountEmployeeId = AccountEmployeeTimeEntryPeriod.AccountEmployeeId) Where
AccountEmployeeTimeEntryPeriodId Is NULL
END
GO
If exists(Select * from SystemData where version = '3.2.2')
BEGIN
Update AccountEmployeeTimeEntry Set AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId =
(Select AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId From AccountEmployeeTimeEntryPeriod
Where AccountEmployeeTimeEntry.TimeEntryDate >= AccountEmployeeTimeEntryPeriod.TimeEntryStartDate 
And AccountEmployeeTimeEntry.TimeEntryDate <= AccountEmployeeTimeEntryPeriod.TimeEntryEndDate
And AccountEmployeeTimeEntry.AccountEmployeeId = AccountEmployeeTimeEntryPeriod.AccountEmployeeId) Where
AccountEmployeeTimeEntryPeriodId Is NULL
END
GO
If exists(Select * from SystemData where version = '3.2.2')
BEGIN
Update AccountEmployeeTimeEntry Set AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId =
(Select top 1 AccountEmployeeTimeEntryApprovalProject.AccountEmployeeTimeEntryApprovalProjectId From AccountEmployeeTimeEntryApprovalProject
Where AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId = AccountEmployeeTimeEntryApprovalProject.AccountEmployeeTimeEntryPeriodId
And AccountEmployeeTimeEntry.AccountEmployeeId = AccountEmployeeTimeEntryApprovalProject.TimeEntryAccountEmployeeId
And AccountEmployeeTimeEntry.AccountProjectId = AccountEmployeeTimeEntryApprovalProject.AccountProjectId) Where
AccountEmployeeTimeEntryApprovalProjectId Is NULL
END
GO
Update SystemData Set Version = '3.2.3' Where Version = '3.2.2' And SystemDataId = 1
GO
-- Drop View vueAccountEmployeeTimeEntryApprovalPendingEmailWithPreference
Print 'Drop View vueAccountEmployeeTimeEntryApprovalPendingEmailWithPreference'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryApprovalPendingEmailWithPreference' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryApprovalPendingEmailWithPreference]
GO
-- Drop View vueAccountEmployeeTimeEntryApprovalPendingEMail
Print 'Drop View vueAccountEmployeeTimeEntryApprovalPendingEMail'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryApprovalPendingEMail' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryApprovalPendingEMail]
GO
-- Drop View vueAccountEmployeeTimeEntryApprovalPendingApprover
Print 'Drop View vueAccountEmployeeTimeEntryApprovalPendingApprover'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryApprovalPendingApprover' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryApprovalPendingApprover]
GO
-- Create View vueAccountEmployeeTimeEntryApprovalPendingApprover
Print 'Create View vueAccountEmployeeTimeEntryApprovalPendingApprover'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryApprovalPendingApprover' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover
AS
SELECT     AccountProjectId, LeaderEmployeeId, ProjectManagerEmployeeId, ApprovalTypeName, AccountApprovalPathId, AccountApprovalTypeId, 
                      SystemApproverTypeId, AccountExternalUserId, AccountEmployeeId, ApprovalPathSequence, AccountEmployeeTimeEntryId, TimeSheetApprovalId, 
                      TimeSheetApprovalPathId, ProjectName, ProjectDescription, ProjectCode, TaskName, AccountProjectTaskId, TaskDescription, EmployeeName, 
                      Approved, TimeSheetApprovalTypeId, TotalTime, TimeEntryDate, Comments, IsReject, IsApproved, MaxApprovalPathSequence, 
                      TimeEntryAccountEmployeeId, AccountId, EMailAddress, EmployeeManagerId, 
                      CASE WHEN systemapprovertypeid = 1 THEN LeaderEmployeeId WHEN systemapprovertypeid = 2 THEN ProjectManagerEmployeeId WHEN systemapprovertypeid
                       = 3 THEN AccountEmployeeId WHEN systemapprovertypeid = 4 THEN AccountExternalUserId WHEN systemapprovertypeid = 5 THEN EmployeeManagerId
                       END AS ApproverEmployeeId, Description, TotalMinutes, NonBillableTotalMinutes, BillableTotalMinutes, AccountEmployeeTimeEntryPeriodId, 
                      EmployeeWeekStartDay, TimeEntryStartDate, TimeEntryEndDate, TimeEntryViewType
FROM         dbo.vueAccountEmployeeTimeEntryApprovalPending'
GO
-- Create View vueAccountEmployeeTimeEntryApprovalPendingEMail
Print 'Create View vueAccountEmployeeTimeEntryApprovalPendingEMail'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryApprovalPendingEMail' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail
AS
SELECT     dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.AccountProjectId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.ProjectManagerEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.ApprovalTypeName, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.AccountApprovalPathId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.AccountApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.SystemApproverTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.AccountExternalUserId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.ApprovalPathSequence, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.AccountEmployeeTimeEntryId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.TimeSheetApprovalId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.TimeSheetApprovalPathId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.ProjectName, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.ProjectDescription, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.ProjectCode, dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.TaskName, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.AccountProjectTaskId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.TaskDescription, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.EmployeeName, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.Approved, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.TotalTime, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.TimeEntryDate, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.Comments, dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.IsReject, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.IsApproved, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.MaxApprovalPathSequence, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.TimeEntryAccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.AccountId, dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.EMailAddress, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.ApproverEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.Description, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.EmployeeManagerId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.TotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.NonBillableTotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.BillableTotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.AccountEmployeeTimeEntryPeriodId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.EmployeeWeekStartDay, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.TimeEntryStartDate, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.TimeEntryEndDate, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.TimeEntryViewType
FROM         dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference ON 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.ApproverEmployeeId = dbo.AccountEMailNotificationPreference.AccountEmployeeId LEFT
                       OUTER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_2 ON 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.AccountProjectId = AccountEMailNotificationPreference_2.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_1 ON 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.AccountId = AccountEMailNotificationPreference_1.AccountId
WHERE     (AccountEMailNotificationPreference_1.SystemEMailNotificationId = 11) AND (AccountEMailNotificationPreference_1.Enabled = 1) AND 
                      (AccountEMailNotificationPreference_2.SystemEMailNotificationId = 12) AND (AccountEMailNotificationPreference_2.Enabled = 1) AND 
                      (dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = 13) AND (dbo.AccountEMailNotificationPreference.Enabled = 1)'
GO
-- Create View vueAccountEmployeeTimeEntryApprovalPendingEmailWithPreference
Print 'Create View vueAccountEmployeeTimeEntryApprovalPendingEmailWithPreference'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryApprovalPendingEmailWithPreference' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailWithPreference
AS
SELECT     dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountProjectId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.ProjectManagerEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.ApprovalTypeName, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountApprovalPathId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.SystemApproverTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountExternalUserId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.ApprovalPathSequence, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountEmployeeTimeEntryId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TimeSheetApprovalId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TimeSheetApprovalPathId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.ProjectName, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.ProjectDescription, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.ProjectCode, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TaskName, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountProjectTaskId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TaskDescription, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.EmployeeName, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.Approved, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TotalTime, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TimeEntryDate, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.Comments, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.IsReject, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.IsApproved, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.MaxApprovalPathSequence, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TimeEntryAccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountId, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.EMailAddress, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.ApproverEmployeeId, dbo.AccountPreferences.ScheduledEmailSendTime, 
                      dbo.AccountEmployee.EMailAddress AS ApproverEMailAddress, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.Description, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.EmployeeManagerId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.NonBillableTotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.BillableTotalMinutes, dbo.AccountPreferences.CultureInfoName, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountEmployeeTimeEntryPeriodId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TimeEntryStartDate, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.EmployeeWeekStartDay, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TimeEntryEndDate, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TimeEntryViewType
FROM         dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail LEFT OUTER JOIN
                      dbo.AccountEmployee ON 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.ApproverEmployeeId = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountPreferences ON dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountId = dbo.AccountPreferences.AccountId'
GO
-- Create View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForProjectManager
Print 'Create View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForProjectManager'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForProjectManager' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForProjectManager
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, MAX(dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName) AS EmployeeName, 
                      MAX(dbo.AccountEmployee.EMailAddress) AS EMailAddress, dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountEmployee.AccountId, 
                      dbo.AccountPreferences.ScheduledEmailSendTime, CASE WHEN MAX(dbo.AccountPreferences.CultureInfoName) IS NULL 
                      THEN ''en-us'' WHEN MAX(dbo.AccountPreferences.CultureInfoName) = ''auto'' THEN ''en-us'' ELSE MAX(dbo.AccountPreferences.CultureInfoName) 
                      END AS CultureInfoName
FROM         dbo.AccountProject INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountProject.ProjectManagerEmployeeId = dbo.AccountEmployee.AccountEmployeeId INNER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployee.AccountId = dbo.AccountPreferences.AccountId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference ON 
                      dbo.AccountEmployee.AccountEmployeeId = dbo.AccountEMailNotificationPreference.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_1 ON 
                      dbo.AccountEmployee.AccountId = AccountEMailNotificationPreference_1.AccountId
WHERE     (dbo.AccountEmployee.EmployeeTypeId <> 2 OR
                      dbo.AccountEmployee.EmployeeTypeId IS NULL) AND (dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = 36) AND 
                      (dbo.AccountEMailNotificationPreference.Enabled = 1) AND (AccountEMailNotificationPreference_1.SystemEMailNotificationId = 35) AND 
                      (AccountEMailNotificationPreference_1.Enabled = 1)
GROUP BY dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountEmployee.AccountId, 
                      dbo.AccountPreferences.ScheduledEmailSendTime'
GO
-- Create View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForEmployeeManager
Print 'Create View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForEmployeeManager'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForEmployeeManager' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForEmployeeManager
AS
SELECT     dbo.AccountPreferences.ScheduledEmailSendTime, MAX(dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName) AS EmployeeName, 
                      AccountEmployee_1.AccountId, dbo.AccountEmployee.LastScheduledEmailSentTime, MAX(dbo.AccountEmployee.EMailAddress) AS EMailAddress, 
                      dbo.AccountEmployee.AccountEmployeeId, CASE WHEN MAX(dbo.AccountPreferences.CultureInfoName) IS NULL 
                      THEN ''en-us'' WHEN MAX(dbo.AccountPreferences.CultureInfoName) = ''auto'' THEN ''en-us'' ELSE MAX(dbo.AccountPreferences.CultureInfoName) 
                      END AS CultureInfoName
FROM         dbo.AccountEmployee INNER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_2 INNER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON 
                      AccountEMailNotificationPreference_2.AccountEmployeeId = AccountEmployee_1.EmployeeManagerId ON 
                      dbo.AccountEmployee.AccountEmployeeId = AccountEmployee_1.EmployeeManagerId RIGHT OUTER JOIN
                      dbo.AccountEMailNotificationPreference ON AccountEmployee_1.AccountId = dbo.AccountEMailNotificationPreference.AccountId LEFT OUTER JOIN
                      dbo.AccountPreferences ON AccountEmployee_1.AccountId = dbo.AccountPreferences.AccountId
WHERE     (AccountEMailNotificationPreference_2.SystemEMailNotificationId = 32) AND (AccountEMailNotificationPreference_2.Enabled = 1) AND 
                      (dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = 31) AND (dbo.AccountEMailNotificationPreference.Enabled = 1) AND 
                      (AccountEmployee_1.EmployeeTypeId <> 2 OR
                      AccountEmployee_1.EmployeeTypeId IS NULL)
GROUP BY dbo.AccountPreferences.ScheduledEmailSendTime, AccountEmployee_1.AccountId, dbo.AccountEmployee.LastScheduledEmailSentTime, 
                      dbo.AccountEmployee.AccountEmployeeId'
GO
-- Create View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForTeamLead
Print 'Create View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForTeamLead'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForTeamLead' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForTeamLead
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, MAX(dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName) AS EmployeeName, 
                      MAX(dbo.AccountEmployee.EMailAddress) AS EMailAddress, dbo.AccountEmployee.LastScheduledEmailSentTime, 
                      dbo.AccountPreferences.ScheduledEmailSendTime, dbo.AccountEmployee.AccountId, CASE WHEN MAX(dbo.AccountPreferences.CultureInfoName) 
                      IS NULL THEN ''en-us'' WHEN MAX(dbo.AccountPreferences.CultureInfoName) 
                      = ''auto'' THEN ''en-us'' ELSE MAX(dbo.AccountPreferences.CultureInfoName) END AS CultureInfoName
FROM         dbo.AccountProject INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountProject.LeaderEmployeeId = dbo.AccountEmployee.AccountEmployeeId INNER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployee.AccountId = dbo.AccountPreferences.AccountId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference ON dbo.AccountEmployee.AccountId = dbo.AccountEMailNotificationPreference.AccountId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_1 ON 
                      dbo.AccountEmployee.AccountEmployeeId = AccountEMailNotificationPreference_1.AccountEmployeeId
WHERE     (dbo.AccountEmployee.EmployeeTypeId <> 2 OR
                      dbo.AccountEmployee.EmployeeTypeId IS NULL) AND (dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = 37) AND 
                      (dbo.AccountEMailNotificationPreference.Enabled = 1) AND (AccountEMailNotificationPreference_1.SystemEMailNotificationId = 38) AND 
                      (AccountEMailNotificationPreference_1.Enabled = 1)
GROUP BY dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountPreferences.ScheduledEmailSendTime, 
                      dbo.AccountEmployee.AccountId'
GO
-- Create View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForAdministrator
Print 'Create View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForAdministrator'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForAdministrator' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForAdministrator
AS
SELECT     dbo.AccountPreferences.ScheduledEmailSendTime, dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, 
                      dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.AccountId, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountRole.Role, dbo.AccountRole.MasterAccountRoleId, 
                      CASE WHEN dbo.AccountPreferences.CultureInfoName IS NULL 
                      THEN ''en-us'' WHEN dbo.AccountPreferences.CultureInfoName = ''auto'' THEN ''en-us'' ELSE CultureInfoName END AS CultureInfoName
FROM         dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_2 RIGHT OUTER JOIN
                      dbo.AccountRole INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountRole.AccountRoleId = dbo.AccountEmployee.AccountRoleId ON 
                      AccountEMailNotificationPreference_2.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference ON dbo.AccountEmployee.AccountId = dbo.AccountEMailNotificationPreference.AccountId LEFT OUTER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployee.AccountId = dbo.AccountPreferences.AccountId
WHERE     (AccountEMailNotificationPreference_2.SystemEMailNotificationId = 34) AND (AccountEMailNotificationPreference_2.Enabled = 1) AND 
                      (dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = 33) AND (dbo.AccountEMailNotificationPreference.Enabled = 1) AND 
                      (dbo.AccountEmployee.EmployeeTypeId <> 2 OR
                      dbo.AccountEmployee.EmployeeTypeId IS NULL) AND (dbo.AccountRole.MasterAccountRoleId = 1)'
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemEMailNotification]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemEMailNotification]'

IF NOT EXISTS (SELECT * FROM [dbo].[SystemEMailNotification] WHERE [SystemEMailNotificationId] = 31)
BEGIN
INSERT INTO [dbo].[SystemEMailNotification] ([SystemEMailNotificationId], [SystemEMailNotification], [SystemEMailNotificationTypeId], [Enabled]) VALUES (31, N'Daily TimeEntry Pending Notification To Employee Manager', 1, 1)
INSERT INTO [dbo].[SystemEMailNotification] ([SystemEMailNotificationId], [SystemEMailNotification], [SystemEMailNotificationTypeId], [Enabled]) VALUES (32, N'Daily TimeEntry Pending Notification To Employee Manager', 3, 1)
INSERT INTO [dbo].[SystemEMailNotification] ([SystemEMailNotificationId], [SystemEMailNotification], [SystemEMailNotificationTypeId], [Enabled]) VALUES (33, N'Daily TimeEntry Pending Notification To Administrator', 1, 1)
INSERT INTO [dbo].[SystemEMailNotification] ([SystemEMailNotificationId], [SystemEMailNotification], [SystemEMailNotificationTypeId], [Enabled]) VALUES (34, N'Daily TimeEntry Pending Notification To Administrator', 3, 1)
INSERT INTO [dbo].[SystemEMailNotification] ([SystemEMailNotificationId], [SystemEMailNotification], [SystemEMailNotificationTypeId], [Enabled]) VALUES (35, N'Daily TimeEntry Pending Notification To Project Manager', 1, 1)
INSERT INTO [dbo].[SystemEMailNotification] ([SystemEMailNotificationId], [SystemEMailNotification], [SystemEMailNotificationTypeId], [Enabled]) VALUES (36, N'Daily TimeEntry Pending Notification To Project Manager', 3, 1)
INSERT INTO [dbo].[SystemEMailNotification] ([SystemEMailNotificationId], [SystemEMailNotification], [SystemEMailNotificationTypeId], [Enabled]) VALUES (37, N'Daily TimeEntry Pending Notification To Team Lead', 1, 1)
INSERT INTO [dbo].[SystemEMailNotification] ([SystemEMailNotificationId], [SystemEMailNotification], [SystemEMailNotificationTypeId], [Enabled]) VALUES (38, N'Daily TimeEntry Pending Notification To Team Lead', 3, 1)
END
GO
-- Create View vueAccountEmployeesWithPreference
Print 'Create View vueAccountEmployeesWithPreference'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeesWithPreference' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeesWithPreference
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.Password, dbo.AccountEmployee.Prefix, dbo.AccountEmployee.FirstName, 
                      dbo.AccountEmployee.LastName, dbo.AccountEmployee.MiddleName, dbo.AccountEmployee.EMailAddress, dbo.AccountEmployee.AccountId, 
                      dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountRoleId, dbo.AccountEmployee.AccountLocationId, 
                      dbo.AccountEmployee.Notes, dbo.AccountEmployee.AddressLine1, dbo.AccountEmployee.AddressLine2, dbo.AccountEmployee.State, 
                      dbo.AccountEmployee.City, dbo.AccountEmployee.Zip, dbo.AccountEmployee.CountryId, dbo.AccountEmployee.HomePhoneNo, 
                      dbo.AccountEmployee.WorkPhoneNo, dbo.AccountEmployee.MobilePhoneNo, dbo.AccountEmployee.TimeEntryApprovalPathId, 
                      dbo.AccountEmployee.BillingRateStateDate, dbo.AccountEmployee.BillingTypeId, dbo.AccountEmployee.StartDate, 
                      dbo.AccountEmployee.TerminationDate, dbo.AccountEmployee.StatusId, dbo.AccountEmployee.IsDeleted, dbo.AccountEmployee.IsDisabled, 
                      dbo.AccountEmployee.DefaultProjectId, dbo.AccountEmployee.TimeZoneId, dbo.AccountEmployee.DefaultEmployee, dbo.AccountEmployee.CreatedOn, 
                      dbo.AccountEmployee.CreatedByEmployeeId, dbo.AccountEmployee.ModifiedOn, dbo.AccountEmployee.ModifiedByEmployeeId, 
                      dbo.AccountEmployee.AllowedAccessFromIP, dbo.AccountEmployee.ExternalUserClientId, dbo.AccountEmployee.EmployeeTypeId, 
                      dbo.AccountEmployee.AccountBillingRateId, dbo.AccountEmployee.Username, dbo.AccountEmployee.EmployeeCode, 
                      dbo.AccountEmployee.EmployeeManagerId, dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.EmployeePayTypeId, 
                      dbo.AccountEmployee.HiredDate, dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountEmployee.LastScheduledEmailSentTime
FROM         dbo.AccountEmployee INNER JOIN
                      dbo.AccountEMailNotificationPreference ON dbo.AccountEmployee.AccountId = dbo.AccountEMailNotificationPreference.AccountId
WHERE     (dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = 1) AND (dbo.AccountEMailNotificationPreference.Enabled = 1)'


GO
-- Drop View vueAccountEmployeeTimeEntryPeriod
Print 'Drop View vueAccountEmployeeTimeEntryPeriod'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPeriod' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryPeriod]
GO
-- Drop View vueAccountEmployeeTimeEntryWithStatus
Print 'Drop View vueAccountEmployeeTimeEntryWithStatus'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithStatus' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryWithStatus]
GO
-- Drop View vueAccountPagePermission
Print 'Drop View vueAccountPagePermission'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountPagePermission' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountPagePermission]
GO
-- Drop Index _dta_index_AccountPagePermission_5_936390405__K2_1_3_4_5_6_7_8_9_10_11 from AccountPagePermission
Print 'Drop Index _dta_index_AccountPagePermission_5_936390405__K2_1_3_4_5_6_7_8_9_10_11 from AccountPagePermission'
GO
IF (EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountPagePermission' AND TABLE_TYPE='BASE TABLE')) AND (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID (N'[dbo].[AccountPagePermission]') AND name = N'_dta_index_AccountPagePermission_5_936390405__K2_1_3_4_5_6_7_8_9_10_11'))
DROP INDEX [dbo].[AccountPagePermission].[_dta_index_AccountPagePermission_5_936390405__K2_1_3_4_5_6_7_8_9_10_11]
GO
-- Add Column CreatedByEmployeeId to AccountEmployeeTimeEntry
Print 'Add Column CreatedByEmployeeId to AccountEmployeeTimeEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntry' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CreatedByEmployeeId' AND TABLE_NAME='AccountEmployeeTimeEntry'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntry]
	ADD [CreatedByEmployeeId] int NULL
GO
-- Add Column ModifiedByEmployeeId to AccountEmployeeTimeEntry
Print 'Add Column ModifiedByEmployeeId to AccountEmployeeTimeEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntry' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='ModifiedByEmployeeId' AND TABLE_NAME='AccountEmployeeTimeEntry'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntry]
	ADD [ModifiedByEmployeeId] int NULL
GO
-- Add Column SubmittedBy to AccountEmployeeTimeEntryPeriod
Print 'Add Column SubmittedBy to AccountEmployeeTimeEntryPeriod'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntryPeriod' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='SubmittedBy' AND TABLE_NAME='AccountEmployeeTimeEntryPeriod'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntryPeriod]
	ADD [SubmittedBy] int NULL
GO
-- Add Column CreatedByEmployeeId to AccountEmployeeTimeEntryPeriod
Print 'Add Column CreatedByEmployeeId to AccountEmployeeTimeEntryPeriod'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntryPeriod' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CreatedByEmployeeId' AND TABLE_NAME='AccountEmployeeTimeEntryPeriod'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntryPeriod]
	ADD [CreatedByEmployeeId] int NULL
GO
-- Add Column ModifiedByEmployeeId to AccountEmployeeTimeEntryPeriod
Print 'Add Column ModifiedByEmployeeId to AccountEmployeeTimeEntryPeriod'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntryPeriod' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='ModifiedByEmployeeId' AND TABLE_NAME='AccountEmployeeTimeEntryPeriod'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntryPeriod]
	ADD [ModifiedByEmployeeId] int NULL
GO
-- Add Column PeriodDescription to AccountEmployeeTimeEntryPeriod
Print 'Add Column PeriodDescription to AccountEmployeeTimeEntryPeriod'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntryPeriod' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='PeriodDescription' AND TABLE_NAME='AccountEmployeeTimeEntryPeriod'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntryPeriod]
	ADD [PeriodDescription] nvarchar(2000) NULL
GO
-- Add Column CreatedOn to AccountEmployeeTimeEntryPeriod
Print 'Add Column CreatedOn to AccountEmployeeTimeEntryPeriod'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntryPeriod' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CreatedOn' AND TABLE_NAME='AccountEmployeeTimeEntryPeriod'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntryPeriod]
	ADD [CreatedOn] datetime NULL
GO
-- Add Column ModifiedOn to AccountEmployeeTimeEntryPeriod
Print 'Add Column ModifiedOn to AccountEmployeeTimeEntryPeriod'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntryPeriod' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='ModifiedOn' AND TABLE_NAME='AccountEmployeeTimeEntryPeriod'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntryPeriod]
	ADD [ModifiedOn] datetime NULL
GO
-- Add Column ShowMySubOrdinatesData to AccountPagePermission
Print 'Add Column ShowMySubOrdinatesData to AccountPagePermission'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountPagePermission' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='ShowMySubOrdinatesData' AND TABLE_NAME='AccountPagePermission'))
ALTER TABLE [dbo].[AccountPagePermission]
	ADD [ShowMySubOrdinatesData] bit NULL
GO
-- Create Index _dta_index_AccountPagePermission_5_936390405__K2_1_3_4_5_6_7_8_9_10_11 on AccountPagePermission
Print 'Create Index _dta_index_AccountPagePermission_5_936390405__K2_1_3_4_5_6_7_8_9_10_11 on AccountPagePermission'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountPagePermission' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountPagePermission]') AND name = N'_dta_index_AccountPagePermission_5_936390405__K2_1_3_4_5_6_7_8_9_10_11'))
CREATE INDEX [_dta_index_AccountPagePermission_5_936390405__K2_1_3_4_5_6_7_8_9_10_11]
	ON [dbo].[AccountPagePermission] ([AccountId])
GO
-- Add Column ShowMySubOrdinatesData to SystemSecurityCategoryMasterAccountRole
Print 'Add Column ShowMySubOrdinatesData to SystemSecurityCategoryMasterAccountRole'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'SystemSecurityCategoryMasterAccountRole' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='ShowMySubOrdinatesData' AND TABLE_NAME='SystemSecurityCategoryMasterAccountRole'))
ALTER TABLE [dbo].[SystemSecurityCategoryMasterAccountRole]
	ADD [ShowMySubOrdinatesData] bit NULL
GO
-- Create View vueAccountPagePermission
Print 'Create View vueAccountPagePermission'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountPagePermission' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountPagePermission
AS
SELECT     dbo.AccountPagePermission.AccountPagePermissionId, dbo.AccountPagePermission.AccountId, dbo.AccountPagePermission.AccountRoleId, 
                      dbo.AccountPagePermission.SystemSecurityCategoryPageId, dbo.AccountPagePermission.ShowAllData, dbo.AccountPagePermission.ShowMyData, 
                      dbo.AccountPagePermission.ShowMyProjectsData, dbo.AccountPagePermission.ShowMyTeamsData, dbo.AccountPagePermission.TillDate, 
                      dbo.AccountPagePermission.TillHours, dbo.SystemSecurityCategoryPage.Folder, dbo.SystemSecurityCategoryPage.SystemCategoryPage, 
                      dbo.SystemSecurityCategoryPage.SystemCategoryPageDescription, dbo.SystemSecurityCategoryPage.IsSiteMapPage, 
                      dbo.SystemPermission.SystemPermission, dbo.AccountRole.Role, dbo.SystemSecurityCategoryPage.ParentSystemSecurityCateogoryPageId, 
                      SystemSecurityCategoryPage_1.SystemCategoryPage AS ParentSystemCategoryPage, 
                      SystemSecurityCategoryPage_1.SystemCategoryPageDescription AS ParentSystemCategoryPageDescription, 
                      SystemSecurityCategoryPage_1.IsSiteMapPage AS ParentIsSiteMapPage, SystemSecurityCategoryPage_1.Folder AS ParentFolder, 
                      dbo.SystemSecurityCategoryPage.SequenceNumber, dbo.AccountPagePermission.SystemPermissionId, 
                      dbo.SystemSecurityCategoryPage.ControlLevelPermission, dbo.AccountPagePermission.ShowMySubOrdinatesData
FROM         dbo.AccountPagePermission INNER JOIN
                      dbo.SystemSecurityCategoryPage ON 
                      dbo.AccountPagePermission.SystemSecurityCategoryPageId = dbo.SystemSecurityCategoryPage.SystemSecurityCategoryPageId INNER JOIN
                      dbo.AccountRole ON dbo.AccountPagePermission.AccountRoleId = dbo.AccountRole.AccountRoleId INNER JOIN
                      dbo.SystemPermission ON dbo.AccountPagePermission.SystemPermissionId = dbo.SystemPermission.SystemPermissionId LEFT OUTER JOIN
                      dbo.SystemSecurityCategoryPage AS SystemSecurityCategoryPage_1 ON 
                      dbo.SystemSecurityCategoryPage.ParentSystemSecurityCateogoryPageId = SystemSecurityCategoryPage_1.SystemSecurityCategoryPageId'
GO
-- Create View vueAccountEmployeeTimeEntryWithStatus
Print 'Create View vueAccountEmployeeTimeEntryWithStatus'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithStatus' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryWithStatus
AS
SELECT     dbo.AccountCostCenter.AccountCostCenter, dbo.AccountProject.ProjectName, dbo.AccountWorkType.AccountWorkType, 
                      dbo.AccountProjectTask.TaskName, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeId, dbo.AccountEmployeeTimeEntry.TimeEntryDate, dbo.AccountEmployeeTimeEntry.StartTime, 
                      dbo.AccountEmployeeTimeEntry.EndTime, dbo.AccountEmployeeTimeEntry.TotalTime, dbo.AccountEmployeeTimeEntry.AccountProjectId, 
                      dbo.AccountEmployeeTimeEntry.AccountProjectTaskId, dbo.AccountEmployeeTimeEntry.Description, 
                      dbo.AccountEmployeeTimeEntry.TimeSheetApprovalPathId, dbo.AccountEmployeeTimeEntry.Approved, 
                      dbo.AccountEmployeeTimeEntry.TeamLeadApproved, dbo.AccountEmployeeTimeEntry.ProjectManagerApproved, 
                      dbo.AccountEmployeeTimeEntry.AdministratorApproved, dbo.AccountEmployeeTimeEntry.CreatedOn, dbo.AccountEmployeeTimeEntry.ModifiedOn, 
                      dbo.AccountEmployeeTimeEntry.Rejected, dbo.AccountEmployeeTimeEntry.BillingRate, dbo.AccountEmployeeTimeEntry.AccountPartyId, 
                      dbo.AccountEmployeeTimeEntry.Submitted, dbo.AccountEmployeeTimeEntry.AccountWorkTypeId, dbo.AccountEmployeeTimeEntry.EmployeeRate, 
                      dbo.AccountEmployeeTimeEntry.AccountCostCenterId, dbo.AccountEmployeeTimeEntry.BillingRateCurrencyId, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateCurrencyId, dbo.AccountEmployeeTimeEntry.BillingRateExchangeRate, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateExchangeRate, dbo.AccountEmployeeTimeEntry.AccountBaseCurrencyId, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeExpenseBillingTimesheetId, dbo.AccountEmployeeTimeEntry.Billed, 
                      dbo.AccountEmployeeTimeEntryApprovalProject.InApproval AS IsApproved, dbo.AccountEmployeeTimeEntryApprovalProject.IsRejected AS IsReject, 
                      dbo.AccountParty.PartyName, dbo.AccountParty.PartyNick, dbo.AccountParty.AccountPartyId AS AccountClientId, 
                      dbo.AccountEmployeeTimeEntryPeriod.PeriodDescription, dbo.AccountParty.AccountId
FROM         dbo.AccountEmployeeTimeEntryApprovalProject RIGHT OUTER JOIN
                      dbo.AccountEmployeeTimeEntry LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryPeriod ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId ON 
                      dbo.AccountEmployeeTimeEntryApprovalProject.AccountEmployeeTimeEntryApprovalProjectId = dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId
                       LEFT OUTER JOIN
                      dbo.AccountParty INNER JOIN
                      dbo.AccountProject ON dbo.AccountParty.AccountPartyId = dbo.AccountProject.AccountClientId ON 
                      dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountProjectTask ON dbo.AccountEmployeeTimeEntry.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId LEFT OUTER JOIN
                      dbo.AccountWorkType ON dbo.AccountEmployeeTimeEntry.AccountWorkTypeId = dbo.AccountWorkType.AccountWorkTypeId LEFT OUTER JOIN
                      dbo.AccountCostCenter ON dbo.AccountEmployeeTimeEntry.AccountCostCenterId = dbo.AccountCostCenter.AccountCostCenterId'
GO
-- Create View vueAccountEmployeeTimeEntryPeriod
Print 'Create View vueAccountEmployeeTimeEntryPeriod'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPeriod' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryPeriod
AS
SELECT     dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId, dbo.AccountEmployeeTimeEntryPeriod.AccountId, 
                      dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeId, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, 
                      dbo.AccountEmployeeTimeEntryPeriod.Submitted, dbo.AccountEmployeeTimeEntryPeriod.Approved, dbo.AccountEmployeeTimeEntryPeriod.Rejected, 
                      dbo.AccountEmployeeTimeEntryPeriod.InApproval, dbo.AccountEmployeeTimeEntryPeriod.SubmittedDate, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS TimeEntryEmployeeName, 
                      AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName AS SubmittedBy
FROM         dbo.AccountEmployeeTimeEntryPeriod INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON dbo.AccountEmployeeTimeEntryPeriod.SubmittedBy = AccountEmployee_1.AccountEmployeeId'
GO
-- =======================================================
-- Foreign Key Constraint Nochecks's for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print ' Foreign Key Constraint Nochecks''s for Table: [dbo].[SystemSecurityCategoryPage]'
ALTER TABLE [dbo].[SystemSecurityCategoryPage] NOCHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory]
ALTER TABLE [dbo].[SystemSecurityCategoryPage] NOCHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory1]
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemSecurityCategoryPage]'
IF NOT EXISTS (SELECT * FROM [dbo].[SystemSecurityCategoryPage] WHERE [SystemSecurityCategoryPageId] = 137)
BEGIN
INSERT INTO [dbo].[SystemSecurityCategoryPage] ([SystemSecurityCategoryPageId], [SystemSecurityCategoryId], [SequenceNumber], [Folder], [SystemCategoryPage], [SystemCategoryPageDescription], [ParentSystemSecurityCateogoryPageId], [IsSiteMapPage], [IsCustomizeable], [IsAllowAdd], [IsAllowEdit], [IsAllowDelete], [IsAllowList], [IsShowDataOptions], [IsShowTillOptions], [IsSystemPage], [ControlLevelPermission], [NotShowInPermission]) VALUES (137, 2, N'22310240', N'Employee', 'AccountEmployeeTimeEntryPeriodList.aspx', 'Timesheet Period List', 18, 1, 1, 0, 0, 0, 1, NULL, NULL, NULL, NULL, 1)
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemSecurityCategoryPage]'
UPDATE [dbo].[SystemSecurityCategoryPage] SET [IsShowDataOptions]=1 WHERE [SystemSecurityCategoryPageId]=18
UPDATE [dbo].[SystemSecurityCategoryPage] SET [NotShowInPermission]=1 WHERE [SystemSecurityCategoryPageId]=19
GO
-- =======================================================
-- Foreign Key Constraint Check's for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print ' Foreign Key Constraint Check''s for Table: [dbo].[SystemSecurityCategoryPage]'
ALTER TABLE [dbo].[SystemSecurityCategoryPage] CHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory]
ALTER TABLE [dbo].[SystemSecurityCategoryPage] CHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory1]
--END 3.2.1
GO
--Start 3.5.1
-- Add Column IsTimeOffApprovalTypes to AccountApprovalType
Print 'Add Column IsTimeOffApprovalTypes to AccountApprovalType'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountApprovalType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='IsTimeOffApprovalTypes' AND TABLE_NAME='AccountApprovalType'))
ALTER TABLE [dbo].[AccountApprovalType]
	ADD [IsTimeOffApprovalTypes] bit NOT NULL
	CONSTRAINT [DF_AccountApprovalType_IsTimeOffApprovalTypes] DEFAULT ((0))
GO
-- Create Table AccountEmployeeTimeOffRequestApproval
Print 'Create Table AccountEmployeeTimeOffRequestApproval'
GO
IF NOT EXISTS (select * from information_schema.tables where table_name = 'AccountEmployeeTimeOffRequestApproval' and table_type = 'BASE TABLE') 
CREATE TABLE [dbo].[AccountEmployeeTimeOffRequestApproval] (
		[AccountEmployeeTimeOffRequestApprovalId]     uniqueidentifier NOT NULL,
		[AccountEmployeeTimeOffRequestId]             uniqueidentifier NOT NULL,
		[TimeOffApprovalTypeId]                       int NOT NULL,
		[TimeOffApprovalPathId]                       int NOT NULL,
		[ApprovedByEmployeeId]                        int NOT NULL,
		[ApprovedOn]                                  datetime NOT NULL,
		[IsRejected]                                  bit NOT NULL,
		[IsApproved]                                  bit NOT NULL,
		[Comments]                                    nvarchar(400) NULL,
		[CreatedByEmployeeId]                         int NULL,
		[CreatedOn]                                   datetime NULL,
		[ModifiedByEmployeeId]                        int NULL,
		[ModifiedOn]                                  datetime NULL
)
GO
-- Add Primary Key PK_AccountEmployeeTimeOffRequestApproval to AccountEmployeeTimeOffRequestApproval
Print 'Add Primary Key PK_AccountEmployeeTimeOffRequestApproval to AccountEmployeeTimeOffRequestApproval'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeOffRequestApproval' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_NAME='PK_AccountEmployeeTimeOffRequestApproval' AND TABLE_NAME='AccountEmployeeTimeOffRequestApproval'))
ALTER TABLE [dbo].[AccountEmployeeTimeOffRequestApproval]
	ADD
	CONSTRAINT [PK_AccountEmployeeTimeOffRequestApproval]
	PRIMARY KEY
	([AccountEmployeeTimeOffRequestApprovalId])
GO
-- Add Default Constraint DF_AccountEmployeeTimeOffRequestApproval_AccountEmployeeTimeOffRequestApprovalId to AccountEmployeeTimeOffRequestApproval
Print 'Add Default Constraint DF_AccountEmployeeTimeOffRequestApproval_AccountEmployeeTimeOffRequestApprovalId to AccountEmployeeTimeOffRequestApproval'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeOffRequestApproval' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM sysobjects WHERE name= N'DF_AccountEmployeeTimeOffRequestApproval_AccountEmployeeTimeOffRequestApprovalId'))
ALTER TABLE [dbo].[AccountEmployeeTimeOffRequestApproval]
	ADD
	CONSTRAINT [DF_AccountEmployeeTimeOffRequestApproval_AccountEmployeeTimeOffRequestApprovalId]
	DEFAULT (newid()) FOR [AccountEmployeeTimeOffRequestApprovalId]
GO
-- Create Index IX_AccountEmployeeTimeOffRequestId on AccountEmployeeTimeOffRequestApproval
Print 'Create Index IX_AccountEmployeeTimeOffRequestId on AccountEmployeeTimeOffRequestApproval'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeOffRequestApproval' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountEmployeeTimeOffRequestApproval]') AND name = N'IX_AccountEmployeeTimeOffRequestId'))
CREATE INDEX [IX_AccountEmployeeTimeOffRequestId]
	ON [dbo].[AccountEmployeeTimeOffRequestApproval] ([AccountEmployeeTimeOffRequestId])
GO
-- Create Index IX_ApprovedByEmployeeId_1 on AccountEmployeeTimeOffRequestApproval
Print 'Create Index IX_ApprovedByEmployeeId_1 on AccountEmployeeTimeOffRequestApproval'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeOffRequestApproval' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountEmployeeTimeOffRequestApproval]') AND name = N'IX_ApprovedByEmployeeId_1'))
CREATE INDEX [IX_ApprovedByEmployeeId_1]
	ON [dbo].[AccountEmployeeTimeOffRequestApproval] ([ApprovedByEmployeeId])
GO
-- Create Index IX_TimeOffApprovalPathId on AccountEmployeeTimeOffRequestApproval
Print 'Create Index IX_TimeOffApprovalPathId on AccountEmployeeTimeOffRequestApproval'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeOffRequestApproval' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountEmployeeTimeOffRequestApproval]') AND name = N'IX_TimeOffApprovalPathId'))
CREATE INDEX [IX_TimeOffApprovalPathId]
	ON [dbo].[AccountEmployeeTimeOffRequestApproval] ([TimeOffApprovalPathId])
GO
-- Create Index IX_TimeOffApprovalTypeId on AccountEmployeeTimeOffRequestApproval
Print 'Create Index IX_TimeOffApprovalTypeId on AccountEmployeeTimeOffRequestApproval'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeOffRequestApproval' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountEmployeeTimeOffRequestApproval]') AND name = N'IX_TimeOffApprovalTypeId'))
CREATE INDEX [IX_TimeOffApprovalTypeId]
	ON [dbo].[AccountEmployeeTimeOffRequestApproval] ([TimeOffApprovalTypeId])
GO
-- Create Table AccountEmployeeTimeOffRequest
Print 'Create Table AccountEmployeeTimeOffRequest'
GO
IF NOT EXISTS (select * from information_schema.tables where table_name = 'AccountEmployeeTimeOffRequest' and table_type = 'BASE TABLE') 
CREATE TABLE [dbo].[AccountEmployeeTimeOffRequest] (
		[AccountEmployeeTimeOffRequestId]     uniqueidentifier NOT NULL,
		[AccountTimeOffTypeId]                uniqueidentifier NOT NULL,
		[AccountEmployeeId]                   int NOT NULL,
		[RequestSubmitDate]                   datetime NOT NULL,
		[HoursOff]                            float NOT NULL,
		[StartDate]                           datetime NOT NULL,
		[EndDate]                             datetime NOT NULL,
		[InApproval]                          bit NULL,
		[Approved]                            bit NULL,
		[Rejected]                            bit NULL,
		[Description]                         nvarchar(2000) NULL,
		[ApprovedOn]                          datetime NULL,
		[ApprovedBy]                          int NULL,
		[DayOff]                              float NOT NULL,
		[CreatedByEmployee]                   int NULL,
		[CreatedOn]                           datetime NULL,
		[ModifiedByEmployeeId]                int NULL,
		[ModifiedOn]                          datetime NULL,
		[AccountId]                           int NOT NULL
)
GO
-- Add Primary Key PK_AccountEmployeeTimeOffRequest to AccountEmployeeTimeOffRequest
Print 'Add Primary Key PK_AccountEmployeeTimeOffRequest to AccountEmployeeTimeOffRequest'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeOffRequest' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_NAME='PK_AccountEmployeeTimeOffRequest' AND TABLE_NAME='AccountEmployeeTimeOffRequest'))
ALTER TABLE [dbo].[AccountEmployeeTimeOffRequest]
	ADD
	CONSTRAINT [PK_AccountEmployeeTimeOffRequest]
	PRIMARY KEY
	([AccountEmployeeTimeOffRequestId])
GO
-- Add Default Constraint DF_AccountEmployeeTimeOffRequest_AccountEmployeeTimeOffRequestId to AccountEmployeeTimeOffRequest
Print 'Add Default Constraint DF_AccountEmployeeTimeOffRequest_AccountEmployeeTimeOffRequestId to AccountEmployeeTimeOffRequest'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeOffRequest' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM sysobjects WHERE name= N'DF_AccountEmployeeTimeOffRequest_AccountEmployeeTimeOffRequestId'))
ALTER TABLE [dbo].[AccountEmployeeTimeOffRequest]
	ADD
	CONSTRAINT [DF_AccountEmployeeTimeOffRequest_AccountEmployeeTimeOffRequestId]
	DEFAULT (newid()) FOR [AccountEmployeeTimeOffRequestId]
GO
-- Add Default Constraint DF_AccountEmployeeTimeOffRequest_Approved to AccountEmployeeTimeOffRequest
Print 'Add Default Constraint DF_AccountEmployeeTimeOffRequest_Approved to AccountEmployeeTimeOffRequest'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeOffRequest' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM sysobjects WHERE name= N'DF_AccountEmployeeTimeOffRequest_Approved'))
ALTER TABLE [dbo].[AccountEmployeeTimeOffRequest]
	ADD
	CONSTRAINT [DF_AccountEmployeeTimeOffRequest_Approved]
	DEFAULT ((0)) FOR [Approved]
GO
-- Add Default Constraint DF_AccountEmployeeTimeOffRequest_CreatedOn to AccountEmployeeTimeOffRequest
Print 'Add Default Constraint DF_AccountEmployeeTimeOffRequest_CreatedOn to AccountEmployeeTimeOffRequest'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeOffRequest' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM sysobjects WHERE name= N'DF_AccountEmployeeTimeOffRequest_CreatedOn'))
ALTER TABLE [dbo].[AccountEmployeeTimeOffRequest]
	ADD
	CONSTRAINT [DF_AccountEmployeeTimeOffRequest_CreatedOn]
	DEFAULT (getdate()) FOR [CreatedOn]
GO
-- Add Default Constraint DF_AccountEmployeeTimeOffRequest_InApproval to AccountEmployeeTimeOffRequest
Print 'Add Default Constraint DF_AccountEmployeeTimeOffRequest_InApproval to AccountEmployeeTimeOffRequest'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeOffRequest' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM sysobjects WHERE name= N'DF_AccountEmployeeTimeOffRequest_InApproval'))
ALTER TABLE [dbo].[AccountEmployeeTimeOffRequest]
	ADD
	CONSTRAINT [DF_AccountEmployeeTimeOffRequest_InApproval]
	DEFAULT ((0)) FOR [InApproval]
GO
-- Add Default Constraint DF_AccountEmployeeTimeOffRequest_ModifiedOn to AccountEmployeeTimeOffRequest
Print 'Add Default Constraint DF_AccountEmployeeTimeOffRequest_ModifiedOn to AccountEmployeeTimeOffRequest'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeOffRequest' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM sysobjects WHERE name= N'DF_AccountEmployeeTimeOffRequest_ModifiedOn'))
ALTER TABLE [dbo].[AccountEmployeeTimeOffRequest]
	ADD
	CONSTRAINT [DF_AccountEmployeeTimeOffRequest_ModifiedOn]
	DEFAULT (getdate()) FOR [ModifiedOn]
GO
-- Add Default Constraint DF_AccountEmployeeTimeOffRequest_Rejected to AccountEmployeeTimeOffRequest
Print 'Add Default Constraint DF_AccountEmployeeTimeOffRequest_Rejected to AccountEmployeeTimeOffRequest'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeOffRequest' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM sysobjects WHERE name= N'DF_AccountEmployeeTimeOffRequest_Rejected'))
ALTER TABLE [dbo].[AccountEmployeeTimeOffRequest]
	ADD
	CONSTRAINT [DF_AccountEmployeeTimeOffRequest_Rejected]
	DEFAULT ((0)) FOR [Rejected]
GO
-- Create Table AccountTimeOffType
Print 'Create Table AccountTimeOffType'
GO
IF NOT EXISTS (select * from information_schema.tables where table_name = 'AccountTimeOffType' and table_type = 'BASE TABLE') 
CREATE TABLE [dbo].[AccountTimeOffType] (
		[AccountTimeOffTypeId]         uniqueidentifier NOT NULL,
		[AccountTimeOffType]           nvarchar(100) NOT NULL,
		[IsTimeOffRequestRequired]     bit NOT NULL,
		[AccountId]                    int NOT NULL,
		[CreatedByEmployeeId]          int NOT NULL,
		[CreatedOn]                    datetime NOT NULL,
		[ModifiedByEmployeeId]         int NOT NULL,
		[ModifiedOn]                   datetime NOT NULL,
		[IsDisabled]                   bit NOT NULL,
		[MasterTimeOffTypeId]          uniqueidentifier NULL
)
GO
-- Add Primary Key PK_AccountTimeOffType to AccountTimeOffType
Print 'Add Primary Key PK_AccountTimeOffType to AccountTimeOffType'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountTimeOffType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_NAME='PK_AccountTimeOffType' AND TABLE_NAME='AccountTimeOffType'))
ALTER TABLE [dbo].[AccountTimeOffType]
	ADD
	CONSTRAINT [PK_AccountTimeOffType]
	PRIMARY KEY
	([AccountTimeOffTypeId])
GO
-- Add Default Constraint DF_AccountTimeOffType_AccountTimeOffTypeId to AccountTimeOffType
Print 'Add Default Constraint DF_AccountTimeOffType_AccountTimeOffTypeId to AccountTimeOffType'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountTimeOffType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM sysobjects WHERE name= N'DF_AccountTimeOffType_AccountTimeOffTypeId'))
ALTER TABLE [dbo].[AccountTimeOffType]
	ADD
	CONSTRAINT [DF_AccountTimeOffType_AccountTimeOffTypeId]
	DEFAULT (newid()) FOR [AccountTimeOffTypeId]
GO
-- Add Default Constraint DF_AccountTimeOffType_CreatedOn to AccountTimeOffType
Print 'Add Default Constraint DF_AccountTimeOffType_CreatedOn to AccountTimeOffType'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountTimeOffType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM sysobjects WHERE name= N'DF_AccountTimeOffType_CreatedOn'))
ALTER TABLE [dbo].[AccountTimeOffType]
	ADD
	CONSTRAINT [DF_AccountTimeOffType_CreatedOn]
	DEFAULT (getdate()) FOR [CreatedOn]
GO
-- Add Default Constraint DF_AccountTimeOffType_IsTimeOffRequestRequired to AccountTimeOffType
Print 'Add Default Constraint DF_AccountTimeOffType_IsTimeOffRequestRequired to AccountTimeOffType'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountTimeOffType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM sysobjects WHERE name= N'DF_AccountTimeOffType_IsTimeOffRequestRequired'))
ALTER TABLE [dbo].[AccountTimeOffType]
	ADD
	CONSTRAINT [DF_AccountTimeOffType_IsTimeOffRequestRequired]
	DEFAULT ((0)) FOR [IsTimeOffRequestRequired]
GO
-- Add Default Constraint DF_AccountTimeOffType_ModifiedOn to AccountTimeOffType
Print 'Add Default Constraint DF_AccountTimeOffType_ModifiedOn to AccountTimeOffType'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountTimeOffType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM sysobjects WHERE name= N'DF_AccountTimeOffType_ModifiedOn'))
ALTER TABLE [dbo].[AccountTimeOffType]
	ADD
	CONSTRAINT [DF_AccountTimeOffType_ModifiedOn]
	DEFAULT (getdate()) FOR [ModifiedOn]
GO
-- Create Table AccountTimeOffPolicy
Print 'Create Table AccountTimeOffPolicy'
GO
IF NOT EXISTS (select * from information_schema.tables where table_name = 'AccountTimeOffPolicy' and table_type = 'BASE TABLE') 
CREATE TABLE [dbo].[AccountTimeOffPolicy] (
		[AccountTimeOffPolicyId]     uniqueidentifier NOT NULL,
		[AccountTimeOffPolicy]       nvarchar(100) NOT NULL,
		[AccountId]                  int NOT NULL,
		[MasterTimeOffPolicyId]      uniqueidentifier NULL,
		[CreatedByEmployeeId]        int NOT NULL,
		[CreatedOn]                  datetime NOT NULL,
		[ModifiedByEmployeeId]       int NOT NULL,
		[ModifiedOn]                 datetime NOT NULL,
		[IsDisabled]                 bit NOT NULL
)
GO
-- Add Primary Key PK_AccountTimeOffPolicy to AccountTimeOffPolicy
Print 'Add Primary Key PK_AccountTimeOffPolicy to AccountTimeOffPolicy'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountTimeOffPolicy' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_NAME='PK_AccountTimeOffPolicy' AND TABLE_NAME='AccountTimeOffPolicy'))
ALTER TABLE [dbo].[AccountTimeOffPolicy]
	ADD
	CONSTRAINT [PK_AccountTimeOffPolicy]
	PRIMARY KEY
	([AccountTimeOffPolicyId])
GO
-- Add Default Constraint DF_AccountTimeOffPolicy_AccountTimeOffPolicyId to AccountTimeOffPolicy
Print 'Add Default Constraint DF_AccountTimeOffPolicy_AccountTimeOffPolicyId to AccountTimeOffPolicy'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountTimeOffPolicy' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM sysobjects WHERE name= N'DF_AccountTimeOffPolicy_AccountTimeOffPolicyId'))
ALTER TABLE [dbo].[AccountTimeOffPolicy]
	ADD
	CONSTRAINT [DF_AccountTimeOffPolicy_AccountTimeOffPolicyId]
	DEFAULT (newid()) FOR [AccountTimeOffPolicyId]
GO
-- Add Default Constraint DF_AccountTimeOffPolicy_CreatedOn to AccountTimeOffPolicy
Print 'Add Default Constraint DF_AccountTimeOffPolicy_CreatedOn to AccountTimeOffPolicy'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountTimeOffPolicy' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM sysobjects WHERE name= N'DF_AccountTimeOffPolicy_CreatedOn'))
ALTER TABLE [dbo].[AccountTimeOffPolicy]
	ADD
	CONSTRAINT [DF_AccountTimeOffPolicy_CreatedOn]
	DEFAULT (getdate()) FOR [CreatedOn]
GO
-- Add Default Constraint DF_AccountTimeOffPolicy_IsDisabled to AccountTimeOffPolicy
Print 'Add Default Constraint DF_AccountTimeOffPolicy_IsDisabled to AccountTimeOffPolicy'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountTimeOffPolicy' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM sysobjects WHERE name= N'DF_AccountTimeOffPolicy_IsDisabled'))
ALTER TABLE [dbo].[AccountTimeOffPolicy]
	ADD
	CONSTRAINT [DF_AccountTimeOffPolicy_IsDisabled]
	DEFAULT ((0)) FOR [IsDisabled]
GO
-- Add Default Constraint DF_AccountTimeOffPolicy_ModifiedOn to AccountTimeOffPolicy
Print 'Add Default Constraint DF_AccountTimeOffPolicy_ModifiedOn to AccountTimeOffPolicy'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountTimeOffPolicy' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM sysobjects WHERE name= N'DF_AccountTimeOffPolicy_ModifiedOn'))
ALTER TABLE [dbo].[AccountTimeOffPolicy]
	ADD
	CONSTRAINT [DF_AccountTimeOffPolicy_ModifiedOn]
	DEFAULT (getdate()) FOR [ModifiedOn]
GO
-- Create Table AccountEmployeeTimeOff
Print 'Create Table AccountEmployeeTimeOff'
GO
IF NOT EXISTS (select * from information_schema.tables where table_name = 'AccountEmployeeTimeOff' and table_type = 'BASE TABLE') 
CREATE TABLE [dbo].[AccountEmployeeTimeOff] (
		[AccountEmployeeTimeOffId]     uniqueidentifier NOT NULL,
		[AccountEmployeeId]            int NOT NULL,
		[AccountId]                    int NOT NULL,
		[AccountTimeOffTypeId]         uniqueidentifier NOT NULL,
		[Earned]                       float NULL,
		[Consume]                      float NULL,
		[Available]                    float NULL,
		[LastEarnedDate]               datetime NULL,
		[CreatedByEmployeeId]          int NULL,
		[CreatedOn]                    datetime NULL,
		[ModifiedByEmployeeId]         int NULL,
		[ModifiedOn]                   datetime NULL,
		[CarryForward]                 float NULL,
		[AccountTimeOffPolicyId]       uniqueidentifier NOT NULL
)
GO
-- Add Primary Key PK_AccountEmployeeTimeOff to AccountEmployeeTimeOff
Print 'Add Primary Key PK_AccountEmployeeTimeOff to AccountEmployeeTimeOff'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeOff' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_NAME='PK_AccountEmployeeTimeOff' AND TABLE_NAME='AccountEmployeeTimeOff'))
ALTER TABLE [dbo].[AccountEmployeeTimeOff]
	ADD
	CONSTRAINT [PK_AccountEmployeeTimeOff]
	PRIMARY KEY
	([AccountEmployeeTimeOffId])
GO
-- Add Default Constraint DF_AccountEmployeeTimeOff_AccountEmployeeTimeOffId to AccountEmployeeTimeOff
Print 'Add Default Constraint DF_AccountEmployeeTimeOff_AccountEmployeeTimeOffId to AccountEmployeeTimeOff'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeOff' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM sysobjects WHERE name= N'DF_AccountEmployeeTimeOff_AccountEmployeeTimeOffId'))
ALTER TABLE [dbo].[AccountEmployeeTimeOff]
	ADD
	CONSTRAINT [DF_AccountEmployeeTimeOff_AccountEmployeeTimeOffId]
	DEFAULT (newid()) FOR [AccountEmployeeTimeOffId]
GO
-- Create Index IX_AccountEmployeeTimeOff on AccountEmployeeTimeOff
Print 'Create Index IX_AccountEmployeeTimeOff on AccountEmployeeTimeOff'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeOff' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountEmployeeTimeOff]') AND name = N'IX_AccountEmployeeTimeOff'))
CREATE UNIQUE INDEX [IX_AccountEmployeeTimeOff]
	ON [dbo].[AccountEmployeeTimeOff] ([AccountId], [AccountEmployeeId], [AccountTimeOffTypeId])
GO
-- Create Table AccountTimeOffPolicyDetail
Print 'Create Table AccountTimeOffPolicyDetail'
GO
IF NOT EXISTS (select * from information_schema.tables where table_name = 'AccountTimeOffPolicyDetail' and table_type = 'BASE TABLE') 
CREATE TABLE [dbo].[AccountTimeOffPolicyDetail] (
		[AccountTimeOffPolicyDetailId]     uniqueidentifier NOT NULL,
		[AccountTimeOffPolicyId]           uniqueidentifier NOT NULL,
		[AccountTimeOffTypeId]             uniqueidentifier NOT NULL,
		[SystemEarnPeriodId]               uniqueidentifier NULL,
		[SystemResetToZeroTypeId]          uniqueidentifier NULL,
		[InitialSetToHours]                float NULL,
		[ResetToHours]                     float NULL,
		[EarnHours]                        float NULL,
		[CarryOver]                        float NULL,
		[MaximumAvailable]                 float NULL,
		[AccountId]                        int NOT NULL,
		[CreatedByEmployeeId]              int NOT NULL,
		[CreatedOn]                        datetime NOT NULL,
		[ModifiedByEmployeeId]             int NOT NULL,
		[ModifiedOn]                       datetime NOT NULL,
		[MasterTimeOffPolicyDetailId]      uniqueidentifier NULL
)
GO
-- Add Primary Key PK_AccountTimeOffPolicyDetail to AccountTimeOffPolicyDetail
Print 'Add Primary Key PK_AccountTimeOffPolicyDetail to AccountTimeOffPolicyDetail'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountTimeOffPolicyDetail' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_NAME='PK_AccountTimeOffPolicyDetail' AND TABLE_NAME='AccountTimeOffPolicyDetail'))
ALTER TABLE [dbo].[AccountTimeOffPolicyDetail]
	ADD
	CONSTRAINT [PK_AccountTimeOffPolicyDetail]
	PRIMARY KEY
	([AccountTimeOffPolicyDetailId])
GO
-- Add Default Constraint DF_AccountTimeOffPolicyDetail_AccountTimeOffPolicyDetailId to AccountTimeOffPolicyDetail
Print 'Add Default Constraint DF_AccountTimeOffPolicyDetail_AccountTimeOffPolicyDetailId to AccountTimeOffPolicyDetail'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountTimeOffPolicyDetail' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM sysobjects WHERE name= N'DF_AccountTimeOffPolicyDetail_AccountTimeOffPolicyDetailId'))
ALTER TABLE [dbo].[AccountTimeOffPolicyDetail]
	ADD
	CONSTRAINT [DF_AccountTimeOffPolicyDetail_AccountTimeOffPolicyDetailId]
	DEFAULT (newid()) FOR [AccountTimeOffPolicyDetailId]
GO
-- Add Default Constraint DF_AccountTimeOffPolicyDetail_CreatedOn to AccountTimeOffPolicyDetail
Print 'Add Default Constraint DF_AccountTimeOffPolicyDetail_CreatedOn to AccountTimeOffPolicyDetail'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountTimeOffPolicyDetail' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM sysobjects WHERE name= N'DF_AccountTimeOffPolicyDetail_CreatedOn'))
ALTER TABLE [dbo].[AccountTimeOffPolicyDetail]
	ADD
	CONSTRAINT [DF_AccountTimeOffPolicyDetail_CreatedOn]
	DEFAULT (getdate()) FOR [CreatedOn]
GO
-- Add Default Constraint DF_AccountTimeOffPolicyDetail_ModifiedOn to AccountTimeOffPolicyDetail
Print 'Add Default Constraint DF_AccountTimeOffPolicyDetail_ModifiedOn to AccountTimeOffPolicyDetail'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountTimeOffPolicyDetail' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM sysobjects WHERE name= N'DF_AccountTimeOffPolicyDetail_ModifiedOn'))
ALTER TABLE [dbo].[AccountTimeOffPolicyDetail]
	ADD
	CONSTRAINT [DF_AccountTimeOffPolicyDetail_ModifiedOn]
	DEFAULT (getdate()) FOR [ModifiedOn]
GO

-- Add Column AccountTimeOffPolicyId to AccountEmployee
Print 'Add Column AccountTimeOffPolicyId to AccountEmployee'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployee' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='AccountTimeOffPolicyId' AND TABLE_NAME='AccountEmployee'))
ALTER TABLE [dbo].[AccountEmployee]
	ADD [AccountTimeOffPolicyId] uniqueidentifier NULL
GO
-- Add Column TimeOffApprovalTypeId to AccountEmployee
Print 'Add Column TimeOffApprovalTypeId to AccountEmployee'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployee' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='TimeOffApprovalTypeId' AND TABLE_NAME='AccountEmployee'))
ALTER TABLE [dbo].[AccountEmployee]
	ADD [TimeOffApprovalTypeId] int NULL
GO
-- Add Column LastTimeOffCalculationScheduledTime to AccountEmployee
Print 'Add Column LastTimeOffCalculationScheduledTime to AccountEmployee'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployee' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='LastTimeOffCalculationScheduledTime' AND TABLE_NAME='AccountEmployee'))
ALTER TABLE [dbo].[AccountEmployee]
	ADD [LastTimeOffCalculationScheduledTime] datetime NULL
GO
-- Add Column InitialPolicy to AccountEmployee
Print 'Add Column InitialPolicy to AccountEmployee'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployee' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='InitialPolicy' AND TABLE_NAME='AccountEmployee'))
ALTER TABLE [dbo].[AccountEmployee]
	ADD [InitialPolicy] bit NULL
GO
-- Create Foreign Key FK_AccountEmployee_AccountApprovalType on AccountEmployee
Print 'Create Foreign Key FK_AccountEmployee_AccountApprovalType on AccountEmployee'
GO
IF NOT EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_SCHEMA='dbo' AND CONSTRAINT_NAME='FK_AccountEmployee_AccountApprovalType' AND TABLE_NAME='AccountEmployee')
BEGIN
		ALTER TABLE [dbo].[AccountEmployee]
			ADD CONSTRAINT [FK_AccountEmployee_AccountApprovalType]
			FOREIGN KEY ([TimeOffApprovalTypeId]) REFERENCES [dbo].[AccountApprovalType] ([AccountApprovalTypeId])
END
GO
-- Create Foreign Key FK_AccountEmployee_AccountTimeOffPolicy on AccountEmployee
Print 'Create Foreign Key FK_AccountEmployee_AccountTimeOffPolicy on AccountEmployee'
GO
IF NOT EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_SCHEMA='dbo' AND CONSTRAINT_NAME='FK_AccountEmployee_AccountTimeOffPolicy' AND TABLE_NAME='AccountEmployee')
BEGIN
		ALTER TABLE [dbo].[AccountEmployee]
			ADD CONSTRAINT [FK_AccountEmployee_AccountTimeOffPolicy]
			FOREIGN KEY ([AccountTimeOffPolicyId]) REFERENCES [dbo].[AccountTimeOffPolicy] ([AccountTimeOffPolicyId])
END
GO
-- Add Column IsTimeOff to AccountEmployeeTimeEntry
Print 'Add Column IsTimeOff to AccountEmployeeTimeEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntry' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='IsTimeOff' AND TABLE_NAME='AccountEmployeeTimeEntry'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntry]
	ADD [IsTimeOff] bit NOT NULL
	CONSTRAINT [DF_AccountEmployeeTimeEntry_IsTimeOff] DEFAULT (0)
GO
-- Add Column Hours to AccountEmployeeTimeEntry
Print 'Add Column Hours to AccountEmployeeTimeEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntry' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='Hours' AND TABLE_NAME='AccountEmployeeTimeEntry'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntry]
	ADD [Hours] float NULL
GO
-- Add Column AccountTimeOffTypeId to AccountEmployeeTimeEntry
Print 'Add Column AccountTimeOffTypeId to AccountEmployeeTimeEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntry' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='AccountTimeOffTypeId' AND TABLE_NAME='AccountEmployeeTimeEntry'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntry]
	ADD [AccountTimeOffTypeId] uniqueidentifier NULL
GO
-- Add Column AccountEmployeeTimeOffRequestId to AccountEmployeeTimeEntry
Print 'Add Column AccountEmployeeTimeOffRequestId to AccountEmployeeTimeEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntry' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='AccountEmployeeTimeOffRequestId' AND TABLE_NAME='AccountEmployeeTimeEntry'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntry]
	ADD [AccountEmployeeTimeOffRequestId] uniqueidentifier NULL
GO
-- Create Foreign Key FK_AccountEmployeeTimeEntry_AccountEmployeeTimeOffRequest on AccountEmployeeTimeEntry
Print 'Create Foreign Key FK_AccountEmployeeTimeEntry_AccountEmployeeTimeOffRequest on AccountEmployeeTimeEntry'
GO
IF NOT EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_SCHEMA='dbo' AND CONSTRAINT_NAME='FK_AccountEmployeeTimeEntry_AccountEmployeeTimeOffRequest' AND TABLE_NAME='AccountEmployeeTimeEntry')
BEGIN
		ALTER TABLE [dbo].[AccountEmployeeTimeEntry]
			ADD CONSTRAINT [FK_AccountEmployeeTimeEntry_AccountEmployeeTimeOffRequest]
			FOREIGN KEY ([AccountEmployeeTimeOffRequestId]) REFERENCES [dbo].[AccountEmployeeTimeOffRequest] ([AccountEmployeeTimeOffRequestId])
			ON DELETE CASCADE
END
GO
-- Create Foreign Key FK_AccountEmployeeTimeEntry_AccountTimeOffType on AccountEmployeeTimeEntry
Print 'Create Foreign Key FK_AccountEmployeeTimeEntry_AccountTimeOffType on AccountEmployeeTimeEntry'
GO
IF NOT EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_SCHEMA='dbo' AND CONSTRAINT_NAME='FK_AccountEmployeeTimeEntry_AccountTimeOffType' AND TABLE_NAME='AccountEmployeeTimeEntry')
BEGIN
		ALTER TABLE [dbo].[AccountEmployeeTimeEntry]
			ADD CONSTRAINT [FK_AccountEmployeeTimeEntry_AccountTimeOffType]
			FOREIGN KEY ([AccountTimeOffTypeId]) REFERENCES [dbo].[AccountTimeOffType] ([AccountTimeOffTypeId])
END
GO
-- Create View vueTimeOffApprovalSequence
Print 'Create View vueTimeOffApprovalSequence'
GO
if not exists (select * from information_schema.tables where table_name = 'vueTimeOffApprovalSequence' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueTimeOffApprovalSequence
AS
SELECT     dbo.AccountEmployeeTimeOffRequest.AccountEmployeeTimeOffRequestId, dbo.AccountEmployee.TimeOffApprovalTypeId, 
                      dbo.AccountApprovalType.AccountApprovalTypeId, dbo.AccountApprovalType.ApprovalTypeName, dbo.AccountApprovalPath.AccountApprovalPathId, 
                      dbo.AccountApprovalPath.SystemApproverTypeId, dbo.AccountApprovalPath.AccountExternalUserId, dbo.AccountApprovalPath.AccountEmployeeId, 
                      dbo.AccountApprovalPath.ApprovalPathSequence, dbo.AccountEmployeeTimeOffRequestApproval.AccountEmployeeTimeOffRequestApprovalId
FROM         dbo.AccountApprovalType INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountApprovalType.AccountApprovalTypeId = dbo.AccountEmployee.TimeOffApprovalTypeId INNER JOIN
                      dbo.AccountApprovalPath ON dbo.AccountApprovalType.AccountApprovalTypeId = dbo.AccountApprovalPath.AccountApprovalTypeId RIGHT OUTER JOIN
                      dbo.AccountEmployeeTimeOffRequest ON 
                      dbo.AccountEmployee.AccountEmployeeId = dbo.AccountEmployeeTimeOffRequest.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeOffRequestApproval ON 
                      dbo.AccountApprovalPath.AccountApprovalPathId = dbo.AccountEmployeeTimeOffRequestApproval.TimeOffApprovalPathId AND 
                      dbo.AccountEmployeeTimeOffRequest.AccountEmployeeTimeOffRequestId = dbo.AccountEmployeeTimeOffRequestApproval.AccountEmployeeTimeOffRequestId
                       AND dbo.AccountEmployeeTimeOffRequestApproval.IsRejected <> 1'
GO
-- Create View vueAccountEmployeeTimeOffRequestApproval
Print 'Create View vueAccountEmployeeTimeOffRequestApproval'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOffRequestApproval' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeOffRequestApproval
AS
SELECT     dbo.AccountEmployeeTimeOffRequest.AccountEmployeeTimeOffRequestId, dbo.AccountEmployeeTimeOffRequest.AccountTimeOffTypeId, 
                      dbo.AccountEmployeeTimeOffRequest.AccountEmployeeId AS TimeOffAccountEmployeeId, dbo.AccountEmployeeTimeOffRequest.RequestSubmitDate, 
                      dbo.AccountEmployeeTimeOffRequest.HoursOff, dbo.AccountEmployeeTimeOffRequest.StartDate, dbo.AccountEmployeeTimeOffRequest.EndDate, 
                      dbo.AccountEmployeeTimeOffRequest.InApproval, dbo.AccountEmployeeTimeOffRequest.Approved, dbo.AccountEmployeeTimeOffRequest.Rejected, 
                      dbo.AccountEmployeeTimeOffRequest.Description, dbo.AccountEmployeeTimeOffRequest.ApprovedOn, 
                      dbo.AccountEmployeeTimeOffRequest.ApprovedBy, dbo.AccountEmployeeTimeOffRequest.DayOff, dbo.AccountEmployeeTimeOffRequest.AccountId, 
                      dbo.AccountApprovalType.ApprovalTypeName, dbo.AccountApprovalPath.AccountApprovalPathId, dbo.AccountApprovalPath.SystemApproverTypeId, 
                      dbo.AccountApprovalPath.AccountExternalUserId, dbo.AccountApprovalPath.ApprovalPathSequence, dbo.AccountApprovalPath.AccountEmployeeId, 
                      dbo.AccountEmployeeTimeOffRequestApproval.TimeOffApprovalPathId, dbo.AccountEmployeeTimeOffRequestApproval.ApprovedByEmployeeId, 
                      dbo.AccountEmployeeTimeOffRequestApproval.ApprovedOn AS ApprovedOnApproval, dbo.AccountEmployeeTimeOffRequestApproval.IsRejected, 
                      dbo.AccountEmployeeTimeOffRequestApproval.IsApproved, dbo.AccountEmployeeTimeOffRequestApproval.Comments, 
                      dbo.AccountEmployeeTimeOffRequestApproval.TimeOffApprovalTypeId, 
                      dbo.AccountEmployeeTimeOffRequestApproval.AccountEmployeeTimeOffRequestApprovalId, dbo.AccountEmployee.FirstName, 
                      dbo.AccountEmployee.LastName, dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS FullName, 
                      dbo.AccountTimeOffType.AccountTimeOffType, dbo.AccountTimeOffType.IsTimeOffRequestRequired, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountApprovalType.AccountApprovalTypeId, dbo.AccountEmployee.EmployeeManagerId, 
                      dbo.AccountEmployeeTimeOffRequestApproval.CreatedByEmployeeId, dbo.AccountEmployeeTimeOffRequestApproval.CreatedOn, 
                      dbo.AccountEmployeeTimeOffRequestApproval.ModifiedByEmployeeId, dbo.AccountEmployeeTimeOffRequestApproval.ModifiedOn
FROM         dbo.AccountApprovalType INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountApprovalType.AccountApprovalTypeId = dbo.AccountEmployee.TimeOffApprovalTypeId INNER JOIN
                      dbo.AccountApprovalPath ON dbo.AccountApprovalType.AccountApprovalTypeId = dbo.AccountApprovalPath.AccountApprovalTypeId RIGHT OUTER JOIN
                      dbo.AccountTimeOffType RIGHT OUTER JOIN
                      dbo.AccountEmployeeTimeOffRequest ON 
                      dbo.AccountTimeOffType.AccountTimeOffTypeId = dbo.AccountEmployeeTimeOffRequest.AccountTimeOffTypeId ON 
                      dbo.AccountEmployee.AccountEmployeeId = dbo.AccountEmployeeTimeOffRequest.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeOffRequestApproval ON 
                      dbo.AccountApprovalPath.AccountApprovalPathId = dbo.AccountEmployeeTimeOffRequestApproval.TimeOffApprovalPathId AND 
                      dbo.AccountEmployeeTimeOffRequest.AccountEmployeeTimeOffRequestId = dbo.AccountEmployeeTimeOffRequestApproval.AccountEmployeeTimeOffRequestId'
GO
-- Create View vueAccountEmployeeTimeOffRequestWithTimeEntryReport
Print 'Create View vueAccountEmployeeTimeOffRequestWithTimeEntryReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOffRequestWithTimeEntryReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeOffRequestWithTimeEntryReport
AS
SELECT     dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, dbo.AccountEmployeeTimeEntry.AccountEmployeeId, 
                      dbo.AccountEmployeeTimeEntry.TimeEntryDate, dbo.AccountEmployeeTimeEntry.StartTime, dbo.AccountEmployeeTimeEntry.EndTime, 
                      dbo.AccountEmployeeTimeEntry.TotalTime, dbo.AccountEmployeeTimeEntry.Description, dbo.AccountEmployeeTimeEntry.Approved, 
                      dbo.AccountEmployeeTimeEntry.CreatedOn, dbo.AccountEmployeeTimeEntry.Submitted, dbo.AccountEmployeeTimeEntry.ModifiedOn, 
                      dbo.AccountEmployeeTimeEntry.Rejected, dbo.AccountEmployeeTimeEntry.IsTimeOff, dbo.AccountEmployeeTimeEntry.Hours, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeOffRequestId, 
                      dbo.AccountTimeOffType.AccountTimeOffType, dbo.AccountTimeOffType.IsTimeOffRequestRequired, dbo.AccountTimeOffType.AccountId, 
                      dbo.AccountEmployeeTimeOffRequest.RequestSubmitDate, ISNULL(dbo.AccountEmployeeTimeOffRequest.HoursOff, 0) AS HoursOff, 
                      dbo.AccountEmployeeTimeOffRequest.StartDate, dbo.AccountEmployeeTimeOffRequest.EndDate, 
                      ISNULL(dbo.AccountEmployeeTimeOffRequest.DayOff, 0) AS DayOff, dbo.AccountEmployeeTimeOffRequest.Description AS RequestDescription, 
                      dbo.AccountEmployeeTimeOffRequest.InApproval AS RequestInApproval, dbo.AccountEmployeeTimeOffRequest.Approved AS RequestApproved, 
                      dbo.AccountEmployeeTimeOffRequest.Rejected AS RequestRejected, dbo.AccountEmployeeTimeOffRequest.ApprovedOn AS RequestApprovedOn, 
                      dbo.AccountEmployeeTimeOffRequest.ApprovedBy AS RequestApprovedBy, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS RequestApprovalEmployeeName, 
                      AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName AS EmployeeName, AccountEmployee_1.EMailAddress, 
                      dbo.AccountDepartment.DepartmentCode, dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountLocation.AccountLocation, 
                      AccountEmployee_1.EmployeeCode, dbo.AccountTimeOffPolicy.AccountTimeOffPolicy, dbo.AccountTimeOffPolicy.AccountTimeOffPolicyId, 
                      dbo.AccountLocation.AccountLocationId, dbo.AccountDepartment.AccountDepartmentId, dbo.AccountRole.AccountRoleId
FROM         dbo.AccountEmployeeTimeEntry LEFT OUTER JOIN
                      dbo.AccountRole RIGHT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON dbo.AccountRole.AccountRoleId = AccountEmployee_1.AccountRoleId LEFT OUTER JOIN
                      dbo.AccountLocation ON AccountEmployee_1.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountDepartment ON AccountEmployee_1.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeId = AccountEmployee_1.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountTimeOffPolicy ON AccountEmployee_1.AccountTimeOffPolicyId = dbo.AccountTimeOffPolicy.AccountTimeOffPolicyId LEFT OUTER JOIN
                      dbo.AccountEmployee RIGHT OUTER JOIN
                      dbo.AccountEmployeeTimeOffRequest ON dbo.AccountEmployee.AccountEmployeeId = dbo.AccountEmployeeTimeOffRequest.ApprovedBy ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeOffRequestId = dbo.AccountEmployeeTimeOffRequest.AccountEmployeeTimeOffRequestId LEFT OUTER
                       JOIN
                      dbo.AccountTimeOffType ON dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId
WHERE     (dbo.AccountEmployeeTimeEntry.IsTimeOff = 1)'
GO
-- Create View vueAccountEmployeeTimeOffForReport
Print 'Create View vueAccountEmployeeTimeOffForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOffForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeOffForReport
AS
SELECT     dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountRoleId, dbo.AccountEmployee.AccountLocationId, 
                      dbo.AccountEmployeeTimeOff.AccountEmployeeTimeOffId, dbo.AccountEmployeeTimeOff.AccountEmployeeId, dbo.AccountEmployeeTimeOff.AccountId, 
                      dbo.AccountEmployeeTimeOff.AccountTimeOffTypeId, dbo.AccountEmployeeTimeOff.Earned, dbo.AccountEmployeeTimeOff.Consume, 
                      dbo.AccountEmployeeTimeOff.Available, dbo.AccountEmployeeTimeOff.LastEarnedDate, dbo.AccountEmployeeTimeOff.CreatedByEmployeeId, 
                      dbo.AccountEmployeeTimeOff.CreatedOn, dbo.AccountEmployeeTimeOff.ModifiedByEmployeeId, dbo.AccountEmployeeTimeOff.ModifiedOn, 
                      dbo.AccountEmployeeTimeOff.CarryForward, dbo.AccountEmployeeTimeOff.AccountTimeOffPolicyId, dbo.AccountTimeOffType.AccountTimeOffType, 
                      dbo.AccountTimeOffType.IsTimeOffRequestRequired, dbo.AccountLocation.AccountLocation, dbo.AccountDepartment.DepartmentCode, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountTimeOffPolicy.AccountTimeOffPolicy, 
                      dbo.AccountEmployee.EmployeeCode
FROM         dbo.AccountEmployee INNER JOIN
                      dbo.AccountEmployeeTimeOff ON dbo.AccountEmployee.AccountEmployeeId = dbo.AccountEmployeeTimeOff.AccountEmployeeId INNER JOIN
                      dbo.AccountTimeOffType ON dbo.AccountEmployeeTimeOff.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId INNER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId INNER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId INNER JOIN
                      dbo.AccountTimeOffPolicy ON dbo.AccountEmployeeTimeOff.AccountTimeOffPolicyId = dbo.AccountTimeOffPolicy.AccountTimeOffPolicyId'
GO
-- Create View vueAccountEmployeeTimeOffRequest
Print 'Create View vueAccountEmployeeTimeOffRequest'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOffRequest' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeOffRequest
AS
SELECT     dbo.AccountEmployeeTimeOffRequest.AccountEmployeeTimeOffRequestId, dbo.AccountEmployeeTimeOffRequest.AccountTimeOffTypeId, 
                      dbo.AccountEmployeeTimeOffRequest.AccountEmployeeId, dbo.AccountEmployeeTimeOffRequest.RequestSubmitDate, 
                      dbo.AccountEmployeeTimeOffRequest.HoursOff, dbo.AccountEmployeeTimeOffRequest.StartDate, dbo.AccountEmployeeTimeOffRequest.EndDate, 
                      dbo.AccountEmployeeTimeOffRequest.InApproval, dbo.AccountEmployeeTimeOffRequest.Approved, dbo.AccountEmployeeTimeOffRequest.Rejected, 
                      dbo.AccountEmployeeTimeOffRequest.Description, dbo.AccountEmployeeTimeOffRequest.ApprovedOn, 
                      dbo.AccountEmployeeTimeOffRequest.ApprovedBy, dbo.AccountEmployeeTimeOffRequest.DayOff, 
                      dbo.AccountEmployeeTimeOffRequest.CreatedByEmployee, dbo.AccountEmployeeTimeOffRequest.CreatedOn, 
                      dbo.AccountEmployeeTimeOffRequest.ModifiedByEmployeeId, dbo.AccountEmployeeTimeOffRequest.ModifiedOn, 
                      dbo.AccountEmployeeTimeOffRequest.AccountId, dbo.AccountTimeOffType.AccountTimeOffType, dbo.AccountTimeOffType.IsTimeOffRequestRequired, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, 
                      CASE WHEN (dbo.AccountEmployeeTimeOffRequest.Approved IS NULL OR
                      dbo.AccountEmployeeTimeOffRequest.Approved = 0) AND (dbo.AccountEmployeeTimeOffRequest.Rejected IS NULL OR
                      dbo.AccountEmployeeTimeOffRequest.Rejected = 0) 
                      THEN ''Submitted'' WHEN dbo.AccountEmployeeTimeOffRequest.Approved = 1 THEN ''Approved'' WHEN dbo.AccountEmployeeTimeOffRequest.Rejected =
                       1 THEN ''Rejected'' END AS ApprovalStatus
FROM         dbo.AccountEmployeeTimeOffRequest INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeOffRequest.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountTimeOffType ON dbo.AccountEmployeeTimeOffRequest.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId'
GO
-- Create View vueAccountEmployeeTimeOffRequestApprovalPending
Print 'Create View vueAccountEmployeeTimeOffRequestApprovalPending'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOffRequestApprovalPending' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeOffRequestApprovalPending
AS
SELECT     dbo.vueAccountEmployeeTimeOffRequestApproval.AccountEmployeeTimeOffRequestId, 
                      dbo.vueAccountEmployeeTimeOffRequestApproval.AccountTimeOffTypeId, 
                      dbo.vueAccountEmployeeTimeOffRequestApproval.TimeOffAccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeOffRequestApproval.RequestSubmitDate, dbo.vueAccountEmployeeTimeOffRequestApproval.HoursOff, 
                      dbo.vueAccountEmployeeTimeOffRequestApproval.StartDate, dbo.vueAccountEmployeeTimeOffRequestApproval.EndDate, 
                      dbo.vueAccountEmployeeTimeOffRequestApproval.InApproval, dbo.vueAccountEmployeeTimeOffRequestApproval.Approved, 
                      dbo.vueAccountEmployeeTimeOffRequestApproval.Rejected, dbo.vueAccountEmployeeTimeOffRequestApproval.Description, 
                      dbo.vueAccountEmployeeTimeOffRequestApproval.ApprovedOn, dbo.vueAccountEmployeeTimeOffRequestApproval.ApprovedBy, 
                      dbo.vueAccountEmployeeTimeOffRequestApproval.DayOff, dbo.vueAccountEmployeeTimeOffRequestApproval.AccountId, 
                      dbo.vueAccountEmployeeTimeOffRequestApproval.ApprovalTypeName, dbo.vueAccountEmployeeTimeOffRequestApproval.AccountApprovalPathId, 
                      dbo.vueAccountEmployeeTimeOffRequestApproval.SystemApproverTypeId, dbo.vueAccountEmployeeTimeOffRequestApproval.AccountExternalUserId, 
                      dbo.vueAccountEmployeeTimeOffRequestApproval.ApprovalPathSequence, dbo.vueAccountEmployeeTimeOffRequestApproval.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeOffRequestApproval.TimeOffApprovalPathId, dbo.vueAccountEmployeeTimeOffRequestApproval.ApprovedByEmployeeId, 
                      MAX(dbo.vueAccountEmployeeTimeOffRequestApproval.ApprovedOnApproval) AS ApprovedOnApproval, 
                      dbo.vueAccountEmployeeTimeOffRequestApproval.IsRejected, dbo.vueAccountEmployeeTimeOffRequestApproval.IsApproved, 
                      MAX(dbo.vueAccountEmployeeTimeOffRequestApproval.Comments) AS Comments, 
                      dbo.vueAccountEmployeeTimeOffRequestApproval.TimeOffApprovalTypeId, dbo.vueAccountEmployeeTimeOffRequestApproval.FirstName, 
                      dbo.vueAccountEmployeeTimeOffRequestApproval.LastName, dbo.vueAccountEmployeeTimeOffRequestApproval.FullName, 
                      dbo.vueAccountEmployeeTimeOffRequestApproval.AccountTimeOffType, 
                      dbo.vueAccountEmployeeTimeOffRequestApproval.IsTimeOffRequestRequired, dbo.vueAccountEmployeeTimeOffRequestApproval.EMailAddress, 
                      dbo.vueAccountEmployeeTimeOffRequestApproval.AccountApprovalTypeId, dbo.vueAccountApproverType.MaxApprovalPathSequence, 
                      dbo.vueAccountEmployeeTimeOffRequestApproval.EmployeeManagerId, dbo.vueAccountEmployeeTimeOffRequestApproval.CreatedByEmployeeId, 
                      MAX(dbo.vueAccountEmployeeTimeOffRequestApproval.CreatedOn) AS CreatedOn
FROM         dbo.vueAccountEmployeeTimeOffRequestApproval INNER JOIN
                      dbo.vueAccountApproverType ON 
                      dbo.vueAccountEmployeeTimeOffRequestApproval.AccountApprovalTypeId = dbo.vueAccountApproverType.AccountApprovalTypeId
WHERE     (dbo.vueAccountEmployeeTimeOffRequestApproval.AccountApprovalPathId IN
                          (SELECT     TOP 1 AccountApprovalPathId
                            FROM          dbo.vueTimeOffApprovalSequence AS vueTimeOffApprovalSequence_1
                            WHERE      (AccountEmployeeTimeOffRequestApprovalId IS NULL) AND 
                                                   (AccountEmployeeTimeOffRequestId = dbo.vueAccountEmployeeTimeOffRequestApproval.AccountEmployeeTimeOffRequestId))) AND 
                      (dbo.vueAccountEmployeeTimeOffRequestApproval.Approved IS NULL OR
                      dbo.vueAccountEmployeeTimeOffRequestApproval.Approved = 0) AND (dbo.vueAccountEmployeeTimeOffRequestApproval.Rejected IS NULL OR
                      dbo.vueAccountEmployeeTimeOffRequestApproval.Rejected = 0)
GROUP BY dbo.vueAccountEmployeeTimeOffRequestApproval.AccountEmployeeTimeOffRequestId, 
                      dbo.vueAccountEmployeeTimeOffRequestApproval.AccountTimeOffTypeId, 
                      dbo.vueAccountEmployeeTimeOffRequestApproval.TimeOffAccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeOffRequestApproval.RequestSubmitDate, dbo.vueAccountEmployeeTimeOffRequestApproval.HoursOff, 
                      dbo.vueAccountEmployeeTimeOffRequestApproval.StartDate, dbo.vueAccountEmployeeTimeOffRequestApproval.EndDate, 
                      dbo.vueAccountEmployeeTimeOffRequestApproval.InApproval, dbo.vueAccountEmployeeTimeOffRequestApproval.Approved, 
                      dbo.vueAccountEmployeeTimeOffRequestApproval.Rejected, dbo.vueAccountEmployeeTimeOffRequestApproval.Description, 
                      dbo.vueAccountEmployeeTimeOffRequestApproval.ApprovedOn, dbo.vueAccountEmployeeTimeOffRequestApproval.ApprovedBy, 
                      dbo.vueAccountEmployeeTimeOffRequestApproval.DayOff, dbo.vueAccountEmployeeTimeOffRequestApproval.AccountId, 
                      dbo.vueAccountEmployeeTimeOffRequestApproval.ApprovalTypeName, dbo.vueAccountEmployeeTimeOffRequestApproval.AccountApprovalPathId, 
                      dbo.vueAccountEmployeeTimeOffRequestApproval.SystemApproverTypeId, dbo.vueAccountEmployeeTimeOffRequestApproval.AccountExternalUserId, 
                      dbo.vueAccountEmployeeTimeOffRequestApproval.ApprovalPathSequence, dbo.vueAccountEmployeeTimeOffRequestApproval.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeOffRequestApproval.TimeOffApprovalPathId, dbo.vueAccountEmployeeTimeOffRequestApproval.ApprovedByEmployeeId, 
                      dbo.vueAccountEmployeeTimeOffRequestApproval.IsRejected, dbo.vueAccountEmployeeTimeOffRequestApproval.IsApproved, 
                      dbo.vueAccountEmployeeTimeOffRequestApproval.TimeOffApprovalTypeId, dbo.vueAccountEmployeeTimeOffRequestApproval.FirstName, 
                      dbo.vueAccountEmployeeTimeOffRequestApproval.LastName, dbo.vueAccountEmployeeTimeOffRequestApproval.FullName, 
                      dbo.vueAccountEmployeeTimeOffRequestApproval.AccountTimeOffType, 
                      dbo.vueAccountEmployeeTimeOffRequestApproval.IsTimeOffRequestRequired, dbo.vueAccountEmployeeTimeOffRequestApproval.EMailAddress, 
                      dbo.vueAccountEmployeeTimeOffRequestApproval.AccountApprovalTypeId, dbo.vueAccountApproverType.MaxApprovalPathSequence, 
                      dbo.vueAccountEmployeeTimeOffRequestApproval.EmployeeManagerId, dbo.vueAccountEmployeeTimeOffRequestApproval.CreatedByEmployeeId'
GO
-- Create Table SystemResetToZeroType
Print 'Create Table SystemResetToZeroType'
GO
IF NOT EXISTS (select * from information_schema.tables where table_name = 'SystemResetToZeroType' and table_type = 'BASE TABLE') 
CREATE TABLE [dbo].[SystemResetToZeroType] (
		[SystemResetToZeroTypeId]     uniqueidentifier NOT NULL,
		[SystemResetToZeroType]       nvarchar(100) NOT NULL
)
GO
-- Add Primary Key PK_SystemResetToZeroType to SystemResetToZeroType
Print 'Add Primary Key PK_SystemResetToZeroType to SystemResetToZeroType'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'SystemResetToZeroType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_NAME='PK_SystemResetToZeroType' AND TABLE_NAME='SystemResetToZeroType'))
ALTER TABLE [dbo].[SystemResetToZeroType]
	ADD
	CONSTRAINT [PK_SystemResetToZeroType]
	PRIMARY KEY
	([SystemResetToZeroTypeId])
GO
-- Add Default Constraint DF_SystemResetToZeroType_SystemResetToZeroTypeId to SystemResetToZeroType
Print 'Add Default Constraint DF_SystemResetToZeroType_SystemResetToZeroTypeId to SystemResetToZeroType'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'SystemResetToZeroType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM sysobjects WHERE name= N'DF_SystemResetToZeroType_SystemResetToZeroTypeId'))
ALTER TABLE [dbo].[SystemResetToZeroType]
	ADD
	CONSTRAINT [DF_SystemResetToZeroType_SystemResetToZeroTypeId]
	DEFAULT (newid()) FOR [SystemResetToZeroTypeId]
GO
-- Create Table SystemEarnPeriod
Print 'Create Table SystemEarnPeriod'
GO
IF NOT EXISTS (select * from information_schema.tables where table_name = 'SystemEarnPeriod' and table_type = 'BASE TABLE') 
CREATE TABLE [dbo].[SystemEarnPeriod] (
		[SystemEarnPeriodId]     uniqueidentifier NOT NULL,
		[SystemEarnPeriod]       nvarchar(100) NOT NULL
)
GO
-- Add Primary Key PK_SystemEarnPeriod to SystemEarnPeriod
Print 'Add Primary Key PK_SystemEarnPeriod to SystemEarnPeriod'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'SystemEarnPeriod' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_NAME='PK_SystemEarnPeriod' AND TABLE_NAME='SystemEarnPeriod'))
ALTER TABLE [dbo].[SystemEarnPeriod]
	ADD
	CONSTRAINT [PK_SystemEarnPeriod]
	PRIMARY KEY
	([SystemEarnPeriodId])
GO
-- Add Default Constraint DF_SystemEarnPeriod_SystemEarnPeriodId to SystemEarnPeriod
Print 'Add Default Constraint DF_SystemEarnPeriod_SystemEarnPeriodId to SystemEarnPeriod'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'SystemEarnPeriod' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM sysobjects WHERE name= N'DF_SystemEarnPeriod_SystemEarnPeriodId'))
ALTER TABLE [dbo].[SystemEarnPeriod]
	ADD
	CONSTRAINT [DF_SystemEarnPeriod_SystemEarnPeriodId]
	DEFAULT (newid()) FOR [SystemEarnPeriodId]
GO
-- Create View vueTimeSheetApprovalSequenceForTimeOff
Print 'Create View vueTimeSheetApprovalSequenceForTimeOff'
GO
if not exists (select * from information_schema.tables where table_name = 'vueTimeSheetApprovalSequenceForTimeOff' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueTimeSheetApprovalSequenceForTimeOff
AS
SELECT     dbo.AccountApprovalType.ApprovalTypeName, dbo.AccountApprovalPath.AccountApprovalPathId, dbo.AccountApprovalPath.AccountApprovalTypeId, 
                      dbo.AccountApprovalPath.SystemApproverTypeId, dbo.AccountApprovalPath.AccountExternalUserId, dbo.AccountApprovalPath.AccountEmployeeId, 
                      dbo.AccountApprovalPath.ApprovalPathSequence, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, 
                      dbo.AccountEmployeeTimeEntryApproval.TimeSheetApprovalId, dbo.AccountEmployeeTimeEntryApproval.TimeSheetApprovalPathId, 
                      dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName
FROM         dbo.AccountEmployee INNER JOIN
                      dbo.AccountEmployeeTimeEntry ON dbo.AccountEmployee.AccountEmployeeId = dbo.AccountEmployeeTimeEntry.AccountEmployeeId INNER JOIN
                      dbo.AccountApprovalType INNER JOIN
                      dbo.AccountApprovalPath ON dbo.AccountApprovalType.AccountApprovalTypeId = dbo.AccountApprovalPath.AccountApprovalTypeId ON 
                      dbo.AccountEmployee.TimeOffApprovalTypeId = dbo.AccountApprovalType.AccountApprovalTypeId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryApproval ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId = dbo.AccountEmployeeTimeEntryApproval.AccountEmployeeTimeEntryId AND 
                      dbo.AccountEmployeeTimeEntryApproval.IsReject <> 1 AND 
                      dbo.AccountApprovalPath.AccountApprovalPathId = dbo.AccountEmployeeTimeEntryApproval.TimeSheetApprovalPathId
WHERE     (dbo.AccountEmployeeTimeEntry.IsTimeOff = 1) AND (dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeOffRequestId IS NULL)'
GO
-- Create View vueAccountEmployeeTimeEntryApprovalForTimeOff
Print 'Create View vueAccountEmployeeTimeEntryApprovalForTimeOff'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryApprovalForTimeOff' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff
AS
SELECT     dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, dbo.AccountEmployeeTimeEntry.AccountEmployeeId AS TimeEntryAccountEmployeeId, 
                      dbo.AccountEmployeeTimeEntry.TimeEntryDate, dbo.AccountEmployeeTimeEntry.StartTime, dbo.AccountEmployeeTimeEntry.EndTime, 
                      dbo.AccountEmployeeTimeEntry.TotalTime, dbo.AccountEmployeeTimeEntry.Description, dbo.AccountEmployeeTimeEntry.Approved, 
                      dbo.AccountEmployeeTimeEntry.AdministratorApproved, dbo.AccountEmployeeTimeEntry.CreatedOn, dbo.AccountEmployeeTimeEntry.Rejected, 
                      dbo.AccountEmployeeTimeEntry.Submitted, dbo.AccountEmployeeTimeEntry.IsTimeOff, dbo.AccountEmployeeTimeEntry.Hours, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeOffRequestId, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountApprovalType.ApprovalTypeName, 
                      dbo.AccountApprovalType.AccountApprovalTypeId, dbo.AccountApprovalPath.AccountApprovalPathId, dbo.AccountApprovalPath.SystemApproverTypeId, 
                      dbo.AccountApprovalPath.AccountExternalUserId, dbo.AccountApprovalPath.ApprovalPathSequence, dbo.AccountApprovalPath.AccountEmployeeId, 
                      dbo.AccountEmployee.EmployeeManagerId, dbo.AccountEmployeeTimeEntry.ModifiedOn, 
                      dbo.AccountEmployeeTimeEntryApproval.TimeSheetApprovalId, dbo.AccountEmployeeTimeEntryApproval.ApprovedByEmployeeId, 
                      dbo.AccountEmployeeTimeEntryApproval.Comments, dbo.AccountEmployeeTimeEntryApproval.IsReject, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountTimeOffType.AccountTimeOffType, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, 
                      dbo.AccountEmployeeTimeEntry.TotalTime) AS TotalMinutes, dbo.AccountEmployeeTimeEntryApproval.IsApproved
FROM         dbo.AccountEmployeeTimeEntry INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeEntry.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId INNER JOIN
                      dbo.AccountApprovalType ON dbo.AccountEmployee.TimeOffApprovalTypeId = dbo.AccountApprovalType.AccountApprovalTypeId INNER JOIN
                      dbo.AccountApprovalPath ON dbo.AccountApprovalType.AccountApprovalTypeId = dbo.AccountApprovalPath.AccountApprovalTypeId LEFT OUTER JOIN
                      dbo.AccountTimeOffType ON 
                      dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryApproval ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId = dbo.AccountEmployeeTimeEntryApproval.AccountEmployeeTimeEntryId AND 
                      dbo.AccountApprovalType.AccountApprovalTypeId = dbo.AccountEmployeeTimeEntryApproval.TimeSheetApprovalTypeId
WHERE     (dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeOffRequestId IS NULL) AND (dbo.AccountEmployeeTimeEntry.IsTimeOff = 1)'
GO
-- Create Table MasterTimeOffPolicyDetail
Print 'Create Table MasterTimeOffPolicyDetail'
GO
IF NOT EXISTS (select * from information_schema.tables where table_name = 'MasterTimeOffPolicyDetail' and table_type = 'BASE TABLE') 
CREATE TABLE [dbo].[MasterTimeOffPolicyDetail] (
		[MasterTimeOffPolicyDetailId]     uniqueidentifier NOT NULL,
		[MasterTimeOffPolicyId]           uniqueidentifier NOT NULL,
		[MasterTimeOffTypeId]             uniqueidentifier NOT NULL,
		[SystemEarnPeriodId]              uniqueidentifier NULL,
		[SystemResetToZeroTypeId]         uniqueidentifier NULL,
		[InitialSetToHours]               float NULL,
		[ResetToHours]                    float NULL,
		[EarnHours]                       float NULL,
		[CarryOver]                       float NULL,
		[AccureDay]                       float NULL,
		[MaximumAvailable]                float NULL
)
GO
-- Add Primary Key PK_MasterTimeOffPolicyDetail to MasterTimeOffPolicyDetail
Print 'Add Primary Key PK_MasterTimeOffPolicyDetail to MasterTimeOffPolicyDetail'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'MasterTimeOffPolicyDetail' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_NAME='PK_MasterTimeOffPolicyDetail' AND TABLE_NAME='MasterTimeOffPolicyDetail'))
ALTER TABLE [dbo].[MasterTimeOffPolicyDetail]
	ADD
	CONSTRAINT [PK_MasterTimeOffPolicyDetail]
	PRIMARY KEY
	([MasterTimeOffPolicyDetailId])
GO
-- Add Default Constraint DF_MasterTimeOffPolicyDetail_MasterTimeOffPolicyDetailId to MasterTimeOffPolicyDetail
Print 'Add Default Constraint DF_MasterTimeOffPolicyDetail_MasterTimeOffPolicyDetailId to MasterTimeOffPolicyDetail'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'MasterTimeOffPolicyDetail' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM sysobjects WHERE name= N'DF_MasterTimeOffPolicyDetail_MasterTimeOffPolicyDetailId'))
ALTER TABLE [dbo].[MasterTimeOffPolicyDetail]
	ADD
	CONSTRAINT [DF_MasterTimeOffPolicyDetail_MasterTimeOffPolicyDetailId]
	DEFAULT (newid()) FOR [MasterTimeOffPolicyDetailId]
GO
-- Create Table MasterTimeOffPolicy
Print 'Create Table MasterTimeOffPolicy'
GO
IF NOT EXISTS (select * from information_schema.tables where table_name = 'MasterTimeOffPolicy' and table_type = 'BASE TABLE') 
CREATE TABLE [dbo].[MasterTimeOffPolicy] (
		[MasterTimeOffPolicyId]     uniqueidentifier NOT NULL,
		[MasterTimeOffPolicy]       nvarchar(100) NOT NULL
)
GO
-- Add Primary Key PK_MasterTimeOffPolicy to MasterTimeOffPolicy
Print 'Add Primary Key PK_MasterTimeOffPolicy to MasterTimeOffPolicy'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'MasterTimeOffPolicy' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_NAME='PK_MasterTimeOffPolicy' AND TABLE_NAME='MasterTimeOffPolicy'))
ALTER TABLE [dbo].[MasterTimeOffPolicy]
	ADD
	CONSTRAINT [PK_MasterTimeOffPolicy]
	PRIMARY KEY
	([MasterTimeOffPolicyId])
GO
-- Add Default Constraint DF_MasterTimeOffPolicy_MasterTimeOffPolicyId to MasterTimeOffPolicy
Print 'Add Default Constraint DF_MasterTimeOffPolicy_MasterTimeOffPolicyId to MasterTimeOffPolicy'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'MasterTimeOffPolicy' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM sysobjects WHERE name= N'DF_MasterTimeOffPolicy_MasterTimeOffPolicyId'))
ALTER TABLE [dbo].[MasterTimeOffPolicy]
	ADD
	CONSTRAINT [DF_MasterTimeOffPolicy_MasterTimeOffPolicyId]
	DEFAULT (newid()) FOR [MasterTimeOffPolicyId]
GO
-- Create Table MasterTimeOffType
Print 'Create Table MasterTimeOffType'
GO
IF NOT EXISTS (select * from information_schema.tables where table_name = 'MasterTimeOffType' and table_type = 'BASE TABLE') 
CREATE TABLE [dbo].[MasterTimeOffType] (
		[MasterTimeOffTypeId]          uniqueidentifier NOT NULL,
		[MasterTimeOffType]            nvarchar(100) NOT NULL,
		[IsTimeOffRequestRequired]     bit NOT NULL
)
GO
-- Add Primary Key PK_MasterTimeOffType to MasterTimeOffType
Print 'Add Primary Key PK_MasterTimeOffType to MasterTimeOffType'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'MasterTimeOffType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_NAME='PK_MasterTimeOffType' AND TABLE_NAME='MasterTimeOffType'))
ALTER TABLE [dbo].[MasterTimeOffType]
	ADD
	CONSTRAINT [PK_MasterTimeOffType]
	PRIMARY KEY
	([MasterTimeOffTypeId])
GO
-- Add Default Constraint DF_MasterTimeOffType_MasterTimeOffTypeId to MasterTimeOffType
Print 'Add Default Constraint DF_MasterTimeOffType_MasterTimeOffTypeId to MasterTimeOffType'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'MasterTimeOffType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM sysobjects WHERE name= N'DF_MasterTimeOffType_MasterTimeOffTypeId'))
ALTER TABLE [dbo].[MasterTimeOffType]
	ADD
	CONSTRAINT [DF_MasterTimeOffType_MasterTimeOffTypeId]
	DEFAULT (newid()) FOR [MasterTimeOffTypeId]
GO
-- Add Default Constraint DF_MasterTimeOffType_IsTimeOffRequestRequired to MasterTimeOffType
Print 'Add Default Constraint DF_MasterTimeOffType_IsTimeOffRequestRequired to MasterTimeOffType'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'MasterTimeOffType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM sysobjects WHERE name= N'DF_MasterTimeOffType_IsTimeOffRequestRequired'))
ALTER TABLE [dbo].[MasterTimeOffType]
	ADD
	CONSTRAINT [DF_MasterTimeOffType_IsTimeOffRequestRequired]
	DEFAULT ((0)) FOR [IsTimeOffRequestRequired]
GO
-- Add Column IsTimeOffApprovalTypes to MasterAccountApprovalType
Print 'Add Column IsTimeOffApprovalTypes to MasterAccountApprovalType'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'MasterAccountApprovalType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='IsTimeOffApprovalTypes' AND TABLE_NAME='MasterAccountApprovalType'))

ALTER TABLE [dbo].[MasterAccountApprovalType]
	ADD [IsTimeOffApprovalTypes] bit NULL

GO
-- Create View vueAccountTimeOffPolicyDetail
Print 'Create View vueAccountTimeOffPolicyDetail'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountTimeOffPolicyDetail' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountTimeOffPolicyDetail
AS
SELECT     dbo.AccountTimeOffPolicyDetail.AccountTimeOffPolicyDetailId, dbo.AccountTimeOffPolicyDetail.AccountTimeOffPolicyId, 
                      dbo.AccountTimeOffPolicyDetail.AccountTimeOffTypeId, dbo.AccountTimeOffPolicyDetail.SystemEarnPeriodId, 
                      dbo.AccountTimeOffPolicyDetail.SystemResetToZeroTypeId, dbo.AccountTimeOffPolicyDetail.InitialSetToHours, 
                      dbo.AccountTimeOffPolicyDetail.ResetToHours, dbo.AccountTimeOffPolicyDetail.EarnHours, dbo.AccountTimeOffPolicyDetail.CarryOver, 
                      dbo.AccountTimeOffPolicyDetail.MaximumAvailable, dbo.AccountTimeOffPolicyDetail.AccountId, dbo.AccountTimeOffPolicyDetail.CreatedByEmployeeId,
                       dbo.AccountTimeOffPolicyDetail.CreatedOn, dbo.AccountTimeOffPolicyDetail.ModifiedByEmployeeId, dbo.AccountTimeOffPolicyDetail.ModifiedOn, 
                      dbo.AccountTimeOffPolicyDetail.MasterTimeOffPolicyDetailId, dbo.AccountTimeOffPolicy.AccountTimeOffPolicy, 
                      dbo.AccountTimeOffPolicy.MasterTimeOffPolicyId, dbo.AccountTimeOffType.AccountTimeOffType, dbo.AccountTimeOffType.IsTimeOffRequestRequired, 
                      dbo.AccountTimeOffType.MasterTimeOffTypeId
FROM         dbo.AccountTimeOffPolicyDetail INNER JOIN
                      dbo.AccountTimeOffPolicy ON dbo.AccountTimeOffPolicyDetail.AccountTimeOffPolicyId = dbo.AccountTimeOffPolicy.AccountTimeOffPolicyId INNER JOIN
                      dbo.AccountTimeOffType ON dbo.AccountTimeOffPolicyDetail.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId'
GO
-- Create View rptvueAccountEmployeeTimeOffRequestWithTimeEntryReport
Print 'Create View rptvueAccountEmployeeTimeOffRequestWithTimeEntryReport'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeOffRequestWithTimeEntryReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountEmployeeTimeOffRequestWithTimeEntryReport
AS
SELECT     AccountEmployeeTimeEntryId, AccountEmployeeId, TimeEntryDate, StartTime, EndTime, TotalTime, Description, Approved, CreatedOn, Submitted, 
                      ModifiedOn, Rejected, IsTimeOff, Hours, AccountTimeOffTypeId, AccountEmployeeTimeOffRequestId, AccountTimeOffType, IsTimeOffRequestRequired, 
                      AccountId, RequestSubmitDate, HoursOff, StartDate, EndDate, DayOff, RequestDescription, RequestInApproval, RequestApproved, RequestRejected, 
                      RequestApprovedOn, RequestApprovedBy, RequestApprovalEmployeeName, EmployeeName, EMailAddress, DepartmentCode, DepartmentName, 
                      Role, AccountLocation, EmployeeCode, AccountTimeOffPolicy, AccountTimeOffPolicyId, AccountLocationId, AccountDepartmentId, AccountRoleId
FROM         dbo.vueAccountEmployeeTimeOffRequestWithTimeEntryReport'
GO
-- Create View rptvueAccountEmployeeTimeOff
Print 'Create View rptvueAccountEmployeeTimeOff'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeOff' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountEmployeeTimeOff
AS
SELECT     EmployeeName, EMailAddress, AccountDepartmentId, AccountRoleId, AccountLocationId, AccountEmployeeTimeOffId, AccountEmployeeId, AccountId, 
                      AccountTimeOffTypeId, Earned, Consume, Available, LastEarnedDate, CreatedByEmployeeId, CreatedOn, ModifiedByEmployeeId, ModifiedOn, 
                      CarryForward, AccountTimeOffPolicyId, AccountTimeOffType, IsTimeOffRequestRequired, AccountLocation, DepartmentCode, DepartmentName, Role, 
                      AccountTimeOffPolicy, EmployeeCode
FROM         dbo.vueAccountEmployeeTimeOffForReport'
GO
-- Create View vueAccountEmployeeTimeOffRequestRejectedEmail
Print 'Create View vueAccountEmployeeTimeOffRequestRejectedEmail'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOffRequestRejectedEmail' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeOffRequestRejectedEmail
AS
SELECT     dbo.vueAccountEmployeeTimeOffRequest.AccountEmployeeTimeOffRequestId, dbo.vueAccountEmployeeTimeOffRequest.AccountTimeOffTypeId, 
                      dbo.vueAccountEmployeeTimeOffRequest.AccountEmployeeId, dbo.vueAccountEmployeeTimeOffRequest.RequestSubmitDate, 
                      dbo.vueAccountEmployeeTimeOffRequest.HoursOff, dbo.vueAccountEmployeeTimeOffRequest.StartDate, 
                      dbo.vueAccountEmployeeTimeOffRequest.EndDate, dbo.vueAccountEmployeeTimeOffRequest.InApproval, 
                      dbo.vueAccountEmployeeTimeOffRequest.Approved, dbo.vueAccountEmployeeTimeOffRequest.Rejected, 
                      dbo.vueAccountEmployeeTimeOffRequest.Description, dbo.vueAccountEmployeeTimeOffRequest.ApprovedOn, 
                      dbo.vueAccountEmployeeTimeOffRequest.ApprovedBy, dbo.vueAccountEmployeeTimeOffRequest.DayOff, 
                      dbo.vueAccountEmployeeTimeOffRequest.CreatedByEmployee, dbo.vueAccountEmployeeTimeOffRequest.CreatedOn, 
                      dbo.vueAccountEmployeeTimeOffRequest.ModifiedByEmployeeId, dbo.vueAccountEmployeeTimeOffRequest.ModifiedOn, 
                      dbo.vueAccountEmployeeTimeOffRequest.AccountId, dbo.vueAccountEmployeeTimeOffRequest.AccountTimeOffType, 
                      dbo.vueAccountEmployeeTimeOffRequest.IsTimeOffRequestRequired, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountEmployeeTimeOffRequestApproval.Comments, dbo.vueAccountEmployeeTimeOffRequest.EmployeeName
FROM         dbo.vueAccountEmployeeTimeOffRequest INNER JOIN
                      dbo.AccountEmployee ON dbo.vueAccountEmployeeTimeOffRequest.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference ON 
                      dbo.vueAccountEmployeeTimeOffRequest.AccountId = dbo.AccountEMailNotificationPreference.AccountId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_1 ON 
                      dbo.vueAccountEmployeeTimeOffRequest.AccountEmployeeId = AccountEMailNotificationPreference_1.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeOffRequestApproval ON 
                      dbo.vueAccountEmployeeTimeOffRequest.AccountEmployeeTimeOffRequestId = dbo.AccountEmployeeTimeOffRequestApproval.AccountEmployeeTimeOffRequestId
WHERE     (AccountEMailNotificationPreference_1.SystemEMailNotificationId = 42) AND (AccountEMailNotificationPreference_1.Enabled = 1) AND 
                      (dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = 41) AND (dbo.AccountEMailNotificationPreference.Enabled = 1)'
GO
-- Create View vueAccountEmployeeTimeOffRequestApprovedEmail
Print 'Create View vueAccountEmployeeTimeOffRequestApprovedEmail'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOffRequestApprovedEmail' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeOffRequestApprovedEmail
AS
SELECT     dbo.vueAccountEmployeeTimeOffRequest.AccountEmployeeTimeOffRequestId, dbo.vueAccountEmployeeTimeOffRequest.AccountTimeOffTypeId, 
                      dbo.vueAccountEmployeeTimeOffRequest.AccountEmployeeId, dbo.vueAccountEmployeeTimeOffRequest.RequestSubmitDate, 
                      dbo.vueAccountEmployeeTimeOffRequest.HoursOff, dbo.vueAccountEmployeeTimeOffRequest.StartDate, 
                      dbo.vueAccountEmployeeTimeOffRequest.EndDate, dbo.vueAccountEmployeeTimeOffRequest.InApproval, 
                      dbo.vueAccountEmployeeTimeOffRequest.Approved, dbo.vueAccountEmployeeTimeOffRequest.Rejected, 
                      dbo.vueAccountEmployeeTimeOffRequest.Description, dbo.vueAccountEmployeeTimeOffRequest.ApprovedOn, 
                      dbo.vueAccountEmployeeTimeOffRequest.ApprovedBy, dbo.vueAccountEmployeeTimeOffRequest.DayOff, 
                      dbo.vueAccountEmployeeTimeOffRequest.CreatedByEmployee, dbo.vueAccountEmployeeTimeOffRequest.CreatedOn, 
                      dbo.vueAccountEmployeeTimeOffRequest.ModifiedByEmployeeId, dbo.vueAccountEmployeeTimeOffRequest.ModifiedOn, 
                      dbo.vueAccountEmployeeTimeOffRequest.AccountId, dbo.vueAccountEmployeeTimeOffRequest.AccountTimeOffType, 
                      dbo.vueAccountEmployeeTimeOffRequest.IsTimeOffRequestRequired, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountEmployeeTimeOffRequestApproval.Comments, dbo.vueAccountEmployeeTimeOffRequest.EmployeeName
FROM         dbo.vueAccountEmployeeTimeOffRequest INNER JOIN
                      dbo.AccountEmployee ON dbo.vueAccountEmployeeTimeOffRequest.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference ON 
                      dbo.vueAccountEmployeeTimeOffRequest.AccountId = dbo.AccountEMailNotificationPreference.AccountId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_1 ON 
                      dbo.vueAccountEmployeeTimeOffRequest.AccountEmployeeId = AccountEMailNotificationPreference_1.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeOffRequestApproval ON 
                      dbo.vueAccountEmployeeTimeOffRequest.AccountEmployeeTimeOffRequestId = dbo.AccountEmployeeTimeOffRequestApproval.AccountEmployeeTimeOffRequestId
WHERE     (AccountEMailNotificationPreference_1.SystemEMailNotificationId = 40) AND (AccountEMailNotificationPreference_1.Enabled = 1) AND 
                      (dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = 39) AND (dbo.AccountEMailNotificationPreference.Enabled = 1)'
GO
-- Create View vueAccountEmployeeTimeOffRequestApprovalPendingApprover
Print 'Create View vueAccountEmployeeTimeOffRequestApprovalPendingApprover'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOffRequestApprovalPendingApprover' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover
AS
SELECT     AccountEmployeeTimeOffRequestId, AccountTimeOffTypeId, TimeOffAccountEmployeeId, RequestSubmitDate, HoursOff, StartDate, EndDate, 
                      InApproval, Approved, Rejected, Description, ApprovedOn, ApprovedBy, DayOff, CreatedByEmployeeId, CreatedOn, AccountId, ApprovalTypeName, 
                      AccountApprovalPathId, SystemApproverTypeId, AccountExternalUserId, ApprovalPathSequence, AccountEmployeeId, TimeOffApprovalPathId, 
                      ApprovedByEmployeeId, ApprovedOnApproval, IsRejected, IsApproved, Comments, TimeOffApprovalTypeId, FirstName, LastName, FullName, 
                      AccountTimeOffType, IsTimeOffRequestRequired, EMailAddress, AccountApprovalTypeId, MaxApprovalPathSequence, EmployeeManagerId, 
                      CASE WHEN systemapprovertypeid = 3 THEN AccountEmployeeId WHEN systemapprovertypeid = 5 THEN EmployeeManagerId END AS ApproverEmployeeId
FROM         dbo.vueAccountEmployeeTimeOffRequestApprovalPending'
GO
-- Create View vueAccountEmployeeTimeOffLastSchedule
Print 'Create View vueAccountEmployeeTimeOffLastSchedule'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOffLastSchedule' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeOffLastSchedule
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.AccountId, dbo.AccountEmployee.AccountTimeOffPolicyId, 
                      dbo.AccountEmployee.TimeOffApprovalTypeId, dbo.AccountEmployee.LastTimeOffCalculationScheduledTime, DATEDIFF(Year, 
                      dbo.AccountEmployee.LastTimeOffCalculationScheduledTime, GETDATE()) AS TotalYears, DATEDIFF(day, 
                      dbo.AccountEmployee.LastTimeOffCalculationScheduledTime, GETDATE()) AS TotalDays, DATEDIFF(month, 
                      dbo.AccountEmployee.LastTimeOffCalculationScheduledTime, GETDATE()) AS TotalMonth, DATEDIFF(week, 
                      dbo.AccountEmployee.LastTimeOffCalculationScheduledTime, GETDATE()) AS TotalWeeks, dbo.AccountTimeOffPolicy.AccountTimeOffPolicy, 
                      dbo.AccountTimeOffPolicy.MasterTimeOffPolicyId, dbo.AccountTimeOffPolicyDetail.AccountTimeOffPolicyDetailId, 
                      dbo.AccountTimeOffPolicyDetail.AccountTimeOffTypeId, dbo.AccountTimeOffPolicyDetail.SystemEarnPeriodId, 
                      dbo.AccountTimeOffPolicyDetail.SystemResetToZeroTypeId, dbo.AccountTimeOffPolicyDetail.ResetToHours, 
                      dbo.AccountTimeOffPolicyDetail.EarnHours, dbo.AccountTimeOffPolicyDetail.CarryOver, dbo.AccountTimeOffPolicyDetail.MaximumAvailable, 
                      dbo.AccountTimeOffPolicyDetail.MasterTimeOffPolicyDetailId, dbo.SystemEarnPeriod.SystemEarnPeriod, 
                      dbo.AccountTimeOffType.AccountTimeOffType, dbo.AccountTimeOffType.IsTimeOffRequestRequired, dbo.AccountTimeOffPolicyDetail.InitialSetToHours, 
                      dbo.AccountEmployee.InitialPolicy, dbo.SystemResetToZeroType.SystemResetToZeroType, dbo.AccountEmployee.EMailAddress
FROM         dbo.SystemResetToZeroType RIGHT OUTER JOIN
                      dbo.AccountTimeOffPolicyDetail INNER JOIN
                      dbo.AccountTimeOffType ON 
                      dbo.AccountTimeOffPolicyDetail.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId RIGHT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.AccountTimeOffPolicy ON dbo.AccountEmployee.AccountTimeOffPolicyId = dbo.AccountTimeOffPolicy.AccountTimeOffPolicyId INNER JOIN
                      dbo.AccountEmployeeTimeOff ON dbo.AccountEmployee.AccountEmployeeId = dbo.AccountEmployeeTimeOff.AccountEmployeeId ON 
                      dbo.AccountTimeOffType.AccountTimeOffTypeId = dbo.AccountEmployeeTimeOff.AccountTimeOffTypeId AND 
                      dbo.AccountTimeOffPolicyDetail.AccountTimeOffPolicyId = dbo.AccountTimeOffPolicy.AccountTimeOffPolicyId LEFT OUTER JOIN
                      dbo.SystemEarnPeriod ON dbo.AccountTimeOffPolicyDetail.SystemEarnPeriodId = dbo.SystemEarnPeriod.SystemEarnPeriodId ON 
                      dbo.SystemResetToZeroType.SystemResetToZeroTypeId = dbo.AccountTimeOffPolicyDetail.SystemResetToZeroTypeId'
GO
-- Create View vueAccountEmployeeTimeEntryApprovalPendingForTimeOff
Print 'Create View vueAccountEmployeeTimeEntryApprovalPendingForTimeOff'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryApprovalPendingForTimeOff' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryApprovalPendingForTimeOff
AS
SELECT     dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountEmployeeTimeEntryId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountEmployeeId, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.TimeEntryDate, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.StartTime, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.EndTime, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.TotalTime, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Description, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Approved, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AdministratorApproved, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.CreatedOn, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Rejected, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Submitted, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.IsTimeOff, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Hours, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountTimeOffTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountEmployeeTimeOffRequestId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.ApprovalTypeName, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountApprovalPathId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.SystemApproverTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountExternalUserId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.ApprovalPathSequence, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.EmployeeManagerId, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.ModifiedOn, 
                      MAX(dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.TimeSheetApprovalId) AS TimeSheetApprovalId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.ApprovedByEmployeeId, 
                      MAX(dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Comments) AS Comments, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.IsReject, dbo.vueAccountApproverType.MaxApprovalPathSequence, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.TimeEntryAccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.EmployeeName, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.EMailAddress, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountTimeOffType, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.TotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.IsApproved
FROM         dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff LEFT OUTER JOIN
                      dbo.vueAccountApproverType ON 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountApprovalTypeId = dbo.vueAccountApproverType.AccountApprovalTypeId
WHERE     (dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountApprovalPathId IN
                          (SELECT     TOP 1 AccountApprovalPathId
                            FROM          dbo.vueTimeSheetApprovalSequenceForTimeOff
                            WHERE      (TimeSheetApprovalId IS NULL) AND 
                                                   (AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountEmployeeTimeEntryId))) AND 
                      (dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Approved = 0) AND 
                      (dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Rejected IS NULL OR
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Rejected = 0) AND (dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Submitted = 1)
GROUP BY dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountEmployeeTimeEntryId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountEmployeeId, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.TimeEntryDate, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.StartTime, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.EndTime, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.TotalTime, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Description, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Approved, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AdministratorApproved, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.CreatedOn, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Rejected, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Submitted, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.IsTimeOff, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Hours, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountTimeOffTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountEmployeeTimeOffRequestId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.ApprovalTypeName, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountApprovalPathId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.SystemApproverTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountExternalUserId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.ApprovalPathSequence, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.EmployeeManagerId, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.ModifiedOn, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.ApprovedByEmployeeId, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.IsReject, 
                      dbo.vueAccountApproverType.MaxApprovalPathSequence, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.TimeEntryAccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.EmployeeName, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.EMailAddress, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountTimeOffType, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.TotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.IsApproved'
GO
-- Create View vueAccountEmployeeTimeOff
Print 'Create View vueAccountEmployeeTimeOff'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOff' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeOff
AS
SELECT     dbo.AccountTimeOffType.AccountTimeOffType, dbo.AccountEmployeeTimeOff.AccountEmployeeTimeOffId, 
                      dbo.AccountEmployeeTimeOff.AccountEmployeeId, dbo.AccountEmployeeTimeOff.AccountId, dbo.AccountEmployeeTimeOff.AccountTimeOffTypeId, 
                      dbo.AccountEmployeeTimeOff.Earned, dbo.AccountEmployeeTimeOff.Consume, dbo.AccountEmployeeTimeOff.Available, 
                      dbo.AccountEmployeeTimeOff.LastEarnedDate, dbo.AccountTimeOffType.IsTimeOffRequestRequired, dbo.AccountEmployeeTimeOff.CarryForward, 
                      dbo.AccountTimeOffPolicy.AccountTimeOffPolicy, dbo.AccountTimeOffPolicy.MasterTimeOffPolicyId, 
                      dbo.AccountEmployeeTimeOff.AccountTimeOffPolicyId
FROM         dbo.AccountEmployeeTimeOff INNER JOIN
                      dbo.AccountTimeOffPolicy ON 
                      dbo.AccountEmployeeTimeOff.AccountTimeOffPolicyId = dbo.AccountTimeOffPolicy.AccountTimeOffPolicyId LEFT OUTER JOIN
                      dbo.AccountTimeOffType ON dbo.AccountEmployeeTimeOff.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId'
GO
-- Create Foreign Key FK_AccountEmployeeTimeOffRequest_AccountTimeOffType on AccountEmployeeTimeOffRequest
Print 'Create Foreign Key FK_AccountEmployeeTimeOffRequest_AccountTimeOffType on AccountEmployeeTimeOffRequest'
GO
IF NOT EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_SCHEMA='dbo' AND CONSTRAINT_NAME='FK_AccountEmployeeTimeOffRequest_AccountTimeOffType' AND TABLE_NAME='AccountEmployeeTimeOffRequest')
BEGIN
		ALTER TABLE [dbo].[AccountEmployeeTimeOffRequest]
			ADD CONSTRAINT [FK_AccountEmployeeTimeOffRequest_AccountTimeOffType]
			FOREIGN KEY ([AccountTimeOffTypeId]) REFERENCES [dbo].[AccountTimeOffType] ([AccountTimeOffTypeId])
END
GO
-- Create Foreign Key FK_AccountEmployeeTimeOffRequestApproval_AccountApprovalPath on AccountEmployeeTimeOffRequestApproval
Print 'Create Foreign Key FK_AccountEmployeeTimeOffRequestApproval_AccountApprovalPath on AccountEmployeeTimeOffRequestApproval'
GO
IF NOT EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_SCHEMA='dbo' AND CONSTRAINT_NAME='FK_AccountEmployeeTimeOffRequestApproval_AccountApprovalPath' AND TABLE_NAME='AccountEmployeeTimeOffRequestApproval')
BEGIN
		ALTER TABLE [dbo].[AccountEmployeeTimeOffRequestApproval]
			ADD CONSTRAINT [FK_AccountEmployeeTimeOffRequestApproval_AccountApprovalPath]
			FOREIGN KEY ([TimeOffApprovalPathId]) REFERENCES [dbo].[AccountApprovalPath] ([AccountApprovalPathId])
END
GO
-- Create Foreign Key FK_AccountEmployeeTimeOffRequestApproval_AccountApprovalType on AccountEmployeeTimeOffRequestApproval
Print 'Create Foreign Key FK_AccountEmployeeTimeOffRequestApproval_AccountApprovalType on AccountEmployeeTimeOffRequestApproval'
GO
IF NOT EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_SCHEMA='dbo' AND CONSTRAINT_NAME='FK_AccountEmployeeTimeOffRequestApproval_AccountApprovalType' AND TABLE_NAME='AccountEmployeeTimeOffRequestApproval')
BEGIN
		ALTER TABLE [dbo].[AccountEmployeeTimeOffRequestApproval]
			ADD CONSTRAINT [FK_AccountEmployeeTimeOffRequestApproval_AccountApprovalType]
			FOREIGN KEY ([TimeOffApprovalTypeId]) REFERENCES [dbo].[AccountApprovalType] ([AccountApprovalTypeId])
END
GO
-- Create Foreign Key FK_AccountEmployeeTimeOffRequestApproval_AccountEmployeeTimeOffRequest on AccountEmployeeTimeOffRequestApproval
Print 'Create Foreign Key FK_AccountEmployeeTimeOffRequestApproval_AccountEmployeeTimeOffRequest on AccountEmployeeTimeOffRequestApproval'
GO
IF NOT EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_SCHEMA='dbo' AND CONSTRAINT_NAME='FK_AccountEmployeeTimeOffRequestApproval_AccountEmployeeTimeOffRequest' AND TABLE_NAME='AccountEmployeeTimeOffRequestApproval')
BEGIN
		ALTER TABLE [dbo].[AccountEmployeeTimeOffRequestApproval]
			ADD CONSTRAINT [FK_AccountEmployeeTimeOffRequestApproval_AccountEmployeeTimeOffRequest]
			FOREIGN KEY ([AccountEmployeeTimeOffRequestId]) REFERENCES [dbo].[AccountEmployeeTimeOffRequest] ([AccountEmployeeTimeOffRequestId])
			ON DELETE CASCADE
END
GO
-- Create Foreign Key FK_AccountTimeOffPolicyDetail_AccountTimeOffPolicy on AccountTimeOffPolicyDetail
Print 'Create Foreign Key FK_AccountTimeOffPolicyDetail_AccountTimeOffPolicy on AccountTimeOffPolicyDetail'
GO
IF NOT EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_SCHEMA='dbo' AND CONSTRAINT_NAME='FK_AccountTimeOffPolicyDetail_AccountTimeOffPolicy' AND TABLE_NAME='AccountTimeOffPolicyDetail')
BEGIN
		ALTER TABLE [dbo].[AccountTimeOffPolicyDetail]
			ADD CONSTRAINT [FK_AccountTimeOffPolicyDetail_AccountTimeOffPolicy]
			FOREIGN KEY ([AccountTimeOffPolicyId]) REFERENCES [dbo].[AccountTimeOffPolicy] ([AccountTimeOffPolicyId])
			ON DELETE CASCADE
END
GO
-- Create Foreign Key FK_AccountTimeOffPolicyDetail_AccountTimeOffType on AccountTimeOffPolicyDetail
Print 'Create Foreign Key FK_AccountTimeOffPolicyDetail_AccountTimeOffType on AccountTimeOffPolicyDetail'
GO
IF NOT EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_SCHEMA='dbo' AND CONSTRAINT_NAME='FK_AccountTimeOffPolicyDetail_AccountTimeOffType' AND TABLE_NAME='AccountTimeOffPolicyDetail')
BEGIN
		ALTER TABLE [dbo].[AccountTimeOffPolicyDetail]
			ADD CONSTRAINT [FK_AccountTimeOffPolicyDetail_AccountTimeOffType]
			FOREIGN KEY ([AccountTimeOffTypeId]) REFERENCES [dbo].[AccountTimeOffType] ([AccountTimeOffTypeId])
END
GO
-- Create Foreign Key FK_AccountEmployeeTimeOff_AccountEmployee on AccountEmployeeTimeOff
Print 'Create Foreign Key FK_AccountEmployeeTimeOff_AccountEmployee on AccountEmployeeTimeOff'
GO
IF NOT EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_SCHEMA='dbo' AND CONSTRAINT_NAME='FK_AccountEmployeeTimeOff_AccountEmployee' AND TABLE_NAME='AccountEmployeeTimeOff')
BEGIN
		ALTER TABLE [dbo].[AccountEmployeeTimeOff]
			ADD CONSTRAINT [FK_AccountEmployeeTimeOff_AccountEmployee]
			FOREIGN KEY ([AccountEmployeeId]) REFERENCES [dbo].[AccountEmployee] ([AccountEmployeeId])
			ON DELETE CASCADE
END
GO
-- Create Foreign Key FK_AccountEmployeeTimeOff_AccountTimeOffPolicy on AccountEmployeeTimeOff
Print 'Create Foreign Key FK_AccountEmployeeTimeOff_AccountTimeOffPolicy on AccountEmployeeTimeOff'
GO
IF NOT EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_SCHEMA='dbo' AND CONSTRAINT_NAME='FK_AccountEmployeeTimeOff_AccountTimeOffPolicy' AND TABLE_NAME='AccountEmployeeTimeOff')
BEGIN
		ALTER TABLE [dbo].[AccountEmployeeTimeOff]
			ADD CONSTRAINT [FK_AccountEmployeeTimeOff_AccountTimeOffPolicy]
			FOREIGN KEY ([AccountTimeOffPolicyId]) REFERENCES [dbo].[AccountTimeOffPolicy] ([AccountTimeOffPolicyId])
			ON DELETE CASCADE
END
GO
-- Create Foreign Key FK_AccountEmployeeTimeOff_AccountTimeOffType on AccountEmployeeTimeOff
Print 'Create Foreign Key FK_AccountEmployeeTimeOff_AccountTimeOffType on AccountEmployeeTimeOff'
GO
IF NOT EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_SCHEMA='dbo' AND CONSTRAINT_NAME='FK_AccountEmployeeTimeOff_AccountTimeOffType' AND TABLE_NAME='AccountEmployeeTimeOff')
BEGIN
		ALTER TABLE [dbo].[AccountEmployeeTimeOff]
			ADD CONSTRAINT [FK_AccountEmployeeTimeOff_AccountTimeOffType]
			FOREIGN KEY ([AccountTimeOffTypeId]) REFERENCES [dbo].[AccountTimeOffType] ([AccountTimeOffTypeId])
			ON DELETE CASCADE
END
GO
-- Drop View vueAccountApproval
Print 'Drop View vueAccountApproval'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountApproval' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountApproval]
GO
-- Create View vueAccountApproval
Print 'Create View vueAccountApproval'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountApproval' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountApproval
AS
SELECT     AccountId, MasterAccountApprovalTypeId, AccountApprovalTypeId, ApprovalTypeName, IsTimeOffApprovalTypes
FROM         dbo.AccountApprovalType'
GO
-- Drop View vueAccountEmployeeTimeEntryWithStatus
Print 'Drop View vueAccountEmployeeTimeEntryWithStatus'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithStatus' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryWithStatus]
GO
-- Drop View vueAccountEmployeeTimeEntryWithLastStatus
Print 'Drop View vueAccountEmployeeTimeEntryWithLastStatus'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithLastStatus' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryWithLastStatus]
GO
-- Create View vueAccountEmployeeTimeEntryWithLastStatus
Print 'Create View vueAccountEmployeeTimeEntryWithLastStatus'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithLastStatus' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryWithLastStatus
AS
SELECT     dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, dbo.AccountEmployeeTimeEntry.AccountEmployeeId, 
                      dbo.AccountEmployeeTimeEntry.TimeEntryDate, dbo.AccountEmployeeTimeEntry.StartTime, dbo.AccountEmployeeTimeEntry.EndTime, 
                      dbo.AccountEmployeeTimeEntry.TotalTime, dbo.AccountEmployeeTimeEntry.AccountProjectId, dbo.AccountEmployeeTimeEntry.AccountProjectTaskId, 
                      dbo.AccountEmployeeTimeEntry.Description, dbo.AccountEmployeeTimeEntry.TimeSheetApprovalPathId, dbo.AccountEmployeeTimeEntry.Approved, 
                      dbo.AccountEmployeeTimeEntry.TeamLeadApproved, dbo.AccountEmployeeTimeEntry.ProjectManagerApproved, 
                      dbo.AccountEmployeeTimeEntry.AdministratorApproved, dbo.AccountEmployeeTimeEntry.CreatedOn, dbo.AccountEmployeeTimeEntry.ModifiedOn, 
                      dbo.AccountEmployeeTimeEntry.Rejected, dbo.AccountEmployeeTimeEntry.BillingRate, 
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction.IsApproved, dbo.vueAccountEmployeeTimeEntryApprovalLastAction.IsReject, 
                      dbo.AccountEmployeeTimeEntry.AccountPartyId, dbo.AccountEmployeeTimeEntry.Submitted, dbo.AccountEmployeeTimeEntry.AccountWorkTypeId, 
                      dbo.AccountEmployeeTimeEntry.AccountCostCenterId, dbo.vueAccountEmployeeTimeEntryApprovalLastAction.ApprovedByEmployeeId, 
                      dbo.AccountProject.ProjectName, dbo.AccountProjectTask.TaskName, dbo.AccountCostCenter.AccountCostCenter, 
                      dbo.AccountWorkType.AccountWorkType, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId, dbo.AccountParty.PartyName, 
                      dbo.AccountParty.AccountPartyId AS AccountClientId, dbo.AccountParty.PartyNick, dbo.vueAccountEmployeeTimeEntryApprovalLastAction.ApprovedOn, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId, dbo.AccountEmployeeTimeEntry.IsTimeOff, 
                      dbo.AccountEmployeeTimeEntry.Hours, dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeOffRequestId
FROM         dbo.AccountParty INNER JOIN
                      dbo.AccountProject ON dbo.AccountParty.AccountPartyId = dbo.AccountProject.AccountClientId RIGHT OUTER JOIN
                      dbo.AccountEmployeeTimeEntry LEFT OUTER JOIN
                      dbo.AccountWorkType ON dbo.AccountEmployeeTimeEntry.AccountWorkTypeId = dbo.AccountWorkType.AccountWorkTypeId ON 
                      dbo.AccountProject.AccountProjectId = dbo.AccountEmployeeTimeEntry.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountProjectTask ON dbo.AccountEmployeeTimeEntry.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId LEFT OUTER JOIN
                      dbo.AccountCostCenter ON dbo.AccountEmployeeTimeEntry.AccountCostCenterId = dbo.AccountCostCenter.AccountCostCenterId LEFT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryApprovalLastAction.AccountEmployeeTimeEntryId'
GO
-- Create View vueAccountEmployeeTimeEntryWithStatus
Print 'Create View vueAccountEmployeeTimeEntryWithStatus'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithStatus' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryWithStatus
AS
SELECT     dbo.AccountCostCenter.AccountCostCenter, dbo.AccountProject.ProjectName, dbo.AccountWorkType.AccountWorkType, 
                      dbo.AccountProjectTask.TaskName, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeId, dbo.AccountEmployeeTimeEntry.TimeEntryDate, dbo.AccountEmployeeTimeEntry.StartTime, 
                      dbo.AccountEmployeeTimeEntry.EndTime, dbo.AccountEmployeeTimeEntry.TotalTime, dbo.AccountEmployeeTimeEntry.AccountProjectId, 
                      dbo.AccountEmployeeTimeEntry.AccountProjectTaskId, dbo.AccountEmployeeTimeEntry.Description, 
                      dbo.AccountEmployeeTimeEntry.TimeSheetApprovalPathId, dbo.AccountEmployeeTimeEntry.Approved, 
                      dbo.AccountEmployeeTimeEntry.TeamLeadApproved, dbo.AccountEmployeeTimeEntry.ProjectManagerApproved, 
                      dbo.AccountEmployeeTimeEntry.AdministratorApproved, dbo.AccountEmployeeTimeEntry.CreatedOn, dbo.AccountEmployeeTimeEntry.ModifiedOn, 
                      dbo.AccountEmployeeTimeEntry.Rejected, dbo.AccountEmployeeTimeEntry.BillingRate, dbo.AccountEmployeeTimeEntry.AccountPartyId, 
                      dbo.AccountEmployeeTimeEntry.Submitted, dbo.AccountEmployeeTimeEntry.AccountWorkTypeId, dbo.AccountEmployeeTimeEntry.EmployeeRate, 
                      dbo.AccountEmployeeTimeEntry.AccountCostCenterId, dbo.AccountEmployeeTimeEntry.BillingRateCurrencyId, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateCurrencyId, dbo.AccountEmployeeTimeEntry.BillingRateExchangeRate, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateExchangeRate, dbo.AccountEmployeeTimeEntry.AccountBaseCurrencyId, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeExpenseBillingTimesheetId, dbo.AccountEmployeeTimeEntry.Billed, 
                      dbo.AccountEmployeeTimeEntryApprovalProject.InApproval AS IsApproved, dbo.AccountEmployeeTimeEntryApprovalProject.IsRejected AS IsReject, 
                      dbo.AccountParty.PartyName, dbo.AccountParty.PartyNick, dbo.AccountParty.AccountPartyId AS AccountClientId, 
                      dbo.AccountEmployeeTimeEntryPeriod.PeriodDescription, dbo.AccountParty.AccountId, dbo.AccountEmployeeTimeEntry.IsTimeOff, 
                      dbo.AccountEmployeeTimeEntry.Hours, dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeOffRequestId, dbo.AccountTimeOffType.AccountTimeOffType, 
                      dbo.AccountTimeOffType.IsTimeOffRequestRequired
FROM         dbo.AccountEmployeeTimeEntryPeriod RIGHT OUTER JOIN
                      dbo.AccountEmployeeTimeEntry LEFT OUTER JOIN
                      dbo.AccountTimeOffType ON dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId ON 
                      dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId LEFT
                       OUTER JOIN
                      dbo.AccountEmployeeTimeEntryApprovalProject ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId = dbo.AccountEmployeeTimeEntryApprovalProject.AccountEmployeeTimeEntryApprovalProjectId
                       LEFT OUTER JOIN
                      dbo.AccountParty INNER JOIN
                      dbo.AccountProject ON dbo.AccountParty.AccountPartyId = dbo.AccountProject.AccountClientId ON 
                      dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountProjectTask ON dbo.AccountEmployeeTimeEntry.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId LEFT OUTER JOIN
                      dbo.AccountWorkType ON dbo.AccountEmployeeTimeEntry.AccountWorkTypeId = dbo.AccountWorkType.AccountWorkTypeId LEFT OUTER JOIN
                      dbo.AccountCostCenter ON dbo.AccountEmployeeTimeEntry.AccountCostCenterId = dbo.AccountCostCenter.AccountCostCenterId'
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[MasterAccountApprovalPath]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[MasterAccountApprovalPath]'
If Not Exists(Select * from [dbo].[MasterAccountApprovalPath] where [MasterAccountApprovalPathId] = 6)
BEGIN
INSERT INTO [dbo].[MasterAccountApprovalPath] ([MasterAccountApprovalPathId], [MasterAccountApprovalTypeId], [SystemApproverTypeId], [ApprovalPathSequence]) VALUES (6, 5, 3, 1)
INSERT INTO [dbo].[MasterAccountApprovalPath] ([MasterAccountApprovalPathId], [MasterAccountApprovalTypeId], [SystemApproverTypeId], [ApprovalPathSequence]) VALUES (7, 6, 5, 1)
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[MasterAccountApprovalType]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[MasterAccountApprovalType]'
If Not Exists(Select * from [dbo].[MasterAccountApprovalType] where [MasterAccountApprovalTypeId] = 5)
BEGIN
INSERT INTO [dbo].[MasterAccountApprovalType] ([MasterAccountApprovalTypeId], [ApprovalTypeName], [IsTimeOffApprovalTypes]) VALUES (5, N'Administrator', 1)
INSERT INTO [dbo].[MasterAccountApprovalType] ([MasterAccountApprovalTypeId], [ApprovalTypeName], [IsTimeOffApprovalTypes]) VALUES (6, N'Employee Manager', 1)
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[MasterTimeOffPolicy]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[MasterTimeOffPolicy]'
If Not Exists(Select * from [dbo].[MasterTimeOffPolicy] where [MasterTimeOffPolicyId] = 'ec43c116-337f-43f1-8836-b63c036aca59')
BEGIN
INSERT INTO [dbo].[MasterTimeOffPolicy] ([MasterTimeOffPolicyId], [MasterTimeOffPolicy]) VALUES ('ec43c116-337f-43f1-8836-b63c036aca59', N'Standard')
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[MasterTimeOffPolicyDetail]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[MasterTimeOffPolicyDetail]'
If Not Exists(Select * from [dbo].[MasterTimeOffPolicyDetail] where [MasterTimeOffPolicyDetailId] = 'baecf128-7d93-4c6f-b0ae-f57502540bee')
BEGIN
INSERT INTO [dbo].[MasterTimeOffPolicyDetail] ([MasterTimeOffPolicyDetailId], [MasterTimeOffPolicyId], [MasterTimeOffTypeId], [SystemEarnPeriodId], [SystemResetToZeroTypeId], [InitialSetToHours], [ResetToHours], [EarnHours], [CarryOver], [AccureDay], [MaximumAvailable]) VALUES ('baecf128-7d93-4c6f-b0ae-f57502540bee', 'ec43c116-337f-43f1-8836-b63c036aca59', '93bbe4c2-8ff0-4ea5-a799-2fd27a1de6f7', NULL, NULL, 0, 0, 0, 0, 0, 0)
INSERT INTO [dbo].[MasterTimeOffPolicyDetail] ([MasterTimeOffPolicyDetailId], [MasterTimeOffPolicyId], [MasterTimeOffTypeId], [SystemEarnPeriodId], [SystemResetToZeroTypeId], [InitialSetToHours], [ResetToHours], [EarnHours], [CarryOver], [AccureDay], [MaximumAvailable]) VALUES ('20bef32d-fc3a-4064-bbb2-43263e9aed29', 'ec43c116-337f-43f1-8836-b63c036aca59', 'c44900ec-bca7-411f-a636-eb65fc4f761f', NULL, NULL, 0, 0, 0, 0, 0, 0)
INSERT INTO [dbo].[MasterTimeOffPolicyDetail] ([MasterTimeOffPolicyDetailId], [MasterTimeOffPolicyId], [MasterTimeOffTypeId], [SystemEarnPeriodId], [SystemResetToZeroTypeId], [InitialSetToHours], [ResetToHours], [EarnHours], [CarryOver], [AccureDay], [MaximumAvailable]) VALUES ('df40313c-b9fa-4820-852b-22066d835657', 'ec43c116-337f-43f1-8836-b63c036aca59', 'd552ef96-0a71-452a-b462-416994709f30', NULL, NULL, 0, 0, 0, 0, 0, 0)
INSERT INTO [dbo].[MasterTimeOffPolicyDetail] ([MasterTimeOffPolicyDetailId], [MasterTimeOffPolicyId], [MasterTimeOffTypeId], [SystemEarnPeriodId], [SystemResetToZeroTypeId], [InitialSetToHours], [ResetToHours], [EarnHours], [CarryOver], [AccureDay], [MaximumAvailable]) VALUES ('5189e253-4523-472d-bca3-adf7d0eebd91', 'ec43c116-337f-43f1-8836-b63c036aca59', 'f21c9fc4-40b2-422f-b0f4-aa31ac9d9852', '86c995dc-262e-4585-ba1c-e7505bee647a', '454e189f-4a08-4a8d-8171-3eba51689a36', 0, 0, 80, 0, 0, 0)
INSERT INTO [dbo].[MasterTimeOffPolicyDetail] ([MasterTimeOffPolicyDetailId], [MasterTimeOffPolicyId], [MasterTimeOffTypeId], [SystemEarnPeriodId], [SystemResetToZeroTypeId], [InitialSetToHours], [ResetToHours], [EarnHours], [CarryOver], [AccureDay], [MaximumAvailable]) VALUES ('84192685-7e0b-4135-b8f1-607ad841a680', 'ec43c116-337f-43f1-8836-b63c036aca59', '267f0580-69c9-4025-a3df-9627d5a2be2e', NULL, NULL, 0, 0, 0, 0, 0, 0)
INSERT INTO [dbo].[MasterTimeOffPolicyDetail] ([MasterTimeOffPolicyDetailId], [MasterTimeOffPolicyId], [MasterTimeOffTypeId], [SystemEarnPeriodId], [SystemResetToZeroTypeId], [InitialSetToHours], [ResetToHours], [EarnHours], [CarryOver], [AccureDay], [MaximumAvailable]) VALUES ('212b96de-4e65-4526-af9c-f69a3910d803', 'ec43c116-337f-43f1-8836-b63c036aca59', '8785065f-7a56-41d2-9959-be23cc0fa55a', '86c995dc-262e-4585-ba1c-e7505bee647a', '454e189f-4a08-4a8d-8171-3eba51689a36', 40, 40, 40, 0, 0, 0)
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[MasterTimeOffType]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[MasterTimeOffType]'
If Not Exists(Select * from [dbo].[MasterTimeOffType] where [MasterTimeOffTypeId] = '8785065f-7a56-41d2-9959-be23cc0fa55a')
BEGIN
INSERT INTO [dbo].[MasterTimeOffType] ([MasterTimeOffTypeId], [MasterTimeOffType], [IsTimeOffRequestRequired]) VALUES ('8785065f-7a56-41d2-9959-be23cc0fa55a', N'Sick Leave', 0)
INSERT INTO [dbo].[MasterTimeOffType] ([MasterTimeOffTypeId], [MasterTimeOffType], [IsTimeOffRequestRequired]) VALUES ('267f0580-69c9-4025-a3df-9627d5a2be2e', N'Personal Leave', 1)
INSERT INTO [dbo].[MasterTimeOffType] ([MasterTimeOffTypeId], [MasterTimeOffType], [IsTimeOffRequestRequired]) VALUES ('d552ef96-0a71-452a-b462-416994709f30', N'Holiday', 0)
INSERT INTO [dbo].[MasterTimeOffType] ([MasterTimeOffTypeId], [MasterTimeOffType], [IsTimeOffRequestRequired]) VALUES ('93bbe4c2-8ff0-4ea5-a799-2fd27a1de6f7', N'Training', 1)
INSERT INTO [dbo].[MasterTimeOffType] ([MasterTimeOffTypeId], [MasterTimeOffType], [IsTimeOffRequestRequired]) VALUES ('f21c9fc4-40b2-422f-b0f4-aa31ac9d9852', N'Vacation', 1)
INSERT INTO [dbo].[MasterTimeOffType] ([MasterTimeOffTypeId], [MasterTimeOffType], [IsTimeOffRequestRequired]) VALUES ('c44900ec-bca7-411f-a636-eb65fc4f761f', N'Other', 1)
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemEarnPeriod]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemEarnPeriod]'
If Not Exists(Select * from [dbo].[SystemEarnPeriod] where [SystemEarnPeriodId] = '2986af3c-cd0b-475a-ae46-5aaaa17c7fb7')
BEGIN
INSERT INTO [dbo].[SystemEarnPeriod] ([SystemEarnPeriodId], [SystemEarnPeriod]) VALUES ('2986af3c-cd0b-475a-ae46-5aaaa17c7fb7', N'Each Week')
INSERT INTO [dbo].[SystemEarnPeriod] ([SystemEarnPeriodId], [SystemEarnPeriod]) VALUES ('294ecfd4-52bb-44f1-bfe1-6e2429bba0e1', N'Each Year Anniversary Day')
INSERT INTO [dbo].[SystemEarnPeriod] ([SystemEarnPeriodId], [SystemEarnPeriod]) VALUES ('86c995dc-262e-4585-ba1c-e7505bee647a', N'Each Year')
INSERT INTO [dbo].[SystemEarnPeriod] ([SystemEarnPeriodId], [SystemEarnPeriod]) VALUES ('564f54f2-3d71-46e8-8c99-f07c8aa65dc0', N'Each Month')
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSource]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSource]'
If Not Exists(Select * from [dbo].[SystemReportDataSource] where [SystemReportDataSourceId] = '996917c1-62f6-44d5-be81-30254953fce3')
BEGIN
INSERT INTO [dbo].[SystemReportDataSource] ([SystemReportDataSourceId], [ReportDataSourceName], [ReportDatasource], [ReportDataSourceType], [DefaultIconPath]) VALUES ('996917c1-62f6-44d5-be81-30254953fce3', N'Employee Time Off Summary', N'rptvueAccountEmployeeTimeOff', N'View', N'/Images/EmployeeTimeOffReport.gif')
INSERT INTO [dbo].[SystemReportDataSource] ([SystemReportDataSourceId], [ReportDataSourceName], [ReportDatasource], [ReportDataSourceType], [DefaultIconPath]) VALUES ('5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', N'Employee Time Off Detail', N'rptvueAccountEmployeeTimeOffRequestWithTimeEntryReport', N'View', N'/Images/EmployeeTimeOffDetail.gif')
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportFilterSource]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportFilterSource]'
If Not Exists(Select * from [dbo].[SystemReportFilterSource] where [SystemReportFilterSourceId] = '0f76fe84-54e7-474a-a9e4-ca8584c03b72')
BEGIN
INSERT INTO [dbo].[SystemReportFilterSource] ([SystemReportFilterSourceId], [SystemReportFilterSource], [ClassName], [ClassFunction], [ParameterName1], [Caption], [FilterSourceType], [FilterSource], [FilterOperator], [IsOptional], [FilterField], [ParentFilterSource]) VALUES ('0f76fe84-54e7-474a-a9e4-ca8584c03b72', N'TimeOffType', NULL, NULL, NULL, N'Time Off Type', NULL, NULL, N'Guid', 1, N'AccountTimeOffTypeId', NULL)
INSERT INTO [dbo].[SystemReportFilterSource] ([SystemReportFilterSourceId], [SystemReportFilterSource], [ClassName], [ClassFunction], [ParameterName1], [Caption], [FilterSourceType], [FilterSource], [FilterOperator], [IsOptional], [FilterField], [ParentFilterSource]) VALUES ('0c06bda4-cfc8-4dd5-8510-cee57d47744d', N'TimeOffPolicy', NULL, NULL, NULL, N'Time Off Policy', NULL, NULL, N'Guid', 1, N'AccountTimeOffPolicyId', NULL)
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemResetToZeroType]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemResetToZeroType]'
If Not Exists(Select * from [dbo].[SystemResetToZeroType] where [SystemResetToZeroTypeId] = '454e189f-4a08-4a8d-8171-3eba51689a36')
BEGIN
INSERT INTO [dbo].[SystemResetToZeroType] ([SystemResetToZeroTypeId], [SystemResetToZeroType]) VALUES ('454e189f-4a08-4a8d-8171-3eba51689a36', N'Every Year')
INSERT INTO [dbo].[SystemResetToZeroType] ([SystemResetToZeroTypeId], [SystemResetToZeroType]) VALUES ('d13503a1-0719-41a2-b0e7-022979027d87', N'Every Month')
INSERT INTO [dbo].[SystemResetToZeroType] ([SystemResetToZeroTypeId], [SystemResetToZeroType]) VALUES ('a356efbf-340f-4ab9-8fde-0344a8e4cb3d', N'Every Year Anniversary Day')
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[MasterAccountApprovalType]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[MasterAccountApprovalType]'

UPDATE [dbo].[MasterAccountApprovalType] SET [IsTimeOffApprovalTypes]=0 WHERE [MasterAccountApprovalTypeId]=1
UPDATE [dbo].[MasterAccountApprovalType] SET [IsTimeOffApprovalTypes]=0 WHERE [MasterAccountApprovalTypeId]=2
UPDATE [dbo].[MasterAccountApprovalType] SET [IsTimeOffApprovalTypes]=0 WHERE [MasterAccountApprovalTypeId]=3
UPDATE [dbo].[MasterAccountApprovalType] SET [IsTimeOffApprovalTypes]=0 WHERE [MasterAccountApprovalTypeId]=4
GO
-- =======================================================
-- Foreign Key Constraint Nochecks's for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print ' Foreign Key Constraint Nochecks''s for Table: [dbo].[SystemSecurityCategoryPage]'

ALTER TABLE [dbo].[SystemSecurityCategoryPage] NOCHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory]
ALTER TABLE [dbo].[SystemSecurityCategoryPage] NOCHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory1]

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemEMailNotification]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemEMailNotification]'
If Not Exists(Select * from [dbo].[SystemEMailNotification] where [SystemEMailNotificationId] = 39)
BEGIN
INSERT INTO [dbo].[SystemEMailNotification] ([SystemEMailNotificationId], [SystemEMailNotification], [SystemEMailNotificationTypeId], [Enabled]) VALUES (39, N'Time Off Approved Notification', 1, 1)
INSERT INTO [dbo].[SystemEMailNotification] ([SystemEMailNotificationId], [SystemEMailNotification], [SystemEMailNotificationTypeId], [Enabled]) VALUES (40, N'Time Off Approved Notification', 3, 1)
INSERT INTO [dbo].[SystemEMailNotification] ([SystemEMailNotificationId], [SystemEMailNotification], [SystemEMailNotificationTypeId], [Enabled]) VALUES (41, N'Time Off Rejected Notification', 1, 1)
INSERT INTO [dbo].[SystemEMailNotification] ([SystemEMailNotificationId], [SystemEMailNotification], [SystemEMailNotificationTypeId], [Enabled]) VALUES (42, N'Time Off Rejected Notification', 3, 1)
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemSecurityCategoryPage]'
If Not Exists(Select * from [dbo].[SystemSecurityCategoryPage] where [SystemSecurityCategoryPageId] = 138)
BEGIN
INSERT INTO [dbo].[SystemSecurityCategoryPage] ([SystemSecurityCategoryPageId], [SystemSecurityCategoryId], [SequenceNumber], [Folder], [SystemCategoryPage], [SystemCategoryPageDescription], [ParentSystemSecurityCateogoryPageId], [IsSiteMapPage], [IsCustomizeable], [IsAllowAdd], [IsAllowEdit], [IsAllowDelete], [IsAllowList], [IsShowDataOptions], [IsShowTillOptions], [IsSystemPage], [ControlLevelPermission], [NotShowInPermission]) VALUES (138, 1, N'2184044856', N'AccountAdmin', 'AccountTimeOffTypes.aspx', 'Time Off Types', 15, 1, 1, 1, 1, 1, 1, NULL, NULL, NULL, NULL, NULL)
INSERT INTO [dbo].[SystemSecurityCategoryPage] ([SystemSecurityCategoryPageId], [SystemSecurityCategoryId], [SequenceNumber], [Folder], [SystemCategoryPage], [SystemCategoryPageDescription], [ParentSystemSecurityCateogoryPageId], [IsSiteMapPage], [IsCustomizeable], [IsAllowAdd], [IsAllowEdit], [IsAllowDelete], [IsAllowList], [IsShowDataOptions], [IsShowTillOptions], [IsSystemPage], [ControlLevelPermission], [NotShowInPermission]) VALUES (139, 1, N'218755857', N'AccountAdmin', 'AccountTimeOffPolicies.aspx', 'Time Off Policies', 15, 1, 1, 1, 1, 1, 1, NULL, NULL, NULL, NULL, NULL)
INSERT INTO [dbo].[SystemSecurityCategoryPage] ([SystemSecurityCategoryPageId], [SystemSecurityCategoryId], [SequenceNumber], [Folder], [SystemCategoryPage], [SystemCategoryPageDescription], [ParentSystemSecurityCateogoryPageId], [IsSiteMapPage], [IsCustomizeable], [IsAllowAdd], [IsAllowEdit], [IsAllowDelete], [IsAllowList], [IsShowDataOptions], [IsShowTillOptions], [IsSystemPage], [ControlLevelPermission], [NotShowInPermission]) VALUES (140, 1, N'218658858', N'AccountAdmin', 'AccountTimeOffPoliciesDetail.aspx', 'Time Off Policies Detail', 139, 1, 1, 1, 1, 1, 1, NULL, NULL, NULL, NULL, NULL)
INSERT INTO [dbo].[SystemSecurityCategoryPage] ([SystemSecurityCategoryPageId], [SystemSecurityCategoryId], [SequenceNumber], [Folder], [SystemCategoryPage], [SystemCategoryPageDescription], [ParentSystemSecurityCateogoryPageId], [IsSiteMapPage], [IsCustomizeable], [IsAllowAdd], [IsAllowEdit], [IsAllowDelete], [IsAllowList], [IsShowDataOptions], [IsShowTillOptions], [IsSystemPage], [ControlLevelPermission], [NotShowInPermission]) VALUES (141, 2, N'214865859', N'Employee', 'TimeOffStatus.aspx', 'Time Off Status', 4, 1, 1, 0, 1, 0, 1, NULL, NULL, NULL, NULL, NULL)
INSERT INTO [dbo].[SystemSecurityCategoryPage] ([SystemSecurityCategoryPageId], [SystemSecurityCategoryId], [SequenceNumber], [Folder], [SystemCategoryPage], [SystemCategoryPageDescription], [ParentSystemSecurityCateogoryPageId], [IsSiteMapPage], [IsCustomizeable], [IsAllowAdd], [IsAllowEdit], [IsAllowDelete], [IsAllowList], [IsShowDataOptions], [IsShowTillOptions], [IsSystemPage], [ControlLevelPermission], [NotShowInPermission]) VALUES (142, 2, N'215485560', N'Employee', 'MyTimeOff.aspx', 'My Time Off', 25, 1, 1, 1, 1, 1, 1, NULL, NULL, NULL, NULL, NULL)
INSERT INTO [dbo].[SystemSecurityCategoryPage] ([SystemSecurityCategoryPageId], [SystemSecurityCategoryId], [SequenceNumber], [Folder], [SystemCategoryPage], [SystemCategoryPageDescription], [ParentSystemSecurityCateogoryPageId], [IsSiteMapPage], [IsCustomizeable], [IsAllowAdd], [IsAllowEdit], [IsAllowDelete], [IsAllowList], [IsShowDataOptions], [IsShowTillOptions], [IsSystemPage], [ControlLevelPermission], [NotShowInPermission]) VALUES (143, 2, N'218455561', N'Employee', 'TimeOffRequest.aspx', 'My Time Off Request', 142, 1, 1, 1, 1, NULL, 1, NULL, NULL, NULL, NULL, NULL)
INSERT INTO [dbo].[SystemSecurityCategoryPage] ([SystemSecurityCategoryPageId], [SystemSecurityCategoryId], [SequenceNumber], [Folder], [SystemCategoryPage], [SystemCategoryPageDescription], [ParentSystemSecurityCateogoryPageId], [IsSiteMapPage], [IsCustomizeable], [IsAllowAdd], [IsAllowEdit], [IsAllowDelete], [IsAllowList], [IsShowDataOptions], [IsShowTillOptions], [IsSystemPage], [ControlLevelPermission], [NotShowInPermission]) VALUES (144, 2, N'218544562', N'Employee', 'MyTimeOffRequestApproval.aspx', 'Time Off Approval', 25, 1, 1, NULL, 1, NULL, 1, NULL, NULL, NULL, NULL, NULL)
END
GO
-- =======================================================
-- Foreign Key Constraint Check's for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print ' Foreign Key Constraint Check''s for Table: [dbo].[SystemSecurityCategoryPage]'

ALTER TABLE [dbo].[SystemSecurityCategoryPage] CHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory]
ALTER TABLE [dbo].[SystemSecurityCategoryPage] CHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory1]
GO
-- =======================================================
-- Foreign Key Constraint Nochecks's for Table: [dbo].[AccountReportSummary]
-- =======================================================
Print ' Foreign Key Constraint Nochecks''s for Table: [dbo].[AccountReportSummary]'

ALTER TABLE [dbo].[AccountReportSummary] NOCHECK CONSTRAINT [FK_AccountReportSummary_AccountReport]

-- =======================================================
-- Foreign Key Constraint Nochecks's for Table: [dbo].[AccountReportGroup]
-- =======================================================
Print ' Foreign Key Constraint Nochecks''s for Table: [dbo].[AccountReportGroup]'

ALTER TABLE [dbo].[AccountReportGroup] NOCHECK CONSTRAINT [FK_AccountReportGroup_AccountReport]

-- =======================================================
-- Foreign Key Constraint Nochecks's for Table: [dbo].[AccountReportDataSourceMapping]
-- =======================================================
Print ' Foreign Key Constraint Nochecks''s for Table: [dbo].[AccountReportDataSourceMapping]'

ALTER TABLE [dbo].[AccountReportDataSourceMapping] NOCHECK CONSTRAINT [FK_AccountReportDataSourceMapping_AccountReport]

-- =======================================================
-- Foreign Key Constraint Nochecks's for Table: [dbo].[AccountReportColumn]
-- =======================================================
Print ' Foreign Key Constraint Nochecks''s for Table: [dbo].[AccountReportColumn]'

ALTER TABLE [dbo].[AccountReportColumn] NOCHECK CONSTRAINT [FK_AccountReportColumn_AccountReport]

-- =======================================================
-- Synchronization Script for Table: [dbo].[AccountReport]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[AccountReport]'
IF NOT EXISTS (SELECT * FROM [dbo].[AccountReport] WHERE [AccountReportId] = '9e8be519-37bd-447d-9c33-a94946ba7261')
BEGIN
INSERT INTO [dbo].[AccountReport] ([AccountReportId], [AccountReportCategoryId], [ReportName], [ReportDescription], [ReportIconPath], [AccountId], [SystemReportTypeId], [SystemReportId], [IsConsolidated], [ReportPageName], [ReportOrder]) VALUES ('9e8be519-37bd-447d-9c33-a94946ba7261', '98f4aa0d-7c01-466c-8b72-0e42e7f40f38', N'Employee Time Off Detail', N'Employee Time Off Detail', '/Images/EmployeeTimeOffDetail.gif', NULL, NULL, NULL, 0, NULL, 11)
INSERT INTO [dbo].[AccountReport] ([AccountReportId], [AccountReportCategoryId], [ReportName], [ReportDescription], [ReportIconPath], [AccountId], [SystemReportTypeId], [SystemReportId], [IsConsolidated], [ReportPageName], [ReportOrder]) VALUES ('cd9ea78c-b2af-447a-9005-72dbce52c88e', '98f4aa0d-7c01-466c-8b72-0e42e7f40f38', N'Employee Time off', N'Employee Time off', '/Images/EmployeeTimeOffReport.gif', NULL, NULL, NULL, 0, NULL, 10)
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'
IF NOT EXISTS (SELECT * FROM [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId] = 'a2d8a801-3d46-4fcb-b0b3-2cad591be440')
BEGIN
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('a2d8a801-3d46-4fcb-b0b3-2cad591be440', '996917c1-62f6-44d5-be81-30254953fce3', N'AccountLocation', 175, 0, NULL, NULL, 14, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Location', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('1082a404-c5ea-4865-bdd3-816f491470b8', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', N'AccountLocation', 150, 0, NULL, NULL, 24, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Location', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('f36bde04-540f-4b27-82b8-e593d6aa3db0', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', N'RequestSubmitDate', 110, 0, NULL, NULL, 14, '48b9ef68-b4f6-4c75-b8de-c547939179ce', N'Request Submit Date', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('1e51230e-355d-4657-8176-7c382d8f8b61', '996917c1-62f6-44d5-be81-30254953fce3', N'Consume', 100, 1, NULL, NULL, 4, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Consume Hours', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('ca6c370e-bf1d-4f70-a050-2bffd678287b', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', N'RequestApprovalEmployeeName', 175, 0, NULL, NULL, 16, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Approved Employee Name', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('1afbfe1e-83b4-4728-9f53-699c28d06815', '996917c1-62f6-44d5-be81-30254953fce3', N'EMailAddress', 240, 0, NULL, NULL, 10, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Email Address', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('d5d89922-9baf-45ba-8b42-730293578449', '996917c1-62f6-44d5-be81-30254953fce3', N'Earned', 100, 1, NULL, NULL, 3, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Earned Hours', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('b6f8b427-380d-4d83-af16-f90b2516201b', '996917c1-62f6-44d5-be81-30254953fce3', N'IsTimeOffRequestRequired', 70, 0, NULL, NULL, 15, 'b2cb6685-3a4b-4cf9-a15a-d01a63031e2b', N'Request Required', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('f1e8462a-df3f-48fa-a900-5862ceab0221', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', N'StartTime', 65, 0, NULL, NULL, 17, '407f7b3f-ab83-4e95-a343-9bfafb746f4d', N'Start Time', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('4bf8db2c-5743-4323-aa07-50d521d46630', '996917c1-62f6-44d5-be81-30254953fce3', N'Role', 175, 0, NULL, NULL, 13, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Role', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('fbc2442e-4c86-42bb-b408-e20f2c4a01c9', '996917c1-62f6-44d5-be81-30254953fce3', N'DepartmentName', 175, 0, NULL, NULL, 12, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Department Name', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('fac6b92f-242d-4527-8d32-3097ace346e3', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', N'AccountTimeOffPolicy', 175, 1, NULL, NULL, 3, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Time Off Policy', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('7126e632-6a59-4d73-80c8-3bf41360e9a2', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', N'EmployeeName', 175, 0, NULL, NULL, 21, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Employee Name', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('16e5a234-d747-4c48-a8dc-ed03ad14c56d', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', N'Role', 115, 0, NULL, NULL, 23, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Role', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('2d7f423c-7980-48cb-8023-2174f6bddfe2', '996917c1-62f6-44d5-be81-30254953fce3', N'CarryForward', 100, 1, NULL, NULL, 6, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Carry Forward', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('94a46046-014f-40f9-811b-b592d23fcfdd', '996917c1-62f6-44d5-be81-30254953fce3', N'DepartmentCode', 115, 0, NULL, NULL, 11, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Department Code', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('f37fa646-d977-40ed-8838-a7223ceba5f5', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', N'TotalTime', 70, 1, NULL, NULL, 5, '407f7b3f-ab83-4e95-a343-9bfafb746f4d', N'Duration', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('81ee694c-1ce2-4ca4-b5e0-2f2d4126516b', '996917c1-62f6-44d5-be81-30254953fce3', N'AccountTimeOffType', 175, 1, NULL, NULL, 2, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Time Off Type', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('77564254-9660-4ca2-98ed-7f660e431923', '996917c1-62f6-44d5-be81-30254953fce3', N'AccountTimeOffPolicy', 175, 1, NULL, NULL, 1, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Time Off Policy', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('7299e957-5c64-4b51-8423-2f2a914f0303', '996917c1-62f6-44d5-be81-30254953fce3', N'Available', 100, 1, NULL, NULL, 5, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Available Hours', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('ef24fc5f-8ebc-44e8-87f8-ec729c13639e', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', N'StartDate', 90, 1, NULL, NULL, 8, '48b9ef68-b4f6-4c75-b8de-c547939179ce', N'Start Date', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('af8aae63-7780-4584-b0c1-d919e0cf333d', '996917c1-62f6-44d5-be81-30254953fce3', N'EmployeeName', 175, 0, NULL, NULL, 9, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Employee Name', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('eebe5f66-ac43-4a15-ad87-2116b6acbf33', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', N'RequestApproved', 70, 0, NULL, NULL, 12, 'b2cb6685-3a4b-4cf9-a15a-d01a63031e2b', N'Request Approved', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('2ca0b468-10cc-43bd-a521-137f55aba30a', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', N'RequestInApproval', 70, 0, NULL, NULL, 11, 'b2cb6685-3a4b-4cf9-a15a-d01a63031e2b', N'Request InApproval', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('36595976-eb65-4010-98e1-f738346c8710', '996917c1-62f6-44d5-be81-30254953fce3', N'EmployeeCode', 115, 0, NULL, NULL, 8, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Employee Code', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('4ccf787c-daed-4520-ad2a-533e2ac10b72', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', N'EmployeeCode', 115, 0, NULL, NULL, 20, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Employee Code', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('a6995f7d-4d11-4a2c-a0d2-cc885f1b65dd', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', N'AccountTimeOffType', 175, 1, NULL, NULL, 4, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Time Off Type', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('9ebbc092-e7b6-4ec4-b3bc-c5f54837c509', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', N'Description', 325, 1, NULL, NULL, 2, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Description', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('c8ad5095-dda4-47e3-ab85-4aab96b1ec8e', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', N'TimeEntryDate', 90, 1, NULL, NULL, 1, '48b9ef68-b4f6-4c75-b8de-c547939179ce', N'Date', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('9ad97da5-6d84-4b11-b37a-3303d1a24cba', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', N'DepartmentCode', 115, 0, NULL, NULL, 25, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Department Code', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('2a2c57a6-b8cd-4ab9-93cf-d51efe5cecc7', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', N'IsTimeOffRequestRequired', 70, 0, NULL, NULL, 19, 'b2cb6685-3a4b-4cf9-a15a-d01a63031e2b', N'Request Required', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('f76749a9-2b8b-4632-bf67-f38fecdce317', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', N'EndDate', 90, 1, NULL, NULL, 9, '48b9ef68-b4f6-4c75-b8de-c547939179ce', N'End Date', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('ccc9aea9-6c2c-421c-86eb-08ef9d1a6562', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', N'RequestDescription', 325, 1, NULL, NULL, 10, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Time Off Description', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('a34a37af-8b6c-4c87-9bbd-ea8e0cc440f8', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', N'HoursOff', 70, 1, NULL, NULL, 6, '0da31ddc-9040-46fa-a33a-74e06a645050', N'Hours Off', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('83362ab3-beb7-4dae-8b15-2abd01cee204', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', N'RequestApprovedOn', 90, 0, NULL, NULL, 15, '48b9ef68-b4f6-4c75-b8de-c547939179ce', N'Request ApprovedOn', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('ec26c4b5-2ec0-414b-96e4-18fd30031b5b', '996917c1-62f6-44d5-be81-30254953fce3', N'LastEarnedDate', 100, 1, NULL, NULL, 7, '48b9ef68-b4f6-4c75-b8de-c547939179ce', N'Last Earned Date', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('40687ecf-7a13-4c07-9251-27d5bdcbc924', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', N'RequestRejected', 70, 0, NULL, NULL, 13, 'b2cb6685-3a4b-4cf9-a15a-d01a63031e2b', N'Request Rejected', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('6dfafdd9-3f52-4a1e-83d0-208a842778b9', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', N'DepartmentName', 175, 0, NULL, NULL, 26, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Department Name', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('cb02f8df-94ce-46b3-a500-96c3feaf4a5b', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', N'EndTime', 65, 0, NULL, NULL, 18, '407f7b3f-ab83-4e95-a343-9bfafb746f4d', N'End Time', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('1aa5bce3-bfbb-4699-a999-05c438329d4f', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', N'DayOff', 70, 1, NULL, NULL, 7, '0da31ddc-9040-46fa-a33a-74e06a645050', N'Days Off', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('d67cfee7-cce7-4c69-9e9a-b6a0bf72e856', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', N'EMailAddress', 240, 0, NULL, NULL, 22, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Email Address', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('a82b04c0-ad91-4256-8285-16d00e8bb8dc', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', N'Submitted', 70, 1, NULL, NULL, 27, 'b2cb6685-3a4b-4cf9-a15a-d01a63031e2b', N'Submitted', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('addfe3f4-3df3-41b1-9cf9-776c71b81afa', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', N'Approved', 70, 1, NULL, NULL, 28, 'b2cb6685-3a4b-4cf9-a15a-d01a63031e2b', N'Approved', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('ed75063c-2e07-4f92-8c55-116c5865e1c7', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', N'Rejected', 70, 1, NULL, NULL, 29, 'b2cb6685-3a4b-4cf9-a15a-d01a63031e2b', N'Rejected', 0, 0)

END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportFilterSourceMapping]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportFilterSourceMapping]'
IF NOT EXISTS (SELECT * FROM [dbo].[SystemReportFilterSourceMapping] WHERE [SystemReportFilterMappingId] = '8af1bb15-60e8-4ff8-9002-ad53b34b48da')
BEGIN
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('8af1bb15-60e8-4ff8-9002-ad53b34b48da', '4f471b5b-2394-4379-a666-d696e2dfb0ef', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', 1, 1, 1)
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('31d01917-0ef3-4fd4-b3bb-8185830d7b51', '430ca1b0-0205-430f-9a9a-9dadd4c07a3d', 'ad0ea79d-c1d7-40ed-a7c4-03cc4f565873', 0, 0, 8)
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('5ae29e2b-5ab6-4ec1-b234-08ae3b58643c', '45259e57-2e6a-4033-8318-b2e0fcc2863a', 'ad0ea79d-c1d7-40ed-a7c4-03cc4f565873', 0, 1, 4)
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('23a2713f-fc3c-4595-b388-3f605bd3e852', '5a1515da-e197-49c1-83fc-b0d5a9a3034a', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', 1, 0, 7)
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('b8b68a42-ef88-40f4-97a3-46814a438dae', '7feed6f5-67ab-4699-8866-8deddac27b9f', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', 1, 1, 3)
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('416f1c49-5516-4f7c-8128-cfc746c8810d', '0c06bda4-cfc8-4dd5-8510-cee57d47744d', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', 1, 1, 5)
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('c0980c4f-253f-4e1a-a70d-b042e23b1a42', '0f76fe84-54e7-474a-a9e4-ca8584c03b72', '996917c1-62f6-44d5-be81-30254953fce3', 1, 1, 6)
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('baa8f055-22ab-4c8e-ad45-86cfc3fd29f8', '40a2a9c4-d975-4167-91c7-c38fa497c9da', 'ad0ea79d-c1d7-40ed-a7c4-03cc4f565873', 0, 0, 9)
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('af9a0557-97e9-468b-9a98-6846f0302e91', '39e77f67-6659-45aa-8eef-6bc28103b617', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', 1, 1, 2)
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('c277d857-867e-49bf-b522-a49b7194fd74', '7feed6f5-67ab-4699-8866-8deddac27b9f', '996917c1-62f6-44d5-be81-30254953fce3', 1, 1, 3)
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('e83a6069-16cc-4df8-9681-3bccbf9a2414', '0f76fe84-54e7-474a-a9e4-ca8584c03b72', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', 1, 1, 6)
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('39ba5490-1534-4fc6-ab7b-f09071affa5a', '39e77f67-6659-45aa-8eef-6bc28103b617', '996917c1-62f6-44d5-be81-30254953fce3', 1, 1, 2)
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('94f2faa9-b691-4894-a849-135671b391a0', '4f471b5b-2394-4379-a666-d696e2dfb0ef', '996917c1-62f6-44d5-be81-30254953fce3', 1, 1, 1)
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('67c3cebd-3b0e-4f25-bd5f-366b5f27ec04', '0c06bda4-cfc8-4dd5-8510-cee57d47744d', '996917c1-62f6-44d5-be81-30254953fce3', 1, 1, 5)
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('c5a9bdc1-4242-4d12-a83e-e8a5dd2cbf04', '40a2a9c4-d975-4167-91c7-c38fa497c9da', 'e3803dc0-49fd-4fc8-b414-ea264ffe85aa', 0, 0, 11)
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('9eb5baf1-2a6d-4fb4-8d43-8d963543e9e5', '875614cd-c8ac-410d-aeae-af024a772739', '996917c1-62f6-44d5-be81-30254953fce3', 1, 1, 4)
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('2ec282f6-0c16-4624-9bf6-465d4035c28e', '875614cd-c8ac-410d-aeae-af024a772739', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', 1, 1, 4)
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[AccountReportColumn]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[AccountReportColumn]'
IF NOT EXISTS (SELECT * FROM [dbo].[AccountReportColumn] WHERE [AccountReportColumnId] = 'dcacf10f-cbe8-4159-a137-a7bacbfbe9eb')
BEGIN
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('dcacf10f-cbe8-4159-a137-a7bacbfbe9eb', '9e8be519-37bd-447d-9c33-a94946ba7261', N'Description', '9ebbc092-e7b6-4ec4-b3bc-c5f54837c509', 2, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('d751da19-5dc3-4f22-ba34-59901ddc723b', 'cd9ea78c-b2af-447a-9005-72dbce52c88e', N'Carry Forward', '2d7f423c-7980-48cb-8023-2174f6bddfe2', 6, 'd3c0763b-8f05-4fd5-aa69-37dbe17479ef', NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('e12b2f27-f7e6-4545-a7c1-3ebbf3fe0abe', '9e8be519-37bd-447d-9c33-a94946ba7261', N'Days Off', '1aa5bce3-bfbb-4699-a999-05c438329d4f', 7, 'd3c0763b-8f05-4fd5-aa69-37dbe17479ef', NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('0b56c32d-430a-493f-8752-9d6478d644a4', 'cd9ea78c-b2af-447a-9005-72dbce52c88e', N'Time Off Type', '81ee694c-1ce2-4ca4-b5e0-2f2d4126516b', 2, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('90943439-a0a8-497e-bf5e-aca2c00b82bd', '9e8be519-37bd-447d-9c33-a94946ba7261', N'Time Off Type', 'a6995f7d-4d11-4a2c-a0d2-cc885f1b65dd', 4, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('a468753b-dac7-45fc-87fd-7d28d3fc6703', 'cd9ea78c-b2af-447a-9005-72dbce52c88e', N'Consume Hours', '1e51230e-355d-4657-8176-7c382d8f8b61', 4, 'd3c0763b-8f05-4fd5-aa69-37dbe17479ef', NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('87ea4556-d805-414b-b028-a3b6023c78cb', '9e8be519-37bd-447d-9c33-a94946ba7261', N'Time Off Description', 'ccc9aea9-6c2c-421c-86eb-08ef9d1a6562', 10, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('1c327a7b-ad95-46a0-a4fe-82b8af6dea44', 'cd9ea78c-b2af-447a-9005-72dbce52c88e', N'Time Off Policy', '77564254-9660-4ca2-98ed-7f660e431923', 1, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('e6eeab9d-ad37-4614-af0f-52ac2365aa2d', '9e8be519-37bd-447d-9c33-a94946ba7261', N'End Date', 'f76749a9-2b8b-4632-bf67-f38fecdce317', 9, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('0b3d52a3-cda1-451e-b81e-989f3c7ae9e5', 'cd9ea78c-b2af-447a-9005-72dbce52c88e', N'Last Earned Date', 'ec26c4b5-2ec0-414b-96e4-18fd30031b5b', 7, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('76b0c4b7-b025-4820-9b6d-5f33ea6c5d79', 'cd9ea78c-b2af-447a-9005-72dbce52c88e', N'Earned Hours', 'd5d89922-9baf-45ba-8b42-730293578449', 3, 'd3c0763b-8f05-4fd5-aa69-37dbe17479ef', NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('6f713ac3-2517-44ce-b78d-99455ea1185a', '9e8be519-37bd-447d-9c33-a94946ba7261', N'Duration', 'f37fa646-d977-40ed-8838-a7223ceba5f5', 5, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('9d6942c9-88fb-4742-9426-1872ecfcc58e', '9e8be519-37bd-447d-9c33-a94946ba7261', N'Hours Off', 'a34a37af-8b6c-4c87-9bbd-ea8e0cc440f8', 6, 'd3c0763b-8f05-4fd5-aa69-37dbe17479ef', NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('0e4f96e3-de72-4dfd-b5db-9c2965a94c6a', '9e8be519-37bd-447d-9c33-a94946ba7261', N'Start Date', 'ef24fc5f-8ebc-44e8-87f8-ec729c13639e', 8, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('d7f4b6ee-97b6-479b-a959-51db9b967e3f', '9e8be519-37bd-447d-9c33-a94946ba7261', N'Date', 'c8ad5095-dda4-47e3-ab85-4aab96b1ec8e', 1, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('ff77a2f0-51b9-420f-8913-83fa8ef6f363', 'cd9ea78c-b2af-447a-9005-72dbce52c88e', N'Available Hours', '7299e957-5c64-4b51-8423-2f2a914f0303', 5, 'd3c0763b-8f05-4fd5-aa69-37dbe17479ef', NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('43cd0ef2-152e-48b9-9237-d8f0cc879289', '9e8be519-37bd-447d-9c33-a94946ba7261', N'Time Off Policy', 'fac6b92f-242d-4527-8d32-3097ace346e3', 3, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('ec14967c-de12-4507-9257-a894704d91f9', '9e8be519-37bd-447d-9c33-a94946ba7261', N'Submitted', 'a82b04c0-ad91-4256-8285-16d00e8bb8dc', 11, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('34b6be87-fd30-4c4e-8b73-2f6d1ba465b0', '9e8be519-37bd-447d-9c33-a94946ba7261', N'Approved', 'addfe3f4-3df3-41b1-9cf9-776c71b81afa', 12, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('8f34e077-11cb-4378-a26f-784995da706c', '9e8be519-37bd-447d-9c33-a94946ba7261', N'Rejected', 'ed75063c-2e07-4f92-8c55-116c5865e1c7', 13, NULL, NULL)
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[AccountReportDataSourceMapping]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[AccountReportDataSourceMapping]'
IF NOT EXISTS (SELECT * FROM [dbo].[AccountReportDataSourceMapping] WHERE [AccountReportDataSourceMappingId] = 'bf753b3c-1784-4766-bd20-5a29fd1e77f0')
BEGIN
INSERT INTO [dbo].[AccountReportDataSourceMapping] ([AccountReportDataSourceMappingId], [AccountReportId], [SystemReportDataSourceId]) VALUES ('bf753b3c-1784-4766-bd20-5a29fd1e77f0', '9e8be519-37bd-447d-9c33-a94946ba7261', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8')
INSERT INTO [dbo].[AccountReportDataSourceMapping] ([AccountReportDataSourceMappingId], [AccountReportId], [SystemReportDataSourceId]) VALUES ('be400461-1b85-4a91-8fb5-bf2be17212c5', 'cd9ea78c-b2af-447a-9005-72dbce52c88e', '996917c1-62f6-44d5-be81-30254953fce3')
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[AccountReportGroup]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[AccountReportGroup]'
IF NOT EXISTS (SELECT * FROM [dbo].[AccountReportGroup] WHERE [AccountReportGroupId] = '37076446-5cef-4808-9ce9-4de82b0287c4')
BEGIN
INSERT INTO [dbo].[AccountReportGroup] ([AccountReportGroupId], [AccountReportId], [ReportGroup], [ReportGroupFieldLabel], [ReportGroupFieldOrder], [SystemReportDataSourceFieldId]) VALUES ('37076446-5cef-4808-9ce9-4de82b0287c4', '9e8be519-37bd-447d-9c33-a94946ba7261', N'EmployeeName', N'Employee Name', 0, '7126e632-6a59-4d73-80c8-3bf41360e9a2')
INSERT INTO [dbo].[AccountReportGroup] ([AccountReportGroupId], [AccountReportId], [ReportGroup], [ReportGroupFieldLabel], [ReportGroupFieldOrder], [SystemReportDataSourceFieldId]) VALUES ('baeae3ac-0899-4f8e-9aa5-c0516cfaab20', 'cd9ea78c-b2af-447a-9005-72dbce52c88e', N'EmployeeName', N'Employee Name', 0, 'af8aae63-7780-4584-b0c1-d919e0cf333d')
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[AccountReportSummary]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[AccountReportSummary]'
IF NOT EXISTS (SELECT * FROM [dbo].[AccountReportSummary] WHERE [AccountReportSummaryId] = 'f2c26016-67e0-450e-a24a-0eeb899bc6fc')
BEGIN
INSERT INTO [dbo].[AccountReportSummary] ([AccountReportSummaryId], [AccountReportGroupId], [AccountReportId], [SystemReportCalculationTypeId], [AccountReportColumnId], [SummaryCaption], [IsShowGroupTotal], [IsShowGrandTotal]) VALUES ('f2c26016-67e0-450e-a24a-0eeb899bc6fc', 'baeae3ac-0899-4f8e-9aa5-c0516cfaab20', 'cd9ea78c-b2af-447a-9005-72dbce52c88e', 'd3c0763b-8f05-4fd5-aa69-37dbe17479ef', '76b0c4b7-b025-4820-9b6d-5f33ea6c5d79', N'Earned', 1, 1)
INSERT INTO [dbo].[AccountReportSummary] ([AccountReportSummaryId], [AccountReportGroupId], [AccountReportId], [SystemReportCalculationTypeId], [AccountReportColumnId], [SummaryCaption], [IsShowGroupTotal], [IsShowGrandTotal]) VALUES ('03c18429-5895-415b-b20e-7919892483c0', 'baeae3ac-0899-4f8e-9aa5-c0516cfaab20', 'cd9ea78c-b2af-447a-9005-72dbce52c88e', 'd3c0763b-8f05-4fd5-aa69-37dbe17479ef', 'ff77a2f0-51b9-420f-8913-83fa8ef6f363', N'Available', 1, 1)
INSERT INTO [dbo].[AccountReportSummary] ([AccountReportSummaryId], [AccountReportGroupId], [AccountReportId], [SystemReportCalculationTypeId], [AccountReportColumnId], [SummaryCaption], [IsShowGroupTotal], [IsShowGrandTotal]) VALUES ('08e7c562-8e9f-484e-9668-e7c634e26ffa', 'baeae3ac-0899-4f8e-9aa5-c0516cfaab20', 'cd9ea78c-b2af-447a-9005-72dbce52c88e', 'd3c0763b-8f05-4fd5-aa69-37dbe17479ef', 'd751da19-5dc3-4f22-ba34-59901ddc723b', N'CarryForward', 1, 1)
INSERT INTO [dbo].[AccountReportSummary] ([AccountReportSummaryId], [AccountReportGroupId], [AccountReportId], [SystemReportCalculationTypeId], [AccountReportColumnId], [SummaryCaption], [IsShowGroupTotal], [IsShowGrandTotal]) VALUES ('c0317b76-18e8-495a-9265-14750b22dc0e', 'baeae3ac-0899-4f8e-9aa5-c0516cfaab20', 'cd9ea78c-b2af-447a-9005-72dbce52c88e', 'd3c0763b-8f05-4fd5-aa69-37dbe17479ef', 'a468753b-dac7-45fc-87fd-7d28d3fc6703', N'Consume', 1, 1)
INSERT INTO [dbo].[AccountReportSummary] ([AccountReportSummaryId], [AccountReportGroupId], [AccountReportId], [SystemReportCalculationTypeId], [AccountReportColumnId], [SummaryCaption], [IsShowGroupTotal], [IsShowGrandTotal]) VALUES ('f6cd6694-b8e1-422f-8b06-0902f7bd9240', '37076446-5cef-4808-9ce9-4de82b0287c4', '9e8be519-37bd-447d-9c33-a94946ba7261', 'd3c0763b-8f05-4fd5-aa69-37dbe17479ef', 'e12b2f27-f7e6-4545-a7c1-3ebbf3fe0abe', N'DayOff', 1, 1)
INSERT INTO [dbo].[AccountReportSummary] ([AccountReportSummaryId], [AccountReportGroupId], [AccountReportId], [SystemReportCalculationTypeId], [AccountReportColumnId], [SummaryCaption], [IsShowGroupTotal], [IsShowGrandTotal]) VALUES ('289363be-2304-47a5-b5b1-bb2879660820', '37076446-5cef-4808-9ce9-4de82b0287c4', '9e8be519-37bd-447d-9c33-a94946ba7261', 'd3c0763b-8f05-4fd5-aa69-37dbe17479ef', '9d6942c9-88fb-4742-9426-1872ecfcc58e', N'HoursOfff', 1, 1)
END
GO
-- =======================================================
-- Foreign Key Constraint Check's for Table: [dbo].[AccountReportColumn]
-- =======================================================
Print ' Foreign Key Constraint Check''s for Table: [dbo].[AccountReportColumn]'

ALTER TABLE [dbo].[AccountReportColumn] CHECK CONSTRAINT [FK_AccountReportColumn_AccountReport]

-- =======================================================
-- Foreign Key Constraint Check's for Table: [dbo].[AccountReportDataSourceMapping]
-- =======================================================
Print ' Foreign Key Constraint Check''s for Table: [dbo].[AccountReportDataSourceMapping]'

ALTER TABLE [dbo].[AccountReportDataSourceMapping] CHECK CONSTRAINT [FK_AccountReportDataSourceMapping_AccountReport]

-- =======================================================
-- Foreign Key Constraint Check's for Table: [dbo].[AccountReportGroup]
-- =======================================================
Print ' Foreign Key Constraint Check''s for Table: [dbo].[AccountReportGroup]'

ALTER TABLE [dbo].[AccountReportGroup] CHECK CONSTRAINT [FK_AccountReportGroup_AccountReport]

-- =======================================================
-- Foreign Key Constraint Check's for Table: [dbo].[AccountReportSummary]
-- =======================================================
Print ' Foreign Key Constraint Check''s for Table: [dbo].[AccountReportSummary]'

ALTER TABLE [dbo].[AccountReportSummary] CHECK CONSTRAINT [FK_AccountReportSummary_AccountReport]
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportPermission]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportPermission]'
IF NOT EXISTS (SELECT * FROM [dbo].[SystemReportPermission] WHERE SystemReportPermissionId = '0df3b931-963d-4e70-ae7e-61e5874e2760')
BEGIN
INSERT INTO [dbo].[SystemReportPermission] ([SystemReportPermissionId], [AccountReportId], [MasterAccountRoleId], [ShowReport], [AllowCustomization], [AllowAllUser], [AllowOwnReport], [AllowOwnTeam], [AllowOwnProject], [AllowOwnSubOrdinates]) VALUES ('0df3b931-963d-4e70-ae7e-61e5874e2760', 'cd9ea78c-b2af-447a-9005-72dbce52c88e', 101, 1, NULL, NULL, NULL, NULL, 1, NULL)
INSERT INTO [dbo].[SystemReportPermission] ([SystemReportPermissionId], [AccountReportId], [MasterAccountRoleId], [ShowReport], [AllowCustomization], [AllowAllUser], [AllowOwnReport], [AllowOwnTeam], [AllowOwnProject], [AllowOwnSubOrdinates]) VALUES ('0d0c86cc-d74c-46f2-b316-764abdffd8ba', 'cd9ea78c-b2af-447a-9005-72dbce52c88e', 1, 1, 1, 1, NULL, NULL, NULL, NULL)
INSERT INTO [dbo].[SystemReportPermission] ([SystemReportPermissionId], [AccountReportId], [MasterAccountRoleId], [ShowReport], [AllowCustomization], [AllowAllUser], [AllowOwnReport], [AllowOwnTeam], [AllowOwnProject], [AllowOwnSubOrdinates]) VALUES ('2d8ff896-c5a4-4343-b3dc-6bc353adf015', 'cd9ea78c-b2af-447a-9005-72dbce52c88e', 2, 1, NULL, NULL, 1, NULL, NULL, NULL)
INSERT INTO [dbo].[SystemReportPermission] ([SystemReportPermissionId], [AccountReportId], [MasterAccountRoleId], [ShowReport], [AllowCustomization], [AllowAllUser], [AllowOwnReport], [AllowOwnTeam], [AllowOwnProject], [AllowOwnSubOrdinates]) VALUES ('659341f9-a9e6-4ecc-868c-e25509993e0c', 'cd9ea78c-b2af-447a-9005-72dbce52c88e', 100, 1, NULL, NULL, NULL, 1, NULL, NULL)
INSERT INTO [dbo].[SystemReportPermission] ([SystemReportPermissionId], [AccountReportId], [MasterAccountRoleId], [ShowReport], [AllowCustomization], [AllowAllUser], [AllowOwnReport], [AllowOwnTeam], [AllowOwnProject], [AllowOwnSubOrdinates]) VALUES ('ffe75cb8-7d63-4f29-980b-ee6c1a922f8e', '9e8be519-37bd-447d-9c33-a94946ba7261', 101, 1, NULL, NULL, NULL, NULL, 1, NULL)
INSERT INTO [dbo].[SystemReportPermission] ([SystemReportPermissionId], [AccountReportId], [MasterAccountRoleId], [ShowReport], [AllowCustomization], [AllowAllUser], [AllowOwnReport], [AllowOwnTeam], [AllowOwnProject], [AllowOwnSubOrdinates]) VALUES ('da81894f-7206-435b-89d9-d8848a6f6136', '9e8be519-37bd-447d-9c33-a94946ba7261', 1, 1, 1, 1, NULL, NULL, NULL, NULL)
INSERT INTO [dbo].[SystemReportPermission] ([SystemReportPermissionId], [AccountReportId], [MasterAccountRoleId], [ShowReport], [AllowCustomization], [AllowAllUser], [AllowOwnReport], [AllowOwnTeam], [AllowOwnProject], [AllowOwnSubOrdinates]) VALUES ('fe71c5ca-b345-4bc3-a03a-b50c006ca805', '9e8be519-37bd-447d-9c33-a94946ba7261', 2, 1, NULL, NULL, 1, NULL, NULL, NULL)
INSERT INTO [dbo].[SystemReportPermission] ([SystemReportPermissionId], [AccountReportId], [MasterAccountRoleId], [ShowReport], [AllowCustomization], [AllowAllUser], [AllowOwnReport], [AllowOwnTeam], [AllowOwnProject], [AllowOwnSubOrdinates]) VALUES ('ee35e4ae-4093-40f2-8519-b4d240436f68', '9e8be519-37bd-447d-9c33-a94946ba7261', 100, 1, NULL, NULL, NULL, 1, NULL, NULL)
END

GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[AccountReportColumn]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[AccountReportColumn]'

UPDATE [dbo].[AccountReportColumn] SET [Caption]='Department Name' WHERE [AccountReportColumnId]='d881d569-43ff-4c0b-9ba4-0349a8bd285d'
GO
-- Drop View vueAccountEmployeeTimeOffForReport
Print 'Drop View vueAccountEmployeeTimeOffForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOffForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeOffForReport]
GO
-- Create View vueAccountEmployeeTimeOffForReport
Print 'Create View vueAccountEmployeeTimeOffForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOffForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeOffForReport
AS
SELECT     dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountRoleId, dbo.AccountEmployee.AccountLocationId, 
                      dbo.AccountEmployeeTimeOff.AccountEmployeeTimeOffId, dbo.AccountEmployeeTimeOff.AccountEmployeeId, dbo.AccountEmployeeTimeOff.AccountId, 
                      dbo.AccountEmployeeTimeOff.AccountTimeOffTypeId, ISNULL(dbo.AccountEmployeeTimeOff.Earned, 0) AS Earned, 
                      ISNULL(dbo.AccountEmployeeTimeOff.Consume, 0) AS Consume, ISNULL(dbo.AccountEmployeeTimeOff.Available, 0) AS Available, 
                      dbo.AccountEmployeeTimeOff.LastEarnedDate, dbo.AccountEmployeeTimeOff.CreatedByEmployeeId, dbo.AccountEmployeeTimeOff.CreatedOn, 
                      dbo.AccountEmployeeTimeOff.ModifiedByEmployeeId, dbo.AccountEmployeeTimeOff.ModifiedOn, ISNULL(dbo.AccountEmployeeTimeOff.CarryForward, 
                      0) AS CarryForward, dbo.AccountEmployeeTimeOff.AccountTimeOffPolicyId, dbo.AccountTimeOffType.AccountTimeOffType, 
                      dbo.AccountTimeOffType.IsTimeOffRequestRequired, dbo.AccountLocation.AccountLocation, dbo.AccountDepartment.DepartmentCode, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountTimeOffPolicy.AccountTimeOffPolicy, 
                      dbo.AccountEmployee.EmployeeCode
FROM         dbo.AccountEmployee INNER JOIN
                      dbo.AccountEmployeeTimeOff ON dbo.AccountEmployee.AccountEmployeeId = dbo.AccountEmployeeTimeOff.AccountEmployeeId INNER JOIN
                      dbo.AccountTimeOffType ON dbo.AccountEmployeeTimeOff.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId INNER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId INNER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId INNER JOIN
                      dbo.AccountTimeOffPolicy ON dbo.AccountEmployeeTimeOff.AccountTimeOffPolicyId = dbo.AccountTimeOffPolicy.AccountTimeOffPolicyId'
GO
Update SystemTimeZone Set TimeZoneCode = 'Central European' Where SystemTimeZoneId = 63
Update SystemTimeZone Set TimeZoneCode = 'Central Pacific' Where SystemTimeZoneId = 29
GO
-- Drop View rptvueAccountEmployeeTimeOffRequestWithTimeEntryReport
Print 'Drop View rptvueAccountEmployeeTimeOffRequestWithTimeEntryReport'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeOffRequestWithTimeEntryReport' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountEmployeeTimeOffRequestWithTimeEntryReport]
GO
-- Drop View vueAccountEmployeeTimeOffRequestWithTimeEntryReport
Print 'Drop View vueAccountEmployeeTimeOffRequestWithTimeEntryReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOffRequestWithTimeEntryReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeOffRequestWithTimeEntryReport]
GO
-- Drop View vueAccountEmployee
Print 'Drop View vueAccountEmployee'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployee]
GO
-- Add Column ShowProjectForTimeOff to AccountPreferences
Print 'Add Column ShowProjectForTimeOff to AccountPreferences'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountPreferences' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='ShowProjectForTimeOff' AND TABLE_NAME='AccountPreferences'))
ALTER TABLE [dbo].[AccountPreferences]
	ADD [ShowProjectForTimeOff] bit NULL
GO
-- Add Default Constraint DF_AccountPreferences_ShowProjectForTimeOff to AccountPreferences
Print 'Add Default Constraint DF_AccountPreferences_ShowProjectForTimeOff to AccountPreferences'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountPreferences' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM sysobjects WHERE name= N'DF_AccountPreferences_ShowProjectForTimeOff'))
ALTER TABLE [dbo].[AccountPreferences]
	ADD
	CONSTRAINT [DF_AccountPreferences_ShowProjectForTimeOff]
	DEFAULT ((0)) FOR [ShowProjectForTimeOff]
GO
-- Add Column AccountProjectId to AccountEmployeeTimeOffRequest
Print 'Add Column AccountProjectId to AccountEmployeeTimeOffRequest'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeOffRequest' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='AccountProjectId' AND TABLE_NAME='AccountEmployeeTimeOffRequest'))
ALTER TABLE [dbo].[AccountEmployeeTimeOffRequest]
	ADD [AccountProjectId] int NULL
GO
-- Create View vueAccountEmployee
Print 'Create View vueAccountEmployee'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployee
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountEmployee.AccountId, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.Password, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountLocationId, 
                      dbo.AccountEmployee.BillingTypeId, dbo.AccountBillingType.BillingType, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountPreferences.ShowClockStartEnd, 
                      dbo.Account.TimeZoneId, dbo.AccountRole.MasterAccountRoleId, dbo.Account.DefaultCurrencyId, dbo.Account.CountryId, 
                      dbo.AccountPreferences.CultureInfoName, dbo.AccountPreferences.TimeEntryFormat, dbo.AccountEmployee.AllowedAccessFromIP, 
                      dbo.AccountRole.AccountRoleId, dbo.AccountPreferences.AccountSessionTimeout, dbo.AccountPreferences.ShowCompletedTasksInTimeSheet, 
                      dbo.AccountPreferences.CurrencySymbol, dbo.AccountPreferences.IsCompanyOwnLogo, dbo.Account.AccountExpiryActivation, 
                      dbo.Account.LicenseActivation, dbo.AccountEmployee.EmployeeTypeId, dbo.AccountEmployee.ExternalUserClientId, 
                      dbo.AccountEmployee.AccountBillingRateId, dbo.AccountPreferences.ScheduledEmailSendTime, dbo.AccountEmployee.Username, 
                      dbo.AccountEmployee.IsDisabled, dbo.AccountPreferences.FromEmailAddress, dbo.AccountPreferences.FromEmailAddressDisplayName, 
                      dbo.AccountEmployee.EmployeeCode, dbo.AccountPreferences.Version, dbo.AccountPreferences.LockSubmittedRecords, 
                      dbo.AccountPreferences.LockApprovedRecords, ISNULL(dbo.AccountEmployee.EmployeeCode + '' - '', '''') 
                      + dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeNameWithCode, 
                      dbo.AccountPreferences.ShowWorkTypeInTimeSheet, dbo.AccountPreferences.NumberOfBlankRowsInTimeEntry, 
                      dbo.AccountPreferences.ShowCostCenterInTimeSheet, dbo.AccountPreferences.WeekStartDay, dbo.AccountPreferences.AccountBaseCurrencyId, 
                      dbo.AccountPreferences.UserInterfaceLanguage, dbo.AccountEmployee.EmployeeManagerId, dbo.AccountPreferences.DefaultTimeEntryMode, 
                      dbo.AccountPreferences.PageSize, dbo.AccountEmployee.TimeZoneId AS EmployeeTimeZoneId, dbo.AccountEmployee.TerminationDate, 
                      dbo.AccountEmployee.StatusId, dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.EmployeePayTypeId, dbo.AccountEmployee.HiredDate, 
                      dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountWorkingDayType, dbo.AccountWorkingDayType.HoursPerDay, 
                      dbo.AccountWorkingDayType.WeekStartDay AS EmployeeWeekStartDay, dbo.AccountPreferences.ShowClientInTimesheet, 
                      dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, 
                      dbo.AccountPreferences.ShowDescriptionInWeekView, dbo.AccountPreferences.InvoiceNoPrefix, 
                      dbo.AccountPreferences.ShowAdditionalTaskInformationType, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, ISNULL(dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, 1) 
                      AS InitialDayOfTheMonth, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, 1) 
                      AS SystemInitialDayOfFirstPeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod, 16) AS SystemInitialDayOfLastPeriod, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountPreferences.TimesheetPrintFooter, 
                      dbo.AccountPreferences.ExpenseSheetPrintFooter, dbo.AccountPreferences.ShowCompletedProjectsInTimeSheet, 
                      dbo.AccountPreferences.ShowProjectForTimeOff
FROM         dbo.vueAccountTimesheetPeriodType RIGHT OUTER JOIN
                      dbo.AccountWorkingDayType ON 
                      dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId = dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId RIGHT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.Account ON dbo.AccountEmployee.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId ON 
                      dbo.AccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployee.AccountId = dbo.AccountPreferences.AccountId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId'
GO
-- Create View vueAccountEmployeeTimeOffRequestWithTimeEntryReport
Print 'Create View vueAccountEmployeeTimeOffRequestWithTimeEntryReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOffRequestWithTimeEntryReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeOffRequestWithTimeEntryReport
AS
SELECT     dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, dbo.AccountEmployeeTimeEntry.AccountEmployeeId, 
                      dbo.AccountEmployeeTimeEntry.TimeEntryDate, dbo.AccountEmployeeTimeEntry.StartTime, dbo.AccountEmployeeTimeEntry.EndTime, 
                      dbo.AccountEmployeeTimeEntry.TotalTime, dbo.AccountEmployeeTimeEntry.Description, dbo.AccountEmployeeTimeEntry.Approved, 
                      dbo.AccountEmployeeTimeEntry.CreatedOn, dbo.AccountEmployeeTimeEntry.Submitted, dbo.AccountEmployeeTimeEntry.ModifiedOn, 
                      dbo.AccountEmployeeTimeEntry.Rejected, dbo.AccountEmployeeTimeEntry.IsTimeOff, dbo.AccountEmployeeTimeEntry.Hours, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeOffRequestId, 
                      dbo.AccountTimeOffType.AccountTimeOffType, dbo.AccountTimeOffType.IsTimeOffRequestRequired, dbo.AccountTimeOffType.AccountId, 
                      dbo.AccountEmployeeTimeOffRequest.RequestSubmitDate, ISNULL(dbo.AccountEmployeeTimeOffRequest.HoursOff, 0) AS HoursOff, 
                      dbo.AccountEmployeeTimeOffRequest.StartDate, dbo.AccountEmployeeTimeOffRequest.EndDate, 
                      ISNULL(dbo.AccountEmployeeTimeOffRequest.DayOff, 0) AS DayOff, dbo.AccountEmployeeTimeOffRequest.Description AS RequestDescription, 
                      dbo.AccountEmployeeTimeOffRequest.InApproval AS RequestInApproval, dbo.AccountEmployeeTimeOffRequest.Approved AS RequestApproved, 
                      dbo.AccountEmployeeTimeOffRequest.Rejected AS RequestRejected, dbo.AccountEmployeeTimeOffRequest.ApprovedOn AS RequestApprovedOn, 
                      dbo.AccountEmployeeTimeOffRequest.ApprovedBy AS RequestApprovedBy, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS RequestApprovalEmployeeName, 
                      AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName AS EmployeeName, AccountEmployee_1.EMailAddress, 
                      dbo.AccountDepartment.DepartmentCode, dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountLocation.AccountLocation, 
                      AccountEmployee_1.EmployeeCode, dbo.AccountTimeOffPolicy.AccountTimeOffPolicy, dbo.AccountTimeOffPolicy.AccountTimeOffPolicyId, 
                      dbo.AccountLocation.AccountLocationId, dbo.AccountDepartment.AccountDepartmentId, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountEmployeeTimeEntry.AccountProjectId, dbo.AccountProject.ProjectName
FROM         dbo.AccountEmployeeTimeOffRequest FULL OUTER JOIN
                      dbo.AccountTimeOffType RIGHT OUTER JOIN
                      dbo.AccountDepartment RIGHT OUTER JOIN
                      dbo.AccountEmployeeTimeEntry LEFT OUTER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeId = AccountEmployee_1.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountRole ON AccountEmployee_1.AccountRoleId = dbo.AccountRole.AccountRoleId LEFT OUTER JOIN
                      dbo.AccountLocation ON AccountEmployee_1.AccountLocationId = dbo.AccountLocation.AccountLocationId ON 
                      dbo.AccountDepartment.AccountDepartmentId = AccountEmployee_1.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountTimeOffPolicy ON AccountEmployee_1.AccountTimeOffPolicyId = dbo.AccountTimeOffPolicy.AccountTimeOffPolicyId ON 
                      dbo.AccountTimeOffType.AccountTimeOffTypeId = dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId ON 
                      dbo.AccountEmployeeTimeOffRequest.AccountEmployeeTimeOffRequestId = dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeOffRequestId FULL OUTER
                       JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeOffRequest.ApprovedBy = dbo.AccountEmployee.AccountEmployeeId
WHERE     (dbo.AccountEmployeeTimeEntry.IsTimeOff = 1)'
GO
-- Create View rptvueAccountEmployeeTimeOffRequestWithTimeEntryReport
Print 'Create View rptvueAccountEmployeeTimeOffRequestWithTimeEntryReport'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeOffRequestWithTimeEntryReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountEmployeeTimeOffRequestWithTimeEntryReport
AS
SELECT     AccountEmployeeTimeEntryId, AccountEmployeeId, TimeEntryDate, StartTime, EndTime, TotalTime, Description, Approved, CreatedOn, Submitted, 
                      ModifiedOn, Rejected, IsTimeOff, Hours, AccountTimeOffTypeId, AccountEmployeeTimeOffRequestId, AccountTimeOffType, IsTimeOffRequestRequired, 
                      AccountId, RequestSubmitDate, HoursOff, StartDate, EndDate, DayOff, RequestDescription, RequestInApproval, RequestApproved, RequestRejected, 
                      RequestApprovedOn, RequestApprovedBy, RequestApprovalEmployeeName, EmployeeName, EMailAddress, DepartmentCode, DepartmentName, 
                      Role, AccountLocation, EmployeeCode, AccountTimeOffPolicy, AccountTimeOffPolicyId, AccountLocationId, AccountDepartmentId, AccountRoleId, 
                      AccountProjectId, ProjectName
FROM         dbo.vueAccountEmployeeTimeOffRequestWithTimeEntryReport'
GO
-- Create Foreign Key FK_AccountEmployeeTimeOffRequest_AccountProject on AccountEmployeeTimeOffRequest
Print 'Create Foreign Key FK_AccountEmployeeTimeOffRequest_AccountProject on AccountEmployeeTimeOffRequest'
GO
IF NOT EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_SCHEMA='dbo' AND CONSTRAINT_NAME='FK_AccountEmployeeTimeOffRequest_AccountProject' AND TABLE_NAME='AccountEmployeeTimeOffRequest')
BEGIN
		ALTER TABLE [dbo].[AccountEmployeeTimeOffRequest]
			ADD CONSTRAINT [FK_AccountEmployeeTimeOffRequest_AccountProject]
			FOREIGN KEY ([AccountProjectId]) REFERENCES [dbo].[AccountProject] ([AccountProjectId])
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'
if not exists(Select * from [dbo].[SystemReportDataSourceField] where [SystemReportDataSourceFieldId] = 'd799effe-33ac-4e97-a816-7bb32b448316')
BEGIN
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('d799effe-33ac-4e97-a816-7bb32b448316', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', N'ProjectName', 250, 1, NULL, NULL, 30, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Project Name', 0, 0)
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportFilterSourceMapping]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportFilterSourceMapping]'
IF NOT EXISTS (SELECT * FROM [dbo].[SystemReportFilterSourceMapping] WHERE [SystemReportFilterMappingId] = '71ff5d48-55a0-4422-bcc0-a4c5e8afbf25')
BEGIN
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('71ff5d48-55a0-4422-bcc0-a4c5e8afbf25', '8f7f0cc7-e5e4-4f40-924a-60a126092cc0', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', 1, 1, 2)
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportFilterSourceMapping]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportFilterSourceMapping]'

UPDATE [dbo].[SystemReportFilterSourceMapping] SET [FilterSequence]=3 WHERE [SystemReportFilterMappingId]='af9a0557-97e9-468b-9a98-6846f0302e91'
UPDATE [dbo].[SystemReportFilterSourceMapping] SET [FilterSequence]=4 WHERE [SystemReportFilterMappingId]='b8b68a42-ef88-40f4-97a3-46814a438dae'
UPDATE [dbo].[SystemReportFilterSourceMapping] SET [FilterSequence]=5 WHERE [SystemReportFilterMappingId]='2ec282f6-0c16-4624-9bf6-465d4035c28e'
UPDATE [dbo].[SystemReportFilterSourceMapping] SET [FilterSequence]=6 WHERE [SystemReportFilterMappingId]='416f1c49-5516-4f7c-8128-cfc746c8810d'
UPDATE [dbo].[SystemReportFilterSourceMapping] SET [FilterSequence]=7 WHERE [SystemReportFilterMappingId]='e83a6069-16cc-4df8-9681-3bccbf9a2414'
UPDATE [dbo].[SystemReportFilterSourceMapping] SET [FilterSequence]=8 WHERE [SystemReportFilterMappingId]='23a2713f-fc3c-4595-b388-3f605bd3e852'
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[AccountReportColumn]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[AccountReportColumn]'
IF NOT EXISTS (SELECT * FROM [dbo].[AccountReportColumn] WHERE [AccountReportColumnId] = 'b87f6052-c570-461d-959c-3b885fc1f379')
BEGIN
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('b87f6052-c570-461d-959c-3b885fc1f379', '9e8be519-37bd-447d-9c33-a94946ba7261', N'ProjectName', 'd799effe-33ac-4e97-a816-7bb32b448316', 14, NULL, NULL)
END
GO
-- =======================================================
-- Foreign Key Constraint Nochecks's for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print ' Foreign Key Constraint Nochecks''s for Table: [dbo].[SystemSecurityCategoryPage]'

ALTER TABLE [dbo].[SystemSecurityCategoryPage] NOCHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory]
ALTER TABLE [dbo].[SystemSecurityCategoryPage] NOCHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory1]

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemSecurityCategoryPage]'
Update [SystemSecurityCategoryPage] Set [SystemCategoryPageDescription] = 'Manage' WHERE [SystemSecurityCategoryPageId] = 34
Update [SystemSecurityCategoryPage] Set [ParentSystemSecurityCateogoryPageId] = 34 WHERE [SystemSecurityCategoryPageId] = 144
Update [SystemSecurityCategoryPage] Set [IsShowDataOptions] = 1 WHERE [SystemSecurityCategoryPageId] = 135
UPDATE [dbo].[SystemSecurityCategoryPage] SET [IsAllowAdd]=0 WHERE [SystemSecurityCategoryPageId]=18
-- =======================================================
-- Foreign Key Constraint Check's for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print ' Foreign Key Constraint Check''s for Table: [dbo].[SystemSecurityCategoryPage]'

ALTER TABLE [dbo].[SystemSecurityCategoryPage] CHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory]
ALTER TABLE [dbo].[SystemSecurityCategoryPage] CHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory1]
GO
-- Alter Column EMailSubject on EmailMessage
Print 'Alter Column EMailSubject on EmailMessage'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'EmailMessage' AND TABLE_TYPE='BASE TABLE')) AND (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='EMailSubject' AND TABLE_NAME='EmailMessage'))
ALTER TABLE [dbo].[EmailMessage]
	 ALTER COLUMN [EMailSubject] nvarchar(4000) NOT NULL
GO
-- =======================================================
-- Foreign Key Constraint Nochecks's for Table: [dbo].[AccountReportColumn]
-- =======================================================
Print ' Foreign Key Constraint Nochecks''s for Table: [dbo].[AccountReportColumn]'

ALTER TABLE [dbo].[AccountReportColumn] NOCHECK CONSTRAINT [FK_AccountReportColumn_AccountReport]

-- =======================================================
-- Synchronization Script for Table: [dbo].[AccountReportColumn]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[AccountReportColumn]'
If exists(Select * from AccountReportColumn where AccountReportColumnId = 'b4eb5e70-057a-4a30-b97b-a3dca2fcfc7e')

DELETE FROM [dbo].[AccountReportColumn] WHERE [AccountReportColumnId]='b4eb5e70-057a-4a30-b97b-a3dca2fcfc7e'

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'
If exists(Select * from SystemReportDataSourceField where SystemReportDataSourceFieldId = 'dc035b18-d8ce-4b6b-82f4-15ba12274eb7')

DELETE FROM [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId]='dc035b18-d8ce-4b6b-82f4-15ba12274eb7'

-- =======================================================
-- Foreign Key Constraint Check's for Table: [dbo].[AccountReportColumn]
-- =======================================================
Print ' Foreign Key Constraint Check''s for Table: [dbo].[AccountReportColumn]'

ALTER TABLE [dbo].[AccountReportColumn] CHECK CONSTRAINT [FK_AccountReportColumn_AccountReport]

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportFilterSourceMapping]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportFilterSourceMapping]'

UPDATE [dbo].[SystemReportFilterSourceMapping] SET [SystemReportFilterSourceId]='8e41ac07-9d13-450a-b8b2-f37db3eeb32e' WHERE [SystemReportFilterMappingId]='921042be-fe69-4e85-8a3d-d2d960c712cb'

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'
if not exists(Select * from [dbo].[SystemReportDataSourceField] where [SystemReportDataSourceFieldId] = 'e095805f-53fb-4810-828a-82383891cfd9')
BEGIN
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('e095805f-53fb-4810-828a-82383891cfd9', '7e5678a3-d1bc-4bb4-8fd1-75cab80388ba', N'IsDisabled', 70, 1, NULL, NULL, 21, 'b2cb6685-3a4b-4cf9-a15a-d01a63031e2b', N'Is Disabled', 0, 0)
END
-- =======================================================
-- Synchronization Script for Table: [dbo].[AccountReportColumn]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[AccountReportColumn]'
IF NOT EXISTS (SELECT * FROM [dbo].[AccountReportColumn] WHERE [AccountReportColumnId] = '552a59a6-7093-474c-9736-06a131b09306')
BEGIN
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('552a59a6-7093-474c-9736-06a131b09306', '479ce554-5ab3-4e0b-a552-ca1b233713c9', N'IsDisabled_text', 'e095805f-53fb-4810-828a-82383891cfd9', 10, NULL, NULL)
END
GO
IF NOT (EXISTS(SELECT * FROM sysobjects WHERE id = OBJECT_ID(N'[dbo].[AuditTriggerAccountEmployeeTimeEntry]') AND [type]='TR'))
EXEC sp_executesql N'
CREATE trigger [AuditTriggerAccountEmployeeTimeEntry] on [dbo].[AccountEmployeeTimeEntry] for insert, update, delete
as

declare @bit int ,
	@field int ,
	@maxfield int ,
	@char int ,
	@fieldname nvarchar(256) ,
	@TableName nvarchar(256) ,
	@PKCols nvarchar(2000) ,
	@sql nvarchar(4000), 
	@UpdateDate nvarchar(42) ,
	@UserName nvarchar(256) ,
	@Type nchar(1) ,
	@PKSelect nvarchar(2000)
	
	select @TableName = ''AccountEmployeeTimeEntry''

	-- date and user
	select 	@UserName = system_user ,
		@UpdateDate = convert(nvarchar(16), getdate(), 112) + '' '' + convert(nvarchar(16), getdate(), 114)



	-- Action
	if exists (select * from inserted)
		if exists (select * from deleted)
			Begin
				select @Type = ''U''
				select @UserName  = ModifiedByEmployeeId from inserted
			End 
		else
			Begin
				select @UserName  = CreatedByEmployeeId from inserted
				select @Type = ''I''
			End
	else
		Begin
			select @Type = ''D''
			select @UserName  = ModifiedByEmployeeId from deleted
		End 
	
	-- get list of columns
	select * into #ins from inserted
	select * into #del from deleted
	
	-- Get primary key columns for full outer join
	select	@PKCols = coalesce(@PKCols + '' and'', '' on'') + '' i.'' + c.COLUMN_NAME + '' = d.'' + c.COLUMN_NAME
	from	INFORMATION_SCHEMA.TABLE_CONSTRAINTS pk ,
		INFORMATION_SCHEMA.KEY_COLUMN_USAGE c
	where 	pk.TABLE_NAME = @TableName
	and	CONSTRAINT_TYPE = ''PRIMARY KEY''
	and	c.TABLE_NAME = pk.TABLE_NAME
	and	c.CONSTRAINT_NAME = pk.CONSTRAINT_NAME
	
	-- Get primary key select for insert
	select @PKSelect = coalesce(@PKSelect+''+'','''') + ''''''<'' + COLUMN_NAME + ''=''''+convert(nvarchar(200),coalesce(i.'' + COLUMN_NAME +'',d.'' + COLUMN_NAME + ''))+''''>'''''' 
	from	INFORMATION_SCHEMA.TABLE_CONSTRAINTS pk ,
		INFORMATION_SCHEMA.KEY_COLUMN_USAGE c
	where 	pk.TABLE_NAME = @TableName
	and	CONSTRAINT_TYPE = ''PRIMARY KEY''
	and	c.TABLE_NAME = pk.TABLE_NAME
	and	c.CONSTRAINT_NAME = pk.CONSTRAINT_NAME
	
	if @PKCols is null
	begin
		raiserror(''no PK on table %s'', 16, -1, @TableName)
		return
	end
	
	select @field = 0, @maxfield = max(ORDINAL_POSITION) from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME = @TableName
	while @field < @maxfield
	begin
		select @field = min(ORDINAL_POSITION) from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME = @TableName and ORDINAL_POSITION > @field
		select @bit = (@field - 1 )% 8 + 1
		select @bit = power(2,@bit - 1)
		select @char = ((@field - 1) / 8) + 1
		if substring(COLUMNS_UPDATED(),@char, 1) & @bit > 0 or @Type in (''I'',''D'')
		begin
			select @fieldname = COLUMN_NAME from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME = @TableName and ORDINAL_POSITION = @field
			select @sql = 		''insert Audit (Type, TableName, PK, FieldName, OldValue, NewValue, UpdateDate, UserName)''
			select @sql = @sql + 	'' select '''''' + @Type + ''''''''
			select @sql = @sql + 	'','''''' + @TableName + ''''''''
			select @sql = @sql + 	'','' + Replace(Replace(@PKSelect,''<AccountEmployeeTimeEntryId='',''''),''>'','''')
			select @sql = @sql + 	'','''''' + @fieldname + ''''''''
			select @sql = @sql + 	'',convert(nvarchar(2000),d.'' + @fieldname + '')''
			select @sql = @sql + 	'',convert(nvarchar(2000),i.'' + @fieldname + '')''
			select @sql = @sql + 	'','''''' + @UpdateDate + ''''''''
			select @sql = @sql + 	'','''''' + @UserName + ''''''''
			select @sql = @sql + 	'' from #ins i full outer join #del d''
			select @sql = @sql + 	@PKCols
			select @sql = @sql + 	'' where i.'' + @fieldname + '' <> d.'' + @fieldname 
			select @sql = @sql + 	'' or (i.'' + @fieldname + '' is null and  d.'' + @fieldname + '' is not null)'' 
			select @sql = @sql + 	'' or (i.'' + @fieldname + '' is not null and  d.'' + @fieldname + '' is null)'' 
			exec (@sql)
		end
	end'
GO
IF NOT (EXISTS(SELECT * FROM sysobjects WHERE id = OBJECT_ID(N'[dbo].[AuditTriggerAccountEmployeeTimeEntryPeriod]') AND [type]='TR'))
EXEC sp_executesql N'
create trigger [AuditTriggerAccountEmployeeTimeEntryPeriod] on [dbo].[AccountEmployeeTimeEntryPeriod] for insert, update, delete
as

declare @bit int ,
	@field int ,
	@maxfield int ,
	@char int ,
	@fieldname nvarchar(256) ,
	@TableName nvarchar(256) ,
	@PKCols nvarchar(2000) ,
	@sql nvarchar(4000), 
	@UpdateDate nvarchar(42) ,
	@UserName nvarchar(256) ,
	@Type nchar(1) ,
	@PKSelect nvarchar(2000)
	
	select @TableName = ''AccountEmployeeTimeEntryPeriod''

	-- date and user
	select 	@UserName = system_user ,
		@UpdateDate = convert(nvarchar(16), getdate(), 112) + '' '' + convert(nvarchar(16), getdate(), 114)



	-- Action
	if exists (select * from inserted)
		if exists (select * from deleted)
			Begin
				select @Type = ''U''
				select @UserName  = ModifiedByEmployeeId from inserted
			End 
		else
			Begin
				select @UserName  = CreatedByEmployeeId from inserted
				select @Type = ''I''
			End
	else
		Begin
			select @Type = ''D''
			select @UserName  = ModifiedByEmployeeId from deleted
		End 
	
	-- get list of columns
	select * into #ins from inserted
	select * into #del from deleted
	
	-- Get primary key columns for full outer join
	select	@PKCols = coalesce(@PKCols + '' and'', '' on'') + '' i.'' + c.COLUMN_NAME + '' = d.'' + c.COLUMN_NAME
	from	INFORMATION_SCHEMA.TABLE_CONSTRAINTS pk ,
		INFORMATION_SCHEMA.KEY_COLUMN_USAGE c
	where 	pk.TABLE_NAME = @TableName
	and	CONSTRAINT_TYPE = ''PRIMARY KEY''
	and	c.TABLE_NAME = pk.TABLE_NAME
	and	c.CONSTRAINT_NAME = pk.CONSTRAINT_NAME
	
	-- Get primary key select for insert
	select @PKSelect = coalesce(@PKSelect+''+'','''') + ''''''<'' + COLUMN_NAME + ''=''''+convert(nvarchar(200),coalesce(i.'' + COLUMN_NAME +'',d.'' + COLUMN_NAME + ''))+''''>'''''' 
	from	INFORMATION_SCHEMA.TABLE_CONSTRAINTS pk ,
		INFORMATION_SCHEMA.KEY_COLUMN_USAGE c
	where 	pk.TABLE_NAME = @TableName
	and	CONSTRAINT_TYPE = ''PRIMARY KEY''
	and	c.TABLE_NAME = pk.TABLE_NAME
	and	c.CONSTRAINT_NAME = pk.CONSTRAINT_NAME
	
	if @PKCols is null
	begin
		raiserror(''no PK on table %s'', 16, -1, @TableName)
		return
	end
	
	select @field = 0, @maxfield = max(ORDINAL_POSITION) from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME = @TableName
	while @field < @maxfield
	begin
		select @field = min(ORDINAL_POSITION) from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME = @TableName and ORDINAL_POSITION > @field
		select @bit = (@field - 1 )% 8 + 1
		select @bit = power(2,@bit - 1)
		select @char = ((@field - 1) / 8) + 1
		if substring(COLUMNS_UPDATED(),@char, 1) & @bit > 0 or @Type in (''I'',''D'')
		begin
			select @fieldname = COLUMN_NAME from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME = @TableName and ORDINAL_POSITION = @field
			select @sql = 		''insert Audit (Type, TableName, PK, FieldName, OldValue, NewValue, UpdateDate, UserName)''
			select @sql = @sql + 	'' select '''''' + @Type + ''''''''
			select @sql = @sql + 	'','''''' + @TableName + ''''''''
			select @sql = @sql + 	'','' + Replace(Replace(@PKSelect,''<AccountEmployeeTimeEntryPeriodId='',''''),''>'','''')
			select @sql = @sql + 	'','''''' + @fieldname + ''''''''
			select @sql = @sql + 	'',convert(nvarchar(2000),d.'' + @fieldname + '')''
			select @sql = @sql + 	'',convert(nvarchar(2000),i.'' + @fieldname + '')''
			select @sql = @sql + 	'','''''' + @UpdateDate + ''''''''
			select @sql = @sql + 	'','''''' + @UserName + ''''''''
			select @sql = @sql + 	'' from #ins i full outer join #del d''
			select @sql = @sql + 	@PKCols
			select @sql = @sql + 	'' where i.'' + @fieldname + '' <> d.'' + @fieldname 
			select @sql = @sql + 	'' or (i.'' + @fieldname + '' is null and  d.'' + @fieldname + '' is not null)'' 
			select @sql = @sql + 	'' or (i.'' + @fieldname + '' is not null and  d.'' + @fieldname + '' is null)'' 
			exec (@sql)
		end
	end'
GO
IF NOT (EXISTS(SELECT * FROM sysobjects WHERE id = OBJECT_ID(N'[dbo].[AuditTriggerAccountExpenseEntry]') AND [type]='TR'))
EXEC sp_executesql N'
Create trigger [AuditTriggerAccountExpenseEntry] on [dbo].[AccountExpenseEntry] for insert, update, delete
as

declare @bit int ,
	@field int ,
	@maxfield int ,
	@char int ,
	@fieldname nvarchar(256) ,
	@TableName nvarchar(256) ,
	@PKCols nvarchar(2000) ,
	@sql nvarchar(4000), 
	@UpdateDate nvarchar(42) ,
	@UserName nvarchar(256) ,
	@Type nchar(1) ,
	@PKSelect nvarchar(2000)
	
	select @TableName = ''AccountExpenseEntry''

	-- date and user
	select 	@UserName = system_user ,
		@UpdateDate = convert(nvarchar(16), getdate(), 112) + '' '' + convert(nvarchar(16), getdate(), 114)



	-- Action
	if exists (select * from inserted)
		if exists (select * from deleted)
			Begin
				select @Type = ''U''
				select @UserName  = ModifiedByEmployeeId from inserted
			End 
		else
			Begin
				select @UserName  = CreatedByEmployeeId from inserted
				select @Type = ''I''
			End
	else
		Begin
			select @Type = ''D''
			select @UserName  = ModifiedByEmployeeId from deleted
		End 
	
	-- get list of columns
	select * into #ins from inserted
	select * into #del from deleted
	
	-- Get primary key columns for full outer join
	select	@PKCols = coalesce(@PKCols + '' and'', '' on'') + '' i.'' + c.COLUMN_NAME + '' = d.'' + c.COLUMN_NAME
	from	INFORMATION_SCHEMA.TABLE_CONSTRAINTS pk ,
		INFORMATION_SCHEMA.KEY_COLUMN_USAGE c
	where 	pk.TABLE_NAME = @TableName
	and	CONSTRAINT_TYPE = ''PRIMARY KEY''
	and	c.TABLE_NAME = pk.TABLE_NAME
	and	c.CONSTRAINT_NAME = pk.CONSTRAINT_NAME
	
	-- Get primary key select for insert
	select @PKSelect = coalesce(@PKSelect+''+'','''') + ''''''<'' + COLUMN_NAME + ''=''''+convert(nvarchar(200),coalesce(i.'' + COLUMN_NAME +'',d.'' + COLUMN_NAME + ''))+''''>'''''' 
	from	INFORMATION_SCHEMA.TABLE_CONSTRAINTS pk ,
		INFORMATION_SCHEMA.KEY_COLUMN_USAGE c
	where 	pk.TABLE_NAME = @TableName
	and	CONSTRAINT_TYPE = ''PRIMARY KEY''
	and	c.TABLE_NAME = pk.TABLE_NAME
	and	c.CONSTRAINT_NAME = pk.CONSTRAINT_NAME
	
	if @PKCols is null
	begin
		raiserror(''no PK on table %s'', 16, -1, @TableName)
		return
	end
	
	select @field = 0, @maxfield = max(ORDINAL_POSITION) from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME = @TableName
	while @field < @maxfield
	begin
		select @field = min(ORDINAL_POSITION) from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME = @TableName and ORDINAL_POSITION > @field
		select @bit = (@field - 1 )% 8 + 1
		select @bit = power(2,@bit - 1)
		select @char = ((@field - 1) / 8) + 1
		if substring(COLUMNS_UPDATED(),@char, 1) & @bit > 0 or @Type in (''I'',''D'')
		begin
			select @fieldname = COLUMN_NAME from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME = @TableName and ORDINAL_POSITION = @field
			select @sql = 		''insert Audit (Type, TableName, PK, FieldName, OldValue, NewValue, UpdateDate, UserName)''
			select @sql = @sql + 	'' select '''''' + @Type + ''''''''
			select @sql = @sql + 	'','''''' + @TableName + ''''''''
			select @sql = @sql + 	'','' + Replace(Replace(@PKSelect,''<AccountExpenseEntryId='',''''),''>'','''')
			select @sql = @sql + 	'','''''' + @fieldname + ''''''''
			select @sql = @sql + 	'',convert(nvarchar(2000),d.'' + @fieldname + '')''
			select @sql = @sql + 	'',convert(nvarchar(2000),i.'' + @fieldname + '')''
			select @sql = @sql + 	'','''''' + @UpdateDate + ''''''''
			select @sql = @sql + 	'','''''' + @UserName + ''''''''
			select @sql = @sql + 	'' from #ins i full outer join #del d''
			select @sql = @sql + 	@PKCols
			select @sql = @sql + 	'' where i.'' + @fieldname + '' <> d.'' + @fieldname 
			select @sql = @sql + 	'' or (i.'' + @fieldname + '' is null and  d.'' + @fieldname + '' is not null)'' 
			select @sql = @sql + 	'' or (i.'' + @fieldname + '' is not null and  d.'' + @fieldname + '' is null)'' 
			exec (@sql)
		end
	end'
GO
IF NOT (EXISTS(SELECT * FROM sysobjects WHERE id = OBJECT_ID(N'[dbo].[AuditTriggerAccountEmployeeExpenseSheet]') AND [type]='TR'))
EXEC sp_executesql N'
Create trigger [AuditTriggerAccountEmployeeExpenseSheet] on [dbo].[AccountEmployeeExpenseSheet] for insert, update, delete
as

declare @bit int ,
	@field int ,
	@maxfield int ,
	@char int ,
	@fieldname nvarchar(256) ,
	@TableName nvarchar(256) ,
	@PKCols nvarchar(2000) ,
	@sql nvarchar(4000), 
	@UpdateDate nvarchar(42) ,
	@UserName nvarchar(256) ,
	@Type nchar(1) ,
	@PKSelect nvarchar(2000)
	
	select @TableName = ''AccountEmployeeExpenseSheet''

	-- date and user
	select 	@UserName = system_user ,
		@UpdateDate = convert(nvarchar(16), getdate(), 112) + '' '' + convert(nvarchar(16), getdate(), 114)



	-- Action
	if exists (select * from inserted)
		if exists (select * from deleted)
			Begin
				select @Type = ''U''
				select @UserName  = ModifiedByEmployeeId from inserted
			End 
		else
			Begin
				select @UserName  = CreatedByEmployeeId from inserted
				select @Type = ''I''
			End
	else
		Begin
			select @Type = ''D''
			select @UserName  = ModifiedByEmployeeId from deleted
		End 
	
	-- get list of columns
	select * into #ins from inserted
	select * into #del from deleted
	
	-- Get primary key columns for full outer join
	select	@PKCols = coalesce(@PKCols + '' and'', '' on'') + '' i.'' + c.COLUMN_NAME + '' = d.'' + c.COLUMN_NAME
	from	INFORMATION_SCHEMA.TABLE_CONSTRAINTS pk ,
		INFORMATION_SCHEMA.KEY_COLUMN_USAGE c
	where 	pk.TABLE_NAME = @TableName
	and	CONSTRAINT_TYPE = ''PRIMARY KEY''
	and	c.TABLE_NAME = pk.TABLE_NAME
	and	c.CONSTRAINT_NAME = pk.CONSTRAINT_NAME
	
	-- Get primary key select for insert
	select @PKSelect = coalesce(@PKSelect+''+'','''') + ''''''<'' + COLUMN_NAME + ''=''''+convert(nvarchar(200),coalesce(i.'' + COLUMN_NAME +'',d.'' + COLUMN_NAME + ''))+''''>'''''' 
	from	INFORMATION_SCHEMA.TABLE_CONSTRAINTS pk ,
		INFORMATION_SCHEMA.KEY_COLUMN_USAGE c
	where 	pk.TABLE_NAME = @TableName
	and	CONSTRAINT_TYPE = ''PRIMARY KEY''
	and	c.TABLE_NAME = pk.TABLE_NAME
	and	c.CONSTRAINT_NAME = pk.CONSTRAINT_NAME
	
	if @PKCols is null
	begin
		raiserror(''no PK on table %s'', 16, -1, @TableName)
		return
	end
	
	select @field = 0, @maxfield = max(ORDINAL_POSITION) from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME = @TableName
	while @field < @maxfield
	begin
		select @field = min(ORDINAL_POSITION) from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME = @TableName and ORDINAL_POSITION > @field
		select @bit = (@field - 1 )% 8 + 1
		select @bit = power(2,@bit - 1)
		select @char = ((@field - 1) / 8) + 1
		if substring(COLUMNS_UPDATED(),@char, 1) & @bit > 0 or @Type in (''I'',''D'')
		begin
			select @fieldname = COLUMN_NAME from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME = @TableName and ORDINAL_POSITION = @field
			select @sql = 		''insert Audit (Type, TableName, PK, FieldName, OldValue, NewValue, UpdateDate, UserName)''
			select @sql = @sql + 	'' select '''''' + @Type + ''''''''
			select @sql = @sql + 	'','''''' + @TableName + ''''''''
			select @sql = @sql + 	'','' + Replace(Replace(@PKSelect,''<AccountEmployeeExpenseSheetId='',''''),''>'','''')
			select @sql = @sql + 	'','''''' + @fieldname + ''''''''
			select @sql = @sql + 	'',convert(nvarchar(2000),d.'' + @fieldname + '')''
			select @sql = @sql + 	'',convert(nvarchar(2000),i.'' + @fieldname + '')''
			select @sql = @sql + 	'','''''' + @UpdateDate + ''''''''
			select @sql = @sql + 	'','''''' + @UserName + ''''''''
			select @sql = @sql + 	'' from #ins i full outer join #del d''
			select @sql = @sql + 	@PKCols
			select @sql = @sql + 	'' where i.'' + @fieldname + '' <> d.'' + @fieldname 
			select @sql = @sql + 	'' or (i.'' + @fieldname + '' is null and  d.'' + @fieldname + '' is not null)'' 
			select @sql = @sql + 	'' or (i.'' + @fieldname + '' is not null and  d.'' + @fieldname + '' is null)'' 
			exec (@sql)
		end
	end'
GO
-- =======================================================
-- Foreign Key Constraint Nochecks's for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print ' Foreign Key Constraint Nochecks''s for Table: [dbo].[SystemSecurityCategoryPage]'

ALTER TABLE [dbo].[SystemSecurityCategoryPage] NOCHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory]
ALTER TABLE [dbo].[SystemSecurityCategoryPage] NOCHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory1]
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemSecurityCategoryPage]'
If Not Exists(Select * from [dbo].[SystemSecurityCategoryPage] where [SystemSecurityCategoryPageId] = 145)
BEGIN
INSERT INTO [dbo].[SystemSecurityCategoryPage] ([SystemSecurityCategoryPageId], [SystemSecurityCategoryId], [SequenceNumber], [Folder], [SystemCategoryPage], [SystemCategoryPageDescription], [ParentSystemSecurityCateogoryPageId], [IsSiteMapPage], [IsCustomizeable], [IsAllowAdd], [IsAllowEdit], [IsAllowDelete], [IsAllowList], [IsShowDataOptions], [IsShowTillOptions], [IsSystemPage], [ControlLevelPermission], [NotShowInPermission]) VALUES (145, 2, N'218544563', N'Employee', 'AccountEmployeeTimeEntryAudit.aspx', 'Timesheet Audit', 18, 1, 1, NULL, NULL, NULL, 1, NULL, NULL, NULL, NULL, NULL)
INSERT INTO [dbo].[SystemSecurityCategoryPage] ([SystemSecurityCategoryPageId], [SystemSecurityCategoryId], [SequenceNumber], [Folder], [SystemCategoryPage], [SystemCategoryPageDescription], [ParentSystemSecurityCateogoryPageId], [IsSiteMapPage], [IsCustomizeable], [IsAllowAdd], [IsAllowEdit], [IsAllowDelete], [IsAllowList], [IsShowDataOptions], [IsShowTillOptions], [IsSystemPage], [ControlLevelPermission], [NotShowInPermission]) VALUES (146, 2, N'218544563', N'Employee', 'AccountExpenseEntryAudit.aspx', 'Expense Sheet Audit', 135, 1, 1, NULL, NULL, NULL, 1, NULL, NULL, NULL, NULL, NULL)
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemSecurityCategoryPage]'
UPDATE [dbo].[SystemSecurityCategoryPage] SET [NotShowInPermission]=1 WHERE [SystemSecurityCategoryPageId]=20
GO
-- =======================================================
-- Foreign Key Constraint Check's for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print ' Foreign Key Constraint Check''s for Table: [dbo].[SystemSecurityCategoryPage]'

ALTER TABLE [dbo].[SystemSecurityCategoryPage] CHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory]
ALTER TABLE [dbo].[SystemSecurityCategoryPage] CHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory1]
GO
-- Drop Index IX_PK from Audit
Print 'Drop Index IX_PK from Audit'
GO
DROP INDEX [dbo].[Audit].[IX_PK]
GO
-- Alter Column PK on Audit
Print 'Alter Column PK on Audit'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'Audit' AND TABLE_TYPE='BASE TABLE')) AND (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='PK' AND TABLE_NAME='Audit'))
ALTER TABLE [dbo].[Audit]
	 ALTER COLUMN [PK] varchar(50) NULL
GO
-- Create Index IX_PK on Audit
Print 'Create Index IX_PK on Audit'
GO
CREATE INDEX [IX_PK]
	ON [dbo].[Audit] ([PK])
GO
If Exists(Select * From SystemReportFilterSourceMapping where SystemReportFilterMappingId = '31d01917-0ef3-4fd4-b3bb-8185830d7b51')
BEGIN
Delete From SystemReportFilterSourceMapping where SystemReportFilterMappingId = '31d01917-0ef3-4fd4-b3bb-8185830d7b51'
END
--End 3.5.1
--Start 3.7.1
GO
-- Create Table MasterHolidayType
Print 'Create Table MasterHolidayType'
GO
IF NOT EXISTS (select * from information_schema.tables where table_name = 'MasterHolidayType' and table_type = 'BASE TABLE')
CREATE TABLE [dbo].[MasterHolidayType] (
		[MasterHolidayTypeId]     uniqueidentifier NOT NULL,
		[HolidayType]             nvarchar(50) NULL
)

GO
-- Add Primary Key PK_MasterHolidayType to MasterHolidayType
Print 'Add Primary Key PK_MasterHolidayType to MasterHolidayType'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'MasterHolidayType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_NAME='PK_MasterHolidayType' AND TABLE_NAME='MasterHolidayType'))
ALTER TABLE [dbo].[MasterHolidayType]
	ADD
	CONSTRAINT [PK_MasterHolidayType]
	PRIMARY KEY
	([MasterHolidayTypeId])
GO
-- Add Default Constraint DF_MasterHolidayType_AccountHolidayTypeId to MasterHolidayType
Print 'Add Default Constraint DF_MasterHolidayType_AccountHolidayTypeId to MasterHolidayType'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'MasterHolidayType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM sysobjects WHERE name= N'DF_MasterHolidayType_AccountHolidayTypeId'))
ALTER TABLE [dbo].[MasterHolidayType]
	ADD
	CONSTRAINT [DF_MasterHolidayType_AccountHolidayTypeId]
	DEFAULT (newid()) FOR [MasterHolidayTypeId]
GO
-- Create Table AccountHolidayType
Print 'Create Table AccountHolidayType'
GO
IF NOT EXISTS (select * from information_schema.tables where table_name = 'AccountHolidayType' and table_type = 'BASE TABLE') 
CREATE TABLE [dbo].[AccountHolidayType] (
		[AccountId]                int NULL,
		[AccountHolidayTypeId]     uniqueidentifier NOT NULL,
		[MasterHolidayTypeId]      uniqueidentifier NULL,
		[AccountHolidayType]       nvarchar(50) NULL,
		[IsDisabled]               bit NULL,
		[CreatedOn]                datetime NULL,
		[CreatedByEmployeeId]      int NULL,
		[ModifiedOn]               datetime NULL,
		[ModifiedByEmployeeId]     int NULL
)
GO
-- Add Primary Key PK_AccountHolidayType to AccountHolidayType
Print 'Add Primary Key PK_AccountHolidayType to AccountHolidayType'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountHolidayType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_NAME='PK_AccountHolidayType' AND TABLE_NAME='AccountHolidayType'))
ALTER TABLE [dbo].[AccountHolidayType]
	ADD
	CONSTRAINT [PK_AccountHolidayType]
	PRIMARY KEY
	([AccountHolidayTypeId])
GO
-- Add Default Constraint DF_AccountHolidayType_AccountHolidayTypeId to AccountHolidayType
Print 'Add Default Constraint DF_AccountHolidayType_AccountHolidayTypeId to AccountHolidayType'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountHolidayType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM sysobjects WHERE name= N'DF_AccountHolidayType_AccountHolidayTypeId'))
ALTER TABLE [dbo].[AccountHolidayType]
	ADD
	CONSTRAINT [DF_AccountHolidayType_AccountHolidayTypeId]
	DEFAULT (newid()) FOR [AccountHolidayTypeId]
GO
-- Create Table MasterHolidayTypeDetail
Print 'Create Table MasterHolidayTypeDetail'
GO
IF NOT EXISTS (select * from information_schema.tables where table_name = 'MasterHolidayTypeDetail' and table_type = 'BASE TABLE') 
CREATE TABLE [dbo].[MasterHolidayTypeDetail] (
		[MasterHolidayTypeId]           uniqueidentifier NOT NULL,
		[MasterHolidayTypeDetailId]     uniqueidentifier NOT NULL,
		[HolidayName]                   nvarchar(50) NULL,
		[HolidayMonth]                  int NULL,
		[HolidayDay]                    int NULL
)
GO

-- Add Primary Key PK_MasterHolidayTypeDetail_1 to MasterHolidayTypeDetail
Print 'Add Primary Key PK_MasterHolidayTypeDetail_1 to MasterHolidayTypeDetail'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'MasterHolidayTypeDetail' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_NAME='PK_MasterHolidayTypeDetail_1' AND TABLE_NAME='MasterHolidayTypeDetail'))
ALTER TABLE [dbo].[MasterHolidayTypeDetail]
	ADD
	CONSTRAINT [PK_MasterHolidayTypeDetail_1]
	PRIMARY KEY
	([MasterHolidayTypeDetailId])

GO
-- Add Default Constraint DF_MasterHolidayTypeDetail_MasterHolidayTypeDetailId to MasterHolidayTypeDetail
Print 'Add Default Constraint DF_MasterHolidayTypeDetail_MasterHolidayTypeDetailId to MasterHolidayTypeDetail'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'MasterHolidayTypeDetail' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM sysobjects WHERE name= N'DF_MasterHolidayTypeDetail_MasterHolidayTypeDetailId'))
ALTER TABLE [dbo].[MasterHolidayTypeDetail]
	ADD
	CONSTRAINT [DF_MasterHolidayTypeDetail_MasterHolidayTypeDetailId]
	DEFAULT (newid()) FOR [MasterHolidayTypeDetailId]
GO
-- Create Table AccountHolidayTypeDetail
Print 'Create Table AccountHolidayTypeDetail'
GO
IF NOT EXISTS (select * from information_schema.tables where table_name = 'AccountHolidayTypeDetail' and table_type = 'BASE TABLE') 
CREATE TABLE [dbo].[AccountHolidayTypeDetail] (
		[AccountHolidayTypeDetailId]     uniqueidentifier NOT NULL,
		[AccountHolidayTypeId]           uniqueidentifier NOT NULL,
		[MasterHolidayTypeDetailId]      uniqueidentifier NULL,
		[HolidayName]                    nvarchar(50) NULL,
		[HolidayDate]                    datetime NULL,
		[AccountId]                      int NULL,
		[CreatedOn]                      datetime NULL,
		[CreatedByEmployeeId]            int NULL,
		[ModifiedOn]                     datetime NULL,
		[ModifiedByEmployeeId]           int NULL
)

GO
-- Add Primary Key PK_AccountHolidayTypeDetail to AccountHolidayTypeDetail
Print 'Add Primary Key PK_AccountHolidayTypeDetail to AccountHolidayTypeDetail'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountHolidayTypeDetail' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_NAME='PK_AccountHolidayTypeDetail' AND TABLE_NAME='AccountHolidayTypeDetail'))
ALTER TABLE [dbo].[AccountHolidayTypeDetail]
	ADD
	CONSTRAINT [PK_AccountHolidayTypeDetail]
	PRIMARY KEY
	([AccountHolidayTypeDetailId])
GO
-- Add Default Constraint DF_AccountHolidayTypeDetail_AccountHolidayTypeDetailId to AccountHolidayTypeDetail
Print 'Add Default Constraint DF_AccountHolidayTypeDetail_AccountHolidayTypeDetailId to AccountHolidayTypeDetail'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountHolidayTypeDetail' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM sysobjects WHERE name= N'DF_AccountHolidayTypeDetail_AccountHolidayTypeDetailId'))
ALTER TABLE [dbo].[AccountHolidayTypeDetail]
	ADD
	CONSTRAINT [DF_AccountHolidayTypeDetail_AccountHolidayTypeDetailId]
	DEFAULT (newid()) FOR [AccountHolidayTypeDetailId]


GO
-- Create View vueAccountHolidayType
Print 'Create View vueAccountHolidayType'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountHolidayType' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountHolidayType
AS
SELECT     AccountHolidayTypeId, MasterHolidayTypeId, AccountHolidayType, AccountId, IsDisabled
FROM         dbo.AccountHolidayType'


GO
-- Create View vueAccountHolidaySelect
Print 'Create View vueAccountHolidaySelect'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountHolidaySelect' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountHolidaySelect
AS
SELECT     HolidayType, MasterHolidayTypeId
FROM         dbo.MasterHolidayType'

GO
-- Create View vueAccountHolidayTypeDetail
Print 'Create View vueAccountHolidayTypeDetail'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountHolidayTypeDetail' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountHolidayTypeDetail
AS
SELECT     AccountHolidayTypeDetailId, AccountHolidayTypeId, MasterHolidayTypeDetailId, HolidayName, HolidayDate, AccountId, YEAR(HolidayDate) AS Year
FROM         dbo.AccountHolidayTypeDetail'

GO
-- Add Column AccountHolidayTypeId to AccountEmployee
Print 'Add Column AccountHolidayTypeId to AccountEmployee'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployee' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='AccountHolidayTypeId' AND TABLE_NAME='AccountEmployee'))
ALTER TABLE [dbo].[AccountEmployee]
	ADD [AccountHolidayTypeId] uniqueidentifier NULL

GO
-- Create View vueAccountHolidayEmployee
Print 'Create View vueAccountHolidayEmployee'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountHolidayEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountHolidayEmployee
AS
SELECT     dbo.AccountHolidayType.AccountHolidayTypeId, dbo.AccountHolidayType.MasterHolidayTypeId, dbo.AccountHolidayType.AccountHolidayType, 
                      dbo.AccountHolidayType.IsDisabled, dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.AccountId
FROM         dbo.AccountHolidayType INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountHolidayType.AccountHolidayTypeId = dbo.AccountEmployee.AccountHolidayTypeId'


GO
-- =======================================================
-- Foreign Key Constraint Nochecks's for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print ' Foreign Key Constraint Nochecks''s for Table: [dbo].[SystemSecurityCategoryPage]'

ALTER TABLE [dbo].[SystemSecurityCategoryPage] NOCHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory]
ALTER TABLE [dbo].[SystemSecurityCategoryPage] NOCHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory1]

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemSecurityCategoryPage]'
If Not Exists(Select * from [dbo].[SystemSecurityCategoryPage] where [SystemSecurityCategoryPageId] = 147)
BEGIN
INSERT INTO [dbo].[SystemSecurityCategoryPage] ([SystemSecurityCategoryPageId], [SystemSecurityCategoryId], [SequenceNumber], [Folder], [SystemCategoryPage], [SystemCategoryPageDescription], [ParentSystemSecurityCateogoryPageId], [IsSiteMapPage], [IsCustomizeable], [IsAllowAdd], [IsAllowEdit], [IsAllowDelete], [IsAllowList], [IsShowDataOptions], [IsShowTillOptions], [IsSystemPage], [ControlLevelPermission], [NotShowInPermission]) VALUES (147, 1, N'2184012857', N'AccountAdmin', 'AccountHolidayTypes.aspx', 'Holiday Types', 15, 1, 1, 1, 1, 1, 1, NULL, NULL, NULL, NULL, NULL)
INSERT INTO [dbo].[SystemSecurityCategoryPage] ([SystemSecurityCategoryPageId], [SystemSecurityCategoryId], [SequenceNumber], [Folder], [SystemCategoryPage], [SystemCategoryPageDescription], [ParentSystemSecurityCateogoryPageId], [IsSiteMapPage], [IsCustomizeable], [IsAllowAdd], [IsAllowEdit], [IsAllowDelete], [IsAllowList], [IsShowDataOptions], [IsShowTillOptions], [IsSystemPage], [ControlLevelPermission], [NotShowInPermission]) VALUES (148, 1, N'2184012858', N'AccountAdmin', 'AccountHolidayTypeDetail.aspx', 'Holiday Type Detail', 147, 1, 1, 1, 1, 1, 1, NULL, NULL, NULL, NULL, NULL)
INSERT INTO [dbo].[SystemSecurityCategoryPage] ([SystemSecurityCategoryPageId], [SystemSecurityCategoryId], [SequenceNumber], [Folder], [SystemCategoryPage], [SystemCategoryPageDescription], [ParentSystemSecurityCateogoryPageId], [IsSiteMapPage], [IsCustomizeable], [IsAllowAdd], [IsAllowEdit], [IsAllowDelete], [IsAllowList], [IsShowDataOptions], [IsShowTillOptions], [IsSystemPage], [ControlLevelPermission], [NotShowInPermission]) VALUES (149, 1, N'2184012859', N'AccountAdmin', 'AccountHolidaySelect.aspx', 'Holidays Select', 15, 1, 1, 1, 0, 0, 1, NULL, NULL, NULL, NULL, NULL)
END
-- =======================================================
-- Foreign Key Constraint Check's for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print ' Foreign Key Constraint Check''s for Table: [dbo].[SystemSecurityCategoryPage]'

ALTER TABLE [dbo].[SystemSecurityCategoryPage] CHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory]
ALTER TABLE [dbo].[SystemSecurityCategoryPage] CHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory1]


GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[MasterHolidayType]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[MasterHolidayType]'
IF NOT EXISTS (SELECT * FROM [dbo].[MasterHolidayType] WHERE [MasterHolidayTypeId] = 'be529e49-927e-4cb9-b80d-9fb1c14d0f46')
BEGIN
INSERT INTO [dbo].[MasterHolidayType] ([MasterHolidayTypeId], [HolidayType]) VALUES ('be529e49-927e-4cb9-b80d-9fb1c14d0f46', N'US')
INSERT INTO [dbo].[MasterHolidayType] ([MasterHolidayTypeId], [HolidayType]) VALUES ('5e38ffd5-e894-4b27-9479-73bea0d8aa64', N'Canada')
INSERT INTO [dbo].[MasterHolidayType] ([MasterHolidayTypeId], [HolidayType]) VALUES ('dd58747d-ea78-4253-8b2f-2fe35065d4f3', N'UK')


-- =======================================================
-- Synchronization Script for Table: [dbo].[MasterHolidayTypeDetail]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[MasterHolidayTypeDetail]'

INSERT INTO [dbo].[MasterHolidayTypeDetail] ([MasterHolidayTypeId], [MasterHolidayTypeDetailId], [HolidayName], [HolidayMonth], [HolidayDay]) VALUES ('be529e49-927e-4cb9-b80d-9fb1c14d0f46', '14cc7f22-c5c4-4eaf-b30b-ba311903437b', N'Columbus Day', 10, 11)
INSERT INTO [dbo].[MasterHolidayTypeDetail] ([MasterHolidayTypeId], [MasterHolidayTypeDetailId], [HolidayName], [HolidayMonth], [HolidayDay]) VALUES ('be529e49-927e-4cb9-b80d-9fb1c14d0f46', 'd83c1025-f9e9-4418-97ed-3b53ce740057', N'Birthday of Martin Luther King, Jr.', 1, 18)
INSERT INTO [dbo].[MasterHolidayTypeDetail] ([MasterHolidayTypeId], [MasterHolidayTypeDetailId], [HolidayName], [HolidayMonth], [HolidayDay]) VALUES ('5e38ffd5-e894-4b27-9479-73bea0d8aa64', '3fcc422f-c126-4eea-bc55-a5d71571a609', N'Christmas Day', 12, 25)
INSERT INTO [dbo].[MasterHolidayTypeDetail] ([MasterHolidayTypeId], [MasterHolidayTypeDetailId], [HolidayName], [HolidayMonth], [HolidayDay]) VALUES ('5e38ffd5-e894-4b27-9479-73bea0d8aa64', '62cd7744-21a6-4b75-89ec-8b393d91301f', N'Remembrance Day', 11, 11)
INSERT INTO [dbo].[MasterHolidayTypeDetail] ([MasterHolidayTypeId], [MasterHolidayTypeDetailId], [HolidayName], [HolidayMonth], [HolidayDay]) VALUES ('5e38ffd5-e894-4b27-9479-73bea0d8aa64', 'c69a654f-f36a-405c-88e5-2e1910f1a672', N'Canada Day', 7, 1)
INSERT INTO [dbo].[MasterHolidayTypeDetail] ([MasterHolidayTypeId], [MasterHolidayTypeDetailId], [HolidayName], [HolidayMonth], [HolidayDay]) VALUES ('be529e49-927e-4cb9-b80d-9fb1c14d0f46', 'd9891e58-567e-4f0c-8935-fdf240cd30fa', N'Christmas Day', 12, 24)
INSERT INTO [dbo].[MasterHolidayTypeDetail] ([MasterHolidayTypeId], [MasterHolidayTypeDetailId], [HolidayName], [HolidayMonth], [HolidayDay]) VALUES ('be529e49-927e-4cb9-b80d-9fb1c14d0f46', 'ca9d6c58-7183-4bc6-84de-bf44a1582f16', N'Veterans Day', 11, 11)
INSERT INTO [dbo].[MasterHolidayTypeDetail] ([MasterHolidayTypeId], [MasterHolidayTypeDetailId], [HolidayName], [HolidayMonth], [HolidayDay]) VALUES ('be529e49-927e-4cb9-b80d-9fb1c14d0f46', '0daa9c63-d4e3-448d-b66d-35ae220e8332', N'New Years Day', 1, 1)
INSERT INTO [dbo].[MasterHolidayTypeDetail] ([MasterHolidayTypeId], [MasterHolidayTypeDetailId], [HolidayName], [HolidayMonth], [HolidayDay]) VALUES ('5e38ffd5-e894-4b27-9479-73bea0d8aa64', '126e3b69-7a80-4d25-b9a2-4bc67e5d6136', N'First Monday of August Civic Holiday', 8, 2)
INSERT INTO [dbo].[MasterHolidayTypeDetail] ([MasterHolidayTypeId], [MasterHolidayTypeDetailId], [HolidayName], [HolidayMonth], [HolidayDay]) VALUES ('5e38ffd5-e894-4b27-9479-73bea0d8aa64', 'e48ab875-3a61-4f9e-9250-54f9a705cd52', N'Labour Day', 9, 6)
INSERT INTO [dbo].[MasterHolidayTypeDetail] ([MasterHolidayTypeId], [MasterHolidayTypeDetailId], [HolidayName], [HolidayMonth], [HolidayDay]) VALUES ('5e38ffd5-e894-4b27-9479-73bea0d8aa64', '82b7ed80-90c3-4604-8289-66e27c3169dc', N'Thanksgiving Day', 10, 11)
INSERT INTO [dbo].[MasterHolidayTypeDetail] ([MasterHolidayTypeId], [MasterHolidayTypeDetailId], [HolidayName], [HolidayMonth], [HolidayDay]) VALUES ('be529e49-927e-4cb9-b80d-9fb1c14d0f46', 'd1930981-43de-4d16-95d0-8886ecc39c1f', N'Memorial Day', 5, 31)
INSERT INTO [dbo].[MasterHolidayTypeDetail] ([MasterHolidayTypeId], [MasterHolidayTypeDetailId], [HolidayName], [HolidayMonth], [HolidayDay]) VALUES ('be529e49-927e-4cb9-b80d-9fb1c14d0f46', 'b9ccfd90-05e9-4360-8f08-9523318bcac6', N'Labor Day', 9, 6)
INSERT INTO [dbo].[MasterHolidayTypeDetail] ([MasterHolidayTypeId], [MasterHolidayTypeDetailId], [HolidayName], [HolidayMonth], [HolidayDay]) VALUES ('5e38ffd5-e894-4b27-9479-73bea0d8aa64', 'eaffbb96-133c-4475-b1f8-1e2119627733', N'Victoria Day', 5, 24)
INSERT INTO [dbo].[MasterHolidayTypeDetail] ([MasterHolidayTypeId], [MasterHolidayTypeDetailId], [HolidayName], [HolidayMonth], [HolidayDay]) VALUES ('be529e49-927e-4cb9-b80d-9fb1c14d0f46', '66b6ffa0-28b3-47be-b931-dafe33bd7a1a', N'Thanksgiving Day', 11, 25)
INSERT INTO [dbo].[MasterHolidayTypeDetail] ([MasterHolidayTypeId], [MasterHolidayTypeDetailId], [HolidayName], [HolidayMonth], [HolidayDay]) VALUES ('5e38ffd5-e894-4b27-9479-73bea0d8aa64', 'd131f9a6-5b09-451a-a690-d7cf94e3f6c6', N'Boxing Day', 12, 26)
INSERT INTO [dbo].[MasterHolidayTypeDetail] ([MasterHolidayTypeId], [MasterHolidayTypeDetailId], [HolidayName], [HolidayMonth], [HolidayDay]) VALUES ('be529e49-927e-4cb9-b80d-9fb1c14d0f46', 'dd36c1aa-da53-4444-9e32-64deda972745', N'Washingtons Birthday', 2, 15)
INSERT INTO [dbo].[MasterHolidayTypeDetail] ([MasterHolidayTypeId], [MasterHolidayTypeDetailId], [HolidayName], [HolidayMonth], [HolidayDay]) VALUES ('5e38ffd5-e894-4b27-9479-73bea0d8aa64', '6eabe9b0-9214-4506-8503-7510b4812ea2', N'New Year''s Day', 1, 1)
INSERT INTO [dbo].[MasterHolidayTypeDetail] ([MasterHolidayTypeId], [MasterHolidayTypeDetailId], [HolidayName], [HolidayMonth], [HolidayDay]) VALUES ('5e38ffd5-e894-4b27-9479-73bea0d8aa64', 'a12f9cb6-0f01-4343-b6ec-066f264ae406', N'Good Friday', 4, 2)
INSERT INTO [dbo].[MasterHolidayTypeDetail] ([MasterHolidayTypeId], [MasterHolidayTypeDetailId], [HolidayName], [HolidayMonth], [HolidayDay]) VALUES ('be529e49-927e-4cb9-b80d-9fb1c14d0f46', '721c87b9-a539-497d-aab1-900976cc57ab', N'Independence Day', 7, 5)
INSERT INTO [dbo].[MasterHolidayTypeDetail] ([MasterHolidayTypeId], [MasterHolidayTypeDetailId], [HolidayName], [HolidayMonth], [HolidayDay]) VALUES ('5e38ffd5-e894-4b27-9479-73bea0d8aa64', '037c2cf3-440a-4cb8-b048-1b7ea761449f', N'Easter Monday', 4, 5)
INSERT INTO [dbo].[MasterHolidayTypeDetail] ([MasterHolidayTypeId], [MasterHolidayTypeDetailId], [HolidayName], [HolidayMonth], [HolidayDay]) VALUES ('dd58747d-ea78-4253-8b2f-2fe35065d4f3', 'c1dc1703-a35a-48f7-8435-0e3bacceb283', N'Good Friday', 4, 2)
INSERT INTO [dbo].[MasterHolidayTypeDetail] ([MasterHolidayTypeId], [MasterHolidayTypeDetailId], [HolidayName], [HolidayMonth], [HolidayDay]) VALUES ('dd58747d-ea78-4253-8b2f-2fe35065d4f3', '07a7373b-360a-4c98-8c4f-39ba57df2699', N'May Day Holiday', 5, 3)
INSERT INTO [dbo].[MasterHolidayTypeDetail] ([MasterHolidayTypeId], [MasterHolidayTypeDetailId], [HolidayName], [HolidayMonth], [HolidayDay]) VALUES ('dd58747d-ea78-4253-8b2f-2fe35065d4f3', '618ae376-b580-447e-a762-68815ec87a07', N'Summer Bank Holiday', 8, 30)
INSERT INTO [dbo].[MasterHolidayTypeDetail] ([MasterHolidayTypeId], [MasterHolidayTypeDetailId], [HolidayName], [HolidayMonth], [HolidayDay]) VALUES ('dd58747d-ea78-4253-8b2f-2fe35065d4f3', '4f1a747a-d154-40e8-8d03-750b19c6d8c6', N'Christmas Day', 12, 25)
INSERT INTO [dbo].[MasterHolidayTypeDetail] ([MasterHolidayTypeId], [MasterHolidayTypeDetailId], [HolidayName], [HolidayMonth], [HolidayDay]) VALUES ('dd58747d-ea78-4253-8b2f-2fe35065d4f3', '878f4c84-7a00-4fc2-b1da-3a9585218615', N'Spring Bank Holiday', 5, 31)
INSERT INTO [dbo].[MasterHolidayTypeDetail] ([MasterHolidayTypeId], [MasterHolidayTypeDetailId], [HolidayName], [HolidayMonth], [HolidayDay]) VALUES ('dd58747d-ea78-4253-8b2f-2fe35065d4f3', '836e918f-8e47-4dc5-93bd-2d8280fb3e72', N'Easter Monday', 4, 5)
INSERT INTO [dbo].[MasterHolidayTypeDetail] ([MasterHolidayTypeId], [MasterHolidayTypeDetailId], [HolidayName], [HolidayMonth], [HolidayDay]) VALUES ('dd58747d-ea78-4253-8b2f-2fe35065d4f3', 'acbc4fb0-76a0-4de5-9f17-b168ed38eeb8', N'Boxing Day', 12, 28)
INSERT INTO [dbo].[MasterHolidayTypeDetail] ([MasterHolidayTypeId], [MasterHolidayTypeDetailId], [HolidayName], [HolidayMonth], [HolidayDay]) VALUES ('dd58747d-ea78-4253-8b2f-2fe35065d4f3', '69ec49e3-e474-4277-be15-02b1fb8df579', N'New Years Day', 1, 1)
END

GO
-- Create Index IXX_AccountId on AccountHolidayType
Print 'Create Index IXX_AccountId on AccountHolidayType'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountHolidayType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountHolidayType]') AND name = N'IXX_AccountId'))
CREATE INDEX [IXX_AccountId]
	ON [dbo].[AccountHolidayType] ([AccountId])

GO
-- Create Foreign Key FK_AccountHolidayTypeDetail_AccountHolidayType on AccountHolidayTypeDetail
Print 'Create Foreign Key FK_AccountHolidayTypeDetail_AccountHolidayType on AccountHolidayTypeDetail'
GO
IF NOT EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_SCHEMA='dbo' AND CONSTRAINT_NAME='FK_AccountHolidayTypeDetail_AccountHolidayType' AND TABLE_NAME='AccountHolidayTypeDetail')
BEGIN
		ALTER TABLE [dbo].[AccountHolidayTypeDetail]
			ADD CONSTRAINT [FK_AccountHolidayTypeDetail_AccountHolidayType]
			FOREIGN KEY ([AccountHolidayTypeId]) REFERENCES [dbo].[AccountHolidayType] ([AccountHolidayTypeId])
			ON DELETE CASCADE
END
GO
-- Create View vueTimesheetAuditTrailForReport
Print 'Create View vueTimesheetAuditTrailForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueTimesheetAuditTrailForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueTimesheetAuditTrailForReport
AS
SELECT     dbo.Audit.Type, dbo.Audit.TableName, dbo.Audit.PK, dbo.Audit.FieldName AS AuditFieldName, dbo.Audit.OldValue AS AuditOldValue, 
                      dbo.Audit.NewValue AS AuditNewValue, dbo.Audit.UpdateDate, dbo.AccountProject.ProjectName, dbo.AccountProjectTask.TaskName, 
                      dbo.AccountEmployeeTimeEntry.TotalTime, 
                      CASE WHEN TableName = ''AccountEmployeeTimeEntryPeriod'' THEN AccountEmployeeTimeEntryPeriod.AccountEmployeeId WHEN TableName = ''AccountEmployeeTimeEntry''
                       THEN AccountEmployeeTimeEntry.AccountEmployeeId END AS AccountEmployeeId, 
                      CASE WHEN TableName = ''AccountEmployeeTimeEntryPeriod'' THEN AccountEmployeeTimeEntryPeriod.AccountId WHEN TableName = ''AccountEmployeeTimeEntry''
                       THEN AccountProject.AccountId END AS AccountId, 
                      CASE WHEN FieldName = ''AccountProjectId'' THEN AccountProjectOld.ProjectName WHEN FieldName = ''AccountProjecTasktId'' THEN AccountProjectTaskOld.TaskName
                       WHEN FieldName = ''AccountCostCenterId'' THEN AccountCostCenterOld.AccountCostCenter WHEN FieldName = ''AccountWorkTypeId'' THEN AccountWorkTypeOld.AccountWorkType
                       WHEN FieldName = ''SubmittedBy'' THEN AccountEmployeeOld.FirstName + '' '' + AccountEmployeeOld.LastName WHEN FieldName = ''ApprovedByEmployeeId''
                       THEN AccountEmployeeOld.FirstName + '' '' + AccountEmployeeOld.LastName WHEN FieldName = ''RejectedByEmployeeId'' THEN AccountEmployeeOld.FirstName
                       + '' '' + AccountEmployeeOld.LastName WHEN FieldName = ''Submitted'' THEN CASE WHEN Audit.OldValue <> ''1'' THEN ''No'' WHEN Audit.OldValue = ''1'' THEN
                       ''Yes'' END WHEN FieldName = ''Approved'' THEN CASE WHEN Audit.OldValue <> ''1'' THEN ''No'' WHEN Audit.OldValue = ''1'' THEN ''Yes'' END WHEN FieldName
                       = ''Rejected'' THEN CASE WHEN Audit.OldValue <> ''1'' THEN ''No'' WHEN Audit.OldValue = ''1'' THEN ''Yes'' END WHEN FieldName = ''StartTime'' THEN Replace(RIGHT(CONVERT(varchar,
                       Audit.OldValue, 109), 7), '' '', 0) WHEN FieldName = ''EndTime'' THEN Replace(RIGHT(CONVERT(varchar, Audit.OldValue, 109), 7), '' '', 0) 
                      WHEN FieldName = ''TotalTime'' THEN LEFT(CONVERT(varchar, CONVERT(datetime, Audit.OldValue), 8), 5) ELSE Audit.OldValue END AS OldValue, 
                      CASE WHEN FieldName = ''AccountProjectId'' THEN AccountProjectNew.ProjectName WHEN FieldName = ''AccountProjectTaskId'' THEN AccountProjectTaskNew.TaskName
                       WHEN FieldName = ''AccountCostCenterId'' THEN AccountCostCenterNew.AccountCostCenter WHEN FieldName = ''AccountWorkTypeId'' THEN AccountWorkTypeNew.AccountWorkType
                       WHEN FieldName = ''SubmittedBy'' THEN AccountEmployeeNew.FirstName + '' '' + AccountEmployeeNew.LastName WHEN FieldName = ''ApprovedByEmployeeId''
                       THEN AccountEmployeeNew.FirstName + '' '' + AccountEmployeeNew.LastName WHEN FieldName = ''RejectedByEmployeeId'' THEN AccountEmployeeNew.FirstName
                       + '' '' + AccountEmployeeNew.LastName WHEN FieldName = ''Submitted'' THEN CASE WHEN Audit.NewValue <> ''1'' THEN ''No'' WHEN Audit.NewValue = ''1''
                       THEN ''Yes'' END WHEN FieldName = ''Approved'' THEN CASE WHEN Audit.NewValue <> ''1'' THEN ''No'' WHEN Audit.NewValue = ''1'' THEN ''Yes'' END WHEN
                       FieldName = ''Rejected'' THEN CASE WHEN Audit.NewValue <> ''1'' THEN ''No'' WHEN Audit.NewValue = ''1'' THEN ''Yes'' END WHEN FieldName = ''StartTime''
                       THEN Replace(RIGHT(CONVERT(varchar, Audit.NewValue, 109), 7), '' '', 0) WHEN FieldName = ''EndTime'' THEN Replace(RIGHT(CONVERT(varchar, 
                      Audit.NewValue, 109), 7), '' '', 0) WHEN FieldName = ''TotalTime'' THEN LEFT(CONVERT(varchar, CONVERT(datetime, Audit.NewValue), 8), 5) 
                      ELSE Audit.NewValue END AS NewValue, 
                      CASE WHEN FieldName = ''AccountProjectId'' THEN ''Project Name'' WHEN FieldName = ''AccountProjectTaskId'' THEN ''Task Name'' WHEN FieldName = ''AccountCostCenterId''
                       THEN ''Cost Center'' WHEN FieldName = ''AccountWorkTypeId'' THEN ''Work Type'' WHEN FieldName = ''SubmittedBy'' THEN ''Submitted By'' WHEN FieldName
                       = ''ApprovedByEmployeeId'' THEN ''Approved By'' WHEN FieldName = ''RejectedByEmployeeId'' THEN ''Rejected By'' ELSE Audit.FieldName END AS FieldName,
                       CASE WHEN TableName = ''AccountEmployeeTimeEntryPeriod'' THEN CONVERT(varchar, AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, 106) 
                      + '' - '' + CONVERT(varchar, AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, 106) 
                      WHEN TableName = ''AccountEmployeeTimeEntry'' THEN CONVERT(varchar, AccountEmployeeTimeEntry.TimeEntryDate, 106) END AS Date, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS UserName
FROM         dbo.AccountProject AS AccountProjectNew RIGHT OUTER JOIN
                      dbo.AccountEmployeeTimeEntry LEFT OUTER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountProjectTask ON dbo.AccountEmployeeTimeEntry.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId RIGHT OUTER JOIN
                      dbo.AccountProjectTask AS AccountProjectTaskOld RIGHT OUTER JOIN
                      dbo.Audit LEFT OUTER JOIN
                      dbo.AccountEmployee ON dbo.Audit.UserName = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountCostCenter AS AccountCostCenterOld ON dbo.Audit.OldValue = CONVERT(nvarchar(50), AccountCostCenterOld.AccountCostCenterId) 
                      LEFT OUTER JOIN
                      dbo.AccountCostCenter AS AccountCostCenterNew ON dbo.Audit.NewValue = CONVERT(nvarchar(50), AccountCostCenterNew.AccountCostCenterId) 
                      LEFT OUTER JOIN
                      dbo.AccountWorkType AS AccountWorkTypeNew ON dbo.Audit.NewValue = CONVERT(nvarchar(50), AccountWorkTypeNew.AccountWorkTypeId) 
                      LEFT OUTER JOIN
                      dbo.AccountWorkType AS AccountWorkTypeOld ON dbo.Audit.OldValue = CONVERT(nvarchar(50), AccountWorkTypeOld.AccountWorkTypeId) 
                      LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployeeOld ON dbo.Audit.OldValue = CONVERT(nvarchar(50), AccountEmployeeOld.AccountEmployeeId) 
                      LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployeeNew ON dbo.Audit.NewValue = CONVERT(nvarchar(50), AccountEmployeeNew.AccountEmployeeId) 
                      LEFT OUTER JOIN
                      dbo.AccountProjectTask AS AccountProjectTaskNew ON dbo.Audit.NewValue = CONVERT(nvarchar(50), AccountProjectTaskNew.AccountProjectTaskId) 
                      ON CONVERT(nvarchar(50), AccountProjectTaskOld.AccountProjectTaskId) = dbo.Audit.OldValue ON CONVERT(nvarchar(50), 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId) = dbo.Audit.PK ON CONVERT(nvarchar(50), AccountProjectNew.AccountProjectId) 
                      = dbo.Audit.NewValue LEFT OUTER JOIN
                      dbo.AccountProject AS AccountProjectOld ON dbo.Audit.OldValue = CONVERT(nvarchar(50), AccountProjectOld.AccountProjectId) LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryPeriod ON dbo.Audit.PK = CONVERT(nvarchar(50), 
                      dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId)
WHERE     (dbo.Audit.TableName = ''AccountEmployeeTimeEntryPeriod '') AND (dbo.Audit.FieldName IN (''Submitted'', ''Approved'', ''Rejected'', ''SubmittedDate'', 
                      ''ApprovedOn'', ''RejectedOn'', ''SubmittedBy'', ''ApprovedByEmployeeId'', ''RejectedByEmployeeId'', ''PeriodDescription'')) OR
                      (dbo.Audit.TableName = ''AccountEmployeeTimeEntry'') AND (dbo.Audit.FieldName IN (''AccountProjectId'', ''AccountProjectTaskId'', ''AccountWorkTypeId'', 
                      ''AccountCostCenterId'', ''StartTime'', ''EndTime'', ''TotalTime'', ''Description''))'
GO
-- Create View vueAccountEmployeeExpenseSheetAuditForReport
Print 'Create View vueAccountEmployeeExpenseSheetAuditForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeExpenseSheetAuditForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeExpenseSheetAuditForReport
AS
SELECT     dbo.Audit.Type, dbo.Audit.TableName, dbo.Audit.PK, dbo.Audit.FieldName AS AuditFieldName, dbo.Audit.OldValue AS AuditOldVal, 
                      dbo.Audit.NewValue AS AuditNewVal, dbo.Audit.UpdateDate, dbo.Audit.UserName, AccountProject_1.ProjectName, 
                      AccountExpense_1.AccountExpenseName, dbo.AccountExpenseEntry.Amount, 
                      CASE WHEN TableName = ''AccountEmployeeExpenseSheet'' THEN AccountEmployeeExpenseSheet.AccountId WHEN TableName = ''AccountExpenseEntry''
                       THEN AccountExpenseEntry.AccountId END AS AccountId, 
                      CASE WHEN TableName = ''AccountEmployeeExpenseSheet'' THEN AccountEmployeeExpenseSheet.AccountEmployeeId WHEN TableName = ''AccountExpenseEntry''
                       THEN AccountExpenseEntry.AccountEmployeeId END AS AccountEmployeeId, 
                      CASE WHEN FieldName = ''AccountExpenseId'' THEN AccountExpense.AccountExpenseName WHEN FieldName = ''AccountProjectId'' THEN AccountProject.ProjectName
                       WHEN FieldName = ''AccountCurrencyId'' THEN vueAccountCurrency.CurrencyCode WHEN FieldName = ''AccountPaymentMethodId'' THEN AccountPaymentMethod.PaymentMethod
                       WHEN FieldName = ''AccountTaxZoneId'' THEN AccountTaxZone.AccountTaxZone WHEN FieldName = ''ApprovedByEmployeeId'' THEN AccountEmployee_2.FirstName
                       + '' '' + AccountEmployee_2.LastName WHEN FieldName = ''RejectedByEmployeeId'' THEN AccountEmployee_2.FirstName + '' '' + AccountEmployee_2.LastName
                       WHEN FieldName = ''Approved'' THEN CASE WHEN Audit.OldValue = ''1'' THEN ''Yes'' WHEN Audit.OldValue <> ''1'' THEN ''No'' END WHEN FieldName = ''Submitted''
                       THEN CASE WHEN Audit.OldValue = ''1'' THEN ''Yes'' WHEN Audit.OldValue <> ''1'' THEN ''No'' END WHEN FieldName = ''Rejected'' THEN CASE WHEN Audit.OldValue
                       = ''1'' THEN ''Yes'' WHEN Audit.OldValue <> ''1'' THEN ''No'' END WHEN FieldName = ''IsBillable'' THEN CASE WHEN Audit.OldValue = ''1'' THEN ''Yes'' WHEN
                       Audit.OldValue <> ''1'' THEN ''No'' END WHEN FieldName = ''Reimburse'' THEN CASE WHEN Audit.OldValue = ''1'' THEN ''Yes'' WHEN Audit.OldValue <> ''1'' THEN
                       ''No'' END WHEN FieldName = ''Amount'' THEN CONVERT(char(100), CONVERT(decimal(10, 2), Audit.OldValue)) 
                      WHEN FieldName = ''AmountBeforeTax'' THEN CONVERT(char(100), CONVERT(decimal(10, 2), Audit.OldValue)) 
                      WHEN FieldName = ''TaxAmount'' THEN CONVERT(char(100), CONVERT(decimal(10, 2), Audit.OldValue)) 
                      WHEN FieldName = ''Quantity'' THEN CONVERT(char(100), CONVERT(decimal(10, 2), Audit.OldValue)) 
                      WHEN FieldName = ''Rate'' THEN CONVERT(char(100), CONVERT(decimal(10, 2), Audit.OldValue)) ELSE Audit.OldValue END AS OldValue, 
                      CASE WHEN FieldName = ''AccountExpenseId '' THEN AccountExpense_2.AccountExpenseName WHEN FieldName = ''AccountProjectId'' THEN AccountProject_2.ProjectName
                       WHEN FieldName = ''AccountCurrencyId'' THEN vueAccountCurrency_1.CurrencyCode WHEN FieldName = ''AccountPaymentMethodId'' THEN AccountPaymentMethod_1.PaymentMethod
                       WHEN FieldName = ''AccountTaxZoneId'' THEN AccountTaxZone_1.AccountTaxZone WHEN FieldName = ''ApprovedByEmployeeId'' THEN AccountEmployee_1.FirstName
                       + '' '' + AccountEmployee_1.LastName WHEN FieldName = ''RejectedByEmployeeId'' THEN AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName
                       WHEN FieldName = ''SubmittedDate'' THEN CONVERT(nvarchar(16), Audit.NewValue, 112) 
                      WHEN FieldName = ''Approved'' THEN CASE WHEN Audit.NewValue = ''1'' THEN ''Yes'' WHEN Audit.NewValue <> ''1'' THEN ''No'' END WHEN FieldName = ''Submitted''
                       THEN CASE WHEN Audit.NewValue = ''1'' THEN ''Yes'' WHEN Audit.NewValue <> ''1'' THEN ''No'' END WHEN FieldName = ''Rejected'' THEN CASE WHEN Audit.NewValue
                       = ''1'' THEN ''Yes'' WHEN Audit.NewValue <> ''1'' THEN ''No'' END WHEN FieldName = ''IsBillable'' THEN CASE WHEN Audit.NewValue = ''1'' THEN ''Yes'' WHEN
                       Audit.NewValue <> ''1'' THEN ''No'' END WHEN FieldName = ''Reimburse'' THEN CASE WHEN Audit.NewValue = ''1'' THEN ''Yes'' WHEN Audit.NewValue <> ''1''
                       THEN ''No'' END WHEN FieldName = ''Amount'' THEN CONVERT(char(100), CONVERT(decimal(10, 2), Audit.NewValue)) 
                      WHEN FieldName = ''AmountBeforeTax'' THEN CONVERT(char(100), CONVERT(decimal(10, 2), Audit.NewValue)) 
                      WHEN FieldName = ''TaxAmount'' THEN CONVERT(char(100), CONVERT(decimal(10, 2), Audit.NewValue)) 
                      WHEN FieldName = ''Quantity'' THEN CONVERT(char(100), CONVERT(decimal(10, 2), Audit.NewValue)) 
                      WHEN FieldName = ''Rate'' THEN CONVERT(char(100), CONVERT(decimal(10, 2), Audit.NewValue)) ELSE Audit.NewValue END AS NewValue, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS UpdatedBy, 
                      CASE WHEN FieldName = ''ApprovedByEmployeeId'' THEN ''ApprovedBy'' WHEN FieldName = ''RejectedByEmployeeId'' THEN ''RejectedBy'' WHEN FieldName
                       = ''AccountProjectId'' THEN ''ProjectName'' WHEN FieldName = ''AccountExpenseId'' THEN ''ExpenseName'' WHEN FieldName = ''AccountPaymentMethodId''
                       THEN ''PaymentMethod'' WHEN FieldName = ''AccountCurrencyId'' THEN ''Currency'' WHEN FieldName = ''AccountTaxZoneId'' THEN ''TaxZone'' ELSE Audit.FieldName
                       END AS FieldName, 
                      CASE WHEN TableName = ''AccountEmployeeExpenseSheet'' THEN AccountEmployeeExpenseSheet.ExpenseSheetDate WHEN TableName = ''AccountExpenseEntry''
                       THEN AccountExpenseEntry.AccountExpenseEntryDate END AS Date
FROM         dbo.AccountEmployeeExpenseSheet RIGHT OUTER JOIN
                      dbo.AccountProject AS AccountProject_1 INNER JOIN
                      dbo.AccountExpenseEntry ON AccountProject_1.AccountProjectId = dbo.AccountExpenseEntry.AccountProjectId INNER JOIN
                      dbo.AccountExpense AS AccountExpense_1 ON 
                      dbo.AccountExpenseEntry.AccountExpenseId = AccountExpense_1.AccountExpenseId RIGHT OUTER JOIN
                      dbo.Audit INNER JOIN
                      dbo.AccountEmployee ON dbo.Audit.UserName = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_2 ON dbo.Audit.OldValue = CONVERT(nvarchar(50), AccountEmployee_2.AccountEmployeeId) 
                      LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON dbo.Audit.NewValue = CONVERT(nvarchar(50), AccountEmployee_1.AccountEmployeeId) 
                      LEFT OUTER JOIN
                      dbo.AccountTaxZone ON dbo.Audit.OldValue = CONVERT(nvarchar(50), dbo.AccountTaxZone.AccountTaxZoneId) LEFT OUTER JOIN
                      dbo.AccountTaxZone AS AccountTaxZone_1 ON dbo.Audit.NewValue = CONVERT(nvarchar(50), AccountTaxZone_1.AccountTaxZoneId) LEFT OUTER JOIN
                      dbo.AccountPaymentMethod ON dbo.Audit.OldValue = CONVERT(nvarchar(50), dbo.AccountPaymentMethod.AccountPaymentMethodId) 
                      LEFT OUTER JOIN
                      dbo.AccountPaymentMethod AS AccountPaymentMethod_1 ON dbo.Audit.NewValue = CONVERT(nvarchar(50), 
                      AccountPaymentMethod_1.AccountPaymentMethodId) LEFT OUTER JOIN
                      dbo.vueAccountCurrency AS vueAccountCurrency_1 ON dbo.Audit.NewValue = CONVERT(nvarchar(50), vueAccountCurrency_1.AccountCurrencyId) 
                      LEFT OUTER JOIN
                      dbo.vueAccountCurrency ON dbo.Audit.OldValue = CONVERT(nvarchar(50), dbo.vueAccountCurrency.AccountCurrencyId) LEFT OUTER JOIN
                      dbo.AccountProject ON dbo.Audit.OldValue = CONVERT(nvarchar(50), dbo.AccountProject.AccountProjectId) ON CONVERT(nvarchar(50), 
                      dbo.AccountExpenseEntry.AccountExpenseEntryId) = dbo.Audit.PK ON CONVERT(nvarchar(50), 
                      dbo.AccountEmployeeExpenseSheet.AccountEmployeeExpenseSheetId) = dbo.Audit.PK LEFT OUTER JOIN
                      dbo.AccountProject AS AccountProject_2 ON dbo.Audit.NewValue = CONVERT(nvarchar(50), AccountProject_2.AccountProjectId) LEFT OUTER JOIN
                      dbo.AccountExpense AS AccountExpense_2 ON dbo.Audit.NewValue = CONVERT(nvarchar(50), AccountExpense_2.AccountExpenseId) LEFT OUTER JOIN
                      dbo.AccountExpense ON dbo.Audit.OldValue = CONVERT(nvarchar(50), dbo.AccountExpense.AccountExpenseId)
WHERE     (dbo.Audit.TableName = ''AccountEmployeeExpenseSheet'' OR
                      dbo.Audit.TableName = ''AccountExpenseEntry'') AND (dbo.Audit.Type = ''U'') AND (dbo.Audit.FieldName IN (N''ExpenseSheetDate'', N''Description'', 
                      ''Submitted'', ''Approved'', ''Rejected'', ''SubmittedDate'', ''ApprovedOn'', ''ApprovedByEmployeeId'', ''RejectedByEmployeeId'', ''RejectedOn'', 
                      ''AccountExpenseEntryDate'', ''AccountProjectId'', ''AccountExpenseId'', ''Description'', ''Amount'', ''IsBillable'', ''Quantity'', ''Rate'', ''AmountBeforeTax'', 
                      ''TaxAmount'', ''Reimburse'', ''AccountCurrencyId'', ''AccountPaymentMethodId'', ''AccountTaxZoneId''))'
GO
-- Create View rptvueTimesheetAuditTrail
Print 'Create View rptvueTimesheetAuditTrail'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueTimesheetAuditTrail' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueTimesheetAuditTrail
AS
SELECT     dbo.vueTimesheetAuditTrailForReport.*
FROM         dbo.vueTimesheetAuditTrailForReport'
GO
-- Create View rptvueExpenseSheetAuditTrail
Print 'Create View rptvueExpenseSheetAuditTrail'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueExpenseSheetAuditTrail' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueExpenseSheetAuditTrail
AS
SELECT     Type, TableName, PK, FieldName, AuditOldVal, AuditNewVal, UpdateDate, UserName, ProjectName, AccountExpenseName, Amount, AccountId, 
                      AccountEmployeeId, OldValue, NewValue, UpdatedBy, AuditFieldName, Date
FROM         dbo.vueAccountEmployeeExpenseSheetAuditForReport'
GO
-- =======================================================
-- Foreign Key Constraint Nochecks's for Table: [dbo].[AccountReportDataSourceMapping]
-- =======================================================
Print ' Foreign Key Constraint Nochecks''s for Table: [dbo].[AccountReportDataSourceMapping]'

ALTER TABLE [dbo].[AccountReportDataSourceMapping] NOCHECK CONSTRAINT [FK_AccountReportDataSourceMapping_AccountReport]

-- =======================================================
-- Foreign Key Constraint Nochecks's for Table: [dbo].[AccountReportColumn]
-- =======================================================
Print ' Foreign Key Constraint Nochecks''s for Table: [dbo].[AccountReportColumn]'

ALTER TABLE [dbo].[AccountReportColumn] NOCHECK CONSTRAINT [FK_AccountReportColumn_AccountReport]

-- =======================================================
-- Synchronization Script for Table: [dbo].[AccountReport]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[AccountReport]'
IF NOT EXISTS (SELECT * FROM [dbo].[AccountReport] WHERE [AccountReportId] = '06c06f05-6120-49a7-bf56-0ee25177a559')
BEGIN
INSERT INTO [dbo].[AccountReport] ([AccountReportId], [AccountReportCategoryId], [ReportName], [ReportDescription], [ReportIconPath], [AccountId], [SystemReportTypeId], [SystemReportId], [IsConsolidated], [ReportPageName], [ReportOrder], [ShowCompanyLogo], [ReportTitle], [ReportHeader], [ReportFooter]) VALUES ('06c06f05-6120-49a7-bf56-0ee25177a559', 'da59cf62-9fd9-4754-880d-030615ca578d', N'Expense Sheet Audit Trail Report', N'Generate Expense Sheet Audit Trail Report', N'/Images/ExpenseSheetAuditTrailReport.gif', NULL, NULL, NULL, 0, NULL, 2, 0, N'Expense Sheet Audit Trail Report', NULL, NULL)
INSERT INTO [dbo].[AccountReport] ([AccountReportId], [AccountReportCategoryId], [ReportName], [ReportDescription], [ReportIconPath], [AccountId], [SystemReportTypeId], [SystemReportId], [IsConsolidated], [ReportPageName], [ReportOrder], [ShowCompanyLogo], [ReportTitle], [ReportHeader], [ReportFooter]) VALUES ('07487723-1aa2-4dcd-b7d0-61d3f26b483d', 'da59cf62-9fd9-4754-880d-030615ca578d', N'Timesheet Audit Trail Report', N'Generate Timesheet Audit Trail', N'/Images/TimesheetAuditTrailReport.gif', NULL, NULL, NULL, 0, NULL, 1, 0, N'Timesheet Audit Trail Report', NULL, NULL)
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[AccountReportCategory]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[AccountReportCategory]'
IF NOT EXISTS (SELECT * FROM [dbo].[AccountReportCategory] WHERE [AccountReportCategoryId] = 'da59cf62-9fd9-4754-880d-030615ca578d')
BEGIN
INSERT INTO [dbo].[AccountReportCategory] ([AccountReportCategoryId], [AccountReportCategory], [AccountId], [SequenceNo]) VALUES ('da59cf62-9fd9-4754-880d-030615ca578d', N'Audit Trail', NULL, 8)
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSource]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSource]'
IF NOT EXISTS (SELECT * FROM [dbo].[SystemReportDataSource] WHERE [SystemReportDataSourceId] = 'eb51cc06-118e-4d80-ae95-1e6d9ddc80b8')
BEGIN
INSERT INTO [dbo].[SystemReportDataSource] ([SystemReportDataSourceId], [ReportDataSourceName], [ReportDatasource], [ReportDataSourceType], [DefaultIconPath]) VALUES ('eb51cc06-118e-4d80-ae95-1e6d9ddc80b8', N'Timesheet Audit Trail', N'rptvueTimesheetAuditTrail', N'View', N'/Images/TimesheetAuditTrailReport.gif')
INSERT INTO [dbo].[SystemReportDataSource] ([SystemReportDataSourceId], [ReportDataSourceName], [ReportDatasource], [ReportDataSourceType], [DefaultIconPath]) VALUES ('75c3b467-f6e1-438c-a821-031917cb0730', N'Expense Sheet Audit Trail', N'rptvueExpenseSheetAuditTrail', N'View', N'/Images/ExpenseSheetAuditTrailReport.gif')
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'
IF NOT EXISTS (SELECT * FROM [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId] = 'c497150a-0ca1-4c03-9203-6852663e9044')
BEGIN
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('c497150a-0ca1-4c03-9203-6852663e9044', 'eb51cc06-118e-4d80-ae95-1e6d9ddc80b8', N'OldValue', 250, 1, NULL, NULL, 7, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Old Value', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('6b843b0b-63a4-448f-85c5-b46ba568f07f', 'eb51cc06-118e-4d80-ae95-1e6d9ddc80b8', N'FieldName', 175, 1, NULL, NULL, 6, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Field Name', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('5560580e-a4c3-4d6d-b886-7cb6df1664fc', '75c3b467-f6e1-438c-a821-031917cb0730', N'UpdatedBy', 150, 1, NULL, NULL, 9, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Updated By', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('0b362711-8c9d-4974-8f93-86f738f53946', 'eb51cc06-118e-4d80-ae95-1e6d9ddc80b8', N'NewValue', 250, 1, NULL, NULL, 8, '91402610-eef0-4dd0-aca3-0080f53389fa', N'New Value', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('bf8ed427-dc85-47d5-83ab-1bdad19f1e63', 'eb51cc06-118e-4d80-ae95-1e6d9ddc80b8', N'Date', 145, 1, NULL, NULL, 2, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Date', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('84b95764-5ac4-4a1b-8058-05a8d0fe3a72', 'eb51cc06-118e-4d80-ae95-1e6d9ddc80b8', N'TaskName', 250, 1, NULL, NULL, 4, '91402610-eef0-4dd0-aca3-0080f53389fa', N'TaskName', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('ac671578-ec8c-4123-a042-0e2f3bfd9107', '75c3b467-f6e1-438c-a821-031917cb0730', N'FieldName', 175, 1, NULL, NULL, 6, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Field Name', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('d7aaae80-fc69-4e5b-801b-488abcf1449a', '75c3b467-f6e1-438c-a821-031917cb0730', N'NewValue', 250, 1, NULL, NULL, 8, '91402610-eef0-4dd0-aca3-0080f53389fa', N'New Value', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('30c4a599-a755-42a5-a3b3-a36702447b5c', 'eb51cc06-118e-4d80-ae95-1e6d9ddc80b8', N'UpdateDate', 80, 1, NULL, NULL, 1, '48b9ef68-b4f6-4c75-b8de-c547939179ce', N'Updated Date', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('d92f769d-d244-4b0a-b2fd-ad786144378f', '75c3b467-f6e1-438c-a821-031917cb0730', N'ProjectName', 250, 1, NULL, NULL, 3, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Project Name', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('c8f3749f-aed4-4a1d-bae4-f171d5ae1ea7', 'eb51cc06-118e-4d80-ae95-1e6d9ddc80b8', N'ProjectName', 250, 1, NULL, NULL, 3, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Project Name', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('75f2a3a4-5d9b-48be-b1a9-e299d01b9de6', 'eb51cc06-118e-4d80-ae95-1e6d9ddc80b8', N'UpdatedBy', 175, 1, NULL, NULL, 9, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Updated By', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('a84275b5-ccb5-4c5c-9848-495b8d9479b5', '75c3b467-f6e1-438c-a821-031917cb0730', N'Date', 90, 1, NULL, NULL, 2, '48b9ef68-b4f6-4c75-b8de-c547939179ce', N'Date', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('c8db5dc4-20bc-47f2-9a76-d5e3ef8ea59b', '75c3b467-f6e1-438c-a821-031917cb0730', N'UpdateDate', 90, 1, NULL, NULL, 1, '48b9ef68-b4f6-4c75-b8de-c547939179ce', N'Updated Date', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('d0838dcb-d998-47c4-9bc2-34f45ec9bc69', '75c3b467-f6e1-438c-a821-031917cb0730', N'OldValue', 250, 1, NULL, NULL, 7, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Old Value', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('ec169ad2-89c7-4522-bafd-d5cca67f300a', '75c3b467-f6e1-438c-a821-031917cb0730', N'Amount', 110, 1, N'CurrencyCode', NULL, 5, '0da31ddc-9040-46fa-a33a-74e06a645050', N'Amount', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('66813cee-436a-4a71-8854-c6dfd7768000', '75c3b467-f6e1-438c-a821-031917cb0730', N'AccountExpenseName', 200, 1, NULL, NULL, 4, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Expense Name', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('d5b17ef8-b176-4156-94bb-03294a088a3d', 'eb51cc06-118e-4d80-ae95-1e6d9ddc80b8', N'TotalTime', 60, 1, NULL, NULL, 5, '4af62dd1-d310-48fc-ac2f-9694ee0bf323', N'Total Time', 0, 0)
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportFilterSourceMapping]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportFilterSourceMapping]'
IF NOT EXISTS (SELECT * FROM [dbo].[SystemReportFilterSourceMapping] WHERE [SystemReportFilterMappingId] = 'c7fb5e37-c983-4a93-8689-72bb0532977b')
BEGIN
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('c7fb5e37-c983-4a93-8689-72bb0532977b', '5a1515da-e197-49c1-83fc-b0d5a9a3034a', 'eb51cc06-118e-4d80-ae95-1e6d9ddc80b8', 1, 1, 2)
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('e4c259b5-fb1f-4a11-accd-9e0cc167dfec', '4f471b5b-2394-4379-a666-d696e2dfb0ef', 'eb51cc06-118e-4d80-ae95-1e6d9ddc80b8', 1, 1, 1)
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('4460e1c7-df94-4bde-aa09-d4abf32c79ee', '4f471b5b-2394-4379-a666-d696e2dfb0ef', '75c3b467-f6e1-438c-a821-031917cb0730', 1, 1, 1)
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('2ca300cf-3b7f-4da7-b45e-b34521d0ab6e', '5a1515da-e197-49c1-83fc-b0d5a9a3034a', '75c3b467-f6e1-438c-a821-031917cb0730', 1, 1, 2)
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportPermission]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportPermission]'
IF NOT EXISTS (SELECT * FROM [dbo].[SystemReportPermission] WHERE [SystemReportPermissionId] = '38be78ee-56c4-4115-a428-a1e96bbb3b8c')
BEGIN
INSERT INTO [dbo].[SystemReportPermission] ([SystemReportPermissionId], [AccountReportId], [MasterAccountRoleId], [ShowReport], [AllowCustomization], [AllowAllUser], [AllowOwnReport], [AllowOwnTeam], [AllowOwnProject], [AllowOwnSubOrdinates], [AllowOwnApproval]) VALUES ('38be78ee-56c4-4115-a428-a1e96bbb3b8c', '07487723-1aa2-4dcd-b7d0-61d3f26b483d', 1, 1, 1, 1, NULL, NULL, NULL, NULL, NULL)
INSERT INTO [dbo].[SystemReportPermission] ([SystemReportPermissionId], [AccountReportId], [MasterAccountRoleId], [ShowReport], [AllowCustomization], [AllowAllUser], [AllowOwnReport], [AllowOwnTeam], [AllowOwnProject], [AllowOwnSubOrdinates], [AllowOwnApproval]) VALUES ('3dabc90e-48d4-4746-822a-0f26e4abf216', '06c06f05-6120-49a7-bf56-0ee25177a559', 1, 1, 1, 1, NULL, NULL, NULL, NULL, NULL)
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[AccountReportColumn]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[AccountReportColumn]'
IF NOT EXISTS (SELECT * FROM [dbo].[AccountReportColumn] WHERE [AccountReportColumnId] = 'c07b3c02-41ff-41f3-a63f-8d89b8aa6760')
BEGIN
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('c07b3c02-41ff-41f3-a63f-8d89b8aa6760', '06c06f05-6120-49a7-bf56-0ee25177a559', N'Updated Date', 'c8db5dc4-20bc-47f2-9a76-d5e3ef8ea59b', 1, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('4470b01f-3c89-4f08-bf84-e2fd6d9a6880', '06c06f05-6120-49a7-bf56-0ee25177a559', N'Updated By', '5560580e-a4c3-4d6d-b886-7cb6df1664fc', 9, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('7813342d-ca23-4d39-aa7c-c9c8916e5732', '07487723-1aa2-4dcd-b7d0-61d3f26b483d', N'Project Name', 'c8f3749f-aed4-4a1d-bae4-f171d5ae1ea7', 3, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('3ad2c040-7b3f-472c-a35f-5807ae1d9556', '07487723-1aa2-4dcd-b7d0-61d3f26b483d', N'Updated Date', '30c4a599-a755-42a5-a3b3-a36702447b5c', 1, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('fa639545-143b-41c4-8b14-9599f789b96d', '06c06f05-6120-49a7-bf56-0ee25177a559', N'Date', 'a84275b5-ccb5-4c5c-9848-495b8d9479b5', 2, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('085b494d-8dfe-425d-805a-62bc3fed0395', '07487723-1aa2-4dcd-b7d0-61d3f26b483d', N'Task Name', '84b95764-5ac4-4a1b-8058-05a8d0fe3a72', 4, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('050d1654-c454-40b1-b72a-b9fef64fccd4', '07487723-1aa2-4dcd-b7d0-61d3f26b483d', N'Updated By', '75f2a3a4-5d9b-48be-b1a9-e299d01b9de6', 9, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('2668d859-7be1-4bea-b3a3-7e8df4322eaf', '07487723-1aa2-4dcd-b7d0-61d3f26b483d', N'Field Name', '6b843b0b-63a4-448f-85c5-b46ba568f07f', 6, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('93a3666c-ff2f-48fc-b58e-214cb7c54154', '07487723-1aa2-4dcd-b7d0-61d3f26b483d', N'Old Value', 'c497150a-0ca1-4c03-9203-6852663e9044', 7, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('22934670-ec20-46f5-9409-6249f9deaefd', '06c06f05-6120-49a7-bf56-0ee25177a559', N'Field Name', 'ac671578-ec8c-4123-a042-0e2f3bfd9107', 6, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('bca3c490-195b-4dcc-8ac7-ea155b029340', '07487723-1aa2-4dcd-b7d0-61d3f26b483d', N'Date', 'bf8ed427-dc85-47d5-83ab-1bdad19f1e63', 2, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('79ead194-3523-41bc-abd0-15d21c9dfbba', '06c06f05-6120-49a7-bf56-0ee25177a559', N'Amount', 'ec169ad2-89c7-4522-bafd-d5cca67f300a', 5, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('682bc6a6-3448-4a1e-aa55-383630d8bd14', '06c06f05-6120-49a7-bf56-0ee25177a559', N'Old Value', 'd0838dcb-d998-47c4-9bc2-34f45ec9bc69', 7, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('50288bc5-c70f-4abb-a5c1-dba3e4251e10', '07487723-1aa2-4dcd-b7d0-61d3f26b483d', N'Total Time', 'd5b17ef8-b176-4156-94bb-03294a088a3d', 5, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('f1e3fdce-c3da-45ec-8339-286a408cbdf9', '06c06f05-6120-49a7-bf56-0ee25177a559', N'Project Name', 'd92f769d-d244-4b0a-b2fd-ad786144378f', 3, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('4c04c2de-f78c-4226-9d5c-c33ece003d78', '06c06f05-6120-49a7-bf56-0ee25177a559', N'Expense Name', '66813cee-436a-4a71-8854-c6dfd7768000', 4, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('1181e1f0-eefe-4c57-b8a1-170a095cf624', '06c06f05-6120-49a7-bf56-0ee25177a559', N'New Value', 'd7aaae80-fc69-4e5b-801b-488abcf1449a', 8, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('8ba96af5-0acf-44f9-9a99-98afb04cc1be', '07487723-1aa2-4dcd-b7d0-61d3f26b483d', N'New Value', '0b362711-8c9d-4974-8f93-86f738f53946', 8, NULL, NULL)
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[AccountReportDataSourceMapping]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[AccountReportDataSourceMapping]'
IF NOT EXISTS (SELECT * FROM [dbo].[AccountReportDataSourceMapping] WHERE [AccountReportDataSourceMappingId] = 'a602311a-0e7b-4753-994a-0934a342dccd')
BEGIN
INSERT INTO [dbo].[AccountReportDataSourceMapping] ([AccountReportDataSourceMappingId], [AccountReportId], [SystemReportDataSourceId]) VALUES ('a602311a-0e7b-4753-994a-0934a342dccd', '07487723-1aa2-4dcd-b7d0-61d3f26b483d', 'eb51cc06-118e-4d80-ae95-1e6d9ddc80b8')
INSERT INTO [dbo].[AccountReportDataSourceMapping] ([AccountReportDataSourceMappingId], [AccountReportId], [SystemReportDataSourceId]) VALUES ('bab3f52e-bbc3-42a0-8867-bce79dcabee3', '06c06f05-6120-49a7-bf56-0ee25177a559', '75c3b467-f6e1-438c-a821-031917cb0730')
END
GO
-- =======================================================
-- Foreign Key Constraint Check's for Table: [dbo].[AccountReportColumn]
-- =======================================================
Print ' Foreign Key Constraint Check''s for Table: [dbo].[AccountReportColumn]'

ALTER TABLE [dbo].[AccountReportColumn] CHECK CONSTRAINT [FK_AccountReportColumn_AccountReport]

-- =======================================================
-- Foreign Key Constraint Check's for Table: [dbo].[AccountReportDataSourceMapping]
-- =======================================================
Print ' Foreign Key Constraint Check''s for Table: [dbo].[AccountReportDataSourceMapping]'

ALTER TABLE [dbo].[AccountReportDataSourceMapping] CHECK CONSTRAINT [FK_AccountReportDataSourceMapping_AccountReport]
GO
-- Drop View rptvueExpenseSheetAuditTrail
Print 'Drop View rptvueExpenseSheetAuditTrail'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueExpenseSheetAuditTrail' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueExpenseSheetAuditTrail]
GO
-- Drop View rptvueTimesheetAuditTrail
Print 'Drop View rptvueTimesheetAuditTrail'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueTimesheetAuditTrail' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueTimesheetAuditTrail]
GO
-- Drop View vueTimesheetAuditTrailForReport
Print 'Drop View vueTimesheetAuditTrailForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueTimesheetAuditTrailForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueTimesheetAuditTrailForReport]
GO
-- Create View vueAccountEmployeeTimeEntryPeriodAuditTrailForReport
Print 'Create View vueAccountEmployeeTimeEntryPeriodAuditTrailForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPeriodAuditTrailForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryPeriodAuditTrailForReport
AS
SELECT     dbo.Audit.Type, dbo.Audit.TableName, dbo.Audit.PK, dbo.Audit.FieldName AS AuditFieldName, dbo.Audit.OldValue AS AuditOldValue, 
                      dbo.Audit.NewValue AS AuditNewValue, dbo.Audit.UpdateDate, NULL AS AccountProjectId, NULL AS AccountProjectTaskId, NULL AS TotalTime, 
                      dbo.Audit.UserName, dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS UpdatedBy, 
                      dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeId, dbo.AccountEmployeeTimeEntryPeriod.AccountId, 
                      CASE WHEN FieldName = ''SubmittedBy'' THEN AccountEmployeeOld.FirstName + '' '' + AccountEmployeeOld.LastName WHEN FieldName = ''ApprovedByEmployeeId''
                       THEN AccountEmployeeOld.FirstName + '' '' + AccountEmployeeOld.LastName WHEN FieldName = ''RejectedByEmployeeId'' THEN AccountEmployeeOld.FirstName
                       + '' '' + AccountEmployeeOld.LastName WHEN FieldName = ''Submitted'' THEN CASE WHEN Audit.OldValue <> ''1'' THEN ''No'' WHEN Audit.OldValue = ''1'' THEN
                       ''Yes'' END WHEN FieldName = ''Approved'' THEN CASE WHEN Audit.OldValue <> ''1'' THEN ''No'' WHEN Audit.OldValue = ''1'' THEN ''Yes'' END WHEN FieldName
                       = ''Rejected'' THEN CASE WHEN Audit.OldValue <> ''1'' THEN ''No'' WHEN Audit.OldValue = ''1'' THEN ''Yes'' END ELSE Audit.OldValue END AS OldValue, 
                      CASE WHEN FieldName = ''SubmittedBy'' THEN AccountEmployeeNew.FirstName + '' '' + AccountEmployeeNew.LastName WHEN FieldName = ''ApprovedByEmployeeId''
                       THEN AccountEmployeeNew.FirstName + '' '' + AccountEmployeeNew.LastName WHEN FieldName = ''RejectedByEmployeeId'' THEN AccountEmployeeNew.FirstName
                       + '' '' + AccountEmployeeNew.LastName WHEN FieldName = ''Submitted'' THEN CASE WHEN Audit.NewValue <> ''1'' THEN ''No'' WHEN Audit.NewValue = ''1''
                       THEN ''Yes'' END WHEN FieldName = ''Approved'' THEN CASE WHEN Audit.NewValue <> ''1'' THEN ''No'' WHEN Audit.NewValue = ''1'' THEN ''Yes'' END WHEN
                       FieldName = ''Rejected'' THEN CASE WHEN Audit.NewValue <> ''1'' THEN ''No'' WHEN Audit.NewValue = ''1'' THEN ''Yes'' END ELSE Audit.NewValue END AS
                       NewValue, 
                      CASE WHEN FieldName = ''SubmittedBy'' THEN ''Submitted By'' WHEN FieldName = ''ApprovedByEmployeeId'' THEN ''Approved By'' WHEN FieldName = ''RejectedByEmployeeId''
                       THEN ''Rejected By'' ELSE Audit.FieldName END AS FieldName, CONVERT(varchar, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, 106) 
                      + '' - '' + CONVERT(varchar, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, 106) AS Date
FROM         dbo.AccountEmployeeTimeEntryPeriod RIGHT OUTER JOIN
                      dbo.Audit ON dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId = dbo.Audit.PK LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployeeOld ON dbo.Audit.OldValue = CONVERT(nvarchar(50), AccountEmployeeOld.AccountEmployeeId) 
                      LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployeeNew ON dbo.Audit.NewValue = CONVERT(nvarchar(50), AccountEmployeeNew.AccountEmployeeId) 
                      LEFT OUTER JOIN
                      dbo.AccountEmployee ON dbo.Audit.UserName = dbo.AccountEmployee.AccountEmployeeId
WHERE     (dbo.Audit.TableName = ''AccountEmployeeTimeEntryPeriod '') AND (dbo.Audit.FieldName IN (''Submitted'', ''Approved'', ''Rejected'', ''SubmittedDate'', 
                      ''ApprovedOn'', ''RejectedOn'', ''SubmittedBy'', ''ApprovedByEmployeeId'', ''RejectedByEmployeeId'', ''PeriodDescription''))'
GO
-- Create View vueAccountEmployeeTimeEntryAuditTrailForReport
Print 'Create View vueAccountEmployeeTimeEntryAuditTrailForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryAuditTrailForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryAuditTrailForReport
AS
SELECT     dbo.Audit.Type, dbo.Audit.TableName, dbo.Audit.PK, dbo.Audit.FieldName AS AuditFieldName, dbo.Audit.OldValue AS AuditOldValue, 
                      dbo.Audit.NewValue AS AuditNewValue, dbo.Audit.UpdateDate, dbo.AccountEmployeeTimeEntry.TotalTime, dbo.Audit.UserName, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS UpdatedBy, dbo.AccountEmployeeTimeEntry.AccountEmployeeId, 
                      dbo.AccountProject.AccountId, 
                      CASE WHEN FieldName = ''AccountProjectId'' THEN AccountProjectOld.ProjectName WHEN FieldName = ''AccountProjectTaskId'' THEN AccountProjectTaskOld.TaskName
                       WHEN FieldName = ''AccountCostCenterId'' THEN AccountCostCenterOld.AccountCostCenter WHEN FieldName = ''AccountWorkTypeId'' THEN AccountWorkTypeOld.AccountWorkType
                       WHEN FieldName = ''StartTime'' THEN Replace(RIGHT(CONVERT(varchar, Audit.OldValue, 109), 7), '' '', 0) 
                      WHEN FieldName = ''EndTime'' THEN Replace(RIGHT(CONVERT(varchar, Audit.OldValue, 109), 7), '' '', 0) 
                      WHEN FieldName = ''TotalTime'' THEN LEFT(CONVERT(varchar, CONVERT(datetime, Audit.OldValue), 8), 5) ELSE Audit.OldValue END AS OldValue, 
                      CASE WHEN FieldName = ''AccountProjectId'' THEN AccountProjectNew.ProjectName WHEN FieldName = ''AccountProjectTaskId'' THEN AccountProjectTaskNew.TaskName
                       WHEN FieldName = ''AccountCostCenterId'' THEN AccountCostCenterNew.AccountCostCenter WHEN FieldName = ''AccountWorkTypeId'' THEN AccountWorkTypeNew.AccountWorkType
                       WHEN FieldName = ''StartTime'' THEN Replace(RIGHT(CONVERT(varchar, Audit.NewValue, 109), 7), '' '', 0) 
                      WHEN FieldName = ''EndTime'' THEN Replace(RIGHT(CONVERT(varchar, Audit.NewValue, 109), 7), '' '', 0) 
                      WHEN FieldName = ''TotalTime'' THEN LEFT(CONVERT(varchar, CONVERT(datetime, Audit.NewValue), 8), 5) ELSE Audit.NewValue END AS NewValue, 
                      CASE WHEN FieldName = ''AccountProjectId'' THEN ''Project Name'' WHEN FieldName = ''AccountProjectTaskId'' THEN ''Task Name'' WHEN FieldName = ''AccountCostCenterId''
                       THEN ''Cost Center'' WHEN FieldName = ''AccountWorkTypeId'' THEN ''Work Type'' ELSE Audit.FieldName END AS FieldName, CONVERT(varchar, 
                      dbo.AccountEmployeeTimeEntry.TimeEntryDate, 106) AS Date, dbo.AccountEmployeeTimeEntry.AccountProjectId, 
                      dbo.AccountEmployeeTimeEntry.AccountProjectTaskId
FROM         dbo.Audit LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntry ON dbo.Audit.PK = dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId LEFT OUTER JOIN
                      dbo.AccountProject AS AccountProjectOld ON dbo.Audit.OldValue = CONVERT(nvarchar(50), AccountProjectOld.AccountProjectId) LEFT OUTER JOIN
                      dbo.AccountProject AS AccountProjectNew ON dbo.Audit.NewValue = CONVERT(nvarchar(50), AccountProjectNew.AccountProjectId) LEFT OUTER JOIN
                      dbo.AccountProjectTask AS AccountProjectTaskOld ON dbo.Audit.OldValue = CONVERT(nvarchar(50), AccountProjectTaskOld.AccountProjectTaskId) 
                      LEFT OUTER JOIN
                      dbo.AccountProjectTask AS AccountProjectTaskNew ON dbo.Audit.NewValue = CONVERT(nvarchar(50), AccountProjectTaskNew.AccountProjectTaskId) 
                      LEFT OUTER JOIN
                      dbo.AccountWorkType AS AccountWorkTypeOld ON dbo.Audit.OldValue = CONVERT(nvarchar(50), AccountWorkTypeOld.AccountWorkTypeId) 
                      LEFT OUTER JOIN
                      dbo.AccountWorkType AS AccountWorkTypeNew ON dbo.Audit.NewValue = CONVERT(nvarchar(50), AccountWorkTypeNew.AccountWorkTypeId) 
                      LEFT OUTER JOIN
                      dbo.AccountCostCenter AS AccountCostCenterOld ON dbo.Audit.OldValue = CONVERT(nvarchar(50), AccountCostCenterOld.AccountCostCenterId) 
                      LEFT OUTER JOIN
                      dbo.AccountCostCenter AS AccountCostCenterNew ON dbo.Audit.NewValue = CONVERT(nvarchar(50), AccountCostCenterNew.AccountCostCenterId) 
                      LEFT OUTER JOIN
                      dbo.AccountEmployee ON dbo.Audit.UserName = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId
WHERE     (dbo.Audit.TableName = ''AccountEmployeeTimeEntry'') AND (dbo.Audit.FieldName IN (''AccountProjectId'', ''AccountProjectTaskId'', ''AccountWorkTypeId'', 
                      ''AccountCostCenterId'', ''StartTime'', ''EndTime'', ''TotalTime'', ''Description''))'
GO
-- Create View vueAccountEmployeeExpenseSheetAuditTrailForReport
Print 'Create View vueAccountEmployeeExpenseSheetAuditTrailForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeExpenseSheetAuditTrailForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeExpenseSheetAuditTrailForReport
AS
SELECT     dbo.Audit.Type, dbo.Audit.TableName, dbo.Audit.PK, dbo.Audit.FieldName AS AuditFieldName, dbo.Audit.OldValue AS AuditOldVal, 
                      dbo.Audit.NewValue AS AuditNewVal, dbo.Audit.UpdateDate, dbo.Audit.UserName, 
                      CASE WHEN FieldName = ''ApprovedByEmployeeId'' THEN AccountEmployeeOld.FirstName + '' '' + AccountEmployeeOld.LastName WHEN FieldName = ''RejectedByEmployeeId''
                       THEN AccountEmployeeOld.FirstName + '' '' + AccountEmployeeOld.LastName WHEN FieldName = ''Approved'' THEN CASE WHEN Audit.OldValue = ''1'' THEN
                       ''Yes'' WHEN Audit.OldValue <> ''1'' THEN ''No'' END WHEN FieldName = ''Submitted'' THEN CASE WHEN Audit.OldValue = ''1'' THEN ''Yes'' WHEN Audit.OldValue
                       <> ''1'' THEN ''No'' END WHEN FieldName = ''Rejected'' THEN CASE WHEN Audit.OldValue = ''1'' THEN ''Yes'' WHEN Audit.OldValue <> ''1'' THEN ''No'' END ELSE
                       Audit.OldValue END AS OldValue, 
                      CASE WHEN FieldName = ''ApprovedByEmployeeId'' THEN AccountEmployeeNew.FirstName + '' '' + AccountEmployeeNew.LastName WHEN FieldName =
                       ''RejectedByEmployeeId'' THEN AccountEmployeeNew.FirstName + '' '' + AccountEmployeeNew.LastName WHEN FieldName = ''SubmittedDate'' THEN CONVERT(nvarchar(16),
                       Audit.NewValue, 112) 
                      WHEN FieldName = ''Approved'' THEN CASE WHEN Audit.NewValue = ''1'' THEN ''Yes'' WHEN Audit.NewValue <> ''1'' THEN ''No'' END WHEN FieldName = ''Submitted''
                       THEN CASE WHEN Audit.NewValue = ''1'' THEN ''Yes'' WHEN Audit.NewValue <> ''1'' THEN ''No'' END WHEN FieldName = ''Rejected'' THEN CASE WHEN Audit.NewValue
                       = ''1'' THEN ''Yes'' WHEN Audit.NewValue <> ''1'' THEN ''No'' END ELSE Audit.NewValue END AS NewValue, 
                      CASE WHEN FieldName = ''ApprovedByEmployeeId'' THEN ''ApprovedBy'' WHEN FieldName = ''RejectedByEmployeeId'' THEN ''RejectedBy'' ELSE Audit.FieldName
                       END AS FieldName, dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS UpdatedBy, 
                      dbo.AccountEmployeeExpenseSheet.AccountEmployeeId, dbo.AccountEmployeeExpenseSheet.AccountId, 
                      dbo.AccountEmployeeExpenseSheet.ExpenseSheetDate AS Date, NULL AS AccountProjectId, NULL AS AccountExpenseId, NULL AS Amount
FROM         dbo.Audit LEFT OUTER JOIN
                      dbo.AccountEmployeeExpenseSheet ON dbo.Audit.PK = dbo.AccountEmployeeExpenseSheet.AccountEmployeeExpenseSheetId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployeeOld ON dbo.Audit.OldValue = CONVERT(varchar, AccountEmployeeOld.AccountEmployeeId) 
                      LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployeeNew ON dbo.Audit.NewValue = CONVERT(varchar, AccountEmployeeNew.AccountEmployeeId) 
                      LEFT OUTER JOIN
                      dbo.AccountEmployee ON dbo.Audit.UserName = dbo.AccountEmployee.AccountEmployeeId
WHERE     (dbo.Audit.TableName = ''AccountEmployeeExpenseSheet'') AND (dbo.Audit.Type = ''U'') AND (dbo.Audit.FieldName IN (N''ExpenseSheetDate'', 
                      N''Description'', ''Submitted'', ''Approved'', ''Rejected'', ''SubmittedDate'', ''ApprovedOn'', ''ApprovedByEmployeeId'', ''RejectedByEmployeeId'', ''RejectedOn''))'
GO
-- Create View vueAccountExpenseEntryAuditTrailForReport
Print 'Create View vueAccountExpenseEntryAuditTrailForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryAuditTrailForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountExpenseEntryAuditTrailForReport
AS
SELECT     dbo.Audit.Type, dbo.Audit.TableName, dbo.Audit.PK, dbo.Audit.FieldName AS AuditFieldName, dbo.Audit.OldValue AS AuditOldVal, 
                      dbo.Audit.NewValue AS AuditNewVal, dbo.Audit.UpdateDate, dbo.Audit.UserName, 
                      CASE WHEN FieldName = ''AccountExpenseId'' THEN AccountExpenseOld.AccountExpenseName WHEN FieldName = ''AccountProjectId'' THEN AccountProjectOld.ProjectName
                       WHEN FieldName = ''AccountCurrencyId'' THEN vueAccountCurrencyOld.CurrencyCode WHEN FieldName = ''AccountPaymentMethodId'' THEN AccountPaymentMethodOld.PaymentMethod
                       WHEN FieldName = ''AccountTaxZoneId'' THEN AccountTaxZoneOld.AccountTaxZone WHEN FieldName = ''IsBillable'' THEN CASE WHEN Audit.OldValue
                       = ''1'' THEN ''Yes'' WHEN Audit.OldValue <> ''1'' THEN ''No'' END WHEN FieldName = ''Reimburse'' THEN CASE WHEN Audit.OldValue = ''1'' THEN ''Yes'' WHEN
                       Audit.OldValue <> ''1'' THEN ''No'' END WHEN FieldName = ''Amount'' THEN CONVERT(char(100), CONVERT(decimal(10, 2), Audit.OldValue)) 
                      WHEN FieldName = ''AmountBeforeTax'' THEN CONVERT(char(100), CONVERT(decimal(10, 2), Audit.OldValue)) 
                      WHEN FieldName = ''TaxAmount'' THEN CONVERT(char(100), CONVERT(decimal(10, 2), Audit.OldValue)) 
                      WHEN FieldName = ''Quantity'' THEN CONVERT(char(100), CONVERT(decimal(10, 2), Audit.OldValue)) 
                      WHEN FieldName = ''Rate'' THEN CONVERT(char(100), CONVERT(decimal(10, 2), Audit.OldValue)) ELSE Audit.OldValue END AS OldValue, 
                      CASE WHEN FieldName = ''AccountExpenseId '' THEN AccountExpenseNew.AccountExpenseName WHEN FieldName = ''AccountProjectId'' THEN AccountProjectNew.ProjectName
                       WHEN FieldName = ''AccountCurrencyId'' THEN vueAccountCurrencyNew.CurrencyCode WHEN FieldName = ''AccountPaymentMethodId'' THEN AccountPaymentMethodNew.PaymentMethod
                       WHEN FieldName = ''AccountTaxZoneId'' THEN AccountTaxZoneNew.AccountTaxZone WHEN FieldName = ''IsBillable'' THEN CASE WHEN Audit.NewValue
                       = ''1'' THEN ''Yes'' WHEN Audit.NewValue <> ''1'' THEN ''No'' END WHEN FieldName = ''Reimburse'' THEN CASE WHEN Audit.NewValue = ''1'' THEN ''Yes'' WHEN
                       Audit.NewValue <> ''1'' THEN ''No'' END WHEN FieldName = ''Amount'' THEN CONVERT(char(100), CONVERT(decimal(10, 2), Audit.NewValue)) 
                      WHEN FieldName = ''AmountBeforeTax'' THEN CONVERT(char(100), CONVERT(decimal(10, 2), Audit.NewValue)) 
                      WHEN FieldName = ''TaxAmount'' THEN CONVERT(char(100), CONVERT(decimal(10, 2), Audit.NewValue)) 
                      WHEN FieldName = ''Quantity'' THEN CONVERT(char(100), CONVERT(decimal(10, 2), Audit.NewValue)) 
                      WHEN FieldName = ''Rate'' THEN CONVERT(char(100), CONVERT(decimal(10, 2), Audit.NewValue)) ELSE Audit.NewValue END AS NewValue, 
                      CASE WHEN FieldName = ''AccountProjectId'' THEN ''ProjectName'' WHEN FieldName = ''AccountExpenseId'' THEN ''ExpenseName'' WHEN FieldName = ''AccountPaymentMethodId''
                       THEN ''PaymentMethod'' WHEN FieldName = ''AccountCurrencyId'' THEN ''Currency'' WHEN FieldName = ''AccountTaxZoneId'' THEN ''TaxZone'' ELSE Audit.FieldName
                       END AS FieldName, dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS UpdatedBy, 
                      dbo.AccountExpenseEntry.AccountEmployeeId, dbo.AccountExpenseEntry.AccountId, dbo.AccountExpenseEntry.AccountExpenseEntryDate AS Date, 
                      dbo.AccountExpenseEntry.AccountProjectId, dbo.AccountExpenseEntry.AccountExpenseId, dbo.AccountExpenseEntry.Amount
FROM         dbo.Audit LEFT OUTER JOIN
                      dbo.AccountExpenseEntry ON dbo.Audit.PK = dbo.AccountExpenseEntry.AccountExpenseEntryId LEFT OUTER JOIN
                      dbo.AccountProject AS AccountProjectOld ON dbo.Audit.OldValue = CONVERT(varchar, AccountProjectOld.AccountProjectId) LEFT OUTER JOIN
                      dbo.AccountProject AS AccountProjectNew ON dbo.Audit.NewValue = CONVERT(varchar, AccountProjectNew.AccountProjectId) LEFT OUTER JOIN
                      dbo.AccountExpense AS AccountExpenseOld ON dbo.Audit.OldValue = CONVERT(varchar, AccountExpenseOld.AccountExpenseId) LEFT OUTER JOIN
                      dbo.AccountExpense AS AccountExpenseNew ON dbo.Audit.NewValue = CONVERT(varchar, AccountExpenseNew.AccountExpenseId) LEFT OUTER JOIN
                      dbo.vueAccountCurrency AS vueAccountCurrencyOld ON dbo.Audit.OldValue = CONVERT(varchar, vueAccountCurrencyOld.AccountCurrencyId) 
                      LEFT OUTER JOIN
                      dbo.vueAccountCurrency AS vueAccountCurrencyNew ON dbo.Audit.NewValue = CONVERT(varchar, vueAccountCurrencyNew.AccountCurrencyId) 
                      LEFT OUTER JOIN
                      dbo.AccountTaxZone AS AccountTaxZoneOld ON dbo.Audit.OldValue = CONVERT(varchar, AccountTaxZoneOld.AccountTaxZoneId) LEFT OUTER JOIN
                      dbo.AccountTaxZone AS AccountTaxZoneNew ON dbo.Audit.NewValue = CONVERT(varchar, AccountTaxZoneNew.AccountTaxZoneId) LEFT OUTER JOIN
                      dbo.AccountPaymentMethod AS AccountPaymentMethodOld ON dbo.Audit.OldValue = CONVERT(varchar, 
                      AccountPaymentMethodOld.AccountPaymentMethodId) LEFT OUTER JOIN
                      dbo.AccountPaymentMethod AS AccountPaymentMethodNew ON dbo.Audit.NewValue = CONVERT(varchar, 
                      AccountPaymentMethodNew.AccountPaymentMethodId) LEFT OUTER JOIN
                      dbo.AccountEmployee ON dbo.Audit.UserName = dbo.AccountEmployee.AccountEmployeeId
WHERE     (dbo.Audit.TableName = ''AccountExpenseEntry'') AND (dbo.Audit.Type = ''U'') AND (dbo.Audit.FieldName IN (''AccountExpenseEntryDate'', 
                      ''AccountProjectId'', ''AccountExpenseId'', ''Description'', ''Amount'', ''IsBillable'', ''Quantity'', ''Rate'', ''AmountBeforeTax'', ''TaxAmount'', ''Reimburse'', 
                      ''AccountCurrencyId'', ''AccountPaymentMethodId'', ''AccountTaxZoneId''))'
GO
-- Create View vueAccountEmployeeTimeEnryAuditTrailUnionForReport
Print 'Create View vueAccountEmployeeTimeEnryAuditTrailUnionForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEnryAuditTrailUnionForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport
AS
SELECT     Type, TableName, PK, AuditFieldName, AuditOldValue, AuditNewValue, UpdateDate, TotalTime, UserName, UpdatedBy, AccountEmployeeId, AccountId, 
                      OldValue, NewValue, FieldName, Date, AccountProjectId, AccountProjectTaskId
FROM         dbo.vueAccountEmployeeTimeEntryAuditTrailForReport
UNION ALL
SELECT     Type, TableName, PK, AuditFieldName, AuditOldValue, AuditNewValue, UpdateDate, TotalTime, UserName, UpdatedBy, AccountEmployeeId, AccountId, 
                      OldValue, NewValue, FieldName, Date, AccountProjectId, AccountProjectTaskId
FROM         dbo.vueAccountEmployeeTimeEntryPeriodAuditTrailForReport'
GO
-- Create View vueExpenseSheetAuditTrailUnionForReport
Print 'Create View vueExpenseSheetAuditTrailUnionForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueExpenseSheetAuditTrailUnionForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueExpenseSheetAuditTrailUnionForReport
AS
SELECT     Type, TableName, PK, AuditFieldName, AuditOldVal, AuditNewVal, UpdateDate, UserName, OldValue, NewValue, FieldName, UpdatedBy, 
                      AccountEmployeeId, AccountId, Date, AccountProjectId, AccountExpenseId, Amount
FROM         dbo.vueAccountExpenseEntryAuditTrailForReport
UNION ALL
SELECT     Type, TableName, PK, AuditFieldName, AuditOldVal, AuditNewVal, UpdateDate, UserName, OldValue, NewValue, FieldName, UpdatedBy, 
                      AccountEmployeeId, AccountId, Date, AccountProjectId, AccountExpenseId, Amount
FROM         dbo.vueAccountEmployeeExpenseSheetAuditTrailForReport'
GO
-- Create View vueTimesheetAuditTrailForReport
Print 'Create View vueTimesheetAuditTrailForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueTimesheetAuditTrailForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueTimesheetAuditTrailForReport
AS
SELECT     dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport.Type, dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport.TableName, 
                      dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport.PK, dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport.AuditFieldName, 
                      dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport.AuditOldValue, 
                      dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport.AuditNewValue, CONVERT(DateTime, CONVERT(VARCHAR(10), 
                      dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport.UpdateDate, 120), 120) AS UpdateDate, 
                      dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport.TotalTime, dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport.UserName, 
                      dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport.UpdatedBy, 
                      dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport.AccountId, dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport.OldValue, 
                      dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport.NewValue, dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport.FieldName, 
                      dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport.Date, dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport.AccountProjectId, 
                      dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport.AccountProjectTaskId, dbo.AccountProject.ProjectName, 
                      dbo.AccountProjectTask.TaskName
FROM         dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport LEFT OUTER JOIN
                      dbo.AccountProjectTask ON 
                      dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId LEFT OUTER JOIN
                      dbo.AccountProject ON dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport.AccountProjectId = dbo.AccountProject.AccountProjectId'
GO
-- Create View vueExpenseSheetAuditTrailForReport
Print 'Create View vueExpenseSheetAuditTrailForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueExpenseSheetAuditTrailForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueExpenseSheetAuditTrailForReport
AS
SELECT     dbo.vueExpenseSheetAuditTrailUnionForReport.Type, dbo.vueExpenseSheetAuditTrailUnionForReport.TableName, 
                      dbo.vueExpenseSheetAuditTrailUnionForReport.PK, dbo.vueExpenseSheetAuditTrailUnionForReport.AuditFieldName, 
                      dbo.vueExpenseSheetAuditTrailUnionForReport.AuditOldVal, dbo.vueExpenseSheetAuditTrailUnionForReport.AuditNewVal, CONVERT(DateTime, 
                      CONVERT(VARCHAR(10), dbo.vueExpenseSheetAuditTrailUnionForReport.UpdateDate, 120), 120) AS UpdateDate, 
                      dbo.vueExpenseSheetAuditTrailUnionForReport.UserName, dbo.vueExpenseSheetAuditTrailUnionForReport.OldValue, 
                      dbo.vueExpenseSheetAuditTrailUnionForReport.NewValue, dbo.vueExpenseSheetAuditTrailUnionForReport.FieldName, 
                      dbo.vueExpenseSheetAuditTrailUnionForReport.UpdatedBy, dbo.vueExpenseSheetAuditTrailUnionForReport.AccountEmployeeId, 
                      dbo.vueExpenseSheetAuditTrailUnionForReport.AccountId, dbo.vueExpenseSheetAuditTrailUnionForReport.Date, 
                      dbo.vueExpenseSheetAuditTrailUnionForReport.AccountProjectId, dbo.vueExpenseSheetAuditTrailUnionForReport.AccountExpenseId, 
                      dbo.vueExpenseSheetAuditTrailUnionForReport.Amount, dbo.AccountExpense.AccountExpenseName, dbo.AccountProject.ProjectName
FROM         dbo.vueExpenseSheetAuditTrailUnionForReport LEFT OUTER JOIN
                      dbo.AccountExpense ON 
                      dbo.vueExpenseSheetAuditTrailUnionForReport.AccountExpenseId = dbo.AccountExpense.AccountExpenseId LEFT OUTER JOIN
                      dbo.AccountProject ON dbo.vueExpenseSheetAuditTrailUnionForReport.AccountProjectId = dbo.AccountProject.AccountProjectId'
GO
-- Create View rptvueTimesheetAuditTrail
Print 'Create View rptvueTimesheetAuditTrail'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueTimesheetAuditTrail' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueTimesheetAuditTrail
AS
SELECT     Type, TableName, PK, AuditFieldName, AuditOldValue, AuditNewValue, UpdateDate, TotalTime, UserName, UpdatedBy, AccountEmployeeId, AccountId, 
                      OldValue, NewValue, FieldName, Date, AccountProjectId, AccountProjectTaskId, ProjectName, TaskName
FROM         dbo.vueTimesheetAuditTrailForReport'
GO
-- Create View rptvueExpenseSheetAuditTrail
Print 'Create View rptvueExpenseSheetAuditTrail'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueExpenseSheetAuditTrail' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueExpenseSheetAuditTrail
AS
SELECT     Type, TableName, PK, AuditFieldName, AuditOldVal, AuditNewVal, UpdateDate, UserName, OldValue, NewValue, FieldName, UpdatedBy, 
                      AccountEmployeeId, AccountId, Date, AccountProjectId, AccountExpenseId, Amount, AccountExpenseName, ProjectName
FROM         dbo.vueExpenseSheetAuditTrailForReport'
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportFilterSourceMapping]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportFilterSourceMapping]'

UPDATE [dbo].[SystemReportFilterSourceMapping] SET [IsRequired]=0 WHERE [SystemReportFilterMappingId]='2ca300cf-3b7f-4da7-b45e-b34521d0ab6e'
UPDATE [dbo].[SystemReportFilterSourceMapping] SET [IsRequired]=0 WHERE [SystemReportFilterMappingId]='c7fb5e37-c983-4a93-8689-72bb0532977b'


GO
-- Drop View vueAccountEmployeeExpenseSheet
Print 'Drop View vueAccountEmployeeExpenseSheet'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeExpenseSheet' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeExpenseSheet]
GO
-- Drop View vueAccountExpenseEntryApprovalPending
Print 'Drop View vueAccountExpenseEntryApprovalPending'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryApprovalPending' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountExpenseEntryApprovalPending]
GO
-- Drop View vueAccountExpenseEntryApproval
Print 'Drop View vueAccountExpenseEntryApproval'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryApproval' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountExpenseEntryApproval]
GO
-- Create View vueAccountExpenseEntryApproval
Print 'Create View vueAccountExpenseEntryApproval'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryApproval' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountExpenseEntryApproval
AS
SELECT     dbo.AccountProject.AccountProjectId, dbo.AccountProject.LeaderEmployeeId, dbo.AccountProject.ProjectManagerEmployeeId, 
                      dbo.AccountApprovalType.ApprovalTypeName, dbo.AccountApprovalPath.AccountApprovalPathId, dbo.AccountApprovalPath.AccountApprovalTypeId, 
                      dbo.AccountApprovalPath.SystemApproverTypeId, dbo.AccountApprovalPath.AccountExternalUserId, dbo.AccountApprovalPath.AccountEmployeeId, 
                      dbo.AccountApprovalPath.ApprovalPathSequence, dbo.AccountExpenseEntry.AccountExpenseEntryId, 
                      dbo.AccountExpenseEntryApproval.ExpenseApprovalId, dbo.AccountExpenseEntryApproval.ExpenseApprovalPathId, dbo.AccountProject.ProjectName, 
                      dbo.AccountProject.ProjectDescription, dbo.AccountProject.ProjectCode, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountExpenseEntry.Approved, 
                      dbo.AccountProject.ExpenseApprovalTypeId, dbo.AccountExpenseEntry.AccountExpenseEntryDate, dbo.AccountExpenseEntryApproval.Comments, 
                      dbo.AccountExpenseEntryApproval.IsRejected, dbo.AccountExpenseEntryApproval.IsApproved, dbo.AccountExpenseEntry.Amount, 
                      dbo.AccountExpense.AccountExpenseName, dbo.AccountExpense.IsBillable, 
                      dbo.AccountExpenseEntry.AccountEmployeeId AS ExpenseEntryAccountEmployeeId, dbo.AccountExpenseEntry.Description, 
                      dbo.AccountExpenseEntry.AccountId, dbo.AccountEmployee.EMailAddress, dbo.AccountExpenseEntry.Submitted, 
                      dbo.AccountEmployee.EmployeeManagerId, dbo.SystemCurrency.CurrencyCode, dbo.AccountExpenseEntry.Rejected, 
                      dbo.AccountExpenseEntry.AccountEmployeeExpenseSheetId, dbo.AccountEmployeeExpenseSheet.Description AS MasterDescription, 
                      dbo.AccountEmployeeExpenseSheet.ExpenseSheetDate, dbo.AccountEmployeeExpenseSheet.SubmittedDate, 
                      dbo.AccountCurrencyExchangeRate.ExchangeRate
FROM         dbo.AccountCurrencyExchangeRate INNER JOIN
                      dbo.AccountCurrency INNER JOIN
                      dbo.SystemCurrency ON dbo.AccountCurrency.SystemCurrencyId = dbo.SystemCurrency.CurrencyId ON 
                      dbo.AccountCurrencyExchangeRate.AccountCurrencyExchangeRateId = dbo.AccountCurrency.AccountCurrencyExchangeRateId RIGHT OUTER JOIN
                      dbo.AccountEmployeeExpenseSheet LEFT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.AccountExpenseEntry ON dbo.AccountEmployee.AccountEmployeeId = dbo.AccountExpenseEntry.AccountEmployeeId ON 
                      dbo.AccountEmployeeExpenseSheet.AccountEmployeeExpenseSheetId = dbo.AccountExpenseEntry.AccountEmployeeExpenseSheetId ON 
                      dbo.AccountCurrency.AccountCurrencyId = dbo.AccountExpenseEntry.AccountCurrencyId LEFT OUTER JOIN
                      dbo.AccountExpense ON dbo.AccountExpenseEntry.AccountExpenseId = dbo.AccountExpense.AccountExpenseId LEFT OUTER JOIN
                      dbo.AccountProject INNER JOIN
                      dbo.AccountApprovalType ON dbo.AccountProject.ExpenseApprovalTypeId = dbo.AccountApprovalType.AccountApprovalTypeId INNER JOIN
                      dbo.AccountApprovalPath ON dbo.AccountApprovalType.AccountApprovalTypeId = dbo.AccountApprovalPath.AccountApprovalTypeId ON 
                      dbo.AccountExpenseEntry.AccountProjectId = dbo.AccountProject.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountExpenseEntryApproval ON 
                      dbo.AccountExpenseEntry.AccountExpenseEntryId = dbo.AccountExpenseEntryApproval.AccountExpenseEntryId AND 
                      dbo.AccountApprovalPath.AccountApprovalPathId = dbo.AccountExpenseEntryApproval.ExpenseApprovalPathId'
GO
-- Create View vueAccountExpenseEntryApprovalPending
Print 'Create View vueAccountExpenseEntryApprovalPending'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryApprovalPending' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountExpenseEntryApprovalPending
AS
SELECT     dbo.vueAccountExpenseEntryApproval.AccountProjectId, dbo.vueAccountExpenseEntryApproval.LeaderEmployeeId, 
                      dbo.vueAccountExpenseEntryApproval.ProjectManagerEmployeeId, dbo.vueAccountExpenseEntryApproval.ApprovalTypeName, 
                      dbo.vueAccountExpenseEntryApproval.AccountApprovalPathId, dbo.vueAccountExpenseEntryApproval.AccountApprovalTypeId, 
                      dbo.vueAccountExpenseEntryApproval.SystemApproverTypeId, dbo.vueAccountExpenseEntryApproval.AccountExternalUserId, 
                      dbo.vueAccountExpenseEntryApproval.AccountEmployeeId, dbo.vueAccountExpenseEntryApproval.ApprovalPathSequence, 
                      dbo.vueAccountExpenseEntryApproval.AccountExpenseEntryId, MAX(dbo.vueAccountExpenseEntryApproval.ExpenseApprovalId) 
                      AS ExpenseApprovalId, dbo.vueAccountExpenseEntryApproval.ExpenseApprovalPathId, dbo.vueAccountExpenseEntryApproval.ProjectName, 
                      dbo.vueAccountExpenseEntryApproval.ProjectDescription, dbo.vueAccountExpenseEntryApproval.ProjectCode, 
                      dbo.vueAccountExpenseEntryApproval.EmployeeName, dbo.vueAccountExpenseEntryApproval.Approved, 
                      dbo.vueAccountExpenseEntryApproval.ExpenseApprovalTypeId, dbo.vueAccountExpenseEntryApproval.AccountExpenseEntryDate, 
                      MAX(dbo.vueAccountExpenseEntryApproval.Comments) AS Comments, dbo.vueAccountExpenseEntryApproval.IsRejected, 
                      dbo.vueAccountExpenseEntryApproval.IsApproved, 
                      dbo.vueAccountExpenseEntryApproval.Amount / SUM(dbo.vueAccountExpenseEntryApproval.ExchangeRate) AS Amount, 
                      dbo.vueAccountExpenseEntryApproval.AccountExpenseName, dbo.vueAccountExpenseEntryApproval.IsBillable, 
                      dbo.vueAccountApproverType.MaxApprovalPathSequence, dbo.vueAccountExpenseEntryApproval.ExpenseEntryAccountEmployeeId, 
                      dbo.vueAccountExpenseEntryApproval.Description, dbo.vueAccountExpenseEntryApproval.AccountId, 
                      dbo.vueAccountExpenseEntryApproval.EMailAddress, dbo.vueAccountExpenseEntryApproval.Submitted, 
                      dbo.vueAccountExpenseEntryApproval.EmployeeManagerId, dbo.vueAccountExpenseEntryApproval.CurrencyCode, 
                      dbo.vueAccountExpenseEntryApproval.Rejected, dbo.vueAccountExpenseEntryApproval.AccountEmployeeExpenseSheetId, 
                      MAX(dbo.vueAccountExpenseEntryApproval.MasterDescription) AS MasterDescription, MAX(dbo.vueAccountExpenseEntryApproval.ExpenseSheetDate) 
                      AS ExpenseSheetDate, MAX(dbo.vueAccountCurrency.CurrencyCode) AS BaseCurrencyCode, MAX(dbo.vueAccountCurrency.Currency) 
                      AS BaseCurrency, MAX(dbo.vueAccountExpenseEntryApproval.SubmittedDate) AS SubmittedDate
FROM         dbo.vueAccountExpenseEntryApproval INNER JOIN
                      dbo.vueAccountApproverType ON 
                      dbo.vueAccountExpenseEntryApproval.AccountApprovalTypeId = dbo.vueAccountApproverType.AccountApprovalTypeId INNER JOIN
                      dbo.AccountPreferences ON dbo.vueAccountExpenseEntryApproval.AccountId = dbo.AccountPreferences.AccountId INNER JOIN
                      dbo.vueAccountCurrency ON dbo.AccountPreferences.AccountBaseCurrencyId = dbo.vueAccountCurrency.AccountCurrencyId
WHERE     (dbo.vueAccountExpenseEntryApproval.AccountApprovalPathId IN
                          (SELECT     TOP 1 AccountApprovalPathId
                            FROM          dbo.vueExpenseApprovalSequence AS vueExpenseApprovalSequence_1
                            WHERE      (ExpenseApprovalId IS NULL) AND (AccountExpenseEntryId = dbo.vueAccountExpenseEntryApproval.AccountExpenseEntryId))) AND 
                      (dbo.vueAccountExpenseEntryApproval.Approved = 0) AND (dbo.vueAccountExpenseEntryApproval.Submitted = 1) AND 
                      (dbo.vueAccountExpenseEntryApproval.Rejected IS NULL OR
                      dbo.vueAccountExpenseEntryApproval.Rejected = 0)
GROUP BY dbo.vueAccountExpenseEntryApproval.AccountProjectId, dbo.vueAccountExpenseEntryApproval.LeaderEmployeeId, 
                      dbo.vueAccountExpenseEntryApproval.ProjectManagerEmployeeId, dbo.vueAccountExpenseEntryApproval.ApprovalTypeName, 
                      dbo.vueAccountExpenseEntryApproval.AccountApprovalPathId, dbo.vueAccountExpenseEntryApproval.AccountApprovalTypeId, 
                      dbo.vueAccountExpenseEntryApproval.SystemApproverTypeId, dbo.vueAccountExpenseEntryApproval.AccountExternalUserId, 
                      dbo.vueAccountExpenseEntryApproval.AccountEmployeeId, dbo.vueAccountExpenseEntryApproval.ApprovalPathSequence, 
                      dbo.vueAccountExpenseEntryApproval.AccountExpenseEntryId, dbo.vueAccountExpenseEntryApproval.ExpenseApprovalPathId, 
                      dbo.vueAccountExpenseEntryApproval.ProjectName, dbo.vueAccountExpenseEntryApproval.ProjectDescription, 
                      dbo.vueAccountExpenseEntryApproval.ProjectCode, dbo.vueAccountExpenseEntryApproval.EmployeeName, 
                      dbo.vueAccountExpenseEntryApproval.Approved, dbo.vueAccountExpenseEntryApproval.ExpenseApprovalTypeId, 
                      dbo.vueAccountExpenseEntryApproval.AccountExpenseEntryDate, dbo.vueAccountExpenseEntryApproval.IsRejected, 
                      dbo.vueAccountExpenseEntryApproval.IsApproved, dbo.vueAccountExpenseEntryApproval.Amount, 
                      dbo.vueAccountExpenseEntryApproval.AccountExpenseName, dbo.vueAccountExpenseEntryApproval.IsBillable, 
                      dbo.vueAccountApproverType.MaxApprovalPathSequence, dbo.vueAccountExpenseEntryApproval.ExpenseEntryAccountEmployeeId, 
                      dbo.vueAccountExpenseEntryApproval.Description, dbo.vueAccountExpenseEntryApproval.AccountId, 
                      dbo.vueAccountExpenseEntryApproval.EMailAddress, dbo.vueAccountExpenseEntryApproval.Submitted, 
                      dbo.vueAccountExpenseEntryApproval.EmployeeManagerId, dbo.vueAccountExpenseEntryApproval.CurrencyCode, 
                      dbo.vueAccountExpenseEntryApproval.Rejected, dbo.vueAccountExpenseEntryApproval.AccountEmployeeExpenseSheetId'
GO
-- Create View vueAccountEmployeeExpenseSheet
Print 'Create View vueAccountEmployeeExpenseSheet'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeExpenseSheet' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeExpenseSheet
AS
SELECT     dbo.AccountEmployeeExpenseSheet.AccountEmployeeExpenseSheetId, dbo.AccountEmployeeExpenseSheet.AccountId, 
                      dbo.AccountEmployeeExpenseSheet.AccountEmployeeId, dbo.AccountEmployeeExpenseSheet.Description, 
                      dbo.AccountEmployeeExpenseSheet.ExpenseSheetDate, SUM(dbo.AccountExpenseEntry.Amount / dbo.AccountCurrencyExchangeRate.ExchangeRate) 
                      AS Amount, MAX(dbo.vueAccountCurrency.Currency) AS Currency, MAX(dbo.vueAccountCurrency.CurrencyCode) AS CurrencyCode, 
                      MAX(dbo.vueAccountCurrency.AccountCurrencyId) AS AccountCurrencyId, CASE WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 0 AND dbo.AccountEmployeeExpenseSheet.Rejected = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.InApproval = 0 THEN ''Not Submitted'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Rejected = 0 THEN ''Approved'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.Rejected = 1 THEN ''Rejected'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 0 AND dbo.AccountEmployeeExpenseSheet.Rejected = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.InApproval = 1 THEN ''Submitted'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 0 AND dbo.AccountEmployeeExpenseSheet.Rejected = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.InApproval = 0 THEN ''Submitted'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 1 THEN ''Not Submitted'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.InApproval = 1 THEN ''Not Submitted'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 1 AND dbo.AccountEmployeeExpenseSheet.Rejected = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.InApproval = 1 THEN ''Approved'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Rejected = 1 THEN ''Submitted'' END AS Status, dbo.AccountEmployeeExpenseSheet.InApproval, 
                      dbo.AccountEmployeeExpenseSheet.Submitted, dbo.AccountEmployeeExpenseSheet.Rejected, dbo.AccountEmployeeExpenseSheet.Approved, 
                      dbo.AccountEmployeeExpenseSheet.SubmittedDate, dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, 
                      dbo.AccountEmployee.EMailAddress, MAX(dbo.vueAccountCurrency.ExchangeRate) AS ExchangeRate, 
                      dbo.AccountEmployeeExpenseSheet.ApprovedOn, dbo.AccountEmployeeExpenseSheet.ApprovedByEmployeeId, 
                      dbo.AccountEmployeeExpenseSheet.RejectedOn, dbo.AccountEmployeeExpenseSheet.RejectedByEmployeeId
FROM         dbo.AccountExpenseEntry INNER JOIN
                      dbo.AccountCurrency ON dbo.AccountExpenseEntry.AccountCurrencyId = dbo.AccountCurrency.AccountCurrencyId INNER JOIN
                      dbo.AccountCurrencyExchangeRate ON 
                      dbo.AccountCurrency.AccountCurrencyExchangeRateId = dbo.AccountCurrencyExchangeRate.AccountCurrencyExchangeRateId RIGHT OUTER JOIN
                      dbo.AccountEmployeeExpenseSheet INNER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployeeExpenseSheet.AccountId = dbo.AccountPreferences.AccountId INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeExpenseSheet.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId ON 
                      dbo.AccountExpenseEntry.AccountEmployeeExpenseSheetId = dbo.AccountEmployeeExpenseSheet.AccountEmployeeExpenseSheetId LEFT OUTER JOIN
                      dbo.vueAccountCurrency ON dbo.AccountPreferences.AccountBaseCurrencyId = dbo.vueAccountCurrency.AccountCurrencyId
GROUP BY dbo.AccountEmployeeExpenseSheet.AccountEmployeeExpenseSheetId, dbo.AccountEmployeeExpenseSheet.AccountId, 
                      dbo.AccountEmployeeExpenseSheet.AccountEmployeeId, dbo.AccountEmployeeExpenseSheet.Description, 
                      dbo.AccountEmployeeExpenseSheet.ExpenseSheetDate, dbo.AccountEmployeeExpenseSheet.InApproval, 
                      dbo.AccountEmployeeExpenseSheet.Submitted, dbo.AccountEmployeeExpenseSheet.Rejected, dbo.AccountEmployeeExpenseSheet.Approved, 
                      dbo.AccountEmployeeExpenseSheet.SubmittedDate, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, 
                      dbo.AccountEmployee.EMailAddress, dbo.AccountEmployeeExpenseSheet.ApprovedOn, dbo.AccountEmployeeExpenseSheet.ApprovedByEmployeeId, 
                      dbo.AccountEmployeeExpenseSheet.RejectedOn, dbo.AccountEmployeeExpenseSheet.RejectedByEmployeeId'

GO
-- Drop View vueAccountEmployeeTimeEntryForReport
Print 'Drop View vueAccountEmployeeTimeEntryForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryForReport]

GO
-- Drop View rptvueAccountEmployeeTimeEntry
Print 'Drop View rptvueAccountEmployeeTimeEntry'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeEntry' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountEmployeeTimeEntry]

GO
-- Drop View vueAccountEmployeeTimeEntryPeriodForReport
Print 'Drop View vueAccountEmployeeTimeEntryPeriodForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPeriodForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryPeriodForReport]

GO
-- Drop View rptvueAccountEmployeeTimeEntryPeriod
Print 'Drop View rptvueAccountEmployeeTimeEntryPeriod'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeEntryPeriod' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountEmployeeTimeEntryPeriod]

GO
-- Create View vueAccountEmployeeTimeEntryForReport
Print 'Create View vueAccountEmployeeTimeEntryForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryForReport
AS
SELECT     dbo.vueAccountEmployeeTimeEntry.EmployeeName, dbo.vueAccountEmployeeTimeEntry.ProjectName, dbo.vueAccountEmployeeTimeEntry.TaskName, 
                      dbo.vueAccountEmployeeTimeEntry.TotalTime, dbo.vueAccountEmployeeTimeEntry.Approved, dbo.vueAccountEmployeeTimeEntry.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntry.AccountProjectId, dbo.vueAccountEmployeeTimeEntry.TeamLeadApproved, 
                      dbo.vueAccountEmployeeTimeEntry.ProjectManagerApproved, dbo.vueAccountEmployeeTimeEntry.AdministratorApproved, 
                      dbo.vueAccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, dbo.vueAccountEmployeeTimeEntry.StartTime, dbo.vueAccountEmployeeTimeEntry.EndTime, 
                      dbo.vueAccountEmployeeTimeEntry.TimeEntryDate, ISNULL(dbo.vueAccountEmployeeTimeEntry.Description, N'''') AS Description, 
                      dbo.vueAccountEmployeeTimeEntry.AccountId, dbo.vueAccountEmployeeTimeEntry.TotalMinutes, dbo.vueAccountEmployeeTimeEntry.WeekDay, 
                      dbo.vueAccountEmployeeTimeEntry.AccountPartyId AS AccountClientId, dbo.vueAccountEmployeeTimeEntry.PartyName AS ClientName, 
                      dbo.vueAccountEmployeeTimeEntry.AccountProjectTaskId, ISNULL(dbo.vueAccountEmployeeTimeEntry.BillingType, N'''') AS BillingType, 
                      dbo.vueAccountEmployeeTimeEntry.LeaderEmployeeId, dbo.vueAccountEmployeeTimeEntry.ProjectManagerEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntry.TimeSheetApprovalTypeId, dbo.vueAccountEmployeeTimeEntry.ExpenseApprovalTypeId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntry.IsBillable, 0) AS IsBillable, ISNULL(dbo.vueAccountEmployeeTimeEntry.Rejected, 0) AS Rejected, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntry.BillingRate, 0) AS BillingRate, dbo.vueAccountEmployeeTimeEntry.ProjectBillingRateTypeId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntry.EmployeeCode, N'''') AS EmployeeCode, dbo.vueAccountEmployeeTimeEntry.AccountDepartmentId, 
                      dbo.vueAccountEmployeeTimeEntry.DepartmentName, ISNULL(dbo.vueAccountEmployeeTimeEntry.EstimatedCost, 0) AS EstimatedCost, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntry.EstimatedTimeSpent, 0) AS EstimatedHours, ISNULL(dbo.vueAccountEmployeeTimeEntry.Submitted, 0) AS Submitted, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntry.AccountWorkType, N'''') AS AccountWorkType, dbo.vueAccountEmployeeTimeEntry.EMailAddress, 
                      dbo.vueAccountEmployeeTimeEntry.AccountLocation, ISNULL(dbo.vueAccountEmployeeTimeEntry.AccountCostCenter, N'''') AS AccountCostCenter, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntry.AccountCostCenterCode, N'''') AS AccountCostCenterCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntry.AccountWorkTypeCode, N'''') AS AccountWorkTypeCode, ISNULL(dbo.vueAccountEmployeeTimeEntry.ProjectCode, N'''') 
                      AS ProjectCode, ISNULL(dbo.vueAccountEmployeeTimeEntry.TaskCode, N'''') AS TaskCode, dbo.vueAccountEmployeeTimeEntry.AccountLocationId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntry.Comments, N'''') AS ApproverComments, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntry.TotalMinutes * dbo.vueAccountEmployeeTimeEntry.BillingRate / 60, 0) AS Amount, 
                      dbo.vueAccountEmployeeTimeEntry.BillingRateCurrencyId, dbo.vueAccountEmployeeTimeEntry.EmployeeRateCurrencyId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntry.BillingRateExchangeRate, 0) AS BillingRateExchangeRate, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntry.EmployeeRateExchangeRate, 0) AS EmployeeRateExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntry.AccountBaseCurrencyId, dbo.vueAccountCurrency.CurrencyCode AS BillingRateCurrencyCode, 
                      dbo.vueAccountCurrency.CurrencyCode AS AmountCurrencyCode, dbo.vueAccountEmployeeTimeEntry.AccountTaskTypeId, 
                      dbo.vueAccountEmployeeTimeEntry.TaskStatusId, dbo.vueAccountEmployeeTimeEntry.AccountPriorityId, 
                      dbo.vueAccountEmployeeTimeEntry.AccountProjectMilestoneId, dbo.AccountTaskType.TaskType, dbo.AccountStatus.Status AS TaskStatus, 
                      dbo.AccountProjectMilestone.MilestoneDescription, dbo.AccountPriority.Priority, ROUND(CONVERT(float, dbo.vueAccountEmployeeTimeEntry.TotalMinutes) / 60, 2) 
                      AS TotalHours, ISNULL(dbo.vueAccountEmployeeTimeEntry.DepartmentCode, N'''') AS DepartmentCode, ISNULL(dbo.vueAccountEmployeeTimeEntry.PartyNick, N'''') 
                      AS ClientNick, dbo.vueAccountEmployeeTimeEntry.EstimatedCurrencyId, vueAccountCurrency_1.CurrencyCode AS EstimatedCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntry.ApprovedOn, ISNULL(dbo.vueAccountEmployeeTimeEntry.EmployeeRate, 0) AS EmployeeRate, 
                      vueAccountCurrency_2.CurrencyCode AS EmployeeRateCurrencyCode, AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName AS TeamLeader, 
                      AccountEmployee_2.FirstName + '' '' + AccountEmployee_2.LastName AS ProjectManager, 
                      ISNULL(dbo.AccountEmployee.FirstName + N'' '' + dbo.AccountEmployee.LastName, N'''') AS EmployeeManager, 
                      vueAccountCurrency_1.ExchangeRate AS EstimatedCurrencyExchangeRate, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntry.TotalMinutes * dbo.vueAccountEmployeeTimeEntry.EmployeeRate / 60, 0) AS EmployeeCost, 
                      { fn DAYOFMONTH(dbo.vueAccountEmployeeTimeEntry.TimeEntryDate) } AS DayNo, MONTH(dbo.vueAccountEmployeeTimeEntry.TimeEntryDate) AS MonthNo, 
                      DATEPART(week, dbo.vueAccountEmployeeTimeEntry.TimeEntryDate) - DATEPART(week, DATEADD(month, DATEDIFF(month, 0, 
                      dbo.vueAccountEmployeeTimeEntry.TimeEntryDate), 0)) + 1 AS WeekNo, YEAR(dbo.vueAccountEmployeeTimeEntry.TimeEntryDate) AS Year, 
                      LEFT({ fn MONTHNAME(dbo.vueAccountEmployeeTimeEntry.TimeEntryDate) }, 3) + '' - '' + CONVERT(nvarchar(10), 
                      YEAR(dbo.vueAccountEmployeeTimeEntry.TimeEntryDate)) AS Period, { fn DAYNAME(dbo.vueAccountEmployeeTimeEntry.TimeEntryDate) } AS WeekDayName, 
                      dbo.vueAccountEmployeeTimeEntry.AccountRoleId, dbo.vueAccountEmployeeTimeEntry.Role, dbo.AccountProjectType.ProjectType, 
                      dbo.AccountRole.Role AS ProjectRole, ISNULL(dbo.vueAccountEmployeeTimeEntry.ProjectDescription, N'''') AS ProjectDescription, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntry.TaskDescription, N'''') AS TaskDescription, dbo.AccountTimeExpenseBilling.InvoiceNumber, 
                      dbo.AccountTimeExpenseBilling.InvoiceDate, dbo.AccountProjectType.AccountProjectTypeId, dbo.vueAccountEmployeeTimeEntry.Billed, 
                      dbo.vueAccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId, ISNULL(dbo.vueAccountEmployeeTimeEntry.ClientContactName, N'''') AS ClientContactName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntry.ClientDepartmentCode, N'''') AS ClientDepartmentCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntry.ClientDepartmentName, N'''') AS ClientDepartmentName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntry.ClientDepartmentLocation, N'''') AS ClientDepartmentLocation
FROM         dbo.AccountRole INNER JOIN
                      dbo.AccountProjectEmployee ON dbo.AccountRole.AccountRoleId = dbo.AccountProjectEmployee.AccountRoleId RIGHT OUTER JOIN
                      dbo.AccountTimeExpenseBillingTimesheet INNER JOIN
                      dbo.AccountTimeExpenseBilling ON 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingId = dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId RIGHT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntry INNER JOIN
                      dbo.AccountTaskType ON dbo.vueAccountEmployeeTimeEntry.AccountTaskTypeId = dbo.AccountTaskType.AccountTaskTypeId INNER JOIN
                      dbo.AccountStatus ON dbo.vueAccountEmployeeTimeEntry.TaskStatusId = dbo.AccountStatus.AccountStatusId INNER JOIN
                      dbo.AccountProjectMilestone ON dbo.vueAccountEmployeeTimeEntry.AccountProjectMilestoneId = dbo.AccountProjectMilestone.AccountProjectMilestoneId INNER JOIN
                      dbo.AccountPriority ON dbo.vueAccountEmployeeTimeEntry.AccountPriorityId = dbo.AccountPriority.AccountPriorityId INNER JOIN
                      dbo.AccountProjectType ON dbo.vueAccountEmployeeTimeEntry.AccountProjectTypeId = dbo.AccountProjectType.AccountProjectTypeId ON 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingTimesheetId = dbo.vueAccountEmployeeTimeEntry.AccountTimeExpenseBillingTimesheetId ON 
                      dbo.AccountProjectEmployee.AccountEmployeeId = dbo.vueAccountEmployeeTimeEntry.AccountEmployeeId AND 
                      dbo.AccountProjectEmployee.AccountProjectId = dbo.vueAccountEmployeeTimeEntry.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON dbo.vueAccountEmployeeTimeEntry.LeaderEmployeeId = AccountEmployee_1.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_2 ON 
                      dbo.vueAccountEmployeeTimeEntry.ProjectManagerEmployeeId = AccountEmployee_2.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.AccountEmployee AS AccountEmployee_3 ON dbo.AccountEmployee.AccountEmployeeId = AccountEmployee_3.EmployeeManagerId ON 
                      dbo.vueAccountEmployeeTimeEntry.AccountEmployeeId = AccountEmployee_3.AccountEmployeeId LEFT OUTER JOIN
                      dbo.vueAccountCurrency AS vueAccountCurrency_2 ON 
                      dbo.vueAccountEmployeeTimeEntry.EmployeeRateCurrencyId = vueAccountCurrency_2.AccountCurrencyId LEFT OUTER JOIN
                      dbo.vueAccountCurrency AS vueAccountCurrency_1 ON 
                      dbo.vueAccountEmployeeTimeEntry.EstimatedCurrencyId = vueAccountCurrency_1.AccountCurrencyId LEFT OUTER JOIN
                      dbo.vueAccountCurrency ON dbo.vueAccountEmployeeTimeEntry.BillingRateCurrencyId = dbo.vueAccountCurrency.AccountCurrencyId'

GO
-- Create View rptvueAccountEmployeeTimeEntry
Print 'Create View rptvueAccountEmployeeTimeEntry'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeEntry' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountEmployeeTimeEntry
AS
SELECT     dbo.vueAccountEmployeeTimeEntryForReport.EmployeeName, dbo.vueAccountEmployeeTimeEntryForReport.ProjectName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskName, dbo.vueAccountEmployeeTimeEntryForReport.TotalTime, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Approved, dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectId, dbo.vueAccountEmployeeTimeEntryForReport.TeamLeadApproved, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManagerApproved, dbo.vueAccountEmployeeTimeEntryForReport.AdministratorApproved, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeTimeEntryId, dbo.vueAccountEmployeeTimeEntryForReport.StartTime, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EndTime, dbo.vueAccountEmployeeTimeEntryForReport.TimeEntryDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Description, dbo.vueAccountEmployeeTimeEntryForReport.AccountId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TotalMinutes, dbo.vueAccountEmployeeTimeEntryForReport.WeekDay, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientName, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectTaskId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingType, dbo.vueAccountEmployeeTimeEntryForReport.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManagerEmployeeId, dbo.vueAccountEmployeeTimeEntryForReport.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ExpenseApprovalTypeId, dbo.vueAccountEmployeeTimeEntryForReport.IsBillable, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Rejected, dbo.vueAccountEmployeeTimeEntryForReport.BillingRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectBillingRateTypeId, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountDepartmentId, dbo.vueAccountEmployeeTimeEntryForReport.DepartmentName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCost, dbo.vueAccountEmployeeTimeEntryForReport.EstimatedHours, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Submitted, dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkType, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EMailAddress, dbo.vueAccountEmployeeTimeEntryForReport.AccountLocation, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountCostCenter, dbo.vueAccountEmployeeTimeEntryForReport.AccountCostCenterCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkTypeCode, dbo.vueAccountEmployeeTimeEntryForReport.ProjectCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCode, dbo.vueAccountEmployeeTimeEntryForReport.AccountLocationId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ApproverComments, dbo.vueAccountEmployeeTimeEntryForReport.Amount, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingRateCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountBaseCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.BillingRateCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AmountCurrencyCode, CASE WHEN vueAccountEmployeeTimeEntryForReport.Submitted = 1 AND 
                      vueAccountEmployeeTimeEntryForReport.Approved = 0 THEN ''Submitted'' WHEN vueAccountEmployeeTimeEntryForReport.Approved = 1 THEN ''Approved'' WHEN vueAccountEmployeeTimeEntryForReport.Rejected
                       = 1 THEN ''Rejected'' WHEN vueAccountEmployeeTimeEntryForReport.Submitted = 0 AND vueAccountEmployeeTimeEntryForReport.Approved = 0 AND 
                      vueAccountEmployeeTimeEntryForReport.Rejected = 0 THEN ''Not Submitted'' END AS ApprovalStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountTaskTypeId, dbo.vueAccountEmployeeTimeEntryForReport.TaskStatusId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountPriorityId, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectMilestoneId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskType, dbo.vueAccountEmployeeTimeEntryForReport.TaskStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.MilestoneDescription, dbo.vueAccountEmployeeTimeEntryForReport.Priority, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TotalHours, dbo.vueAccountEmployeeTimeEntryForReport.DepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientNick, dbo.vueAccountEmployeeTimeEntryForReport.AccountClientId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ApprovedOn, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateCurrencyCode, dbo.vueAccountEmployeeTimeEntryForReport.TeamLeader, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManager, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeManager, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate, 0) AS EstimatedCurrencyExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCost, dbo.vueAccountEmployeeTimeEntryForReport.AccountRoleId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Role, dbo.vueAccountEmployeeTimeEntryForReport.WeekDayName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Period, dbo.vueAccountEmployeeTimeEntryForReport.Year, dbo.vueAccountEmployeeTimeEntryForReport.WeekNo, 
                      dbo.vueAccountEmployeeTimeEntryForReport.MonthNo, dbo.vueAccountEmployeeTimeEntryForReport.DayNo, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 1 THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours ELSE 0 END AS BillableTotalHours,
                       CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable
                       IS NULL THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours ELSE 0 END AS NonBillableTotalHours, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCost / dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate
                       ELSE 0 END AS CurrencyEmployeeCost, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.Amount / dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate
                       ELSE 0 END AS CurrencyAmount, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCost / dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate
                       ELSE 0 END AS CurrencyEstimatedCost, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate / dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate
                       ELSE 0 END AS CurrencyBillingRate, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRate / dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate
                       ELSE 0 END AS CurrencyEmployeeRate, dbo.vueAccountEmployeeTimeEntryForReport.ProjectRole, dbo.vueAccountEmployeeTimeEntryForReport.ProjectType, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectDescription, dbo.vueAccountEmployeeTimeEntryForReport.TaskDescription, 
                      dbo.vueAccountEmployeeTimeEntryForReport.InvoiceNumber, dbo.vueAccountEmployeeTimeEntryForReport.InvoiceDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectTypeId, dbo.vueAccountEmployeeTimeEntryForReport.Billed, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientContactName, dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentName, dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentLocation
FROM         dbo.vueAccountEmployeeTimeEntryForReport INNER JOIN
                      dbo.vueAccountEmployeeTimeEntryWithLastStatus ON 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryWithLastStatus.AccountEmployeeTimeEntryId'

GO
-- Create View vueAccountEmployeeTimeEntryPeriodForReport
Print 'Create View vueAccountEmployeeTimeEntryPeriodForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPeriodForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryPeriodForReport
AS
SELECT     dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId, dbo.AccountEmployeeTimeEntryPeriod.AccountId, 
                      dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeId, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, 
                      dbo.AccountEmployeeTimeEntryPeriod.Submitted, dbo.AccountEmployeeTimeEntryPeriod.Approved, dbo.AccountEmployeeTimeEntryPeriod.Rejected, 
                      dbo.AccountEmployeeTimeEntryPeriod.InApproval, dbo.AccountEmployeeTimeEntryPeriod.SubmittedDate, dbo.vueAccountEmployee.EmployeeName, 
                      dbo.vueAccountEmployee.AccountLocationId, dbo.vueAccountEmployee.AccountDepartmentId, dbo.vueAccountEmployee.AccountLocation, 
                      dbo.vueAccountEmployee.Role, dbo.vueAccountEmployee.DepartmentName, dbo.vueAccountEmployee.EMailAddress, dbo.vueAccountEmployee.AccountRoleId, 
                      CASE WHEN AccountEmployeeTimeEntryPeriod.Submitted = 1 AND 
                      AccountEmployeeTimeEntryPeriod.Approved = 0 THEN ''Submitted'' WHEN AccountEmployeeTimeEntryPeriod.Approved = 1 THEN ''Approved'' WHEN AccountEmployeeTimeEntryPeriod.Rejected
                       = 1 THEN ''Rejected'' WHEN AccountEmployeeTimeEntryPeriod.Submitted = 0 AND AccountEmployeeTimeEntryPeriod.Approved = 0 AND 
                      AccountEmployeeTimeEntryPeriod.Rejected = 0 THEN ''Not Submitted'' END AS ApprovalStatus, 
                      { fn DAYOFMONTH(dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate) } AS DayNo, MONTH(dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate) 
                      AS MonthNo, DATEPART(week, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate) - DATEPART(week, DATEADD(month, DATEDIFF(month, 0, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate), 0)) + 1 AS WeekNo, YEAR(dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate) AS Year, 
                      LEFT({ fn MONTHNAME(dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate) }, 3) + '' - '' + CONVERT(nvarchar(10), 
                      YEAR(dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate)) AS Period, { fn DAYNAME(dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate) 
                      } AS WeekDayName, SUM(ROUND(CONVERT(float, dbo.vueAccountEmployeeTimeEntry.TotalMinutes) / 60, 2)) AS TotalHours, 
                      SUM(ISNULL(dbo.vueAccountEmployeeTimeEntry.TotalMinutes * dbo.vueAccountEmployeeTimeEntry.BillingRate / 60, 0)) AS Amount, 
                      SUM(ISNULL(dbo.vueAccountEmployeeTimeEntry.BillingRate, 0)) AS BillingRate, SUM(ISNULL(dbo.vueAccountEmployeeTimeEntry.SubmittedHours, 0)) 
                      AS SubmittedHours, SUM(ISNULL(dbo.vueAccountEmployeeTimeEntry.ApprovedHours, 0)) AS ApprovedHours, 
                      SUM(ISNULL(dbo.vueAccountEmployeeTimeEntry.RejectedHours, 0)) AS RejectedHours, ISNULL(dbo.vueAccountEmployee.EmployeeCode, '''') AS EmployeeCode, 
                      SUM(ISNULL(dbo.vueAccountEmployeeTimeEntry.BillingRateExchangeRate, 0)) AS BillingRateExchangeRate, dbo.AccountEmployeeTimeEntryPeriod.ApprovedOn, 
                      dbo.AccountEmployeeTimeEntryPeriod.RejectedOn, dbo.AccountEmployeeTimeEntryPeriod.ApprovedByEmployeeId, 
                      dbo.AccountEmployeeTimeEntryPeriod.RejectedByEmployeeId, ISNULL(dbo.vueAccountEmployeeTimeEntry.ClientContactName, N'''') AS ClientContactName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntry.ClientDepartmentCode, N'''') AS ClientDepartmentCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntry.ClientDepartmentName, N'''') AS ClientDepartmentName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntry.ClientDepartmentLocation, N'''') AS ClientDepartmentLocation
FROM         dbo.AccountEmployeeTimeEntryPeriod INNER JOIN
                      dbo.vueAccountEmployee ON dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeId = dbo.vueAccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntry ON 
                      dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId = dbo.vueAccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId
GROUP BY dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId, dbo.AccountEmployeeTimeEntryPeriod.AccountId, 
                      dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeId, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, 
                      dbo.AccountEmployeeTimeEntryPeriod.Submitted, dbo.AccountEmployeeTimeEntryPeriod.Approved, dbo.AccountEmployeeTimeEntryPeriod.Rejected, 
                      dbo.AccountEmployeeTimeEntryPeriod.InApproval, dbo.AccountEmployeeTimeEntryPeriod.SubmittedDate, dbo.vueAccountEmployee.EmployeeName, 
                      dbo.vueAccountEmployee.AccountLocationId, dbo.vueAccountEmployee.AccountDepartmentId, dbo.vueAccountEmployee.AccountLocation, 
                      dbo.vueAccountEmployee.Role, dbo.vueAccountEmployee.DepartmentName, dbo.vueAccountEmployee.EMailAddress, dbo.vueAccountEmployee.AccountRoleId, 
                      dbo.vueAccountEmployee.EmployeeCode, dbo.AccountEmployeeTimeEntryPeriod.ApprovedOn, dbo.AccountEmployeeTimeEntryPeriod.RejectedOn, 
                      dbo.AccountEmployeeTimeEntryPeriod.ApprovedByEmployeeId, dbo.AccountEmployeeTimeEntryPeriod.RejectedByEmployeeId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntry.ClientContactName, N''''), ISNULL(dbo.vueAccountEmployeeTimeEntry.ClientDepartmentCode, N''''), 
                      ISNULL(dbo.vueAccountEmployeeTimeEntry.ClientDepartmentName, N''''), ISNULL(dbo.vueAccountEmployeeTimeEntry.ClientDepartmentLocation, N'''')'

GO
-- Create View rptvueAccountEmployeeTimeEntryPeriod
Print 'Create View rptvueAccountEmployeeTimeEntryPeriod'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeEntryPeriod' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountEmployeeTimeEntryPeriod
AS
SELECT     dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountEmployeeTimeEntryPeriodId, dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountId, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountEmployeeId, dbo.vueAccountEmployeeTimeEntryPeriodForReport.TimeEntryStartDate, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.TimeEntryEndDate, dbo.vueAccountEmployeeTimeEntryPeriodForReport.TimeEntryViewType, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.Submitted, dbo.vueAccountEmployeeTimeEntryPeriodForReport.Approved, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.Rejected, dbo.vueAccountEmployeeTimeEntryPeriodForReport.InApproval, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.SubmittedDate, dbo.vueAccountEmployeeTimeEntryPeriodForReport.EmployeeName, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountLocationId, dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountDepartmentId, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountLocation, dbo.vueAccountEmployeeTimeEntryPeriodForReport.Role, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.DepartmentName, dbo.vueAccountEmployeeTimeEntryPeriodForReport.EMailAddress, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountRoleId, dbo.vueAccountEmployeeTimeEntryPeriodForReport.ApprovalStatus, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.DayNo, dbo.vueAccountEmployeeTimeEntryPeriodForReport.MonthNo, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.WeekNo, dbo.vueAccountEmployeeTimeEntryPeriodForReport.Year, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.Period, dbo.vueAccountEmployeeTimeEntryPeriodForReport.WeekDayName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryPeriodForReport.TotalHours, 0) AS TotalHours, dbo.vueAccountEmployeeTimeEntryPeriodForReport.Amount, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.BillingRate, dbo.vueAccountEmployeeTimeEntryPeriodForReport.SubmittedHours, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.ApprovedHours, dbo.vueAccountEmployeeTimeEntryPeriodForReport.RejectedHours, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.EmployeeCode, 
                      CASE WHEN BillingRateExchangeRate > 0 THEN Amount / BillingRateExchangeRate ELSE 0 END AS CurrencyAmount, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryPeriodForReport.Approved = 1 THEN dbo.vueAccountEmployeeTimeEntryPeriodForReport.ApprovedOn ELSE NULL 
                      END AS ApprovedDate, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryPeriodForReport.Rejected = 1 THEN dbo.vueAccountEmployeeTimeEntryPeriodForReport.RejectedOn ELSE NULL 
                      END AS RejectedDate, AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName AS ApprovedByEmployeeName, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS RejectedByEmployeeName, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.ClientContactName, dbo.vueAccountEmployeeTimeEntryPeriodForReport.ClientDepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.ClientDepartmentName, dbo.vueAccountEmployeeTimeEntryPeriodForReport.ClientDepartmentLocation
FROM         dbo.vueAccountEmployeeTimeEntryPeriodForReport LEFT OUTER JOIN
                      dbo.AccountEmployee ON dbo.vueAccountEmployeeTimeEntryPeriodForReport.RejectedByEmployeeId = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.ApprovedByEmployeeId = AccountEmployee_1.AccountEmployeeId'

GO

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'
IF NOT EXISTS (SELECT * FROM [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId] = '1d685d0d-417b-4024-94f4-8805d46baf70')
BEGIN
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('1d685d0d-417b-4024-94f4-8805d46baf70', '3a080202-6842-4eca-8c79-a945978810b4', N'ClientDepartmentName', 250, 0, NULL, NULL, 64, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Client Department Name', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('34438525-1208-45aa-98a3-3b6560e59b82', '18966956-9937-4da0-a6f3-465e6066d433', N'ClientContactName', 250, 0, NULL, NULL, 32, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Client Contact Name', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('d862b53d-387b-4fe0-b89d-175565b64856', '18966956-9937-4da0-a6f3-465e6066d433', N'ClientDepartmentCode', 150, 0, NULL, NULL, 29, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Client Department Code', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('6c2b6965-8acc-477f-844d-de1324564018', '3a080202-6842-4eca-8c79-a945978810b4', N'ClientDepartmentLocation', 250, 0, NULL, NULL, 65, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Client Department Location', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('3f6731b6-1892-42d6-9250-abd764b77a91', '18966956-9937-4da0-a6f3-465e6066d433', N'ClientDepartmentLocation', 250, 0, NULL, NULL, 31, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Client Department Location', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('21123dca-3245-4f23-a17a-bb1ed0278bee', '3a080202-6842-4eca-8c79-a945978810b4', N'ClientDepartmentCode', 150, 0, NULL, NULL, 63, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Client Department Code', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('507c4ee9-ce9a-4d10-93b0-27de8c0e4223', '18966956-9937-4da0-a6f3-465e6066d433', N'ClientDepartmentName', 250, 0, NULL, NULL, 30, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Client Department Name', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('7ac012f0-1890-4451-a13f-eedd82534b1b', '3a080202-6842-4eca-8c79-a945978810b4', N'ClientContactName', 250, 0, NULL, NULL, 62, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Client Contact Name', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('b7140b5e-1bfc-4abc-b7fe-73b57479c837', '1e657f0a-881b-4f50-839a-c3a962c9a460', N'AccountProjectTaskId', 75, 0, NULL, NULL, 32, 'be1ea264-d750-43b6-85c0-a5b8467f8024', N'Task Id', 0, 0)
END
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'

UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=61 WHERE [SystemReportDataSourceFieldId]='ca7cbd0b-b3ce-419c-81f7-9502b68c74f8'
UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=60 WHERE [SystemReportDataSourceFieldId]='a2ba3c2f-5ecf-4261-bfa4-e4478d6788b3'
UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=57 WHERE [SystemReportDataSourceFieldId]='4e8c5e41-5e1f-4761-a223-f54f9e74b575'
UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=35 WHERE [SystemReportDataSourceFieldId]='7345bf5c-d3d6-4333-bc8d-190dc24e2bdb'
UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=33 WHERE [SystemReportDataSourceFieldId]='31ec898a-397a-4db6-b9a4-93065f9c1164'
UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=58 WHERE [SystemReportDataSourceFieldId]='7cd042a0-32ab-434e-a62d-5e2bd32846b1'
UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=34 WHERE [SystemReportDataSourceFieldId]='9d0158d1-c743-44a1-949e-88c862ea27fb'
UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=37 WHERE [SystemReportDataSourceFieldId]='ff04aed4-8b0f-43b1-91cd-5793882bf861'
UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=36 WHERE [SystemReportDataSourceFieldId]='3e97c0da-f348-4473-af95-b05449750a14'
UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=31 WHERE [SystemReportDataSourceFieldId]='df5731dd-4ca0-4e0c-a7b3-b882b807d26d'
GO
-- Drop View vueAccountEmployee
Print 'Drop View vueAccountEmployee'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployee]
GO
-- Add Column ShowTimeOffInTimesheet to AccountPreferences
Print 'Add Column ShowTimeOffInTimesheet to AccountPreferences'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountPreferences' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='ShowTimeOffInTimesheet' AND TABLE_NAME='AccountPreferences'))
ALTER TABLE [dbo].[AccountPreferences]
	ADD [ShowTimeOffInTimesheet] bit NULL
GO
-- Create View vueAccountEmployee
Print 'Create View vueAccountEmployee'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployee
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountEmployee.AccountId, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.Password, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountLocationId, 
                      dbo.AccountEmployee.BillingTypeId, dbo.AccountBillingType.BillingType, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountPreferences.ShowClockStartEnd, 
                      dbo.Account.TimeZoneId, dbo.AccountRole.MasterAccountRoleId, dbo.Account.DefaultCurrencyId, dbo.Account.CountryId, 
                      dbo.AccountPreferences.CultureInfoName, dbo.AccountPreferences.TimeEntryFormat, dbo.AccountEmployee.AllowedAccessFromIP, 
                      dbo.AccountRole.AccountRoleId, dbo.AccountPreferences.AccountSessionTimeout, dbo.AccountPreferences.ShowCompletedTasksInTimeSheet, 
                      dbo.AccountPreferences.CurrencySymbol, dbo.AccountPreferences.IsCompanyOwnLogo, dbo.Account.AccountExpiryActivation, 
                      dbo.Account.LicenseActivation, dbo.AccountEmployee.EmployeeTypeId, dbo.AccountEmployee.ExternalUserClientId, 
                      dbo.AccountEmployee.AccountBillingRateId, dbo.AccountPreferences.ScheduledEmailSendTime, dbo.AccountEmployee.Username, 
                      dbo.AccountEmployee.IsDisabled, dbo.AccountPreferences.FromEmailAddress, dbo.AccountPreferences.FromEmailAddressDisplayName, 
                      dbo.AccountEmployee.EmployeeCode, dbo.AccountPreferences.Version, dbo.AccountPreferences.LockSubmittedRecords, 
                      dbo.AccountPreferences.LockApprovedRecords, ISNULL(dbo.AccountEmployee.EmployeeCode + '' - '', '''') 
                      + dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeNameWithCode, 
                      dbo.AccountPreferences.ShowWorkTypeInTimeSheet, dbo.AccountPreferences.NumberOfBlankRowsInTimeEntry, 
                      dbo.AccountPreferences.ShowCostCenterInTimeSheet, dbo.AccountPreferences.WeekStartDay, dbo.AccountPreferences.AccountBaseCurrencyId, 
                      dbo.AccountPreferences.UserInterfaceLanguage, dbo.AccountEmployee.EmployeeManagerId, dbo.AccountPreferences.DefaultTimeEntryMode, 
                      dbo.AccountPreferences.PageSize, dbo.AccountEmployee.TimeZoneId AS EmployeeTimeZoneId, dbo.AccountEmployee.TerminationDate, 
                      dbo.AccountEmployee.StatusId, dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.EmployeePayTypeId, dbo.AccountEmployee.HiredDate, 
                      dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountWorkingDayType, dbo.AccountWorkingDayType.HoursPerDay, 
                      dbo.AccountWorkingDayType.WeekStartDay AS EmployeeWeekStartDay, dbo.AccountPreferences.ShowClientInTimesheet, 
                      dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, 
                      dbo.AccountPreferences.ShowDescriptionInWeekView, dbo.AccountPreferences.InvoiceNoPrefix, 
                      dbo.AccountPreferences.ShowAdditionalTaskInformationType, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, ISNULL(dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, 1) 
                      AS InitialDayOfTheMonth, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, 1) 
                      AS SystemInitialDayOfFirstPeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod, 16) AS SystemInitialDayOfLastPeriod, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountPreferences.TimesheetPrintFooter, 
                      dbo.AccountPreferences.ExpenseSheetPrintFooter, dbo.AccountPreferences.ShowCompletedProjectsInTimeSheet, 
                      dbo.AccountPreferences.ShowProjectForTimeOff, dbo.AccountPreferences.ShowTimeOffInTimesheet
FROM         dbo.vueAccountTimesheetPeriodType RIGHT OUTER JOIN
                      dbo.AccountWorkingDayType ON 
                      dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId = dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId RIGHT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.Account ON dbo.AccountEmployee.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId ON 
                      dbo.AccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployee.AccountId = dbo.AccountPreferences.AccountId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId'
GO
-- Drop View vueAccountExpenseEntryApprovalPending
Print 'Drop View vueAccountExpenseEntryApprovalPending'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryApprovalPending' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountExpenseEntryApprovalPending]
GO
-- Create View vueAccountExpenseEntryApprovalPending
Print 'Create View vueAccountExpenseEntryApprovalPending'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryApprovalPending' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountExpenseEntryApprovalPending
AS
SELECT     dbo.vueAccountExpenseEntryApproval.AccountProjectId, dbo.vueAccountExpenseEntryApproval.LeaderEmployeeId, 
                      dbo.vueAccountExpenseEntryApproval.ProjectManagerEmployeeId, dbo.vueAccountExpenseEntryApproval.ApprovalTypeName, 
                      dbo.vueAccountExpenseEntryApproval.AccountApprovalPathId, dbo.vueAccountExpenseEntryApproval.AccountApprovalTypeId, 
                      dbo.vueAccountExpenseEntryApproval.SystemApproverTypeId, dbo.vueAccountExpenseEntryApproval.AccountExternalUserId, 
                      dbo.vueAccountExpenseEntryApproval.AccountEmployeeId, dbo.vueAccountExpenseEntryApproval.ApprovalPathSequence, 
                      dbo.vueAccountExpenseEntryApproval.AccountExpenseEntryId, MAX(dbo.vueAccountExpenseEntryApproval.ExpenseApprovalId) 
                      AS ExpenseApprovalId, dbo.vueAccountExpenseEntryApproval.ExpenseApprovalPathId, dbo.vueAccountExpenseEntryApproval.ProjectName, 
                      dbo.vueAccountExpenseEntryApproval.ProjectDescription, dbo.vueAccountExpenseEntryApproval.ProjectCode, 
                      dbo.vueAccountExpenseEntryApproval.EmployeeName, dbo.vueAccountExpenseEntryApproval.Approved, 
                      dbo.vueAccountExpenseEntryApproval.ExpenseApprovalTypeId, dbo.vueAccountExpenseEntryApproval.AccountExpenseEntryDate, 
                      MAX(dbo.vueAccountExpenseEntryApproval.Comments) AS Comments, dbo.vueAccountExpenseEntryApproval.IsRejected, 
                      dbo.vueAccountExpenseEntryApproval.IsApproved, 
                      CASE WHEN SUM(dbo.vueAccountExpenseEntryApproval.ExchangeRate) 
                      <> 0 THEN dbo.vueAccountExpenseEntryApproval.Amount / SUM(dbo.vueAccountExpenseEntryApproval.ExchangeRate) ELSE 0 END AS Amount, 
                      dbo.vueAccountExpenseEntryApproval.AccountExpenseName, dbo.vueAccountExpenseEntryApproval.IsBillable, 
                      dbo.vueAccountApproverType.MaxApprovalPathSequence, dbo.vueAccountExpenseEntryApproval.ExpenseEntryAccountEmployeeId, 
                      dbo.vueAccountExpenseEntryApproval.Description, dbo.vueAccountExpenseEntryApproval.AccountId, 
                      dbo.vueAccountExpenseEntryApproval.EMailAddress, dbo.vueAccountExpenseEntryApproval.Submitted, 
                      dbo.vueAccountExpenseEntryApproval.EmployeeManagerId, dbo.vueAccountExpenseEntryApproval.CurrencyCode, 
                      dbo.vueAccountExpenseEntryApproval.Rejected, dbo.vueAccountExpenseEntryApproval.AccountEmployeeExpenseSheetId, 
                      MAX(dbo.vueAccountExpenseEntryApproval.MasterDescription) AS MasterDescription, MAX(dbo.vueAccountExpenseEntryApproval.ExpenseSheetDate) 
                      AS ExpenseSheetDate, MAX(dbo.vueAccountCurrency.CurrencyCode) AS BaseCurrencyCode, MAX(dbo.vueAccountCurrency.Currency) 
                      AS BaseCurrency, MAX(dbo.vueAccountExpenseEntryApproval.SubmittedDate) AS SubmittedDate
FROM         dbo.vueAccountExpenseEntryApproval INNER JOIN
                      dbo.vueAccountApproverType ON 
                      dbo.vueAccountExpenseEntryApproval.AccountApprovalTypeId = dbo.vueAccountApproverType.AccountApprovalTypeId INNER JOIN
                      dbo.AccountPreferences ON dbo.vueAccountExpenseEntryApproval.AccountId = dbo.AccountPreferences.AccountId INNER JOIN
                      dbo.vueAccountCurrency ON dbo.AccountPreferences.AccountBaseCurrencyId = dbo.vueAccountCurrency.AccountCurrencyId
WHERE     (dbo.vueAccountExpenseEntryApproval.AccountApprovalPathId IN
                          (SELECT     TOP 1 AccountApprovalPathId
                            FROM          dbo.vueExpenseApprovalSequence AS vueExpenseApprovalSequence_1
                            WHERE      (ExpenseApprovalId IS NULL) AND (AccountExpenseEntryId = dbo.vueAccountExpenseEntryApproval.AccountExpenseEntryId))) AND 
                      (dbo.vueAccountExpenseEntryApproval.Approved = 0) AND (dbo.vueAccountExpenseEntryApproval.Submitted = 1) AND 
                      (dbo.vueAccountExpenseEntryApproval.Rejected IS NULL OR
                      dbo.vueAccountExpenseEntryApproval.Rejected = 0)
GROUP BY dbo.vueAccountExpenseEntryApproval.AccountProjectId, dbo.vueAccountExpenseEntryApproval.LeaderEmployeeId, 
                      dbo.vueAccountExpenseEntryApproval.ProjectManagerEmployeeId, dbo.vueAccountExpenseEntryApproval.ApprovalTypeName, 
                      dbo.vueAccountExpenseEntryApproval.AccountApprovalPathId, dbo.vueAccountExpenseEntryApproval.AccountApprovalTypeId, 
                      dbo.vueAccountExpenseEntryApproval.SystemApproverTypeId, dbo.vueAccountExpenseEntryApproval.AccountExternalUserId, 
                      dbo.vueAccountExpenseEntryApproval.AccountEmployeeId, dbo.vueAccountExpenseEntryApproval.ApprovalPathSequence, 
                      dbo.vueAccountExpenseEntryApproval.AccountExpenseEntryId, dbo.vueAccountExpenseEntryApproval.ExpenseApprovalPathId, 
                      dbo.vueAccountExpenseEntryApproval.ProjectName, dbo.vueAccountExpenseEntryApproval.ProjectDescription, 
                      dbo.vueAccountExpenseEntryApproval.ProjectCode, dbo.vueAccountExpenseEntryApproval.EmployeeName, 
                      dbo.vueAccountExpenseEntryApproval.Approved, dbo.vueAccountExpenseEntryApproval.ExpenseApprovalTypeId, 
                      dbo.vueAccountExpenseEntryApproval.AccountExpenseEntryDate, dbo.vueAccountExpenseEntryApproval.IsRejected, 
                      dbo.vueAccountExpenseEntryApproval.IsApproved, dbo.vueAccountExpenseEntryApproval.Amount, 
                      dbo.vueAccountExpenseEntryApproval.AccountExpenseName, dbo.vueAccountExpenseEntryApproval.IsBillable, 
                      dbo.vueAccountApproverType.MaxApprovalPathSequence, dbo.vueAccountExpenseEntryApproval.ExpenseEntryAccountEmployeeId, 
                      dbo.vueAccountExpenseEntryApproval.Description, dbo.vueAccountExpenseEntryApproval.AccountId, 
                      dbo.vueAccountExpenseEntryApproval.EMailAddress, dbo.vueAccountExpenseEntryApproval.Submitted, 
                      dbo.vueAccountExpenseEntryApproval.EmployeeManagerId, dbo.vueAccountExpenseEntryApproval.CurrencyCode, 
                      dbo.vueAccountExpenseEntryApproval.Rejected, dbo.vueAccountExpenseEntryApproval.AccountEmployeeExpenseSheetId'
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'
IF NOT EXISTS (SELECT * FROM [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId] = 'de89a3ac-5e8b-436b-9d8f-65329c012f85')
BEGIN
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('de89a3ac-5e8b-436b-9d8f-65329c012f85', '0f2d1d68-826d-400e-bf9f-95d4a9d6c4e0', N'ExchangeRate', 100, 0, NULL, NULL, 48, '0da31ddc-9040-46fa-a33a-74e06a645050', N'Exchange Rate', 0, 0)
END
GO
-- Drop View vueAccountEmployeeExpenseSheet
Print 'Drop View vueAccountEmployeeExpenseSheet'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeExpenseSheet' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeExpenseSheet]
GO
-- Create View vueAccountEmployeeExpenseSheetOnlyAmount
Print 'Create View vueAccountEmployeeExpenseSheetOnlyAmount'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeExpenseSheetOnlyAmount' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeExpenseSheetOnlyAmount
AS
SELECT     ISNULL(Amount, 0) AS Amount1, ISNULL(ExchangeRate, 0) AS ExchangeRate, 
                      CASE WHEN ExchangeRate <> 0 THEN Amount / ExchangeRate ELSE 0 END AS Amount, AccountExpenseEntryId, 
                      AccountEmployeeExpenseSheetId
FROM         dbo.AccountExpenseEntry'
GO
-- Create View vueAccountEmployeeExpenseSheet
Print 'Create View vueAccountEmployeeExpenseSheet'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeExpenseSheet' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeExpenseSheet
AS
SELECT     dbo.AccountEmployeeExpenseSheet.AccountEmployeeExpenseSheetId, dbo.AccountEmployeeExpenseSheet.AccountId, 
                      dbo.AccountEmployeeExpenseSheet.AccountEmployeeId, dbo.AccountEmployeeExpenseSheet.Description, 
                      dbo.AccountEmployeeExpenseSheet.ExpenseSheetDate, MAX(dbo.vueAccountCurrency.Currency) AS Currency, 
                      MAX(dbo.vueAccountCurrency.CurrencyCode) AS CurrencyCode, MAX(dbo.vueAccountCurrency.AccountCurrencyId) AS AccountCurrencyId, 
                      CASE WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 0 AND dbo.AccountEmployeeExpenseSheet.Approved = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.Rejected = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.InApproval = 0 THEN ''Not Submitted'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Rejected = 0 THEN ''Approved'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.Rejected = 1 THEN ''Rejected'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 0 AND dbo.AccountEmployeeExpenseSheet.Rejected = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.InApproval = 1 THEN ''Submitted'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 0 AND dbo.AccountEmployeeExpenseSheet.Rejected = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.InApproval = 0 THEN ''Submitted'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 1 THEN ''Not Submitted'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.InApproval = 1 THEN ''Not Submitted'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 1 AND dbo.AccountEmployeeExpenseSheet.Rejected = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.InApproval = 1 THEN ''Approved'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Rejected = 1 THEN ''Submitted'' END AS Status, dbo.AccountEmployeeExpenseSheet.InApproval, 
                      dbo.AccountEmployeeExpenseSheet.Submitted, dbo.AccountEmployeeExpenseSheet.Rejected, dbo.AccountEmployeeExpenseSheet.Approved, 
                      dbo.AccountEmployeeExpenseSheet.SubmittedDate, dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, 
                      dbo.AccountEmployee.EMailAddress, MAX(dbo.vueAccountCurrency.ExchangeRate) AS ExchangeRate, 
                      dbo.AccountEmployeeExpenseSheet.ApprovedOn, dbo.AccountEmployeeExpenseSheet.ApprovedByEmployeeId, 
                      dbo.AccountEmployeeExpenseSheet.RejectedOn, dbo.AccountEmployeeExpenseSheet.RejectedByEmployeeId, 
                       SUM(ISNULL(dbo.vueAccountEmployeeExpenseSheetOnlyAmount.Amount, 0)) AS Amount
FROM         dbo.AccountExpenseEntry INNER JOIN
                      dbo.vueAccountEmployeeExpenseSheetOnlyAmount ON 
                      dbo.AccountExpenseEntry.AccountEmployeeExpenseSheetId = dbo.vueAccountEmployeeExpenseSheetOnlyAmount.AccountEmployeeExpenseSheetId RIGHT
                       OUTER JOIN
                      dbo.AccountEmployeeExpenseSheet INNER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployeeExpenseSheet.AccountId = dbo.AccountPreferences.AccountId INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeExpenseSheet.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId ON 
                      dbo.AccountExpenseEntry.AccountEmployeeExpenseSheetId = dbo.AccountEmployeeExpenseSheet.AccountEmployeeExpenseSheetId LEFT OUTER JOIN
                      dbo.vueAccountCurrency ON dbo.AccountPreferences.AccountBaseCurrencyId = dbo.vueAccountCurrency.AccountCurrencyId
GROUP BY dbo.AccountEmployeeExpenseSheet.AccountEmployeeExpenseSheetId, dbo.AccountEmployeeExpenseSheet.AccountId, 
                      dbo.AccountEmployeeExpenseSheet.AccountEmployeeId, dbo.AccountEmployeeExpenseSheet.Description, 
                      dbo.AccountEmployeeExpenseSheet.ExpenseSheetDate, dbo.AccountEmployeeExpenseSheet.InApproval, 
                      dbo.AccountEmployeeExpenseSheet.Submitted, dbo.AccountEmployeeExpenseSheet.Rejected, dbo.AccountEmployeeExpenseSheet.Approved, 
                      dbo.AccountEmployeeExpenseSheet.SubmittedDate, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, 
                      dbo.AccountEmployee.EMailAddress, dbo.AccountEmployeeExpenseSheet.ApprovedOn, dbo.AccountEmployeeExpenseSheet.ApprovedByEmployeeId, 
                      dbo.AccountEmployeeExpenseSheet.RejectedOn, dbo.AccountEmployeeExpenseSheet.RejectedByEmployeeId'
GO
-- Drop View vueAccountExpenseEntryApproval
Print 'Drop View vueAccountExpenseEntryApproval'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryApproval' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountExpenseEntryApproval]
GO
-- Create View vueAccountExpenseEntryApproval
Print 'Create View vueAccountExpenseEntryApproval'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryApproval' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountExpenseEntryApproval
AS
SELECT     dbo.AccountProject.AccountProjectId, dbo.AccountProject.LeaderEmployeeId, dbo.AccountProject.ProjectManagerEmployeeId, 
                      dbo.AccountApprovalType.ApprovalTypeName, dbo.AccountApprovalPath.AccountApprovalPathId, dbo.AccountApprovalPath.AccountApprovalTypeId, 
                      dbo.AccountApprovalPath.SystemApproverTypeId, dbo.AccountApprovalPath.AccountExternalUserId, dbo.AccountApprovalPath.AccountEmployeeId, 
                      dbo.AccountApprovalPath.ApprovalPathSequence, dbo.AccountExpenseEntry.AccountExpenseEntryId, 
                      dbo.AccountExpenseEntryApproval.ExpenseApprovalId, dbo.AccountExpenseEntryApproval.ExpenseApprovalPathId, dbo.AccountProject.ProjectName, 
                      dbo.AccountProject.ProjectDescription, dbo.AccountProject.ProjectCode, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountExpenseEntry.Approved, 
                      dbo.AccountProject.ExpenseApprovalTypeId, dbo.AccountExpenseEntry.AccountExpenseEntryDate, dbo.AccountExpenseEntryApproval.Comments, 
                      dbo.AccountExpenseEntryApproval.IsRejected, dbo.AccountExpenseEntryApproval.IsApproved, dbo.AccountExpenseEntry.Amount, 
                      dbo.AccountExpense.AccountExpenseName, dbo.AccountExpense.IsBillable, 
                      dbo.AccountExpenseEntry.AccountEmployeeId AS ExpenseEntryAccountEmployeeId, dbo.AccountExpenseEntry.Description, 
                      dbo.AccountExpenseEntry.AccountId, dbo.AccountEmployee.EMailAddress, dbo.AccountExpenseEntry.Submitted, 
                      dbo.AccountEmployee.EmployeeManagerId, dbo.SystemCurrency.CurrencyCode, dbo.AccountExpenseEntry.Rejected, 
                      dbo.AccountExpenseEntry.AccountEmployeeExpenseSheetId, dbo.AccountEmployeeExpenseSheet.Description AS MasterDescription, 
                      dbo.AccountEmployeeExpenseSheet.ExpenseSheetDate, dbo.AccountEmployeeExpenseSheet.SubmittedDate, 
                      ISNULL(dbo.AccountExpenseEntry.ExchangeRate, 0) AS ExchangeRate
FROM         dbo.AccountCurrency INNER JOIN
                      dbo.SystemCurrency ON dbo.AccountCurrency.SystemCurrencyId = dbo.SystemCurrency.CurrencyId RIGHT OUTER JOIN
                      dbo.AccountEmployeeExpenseSheet LEFT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.AccountExpenseEntry ON dbo.AccountEmployee.AccountEmployeeId = dbo.AccountExpenseEntry.AccountEmployeeId ON 
                      dbo.AccountEmployeeExpenseSheet.AccountEmployeeExpenseSheetId = dbo.AccountExpenseEntry.AccountEmployeeExpenseSheetId ON 
                      dbo.AccountCurrency.AccountCurrencyId = dbo.AccountExpenseEntry.AccountCurrencyId LEFT OUTER JOIN
                      dbo.AccountExpense ON dbo.AccountExpenseEntry.AccountExpenseId = dbo.AccountExpense.AccountExpenseId LEFT OUTER JOIN
                      dbo.AccountProject INNER JOIN
                      dbo.AccountApprovalType ON dbo.AccountProject.ExpenseApprovalTypeId = dbo.AccountApprovalType.AccountApprovalTypeId INNER JOIN
                      dbo.AccountApprovalPath ON dbo.AccountApprovalType.AccountApprovalTypeId = dbo.AccountApprovalPath.AccountApprovalTypeId ON 
                      dbo.AccountExpenseEntry.AccountProjectId = dbo.AccountProject.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountExpenseEntryApproval ON 
                      dbo.AccountExpenseEntry.AccountExpenseEntryId = dbo.AccountExpenseEntryApproval.AccountExpenseEntryId AND 
                      dbo.AccountApprovalPath.AccountApprovalPathId = dbo.AccountExpenseEntryApproval.ExpenseApprovalPathId'
GO
-- Drop View vueAccountEmployee
Print 'Drop View vueAccountEmployee'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployee]
GO
-- Create View vueAccountEmployee
Print 'Create View vueAccountEmployee'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployee
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountEmployee.AccountId, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.Password, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountLocationId, 
                      dbo.AccountEmployee.BillingTypeId, dbo.AccountBillingType.BillingType, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountPreferences.ShowClockStartEnd, 
                      dbo.Account.TimeZoneId, dbo.AccountRole.MasterAccountRoleId, dbo.Account.DefaultCurrencyId, dbo.Account.CountryId, 
                      dbo.AccountPreferences.CultureInfoName, dbo.AccountPreferences.TimeEntryFormat, dbo.AccountEmployee.AllowedAccessFromIP, 
                      dbo.AccountRole.AccountRoleId, dbo.AccountPreferences.AccountSessionTimeout, dbo.AccountPreferences.ShowCompletedTasksInTimeSheet, 
                      dbo.AccountPreferences.CurrencySymbol, dbo.AccountPreferences.IsCompanyOwnLogo, dbo.Account.AccountExpiryActivation, 
                      dbo.Account.LicenseActivation, dbo.AccountEmployee.EmployeeTypeId, dbo.AccountEmployee.ExternalUserClientId, 
                      dbo.AccountEmployee.AccountBillingRateId, dbo.AccountPreferences.ScheduledEmailSendTime, dbo.AccountEmployee.Username, 
                      dbo.AccountEmployee.IsDisabled, dbo.AccountPreferences.FromEmailAddress, dbo.AccountPreferences.FromEmailAddressDisplayName, 
                      dbo.AccountEmployee.EmployeeCode, dbo.AccountPreferences.Version, dbo.AccountPreferences.LockSubmittedRecords, 
                      dbo.AccountPreferences.LockApprovedRecords, ISNULL(dbo.AccountEmployee.EmployeeCode + '' - '', '''') 
                      + dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeNameWithCode, 
                      dbo.AccountPreferences.ShowWorkTypeInTimeSheet, dbo.AccountPreferences.NumberOfBlankRowsInTimeEntry, 
                      dbo.AccountPreferences.ShowCostCenterInTimeSheet, dbo.AccountPreferences.WeekStartDay, dbo.AccountPreferences.AccountBaseCurrencyId, 
                      dbo.AccountPreferences.UserInterfaceLanguage, dbo.AccountEmployee.EmployeeManagerId, dbo.AccountPreferences.DefaultTimeEntryMode, 
                      dbo.AccountPreferences.PageSize, dbo.AccountEmployee.TimeZoneId AS EmployeeTimeZoneId, dbo.AccountEmployee.TerminationDate, 
                      dbo.AccountEmployee.StatusId, dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.EmployeePayTypeId, dbo.AccountEmployee.HiredDate, 
                      dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountWorkingDayType, dbo.AccountWorkingDayType.HoursPerDay, 
                      dbo.AccountWorkingDayType.WeekStartDay AS EmployeeWeekStartDay, dbo.AccountPreferences.ShowClientInTimesheet, 
                      dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, 
                      dbo.AccountPreferences.ShowDescriptionInWeekView, dbo.AccountPreferences.InvoiceNoPrefix, 
                      dbo.AccountPreferences.ShowAdditionalTaskInformationType, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, ISNULL(dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, 1) 
                      AS InitialDayOfTheMonth, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, 1) 
                      AS SystemInitialDayOfFirstPeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod, 16) AS SystemInitialDayOfLastPeriod, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountPreferences.TimesheetPrintFooter, 
                      dbo.AccountPreferences.ExpenseSheetPrintFooter, dbo.AccountPreferences.ShowCompletedProjectsInTimeSheet, 
                      dbo.AccountPreferences.ShowProjectForTimeOff, dbo.AccountPreferences.ShowTimeOffInTimesheet, dbo.AccountEmployee.IsDeleted
FROM         dbo.vueAccountTimesheetPeriodType RIGHT OUTER JOIN
                      dbo.AccountWorkingDayType ON 
                      dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId = dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId RIGHT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.Account ON dbo.AccountEmployee.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId ON 
                      dbo.AccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployee.AccountId = dbo.AccountPreferences.AccountId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId'
GO
-- =======================================================
-- Foreign Key Constraint Nochecks's for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print ' Foreign Key Constraint Nochecks''s for Table: [dbo].[SystemSecurityCategoryPage]'

ALTER TABLE [dbo].[SystemSecurityCategoryPage] NOCHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory]
ALTER TABLE [dbo].[SystemSecurityCategoryPage] NOCHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory1]
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemSecurityCategoryPage]'

UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemSecurityCategoryId]=7 WHERE [SystemSecurityCategoryPageId]=144
GO
-- =======================================================
-- Foreign Key Constraint Check's for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print ' Foreign Key Constraint Check''s for Table: [dbo].[SystemSecurityCategoryPage]'

ALTER TABLE [dbo].[SystemSecurityCategoryPage] CHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory]
ALTER TABLE [dbo].[SystemSecurityCategoryPage] CHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory1]

GO
-- Drop View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForEmployeeManager
Print 'Drop View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForEmployeeManager'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForEmployeeManager' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForEmployeeManager]
GO

-- Drop View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForProjectManager
Print 'Drop View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForProjectManager'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForProjectManager' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForProjectManager]
GO

-- Drop View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForAdministrator
Print 'Drop View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForAdministrator'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForAdministrator' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForAdministrator]
GO

-- Drop View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreference
Print 'Drop View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreference'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreference' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreference]
GO

-- Drop View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForTeamLead
Print 'Drop View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForTeamLead'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForTeamLead' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForTeamLead]
GO

-- Drop View vueAccountEmployeeTimeEntryApprovalPendingEmailWithPreference
Print 'Drop View vueAccountEmployeeTimeEntryApprovalPendingEmailWithPreference'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryApprovalPendingEmailWithPreference' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryApprovalPendingEmailWithPreference]
GO

-- Drop View vueExternalAccountEmployee
Print 'Drop View vueExternalAccountEmployee'
GO
if exists (select * from information_schema.tables where table_name = 'vueExternalAccountEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueExternalAccountEmployee]
GO
-- Create View vueExternalAccountEmployee
Print 'Create View vueExternalAccountEmployee'
GO
if not exists (select * from information_schema.tables where table_name = 'vueExternalAccountEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueExternalAccountEmployee
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountEmployee.AccountId, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.Password, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountLocationId, 
                      dbo.AccountEmployee.BillingTypeId, dbo.AccountBillingType.BillingType, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountPreferences.ShowClockStartEnd, 
                      dbo.Account.TimeZoneId, dbo.AccountRole.MasterAccountRoleId, dbo.Account.DefaultCurrencyId, dbo.Account.CountryId, 
                      dbo.AccountPreferences.CultureInfoName, dbo.AccountPreferences.TimeEntryFormat, dbo.AccountEmployee.AllowedAccessFromIP, 
                      dbo.AccountRole.AccountRoleId, dbo.AccountPreferences.AccountSessionTimeout, dbo.AccountPreferences.ShowCompletedTasksInTimeSheet, 
                      dbo.AccountPreferences.CurrencySymbol, dbo.AccountPreferences.IsCompanyOwnLogo, dbo.Account.AccountExpiryActivation, 
                      dbo.Account.LicenseActivation, dbo.AccountEmployee.EmployeeTypeId, dbo.AccountEmployee.ExternalUserClientId, dbo.AccountParty.PartyName, 
                      dbo.AccountParty.PartyNick, dbo.AccountEmployee.IsDisabled, dbo.AccountEmployee.IsDeleted
FROM         dbo.AccountEmployee INNER JOIN
                      dbo.Account ON dbo.AccountEmployee.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId LEFT OUTER JOIN
                      dbo.AccountParty ON dbo.AccountEmployee.ExternalUserClientId = dbo.AccountParty.AccountPartyId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployee.AccountId = dbo.AccountPreferences.AccountId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId'
GO
-- Create View vueAccountEmployeeTimeEntryApprovalPendingEmailWithPreference
Print 'Create View vueAccountEmployeeTimeEntryApprovalPendingEmailWithPreference'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryApprovalPendingEmailWithPreference' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailWithPreference
AS
SELECT     dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountProjectId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.ProjectManagerEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.ApprovalTypeName, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountApprovalPathId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.SystemApproverTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountExternalUserId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.ApprovalPathSequence, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountEmployeeTimeEntryId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TimeSheetApprovalId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TimeSheetApprovalPathId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.ProjectName, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.ProjectDescription, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.ProjectCode, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TaskName, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountProjectTaskId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TaskDescription, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.EmployeeName, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.Approved, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TotalTime, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TimeEntryDate, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.Comments, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.IsReject, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.IsApproved, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.MaxApprovalPathSequence, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TimeEntryAccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountId, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.EMailAddress, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.ApproverEmployeeId, dbo.AccountPreferences.ScheduledEmailSendTime, 
                      dbo.AccountEmployee.EMailAddress AS ApproverEMailAddress, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.Description, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.EmployeeManagerId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.NonBillableTotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.BillableTotalMinutes, dbo.AccountPreferences.CultureInfoName, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountEmployeeTimeEntryPeriodId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TimeEntryStartDate, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.EmployeeWeekStartDay, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TimeEntryEndDate, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TimeEntryViewType
FROM         dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail LEFT OUTER JOIN
                      dbo.AccountEmployee ON 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.ApproverEmployeeId = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountPreferences ON dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountId = dbo.AccountPreferences.AccountId
WHERE     (dbo.AccountEmployee.IsDeleted <> 1)'
GO

-- Create View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForProjectManager
Print 'Create View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForProjectManager'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForProjectManager' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForProjectManager
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, MAX(dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName) AS EmployeeName, 
                      MAX(dbo.AccountEmployee.EMailAddress) AS EMailAddress, dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountEmployee.AccountId, 
                      dbo.AccountPreferences.ScheduledEmailSendTime, CASE WHEN MAX(dbo.AccountPreferences.CultureInfoName) IS NULL 
                      THEN ''en-us'' WHEN MAX(dbo.AccountPreferences.CultureInfoName) = ''auto'' THEN ''en-us'' ELSE MAX(dbo.AccountPreferences.CultureInfoName) 
                      END AS CultureInfoName
FROM         dbo.AccountProject INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountProject.ProjectManagerEmployeeId = dbo.AccountEmployee.AccountEmployeeId INNER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployee.AccountId = dbo.AccountPreferences.AccountId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference ON 
                      dbo.AccountEmployee.AccountEmployeeId = dbo.AccountEMailNotificationPreference.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_1 ON 
                      dbo.AccountEmployee.AccountId = AccountEMailNotificationPreference_1.AccountId
WHERE     (dbo.AccountEmployee.EmployeeTypeId <> 2 OR
                      dbo.AccountEmployee.EmployeeTypeId IS NULL) AND (dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = 36) AND 
                      (dbo.AccountEMailNotificationPreference.Enabled = 1) AND (AccountEMailNotificationPreference_1.SystemEMailNotificationId = 35) AND 
                      (AccountEMailNotificationPreference_1.Enabled = 1) AND (dbo.AccountEmployee.IsDeleted <> 1)
GROUP BY dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountEmployee.AccountId, 
                      dbo.AccountPreferences.ScheduledEmailSendTime'
GO

-- Create View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForEmployeeManager
Print 'Create View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForEmployeeManager'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForEmployeeManager' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForEmployeeManager
AS
SELECT     dbo.AccountPreferences.ScheduledEmailSendTime, MAX(dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName) AS EmployeeName, 
                      AccountEmployee_1.AccountId, dbo.AccountEmployee.LastScheduledEmailSentTime, MAX(dbo.AccountEmployee.EMailAddress) AS EMailAddress, 
                      dbo.AccountEmployee.AccountEmployeeId, CASE WHEN MAX(dbo.AccountPreferences.CultureInfoName) IS NULL 
                      THEN ''en-us'' WHEN MAX(dbo.AccountPreferences.CultureInfoName) = ''auto'' THEN ''en-us'' ELSE MAX(dbo.AccountPreferences.CultureInfoName) 
                      END AS CultureInfoName
FROM         dbo.AccountEmployee INNER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_2 INNER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON 
                      AccountEMailNotificationPreference_2.AccountEmployeeId = AccountEmployee_1.EmployeeManagerId ON 
                      dbo.AccountEmployee.AccountEmployeeId = AccountEmployee_1.EmployeeManagerId RIGHT OUTER JOIN
                      dbo.AccountEMailNotificationPreference ON AccountEmployee_1.AccountId = dbo.AccountEMailNotificationPreference.AccountId LEFT OUTER JOIN
                      dbo.AccountPreferences ON AccountEmployee_1.AccountId = dbo.AccountPreferences.AccountId
WHERE     (AccountEMailNotificationPreference_2.SystemEMailNotificationId = 32) AND (AccountEMailNotificationPreference_2.Enabled = 1) AND 
                      (dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = 31) AND (dbo.AccountEMailNotificationPreference.Enabled = 1) AND 
                      (AccountEmployee_1.EmployeeTypeId <> 2 OR
                      AccountEmployee_1.EmployeeTypeId IS NULL) AND (dbo.AccountEmployee.IsDeleted <> 1)
GROUP BY dbo.AccountPreferences.ScheduledEmailSendTime, AccountEmployee_1.AccountId, dbo.AccountEmployee.LastScheduledEmailSentTime, 
                      dbo.AccountEmployee.AccountEmployeeId'
GO

-- Create View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForAdministrator
Print 'Create View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForAdministrator'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForAdministrator' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForAdministrator
AS
SELECT     dbo.AccountPreferences.ScheduledEmailSendTime, dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, 
                      dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.AccountId, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountRole.Role, dbo.AccountRole.MasterAccountRoleId, 
                      CASE WHEN dbo.AccountPreferences.CultureInfoName IS NULL 
                      THEN ''en-us'' WHEN dbo.AccountPreferences.CultureInfoName = ''auto'' THEN ''en-us'' ELSE CultureInfoName END AS CultureInfoName
FROM         dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_2 RIGHT OUTER JOIN
                      dbo.AccountRole INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountRole.AccountRoleId = dbo.AccountEmployee.AccountRoleId ON 
                      AccountEMailNotificationPreference_2.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference ON dbo.AccountEmployee.AccountId = dbo.AccountEMailNotificationPreference.AccountId LEFT OUTER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployee.AccountId = dbo.AccountPreferences.AccountId
WHERE     (AccountEMailNotificationPreference_2.SystemEMailNotificationId = 34) AND (AccountEMailNotificationPreference_2.Enabled = 1) AND 
                      (dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = 33) AND (dbo.AccountEMailNotificationPreference.Enabled = 1) AND 
                      (dbo.AccountEmployee.EmployeeTypeId <> 2 OR
                      dbo.AccountEmployee.EmployeeTypeId IS NULL) AND (dbo.AccountRole.MasterAccountRoleId = 1) AND (dbo.AccountEmployee.IsDeleted <> 1)'
GO

-- Create View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForTeamLead
Print 'Create View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForTeamLead'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForTeamLead' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForTeamLead
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, MAX(dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName) AS EmployeeName, 
                      MAX(dbo.AccountEmployee.EMailAddress) AS EMailAddress, dbo.AccountEmployee.LastScheduledEmailSentTime, 
                      dbo.AccountPreferences.ScheduledEmailSendTime, dbo.AccountEmployee.AccountId, CASE WHEN MAX(dbo.AccountPreferences.CultureInfoName) 
                      IS NULL THEN ''en-us'' WHEN MAX(dbo.AccountPreferences.CultureInfoName) 
                      = ''auto'' THEN ''en-us'' ELSE MAX(dbo.AccountPreferences.CultureInfoName) END AS CultureInfoName
FROM         dbo.AccountProject INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountProject.LeaderEmployeeId = dbo.AccountEmployee.AccountEmployeeId INNER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployee.AccountId = dbo.AccountPreferences.AccountId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference ON dbo.AccountEmployee.AccountId = dbo.AccountEMailNotificationPreference.AccountId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_1 ON 
                      dbo.AccountEmployee.AccountEmployeeId = AccountEMailNotificationPreference_1.AccountEmployeeId
WHERE     (dbo.AccountEmployee.EmployeeTypeId <> 2 OR
                      dbo.AccountEmployee.EmployeeTypeId IS NULL) AND (dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = 37) AND 
                      (dbo.AccountEMailNotificationPreference.Enabled = 1) AND (AccountEMailNotificationPreference_1.SystemEMailNotificationId = 38) AND 
                      (AccountEMailNotificationPreference_1.Enabled = 1) AND (dbo.AccountEmployee.IsDeleted <> 1)
GROUP BY dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountPreferences.ScheduledEmailSendTime, 
                      dbo.AccountEmployee.AccountId'
GO

-- Create View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreference
Print 'Create View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreference'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreference' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreference
AS
SELECT     dbo.AccountPreferences.ScheduledEmailSendTime, dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, 
                      dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.AccountId, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime
FROM         dbo.AccountEMailNotificationPreference RIGHT OUTER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_2 RIGHT OUTER JOIN
                      dbo.AccountEmployee ON AccountEMailNotificationPreference_2.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId ON 
                      dbo.AccountEMailNotificationPreference.AccountId = dbo.AccountEmployee.AccountId LEFT OUTER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployee.AccountId = dbo.AccountPreferences.AccountId
WHERE     (AccountEMailNotificationPreference_2.SystemEMailNotificationId = 30) AND (AccountEMailNotificationPreference_2.Enabled = 1) AND 
                      (dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = 29) AND (dbo.AccountEMailNotificationPreference.Enabled = 1) AND 
                      (dbo.AccountEmployee.EmployeeTypeId <> 2 OR
                      dbo.AccountEmployee.EmployeeTypeId IS NULL) AND (dbo.AccountEmployee.IsDeleted <> 1)'
GO
-- Drop View vueAccountProjectEmployee
Print 'Drop View vueAccountProjectEmployee'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountProjectEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountProjectEmployee]
GO

-- Create View vueAccountProjectEmployee
Print 'Create View vueAccountProjectEmployee'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountProjectEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountProjectEmployee
AS
SELECT     dbo.AccountProject.AccountProjectId, dbo.AccountProject.ProjectName, dbo.AccountProject.LeaderEmployeeId, 
                      dbo.AccountProject.ProjectManagerEmployeeId, dbo.AccountProjectEmployee.AccountProjectEmployeeId, dbo.AccountProjectEmployee.AccountRoleId, 
                      dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.Password, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS FullName, dbo.AccountEmployee.AccountId, 
                      dbo.AccountBillingRate.BillingRate, dbo.AccountBillingRate.StartDate, dbo.AccountBillingRate.EndDate, dbo.AccountBillingRate.EmployeeRate, 
                      dbo.AccountBillingRate.AccountBillingRateId, dbo.vueAccountEmployeeWithBillingRate.BillingRate AS EmployeeBillingRate, 
                      dbo.vueAccountEmployeeWithBillingRate.EmployeeRate AS EmployeeEmployeeRate, dbo.vueAccountEmployeeWithBillingRate.AccountWorkTypeId, 
                      dbo.AccountBillingRate.SystemBillingRateTypeId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, 
                      dbo.AccountBillingRate.BillingRateCurrencyId, dbo.AccountBillingRate.EmployeeRateCurrencyId, 
                      dbo.vueAccountEmployeeWithBillingRate.BillingRateCurrencyId AS EmployeeBillingRateCurrencyId, 
                      dbo.vueAccountEmployeeWithBillingRate.EmployeeRateCurrencyId AS EmployeeEmployeeRateCurrencyId, dbo.AccountEmployee.IsDisabled, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountLocation.AccountLocation, dbo.AccountEmployee.AccountDepartmentId, 
                      dbo.AccountEmployee.AccountLocationId, dbo.AccountEmployee.IsDeleted
FROM         dbo.AccountLocation RIGHT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.AccountProject ON dbo.AccountEmployee.AccountId = dbo.AccountProject.AccountId ON 
                      dbo.AccountLocation.AccountLocationId = dbo.AccountEmployee.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountWorkType INNER JOIN
                      dbo.vueAccountEmployeeWithBillingRate ON 
                      dbo.AccountWorkType.AccountWorkTypeId = dbo.vueAccountEmployeeWithBillingRate.AccountWorkTypeId ON 
                      dbo.AccountEmployee.AccountEmployeeId = dbo.vueAccountEmployeeWithBillingRate.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountProjectEmployee ON dbo.AccountEmployee.AccountEmployeeId = dbo.AccountProjectEmployee.AccountEmployeeId AND 
                      dbo.AccountProject.AccountProjectId = dbo.AccountProjectEmployee.AccountProjectId AND 
                      dbo.AccountWorkType.AccountId = dbo.AccountProjectEmployee.AccountId LEFT OUTER JOIN
                      dbo.AccountWorkTypeBillingRate ON 
                      dbo.AccountProjectEmployee.AccountProjectEmployeeId = dbo.AccountWorkTypeBillingRate.AccountProjectEmployeeId AND 
                      dbo.AccountWorkType.AccountWorkTypeId = dbo.AccountWorkTypeBillingRate.AccountWorkTypeId LEFT OUTER JOIN
                      dbo.AccountBillingRate ON dbo.AccountWorkTypeBillingRate.AccountBillingRateId = dbo.AccountBillingRate.AccountBillingRateId'
GO
-- Drop Index IX_EMailAddress from AccountEmployee
Print 'Drop Index IX_EMailAddress from AccountEmployee'
GO
IF (EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployee' AND TABLE_TYPE='BASE TABLE')) AND (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID (N'[dbo].[AccountEmployee]') AND name = N'IX_EMailAddress'))
DROP INDEX [dbo].[AccountEmployee].[IX_EMailAddress]
GO
-- Create Index IX_EMailAddress on AccountEmployee
Print 'Create Index IX_EMailAddress on AccountEmployee'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployee' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[IX_EMailAddress]') AND name = N'IX_EMailAddress'))
CREATE UNIQUE INDEX [IX_EMailAddress]
	ON [dbo].[AccountEmployee] ([EMailAddress], [IsDeleted])
GO
-- Drop View rptvueAccountEmployeeTimeEntryPeriod
Print 'Drop View rptvueAccountEmployeeTimeEntryPeriod'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeEntryPeriod' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountEmployeeTimeEntryPeriod]
GO
-- Drop View vueAccountEmployeeTimeEntryPeriodForReport
Print 'Drop View vueAccountEmployeeTimeEntryPeriodForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPeriodForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryPeriodForReport]
GO
-- Drop View rptvueAccountEmployeeTimeEntry
Print 'Drop View rptvueAccountEmployeeTimeEntry'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeEntry' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountEmployeeTimeEntry]
GO
-- Drop View vueAccountEmployeeTimeEntryForReport
Print 'Drop View vueAccountEmployeeTimeEntryForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryForReport]
GO
-- Create View vueAccountEmployeeTimeEntryWithTimeOffForReport
Print 'Create View vueAccountEmployeeTimeEntryWithTimeOffForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithTimeOffForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport
AS
SELECT     dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountProject.ProjectName, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 1 THEN dbo.AccountProjectTask.TaskName ELSE dbo.AccountTimeOffType.AccountTimeOffType
                       END AS TaskName, dbo.AccountEmployeeTimeEntry.TotalTime, dbo.AccountEmployeeTimeEntry.Approved, dbo.AccountEmployee.AccountEmployeeId, 
                      dbo.AccountProject.AccountProjectId, dbo.AccountEmployeeTimeEntry.TeamLeadApproved, dbo.AccountEmployeeTimeEntry.ProjectManagerApproved, 
                      dbo.AccountEmployeeTimeEntry.AdministratorApproved, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, 
                      dbo.AccountEmployeeTimeEntry.StartTime, dbo.AccountEmployeeTimeEntry.EndTime, dbo.AccountEmployeeTimeEntry.TimeEntryDate, 
                      dbo.AccountEmployeeTimeEntry.Description, ISNULL(dbo.AccountProject.AccountId, dbo.AccountTimeOffType.AccountId) AS AccountId, DATEPART(hh, 
                      dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime) AS TotalMinutes, DATEPART(dw, 
                      dbo.AccountEmployeeTimeEntry.TimeEntryDate) AS WeekDay, dbo.AccountParty.AccountPartyId, dbo.AccountParty.PartyName, 
                      dbo.AccountProjectTask.AccountProjectTaskId, dbo.AccountBillingType.BillingType, dbo.AccountProject.LeaderEmployeeId, 
                      dbo.AccountProject.ProjectManagerEmployeeId, dbo.AccountProject.TimeSheetApprovalTypeId, dbo.AccountProject.ExpenseApprovalTypeId, 
                      dbo.AccountProjectTask.IsBillable, dbo.AccountEmployeeTimeEntry.Rejected, dbo.AccountEmployeeTimeEntry.BillingRate, 
                      dbo.AccountProject.ProjectBillingRateTypeId, dbo.AccountEmployee.EmployeeCode, dbo.AccountEmployee.AccountDepartmentId, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountProjectTask.EstimatedCost, dbo.AccountProjectTask.EstimatedTimeSpent, 
                      dbo.AccountEmployeeTimeEntry.Submitted, dbo.AccountWorkType.AccountWorkType, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountLocation.AccountLocation, dbo.AccountCostCenter.AccountCostCenter, dbo.AccountCostCenter.AccountCostCenterCode, 
                      dbo.AccountWorkType.AccountWorkTypeCode, dbo.AccountProject.ProjectCode, dbo.AccountProjectTask.TaskCode, 
                      dbo.AccountLocation.AccountLocationId, dbo.vueAccountEmployeeTimeEntryApprovalLastAction.Comments, 
                      dbo.AccountEmployeeTimeEntry.BillingRateCurrencyId, dbo.AccountEmployeeTimeEntry.EmployeeRateCurrencyId, 
                      dbo.AccountEmployeeTimeEntry.BillingRateExchangeRate, dbo.AccountEmployeeTimeEntry.EmployeeRateExchangeRate, 
                      dbo.AccountEmployeeTimeEntry.AccountBaseCurrencyId, dbo.AccountProjectTask.AccountTaskTypeId, dbo.AccountProjectTask.TaskStatusId, 
                      dbo.AccountProjectTask.AccountPriorityId, dbo.AccountProjectTask.AccountProjectMilestoneId, dbo.AccountDepartment.DepartmentCode, 
                      dbo.AccountParty.PartyNick, dbo.AccountProjectTask.EstimatedCurrencyId, dbo.vueAccountEmployeeTimeEntryApprovalLastAction.ApprovedOn, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRate, dbo.AccountRole.AccountRoleId, dbo.AccountRole.Role, dbo.AccountProject.AccountProjectTypeId, 
                      dbo.AccountProject.ProjectDescription, dbo.AccountProjectTask.TaskDescription, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeExpenseBillingTimesheetId, dbo.AccountEmployeeTimeEntry.Billed, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Submitted = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS SubmittedHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Approved = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS ApprovedHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Rejected = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS RejectedHours, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, 
                      dbo.AccountPartyContact.FirstName + N'' '' + dbo.AccountPartyContact.LastName AS ClientContactName, 
                      dbo.AccountPartyDepartment.PartyDepartmentCode AS ClientDepartmentCode, 
                      dbo.AccountPartyDepartment.PartyDepartmentName AS ClientDepartmentName, 
                      dbo.AccountPartyDepartment.PartyDepartmentLocation AS ClientDepartmentLocation, dbo.AccountEmployeeTimeEntry.IsTimeOff, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId, CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 0 THEN ROUND(CONVERT(float, 
                      DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) 
                      END AS TimeOffHours, CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 1 THEN ROUND(CONVERT(float, DATEPART(hh, 
                      dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS TimesheetHours
FROM         dbo.AccountEmployeeTimeEntry INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeEntry.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountTimeOffType ON 
                      dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId LEFT OUTER JOIN
                      dbo.AccountProjectTask ON dbo.AccountEmployeeTimeEntry.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId LEFT OUTER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountPartyDepartment ON 
                      dbo.AccountProject.AccountPartyDepartmentId = dbo.AccountPartyDepartment.AccountPartyDepartmentId LEFT OUTER JOIN
                      dbo.AccountPartyContact ON dbo.AccountProject.AccountPartyContactId = dbo.AccountPartyContact.AccountPartyContactId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryPeriod ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId LEFT
                       OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId LEFT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryApprovalLastAction.AccountEmployeeTimeEntryId LEFT
                       OUTER JOIN
                      dbo.AccountCostCenter ON dbo.AccountEmployeeTimeEntry.AccountCostCenterId = dbo.AccountCostCenter.AccountCostCenterId LEFT OUTER JOIN
                      dbo.AccountWorkType ON dbo.AccountEmployeeTimeEntry.AccountWorkTypeId = dbo.AccountWorkType.AccountWorkTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId LEFT OUTER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId'
GO
-- Create View vueAccountEmployeeTimeEntryForReport
Print 'Create View vueAccountEmployeeTimeEntryForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryForReport
AS
SELECT     dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeName, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskName, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalTime, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Approved, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TeamLeadApproved, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectManagerApproved, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AdministratorApproved, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeTimeEntryId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.StartTime, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EndTime, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Description, N'''') AS Description, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.WeekDay, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountPartyId AS AccountClientId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.PartyName AS ClientName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectTaskId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingType, N'''') AS BillingType, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectManagerEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ExpenseApprovalTypeId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.IsBillable, 0) AS IsBillable, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Rejected, 0) AS Rejected, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRate, 0) AS BillingRate, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectBillingRateTypeId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeCode, N'''') AS EmployeeCode, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountDepartmentId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.DepartmentName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedCost, 0) AS EstimatedCost, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedTimeSpent, 0) AS EstimatedHours, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Submitted, 0) AS Submitted, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountWorkType, N'''') AS AccountWorkType, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EMailAddress, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountLocation, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountCostCenter, N'''') AS AccountCostCenter, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountCostCenterCode, N'''') AS AccountCostCenterCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountWorkTypeCode, N'''') AS AccountWorkTypeCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectCode, N'''') AS ProjectCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCode, N'''') AS TaskCode, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountLocationId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Comments, N'''') AS ApproverComments, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes * dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRate
                       / 60, 0) AS Amount, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRateCurrencyId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateExchangeRate, 0) AS BillingRateExchangeRate, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRateExchangeRate, 0) AS EmployeeRateExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountBaseCurrencyId, 
                      dbo.vueAccountCurrency.CurrencyCode AS BillingRateCurrencyCode, dbo.vueAccountCurrency.CurrencyCode AS AmountCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountTaskTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskStatusId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountPriorityId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectMilestoneId, dbo.AccountTaskType.TaskType, 
                      dbo.AccountStatus.Status AS TaskStatus, dbo.AccountProjectMilestone.MilestoneDescription, dbo.AccountPriority.Priority, ROUND(CONVERT(float, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes) / 60, 2) AS TotalHours, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.DepartmentCode, N'''') AS DepartmentCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.PartyNick, N'''') AS ClientNick, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedCurrencyId, vueAccountCurrency_1.CurrencyCode AS EstimatedCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ApprovedOn, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRate, 0) AS EmployeeRate, 
                      vueAccountCurrency_2.CurrencyCode AS EmployeeRateCurrencyCode, 
                      AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName AS TeamLeader, 
                      AccountEmployee_2.FirstName + '' '' + AccountEmployee_2.LastName AS ProjectManager, 
                      ISNULL(dbo.AccountEmployee.FirstName + N'' '' + dbo.AccountEmployee.LastName, N'''') AS EmployeeManager, 
                      vueAccountCurrency_1.ExchangeRate AS EstimatedCurrencyExchangeRate, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes * dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRate
                       / 60, 0) AS EmployeeCost, { fn DAYOFMONTH(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) } AS DayNo, 
                      MONTH(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) AS MonthNo, DATEPART(week, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) - DATEPART(week, DATEADD(month, DATEDIFF(month, 0, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate), 0)) + 1 AS WeekNo, 
                      YEAR(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) AS Year, 
                      LEFT({ fn MONTHNAME(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) }, 3) + '' - '' + CONVERT(nvarchar(10), 
                      YEAR(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate)) AS Period, 
                      { fn DAYNAME(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) } AS WeekDayName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountRoleId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Role, 
                      dbo.AccountProjectType.ProjectType, dbo.AccountRole.Role AS ProjectRole, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectDescription, N'''') AS ProjectDescription, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskDescription, N'''') AS TaskDescription, 
                      dbo.AccountTimeExpenseBilling.InvoiceNumber, dbo.AccountTimeExpenseBilling.InvoiceDate, dbo.AccountProjectType.AccountProjectTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Billed, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeTimeEntryPeriodId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientContactName, N'''') AS ClientContactName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentCode, N'''') AS ClientDepartmentCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentName, N'''') AS ClientDepartmentName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentLocation, N'''') AS ClientDepartmentLocation, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.IsTimeOff
FROM         dbo.AccountRole INNER JOIN
                      dbo.AccountProjectEmployee ON dbo.AccountRole.AccountRoleId = dbo.AccountProjectEmployee.AccountRoleId RIGHT OUTER JOIN
                      dbo.AccountTimeExpenseBillingTimesheet INNER JOIN
                      dbo.AccountTimeExpenseBilling ON 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingId = dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId RIGHT OUTER
                       JOIN
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport LEFT OUTER JOIN
                      dbo.AccountProjectType ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectTypeId = dbo.AccountProjectType.AccountProjectTypeId LEFT OUTER JOIN
                      dbo.AccountProjectMilestone ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectMilestoneId = dbo.AccountProjectMilestone.AccountProjectMilestoneId LEFT OUTER
                       JOIN
                      dbo.AccountStatus ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskStatusId = dbo.AccountStatus.AccountStatusId LEFT OUTER JOIN
                      dbo.AccountPriority ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountPriorityId = dbo.AccountPriority.AccountPriorityId LEFT OUTER JOIN
                      dbo.AccountTaskType ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountTaskTypeId = dbo.AccountTaskType.AccountTaskTypeId ON
                       dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingTimesheetId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountTimeExpenseBillingTimesheetId
                       ON dbo.AccountProjectEmployee.AccountEmployeeId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeId AND 
                      dbo.AccountProjectEmployee.AccountProjectId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.LeaderEmployeeId = AccountEmployee_1.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_2 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectManagerEmployeeId = AccountEmployee_2.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.AccountEmployee AS AccountEmployee_3 ON dbo.AccountEmployee.AccountEmployeeId = AccountEmployee_3.EmployeeManagerId ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeId = AccountEmployee_3.AccountEmployeeId LEFT OUTER JOIN
                      dbo.vueAccountCurrency AS vueAccountCurrency_2 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRateCurrencyId = vueAccountCurrency_2.AccountCurrencyId LEFT OUTER JOIN
                      dbo.vueAccountCurrency AS vueAccountCurrency_1 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedCurrencyId = vueAccountCurrency_1.AccountCurrencyId LEFT OUTER JOIN
                      dbo.vueAccountCurrency ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateCurrencyId = dbo.vueAccountCurrency.AccountCurrencyId'
GO
-- Create View rptvueAccountEmployeeTimeEntry
Print 'Create View rptvueAccountEmployeeTimeEntry'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeEntry' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountEmployeeTimeEntry
AS
SELECT     dbo.vueAccountEmployeeTimeEntryForReport.EmployeeName, dbo.vueAccountEmployeeTimeEntryForReport.ProjectName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskName, dbo.vueAccountEmployeeTimeEntryForReport.TotalTime, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Approved, dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectId, dbo.vueAccountEmployeeTimeEntryForReport.TeamLeadApproved, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManagerApproved, dbo.vueAccountEmployeeTimeEntryForReport.AdministratorApproved, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeTimeEntryId, dbo.vueAccountEmployeeTimeEntryForReport.StartTime, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EndTime, dbo.vueAccountEmployeeTimeEntryForReport.TimeEntryDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Description, dbo.vueAccountEmployeeTimeEntryForReport.AccountId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TotalMinutes, dbo.vueAccountEmployeeTimeEntryForReport.WeekDay, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientName, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectTaskId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingType, dbo.vueAccountEmployeeTimeEntryForReport.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManagerEmployeeId, dbo.vueAccountEmployeeTimeEntryForReport.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ExpenseApprovalTypeId, dbo.vueAccountEmployeeTimeEntryForReport.IsBillable, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Rejected, dbo.vueAccountEmployeeTimeEntryForReport.BillingRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectBillingRateTypeId, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountDepartmentId, dbo.vueAccountEmployeeTimeEntryForReport.DepartmentName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCost, dbo.vueAccountEmployeeTimeEntryForReport.EstimatedHours, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Submitted, dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkType, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EMailAddress, dbo.vueAccountEmployeeTimeEntryForReport.AccountLocation, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountCostCenter, dbo.vueAccountEmployeeTimeEntryForReport.AccountCostCenterCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkTypeCode, dbo.vueAccountEmployeeTimeEntryForReport.ProjectCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCode, dbo.vueAccountEmployeeTimeEntryForReport.AccountLocationId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ApproverComments, dbo.vueAccountEmployeeTimeEntryForReport.Amount, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingRateCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountBaseCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.BillingRateCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AmountCurrencyCode, CASE WHEN vueAccountEmployeeTimeEntryForReport.Submitted = 1 AND 
                      vueAccountEmployeeTimeEntryForReport.Approved = 0 THEN ''Submitted'' WHEN vueAccountEmployeeTimeEntryForReport.Approved = 1 THEN ''Approved''
                       WHEN vueAccountEmployeeTimeEntryForReport.Rejected = 1 THEN ''Rejected'' WHEN vueAccountEmployeeTimeEntryForReport.Submitted = 0 AND 
                      vueAccountEmployeeTimeEntryForReport.Approved = 0 AND 
                      vueAccountEmployeeTimeEntryForReport.Rejected = 0 THEN ''Not Submitted'' END AS ApprovalStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountTaskTypeId, dbo.vueAccountEmployeeTimeEntryForReport.TaskStatusId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountPriorityId, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectMilestoneId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskType, dbo.vueAccountEmployeeTimeEntryForReport.TaskStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.MilestoneDescription, dbo.vueAccountEmployeeTimeEntryForReport.Priority, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TotalHours, dbo.vueAccountEmployeeTimeEntryForReport.DepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientNick, dbo.vueAccountEmployeeTimeEntryForReport.AccountClientId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ApprovedOn, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateCurrencyCode, dbo.vueAccountEmployeeTimeEntryForReport.TeamLeader, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManager, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeManager, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate, 0) AS EstimatedCurrencyExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCost, dbo.vueAccountEmployeeTimeEntryForReport.AccountRoleId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Role, dbo.vueAccountEmployeeTimeEntryForReport.WeekDayName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Period, dbo.vueAccountEmployeeTimeEntryForReport.Year, 
                      dbo.vueAccountEmployeeTimeEntryForReport.WeekNo, dbo.vueAccountEmployeeTimeEntryForReport.MonthNo, 
                      dbo.vueAccountEmployeeTimeEntryForReport.DayNo, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 1 THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours ELSE 0 END AS
                       BillableTotalHours, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable
                       IS NULL THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours ELSE 0 END AS NonBillableTotalHours, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCost
                       / dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate ELSE 0 END AS CurrencyEmployeeCost, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.Amount / dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate
                       ELSE 0 END AS CurrencyAmount, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCost
                       / dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate ELSE 0 END AS CurrencyEstimatedCost, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate
                       / dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate ELSE 0 END AS CurrencyBillingRate, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRate
                       / dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate ELSE 0 END AS CurrencyEmployeeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectRole, dbo.vueAccountEmployeeTimeEntryForReport.ProjectType, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectDescription, dbo.vueAccountEmployeeTimeEntryForReport.TaskDescription, 
                      dbo.vueAccountEmployeeTimeEntryForReport.InvoiceNumber, dbo.vueAccountEmployeeTimeEntryForReport.InvoiceDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectTypeId, dbo.vueAccountEmployeeTimeEntryForReport.Billed, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientContactName, dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentName, dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentLocation, 
                      dbo.vueAccountEmployeeTimeEntryForReport.IsTimeOff
FROM         dbo.vueAccountEmployeeTimeEntryForReport INNER JOIN
                      dbo.vueAccountEmployeeTimeEntryWithLastStatus ON 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryWithLastStatus.AccountEmployeeTimeEntryId'
GO
-- Create View vueAccountEmployeeTimeEntryPeriodForReport
Print 'Create View vueAccountEmployeeTimeEntryPeriodForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPeriodForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryPeriodForReport
AS
SELECT     dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId, dbo.AccountEmployeeTimeEntryPeriod.AccountId, 
                      dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeId, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, 
                      dbo.AccountEmployeeTimeEntryPeriod.Submitted, dbo.AccountEmployeeTimeEntryPeriod.Approved, dbo.AccountEmployeeTimeEntryPeriod.Rejected, 
                      dbo.AccountEmployeeTimeEntryPeriod.InApproval, dbo.AccountEmployeeTimeEntryPeriod.SubmittedDate, dbo.vueAccountEmployee.EmployeeName, 
                      dbo.vueAccountEmployee.AccountLocationId, dbo.vueAccountEmployee.AccountDepartmentId, dbo.vueAccountEmployee.AccountLocation, 
                      dbo.vueAccountEmployee.Role, dbo.vueAccountEmployee.DepartmentName, dbo.vueAccountEmployee.EMailAddress, 
                      dbo.vueAccountEmployee.AccountRoleId, CASE WHEN AccountEmployeeTimeEntryPeriod.Submitted = 1 AND 
                      AccountEmployeeTimeEntryPeriod.Approved = 0 THEN ''Submitted'' WHEN AccountEmployeeTimeEntryPeriod.Approved = 1 THEN ''Approved'' WHEN AccountEmployeeTimeEntryPeriod.Rejected
                       = 1 THEN ''Rejected'' WHEN AccountEmployeeTimeEntryPeriod.Submitted = 0 AND AccountEmployeeTimeEntryPeriod.Approved = 0 AND 
                      AccountEmployeeTimeEntryPeriod.Rejected = 0 THEN ''Not Submitted'' END AS ApprovalStatus, 
                      { fn DAYOFMONTH(dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate) } AS DayNo, 
                      MONTH(dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate) AS MonthNo, DATEPART(week, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate) - DATEPART(week, DATEADD(month, DATEDIFF(month, 0, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate), 0)) + 1 AS WeekNo, YEAR(dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate) 
                      AS Year, LEFT({ fn MONTHNAME(dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate) }, 3) + '' - '' + CONVERT(nvarchar(10), 
                      YEAR(dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate)) AS Period, 
                      { fn DAYNAME(dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate) } AS WeekDayName, SUM(ROUND(CONVERT(float, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes) / 60, 2)) AS TotalHours, 
                      SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes * dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRate
                       / 60, 0)) AS Amount, SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRate, 0)) AS BillingRate, 
                      SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.SubmittedHours, 0)) AS SubmittedHours, 
                      SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ApprovedHours, 0)) AS ApprovedHours, 
                      SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.RejectedHours, 0)) AS RejectedHours, 
                      ISNULL(dbo.vueAccountEmployee.EmployeeCode, '''') AS EmployeeCode, 
                      SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateExchangeRate, 0)) AS BillingRateExchangeRate, 
                      dbo.AccountEmployeeTimeEntryPeriod.ApprovedOn, dbo.AccountEmployeeTimeEntryPeriod.RejectedOn, 
                      dbo.AccountEmployeeTimeEntryPeriod.ApprovedByEmployeeId, dbo.AccountEmployeeTimeEntryPeriod.RejectedByEmployeeId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientContactName, N'''') AS ClientContactName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentCode, N'''') AS ClientDepartmentCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentName, N'''') AS ClientDepartmentName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentLocation, N'''') AS ClientDepartmentLocation, 
                      SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeOffHours, 0)) AS TimeOffHours, 
                      SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimesheetHours, 0)) AS TimesheetHours
FROM         dbo.AccountEmployeeTimeEntryPeriod INNER JOIN
                      dbo.vueAccountEmployee ON 
                      dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeId = dbo.vueAccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport ON 
                      dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeTimeEntryPeriodId
GROUP BY dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId, dbo.AccountEmployeeTimeEntryPeriod.AccountId, 
                      dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeId, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, 
                      dbo.AccountEmployeeTimeEntryPeriod.Submitted, dbo.AccountEmployeeTimeEntryPeriod.Approved, dbo.AccountEmployeeTimeEntryPeriod.Rejected, 
                      dbo.AccountEmployeeTimeEntryPeriod.InApproval, dbo.AccountEmployeeTimeEntryPeriod.SubmittedDate, dbo.vueAccountEmployee.EmployeeName, 
                      dbo.vueAccountEmployee.AccountLocationId, dbo.vueAccountEmployee.AccountDepartmentId, dbo.vueAccountEmployee.AccountLocation, 
                      dbo.vueAccountEmployee.Role, dbo.vueAccountEmployee.DepartmentName, dbo.vueAccountEmployee.EMailAddress, 
                      dbo.vueAccountEmployee.AccountRoleId, dbo.vueAccountEmployee.EmployeeCode, dbo.AccountEmployeeTimeEntryPeriod.ApprovedOn, 
                      dbo.AccountEmployeeTimeEntryPeriod.RejectedOn, dbo.AccountEmployeeTimeEntryPeriod.ApprovedByEmployeeId, 
                      dbo.AccountEmployeeTimeEntryPeriod.RejectedByEmployeeId, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientContactName, 
                      N''''), ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentCode, N''''), 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentName, N''''), 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentLocation, N'''')'
GO
-- Create View rptvueAccountEmployeeTimeEntryPeriod
Print 'Create View rptvueAccountEmployeeTimeEntryPeriod'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeEntryPeriod' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountEmployeeTimeEntryPeriod
AS
SELECT     dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountEmployeeTimeEntryPeriodId, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountId, dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.TimeEntryStartDate, dbo.vueAccountEmployeeTimeEntryPeriodForReport.TimeEntryEndDate, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.TimeEntryViewType, dbo.vueAccountEmployeeTimeEntryPeriodForReport.Submitted, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.Approved, dbo.vueAccountEmployeeTimeEntryPeriodForReport.Rejected, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.InApproval, dbo.vueAccountEmployeeTimeEntryPeriodForReport.SubmittedDate, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.EmployeeName, dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountLocationId, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountDepartmentId, dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountLocation, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.Role, dbo.vueAccountEmployeeTimeEntryPeriodForReport.DepartmentName, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.EMailAddress, dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountRoleId, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.ApprovalStatus, dbo.vueAccountEmployeeTimeEntryPeriodForReport.DayNo, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.MonthNo, dbo.vueAccountEmployeeTimeEntryPeriodForReport.WeekNo, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.Year, dbo.vueAccountEmployeeTimeEntryPeriodForReport.Period, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.WeekDayName, ISNULL(dbo.vueAccountEmployeeTimeEntryPeriodForReport.TotalHours, 0) 
                      AS TotalHours, dbo.vueAccountEmployeeTimeEntryPeriodForReport.Amount, dbo.vueAccountEmployeeTimeEntryPeriodForReport.BillingRate, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.SubmittedHours, dbo.vueAccountEmployeeTimeEntryPeriodForReport.ApprovedHours, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.RejectedHours, dbo.vueAccountEmployeeTimeEntryPeriodForReport.EmployeeCode, 
                      CASE WHEN BillingRateExchangeRate > 0 THEN Amount / BillingRateExchangeRate ELSE 0 END AS CurrencyAmount, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryPeriodForReport.Approved = 1 THEN dbo.vueAccountEmployeeTimeEntryPeriodForReport.ApprovedOn
                       ELSE NULL END AS ApprovedDate, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryPeriodForReport.Rejected = 1 THEN dbo.vueAccountEmployeeTimeEntryPeriodForReport.RejectedOn ELSE
                       NULL END AS RejectedDate, AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName AS ApprovedByEmployeeName, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS RejectedByEmployeeName, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.ClientContactName, dbo.vueAccountEmployeeTimeEntryPeriodForReport.ClientDepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.ClientDepartmentName, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.ClientDepartmentLocation, dbo.vueAccountEmployeeTimeEntryPeriodForReport.TimeOffHours, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.TimesheetHours
FROM         dbo.vueAccountEmployeeTimeEntryPeriodForReport LEFT OUTER JOIN
                      dbo.AccountEmployee ON 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.RejectedByEmployeeId = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.ApprovedByEmployeeId = AccountEmployee_1.AccountEmployeeId'
GO
-- =======================================================
-- Foreign Key Constraint Nochecks's for Table: [dbo].[AccountReportSummary]
-- =======================================================
Print ' Foreign Key Constraint Nochecks''s for Table: [dbo].[AccountReportSummary]'

ALTER TABLE [dbo].[AccountReportSummary] NOCHECK CONSTRAINT [FK_AccountReportSummary_AccountReport]

-- =======================================================
-- Foreign Key Constraint Nochecks's for Table: [dbo].[AccountReportColumn]
-- =======================================================
Print ' Foreign Key Constraint Nochecks''s for Table: [dbo].[AccountReportColumn]'

ALTER TABLE [dbo].[AccountReportColumn] NOCHECK CONSTRAINT [FK_AccountReportColumn_AccountReport]

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'
IF NOT EXISTS (SELECT * FROM [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId] = '5ca5a57f-d5b4-4c1a-ba36-a96835d0ceb3')
BEGIN
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('5ca5a57f-d5b4-4c1a-ba36-a96835d0ceb3', '18966956-9937-4da0-a6f3-465e6066d433', N'TimesheetHours', 100, 1, NULL, NULL, 38, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Timesheet Hours', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('36f732d8-e892-4d11-b3c7-efd39dd6cfce', '18966956-9937-4da0-a6f3-465e6066d433', N'TimeOffHours', 100, 1, NULL, NULL, 39, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Time Off Hours', 0, 0)
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportFilterSource]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportFilterSource]'
IF NOT EXISTS (SELECT * FROM [dbo].[SystemReportFilterSource] WHERE [SystemReportFilterSourceId] = '4c168cad-7801-4d10-bb0f-9dc7ef41d7a6')
BEGIN
INSERT INTO [dbo].[SystemReportFilterSource] ([SystemReportFilterSourceId], [SystemReportFilterSource], [ClassName], [ClassFunction], [ParameterName1], [Caption], [FilterSourceType], [FilterSource], [FilterOperator], [IsOptional], [FilterField], [ParentFilterSource]) VALUES ('4c168cad-7801-4d10-bb0f-9dc7ef41d7a6', N'TimesheetType', NULL, NULL, NULL, N'Timesheet Type:', NULL, NULL, N'TimesheetType', NULL, N'TimesheetType', NULL)
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportFilterSourceMapping]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportFilterSourceMapping]'
IF NOT EXISTS (SELECT * FROM [dbo].[SystemReportFilterSourceMapping] WHERE [SystemReportFilterMappingId] = '0674aee1-52b3-456c-acb7-890e73f8898c')
BEGIN
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('0674aee1-52b3-456c-acb7-890e73f8898c', '4c168cad-7801-4d10-bb0f-9dc7ef41d7a6', '3a080202-6842-4eca-8c79-a945978810b4', 0, 0, 15)
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[AccountReportColumn]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[AccountReportColumn]'
IF NOT EXISTS (SELECT * FROM [dbo].[AccountReportColumn] WHERE [AccountReportColumnId] = 'e2311a45-547f-4128-9020-ffc854c7f946')
BEGIN
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('e2311a45-547f-4128-9020-ffc854c7f946', '07cf48a8-c92c-432a-8a14-f0f5d931ba0a', N'Timesheet Hours', '5ca5a57f-d5b4-4c1a-ba36-a96835d0ceb3', 19, 'd3c0763b-8f05-4fd5-aa69-37dbe17479ef', NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('200b356c-d7de-41d7-824c-44377282047a', '07cf48a8-c92c-432a-8a14-f0f5d931ba0a', N'Time Off Hours', '36f732d8-e892-4d11-b3c7-efd39dd6cfce', 20, 'd3c0763b-8f05-4fd5-aa69-37dbe17479ef', NULL)
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[AccountReportSummary]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[AccountReportSummary]'
IF NOT EXISTS (SELECT * FROM [dbo].[AccountReportSummary] WHERE [AccountReportSummaryId] = 'd7ee270f-510d-41c1-b548-9c089a197155')
BEGIN
INSERT INTO [dbo].[AccountReportSummary] ([AccountReportSummaryId], [AccountReportGroupId], [AccountReportId], [SystemReportCalculationTypeId], [AccountReportColumnId], [SummaryCaption], [IsShowGroupTotal], [IsShowGrandTotal]) VALUES ('d7ee270f-510d-41c1-b548-9c089a197155', '5ca9a823-1fd9-4d14-8c53-4d60af6c60d0', '07cf48a8-c92c-432a-8a14-f0f5d931ba0a', 'd3c0763b-8f05-4fd5-aa69-37dbe17479ef', '200b356c-d7de-41d7-824c-44377282047a', N'TimeOffHours', 1, 1)
INSERT INTO [dbo].[AccountReportSummary] ([AccountReportSummaryId], [AccountReportGroupId], [AccountReportId], [SystemReportCalculationTypeId], [AccountReportColumnId], [SummaryCaption], [IsShowGroupTotal], [IsShowGrandTotal]) VALUES ('45ee5d7f-19b1-4e6a-8877-2b1790d0e410', '5ca9a823-1fd9-4d14-8c53-4d60af6c60d0', '07cf48a8-c92c-432a-8a14-f0f5d931ba0a', 'd3c0763b-8f05-4fd5-aa69-37dbe17479ef', 'e2311a45-547f-4128-9020-ffc854c7f946', N'TimesheetHours', 1, 1)
END
GO
-- =======================================================
-- Foreign Key Constraint Check's for Table: [dbo].[AccountReportColumn]
-- =======================================================
Print ' Foreign Key Constraint Check''s for Table: [dbo].[AccountReportColumn]'

ALTER TABLE [dbo].[AccountReportColumn] CHECK CONSTRAINT [FK_AccountReportColumn_AccountReport]

-- =======================================================
-- Foreign Key Constraint Check's for Table: [dbo].[AccountReportSummary]
-- =======================================================
Print ' Foreign Key Constraint Check''s for Table: [dbo].[AccountReportSummary]'

ALTER TABLE [dbo].[AccountReportSummary] CHECK CONSTRAINT [FK_AccountReportSummary_AccountReport]
GO
-- Add Column Completed to AccountProject
Print 'Add Column IsEmailSend to AccountEmployee'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployee' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='IsEmailSend' AND TABLE_NAME='AccountEmployee'))

ALTER TABLE [dbo].[AccountEmployee]
	ADD [IsEmailSend] bit NOT NULL
	CONSTRAINT [DF_AccountEmployee_IsEmailSend] DEFAULT ((0))
GO
-- Drop View vueAccountEmployeeTimeEntry
Print 'Drop View vueAccountEmployeeTimeEntry'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntry' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntry]
GO
-- Create View vueAccountEmployeeTimeEntry
Print 'Create View vueAccountEmployeeTimeEntry'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntry' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntry
AS
SELECT     dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountProject.ProjectName, 
                      CASE WHEN dbo.AccountProjectTask.AccountProjectTaskId IS NOT NULL 
                      THEN dbo.AccountProjectTask.TaskName ELSE AccountTimeOffType.AccountTimeOffType END AS TaskName, 
                      dbo.AccountEmployeeTimeEntry.TotalTime, dbo.AccountEmployeeTimeEntry.Approved, dbo.AccountEmployee.AccountEmployeeId, 
                      dbo.AccountProject.AccountProjectId, dbo.AccountEmployeeTimeEntry.TeamLeadApproved, dbo.AccountEmployeeTimeEntry.ProjectManagerApproved, 
                      dbo.AccountEmployeeTimeEntry.AdministratorApproved, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, 
                      dbo.AccountEmployeeTimeEntry.StartTime, dbo.AccountEmployeeTimeEntry.EndTime, dbo.AccountEmployeeTimeEntry.TimeEntryDate, 
                      dbo.AccountEmployeeTimeEntry.Description, dbo.AccountEmployee.AccountId, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime) AS TotalMinutes, DATEPART(dw, dbo.AccountEmployeeTimeEntry.TimeEntryDate) 
                      AS WeekDay, dbo.AccountParty.AccountPartyId, dbo.AccountParty.PartyName, dbo.AccountProjectTask.AccountProjectTaskId, 
                      dbo.AccountBillingType.BillingType, dbo.AccountProject.LeaderEmployeeId, dbo.AccountProject.ProjectManagerEmployeeId, 
                      dbo.AccountProject.TimeSheetApprovalTypeId, dbo.AccountProject.ExpenseApprovalTypeId, dbo.AccountProjectTask.IsBillable, 
                      dbo.AccountEmployeeTimeEntry.Rejected, dbo.AccountEmployeeTimeEntry.BillingRate, dbo.AccountProject.ProjectBillingRateTypeId, 
                      dbo.AccountEmployee.EmployeeCode, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountDepartment.DepartmentName, 
                      dbo.AccountProjectTask.EstimatedCost, dbo.AccountProjectTask.EstimatedTimeSpent, dbo.AccountEmployeeTimeEntry.Submitted, 
                      dbo.AccountWorkType.AccountWorkType, dbo.AccountEmployee.EMailAddress, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountCostCenter.AccountCostCenter, dbo.AccountCostCenter.AccountCostCenterCode, dbo.AccountWorkType.AccountWorkTypeCode, 
                      dbo.AccountProject.ProjectCode, dbo.AccountProjectTask.TaskCode, dbo.AccountLocation.AccountLocationId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction.Comments, dbo.AccountEmployeeTimeEntry.BillingRateCurrencyId, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateCurrencyId, dbo.AccountEmployeeTimeEntry.BillingRateExchangeRate, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateExchangeRate, dbo.AccountEmployeeTimeEntry.AccountBaseCurrencyId, 
                      dbo.AccountProjectTask.AccountTaskTypeId, dbo.AccountProjectTask.TaskStatusId, dbo.AccountProjectTask.AccountPriorityId, 
                      dbo.AccountProjectTask.AccountProjectMilestoneId, dbo.AccountDepartment.DepartmentCode, dbo.AccountParty.PartyNick, 
                      dbo.AccountProjectTask.EstimatedCurrencyId, dbo.vueAccountEmployeeTimeEntryApprovalLastAction.ApprovedOn, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRate, dbo.AccountRole.AccountRoleId, dbo.AccountRole.Role, dbo.AccountProject.AccountProjectTypeId, 
                      dbo.AccountProject.ProjectDescription, dbo.AccountProjectTask.TaskDescription, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeExpenseBillingTimesheetId, dbo.AccountEmployeeTimeEntry.Billed, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Submitted = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS SubmittedHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Approved = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS ApprovedHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Rejected = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS RejectedHours, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, 
                      dbo.AccountPartyContact.FirstName + N'' '' + dbo.AccountPartyContact.LastName AS ClientContactName, 
                      dbo.AccountPartyDepartment.PartyDepartmentCode AS ClientDepartmentCode, 
                      dbo.AccountPartyDepartment.PartyDepartmentName AS ClientDepartmentName, 
                      dbo.AccountPartyDepartment.PartyDepartmentLocation AS ClientDepartmentLocation
FROM         dbo.AccountEmployeeTimeEntry INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeEntry.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountTimeOffType ON 
                      dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId LEFT OUTER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountProjectTask ON dbo.AccountEmployeeTimeEntry.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId LEFT OUTER JOIN
                      dbo.AccountPartyDepartment ON 
                      dbo.AccountProject.AccountPartyDepartmentId = dbo.AccountPartyDepartment.AccountPartyDepartmentId LEFT OUTER JOIN
                      dbo.AccountPartyContact ON dbo.AccountProject.AccountPartyContactId = dbo.AccountPartyContact.AccountPartyContactId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryPeriod ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId LEFT
                       OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId LEFT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryApprovalLastAction.AccountEmployeeTimeEntryId LEFT
                       OUTER JOIN
                      dbo.AccountCostCenter ON dbo.AccountEmployeeTimeEntry.AccountCostCenterId = dbo.AccountCostCenter.AccountCostCenterId LEFT OUTER JOIN
                      dbo.AccountWorkType ON dbo.AccountEmployeeTimeEntry.AccountWorkTypeId = dbo.AccountWorkType.AccountWorkTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId LEFT OUTER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId'

GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[MasterHolidayTypeDetail]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[MasterHolidayTypeDetail]'
GO
UPDATE [dbo].[MasterHolidayTypeDetail] SET [HolidayName]=N'New Years Day' WHERE [MasterHolidayTypeDetailId]='0daa9c63-d4e3-448d-b66d-35ae220e8332'
UPDATE [dbo].[MasterHolidayTypeDetail] SET [HolidayName]=N'New Years Day' WHERE [MasterHolidayTypeDetailId]='6eabe9b0-9214-4506-8503-7510b4812ea2'
UPDATE [dbo].[MasterHolidayTypeDetail] SET [HolidayName]=N'New Years Day' WHERE [MasterHolidayTypeDetailId]='69ec49e3-e474-4277-be15-02b1fb8df579'
UPDATE [dbo].[MasterHolidayTypeDetail] SET [HolidayName]=N'Washingtons Birthday' WHERE [MasterHolidayTypeDetailId]='dd36c1aa-da53-4444-9e32-64deda972745'
GO
-- Drop View vueAccountEmployeeTimeEntryWithAccountProjectEmployee
Print 'Drop View vueAccountEmployeeTimeEntryWithAccountProjectEmployee'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithAccountProjectEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryWithAccountProjectEmployee]
GO
-- Drop View vueAccountEmployeeTimeEntryWithAccountProjectRole
Print 'Drop View vueAccountEmployeeTimeEntryWithAccountProjectRole'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithAccountProjectRole' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryWithAccountProjectRole]
GO
-- Drop View vueAccountEmployeeTimeEntry
Print 'Drop View vueAccountEmployeeTimeEntry'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntry' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntry]
GO
-- Create View vueAccountEmployeeTimeEntry
Print 'Create View vueAccountEmployeeTimeEntry'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntry' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntry
AS
SELECT     dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountProject.ProjectName, 
                      CASE WHEN dbo.AccountProjectTask.AccountProjectTaskId IS NOT NULL 
                      THEN dbo.AccountProjectTask.TaskName ELSE AccountTimeOffType.AccountTimeOffType END AS TaskName, 
                      dbo.AccountEmployeeTimeEntry.TotalTime, dbo.AccountEmployeeTimeEntry.Approved, dbo.AccountEmployee.AccountEmployeeId, 
                      dbo.AccountProject.AccountProjectId, dbo.AccountEmployeeTimeEntry.TeamLeadApproved, dbo.AccountEmployeeTimeEntry.ProjectManagerApproved, 
                      dbo.AccountEmployeeTimeEntry.AdministratorApproved, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, 
                      dbo.AccountEmployeeTimeEntry.StartTime, dbo.AccountEmployeeTimeEntry.EndTime, dbo.AccountEmployeeTimeEntry.TimeEntryDate, 
                      dbo.AccountEmployeeTimeEntry.Description, dbo.AccountEmployee.AccountId, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime) AS TotalMinutes, DATEPART(dw, dbo.AccountEmployeeTimeEntry.TimeEntryDate) 
                      AS WeekDay, dbo.AccountParty.AccountPartyId, dbo.AccountParty.PartyName, dbo.AccountProjectTask.AccountProjectTaskId, 
                      dbo.AccountBillingType.BillingType, dbo.AccountProject.LeaderEmployeeId, dbo.AccountProject.ProjectManagerEmployeeId, 
                      dbo.AccountProject.TimeSheetApprovalTypeId, dbo.AccountProject.ExpenseApprovalTypeId, dbo.AccountProjectTask.IsBillable, 
                      dbo.AccountEmployeeTimeEntry.Rejected, dbo.AccountEmployeeTimeEntry.BillingRate, dbo.AccountProject.ProjectBillingRateTypeId, 
                      dbo.AccountEmployee.EmployeeCode, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountDepartment.DepartmentName, 
                      dbo.AccountProjectTask.EstimatedCost, dbo.AccountProjectTask.EstimatedTimeSpent, dbo.AccountEmployeeTimeEntry.Submitted, 
                      dbo.AccountWorkType.AccountWorkType, dbo.AccountEmployee.EMailAddress, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountCostCenter.AccountCostCenter, dbo.AccountCostCenter.AccountCostCenterCode, dbo.AccountWorkType.AccountWorkTypeCode, 
                      dbo.AccountProject.ProjectCode, dbo.AccountProjectTask.TaskCode, dbo.AccountLocation.AccountLocationId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction.Comments, dbo.AccountEmployeeTimeEntry.BillingRateCurrencyId, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateCurrencyId, dbo.AccountEmployeeTimeEntry.BillingRateExchangeRate, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateExchangeRate, dbo.AccountEmployeeTimeEntry.AccountBaseCurrencyId, 
                      dbo.AccountProjectTask.AccountTaskTypeId, dbo.AccountProjectTask.TaskStatusId, dbo.AccountProjectTask.AccountPriorityId, 
                      dbo.AccountProjectTask.AccountProjectMilestoneId, dbo.AccountDepartment.DepartmentCode, dbo.AccountParty.PartyNick, 
                      dbo.AccountProjectTask.EstimatedCurrencyId, dbo.vueAccountEmployeeTimeEntryApprovalLastAction.ApprovedOn, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRate, dbo.AccountRole.AccountRoleId, dbo.AccountRole.Role, dbo.AccountProject.AccountProjectTypeId, 
                      dbo.AccountProject.ProjectDescription, dbo.AccountProjectTask.TaskDescription, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeExpenseBillingTimesheetId, dbo.AccountEmployeeTimeEntry.Billed, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Submitted = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS SubmittedHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Approved = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS ApprovedHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Rejected = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS RejectedHours, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, 
                      dbo.AccountPartyContact.FirstName + N'' '' + dbo.AccountPartyContact.LastName AS ClientContactName, 
                      dbo.AccountPartyDepartment.PartyDepartmentCode AS ClientDepartmentCode, 
                      dbo.AccountPartyDepartment.PartyDepartmentName AS ClientDepartmentName, 
                      dbo.AccountPartyDepartment.PartyDepartmentLocation AS ClientDepartmentLocation, dbo.AccountWorkType.AccountWorkTypeId
FROM         dbo.AccountEmployeeTimeEntry INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeEntry.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountTimeOffType ON 
                      dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId LEFT OUTER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountProjectTask ON dbo.AccountEmployeeTimeEntry.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId LEFT OUTER JOIN
                      dbo.AccountPartyDepartment ON 
                      dbo.AccountProject.AccountPartyDepartmentId = dbo.AccountPartyDepartment.AccountPartyDepartmentId LEFT OUTER JOIN
                      dbo.AccountPartyContact ON dbo.AccountProject.AccountPartyContactId = dbo.AccountPartyContact.AccountPartyContactId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryPeriod ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId LEFT
                       OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId LEFT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryApprovalLastAction.AccountEmployeeTimeEntryId LEFT
                       OUTER JOIN
                      dbo.AccountCostCenter ON dbo.AccountEmployeeTimeEntry.AccountCostCenterId = dbo.AccountCostCenter.AccountCostCenterId LEFT OUTER JOIN
                      dbo.AccountWorkType ON dbo.AccountEmployeeTimeEntry.AccountWorkTypeId = dbo.AccountWorkType.AccountWorkTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId LEFT OUTER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId'
GO
-- Create View vueAccountEmployeeTimeEntryWithAccountProjectRole
Print 'Create View vueAccountEmployeeTimeEntryWithAccountProjectRole'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithAccountProjectRole' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryWithAccountProjectRole
AS
SELECT     dbo.AccountProjectRole.AccountProjectRoleId, dbo.AccountProjectRole.AccountProjectId, dbo.AccountProjectRole.AccountRoleId, 
                      dbo.AccountProjectRole.NumberOfResources, dbo.AccountProjectRole.BillingRate, dbo.AccountProjectRole.BillingTypeId, 
                      dbo.AccountProjectRole.AccountBillingRateId, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeId, dbo.AccountProject.ProjectBillingRateTypeId, 
                      dbo.AccountEmployeeTimeEntry.AccountProjectTaskId, dbo.AccountProjectTask.IsBillable, dbo.AccountEmployeeTimeEntry.AccountWorkTypeId
FROM         dbo.AccountProjectRole INNER JOIN
                      dbo.AccountEmployeeTimeEntry ON dbo.AccountProjectRole.AccountProjectId = dbo.AccountEmployeeTimeEntry.AccountProjectId INNER JOIN
                      dbo.AccountProjectEmployee ON dbo.AccountProjectRole.AccountProjectId = dbo.AccountProjectEmployee.AccountProjectId AND 
                      dbo.AccountProjectRole.AccountRoleId = dbo.AccountProjectEmployee.AccountRoleId INNER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountProjectTask ON dbo.AccountEmployeeTimeEntry.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId'
GO
-- Create View vueAccountEmployeeTimeEntryWithAccountProjectEmployee
Print 'Create View vueAccountEmployeeTimeEntryWithAccountProjectEmployee'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithAccountProjectEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryWithAccountProjectEmployee
AS
SELECT     dbo.AccountProjectEmployee.AccountProjectEmployeeId, dbo.AccountProjectEmployee.AccountId, dbo.AccountProjectEmployee.AccountProjectId, 
                      dbo.AccountProjectEmployee.AccountEmployeeId, dbo.AccountProjectEmployee.TaskCompletedPercentage, 
                      dbo.AccountProjectEmployee.TaskCompleted, dbo.AccountProjectEmployee.AccountRoleId, dbo.AccountProjectEmployee.AccountBillingRateId, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, dbo.AccountProject.ProjectBillingRateTypeId, 
                      dbo.AccountEmployeeTimeEntry.AccountProjectTaskId, dbo.AccountProjectTask.IsBillable, dbo.AccountEmployeeTimeEntry.AccountWorkTypeId
FROM         dbo.AccountProjectEmployee INNER JOIN
                      dbo.AccountEmployeeTimeEntry ON dbo.AccountProjectEmployee.AccountEmployeeId = dbo.AccountEmployeeTimeEntry.AccountEmployeeId AND 
                      dbo.AccountProjectEmployee.AccountProjectId = dbo.AccountEmployeeTimeEntry.AccountProjectId INNER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountProjectTask ON dbo.AccountEmployeeTimeEntry.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId'
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportFilterSourceMapping]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportFilterSourceMapping]'
IF NOT EXISTS (SELECT * FROM [dbo].[SystemReportFilterSourceMapping] WHERE [SystemReportFilterMappingId] = '82956fcd-2984-4789-a5c1-f62722459530')
BEGIN
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('82956fcd-2984-4789-a5c1-f62722459530', '40a2a9c4-d975-4167-91c7-c38fa497c9da', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', 1, 1, 8)
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('9304c3aa-d9d3-45f6-90cc-5aa2e220e077', 'c29a0dd3-3337-43b7-9c3f-abf8e9ae9978', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', 1, 1, 9)
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportFilterSourceMapping]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportFilterSourceMapping]'

UPDATE [dbo].[SystemReportFilterSourceMapping] SET [FilterSequence]=10 WHERE [SystemReportFilterMappingId]='23a2713f-fc3c-4595-b388-3f605bd3e852'
GO
-- Drop View vueAccountEmployeeExpenseSheet
Print 'Drop View vueAccountEmployeeExpenseSheet'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeExpenseSheet' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeExpenseSheet]
GO
-- Create View vueAccountEmployeeExpenseSheet
Print 'Create View vueAccountEmployeeExpenseSheet'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeExpenseSheet' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeExpenseSheet
AS
SELECT     dbo.AccountEmployeeExpenseSheet.AccountEmployeeExpenseSheetId, dbo.AccountEmployeeExpenseSheet.AccountId, 
                      dbo.AccountEmployeeExpenseSheet.AccountEmployeeId, dbo.AccountEmployeeExpenseSheet.Description, 
                      dbo.AccountEmployeeExpenseSheet.ExpenseSheetDate, MAX(dbo.vueAccountCurrency.Currency) AS Currency, 
                      MAX(dbo.vueAccountCurrency.CurrencyCode) AS CurrencyCode, MAX(dbo.vueAccountCurrency.AccountCurrencyId) AS AccountCurrencyId, 
                      CASE WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 0 AND dbo.AccountEmployeeExpenseSheet.Approved = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.Rejected = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.InApproval = 0 THEN ''Not Submitted'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Rejected = 0 THEN ''Approved'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.Rejected = 1 THEN ''Rejected'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 0 AND dbo.AccountEmployeeExpenseSheet.Rejected = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.InApproval = 1 THEN ''Submitted'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 0 AND dbo.AccountEmployeeExpenseSheet.Rejected = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.InApproval = 0 THEN ''Submitted'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 1 THEN ''Not Submitted'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.InApproval = 1 THEN ''Not Submitted'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 1 AND dbo.AccountEmployeeExpenseSheet.Rejected = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.InApproval = 1 THEN ''Approved'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Rejected = 1 THEN ''Submitted'' END AS Status, dbo.AccountEmployeeExpenseSheet.InApproval, 
                      dbo.AccountEmployeeExpenseSheet.Submitted, dbo.AccountEmployeeExpenseSheet.Rejected, dbo.AccountEmployeeExpenseSheet.Approved, 
                      dbo.AccountEmployeeExpenseSheet.SubmittedDate, dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, 
                      dbo.AccountEmployee.EMailAddress, MAX(dbo.vueAccountCurrency.ExchangeRate) AS ExchangeRate, 
                      dbo.AccountEmployeeExpenseSheet.ApprovedOn, dbo.AccountEmployeeExpenseSheet.ApprovedByEmployeeId, 
                      dbo.AccountEmployeeExpenseSheet.RejectedOn, dbo.AccountEmployeeExpenseSheet.RejectedByEmployeeId, 
                      SUM(ISNULL(dbo.vueAccountEmployeeExpenseSheetOnlyAmount.Amount, 0)) AS Amount
FROM         dbo.AccountExpenseEntry INNER JOIN
                      dbo.vueAccountEmployeeExpenseSheetOnlyAmount ON 
                      dbo.AccountExpenseEntry.AccountEmployeeExpenseSheetId = dbo.vueAccountEmployeeExpenseSheetOnlyAmount.AccountEmployeeExpenseSheetId AND
                       dbo.AccountExpenseEntry.AccountExpenseEntryId = dbo.vueAccountEmployeeExpenseSheetOnlyAmount.AccountExpenseEntryId RIGHT OUTER JOIN
                      dbo.AccountEmployeeExpenseSheet INNER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployeeExpenseSheet.AccountId = dbo.AccountPreferences.AccountId INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeExpenseSheet.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId ON 
                      dbo.AccountExpenseEntry.AccountEmployeeExpenseSheetId = dbo.AccountEmployeeExpenseSheet.AccountEmployeeExpenseSheetId LEFT OUTER JOIN
                      dbo.vueAccountCurrency ON dbo.AccountPreferences.AccountBaseCurrencyId = dbo.vueAccountCurrency.AccountCurrencyId
GROUP BY dbo.AccountEmployeeExpenseSheet.AccountEmployeeExpenseSheetId, dbo.AccountEmployeeExpenseSheet.AccountId, 
                      dbo.AccountEmployeeExpenseSheet.AccountEmployeeId, dbo.AccountEmployeeExpenseSheet.Description, 
                      dbo.AccountEmployeeExpenseSheet.ExpenseSheetDate, dbo.AccountEmployeeExpenseSheet.InApproval, 
                      dbo.AccountEmployeeExpenseSheet.Submitted, dbo.AccountEmployeeExpenseSheet.Rejected, dbo.AccountEmployeeExpenseSheet.Approved, 
                      dbo.AccountEmployeeExpenseSheet.SubmittedDate, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, 
                      dbo.AccountEmployee.EMailAddress, dbo.AccountEmployeeExpenseSheet.ApprovedOn, dbo.AccountEmployeeExpenseSheet.ApprovedByEmployeeId, 
                      dbo.AccountEmployeeExpenseSheet.RejectedOn, dbo.AccountEmployeeExpenseSheet.RejectedByEmployeeId'
GO
-- Create View vueTimesheetSequenceForApproval
Print 'Create View vueTimesheetSequenceForApproval'
GO
if not exists (select * from information_schema.tables where table_name = 'vueTimesheetSequenceForApproval' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueTimesheetSequenceForApproval
AS
SELECT     dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId, 
                      dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeId AS TimeEntryAccountEmployeeId, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, dbo.AccountEmployeeTimeEntryApproval.TimeSheetApprovalId, 
                      dbo.AccountApprovalPath.AccountApprovalPathId, dbo.AccountApprovalPath.SystemApproverTypeId, dbo.AccountApprovalPath.AccountExternalUserId, 
                      dbo.AccountApprovalPath.AccountEmployeeId, dbo.AccountApprovalPath.ApprovalPathSequence, dbo.AccountProject.LeaderEmployeeId, 
                      dbo.AccountProject.ProjectManagerEmployeeId, dbo.AccountApprovalType.AccountApprovalTypeId, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountEmployee.EmployeeManagerId, 
                      dbo.AccountProject.AccountProjectId, dbo.AccountEmployeeTimeEntryApproval.IsApproved, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountEmployeeTimeEntryApprovalProject.AccountEmployeeTimeEntryApprovalProjectId, 
                      dbo.AccountEmployeeTimeEntryApproval.PreviousStatus, dbo.AccountEmployeeTimeEntryApproval.IsReject, 
                      dbo.AccountEmployeeTimeEntryApprovalProject.Submitted, dbo.AccountEmployeeTimeEntryApprovalProject.Approved, 
                      dbo.AccountEmployeeTimeEntryApprovalProject.Rejected
FROM         dbo.AccountApprovalType INNER JOIN
                      dbo.AccountEmployeeTimeEntryApprovalProject INNER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntryApprovalProject.AccountProjectId = dbo.AccountProject.AccountProjectId ON 
                      dbo.AccountApprovalType.AccountApprovalTypeId = dbo.AccountProject.TimeSheetApprovalTypeId INNER JOIN
                      dbo.AccountApprovalPath ON dbo.AccountApprovalType.AccountApprovalTypeId = dbo.AccountApprovalPath.AccountApprovalTypeId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryApproval ON dbo.AccountEmployeeTimeEntryApproval.PreviousStatus <> 1 AND 
                      dbo.AccountEmployeeTimeEntryApproval.IsReject <> 1 AND 
                      dbo.AccountApprovalPath.AccountApprovalPathId = dbo.AccountEmployeeTimeEntryApproval.TimeSheetApprovalPathId AND 
                      dbo.AccountEmployeeTimeEntryApprovalProject.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntryApproval.AccountEmployeeTimeEntryPeriodId
                       AND dbo.AccountEmployeeTimeEntryApprovalProject.AccountProjectId = dbo.AccountEmployeeTimeEntryApproval.AccountProjectId RIGHT OUTER JOIN
                      dbo.AccountEmployee RIGHT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryPeriod ON dbo.AccountEmployee.AccountEmployeeId = dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeId ON 
                      dbo.AccountEmployeeTimeEntryApprovalProject.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId'
GO
-- Create View vueTimesheetSummaryForApproval
Print 'Create View vueTimesheetSummaryForApproval'
GO
if not exists (select * from information_schema.tables where table_name = 'vueTimesheetSummaryForApproval' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueTimesheetSummaryForApproval
AS
SELECT     dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId, 
                      dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeId AS TimeEntryAccountEmployeeId, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, dbo.AccountEmployeeTimeEntryApproval.TimeSheetApprovalId, 
                      dbo.AccountApprovalPath.AccountApprovalPathId, dbo.AccountApprovalPath.SystemApproverTypeId, dbo.AccountApprovalPath.AccountExternalUserId, 
                      dbo.AccountApprovalPath.AccountEmployeeId, dbo.AccountApprovalPath.ApprovalPathSequence, dbo.AccountProject.LeaderEmployeeId, 
                      dbo.AccountProject.ProjectManagerEmployeeId, dbo.AccountApprovalType.AccountApprovalTypeId, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountEmployee.EmployeeManagerId, 
                      dbo.AccountProject.AccountProjectId, dbo.AccountEmployeeTimeEntryApproval.IsApproved, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountEmployeeTimeEntryApprovalProject.AccountEmployeeTimeEntryApprovalProjectId, 
                      dbo.AccountEmployeeTimeEntryApproval.PreviousStatus, dbo.AccountEmployeeTimeEntryApproval.IsReject, 
                      dbo.AccountEmployeeTimeEntryApprovalProject.Submitted, dbo.AccountEmployeeTimeEntryApprovalProject.Approved, 
                      dbo.AccountEmployeeTimeEntryApprovalProject.Rejected
FROM         dbo.AccountApprovalType INNER JOIN
                      dbo.AccountEmployeeTimeEntryApprovalProject INNER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntryApprovalProject.AccountProjectId = dbo.AccountProject.AccountProjectId ON 
                      dbo.AccountApprovalType.AccountApprovalTypeId = dbo.AccountProject.TimeSheetApprovalTypeId INNER JOIN
                      dbo.AccountApprovalPath ON dbo.AccountApprovalType.AccountApprovalTypeId = dbo.AccountApprovalPath.AccountApprovalTypeId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryApproval ON dbo.AccountEmployeeTimeEntryApproval.PreviousStatus <> 1 AND 
                      dbo.AccountEmployeeTimeEntryApproval.IsReject <> 1 AND 
                      dbo.AccountApprovalPath.AccountApprovalPathId = dbo.AccountEmployeeTimeEntryApproval.TimeSheetApprovalPathId AND 
                      dbo.AccountEmployeeTimeEntryApprovalProject.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntryApproval.AccountEmployeeTimeEntryPeriodId
                       AND dbo.AccountEmployeeTimeEntryApprovalProject.AccountProjectId = dbo.AccountEmployeeTimeEntryApproval.AccountProjectId RIGHT OUTER JOIN
                      dbo.AccountEmployee RIGHT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryPeriod ON dbo.AccountEmployee.AccountEmployeeId = dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeId ON 
                      dbo.AccountEmployeeTimeEntryApprovalProject.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId'
GO
-- Create View vueTimesheetSummaryPendingForApproval
Print 'Create View vueTimesheetSummaryPendingForApproval'
GO
if not exists (select * from information_schema.tables where table_name = 'vueTimesheetSummaryPendingForApproval' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueTimesheetSummaryPendingForApproval
AS
SELECT     AccountEmployeeTimeEntryPeriodId, TimeEntryAccountEmployeeId, TimeEntryStartDate, TimeEntryEndDate, TimeEntryViewType, Submitted, 
                      Approved, Rejected, MAX(TimeSheetApprovalId) AS TimeSheetApprovalId, AccountApprovalPathId, SystemApproverTypeId, AccountExternalUserId, 
                      AccountEmployeeId, ApprovalPathSequence, LeaderEmployeeId, ProjectManagerEmployeeId, AccountApprovalTypeId, EmployeeName, 
                      EmployeeManagerId, AccountProjectId, 
                      CASE WHEN systemapprovertypeid = 1 THEN LeaderEmployeeId WHEN systemapprovertypeid = 2 THEN ProjectManagerEmployeeId WHEN systemapprovertypeid
                       = 3 THEN AccountEmployeeId WHEN systemapprovertypeid = 4 THEN AccountExternalUserId WHEN systemapprovertypeid = 5 THEN EmployeeManagerId
                       END AS ApproverEmployeeId, IsApproved, EMailAddress, AccountEmployeeTimeEntryApprovalProjectId
FROM         dbo.vueTimesheetSummaryForApproval
WHERE     (AccountApprovalPathId IN
                          (SELECT     TOP 1 AccountApprovalPathId
                            FROM          dbo.vueTimesheetSequenceForApproval
                            WHERE      (TimeSheetApprovalId IS NULL) AND (AccountProjectId = dbo.vueTimesheetSummaryForApproval.AccountProjectId) AND 
                                                   (AccountEmployeeTimeEntryPeriodId = dbo.vueTimesheetSummaryForApproval.AccountEmployeeTimeEntryPeriodId)))
GROUP BY AccountEmployeeTimeEntryPeriodId, TimeEntryAccountEmployeeId, TimeEntryStartDate, TimeEntryEndDate, TimeEntryViewType, Submitted, 
                      Approved, Rejected, AccountApprovalPathId, SystemApproverTypeId, AccountExternalUserId, AccountEmployeeId, ApprovalPathSequence, 
                      LeaderEmployeeId, ProjectManagerEmployeeId, AccountApprovalTypeId, EmployeeName, EmployeeManagerId, AccountProjectId, IsApproved, 
                      EMailAddress, AccountEmployeeTimeEntryApprovalProjectId'
GO
-- Drop View vueAccountEmployeeTimeEntryApprovalPendingForTimeOff
Print 'Drop View vueAccountEmployeeTimeEntryApprovalPendingForTimeOff'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryApprovalPendingForTimeOff' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryApprovalPendingForTimeOff]
GO
-- Drop View vueAccountEmployeeTimeEntryApprovalForTimeOff
Print 'Drop View vueAccountEmployeeTimeEntryApprovalForTimeOff'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryApprovalForTimeOff' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryApprovalForTimeOff]
GO
-- Create View vueAccountEmployeeTimeEntryApprovalForTimeOff
Print 'Create View vueAccountEmployeeTimeEntryApprovalForTimeOff'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryApprovalForTimeOff' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff
AS
SELECT     dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, dbo.AccountEmployeeTimeEntry.AccountEmployeeId AS TimeEntryAccountEmployeeId, 
                      dbo.AccountEmployeeTimeEntry.TimeEntryDate, dbo.AccountEmployeeTimeEntry.StartTime, dbo.AccountEmployeeTimeEntry.EndTime, 
                      dbo.AccountEmployeeTimeEntry.TotalTime, dbo.AccountEmployeeTimeEntry.Description, dbo.AccountEmployeeTimeEntry.Approved, 
                      dbo.AccountEmployeeTimeEntry.AdministratorApproved, dbo.AccountEmployeeTimeEntry.CreatedOn, dbo.AccountEmployeeTimeEntry.Rejected, 
                      dbo.AccountEmployeeTimeEntry.Submitted, dbo.AccountEmployeeTimeEntry.IsTimeOff, dbo.AccountEmployeeTimeEntry.Hours, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeOffRequestId, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountApprovalType.ApprovalTypeName, 
                      dbo.AccountApprovalType.AccountApprovalTypeId, dbo.AccountApprovalPath.AccountApprovalPathId, dbo.AccountApprovalPath.SystemApproverTypeId, 
                      dbo.AccountApprovalPath.AccountExternalUserId, dbo.AccountApprovalPath.ApprovalPathSequence, dbo.AccountApprovalPath.AccountEmployeeId, 
                      dbo.AccountEmployee.EmployeeManagerId, dbo.AccountEmployeeTimeEntry.ModifiedOn, 
                      dbo.AccountEmployeeTimeEntryApproval.TimeSheetApprovalId, dbo.AccountEmployeeTimeEntryApproval.ApprovedByEmployeeId, 
                      dbo.AccountEmployeeTimeEntryApproval.Comments, dbo.AccountEmployeeTimeEntryApproval.IsReject, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountTimeOffType.AccountTimeOffType, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, 
                      dbo.AccountEmployeeTimeEntry.TotalTime) AS TotalMinutes, dbo.AccountEmployeeTimeEntryApproval.IsApproved, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId
FROM         dbo.AccountEmployeeTimeEntry INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeEntry.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId INNER JOIN
                      dbo.AccountApprovalType ON dbo.AccountEmployee.TimeOffApprovalTypeId = dbo.AccountApprovalType.AccountApprovalTypeId INNER JOIN
                      dbo.AccountApprovalPath ON dbo.AccountApprovalType.AccountApprovalTypeId = dbo.AccountApprovalPath.AccountApprovalTypeId LEFT OUTER JOIN
                      dbo.AccountTimeOffType ON 
                      dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryApproval ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId = dbo.AccountEmployeeTimeEntryApproval.AccountEmployeeTimeEntryId AND 
                      dbo.AccountApprovalType.AccountApprovalTypeId = dbo.AccountEmployeeTimeEntryApproval.TimeSheetApprovalTypeId
WHERE     (dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeOffRequestId IS NULL) AND (dbo.AccountEmployeeTimeEntry.IsTimeOff = 1)'
GO
-- Create View vueAccountEmployeeTimeEntryApprovalPendingForTimeOff
Print 'Create View vueAccountEmployeeTimeEntryApprovalPendingForTimeOff'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryApprovalPendingForTimeOff' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryApprovalPendingForTimeOff
AS
SELECT     dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountEmployeeTimeEntryId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountEmployeeId, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.TimeEntryDate, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.StartTime, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.EndTime, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.TotalTime, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Description, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Approved, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AdministratorApproved, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.CreatedOn, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Rejected, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Submitted, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.IsTimeOff, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Hours, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountTimeOffTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountEmployeeTimeOffRequestId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.ApprovalTypeName, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountApprovalPathId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.SystemApproverTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountExternalUserId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.ApprovalPathSequence, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.EmployeeManagerId, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.ModifiedOn, 
                      MAX(dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.TimeSheetApprovalId) AS TimeSheetApprovalId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.ApprovedByEmployeeId, 
                      MAX(dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Comments) AS Comments, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.IsReject, dbo.vueAccountApproverType.MaxApprovalPathSequence, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.TimeEntryAccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.EmployeeName, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.EMailAddress, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountTimeOffType, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.TotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.IsApproved, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountEmployeeTimeEntryPeriodId
FROM         dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff LEFT OUTER JOIN
                      dbo.vueAccountApproverType ON 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountApprovalTypeId = dbo.vueAccountApproverType.AccountApprovalTypeId
WHERE     (dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountApprovalPathId IN
                          (SELECT     TOP 1 AccountApprovalPathId
                            FROM          dbo.vueTimeSheetApprovalSequenceForTimeOff
                            WHERE      (TimeSheetApprovalId IS NULL) AND 
                                                   (AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountEmployeeTimeEntryId))) AND 
                      (dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Approved = 0) AND 
                      (dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Rejected IS NULL OR
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Rejected = 0) AND (dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Submitted = 1)
GROUP BY dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountEmployeeTimeEntryId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountEmployeeId, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.TimeEntryDate, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.StartTime, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.EndTime, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.TotalTime, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Description, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Approved, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AdministratorApproved, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.CreatedOn, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Rejected, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Submitted, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.IsTimeOff, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Hours, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountTimeOffTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountEmployeeTimeOffRequestId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.ApprovalTypeName, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountApprovalPathId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.SystemApproverTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountExternalUserId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.ApprovalPathSequence, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.EmployeeManagerId, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.ModifiedOn, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.ApprovedByEmployeeId, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.IsReject, 
                      dbo.vueAccountApproverType.MaxApprovalPathSequence, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.TimeEntryAccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.EmployeeName, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.EMailAddress, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountTimeOffType, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.TotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.IsApproved, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountEmployeeTimeEntryPeriodId'
GO
-- Drop View vueProjectSummary
Print 'Drop View vueProjectSummary'
GO
if exists (select * from information_schema.tables where table_name = 'vueProjectSummary' and table_type = 'VIEW' and table_schema = 'dbo')
DROP VIEW [dbo].[vueProjectSummary]
GO
-- Drop View vueAccountEmployeeTimeEntry
Print 'Drop View vueAccountEmployeeTimeEntry'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntry' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntry]
GO
-- Create View vueAccountEmployeeTimeEntry
Print 'Create View vueAccountEmployeeTimeEntry'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntry' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntry
AS
SELECT     dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountProject.ProjectName, 
                      CASE WHEN dbo.AccountProjectTask.AccountProjectTaskId IS NOT NULL 
                      THEN dbo.AccountProjectTask.TaskName ELSE AccountTimeOffType.AccountTimeOffType END AS TaskName, 
                      dbo.AccountEmployeeTimeEntry.TotalTime, dbo.AccountEmployeeTimeEntry.Approved, dbo.AccountEmployee.AccountEmployeeId, 
                      dbo.AccountProject.AccountProjectId, dbo.AccountEmployeeTimeEntry.TeamLeadApproved, dbo.AccountEmployeeTimeEntry.ProjectManagerApproved, 
                      dbo.AccountEmployeeTimeEntry.AdministratorApproved, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, 
                      dbo.AccountEmployeeTimeEntry.StartTime, dbo.AccountEmployeeTimeEntry.EndTime, dbo.AccountEmployeeTimeEntry.TimeEntryDate, 
                      dbo.AccountEmployeeTimeEntry.Description, dbo.AccountEmployee.AccountId, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime) AS TotalMinutes, DATEPART(dw, dbo.AccountEmployeeTimeEntry.TimeEntryDate) 
                      AS WeekDay, dbo.AccountParty.AccountPartyId, dbo.AccountParty.PartyName, dbo.AccountProjectTask.AccountProjectTaskId, 
                      dbo.AccountBillingType.BillingType, dbo.AccountProject.LeaderEmployeeId, dbo.AccountProject.ProjectManagerEmployeeId, 
                      dbo.AccountProject.TimeSheetApprovalTypeId, dbo.AccountProject.ExpenseApprovalTypeId, dbo.AccountProjectTask.IsBillable, 
                      dbo.AccountEmployeeTimeEntry.Rejected, dbo.AccountEmployeeTimeEntry.BillingRate, dbo.AccountProject.ProjectBillingRateTypeId, 
                      dbo.AccountEmployee.EmployeeCode, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountDepartment.DepartmentName, 
                      dbo.AccountProjectTask.EstimatedCost, dbo.AccountProjectTask.EstimatedTimeSpent, dbo.AccountEmployeeTimeEntry.Submitted, 
                      dbo.AccountWorkType.AccountWorkType, dbo.AccountEmployee.EMailAddress, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountCostCenter.AccountCostCenter, dbo.AccountCostCenter.AccountCostCenterCode, dbo.AccountWorkType.AccountWorkTypeCode, 
                      dbo.AccountProject.ProjectCode, dbo.AccountProjectTask.TaskCode, dbo.AccountLocation.AccountLocationId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction.Comments, dbo.AccountEmployeeTimeEntry.BillingRateCurrencyId, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateCurrencyId, dbo.AccountEmployeeTimeEntry.BillingRateExchangeRate, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateExchangeRate, dbo.AccountEmployeeTimeEntry.AccountBaseCurrencyId, 
                      dbo.AccountProjectTask.AccountTaskTypeId, dbo.AccountProjectTask.TaskStatusId, dbo.AccountProjectTask.AccountPriorityId, 
                      dbo.AccountProjectTask.AccountProjectMilestoneId, dbo.AccountDepartment.DepartmentCode, dbo.AccountParty.PartyNick, 
                      dbo.AccountProjectTask.EstimatedCurrencyId, dbo.vueAccountEmployeeTimeEntryApprovalLastAction.ApprovedOn, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRate, dbo.AccountRole.AccountRoleId, dbo.AccountRole.Role, dbo.AccountProject.AccountProjectTypeId, 
                      dbo.AccountProject.ProjectDescription, dbo.AccountProjectTask.TaskDescription, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeExpenseBillingTimesheetId, dbo.AccountEmployeeTimeEntry.Billed, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Submitted = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS SubmittedHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Approved = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS ApprovedHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Rejected = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS RejectedHours, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, 
                      dbo.AccountPartyContact.FirstName + N'' '' + dbo.AccountPartyContact.LastName AS ClientContactName, 
                      dbo.AccountPartyDepartment.PartyDepartmentCode AS ClientDepartmentCode, 
                      dbo.AccountPartyDepartment.PartyDepartmentName AS ClientDepartmentName, 
                      dbo.AccountPartyDepartment.PartyDepartmentLocation AS ClientDepartmentLocation, dbo.AccountWorkType.AccountWorkTypeId, 
                      dbo.AccountEmployeeTimeEntry.IsTimeOff, dbo.AccountEmployeeTimeEntry.Hours, dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeOffRequestId
FROM         dbo.AccountEmployeeTimeEntry INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeEntry.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountTimeOffType ON 
                      dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId LEFT OUTER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountProjectTask ON dbo.AccountEmployeeTimeEntry.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId LEFT OUTER JOIN
                      dbo.AccountPartyDepartment ON 
                      dbo.AccountProject.AccountPartyDepartmentId = dbo.AccountPartyDepartment.AccountPartyDepartmentId LEFT OUTER JOIN
                      dbo.AccountPartyContact ON dbo.AccountProject.AccountPartyContactId = dbo.AccountPartyContact.AccountPartyContactId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryPeriod ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId LEFT
                       OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId LEFT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryApprovalLastAction.AccountEmployeeTimeEntryId LEFT
                       OUTER JOIN
                      dbo.AccountCostCenter ON dbo.AccountEmployeeTimeEntry.AccountCostCenterId = dbo.AccountCostCenter.AccountCostCenterId LEFT OUTER JOIN
                      dbo.AccountWorkType ON dbo.AccountEmployeeTimeEntry.AccountWorkTypeId = dbo.AccountWorkType.AccountWorkTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId LEFT OUTER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId'
GO
-- Create View vueProjectSummary
Print 'Create View vueProjectSummary'
GO
if not exists (select * from information_schema.tables where table_name = 'vueProjectSummary' and table_type = 'VIEW' and table_schema = 'dbo') 
EXEC sp_executesql N'
CREATE  VIEW [dbo].[vueProjectSummary]
AS
SELECT     ProjectName, EmployeeName, TaskName, TotalTime, AccountEmployeeId, AccountProjectId, TimeEntryDate,
AccountId, AccountPartyId, PartyName, AccountProjectTaskId, TotalMinutes / 60 AS TotalMinutes, Approved
FROM         dbo.vueAccountEmployeeTimeEntry
WHERE     (IsTimeOff IS NULL) OR
                      (IsTimeOff = 0)'
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportFilterSource]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportFilterSource]'
IF NOT EXISTS (SELECT * FROM [dbo].[SystemReportFilterSource] WHERE [SystemReportFilterSourceId] = '8f5c5a03-c05c-4b9d-baf9-3fce76e2371b')
BEGIN
INSERT INTO [dbo].[SystemReportFilterSource] ([SystemReportFilterSourceId], [SystemReportFilterSource], [ClassName], [ClassFunction], [ParameterName1], [Caption], [FilterSourceType], [FilterSource], [FilterOperator], [IsOptional], [FilterField], [ParentFilterSource]) VALUES ('8f5c5a03-c05c-4b9d-baf9-3fce76e2371b', N'WorkType', NULL, NULL, NULL, N'Work Type:', NULL, NULL, N'=', 1, N'AccountWorkTypeId', NULL)
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportFilterSourceMapping]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportFilterSourceMapping]'
IF NOT EXISTS (SELECT * FROM [dbo].[SystemReportFilterSourceMapping] WHERE [SystemReportFilterMappingId] = 'ecda90ee-f79d-42e7-af40-0a99954e7c29')
BEGIN
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('ecda90ee-f79d-42e7-af40-0a99954e7c29', '8f5c5a03-c05c-4b9d-baf9-3fce76e2371b', '3a080202-6842-4eca-8c79-a945978810b4', 1, 1, 9)
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportFilterSourceMapping]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportFilterSourceMapping]'

UPDATE [dbo].[SystemReportFilterSourceMapping] SET [FilterSequence]=14 WHERE [SystemReportFilterMappingId]='a6282f2c-97e3-4ad2-beef-a7b4c96655a2'
UPDATE [dbo].[SystemReportFilterSourceMapping] SET [FilterSequence]=11 WHERE [SystemReportFilterMappingId]='040adb46-8f90-451b-a8f8-53022a151d50'
UPDATE [dbo].[SystemReportFilterSourceMapping] SET [FilterSequence]=10 WHERE [SystemReportFilterMappingId]='cf407089-f92f-4924-9352-796769259ff5'
UPDATE [dbo].[SystemReportFilterSourceMapping] SET [FilterSequence]=12 WHERE [SystemReportFilterMappingId]='00ded0d1-06a4-48a8-921d-41d134d06065'
UPDATE [dbo].[SystemReportFilterSourceMapping] SET [FilterSequence]=13 WHERE [SystemReportFilterMappingId]='8cd491d6-5339-403d-9d22-dc07469ebee0'
UPDATE [dbo].[SystemReportFilterSourceMapping] SET [FilterSequence]=16 WHERE [SystemReportFilterMappingId]='0674aee1-52b3-456c-acb7-890e73f8898c'
UPDATE [dbo].[SystemReportFilterSourceMapping] SET [FilterSequence]=15 WHERE [SystemReportFilterMappingId]='c633f4fa-0039-44aa-8838-acbb6676c6d2'

GO
-- Drop View vueAccountEmployeeTimeEntryWithTimeOffForReport
Print 'Drop View vueAccountEmployeeTimeEntryWithTimeOffForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithTimeOffForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryWithTimeOffForReport]
GO
-- Drop View rptvueAccountEmployeeTimeEntry
Print 'Drop View rptvueAccountEmployeeTimeEntry'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeEntry' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountEmployeeTimeEntry]
GO
-- Drop View vueAccountEmployeeTimeEntryForReport
Print 'Drop View vueAccountEmployeeTimeEntryForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryForReport]
GO
-- Create View vueAccountEmployeeTimeEntryWithTimeOffForReport
Print 'Create View vueAccountEmployeeTimeEntryWithTimeOffForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithTimeOffForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport
AS
SELECT     dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountProject.ProjectName, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 1 THEN dbo.AccountProjectTask.TaskName ELSE dbo.AccountTimeOffType.AccountTimeOffType
                       END AS TaskName, dbo.AccountEmployeeTimeEntry.TotalTime, dbo.AccountEmployeeTimeEntry.Approved, dbo.AccountEmployee.AccountEmployeeId, 
                      dbo.AccountProject.AccountProjectId, dbo.AccountEmployeeTimeEntry.TeamLeadApproved, dbo.AccountEmployeeTimeEntry.ProjectManagerApproved, 
                      dbo.AccountEmployeeTimeEntry.AdministratorApproved, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, 
                      dbo.AccountEmployeeTimeEntry.StartTime, dbo.AccountEmployeeTimeEntry.EndTime, dbo.AccountEmployeeTimeEntry.TimeEntryDate, 
                      dbo.AccountEmployeeTimeEntry.Description, ISNULL(dbo.AccountProject.AccountId, dbo.AccountTimeOffType.AccountId) AS AccountId, DATEPART(hh, 
                      dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime) AS TotalMinutes, DATEPART(dw, 
                      dbo.AccountEmployeeTimeEntry.TimeEntryDate) AS WeekDay, dbo.AccountParty.AccountPartyId, dbo.AccountParty.PartyName, 
                      dbo.AccountProjectTask.AccountProjectTaskId, dbo.AccountBillingType.BillingType, dbo.AccountProject.LeaderEmployeeId, 
                      dbo.AccountProject.ProjectManagerEmployeeId, dbo.AccountProject.TimeSheetApprovalTypeId, dbo.AccountProject.ExpenseApprovalTypeId, 
                      dbo.AccountProjectTask.IsBillable, dbo.AccountEmployeeTimeEntry.Rejected, dbo.AccountEmployeeTimeEntry.BillingRate, 
                      dbo.AccountProject.ProjectBillingRateTypeId, dbo.AccountEmployee.EmployeeCode, dbo.AccountEmployee.AccountDepartmentId, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountProjectTask.EstimatedCost, dbo.AccountProjectTask.EstimatedTimeSpent, 
                      dbo.AccountEmployeeTimeEntry.Submitted, dbo.AccountWorkType.AccountWorkType, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountLocation.AccountLocation, dbo.AccountCostCenter.AccountCostCenter, dbo.AccountCostCenter.AccountCostCenterCode, 
                      dbo.AccountWorkType.AccountWorkTypeCode, dbo.AccountProject.ProjectCode, dbo.AccountProjectTask.TaskCode, 
                      dbo.AccountLocation.AccountLocationId, dbo.vueAccountEmployeeTimeEntryApprovalLastAction.Comments, 
                      dbo.AccountEmployeeTimeEntry.BillingRateCurrencyId, dbo.AccountEmployeeTimeEntry.EmployeeRateCurrencyId, 
                      dbo.AccountEmployeeTimeEntry.BillingRateExchangeRate, dbo.AccountEmployeeTimeEntry.EmployeeRateExchangeRate, 
                      dbo.AccountEmployeeTimeEntry.AccountBaseCurrencyId, dbo.AccountProjectTask.AccountTaskTypeId, dbo.AccountProjectTask.TaskStatusId, 
                      dbo.AccountProjectTask.AccountPriorityId, dbo.AccountProjectTask.AccountProjectMilestoneId, dbo.AccountDepartment.DepartmentCode, 
                      dbo.AccountParty.PartyNick, dbo.AccountProjectTask.EstimatedCurrencyId, dbo.vueAccountEmployeeTimeEntryApprovalLastAction.ApprovedOn, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRate, dbo.AccountRole.AccountRoleId, dbo.AccountRole.Role, dbo.AccountProject.AccountProjectTypeId, 
                      dbo.AccountProject.ProjectDescription, dbo.AccountProjectTask.TaskDescription, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeExpenseBillingTimesheetId, dbo.AccountEmployeeTimeEntry.Billed, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Submitted = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS SubmittedHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Approved = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS ApprovedHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Rejected = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS RejectedHours, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, 
                      dbo.AccountPartyContact.FirstName + N'' '' + dbo.AccountPartyContact.LastName AS ClientContactName, 
                      dbo.AccountPartyDepartment.PartyDepartmentCode AS ClientDepartmentCode, 
                      dbo.AccountPartyDepartment.PartyDepartmentName AS ClientDepartmentName, 
                      dbo.AccountPartyDepartment.PartyDepartmentLocation AS ClientDepartmentLocation, dbo.AccountEmployeeTimeEntry.IsTimeOff, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId, CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 0 THEN ROUND(CONVERT(float, 
                      DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) 
                      END AS TimeOffHours, CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 1 THEN ROUND(CONVERT(float, DATEPART(hh, 
                      dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS TimesheetHours, 
                      dbo.AccountWorkType.AccountWorkTypeId
FROM         dbo.AccountEmployeeTimeEntry INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeEntry.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountTimeOffType ON 
                      dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId LEFT OUTER JOIN
                      dbo.AccountProjectTask ON dbo.AccountEmployeeTimeEntry.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId LEFT OUTER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountPartyDepartment ON 
                      dbo.AccountProject.AccountPartyDepartmentId = dbo.AccountPartyDepartment.AccountPartyDepartmentId LEFT OUTER JOIN
                      dbo.AccountPartyContact ON dbo.AccountProject.AccountPartyContactId = dbo.AccountPartyContact.AccountPartyContactId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryPeriod ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId LEFT
                       OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId LEFT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryApprovalLastAction.AccountEmployeeTimeEntryId LEFT
                       OUTER JOIN
                      dbo.AccountCostCenter ON dbo.AccountEmployeeTimeEntry.AccountCostCenterId = dbo.AccountCostCenter.AccountCostCenterId LEFT OUTER JOIN
                      dbo.AccountWorkType ON dbo.AccountEmployeeTimeEntry.AccountWorkTypeId = dbo.AccountWorkType.AccountWorkTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId LEFT OUTER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId'
GO
-- Create View vueAccountEmployeeTimeEntryForReport
Print 'Create View vueAccountEmployeeTimeEntryForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryForReport
AS
SELECT     dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeName, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskName, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalTime, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Approved, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TeamLeadApproved, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectManagerApproved, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AdministratorApproved, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeTimeEntryId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.StartTime, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EndTime, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Description, N'''') AS Description, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.WeekDay, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountPartyId AS AccountClientId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.PartyName AS ClientName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectTaskId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingType, N'''') AS BillingType, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectManagerEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ExpenseApprovalTypeId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.IsBillable, 0) AS IsBillable, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Rejected, 0) AS Rejected, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRate, 0) AS BillingRate, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectBillingRateTypeId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeCode, N'''') AS EmployeeCode, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountDepartmentId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.DepartmentName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedCost, 0) AS EstimatedCost, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedTimeSpent, 0) AS EstimatedHours, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Submitted, 0) AS Submitted, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountWorkType, N'''') AS AccountWorkType, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EMailAddress, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountLocation, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountCostCenter, N'''') AS AccountCostCenter, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountCostCenterCode, N'''') AS AccountCostCenterCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountWorkTypeCode, N'''') AS AccountWorkTypeCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectCode, N'''') AS ProjectCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCode, N'''') AS TaskCode, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountLocationId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Comments, N'''') AS ApproverComments, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes * dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRate
                       / 60, 0) AS Amount, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRateCurrencyId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateExchangeRate, 0) AS BillingRateExchangeRate, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRateExchangeRate, 0) AS EmployeeRateExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountBaseCurrencyId, 
                      dbo.vueAccountCurrency.CurrencyCode AS BillingRateCurrencyCode, dbo.vueAccountCurrency.CurrencyCode AS AmountCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountTaskTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskStatusId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountPriorityId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectMilestoneId, dbo.AccountTaskType.TaskType, 
                      dbo.AccountStatus.Status AS TaskStatus, dbo.AccountProjectMilestone.MilestoneDescription, dbo.AccountPriority.Priority, ROUND(CONVERT(float, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes) / 60, 2) AS TotalHours, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.DepartmentCode, N'''') AS DepartmentCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.PartyNick, N'''') AS ClientNick, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedCurrencyId, vueAccountCurrency_1.CurrencyCode AS EstimatedCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ApprovedOn, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRate, 0) AS EmployeeRate, 
                      vueAccountCurrency_2.CurrencyCode AS EmployeeRateCurrencyCode, 
                      AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName AS TeamLeader, 
                      AccountEmployee_2.FirstName + '' '' + AccountEmployee_2.LastName AS ProjectManager, 
                      ISNULL(dbo.AccountEmployee.FirstName + N'' '' + dbo.AccountEmployee.LastName, N'''') AS EmployeeManager, 
                      vueAccountCurrency_1.ExchangeRate AS EstimatedCurrencyExchangeRate, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes * dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRate
                       / 60, 0) AS EmployeeCost, { fn DAYOFMONTH(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) } AS DayNo, 
                      MONTH(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) AS MonthNo, DATEPART(week, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) - DATEPART(week, DATEADD(month, DATEDIFF(month, 0, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate), 0)) + 1 AS WeekNo, 
                      YEAR(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) AS Year, 
                      LEFT({ fn MONTHNAME(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) }, 3) + '' - '' + CONVERT(nvarchar(10), 
                      YEAR(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate)) AS Period, 
                      { fn DAYNAME(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) } AS WeekDayName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountRoleId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Role, 
                      dbo.AccountProjectType.ProjectType, dbo.AccountRole.Role AS ProjectRole, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectDescription, N'''') AS ProjectDescription, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskDescription, N'''') AS TaskDescription, 
                      dbo.AccountTimeExpenseBilling.InvoiceNumber, dbo.AccountTimeExpenseBilling.InvoiceDate, dbo.AccountProjectType.AccountProjectTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Billed, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeTimeEntryPeriodId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientContactName, N'''') AS ClientContactName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentCode, N'''') AS ClientDepartmentCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentName, N'''') AS ClientDepartmentName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentLocation, N'''') AS ClientDepartmentLocation, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.IsTimeOff, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountWorkTypeId
FROM         dbo.AccountRole INNER JOIN
                      dbo.AccountProjectEmployee ON dbo.AccountRole.AccountRoleId = dbo.AccountProjectEmployee.AccountRoleId RIGHT OUTER JOIN
                      dbo.AccountTimeExpenseBillingTimesheet INNER JOIN
                      dbo.AccountTimeExpenseBilling ON 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingId = dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId RIGHT OUTER
                       JOIN
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport LEFT OUTER JOIN
                      dbo.AccountProjectType ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectTypeId = dbo.AccountProjectType.AccountProjectTypeId LEFT OUTER JOIN
                      dbo.AccountProjectMilestone ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectMilestoneId = dbo.AccountProjectMilestone.AccountProjectMilestoneId LEFT OUTER
                       JOIN
                      dbo.AccountStatus ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskStatusId = dbo.AccountStatus.AccountStatusId LEFT OUTER JOIN
                      dbo.AccountPriority ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountPriorityId = dbo.AccountPriority.AccountPriorityId LEFT OUTER JOIN
                      dbo.AccountTaskType ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountTaskTypeId = dbo.AccountTaskType.AccountTaskTypeId ON
                       dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingTimesheetId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountTimeExpenseBillingTimesheetId
                       ON dbo.AccountProjectEmployee.AccountEmployeeId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeId AND 
                      dbo.AccountProjectEmployee.AccountProjectId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.LeaderEmployeeId = AccountEmployee_1.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_2 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectManagerEmployeeId = AccountEmployee_2.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.AccountEmployee AS AccountEmployee_3 ON dbo.AccountEmployee.AccountEmployeeId = AccountEmployee_3.EmployeeManagerId ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeId = AccountEmployee_3.AccountEmployeeId LEFT OUTER JOIN
                      dbo.vueAccountCurrency AS vueAccountCurrency_2 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRateCurrencyId = vueAccountCurrency_2.AccountCurrencyId LEFT OUTER JOIN
                      dbo.vueAccountCurrency AS vueAccountCurrency_1 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedCurrencyId = vueAccountCurrency_1.AccountCurrencyId LEFT OUTER JOIN
                      dbo.vueAccountCurrency ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateCurrencyId = dbo.vueAccountCurrency.AccountCurrencyId'
GO
-- Create View rptvueAccountEmployeeTimeEntry
Print 'Create View rptvueAccountEmployeeTimeEntry'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeEntry' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountEmployeeTimeEntry
AS
SELECT     dbo.vueAccountEmployeeTimeEntryForReport.EmployeeName, dbo.vueAccountEmployeeTimeEntryForReport.ProjectName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskName, dbo.vueAccountEmployeeTimeEntryForReport.TotalTime, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Approved, dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectId, dbo.vueAccountEmployeeTimeEntryForReport.TeamLeadApproved, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManagerApproved, dbo.vueAccountEmployeeTimeEntryForReport.AdministratorApproved, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeTimeEntryId, dbo.vueAccountEmployeeTimeEntryForReport.StartTime, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EndTime, dbo.vueAccountEmployeeTimeEntryForReport.TimeEntryDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Description, dbo.vueAccountEmployeeTimeEntryForReport.AccountId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TotalMinutes, dbo.vueAccountEmployeeTimeEntryForReport.WeekDay, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientName, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectTaskId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingType, dbo.vueAccountEmployeeTimeEntryForReport.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManagerEmployeeId, dbo.vueAccountEmployeeTimeEntryForReport.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ExpenseApprovalTypeId, dbo.vueAccountEmployeeTimeEntryForReport.IsBillable, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Rejected, dbo.vueAccountEmployeeTimeEntryForReport.BillingRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectBillingRateTypeId, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountDepartmentId, dbo.vueAccountEmployeeTimeEntryForReport.DepartmentName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCost, dbo.vueAccountEmployeeTimeEntryForReport.EstimatedHours, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Submitted, dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkType, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EMailAddress, dbo.vueAccountEmployeeTimeEntryForReport.AccountLocation, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountCostCenter, dbo.vueAccountEmployeeTimeEntryForReport.AccountCostCenterCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkTypeCode, dbo.vueAccountEmployeeTimeEntryForReport.ProjectCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCode, dbo.vueAccountEmployeeTimeEntryForReport.AccountLocationId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ApproverComments, dbo.vueAccountEmployeeTimeEntryForReport.Amount, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingRateCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountBaseCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.BillingRateCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AmountCurrencyCode, CASE WHEN vueAccountEmployeeTimeEntryForReport.Submitted = 1 AND 
                      vueAccountEmployeeTimeEntryForReport.Approved = 0 THEN ''Submitted'' WHEN vueAccountEmployeeTimeEntryForReport.Approved = 1 THEN ''Approved''
                       WHEN vueAccountEmployeeTimeEntryForReport.Rejected = 1 THEN ''Rejected'' WHEN vueAccountEmployeeTimeEntryForReport.Submitted = 0 AND 
                      vueAccountEmployeeTimeEntryForReport.Approved = 0 AND 
                      vueAccountEmployeeTimeEntryForReport.Rejected = 0 THEN ''Not Submitted'' END AS ApprovalStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountTaskTypeId, dbo.vueAccountEmployeeTimeEntryForReport.TaskStatusId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountPriorityId, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectMilestoneId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskType, dbo.vueAccountEmployeeTimeEntryForReport.TaskStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.MilestoneDescription, dbo.vueAccountEmployeeTimeEntryForReport.Priority, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TotalHours, dbo.vueAccountEmployeeTimeEntryForReport.DepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientNick, dbo.vueAccountEmployeeTimeEntryForReport.AccountClientId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ApprovedOn, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateCurrencyCode, dbo.vueAccountEmployeeTimeEntryForReport.TeamLeader, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManager, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeManager, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate, 0) AS EstimatedCurrencyExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCost, dbo.vueAccountEmployeeTimeEntryForReport.AccountRoleId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Role, dbo.vueAccountEmployeeTimeEntryForReport.WeekDayName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Period, dbo.vueAccountEmployeeTimeEntryForReport.Year, 
                      dbo.vueAccountEmployeeTimeEntryForReport.WeekNo, dbo.vueAccountEmployeeTimeEntryForReport.MonthNo, 
                      dbo.vueAccountEmployeeTimeEntryForReport.DayNo, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 1 THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours ELSE 0 END AS
                       BillableTotalHours, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable
                       IS NULL THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours ELSE 0 END AS NonBillableTotalHours, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCost
                       / dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate ELSE 0 END AS CurrencyEmployeeCost, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.Amount / dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate
                       ELSE 0 END AS CurrencyAmount, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCost
                       / dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate ELSE 0 END AS CurrencyEstimatedCost, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate
                       / dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate ELSE 0 END AS CurrencyBillingRate, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRate
                       / dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate ELSE 0 END AS CurrencyEmployeeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectRole, dbo.vueAccountEmployeeTimeEntryForReport.ProjectType, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectDescription, dbo.vueAccountEmployeeTimeEntryForReport.TaskDescription, 
                      dbo.vueAccountEmployeeTimeEntryForReport.InvoiceNumber, dbo.vueAccountEmployeeTimeEntryForReport.InvoiceDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectTypeId, dbo.vueAccountEmployeeTimeEntryForReport.Billed, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientContactName, dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentName, dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentLocation, 
                      dbo.vueAccountEmployeeTimeEntryForReport.IsTimeOff, dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkTypeId
FROM         dbo.vueAccountEmployeeTimeEntryForReport INNER JOIN
                      dbo.vueAccountEmployeeTimeEntryWithLastStatus ON 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryWithLastStatus.AccountEmployeeTimeEntryId'
GO
-- Drop View vueAccountEmployeeExpenseSheet
Print 'Drop View vueAccountEmployeeExpenseSheet'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeExpenseSheet' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeExpenseSheet]
GO
-- Create View vueAccountEmployeeExpenseSheet
Print 'Create View vueAccountEmployeeExpenseSheet'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeExpenseSheet' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeExpenseSheet
AS
SELECT     dbo.AccountEmployeeExpenseSheet.AccountEmployeeExpenseSheetId, dbo.AccountEmployeeExpenseSheet.AccountId, 
                      dbo.AccountEmployeeExpenseSheet.AccountEmployeeId, dbo.AccountEmployeeExpenseSheet.Description, 
                      dbo.AccountEmployeeExpenseSheet.ExpenseSheetDate, MAX(dbo.vueAccountCurrency.Currency) AS Currency, 
                      MAX(dbo.vueAccountCurrency.CurrencyCode) AS CurrencyCode, MAX(dbo.vueAccountCurrency.AccountCurrencyId) AS AccountCurrencyId, 
                      CASE WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 0 AND dbo.AccountEmployeeExpenseSheet.Approved = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.Rejected = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.InApproval = 0 THEN ''Not Submitted'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Rejected = 0 THEN ''Approved'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.Rejected = 1 THEN ''Rejected'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 0 AND dbo.AccountEmployeeExpenseSheet.Rejected = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.InApproval = 1 THEN ''Submitted'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 0 AND dbo.AccountEmployeeExpenseSheet.Rejected = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.InApproval = 0 THEN ''Submitted'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 1 THEN ''Not Submitted'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.InApproval = 1 THEN ''Not Submitted'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 1 AND dbo.AccountEmployeeExpenseSheet.Rejected = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.InApproval = 1 THEN ''Approved'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Rejected = 1 THEN ''Submitted'' END AS Status, dbo.AccountEmployeeExpenseSheet.InApproval, 
                      dbo.AccountEmployeeExpenseSheet.Submitted, dbo.AccountEmployeeExpenseSheet.Rejected, dbo.AccountEmployeeExpenseSheet.Approved, 
                      dbo.AccountEmployeeExpenseSheet.SubmittedDate, dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, 
                      dbo.AccountEmployee.EMailAddress, MAX(dbo.vueAccountCurrency.ExchangeRate) AS ExchangeRate, 
                      dbo.AccountEmployeeExpenseSheet.ApprovedOn, dbo.AccountEmployeeExpenseSheet.ApprovedByEmployeeId, 
                      dbo.AccountEmployeeExpenseSheet.RejectedOn, dbo.AccountEmployeeExpenseSheet.RejectedByEmployeeId, 
                      SUM(ISNULL(dbo.vueAccountEmployeeExpenseSheetOnlyAmount.Amount * dbo.vueAccountCurrency.ExchangeRate, 0)) AS Amount
FROM         dbo.AccountExpenseEntry INNER JOIN
                      dbo.vueAccountEmployeeExpenseSheetOnlyAmount ON 
                      dbo.AccountExpenseEntry.AccountEmployeeExpenseSheetId = dbo.vueAccountEmployeeExpenseSheetOnlyAmount.AccountEmployeeExpenseSheetId AND
                       dbo.AccountExpenseEntry.AccountExpenseEntryId = dbo.vueAccountEmployeeExpenseSheetOnlyAmount.AccountExpenseEntryId RIGHT OUTER JOIN
                      dbo.AccountEmployeeExpenseSheet INNER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployeeExpenseSheet.AccountId = dbo.AccountPreferences.AccountId INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeExpenseSheet.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId ON 
                      dbo.AccountExpenseEntry.AccountEmployeeExpenseSheetId = dbo.AccountEmployeeExpenseSheet.AccountEmployeeExpenseSheetId LEFT OUTER JOIN
                      dbo.vueAccountCurrency ON dbo.AccountPreferences.AccountBaseCurrencyId = dbo.vueAccountCurrency.AccountCurrencyId
GROUP BY dbo.AccountEmployeeExpenseSheet.AccountEmployeeExpenseSheetId, dbo.AccountEmployeeExpenseSheet.AccountId, 
                      dbo.AccountEmployeeExpenseSheet.AccountEmployeeId, dbo.AccountEmployeeExpenseSheet.Description, 
                      dbo.AccountEmployeeExpenseSheet.ExpenseSheetDate, dbo.AccountEmployeeExpenseSheet.InApproval, 
                      dbo.AccountEmployeeExpenseSheet.Submitted, dbo.AccountEmployeeExpenseSheet.Rejected, dbo.AccountEmployeeExpenseSheet.Approved, 
                      dbo.AccountEmployeeExpenseSheet.SubmittedDate, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, 
                      dbo.AccountEmployee.EMailAddress, dbo.AccountEmployeeExpenseSheet.ApprovedOn, dbo.AccountEmployeeExpenseSheet.ApprovedByEmployeeId, 
                      dbo.AccountEmployeeExpenseSheet.RejectedOn, dbo.AccountEmployeeExpenseSheet.RejectedByEmployeeId'
GO
-- Drop View rptvueAccountEmployees
Print 'Drop View rptvueAccountEmployees'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployees' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountEmployees]
GO
-- Drop View vueAccountEmployeesForReport
Print 'Drop View vueAccountEmployeesForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeesForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeesForReport]

GO
-- Create View vueAccountEmployeesForReport
Print 'Create View vueAccountEmployeesForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeesForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeesForReport
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.Password, dbo.AccountEmployee.Prefix, dbo.AccountEmployee.FirstName, 
                      dbo.AccountEmployee.LastName, ISNULL(dbo.AccountEmployee.MiddleName, N'''') AS MiddleName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountEmployee.AccountId, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountRoleId, dbo.AccountEmployee.AccountLocationId, 
                      ISNULL(dbo.AccountEmployee.Notes, N'''') AS Notes, ISNULL(dbo.AccountEmployee.AddressLine1, N'''') AS AddressLine1, ISNULL(dbo.AccountEmployee.AddressLine2, 
                      N'''') AS AddressLine2, ISNULL(dbo.AccountEmployee.State, N'''') AS State, ISNULL(dbo.AccountEmployee.City, N'''') AS City, ISNULL(dbo.AccountEmployee.Zip, N'''') 
                      AS Zip, dbo.AccountEmployee.CountryId, ISNULL(dbo.AccountEmployee.HomePhoneNo, N'''') AS HomePhoneNo, ISNULL(dbo.AccountEmployee.WorkPhoneNo, N'''') 
                      AS WorkPhoneNo, ISNULL(dbo.AccountEmployee.MobilePhoneNo, N'''') AS MobilePhoneNo, dbo.AccountEmployee.TimeEntryApprovalPathId, 
                      dbo.AccountEmployee.BillingRateStateDate, dbo.AccountEmployee.BillingTypeId, dbo.AccountEmployee.StartDate, dbo.AccountEmployee.TerminationDate, 
                      dbo.AccountEmployee.StatusId, dbo.AccountEmployee.IsDeleted, dbo.AccountEmployee.IsDisabled, dbo.AccountEmployee.DefaultProjectId, 
                      dbo.AccountEmployee.TimeZoneId, dbo.AccountEmployee.DefaultEmployee, dbo.AccountEmployee.CreatedOn, dbo.AccountEmployee.CreatedByEmployeeId, 
                      dbo.AccountEmployee.ModifiedOn, dbo.AccountEmployee.ModifiedByEmployeeId, dbo.AccountEmployee.AllowedAccessFromIP, 
                      dbo.AccountEmployee.ExternalUserClientId, dbo.AccountEmployee.EmployeeTypeId, dbo.AccountEmployee.AccountBillingRateId, dbo.AccountEmployee.Username, 
                      ISNULL(dbo.AccountEmployee.EmployeeCode, N'''') AS EmployeeCode, dbo.AccountEmployee.EmployeeManagerId, 
                      dbo.AccountEmployee.FirstName + N'' '' + dbo.AccountEmployee.LastName AS EmployeeName, ISNULL(dbo.AccountDepartment.DepartmentCode, N'''') 
                      AS DepartmentCode, dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountLocation.AccountLocation, ISNULL(dbo.SystemCountry.Country, N'''') 
                      AS Country, ISNULL(AccountEmployee_1.FirstName + N'' '' + AccountEmployee_1.LastName, N'''') AS EmployeeManager, 
                      ISNULL(dbo.vueAccountWorkTypeBillingRate.AccountWorkTypeCode, N'''') AS AccountWorkTypeCode, ISNULL(dbo.vueAccountWorkTypeBillingRate.AccountWorkType, 
                      N'''') AS AccountWorkType, ISNULL(dbo.vueAccountWorkTypeBillingRate.BillingRate, 0) AS BillingRate, ISNULL(dbo.vueAccountWorkTypeBillingRate.EmployeeRate, 0) 
                      AS EmployeeRate, dbo.vueAccountWorkTypeBillingRate.EmployeeRateCurrencyCode, dbo.vueAccountWorkTypeBillingRate.BillingRateCurrencyCode, 
                      dbo.AccountEmployee.HiredDate, ISNULL(dbo.AccountStatus.Status, N'''') AS EmployeeStatus
FROM         dbo.AccountEmployee INNER JOIN
                      dbo.Account ON dbo.AccountEmployee.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId AND 
                      dbo.Account.AccountId = dbo.AccountDepartment.AccountId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId AND dbo.Account.AccountId = dbo.AccountRole.AccountId INNER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId AND 
                      dbo.Account.AccountId = dbo.AccountLocation.AccountId INNER JOIN
                      dbo.SystemCountry ON dbo.AccountEmployee.CountryId = dbo.SystemCountry.CountryId LEFT OUTER JOIN
                      dbo.AccountStatus ON dbo.AccountEmployee.StatusId = dbo.AccountStatus.AccountStatusId AND 
                      dbo.Account.AccountId = dbo.AccountStatus.AccountId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON dbo.Account.AccountId = AccountEmployee_1.AccountId AND 
                      dbo.AccountEmployee.EmployeeManagerId = AccountEmployee_1.AccountEmployeeId LEFT OUTER JOIN
                      dbo.vueAccountWorkTypeBillingRate ON dbo.Account.AccountId = dbo.vueAccountWorkTypeBillingRate.AccountId AND 
                      dbo.AccountEmployee.AccountEmployeeId = dbo.vueAccountWorkTypeBillingRate.AccountEmployeeId
WHERE     (dbo.AccountEmployee.EmployeeTypeId IS NULL)'

GO
-- Create View rptvueAccountEmployees
Print 'Create View rptvueAccountEmployees'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployees' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountEmployees
AS
SELECT     AccountEmployeeId, Password, Prefix, FirstName, LastName, MiddleName, EMailAddress, AccountId, AccountDepartmentId, AccountRoleId, AccountLocationId, Notes, 
                      AddressLine1, AddressLine2, State, City, Zip, CountryId, HomePhoneNo, WorkPhoneNo, MobilePhoneNo, TimeEntryApprovalPathId, BillingRateStateDate, 
                      BillingTypeId, StartDate, TerminationDate, StatusId, IsDeleted, IsDisabled, DefaultProjectId, TimeZoneId, DefaultEmployee, CreatedOn, CreatedByEmployeeId, 
                      ModifiedOn, ModifiedByEmployeeId, AllowedAccessFromIP, ExternalUserClientId, EmployeeTypeId, AccountBillingRateId, Username, EmployeeCode, 
                      EmployeeManagerId, EmployeeName, DepartmentCode, DepartmentName, Role, AccountLocation, Country, ISNULL(EmployeeManager, '''') AS EmployeeManager, 
                      AccountWorkTypeCode, AccountWorkType, BillingRate, EmployeeRate, EmployeeRateCurrencyCode, BillingRateCurrencyCode, HiredDate, EmployeeStatus
FROM         dbo.vueAccountEmployeesForReport
WHERE     (dbo.vueAccountEmployeesForReport.IsDeleted <> 1)'

GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'
If Not Exists(Select * from [dbo].[SystemReportDataSourceField] where [SystemReportDataSourceFieldId] = '9d5ae4b4-2da4-4c17-b179-c1eef3a6ad26')
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('9d5ae4b4-2da4-4c17-b179-c1eef3a6ad26', '14428dea-801b-4f8e-b2e3-afa8cb644ac8', N'EmployeeStatus', 125, 0, NULL, NULL, 25, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Employee Status', 0, 0)

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportFilterSourceMapping]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportFilterSourceMapping]'
IF NOT EXISTS (SELECT * FROM [dbo].[SystemReportFilterSourceMapping] WHERE [SystemReportFilterMappingId] = '91b37ffe-90b1-4b46-a933-0facc5a4417a')
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('91b37ffe-90b1-4b46-a933-0facc5a4417a', '8e41ac07-9d13-450a-b8b2-f37db3eeb32e', '14428dea-801b-4f8e-b2e3-afa8cb644ac8', 0, 0, 4)

GO
-- Drop View rptvueAccountEmployeeTimeEntry
Print 'Drop View rptvueAccountEmployeeTimeEntry'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeEntry' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountEmployeeTimeEntry]

GO
-- Drop View vueAccountProjectsForReport
Print 'Drop View vueAccountProjectsForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountProjectsForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountProjectsForReport]

GO
-- Drop View rptvueAccountProjects
Print 'Drop View rptvueAccountProjects'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountProjects' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountProjects]

GO
-- Drop View rptvueAccountProjectsReport
Print 'Drop View rptvueAccountProjectsReport'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectsReport' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountProjectsReport]

GO
-- Create View rptvueAccountEmployeeTimeEntry
Print 'Create View rptvueAccountEmployeeTimeEntry'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeEntry' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountEmployeeTimeEntry
AS
SELECT     dbo.vueAccountEmployeeTimeEntryForReport.EmployeeName, dbo.vueAccountEmployeeTimeEntryForReport.ProjectName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskName, dbo.vueAccountEmployeeTimeEntryForReport.TotalTime, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Approved, dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectId, dbo.vueAccountEmployeeTimeEntryForReport.TeamLeadApproved, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManagerApproved, dbo.vueAccountEmployeeTimeEntryForReport.AdministratorApproved, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeTimeEntryId, dbo.vueAccountEmployeeTimeEntryForReport.StartTime, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EndTime, dbo.vueAccountEmployeeTimeEntryForReport.TimeEntryDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Description, dbo.vueAccountEmployeeTimeEntryForReport.AccountId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TotalMinutes, dbo.vueAccountEmployeeTimeEntryForReport.WeekDay, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientName, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectTaskId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingType, dbo.vueAccountEmployeeTimeEntryForReport.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManagerEmployeeId, dbo.vueAccountEmployeeTimeEntryForReport.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ExpenseApprovalTypeId, dbo.vueAccountEmployeeTimeEntryForReport.IsBillable, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Rejected, dbo.vueAccountEmployeeTimeEntryForReport.BillingRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectBillingRateTypeId, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountDepartmentId, dbo.vueAccountEmployeeTimeEntryForReport.DepartmentName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCost, dbo.vueAccountEmployeeTimeEntryForReport.EstimatedHours, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Submitted, dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkType, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EMailAddress, dbo.vueAccountEmployeeTimeEntryForReport.AccountLocation, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountCostCenter, dbo.vueAccountEmployeeTimeEntryForReport.AccountCostCenterCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkTypeCode, dbo.vueAccountEmployeeTimeEntryForReport.ProjectCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCode, dbo.vueAccountEmployeeTimeEntryForReport.AccountLocationId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ApproverComments, dbo.vueAccountEmployeeTimeEntryForReport.Amount, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingRateCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountBaseCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.BillingRateCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AmountCurrencyCode, CASE WHEN vueAccountEmployeeTimeEntryForReport.Submitted = 1 AND 
                      vueAccountEmployeeTimeEntryForReport.Approved = 0 THEN ''Submitted'' WHEN vueAccountEmployeeTimeEntryForReport.Approved = 1 THEN ''Approved'' WHEN vueAccountEmployeeTimeEntryForReport.Rejected
                       = 1 THEN ''Rejected'' WHEN vueAccountEmployeeTimeEntryForReport.Submitted = 0 AND vueAccountEmployeeTimeEntryForReport.Approved = 0 AND 
                      vueAccountEmployeeTimeEntryForReport.Rejected = 0 THEN ''Not Submitted'' END AS ApprovalStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountTaskTypeId, dbo.vueAccountEmployeeTimeEntryForReport.TaskStatusId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountPriorityId, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectMilestoneId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskType, dbo.vueAccountEmployeeTimeEntryForReport.TaskStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.MilestoneDescription, dbo.vueAccountEmployeeTimeEntryForReport.Priority, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TotalHours, dbo.vueAccountEmployeeTimeEntryForReport.DepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientNick, dbo.vueAccountEmployeeTimeEntryForReport.AccountClientId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ApprovedOn, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateCurrencyCode, dbo.vueAccountEmployeeTimeEntryForReport.TeamLeader, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManager, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeManager, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate, 0) AS EstimatedCurrencyExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCost, dbo.vueAccountEmployeeTimeEntryForReport.AccountRoleId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Role, dbo.vueAccountEmployeeTimeEntryForReport.WeekDayName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Period, dbo.vueAccountEmployeeTimeEntryForReport.Year, dbo.vueAccountEmployeeTimeEntryForReport.WeekNo, 
                      dbo.vueAccountEmployeeTimeEntryForReport.MonthNo, dbo.vueAccountEmployeeTimeEntryForReport.DayNo, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 1 THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours ELSE 0 END AS BillableTotalHours,
                       CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable
                       IS NULL THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours ELSE 0 END AS NonBillableTotalHours, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCost / dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate
                       ELSE 0 END AS CurrencyEmployeeCost, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.Amount / dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate
                       ELSE 0 END AS CurrencyAmount, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCost / dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate
                       ELSE 0 END AS CurrencyEstimatedCost, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate / dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate
                       ELSE 0 END AS CurrencyBillingRate, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRate / dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate
                       ELSE 0 END AS CurrencyEmployeeRate, dbo.vueAccountEmployeeTimeEntryForReport.ProjectRole, dbo.vueAccountEmployeeTimeEntryForReport.ProjectType, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectDescription, dbo.vueAccountEmployeeTimeEntryForReport.TaskDescription, 
                      dbo.vueAccountEmployeeTimeEntryForReport.InvoiceNumber, dbo.vueAccountEmployeeTimeEntryForReport.InvoiceDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectTypeId, dbo.vueAccountEmployeeTimeEntryForReport.Billed, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientContactName, dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentName, dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentLocation, 
                      dbo.vueAccountEmployeeTimeEntryForReport.IsTimeOff, dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkTypeId,
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 1 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate * dbo.vueAccountEmployeeTimeEntryForReport.TotalHours
                       ELSE 0 END AS BillableTotalAmount, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate * dbo.vueAccountEmployeeTimeEntryForReport.TotalHours
                       ELSE 0 END AS NonBillableTotalAmount
FROM         dbo.vueAccountEmployeeTimeEntryForReport INNER JOIN
                      dbo.vueAccountEmployeeTimeEntryWithLastStatus ON 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryWithLastStatus.AccountEmployeeTimeEntryId'

GO
-- Create View vueAccountProjectsForReport
Print 'Create View vueAccountProjectsForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountProjectsForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountProjectsForReport
AS
SELECT     dbo.vueAccountProjectsOnlyForReport.AccountProjectId, dbo.vueAccountProjectsOnlyForReport.AccountId, 
                      dbo.vueAccountProjectsOnlyForReport.AccountProjectTypeId, dbo.vueAccountProjectsOnlyForReport.AccountClientId, 
                      dbo.vueAccountProjectsOnlyForReport.ProjectBillingTypeId, dbo.vueAccountProjectsOnlyForReport.ProjectName, 
                      dbo.vueAccountProjectsOnlyForReport.ProjectDescription, dbo.vueAccountProjectsOnlyForReport.StartDate, 
                      dbo.vueAccountProjectsOnlyForReport.AccountMilestoneId, dbo.vueAccountProjectsOnlyForReport.Deadline, 
                      dbo.vueAccountProjectsOnlyForReport.LeaderEmployeeId, dbo.vueAccountProjectsOnlyForReport.ProjectManagerEmployeeId, 
                      dbo.vueAccountProjectsOnlyForReport.EstimatedTime, dbo.vueAccountProjectsOnlyForReport.EstimatedDurationUnit, 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.ProjectCode, N'''') AS ProjectCode, dbo.vueAccountProjectsOnlyForReport.DefaultBillingRate, 
                      dbo.vueAccountProjectsOnlyForReport.IsActive, dbo.vueAccountProjectsOnlyForReport.ProjectStatusId, dbo.vueAccountProjectsOnlyForReport.AccountPriorityId, 
                      dbo.vueAccountProjectsOnlyForReport.CreatedOn, dbo.vueAccountProjectsOnlyForReport.CreatedByEmployeeId, dbo.vueAccountProjectsOnlyForReport.ModifiedOn, 
                      dbo.vueAccountProjectsOnlyForReport.ModifiedByEmployeeId, dbo.vueAccountProjectsOnlyForReport.ProjectBillingRateTypeId, 
                      dbo.vueAccountProjectsOnlyForReport.TimeSheetApprovalTypeId, dbo.vueAccountProjectsOnlyForReport.ExpenseApprovalTypeId, 
                      dbo.vueAccountProjectsOnlyForReport.IsDisabled, dbo.vueAccountProjectsOnlyForReport.IsTemplate, dbo.vueAccountProjectsOnlyForReport.IsProject, 
                      dbo.vueAccountProjectsOnlyForReport.AccountProjectTemplateId, ISNULL(dbo.vueAccountProjectsOnlyForReport.ClientNick, N'''') AS ClientNick, 
                      dbo.vueAccountProjectsOnlyForReport.ClientName, dbo.vueAccountProjectsOnlyForReport.ProjectType, dbo.vueAccountProjectsOnlyForReport.BillingType, 
                      dbo.vueAccountProjectsOnlyForReport.Status, 
                      dbo.vueAccountProjectsOnlyForReport.EstimatedDuration + '' - '' + dbo.vueAccountProjectsOnlyForReport.EstimatedDurationUnit AS EstimatedDuration, 
                      dbo.vueAccountProjectsOnlyForReport.AccountClientContactId, dbo.vueAccountProjectsOnlyForReport.AccountClientDepartmentId, 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.ClientDepartmentCode, N'''') AS ClientDepartmentCode, 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.ClientDepartmentName, N'''') AS ClientDepartmentName, 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.ClientDepartmentLocation, N'''') AS ClientDepartmentLocation, 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.ExpenseApprovalTypeName, N'''') AS ExpenseApprovalTypeName, 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.TimesheetApprovalTypeName, N'''') AS TimesheetApprovalTypeName, 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.ClientContactName, N'''') AS ClientContactName, dbo.vueAccountProjectsOnlyForReport.TeamLead, 
                      dbo.vueAccountProjectsOnlyForReport.ProjectManager, dbo.vueAccountProjectsOnlyForReport.ProjectBillingRateType, 
                      ISNULL(SUM(dbo.rptvueAccountEmployeeTimeEntry.BillableTotalHours), 0) AS BillableTotalHours, 
                      ISNULL(SUM(dbo.rptvueAccountEmployeeTimeEntry.NonBillableTotalHours), 0) AS NonBillableTotalHours, SUM(dbo.rptvueAccountEmployeeTimeEntry.EmployeeCost) 
                      AS TotalEmployeeCost, ISNULL(SUM(dbo.rptvueAccountEmployeeTimeEntry.Amount), 0) AS TotalTimeAmount, 
                      ISNULL(SUM(dbo.rptvueAccountEmployeeTimeEntry.TotalHours), 0) AS TotalHours, ISNULL(SUM(dbo.rptvueAccountEmployeeTimeEntry.BillableTotalAmount), 0) 
                      AS BillableTimeAmount, ISNULL(SUM(dbo.rptvueAccountEmployeeTimeEntry.NonBillableTotalAmount), 0) AS NonBillableTimeAmount, 
                      ISNULL(SUM(CASE WHEN dbo.rptvueAccountEmployeeTimeEntry.Billed = 1 THEN dbo.rptvueAccountEmployeeTimeEntry.Amount ELSE 0 END), 0) 
                      AS BilledTimeAmount
FROM         dbo.vueAccountProjectsOnlyForReport LEFT OUTER JOIN
                      dbo.rptvueAccountEmployeeTimeEntry ON dbo.vueAccountProjectsOnlyForReport.AccountProjectId = dbo.rptvueAccountEmployeeTimeEntry.AccountProjectId
GROUP BY dbo.vueAccountProjectsOnlyForReport.AccountProjectId, dbo.vueAccountProjectsOnlyForReport.AccountId, 
                      dbo.vueAccountProjectsOnlyForReport.AccountProjectTypeId, dbo.vueAccountProjectsOnlyForReport.AccountClientId, 
                      dbo.vueAccountProjectsOnlyForReport.ProjectBillingTypeId, dbo.vueAccountProjectsOnlyForReport.ProjectName, 
                      dbo.vueAccountProjectsOnlyForReport.ProjectDescription, dbo.vueAccountProjectsOnlyForReport.StartDate, 
                      dbo.vueAccountProjectsOnlyForReport.AccountMilestoneId, dbo.vueAccountProjectsOnlyForReport.Deadline, 
                      dbo.vueAccountProjectsOnlyForReport.LeaderEmployeeId, dbo.vueAccountProjectsOnlyForReport.ProjectManagerEmployeeId, 
                      dbo.vueAccountProjectsOnlyForReport.EstimatedTime, dbo.vueAccountProjectsOnlyForReport.EstimatedDurationUnit, 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.ProjectCode, N''''), dbo.vueAccountProjectsOnlyForReport.DefaultBillingRate, 
                      dbo.vueAccountProjectsOnlyForReport.IsActive, dbo.vueAccountProjectsOnlyForReport.ProjectStatusId, dbo.vueAccountProjectsOnlyForReport.AccountPriorityId, 
                      dbo.vueAccountProjectsOnlyForReport.CreatedOn, dbo.vueAccountProjectsOnlyForReport.CreatedByEmployeeId, dbo.vueAccountProjectsOnlyForReport.ModifiedOn, 
                      dbo.vueAccountProjectsOnlyForReport.ModifiedByEmployeeId, dbo.vueAccountProjectsOnlyForReport.ProjectBillingRateTypeId, 
                      dbo.vueAccountProjectsOnlyForReport.TimeSheetApprovalTypeId, dbo.vueAccountProjectsOnlyForReport.ExpenseApprovalTypeId, 
                      dbo.vueAccountProjectsOnlyForReport.IsDisabled, dbo.vueAccountProjectsOnlyForReport.IsTemplate, dbo.vueAccountProjectsOnlyForReport.IsProject, 
                      dbo.vueAccountProjectsOnlyForReport.AccountProjectTemplateId, ISNULL(dbo.vueAccountProjectsOnlyForReport.ClientNick, N''''), 
                      dbo.vueAccountProjectsOnlyForReport.ClientName, dbo.vueAccountProjectsOnlyForReport.ProjectType, dbo.vueAccountProjectsOnlyForReport.BillingType, 
                      dbo.vueAccountProjectsOnlyForReport.Status, 
                      dbo.vueAccountProjectsOnlyForReport.EstimatedDuration + '' - '' + dbo.vueAccountProjectsOnlyForReport.EstimatedDurationUnit, 
                      dbo.vueAccountProjectsOnlyForReport.AccountClientContactId, dbo.vueAccountProjectsOnlyForReport.AccountClientDepartmentId, 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.ClientDepartmentCode, N''''), ISNULL(dbo.vueAccountProjectsOnlyForReport.ClientDepartmentName, N''''), 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.ClientDepartmentLocation, N''''), ISNULL(dbo.vueAccountProjectsOnlyForReport.ExpenseApprovalTypeName, N''''), 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.TimesheetApprovalTypeName, N''''), ISNULL(dbo.vueAccountProjectsOnlyForReport.ClientContactName, N''''), 
                      dbo.vueAccountProjectsOnlyForReport.TeamLead, dbo.vueAccountProjectsOnlyForReport.ProjectManager, 
                      dbo.vueAccountProjectsOnlyForReport.ProjectBillingRateType'

GO
-- Create View rptvueAccountProjects
Print 'Create View rptvueAccountProjects'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountProjects' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountProjects
AS
SELECT     dbo.vueAccountProjectsForReport.AccountProjectId, dbo.vueAccountProjectsForReport.AccountId, dbo.vueAccountProjectsForReport.AccountProjectTypeId, 
                      dbo.vueAccountProjectsForReport.AccountClientId, dbo.vueAccountProjectsForReport.ProjectBillingTypeId, dbo.vueAccountProjectsForReport.ProjectName, 
                      dbo.vueAccountProjectsForReport.ProjectDescription, dbo.vueAccountProjectsForReport.StartDate, dbo.vueAccountProjectsForReport.AccountMilestoneId, 
                      dbo.vueAccountProjectsForReport.Deadline, dbo.vueAccountProjectsForReport.LeaderEmployeeId, dbo.vueAccountProjectsForReport.ProjectManagerEmployeeId, 
                      dbo.vueAccountProjectsForReport.EstimatedTime, dbo.vueAccountProjectsForReport.EstimatedDurationUnit, dbo.vueAccountProjectsForReport.ProjectCode, 
                      dbo.vueAccountProjectsForReport.DefaultBillingRate, dbo.vueAccountProjectsForReport.IsActive, dbo.vueAccountProjectsForReport.ProjectStatusId, 
                      dbo.vueAccountProjectsForReport.AccountPriorityId, dbo.vueAccountProjectsForReport.CreatedOn, dbo.vueAccountProjectsForReport.CreatedByEmployeeId, 
                      dbo.vueAccountProjectsForReport.ModifiedOn, dbo.vueAccountProjectsForReport.ModifiedByEmployeeId, dbo.vueAccountProjectsForReport.ProjectBillingRateTypeId, 
                      dbo.vueAccountProjectsForReport.TimeSheetApprovalTypeId, dbo.vueAccountProjectsForReport.ExpenseApprovalTypeId, 
                      dbo.vueAccountProjectsForReport.IsDisabled, dbo.vueAccountProjectsForReport.IsTemplate, dbo.vueAccountProjectsForReport.IsProject, 
                      dbo.vueAccountProjectsForReport.AccountProjectTemplateId, dbo.vueAccountProjectsForReport.ClientNick, dbo.vueAccountProjectsForReport.ClientName, 
                      dbo.vueAccountProjectsForReport.ProjectType, dbo.vueAccountProjectsForReport.BillingType, dbo.vueAccountProjectsForReport.Status, 
                      dbo.vueAccountProjectsForReport.EstimatedDuration, dbo.vueAccountProjectsForReport.AccountClientContactId, 
                      dbo.vueAccountProjectsForReport.AccountClientDepartmentId, dbo.vueAccountProjectsForReport.ClientDepartmentCode, 
                      dbo.vueAccountProjectsForReport.ClientDepartmentName, dbo.vueAccountProjectsForReport.ClientDepartmentLocation, 
                      dbo.vueAccountProjectsForReport.ExpenseApprovalTypeName, dbo.vueAccountProjectsForReport.TimesheetApprovalTypeName, 
                      dbo.vueAccountProjectsForReport.ClientContactName, dbo.vueAccountProjectsForReport.TeamLead, dbo.vueAccountProjectsForReport.ProjectManager, 
                      dbo.vueAccountProjectsForReport.ProjectBillingRateType, dbo.vueAccountProjectsForReport.BillableTotalHours, 
                      dbo.vueAccountProjectsForReport.NonBillableTotalHours, dbo.vueAccountProjectsForReport.TotalEmployeeCost, SUM(dbo.rptvueAccountProjectTasks.EstimatedCost) 
                      AS TotalTaskEstimatedCost, SUM(dbo.rptvueAccountProjectTasks.EstimatedHours) AS TotalTaskEstimatedHours, dbo.vueAccountProjectsForReport.TotalHours, 
                      dbo.vueAccountProjectsForReport.BillableTimeAmount, dbo.vueAccountProjectsForReport.NonBillableTimeAmount, 
                      dbo.vueAccountProjectsForReport.TotalTimeAmount, dbo.vueAccountProjectsForReport.BilledTimeAmount
FROM         dbo.vueAccountProjectsForReport LEFT OUTER JOIN
                      dbo.rptvueAccountProjectTasks ON dbo.vueAccountProjectsForReport.AccountProjectId = dbo.rptvueAccountProjectTasks.AccountProjectId
GROUP BY dbo.vueAccountProjectsForReport.AccountProjectId, dbo.vueAccountProjectsForReport.AccountId, dbo.vueAccountProjectsForReport.AccountProjectTypeId, 
                      dbo.vueAccountProjectsForReport.AccountClientId, dbo.vueAccountProjectsForReport.ProjectBillingTypeId, dbo.vueAccountProjectsForReport.ProjectName, 
                      dbo.vueAccountProjectsForReport.ProjectDescription, dbo.vueAccountProjectsForReport.StartDate, dbo.vueAccountProjectsForReport.AccountMilestoneId, 
                      dbo.vueAccountProjectsForReport.Deadline, dbo.vueAccountProjectsForReport.LeaderEmployeeId, dbo.vueAccountProjectsForReport.ProjectManagerEmployeeId, 
                      dbo.vueAccountProjectsForReport.EstimatedTime, dbo.vueAccountProjectsForReport.EstimatedDurationUnit, dbo.vueAccountProjectsForReport.ProjectCode, 
                      dbo.vueAccountProjectsForReport.IsActive, dbo.vueAccountProjectsForReport.ProjectStatusId, dbo.vueAccountProjectsForReport.DefaultBillingRate, 
                      dbo.vueAccountProjectsForReport.AccountPriorityId, dbo.vueAccountProjectsForReport.CreatedOn, dbo.vueAccountProjectsForReport.CreatedByEmployeeId, 
                      dbo.vueAccountProjectsForReport.ModifiedOn, dbo.vueAccountProjectsForReport.ModifiedByEmployeeId, dbo.vueAccountProjectsForReport.ProjectBillingRateTypeId, 
                      dbo.vueAccountProjectsForReport.TimeSheetApprovalTypeId, dbo.vueAccountProjectsForReport.ExpenseApprovalTypeId, 
                      dbo.vueAccountProjectsForReport.IsDisabled, dbo.vueAccountProjectsForReport.IsTemplate, dbo.vueAccountProjectsForReport.IsProject, 
                      dbo.vueAccountProjectsForReport.AccountProjectTemplateId, dbo.vueAccountProjectsForReport.ClientNick, dbo.vueAccountProjectsForReport.ClientName, 
                      dbo.vueAccountProjectsForReport.ProjectType, dbo.vueAccountProjectsForReport.BillingType, dbo.vueAccountProjectsForReport.Status, 
                      dbo.vueAccountProjectsForReport.EstimatedDuration, dbo.vueAccountProjectsForReport.AccountClientContactId, 
                      dbo.vueAccountProjectsForReport.AccountClientDepartmentId, dbo.vueAccountProjectsForReport.ClientDepartmentCode, 
                      dbo.vueAccountProjectsForReport.ClientDepartmentName, dbo.vueAccountProjectsForReport.ClientDepartmentLocation, 
                      dbo.vueAccountProjectsForReport.ExpenseApprovalTypeName, dbo.vueAccountProjectsForReport.TimesheetApprovalTypeName, 
                      dbo.vueAccountProjectsForReport.ClientContactName, dbo.vueAccountProjectsForReport.TeamLead, dbo.vueAccountProjectsForReport.ProjectManager, 
                      dbo.vueAccountProjectsForReport.ProjectBillingRateType, dbo.vueAccountProjectsForReport.BillableTotalHours, 
                      dbo.vueAccountProjectsForReport.NonBillableTotalHours, dbo.vueAccountProjectsForReport.TotalEmployeeCost, dbo.vueAccountProjectsForReport.TotalHours, 
                      dbo.vueAccountProjectsForReport.BillableTimeAmount, dbo.vueAccountProjectsForReport.NonBillableTimeAmount, 
                      dbo.vueAccountProjectsForReport.TotalTimeAmount, dbo.vueAccountProjectsForReport.BilledTimeAmount'

GO
-- Create View rptvueAccountProjectsReport
Print 'Create View rptvueAccountProjectsReport'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectsReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountProjectsReport
AS
SELECT     dbo.rptvueAccountProjects.AccountProjectId, dbo.rptvueAccountProjects.AccountId, dbo.rptvueAccountProjects.AccountProjectTypeId, 
                      dbo.rptvueAccountProjects.AccountClientId, dbo.rptvueAccountProjects.ProjectBillingTypeId, dbo.rptvueAccountProjects.ProjectName, 
                      dbo.rptvueAccountProjects.ProjectDescription, dbo.rptvueAccountProjects.StartDate, dbo.rptvueAccountProjects.AccountMilestoneId, 
                      dbo.rptvueAccountProjects.Deadline, dbo.rptvueAccountProjects.LeaderEmployeeId, dbo.rptvueAccountProjects.ProjectManagerEmployeeId, 
                      dbo.rptvueAccountProjects.EstimatedTime, dbo.rptvueAccountProjects.EstimatedDurationUnit, dbo.rptvueAccountProjects.ProjectCode, 
                      dbo.rptvueAccountProjects.DefaultBillingRate, dbo.rptvueAccountProjects.IsActive, dbo.rptvueAccountProjects.ProjectStatusId, 
                      dbo.rptvueAccountProjects.AccountPriorityId, dbo.rptvueAccountProjects.CreatedOn, dbo.rptvueAccountProjects.CreatedByEmployeeId, 
                      dbo.rptvueAccountProjects.ModifiedOn, dbo.rptvueAccountProjects.ModifiedByEmployeeId, dbo.rptvueAccountProjects.ProjectBillingRateTypeId, 
                      dbo.rptvueAccountProjects.TimeSheetApprovalTypeId, dbo.rptvueAccountProjects.ExpenseApprovalTypeId, dbo.rptvueAccountProjects.IsDisabled, 
                      dbo.rptvueAccountProjects.IsTemplate, dbo.rptvueAccountProjects.IsProject, dbo.rptvueAccountProjects.AccountProjectTemplateId, 
                      dbo.rptvueAccountProjects.ClientNick, dbo.rptvueAccountProjects.ClientName, dbo.rptvueAccountProjects.ProjectType, dbo.rptvueAccountProjects.BillingType, 
                      dbo.rptvueAccountProjects.Status, dbo.rptvueAccountProjects.EstimatedDuration, dbo.rptvueAccountProjects.AccountClientContactId, 
                      dbo.rptvueAccountProjects.AccountClientDepartmentId, dbo.rptvueAccountProjects.ClientDepartmentCode, dbo.rptvueAccountProjects.ClientDepartmentName, 
                      dbo.rptvueAccountProjects.ClientDepartmentLocation, dbo.rptvueAccountProjects.ExpenseApprovalTypeName, 
                      dbo.rptvueAccountProjects.TimesheetApprovalTypeName, dbo.rptvueAccountProjects.ClientContactName, dbo.rptvueAccountProjects.TeamLead, 
                      dbo.rptvueAccountProjects.ProjectManager, dbo.rptvueAccountProjects.ProjectBillingRateType, dbo.rptvueAccountProjects.BillableTotalHours, 
                      dbo.rptvueAccountProjects.NonBillableTotalHours, dbo.rptvueAccountProjects.TotalEmployeeCost, dbo.rptvueAccountProjects.TotalTimeAmount, 
                      ISNULL(dbo.rptvueAccountProjects.TotalTaskEstimatedCost, 0) AS TotalTaskEstimatedCost, 
                      SUM(CASE WHEN dbo.rptvueAccountExpenseEntry.IsBillable = 1 THEN dbo.rptvueAccountExpenseEntry.NetAmount ELSE 0 END) AS TotalBillableExpense, 
                      SUM(CASE WHEN dbo.rptvueAccountExpenseEntry.IsBillable = 0 THEN dbo.rptvueAccountExpenseEntry.NetAmount ELSE 0 END) AS TotalNonBillableExpense, 
                      ISNULL(SUM(dbo.rptvueAccountExpenseEntry.NetAmount), 0) AS NetAmount, ISNULL(dbo.rptvueAccountProjects.TotalTaskEstimatedHours, 0) 
                      AS TotalTaskEstimatedHours, SUM(CASE WHEN dbo.rptvueAccountExpenseEntry.Billed = 1 THEN dbo.rptvueAccountExpenseEntry.NetAmount ELSE 0 END) 
                      AS BilledExpenseAmount, dbo.rptvueAccountProjects.TotalHours, dbo.rptvueAccountProjects.BillableTimeAmount, dbo.rptvueAccountProjects.NonBillableTimeAmount, 
                      dbo.rptvueAccountProjects.BilledTimeAmount
FROM         dbo.rptvueAccountProjects LEFT OUTER JOIN
                      dbo.rptvueAccountExpenseEntry ON dbo.rptvueAccountProjects.AccountProjectId = dbo.rptvueAccountExpenseEntry.AccountProjectId
GROUP BY dbo.rptvueAccountProjects.AccountProjectId, dbo.rptvueAccountProjects.AccountId, dbo.rptvueAccountProjects.AccountProjectTypeId, 
                      dbo.rptvueAccountProjects.AccountClientId, dbo.rptvueAccountProjects.ProjectName, dbo.rptvueAccountProjects.ProjectBillingTypeId, 
                      dbo.rptvueAccountProjects.ProjectDescription, dbo.rptvueAccountProjects.StartDate, dbo.rptvueAccountProjects.AccountMilestoneId, 
                      dbo.rptvueAccountProjects.Deadline, dbo.rptvueAccountProjects.LeaderEmployeeId, dbo.rptvueAccountProjects.ProjectManagerEmployeeId, 
                      dbo.rptvueAccountProjects.EstimatedTime, dbo.rptvueAccountProjects.EstimatedDurationUnit, dbo.rptvueAccountProjects.ProjectCode, 
                      dbo.rptvueAccountProjects.DefaultBillingRate, dbo.rptvueAccountProjects.IsActive, dbo.rptvueAccountProjects.ProjectStatusId, 
                      dbo.rptvueAccountProjects.AccountPriorityId, dbo.rptvueAccountProjects.CreatedOn, dbo.rptvueAccountProjects.CreatedByEmployeeId, 
                      dbo.rptvueAccountProjects.ModifiedOn, dbo.rptvueAccountProjects.ModifiedByEmployeeId, dbo.rptvueAccountProjects.ProjectBillingRateTypeId, 
                      dbo.rptvueAccountProjects.TimeSheetApprovalTypeId, dbo.rptvueAccountProjects.ExpenseApprovalTypeId, dbo.rptvueAccountProjects.IsDisabled, 
                      dbo.rptvueAccountProjects.IsTemplate, dbo.rptvueAccountProjects.IsProject, dbo.rptvueAccountProjects.AccountProjectTemplateId, 
                      dbo.rptvueAccountProjects.ClientNick, dbo.rptvueAccountProjects.ClientName, dbo.rptvueAccountProjects.ProjectType, dbo.rptvueAccountProjects.BillingType, 
                      dbo.rptvueAccountProjects.Status, dbo.rptvueAccountProjects.EstimatedDuration, dbo.rptvueAccountProjects.AccountClientContactId, 
                      dbo.rptvueAccountProjects.AccountClientDepartmentId, dbo.rptvueAccountProjects.ClientDepartmentCode, dbo.rptvueAccountProjects.ClientDepartmentName, 
                      dbo.rptvueAccountProjects.ClientDepartmentLocation, dbo.rptvueAccountProjects.ExpenseApprovalTypeName, 
                      dbo.rptvueAccountProjects.TimesheetApprovalTypeName, dbo.rptvueAccountProjects.ClientContactName, dbo.rptvueAccountProjects.TeamLead, 
                      dbo.rptvueAccountProjects.ProjectManager, dbo.rptvueAccountProjects.ProjectBillingRateType, dbo.rptvueAccountProjects.BillableTotalHours, 
                      dbo.rptvueAccountProjects.NonBillableTotalHours, dbo.rptvueAccountProjects.TotalEmployeeCost, dbo.rptvueAccountProjects.TotalTimeAmount, 
                      dbo.rptvueAccountProjects.TotalTaskEstimatedCost, ISNULL(dbo.rptvueAccountProjects.TotalTaskEstimatedHours, 0), dbo.rptvueAccountProjects.TotalHours, 
                      dbo.rptvueAccountProjects.BillableTimeAmount, dbo.rptvueAccountProjects.NonBillableTimeAmount, dbo.rptvueAccountProjects.BilledTimeAmount'


-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'
if not exists(Select * from [dbo].[SystemReportDataSourceField] where [SystemReportDataSourceFieldId] = '4e596b5b-ec68-47f3-b471-218da13106ee')
BEGIN
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('4e596b5b-ec68-47f3-b471-218da13106ee', '7e5678a3-d1bc-4bb4-8fd1-75cab80388ba', N'NonBillableTimeAmount', 100, 0, NULL, NULL, 32, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Non-Billable Time Amount', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('f87ddd7e-88b7-46b9-aaca-0a09c6b201b6', '7e5678a3-d1bc-4bb4-8fd1-75cab80388ba', N'BilledExpenseAmount', 100, 0, NULL, NULL, 27, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Billed Expense Amount', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('7a2a4d85-699e-4254-8000-d59e303bf2bc', '7e5678a3-d1bc-4bb4-8fd1-75cab80388ba', N'BillableTimeAmount', 100, 0, NULL, NULL, 31, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Billable Time Amount', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('3824adbe-405c-43d6-8268-a0f087aa404d', '7e5678a3-d1bc-4bb4-8fd1-75cab80388ba', N'NetAmount', 100, 0, NULL, NULL, 33, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Total Expense Amount', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('d049d1cf-59b3-4552-a838-815b7f104fab', '7e5678a3-d1bc-4bb4-8fd1-75cab80388ba', N'TotalTimeAmount', 100, 0, NULL, NULL, 29, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Total Time Amount', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('5ea4f9df-e2ed-4be3-95fe-565e8e3de794', '7e5678a3-d1bc-4bb4-8fd1-75cab80388ba', N'BilledTimeAmount', 100, 0, NULL, NULL, 30, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Billed Time Amount', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('c282bbf4-886f-4e0d-9841-7cdafeeb39fe', '7e5678a3-d1bc-4bb4-8fd1-75cab80388ba', N'TotalHours', 100, 0, NULL, NULL, 28, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Total Time Hours', 0, 0)

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'

UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=49 WHERE [SystemReportDataSourceFieldId]='daf2b619-50fd-4afe-9e3b-4f48587ac18b'
UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=48 WHERE [SystemReportDataSourceFieldId]='bbf83e4a-27b4-46b6-900d-21f377d460ed'
UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=46 WHERE [SystemReportDataSourceFieldId]='a5b9e183-e9e0-46b8-a721-294e543579f5'
UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=47 WHERE [SystemReportDataSourceFieldId]='2710bbd5-66b0-44ba-bf41-17fbadeac5e3'
UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=50 WHERE [SystemReportDataSourceFieldId]='5d920bfb-b7f7-4bec-a6d6-13862db32199'
END

GO
-- Drop View rptvueAccountProjects
Print 'Drop View rptvueAccountProjects'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountProjects' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountProjects]

GO
-- Drop View vueAccountProjectsForReport
Print 'Drop View vueAccountProjectsForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountProjectsForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountProjectsForReport]

GO
-- Create View vueAccountProjectsForReport
Print 'Create View vueAccountProjectsForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountProjectsForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountProjectsForReport
AS
SELECT     dbo.vueAccountProjectsOnlyForReport.AccountProjectId, dbo.vueAccountProjectsOnlyForReport.AccountId, 
                      dbo.vueAccountProjectsOnlyForReport.AccountProjectTypeId, dbo.vueAccountProjectsOnlyForReport.AccountClientId, 
                      dbo.vueAccountProjectsOnlyForReport.ProjectBillingTypeId, dbo.vueAccountProjectsOnlyForReport.ProjectName, 
                      dbo.vueAccountProjectsOnlyForReport.ProjectDescription, dbo.vueAccountProjectsOnlyForReport.StartDate, 
                      dbo.vueAccountProjectsOnlyForReport.AccountMilestoneId, dbo.vueAccountProjectsOnlyForReport.Deadline, 
                      dbo.vueAccountProjectsOnlyForReport.LeaderEmployeeId, dbo.vueAccountProjectsOnlyForReport.ProjectManagerEmployeeId, 
                      dbo.vueAccountProjectsOnlyForReport.EstimatedTime, dbo.vueAccountProjectsOnlyForReport.EstimatedDurationUnit, 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.ProjectCode, N'''') AS ProjectCode, dbo.vueAccountProjectsOnlyForReport.DefaultBillingRate, 
                      dbo.vueAccountProjectsOnlyForReport.IsActive, dbo.vueAccountProjectsOnlyForReport.ProjectStatusId, dbo.vueAccountProjectsOnlyForReport.AccountPriorityId, 
                      dbo.vueAccountProjectsOnlyForReport.CreatedOn, dbo.vueAccountProjectsOnlyForReport.CreatedByEmployeeId, dbo.vueAccountProjectsOnlyForReport.ModifiedOn, 
                      dbo.vueAccountProjectsOnlyForReport.ModifiedByEmployeeId, dbo.vueAccountProjectsOnlyForReport.ProjectBillingRateTypeId, 
                      dbo.vueAccountProjectsOnlyForReport.TimeSheetApprovalTypeId, dbo.vueAccountProjectsOnlyForReport.ExpenseApprovalTypeId, 
                      dbo.vueAccountProjectsOnlyForReport.IsDisabled, dbo.vueAccountProjectsOnlyForReport.IsTemplate, dbo.vueAccountProjectsOnlyForReport.IsProject, 
                      dbo.vueAccountProjectsOnlyForReport.AccountProjectTemplateId, ISNULL(dbo.vueAccountProjectsOnlyForReport.ClientNick, N'''') AS ClientNick, 
                      dbo.vueAccountProjectsOnlyForReport.ClientName, dbo.vueAccountProjectsOnlyForReport.ProjectType, dbo.vueAccountProjectsOnlyForReport.BillingType, 
                      dbo.vueAccountProjectsOnlyForReport.Status, 
                      dbo.vueAccountProjectsOnlyForReport.EstimatedDuration + '' - '' + dbo.vueAccountProjectsOnlyForReport.EstimatedDurationUnit AS EstimatedDuration, 
                      dbo.vueAccountProjectsOnlyForReport.AccountClientContactId, dbo.vueAccountProjectsOnlyForReport.AccountClientDepartmentId, 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.ClientDepartmentCode, N'''') AS ClientDepartmentCode, 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.ClientDepartmentName, N'''') AS ClientDepartmentName, 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.ClientDepartmentLocation, N'''') AS ClientDepartmentLocation, 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.ExpenseApprovalTypeName, N'''') AS ExpenseApprovalTypeName, 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.TimesheetApprovalTypeName, N'''') AS TimesheetApprovalTypeName, 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.ClientContactName, N'''') AS ClientContactName, dbo.vueAccountProjectsOnlyForReport.TeamLead, 
                      dbo.vueAccountProjectsOnlyForReport.ProjectManager, dbo.vueAccountProjectsOnlyForReport.ProjectBillingRateType, 
                      ISNULL(SUM(dbo.rptvueAccountEmployeeTimeEntry.BillableTotalHours), 0) AS BillableTotalHours, 
                      ISNULL(SUM(dbo.rptvueAccountEmployeeTimeEntry.NonBillableTotalHours), 0) AS NonBillableTotalHours, SUM(dbo.rptvueAccountEmployeeTimeEntry.EmployeeCost) 
                      AS TotalEmployeeCost, ISNULL(SUM(dbo.rptvueAccountEmployeeTimeEntry.Amount), 0) AS TotalTimeAmount, 
                      ISNULL(SUM(dbo.rptvueAccountEmployeeTimeEntry.TotalHours), 0) AS TotalHours, ISNULL(SUM(dbo.rptvueAccountEmployeeTimeEntry.BillableTotalAmount), 0) 
                      AS BillableTimeAmount, ISNULL(SUM(dbo.rptvueAccountEmployeeTimeEntry.NonBillableTotalAmount), 0) AS NonBillableTimeAmount
FROM         dbo.vueAccountProjectsOnlyForReport LEFT OUTER JOIN
                      dbo.rptvueAccountEmployeeTimeEntry ON dbo.vueAccountProjectsOnlyForReport.AccountProjectId = dbo.rptvueAccountEmployeeTimeEntry.AccountProjectId
GROUP BY dbo.vueAccountProjectsOnlyForReport.AccountProjectId, dbo.vueAccountProjectsOnlyForReport.AccountId, 
                      dbo.vueAccountProjectsOnlyForReport.AccountProjectTypeId, dbo.vueAccountProjectsOnlyForReport.AccountClientId, 
                      dbo.vueAccountProjectsOnlyForReport.ProjectBillingTypeId, dbo.vueAccountProjectsOnlyForReport.ProjectName, 
                      dbo.vueAccountProjectsOnlyForReport.ProjectDescription, dbo.vueAccountProjectsOnlyForReport.StartDate, 
                      dbo.vueAccountProjectsOnlyForReport.AccountMilestoneId, dbo.vueAccountProjectsOnlyForReport.Deadline, 
                      dbo.vueAccountProjectsOnlyForReport.LeaderEmployeeId, dbo.vueAccountProjectsOnlyForReport.ProjectManagerEmployeeId, 
                      dbo.vueAccountProjectsOnlyForReport.EstimatedTime, dbo.vueAccountProjectsOnlyForReport.EstimatedDurationUnit, 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.ProjectCode, N''''), dbo.vueAccountProjectsOnlyForReport.DefaultBillingRate, 
                      dbo.vueAccountProjectsOnlyForReport.IsActive, dbo.vueAccountProjectsOnlyForReport.ProjectStatusId, dbo.vueAccountProjectsOnlyForReport.AccountPriorityId, 
                      dbo.vueAccountProjectsOnlyForReport.CreatedOn, dbo.vueAccountProjectsOnlyForReport.CreatedByEmployeeId, dbo.vueAccountProjectsOnlyForReport.ModifiedOn, 
                      dbo.vueAccountProjectsOnlyForReport.ModifiedByEmployeeId, dbo.vueAccountProjectsOnlyForReport.ProjectBillingRateTypeId, 
                      dbo.vueAccountProjectsOnlyForReport.TimeSheetApprovalTypeId, dbo.vueAccountProjectsOnlyForReport.ExpenseApprovalTypeId, 
                      dbo.vueAccountProjectsOnlyForReport.IsDisabled, dbo.vueAccountProjectsOnlyForReport.IsTemplate, dbo.vueAccountProjectsOnlyForReport.IsProject, 
                      dbo.vueAccountProjectsOnlyForReport.AccountProjectTemplateId, ISNULL(dbo.vueAccountProjectsOnlyForReport.ClientNick, N''''), 
                      dbo.vueAccountProjectsOnlyForReport.ClientName, dbo.vueAccountProjectsOnlyForReport.ProjectType, dbo.vueAccountProjectsOnlyForReport.BillingType, 
                      dbo.vueAccountProjectsOnlyForReport.Status, 
                      dbo.vueAccountProjectsOnlyForReport.EstimatedDuration + '' - '' + dbo.vueAccountProjectsOnlyForReport.EstimatedDurationUnit, 
                      dbo.vueAccountProjectsOnlyForReport.AccountClientContactId, dbo.vueAccountProjectsOnlyForReport.AccountClientDepartmentId, 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.ClientDepartmentCode, N''''), ISNULL(dbo.vueAccountProjectsOnlyForReport.ClientDepartmentName, N''''), 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.ClientDepartmentLocation, N''''), ISNULL(dbo.vueAccountProjectsOnlyForReport.ExpenseApprovalTypeName, N''''), 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.TimesheetApprovalTypeName, N''''), ISNULL(dbo.vueAccountProjectsOnlyForReport.ClientContactName, N''''), 
                      dbo.vueAccountProjectsOnlyForReport.TeamLead, dbo.vueAccountProjectsOnlyForReport.ProjectManager, 
                      dbo.vueAccountProjectsOnlyForReport.ProjectBillingRateType'

GO
-- Create View rptvueAccountProjects
Print 'Create View rptvueAccountProjects'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountProjects' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountProjects
AS
SELECT     dbo.vueAccountProjectsForReport.AccountProjectId, dbo.vueAccountProjectsForReport.AccountId, dbo.vueAccountProjectsForReport.AccountProjectTypeId, 
                      dbo.vueAccountProjectsForReport.AccountClientId, dbo.vueAccountProjectsForReport.ProjectBillingTypeId, dbo.vueAccountProjectsForReport.ProjectName, 
                      dbo.vueAccountProjectsForReport.ProjectDescription, dbo.vueAccountProjectsForReport.StartDate, dbo.vueAccountProjectsForReport.AccountMilestoneId, 
                      dbo.vueAccountProjectsForReport.Deadline, dbo.vueAccountProjectsForReport.LeaderEmployeeId, dbo.vueAccountProjectsForReport.ProjectManagerEmployeeId, 
                      dbo.vueAccountProjectsForReport.EstimatedTime, dbo.vueAccountProjectsForReport.EstimatedDurationUnit, dbo.vueAccountProjectsForReport.ProjectCode, 
                      dbo.vueAccountProjectsForReport.DefaultBillingRate, dbo.vueAccountProjectsForReport.IsActive, dbo.vueAccountProjectsForReport.ProjectStatusId, 
                      dbo.vueAccountProjectsForReport.AccountPriorityId, dbo.vueAccountProjectsForReport.CreatedOn, dbo.vueAccountProjectsForReport.CreatedByEmployeeId, 
                      dbo.vueAccountProjectsForReport.ModifiedOn, dbo.vueAccountProjectsForReport.ModifiedByEmployeeId, dbo.vueAccountProjectsForReport.ProjectBillingRateTypeId, 
                      dbo.vueAccountProjectsForReport.TimeSheetApprovalTypeId, dbo.vueAccountProjectsForReport.ExpenseApprovalTypeId, 
                      dbo.vueAccountProjectsForReport.IsDisabled, dbo.vueAccountProjectsForReport.IsTemplate, dbo.vueAccountProjectsForReport.IsProject, 
                      dbo.vueAccountProjectsForReport.AccountProjectTemplateId, dbo.vueAccountProjectsForReport.ClientNick, dbo.vueAccountProjectsForReport.ClientName, 
                      dbo.vueAccountProjectsForReport.ProjectType, dbo.vueAccountProjectsForReport.BillingType, dbo.vueAccountProjectsForReport.Status, 
                      dbo.vueAccountProjectsForReport.EstimatedDuration, dbo.vueAccountProjectsForReport.AccountClientContactId, 
                      dbo.vueAccountProjectsForReport.AccountClientDepartmentId, dbo.vueAccountProjectsForReport.ClientDepartmentCode, 
                      dbo.vueAccountProjectsForReport.ClientDepartmentName, dbo.vueAccountProjectsForReport.ClientDepartmentLocation, 
                      dbo.vueAccountProjectsForReport.ExpenseApprovalTypeName, dbo.vueAccountProjectsForReport.TimesheetApprovalTypeName, 
                      dbo.vueAccountProjectsForReport.ClientContactName, dbo.vueAccountProjectsForReport.TeamLead, dbo.vueAccountProjectsForReport.ProjectManager, 
                      dbo.vueAccountProjectsForReport.ProjectBillingRateType, dbo.vueAccountProjectsForReport.BillableTotalHours, 
                      dbo.vueAccountProjectsForReport.NonBillableTotalHours, dbo.vueAccountProjectsForReport.TotalEmployeeCost, SUM(dbo.rptvueAccountProjectTasks.EstimatedCost) 
                      AS TotalTaskEstimatedCost, SUM(dbo.rptvueAccountProjectTasks.EstimatedHours) AS TotalTaskEstimatedHours, dbo.vueAccountProjectsForReport.TotalHours, 
                      dbo.vueAccountProjectsForReport.BillableTimeAmount, dbo.vueAccountProjectsForReport.NonBillableTimeAmount, 
                      dbo.vueAccountProjectsForReport.TotalTimeAmount
FROM         dbo.vueAccountProjectsForReport LEFT OUTER JOIN
                      dbo.rptvueAccountProjectTasks ON dbo.vueAccountProjectsForReport.AccountProjectId = dbo.rptvueAccountProjectTasks.AccountProjectId
GROUP BY dbo.vueAccountProjectsForReport.AccountProjectId, dbo.vueAccountProjectsForReport.AccountId, dbo.vueAccountProjectsForReport.AccountProjectTypeId, 
                      dbo.vueAccountProjectsForReport.AccountClientId, dbo.vueAccountProjectsForReport.ProjectBillingTypeId, dbo.vueAccountProjectsForReport.ProjectName, 
                      dbo.vueAccountProjectsForReport.ProjectDescription, dbo.vueAccountProjectsForReport.StartDate, dbo.vueAccountProjectsForReport.AccountMilestoneId, 
                      dbo.vueAccountProjectsForReport.Deadline, dbo.vueAccountProjectsForReport.LeaderEmployeeId, dbo.vueAccountProjectsForReport.ProjectManagerEmployeeId, 
                      dbo.vueAccountProjectsForReport.EstimatedTime, dbo.vueAccountProjectsForReport.EstimatedDurationUnit, dbo.vueAccountProjectsForReport.ProjectCode, 
                      dbo.vueAccountProjectsForReport.IsActive, dbo.vueAccountProjectsForReport.ProjectStatusId, dbo.vueAccountProjectsForReport.DefaultBillingRate, 
                      dbo.vueAccountProjectsForReport.AccountPriorityId, dbo.vueAccountProjectsForReport.CreatedOn, dbo.vueAccountProjectsForReport.CreatedByEmployeeId, 
                      dbo.vueAccountProjectsForReport.ModifiedOn, dbo.vueAccountProjectsForReport.ModifiedByEmployeeId, dbo.vueAccountProjectsForReport.ProjectBillingRateTypeId, 
                      dbo.vueAccountProjectsForReport.TimeSheetApprovalTypeId, dbo.vueAccountProjectsForReport.ExpenseApprovalTypeId, 
                      dbo.vueAccountProjectsForReport.IsDisabled, dbo.vueAccountProjectsForReport.IsTemplate, dbo.vueAccountProjectsForReport.IsProject, 
                      dbo.vueAccountProjectsForReport.AccountProjectTemplateId, dbo.vueAccountProjectsForReport.ClientNick, dbo.vueAccountProjectsForReport.ClientName, 
                      dbo.vueAccountProjectsForReport.ProjectType, dbo.vueAccountProjectsForReport.BillingType, dbo.vueAccountProjectsForReport.Status, 
                      dbo.vueAccountProjectsForReport.EstimatedDuration, dbo.vueAccountProjectsForReport.AccountClientContactId, 
                      dbo.vueAccountProjectsForReport.AccountClientDepartmentId, dbo.vueAccountProjectsForReport.ClientDepartmentCode, 
                      dbo.vueAccountProjectsForReport.ClientDepartmentName, dbo.vueAccountProjectsForReport.ClientDepartmentLocation, 
                      dbo.vueAccountProjectsForReport.ExpenseApprovalTypeName, dbo.vueAccountProjectsForReport.TimesheetApprovalTypeName, 
                      dbo.vueAccountProjectsForReport.ClientContactName, dbo.vueAccountProjectsForReport.TeamLead, dbo.vueAccountProjectsForReport.ProjectManager, 
                      dbo.vueAccountProjectsForReport.ProjectBillingRateType, dbo.vueAccountProjectsForReport.BillableTotalHours, 
                      dbo.vueAccountProjectsForReport.NonBillableTotalHours, dbo.vueAccountProjectsForReport.TotalEmployeeCost, dbo.vueAccountProjectsForReport.TotalHours, 
                      dbo.vueAccountProjectsForReport.BillableTimeAmount, dbo.vueAccountProjectsForReport.NonBillableTimeAmount, dbo.vueAccountProjectsForReport.TotalTimeAmount'

GO
-- Create View rptvueAccountProjectsforReport
Print 'Create View rptvueAccountProjectsforReport'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectsforReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountProjectsforReport
AS
SELECT     dbo.rptvueAccountProjects.AccountProjectId, dbo.rptvueAccountProjects.AccountId, dbo.rptvueAccountProjects.AccountProjectTypeId, 
                      dbo.rptvueAccountProjects.AccountClientId, dbo.rptvueAccountProjects.ProjectBillingTypeId, dbo.rptvueAccountProjects.ProjectName, 
                      dbo.rptvueAccountProjects.ProjectDescription, dbo.rptvueAccountProjects.StartDate, dbo.rptvueAccountProjects.AccountMilestoneId, 
                      dbo.rptvueAccountProjects.Deadline, dbo.rptvueAccountProjects.LeaderEmployeeId, dbo.rptvueAccountProjects.ProjectManagerEmployeeId, 
                      dbo.rptvueAccountProjects.EstimatedTime, dbo.rptvueAccountProjects.EstimatedDurationUnit, dbo.rptvueAccountProjects.ProjectCode, 
                      dbo.rptvueAccountProjects.DefaultBillingRate, dbo.rptvueAccountProjects.IsActive, dbo.rptvueAccountProjects.ProjectStatusId, 
                      dbo.rptvueAccountProjects.AccountPriorityId, dbo.rptvueAccountProjects.CreatedOn, dbo.rptvueAccountProjects.CreatedByEmployeeId, 
                      dbo.rptvueAccountProjects.ModifiedOn, dbo.rptvueAccountProjects.ModifiedByEmployeeId, dbo.rptvueAccountProjects.ProjectBillingRateTypeId, 
                      dbo.rptvueAccountProjects.TimeSheetApprovalTypeId, dbo.rptvueAccountProjects.ExpenseApprovalTypeId, dbo.rptvueAccountProjects.IsDisabled, 
                      dbo.rptvueAccountProjects.IsTemplate, dbo.rptvueAccountProjects.IsProject, dbo.rptvueAccountProjects.AccountProjectTemplateId, 
                      dbo.rptvueAccountProjects.ClientNick, dbo.rptvueAccountProjects.ClientName, dbo.rptvueAccountProjects.ProjectType, dbo.rptvueAccountProjects.BillingType, 
                      dbo.rptvueAccountProjects.Status, dbo.rptvueAccountProjects.EstimatedDuration, dbo.rptvueAccountProjects.AccountClientContactId, 
                      dbo.rptvueAccountProjects.AccountClientDepartmentId, dbo.rptvueAccountProjects.ClientDepartmentCode, dbo.rptvueAccountProjects.ClientDepartmentName, 
                      dbo.rptvueAccountProjects.ClientDepartmentLocation, dbo.rptvueAccountProjects.ExpenseApprovalTypeName, 
                      dbo.rptvueAccountProjects.TimesheetApprovalTypeName, dbo.rptvueAccountProjects.ClientContactName, dbo.rptvueAccountProjects.TeamLead, 
                      dbo.rptvueAccountProjects.ProjectManager, dbo.rptvueAccountProjects.ProjectBillingRateType, dbo.rptvueAccountProjects.BillableTotalHours, 
                      dbo.rptvueAccountProjects.NonBillableTotalHours, dbo.rptvueAccountProjects.TotalEmployeeCost, dbo.rptvueAccountProjects.TotalTimeAmount, 
                      ISNULL(dbo.rptvueAccountProjects.TotalTaskEstimatedCost, 0) AS TotalTaskEstimatedCost, 
                      SUM(CASE WHEN dbo.rptvueAccountExpenseEntry.IsBillable = 1 THEN dbo.rptvueAccountExpenseEntry.NetAmount ELSE 0 END) AS TotalBillableExpense, 
                      SUM(CASE WHEN dbo.rptvueAccountExpenseEntry.IsBillable = 0 THEN dbo.rptvueAccountExpenseEntry.NetAmount ELSE 0 END) AS TotalNonBillableExpense, 
                      ISNULL(SUM(dbo.rptvueAccountExpenseEntry.NetAmount), 0) AS NetAmount, ISNULL(dbo.rptvueAccountProjects.TotalTaskEstimatedHours, 0) 
                      AS TotalTaskEstimatedHours, dbo.rptvueAccountProjects.TotalHours, dbo.rptvueAccountProjects.BillableTimeAmount, 
                      dbo.rptvueAccountProjects.NonBillableTimeAmount
FROM         dbo.rptvueAccountProjects LEFT OUTER JOIN
                      dbo.rptvueAccountExpenseEntry ON dbo.rptvueAccountProjects.AccountProjectId = dbo.rptvueAccountExpenseEntry.AccountProjectId
GROUP BY dbo.rptvueAccountProjects.AccountProjectId, dbo.rptvueAccountProjects.AccountId, dbo.rptvueAccountProjects.AccountProjectTypeId, 
                      dbo.rptvueAccountProjects.AccountClientId, dbo.rptvueAccountProjects.ProjectName, dbo.rptvueAccountProjects.ProjectBillingTypeId, 
                      dbo.rptvueAccountProjects.ProjectDescription, dbo.rptvueAccountProjects.StartDate, dbo.rptvueAccountProjects.AccountMilestoneId, 
                      dbo.rptvueAccountProjects.Deadline, dbo.rptvueAccountProjects.LeaderEmployeeId, dbo.rptvueAccountProjects.ProjectManagerEmployeeId, 
                      dbo.rptvueAccountProjects.EstimatedTime, dbo.rptvueAccountProjects.EstimatedDurationUnit, dbo.rptvueAccountProjects.ProjectCode, 
                      dbo.rptvueAccountProjects.DefaultBillingRate, dbo.rptvueAccountProjects.IsActive, dbo.rptvueAccountProjects.ProjectStatusId, 
                      dbo.rptvueAccountProjects.AccountPriorityId, dbo.rptvueAccountProjects.CreatedOn, dbo.rptvueAccountProjects.CreatedByEmployeeId, 
                      dbo.rptvueAccountProjects.ModifiedOn, dbo.rptvueAccountProjects.ModifiedByEmployeeId, dbo.rptvueAccountProjects.ProjectBillingRateTypeId, 
                      dbo.rptvueAccountProjects.TimeSheetApprovalTypeId, dbo.rptvueAccountProjects.ExpenseApprovalTypeId, dbo.rptvueAccountProjects.IsDisabled, 
                      dbo.rptvueAccountProjects.IsTemplate, dbo.rptvueAccountProjects.IsProject, dbo.rptvueAccountProjects.AccountProjectTemplateId, 
                      dbo.rptvueAccountProjects.ClientNick, dbo.rptvueAccountProjects.ClientName, dbo.rptvueAccountProjects.ProjectType, dbo.rptvueAccountProjects.BillingType, 
                      dbo.rptvueAccountProjects.Status, dbo.rptvueAccountProjects.EstimatedDuration, dbo.rptvueAccountProjects.AccountClientContactId, 
                      dbo.rptvueAccountProjects.AccountClientDepartmentId, dbo.rptvueAccountProjects.ClientDepartmentCode, dbo.rptvueAccountProjects.ClientDepartmentName, 
                      dbo.rptvueAccountProjects.ClientDepartmentLocation, dbo.rptvueAccountProjects.ExpenseApprovalTypeName, 
                      dbo.rptvueAccountProjects.TimesheetApprovalTypeName, dbo.rptvueAccountProjects.ClientContactName, dbo.rptvueAccountProjects.TeamLead, 
                      dbo.rptvueAccountProjects.ProjectManager, dbo.rptvueAccountProjects.ProjectBillingRateType, dbo.rptvueAccountProjects.BillableTotalHours, 
                      dbo.rptvueAccountProjects.NonBillableTotalHours, dbo.rptvueAccountProjects.TotalEmployeeCost, dbo.rptvueAccountProjects.TotalTimeAmount, 
                      dbo.rptvueAccountProjects.TotalTaskEstimatedCost, ISNULL(dbo.rptvueAccountProjects.TotalTaskEstimatedHours, 0), dbo.rptvueAccountProjects.TotalHours, 
                      dbo.rptvueAccountProjects.BillableTimeAmount, dbo.rptvueAccountProjects.NonBillableTimeAmount'

GO
-- Create View vueBillingTimesheet
Print 'Create View vueBillingTimesheet'
GO
if not exists (select * from information_schema.tables where table_name = 'vueBillingTimesheet' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueBillingTimesheet
AS
SELECT     dbo.AccountTimeExpenseBillingTimesheet.TotalAmount, dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingTimesheetId, 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountId, dbo.AccountTimeExpenseBilling.AccountClientId, dbo.AccountTimeExpenseBillingTimesheet.AccountProjectId, 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountProjectTaskId
FROM         dbo.AccountTimeExpenseBilling LEFT OUTER JOIN
                      dbo.AccountTimeExpenseBillingTimesheet ON 
                      dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId = dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingId'

GO
-- Create View vueBillingExpense
Print 'Create View vueBillingExpense'
GO
if not exists (select * from information_schema.tables where table_name = 'vueBillingExpense' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueBillingExpense
AS
SELECT     dbo.AccountTimeExpenseBilling.AccountClientId, dbo.AccountTimeExpenseBillingExpense.AccountTimeExpenseBillingExpenseId, 
                      dbo.AccountTimeExpenseBillingExpense.AccountId, dbo.AccountTimeExpenseBillingExpense.AccountProjectId, 
                      dbo.AccountTimeExpenseBillingExpense.AccountExpenseTypeId, dbo.AccountTimeExpenseBillingExpense.AccountExpenseId, 
                      dbo.AccountTimeExpenseBillingExpense.BilledExpenseAmount
FROM         dbo.AccountTimeExpenseBilling LEFT OUTER JOIN
                      dbo.AccountTimeExpenseBillingExpense ON 
                      dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId = dbo.AccountTimeExpenseBillingExpense.AccountTimeExpenseBillingId'

GO
-- Create View rptvueAccountProjectsTimesheet
Print 'Create View rptvueAccountProjectsTimesheet'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectsTimesheet' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountProjectsTimesheet
AS
SELECT     dbo.rptvueAccountProjectsforReport.AccountProjectId, dbo.rptvueAccountProjectsforReport.AccountId, dbo.rptvueAccountProjectsforReport.AccountProjectTypeId, 
                      dbo.rptvueAccountProjectsforReport.AccountClientId, dbo.rptvueAccountProjectsforReport.ProjectBillingTypeId, dbo.rptvueAccountProjectsforReport.ProjectName, 
                      dbo.rptvueAccountProjectsforReport.ProjectDescription, dbo.rptvueAccountProjectsforReport.StartDate, dbo.rptvueAccountProjectsforReport.AccountMilestoneId, 
                      dbo.rptvueAccountProjectsforReport.Deadline, dbo.rptvueAccountProjectsforReport.LeaderEmployeeId, 
                      dbo.rptvueAccountProjectsforReport.ProjectManagerEmployeeId, dbo.rptvueAccountProjectsforReport.EstimatedTime, 
                      dbo.rptvueAccountProjectsforReport.EstimatedDurationUnit, dbo.rptvueAccountProjectsforReport.ProjectCode, dbo.rptvueAccountProjectsforReport.DefaultBillingRate, 
                      dbo.rptvueAccountProjectsforReport.IsActive, dbo.rptvueAccountProjectsforReport.ProjectStatusId, dbo.rptvueAccountProjectsforReport.AccountPriorityId, 
                      dbo.rptvueAccountProjectsforReport.CreatedOn, dbo.rptvueAccountProjectsforReport.CreatedByEmployeeId, dbo.rptvueAccountProjectsforReport.ModifiedOn, 
                      dbo.rptvueAccountProjectsforReport.ModifiedByEmployeeId, dbo.rptvueAccountProjectsforReport.ProjectBillingRateTypeId, 
                      dbo.rptvueAccountProjectsforReport.TimeSheetApprovalTypeId, dbo.rptvueAccountProjectsforReport.ExpenseApprovalTypeId, 
                      dbo.rptvueAccountProjectsforReport.IsDisabled, dbo.rptvueAccountProjectsforReport.IsTemplate, dbo.rptvueAccountProjectsforReport.IsProject, 
                      dbo.rptvueAccountProjectsforReport.AccountProjectTemplateId, dbo.rptvueAccountProjectsforReport.ClientNick, dbo.rptvueAccountProjectsforReport.ClientName, 
                      dbo.rptvueAccountProjectsforReport.ProjectType, dbo.rptvueAccountProjectsforReport.BillingType, dbo.rptvueAccountProjectsforReport.Status, 
                      dbo.rptvueAccountProjectsforReport.EstimatedDuration, dbo.rptvueAccountProjectsforReport.AccountClientContactId, 
                      dbo.rptvueAccountProjectsforReport.AccountClientDepartmentId, dbo.rptvueAccountProjectsforReport.ClientDepartmentCode, 
                      dbo.rptvueAccountProjectsforReport.ClientDepartmentName, dbo.rptvueAccountProjectsforReport.ClientDepartmentLocation, 
                      dbo.rptvueAccountProjectsforReport.ExpenseApprovalTypeName, dbo.rptvueAccountProjectsforReport.TimesheetApprovalTypeName, 
                      dbo.rptvueAccountProjectsforReport.ClientContactName, dbo.rptvueAccountProjectsforReport.TeamLead, dbo.rptvueAccountProjectsforReport.ProjectManager, 
                      dbo.rptvueAccountProjectsforReport.ProjectBillingRateType, dbo.rptvueAccountProjectsforReport.BillableTotalHours, 
                      dbo.rptvueAccountProjectsforReport.NonBillableTotalHours, dbo.rptvueAccountProjectsforReport.TotalEmployeeCost, 
                      dbo.rptvueAccountProjectsforReport.TotalTimeAmount, dbo.rptvueAccountProjectsforReport.TotalTaskEstimatedCost, 
                      dbo.rptvueAccountProjectsforReport.TotalBillableExpense, dbo.rptvueAccountProjectsforReport.TotalNonBillableExpense, 
                      dbo.rptvueAccountProjectsforReport.NetAmount, dbo.rptvueAccountProjectsforReport.TotalTaskEstimatedHours, dbo.rptvueAccountProjectsforReport.TotalHours, 
                      dbo.rptvueAccountProjectsforReport.BillableTimeAmount, dbo.rptvueAccountProjectsforReport.NonBillableTimeAmount, SUM(dbo.vueBillingTimesheet.TotalAmount) 
                      AS BilledTimeAmount
FROM         dbo.rptvueAccountProjectsforReport LEFT OUTER JOIN
                      dbo.vueBillingTimesheet ON dbo.rptvueAccountProjectsforReport.AccountProjectId = dbo.vueBillingTimesheet.AccountProjectId
GROUP BY dbo.rptvueAccountProjectsforReport.AccountProjectId, dbo.rptvueAccountProjectsforReport.AccountId, dbo.rptvueAccountProjectsforReport.AccountProjectTypeId, 
                      dbo.rptvueAccountProjectsforReport.AccountClientId, dbo.rptvueAccountProjectsforReport.ProjectBillingTypeId, dbo.rptvueAccountProjectsforReport.ProjectName, 
                      dbo.rptvueAccountProjectsforReport.ProjectDescription, dbo.rptvueAccountProjectsforReport.StartDate, dbo.rptvueAccountProjectsforReport.AccountMilestoneId, 
                      dbo.rptvueAccountProjectsforReport.Deadline, dbo.rptvueAccountProjectsforReport.LeaderEmployeeId, 
                      dbo.rptvueAccountProjectsforReport.ProjectManagerEmployeeId, dbo.rptvueAccountProjectsforReport.EstimatedTime, 
                      dbo.rptvueAccountProjectsforReport.EstimatedDurationUnit, dbo.rptvueAccountProjectsforReport.ProjectCode, dbo.rptvueAccountProjectsforReport.DefaultBillingRate, 
                      dbo.rptvueAccountProjectsforReport.IsActive, dbo.rptvueAccountProjectsforReport.ProjectStatusId, dbo.rptvueAccountProjectsforReport.AccountPriorityId, 
                      dbo.rptvueAccountProjectsforReport.CreatedOn, dbo.rptvueAccountProjectsforReport.CreatedByEmployeeId, dbo.rptvueAccountProjectsforReport.ModifiedOn, 
                      dbo.rptvueAccountProjectsforReport.ModifiedByEmployeeId, dbo.rptvueAccountProjectsforReport.ProjectBillingRateTypeId, 
                      dbo.rptvueAccountProjectsforReport.TimeSheetApprovalTypeId, dbo.rptvueAccountProjectsforReport.ExpenseApprovalTypeId, 
                      dbo.rptvueAccountProjectsforReport.IsDisabled, dbo.rptvueAccountProjectsforReport.IsTemplate, dbo.rptvueAccountProjectsforReport.IsProject, 
                      dbo.rptvueAccountProjectsforReport.AccountProjectTemplateId, dbo.rptvueAccountProjectsforReport.ClientNick, dbo.rptvueAccountProjectsforReport.ClientName, 
                      dbo.rptvueAccountProjectsforReport.ProjectType, dbo.rptvueAccountProjectsforReport.BillingType, dbo.rptvueAccountProjectsforReport.Status, 
                      dbo.rptvueAccountProjectsforReport.EstimatedDuration, dbo.rptvueAccountProjectsforReport.AccountClientContactId, 
                      dbo.rptvueAccountProjectsforReport.AccountClientDepartmentId, dbo.rptvueAccountProjectsforReport.ClientDepartmentCode, 
                      dbo.rptvueAccountProjectsforReport.ClientDepartmentName, dbo.rptvueAccountProjectsforReport.ClientDepartmentLocation, 
                      dbo.rptvueAccountProjectsforReport.ExpenseApprovalTypeName, dbo.rptvueAccountProjectsforReport.TimesheetApprovalTypeName, 
                      dbo.rptvueAccountProjectsforReport.ClientContactName, dbo.rptvueAccountProjectsforReport.TeamLead, dbo.rptvueAccountProjectsforReport.ProjectManager, 
                      dbo.rptvueAccountProjectsforReport.ProjectBillingRateType, dbo.rptvueAccountProjectsforReport.BillableTotalHours, 
                      dbo.rptvueAccountProjectsforReport.NonBillableTotalHours, dbo.rptvueAccountProjectsforReport.TotalEmployeeCost, 
                      dbo.rptvueAccountProjectsforReport.TotalTimeAmount, dbo.rptvueAccountProjectsforReport.TotalTaskEstimatedCost, 
                      dbo.rptvueAccountProjectsforReport.TotalBillableExpense, dbo.rptvueAccountProjectsforReport.TotalNonBillableExpense, 
                      dbo.rptvueAccountProjectsforReport.NetAmount, dbo.rptvueAccountProjectsforReport.TotalTaskEstimatedHours, dbo.rptvueAccountProjectsforReport.TotalHours, 
                      dbo.rptvueAccountProjectsforReport.BillableTimeAmount, dbo.rptvueAccountProjectsforReport.NonBillableTimeAmount'

GO
-- Drop View vueAccountEmployeeTimeEntryWithStatus
Print 'Drop View vueAccountEmployeeTimeEntryWithStatus'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithStatus' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryWithStatus]
GO
-- Drop View vueTimesheetSummaryPendingForApproval
Print 'Drop View vueTimesheetSummaryPendingForApproval'
GO
if exists (select * from information_schema.tables where table_name = 'vueTimesheetSummaryPendingForApproval' and table_type = 'VIEW')
DROP VIEW [dbo].[vueTimesheetSummaryPendingForApproval]
GO
-- Create View vueTimesheetSummaryPendingForApproval
Print 'Create View vueTimesheetSummaryPendingForApproval'
GO
if not exists (select * from information_schema.tables where table_name = 'vueTimesheetSummaryPendingForApproval' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueTimesheetSummaryPendingForApproval
AS
SELECT     AccountEmployeeTimeEntryPeriodId, TimeEntryAccountEmployeeId, TimeEntryStartDate, TimeEntryEndDate, TimeEntryViewType, Submitted, 
                      Approved, Rejected, MAX(TimeSheetApprovalId) AS TimeSheetApprovalId, AccountApprovalPathId, SystemApproverTypeId, AccountExternalUserId, 
                      AccountEmployeeId, ApprovalPathSequence, LeaderEmployeeId, ProjectManagerEmployeeId, AccountApprovalTypeId, EmployeeName, 
                      EmployeeManagerId, AccountProjectId, 
                      CASE WHEN systemapprovertypeid = 1 THEN LeaderEmployeeId WHEN systemapprovertypeid = 2 THEN ProjectManagerEmployeeId WHEN systemapprovertypeid
                       = 3 THEN AccountEmployeeId WHEN systemapprovertypeid = 4 THEN AccountExternalUserId WHEN systemapprovertypeid = 5 THEN EmployeeManagerId
                       END AS ApproverEmployeeId, IsApproved, EMailAddress, AccountEmployeeTimeEntryApprovalProjectId
FROM         dbo.vueTimesheetSummaryForApproval
WHERE     (ApprovalPathSequence IN
                          (SELECT     TOP 1 ApprovalPathSequence
                            FROM          dbo.vueTimesheetSequenceForApproval
                            WHERE      (TimeSheetApprovalId IS NULL) AND (AccountProjectId = dbo.vueTimesheetSummaryForApproval.AccountProjectId) AND 
                                                   (AccountEmployeeTimeEntryPeriodId = dbo.vueTimesheetSummaryForApproval.AccountEmployeeTimeEntryPeriodId)))
GROUP BY AccountEmployeeTimeEntryPeriodId, TimeEntryAccountEmployeeId, TimeEntryStartDate, TimeEntryEndDate, TimeEntryViewType, Submitted, 
                      Approved, Rejected, AccountApprovalPathId, SystemApproverTypeId, AccountExternalUserId, AccountEmployeeId, ApprovalPathSequence, 
                      LeaderEmployeeId, ProjectManagerEmployeeId, AccountApprovalTypeId, EmployeeName, EmployeeManagerId, AccountProjectId, IsApproved, 
                      EMailAddress, AccountEmployeeTimeEntryApprovalProjectId'
GO
-- Create View vueAccountEmployeeTimeEntryWithStatus
Print 'Create View vueAccountEmployeeTimeEntryWithStatus'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithStatus' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryWithStatus
AS
SELECT     dbo.AccountCostCenter.AccountCostCenter, dbo.AccountProject.ProjectName, dbo.AccountWorkType.AccountWorkType, 
                      dbo.AccountProjectTask.TaskName, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeId, dbo.AccountEmployeeTimeEntry.TimeEntryDate, dbo.AccountEmployeeTimeEntry.StartTime, 
                      dbo.AccountEmployeeTimeEntry.EndTime, dbo.AccountEmployeeTimeEntry.TotalTime, dbo.AccountEmployeeTimeEntry.AccountProjectId, 
                      dbo.AccountEmployeeTimeEntry.AccountProjectTaskId, dbo.AccountEmployeeTimeEntry.Description, 
                      dbo.AccountEmployeeTimeEntry.TimeSheetApprovalPathId, dbo.AccountEmployeeTimeEntry.Approved, 
                      dbo.AccountEmployeeTimeEntry.TeamLeadApproved, dbo.AccountEmployeeTimeEntry.ProjectManagerApproved, 
                      dbo.AccountEmployeeTimeEntry.AdministratorApproved, dbo.AccountEmployeeTimeEntry.CreatedOn, dbo.AccountEmployeeTimeEntry.ModifiedOn, 
                      dbo.AccountEmployeeTimeEntry.Rejected, dbo.AccountEmployeeTimeEntry.BillingRate, dbo.AccountEmployeeTimeEntry.AccountPartyId, 
                      dbo.AccountEmployeeTimeEntry.Submitted, dbo.AccountEmployeeTimeEntry.AccountWorkTypeId, dbo.AccountEmployeeTimeEntry.EmployeeRate, 
                      dbo.AccountEmployeeTimeEntry.AccountCostCenterId, dbo.AccountEmployeeTimeEntry.BillingRateCurrencyId, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateCurrencyId, dbo.AccountEmployeeTimeEntry.BillingRateExchangeRate, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateExchangeRate, dbo.AccountEmployeeTimeEntry.AccountBaseCurrencyId, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeExpenseBillingTimesheetId, dbo.AccountEmployeeTimeEntry.Billed, 
                      dbo.AccountEmployeeTimeEntryApprovalProject.InApproval AS IsApproved, dbo.AccountEmployeeTimeEntryApprovalProject.IsRejected AS IsReject, 
                      dbo.AccountParty.PartyName, dbo.AccountParty.PartyNick, dbo.AccountParty.AccountPartyId AS AccountClientId, 
                      dbo.AccountEmployeeTimeEntryPeriod.PeriodDescription, dbo.AccountParty.AccountId, dbo.AccountEmployeeTimeEntry.IsTimeOff, 
                      dbo.AccountEmployeeTimeEntry.Hours, dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeOffRequestId, dbo.AccountTimeOffType.AccountTimeOffType, 
                      dbo.AccountTimeOffType.IsTimeOffRequestRequired, dbo.AccountEmployeeTimeEntryApprovalProject.Approved AS ProjectApproved
FROM         dbo.AccountEmployeeTimeEntryPeriod RIGHT OUTER JOIN
                      dbo.AccountEmployeeTimeEntry LEFT OUTER JOIN
                      dbo.AccountTimeOffType ON dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId ON 
                      dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId LEFT
                       OUTER JOIN
                      dbo.AccountEmployeeTimeEntryApprovalProject ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId = dbo.AccountEmployeeTimeEntryApprovalProject.AccountEmployeeTimeEntryApprovalProjectId
                       LEFT OUTER JOIN
                      dbo.AccountParty INNER JOIN
                      dbo.AccountProject ON dbo.AccountParty.AccountPartyId = dbo.AccountProject.AccountClientId ON 
                      dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountProjectTask ON dbo.AccountEmployeeTimeEntry.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId LEFT OUTER JOIN
                      dbo.AccountWorkType ON dbo.AccountEmployeeTimeEntry.AccountWorkTypeId = dbo.AccountWorkType.AccountWorkTypeId LEFT OUTER JOIN
                      dbo.AccountCostCenter ON dbo.AccountEmployeeTimeEntry.AccountCostCenterId = dbo.AccountCostCenter.AccountCostCenterId'
GO
-- Drop View vueAccountExpenseEntryApprovalPending
Print 'Drop View vueAccountExpenseEntryApprovalPending'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryApprovalPending' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountExpenseEntryApprovalPending]
GO
-- Create View vueAccountExpenseEntryApprovalPending
Print 'Create View vueAccountExpenseEntryApprovalPending'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryApprovalPending' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountExpenseEntryApprovalPending
AS
SELECT     dbo.vueAccountExpenseEntryApproval.AccountProjectId, dbo.vueAccountExpenseEntryApproval.LeaderEmployeeId, 
                      dbo.vueAccountExpenseEntryApproval.ProjectManagerEmployeeId, dbo.vueAccountExpenseEntryApproval.ApprovalTypeName, 
                      dbo.vueAccountExpenseEntryApproval.AccountApprovalPathId, dbo.vueAccountExpenseEntryApproval.AccountApprovalTypeId, 
                      dbo.vueAccountExpenseEntryApproval.SystemApproverTypeId, dbo.vueAccountExpenseEntryApproval.AccountExternalUserId, 
                      dbo.vueAccountExpenseEntryApproval.AccountEmployeeId, dbo.vueAccountExpenseEntryApproval.ApprovalPathSequence, 
                      dbo.vueAccountExpenseEntryApproval.AccountExpenseEntryId, MAX(dbo.vueAccountExpenseEntryApproval.ExpenseApprovalId) 
                      AS ExpenseApprovalId, dbo.vueAccountExpenseEntryApproval.ExpenseApprovalPathId, dbo.vueAccountExpenseEntryApproval.ProjectName, 
                      dbo.vueAccountExpenseEntryApproval.ProjectDescription, dbo.vueAccountExpenseEntryApproval.ProjectCode, 
                      dbo.vueAccountExpenseEntryApproval.EmployeeName, dbo.vueAccountExpenseEntryApproval.Approved, 
                      dbo.vueAccountExpenseEntryApproval.ExpenseApprovalTypeId, dbo.vueAccountExpenseEntryApproval.AccountExpenseEntryDate, 
                      MAX(dbo.vueAccountExpenseEntryApproval.Comments) AS Comments, dbo.vueAccountExpenseEntryApproval.IsRejected, 
                      dbo.vueAccountExpenseEntryApproval.IsApproved, CASE WHEN MAX(dbo.vueAccountExpenseEntryApproval.ExchangeRate) 
                      <> 0 THEN (dbo.vueAccountExpenseEntryApproval.Amount / MAX(dbo.vueAccountExpenseEntryApproval.ExchangeRate)) 
                      * dbo.vueAccountCurrency.ExchangeRate ELSE 0 END AS Amount, dbo.vueAccountExpenseEntryApproval.AccountExpenseName, 
                      dbo.vueAccountExpenseEntryApproval.IsBillable, dbo.vueAccountApproverType.MaxApprovalPathSequence, 
                      dbo.vueAccountExpenseEntryApproval.ExpenseEntryAccountEmployeeId, dbo.vueAccountExpenseEntryApproval.Description, 
                      dbo.vueAccountExpenseEntryApproval.AccountId, dbo.vueAccountExpenseEntryApproval.EMailAddress, 
                      dbo.vueAccountExpenseEntryApproval.Submitted, dbo.vueAccountExpenseEntryApproval.EmployeeManagerId, 
                      dbo.vueAccountExpenseEntryApproval.CurrencyCode, dbo.vueAccountExpenseEntryApproval.Rejected, 
                      dbo.vueAccountExpenseEntryApproval.AccountEmployeeExpenseSheetId, MAX(dbo.vueAccountExpenseEntryApproval.MasterDescription) 
                      AS MasterDescription, MAX(dbo.vueAccountExpenseEntryApproval.ExpenseSheetDate) AS ExpenseSheetDate, 
                      MAX(dbo.vueAccountCurrency.CurrencyCode) AS BaseCurrencyCode, MAX(dbo.vueAccountCurrency.Currency) AS BaseCurrency, 
                      MAX(dbo.vueAccountExpenseEntryApproval.SubmittedDate) AS SubmittedDate, 
                      dbo.vueAccountCurrency.ExchangeRate AS BaseCurrencyExchangeRate
FROM         dbo.vueAccountExpenseEntryApproval INNER JOIN
                      dbo.vueAccountApproverType ON 
                      dbo.vueAccountExpenseEntryApproval.AccountApprovalTypeId = dbo.vueAccountApproverType.AccountApprovalTypeId INNER JOIN
                      dbo.AccountPreferences ON dbo.vueAccountExpenseEntryApproval.AccountId = dbo.AccountPreferences.AccountId INNER JOIN
                      dbo.vueAccountCurrency ON dbo.AccountPreferences.AccountBaseCurrencyId = dbo.vueAccountCurrency.AccountCurrencyId
WHERE     (dbo.vueAccountExpenseEntryApproval.AccountApprovalPathId IN
                          (SELECT     TOP 1 AccountApprovalPathId
                            FROM          dbo.vueExpenseApprovalSequence AS vueExpenseApprovalSequence_1
                            WHERE      (ExpenseApprovalId IS NULL) AND (AccountExpenseEntryId = dbo.vueAccountExpenseEntryApproval.AccountExpenseEntryId))) AND 
                      (dbo.vueAccountExpenseEntryApproval.Approved = 0) AND (dbo.vueAccountExpenseEntryApproval.Submitted = 1) AND 
                      (dbo.vueAccountExpenseEntryApproval.Rejected IS NULL OR
                      dbo.vueAccountExpenseEntryApproval.Rejected = 0)
GROUP BY dbo.vueAccountExpenseEntryApproval.AccountProjectId, dbo.vueAccountExpenseEntryApproval.LeaderEmployeeId, 
                      dbo.vueAccountExpenseEntryApproval.ProjectManagerEmployeeId, dbo.vueAccountExpenseEntryApproval.ApprovalTypeName, 
                      dbo.vueAccountExpenseEntryApproval.AccountApprovalPathId, dbo.vueAccountExpenseEntryApproval.AccountApprovalTypeId, 
                      dbo.vueAccountExpenseEntryApproval.SystemApproverTypeId, dbo.vueAccountExpenseEntryApproval.AccountExternalUserId, 
                      dbo.vueAccountExpenseEntryApproval.AccountEmployeeId, dbo.vueAccountExpenseEntryApproval.ApprovalPathSequence, 
                      dbo.vueAccountExpenseEntryApproval.AccountExpenseEntryId, dbo.vueAccountExpenseEntryApproval.ExpenseApprovalPathId, 
                      dbo.vueAccountExpenseEntryApproval.ProjectName, dbo.vueAccountExpenseEntryApproval.ProjectDescription, 
                      dbo.vueAccountExpenseEntryApproval.ProjectCode, dbo.vueAccountExpenseEntryApproval.EmployeeName, 
                      dbo.vueAccountExpenseEntryApproval.Approved, dbo.vueAccountExpenseEntryApproval.ExpenseApprovalTypeId, 
                      dbo.vueAccountExpenseEntryApproval.AccountExpenseEntryDate, dbo.vueAccountExpenseEntryApproval.IsRejected, 
                      dbo.vueAccountExpenseEntryApproval.IsApproved, dbo.vueAccountExpenseEntryApproval.Amount, 
                      dbo.vueAccountExpenseEntryApproval.AccountExpenseName, dbo.vueAccountExpenseEntryApproval.IsBillable, 
                      dbo.vueAccountApproverType.MaxApprovalPathSequence, dbo.vueAccountExpenseEntryApproval.ExpenseEntryAccountEmployeeId, 
                      dbo.vueAccountExpenseEntryApproval.Description, dbo.vueAccountExpenseEntryApproval.AccountId, 
                      dbo.vueAccountExpenseEntryApproval.EMailAddress, dbo.vueAccountExpenseEntryApproval.Submitted, 
                      dbo.vueAccountExpenseEntryApproval.EmployeeManagerId, dbo.vueAccountExpenseEntryApproval.CurrencyCode, 
                      dbo.vueAccountExpenseEntryApproval.Rejected, dbo.vueAccountExpenseEntryApproval.AccountEmployeeExpenseSheetId, 
                      dbo.vueAccountCurrency.ExchangeRate'
GO
-- Drop View rptvueAccountProjects
Print 'Drop View rptvueAccountProjects'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountProjects' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountProjects]

GO
-- Create View rptvueAccountProjects
Print 'Create View rptvueAccountProjects'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountProjects' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountProjects
AS
SELECT     dbo.vueAccountProjectsForReport.AccountProjectId, dbo.vueAccountProjectsForReport.AccountId, 
                      dbo.vueAccountProjectsForReport.AccountProjectTypeId, dbo.vueAccountProjectsForReport.AccountClientId, 
                      dbo.vueAccountProjectsForReport.ProjectBillingTypeId, dbo.vueAccountProjectsForReport.ProjectName, 
                      dbo.vueAccountProjectsForReport.ProjectDescription, dbo.vueAccountProjectsForReport.StartDate, 
                      dbo.vueAccountProjectsForReport.AccountMilestoneId, dbo.vueAccountProjectsForReport.Deadline, 
                      dbo.vueAccountProjectsForReport.LeaderEmployeeId, dbo.vueAccountProjectsForReport.ProjectManagerEmployeeId, 
                      dbo.vueAccountProjectsForReport.EstimatedTime, dbo.vueAccountProjectsForReport.EstimatedDurationUnit, 
                      dbo.vueAccountProjectsForReport.ProjectCode, dbo.vueAccountProjectsForReport.DefaultBillingRate, dbo.vueAccountProjectsForReport.IsActive, 
                      dbo.vueAccountProjectsForReport.ProjectStatusId, dbo.vueAccountProjectsForReport.AccountPriorityId, dbo.vueAccountProjectsForReport.CreatedOn, 
                      dbo.vueAccountProjectsForReport.CreatedByEmployeeId, dbo.vueAccountProjectsForReport.ModifiedOn, 
                      dbo.vueAccountProjectsForReport.ModifiedByEmployeeId, dbo.vueAccountProjectsForReport.ProjectBillingRateTypeId, 
                      dbo.vueAccountProjectsForReport.TimeSheetApprovalTypeId, dbo.vueAccountProjectsForReport.ExpenseApprovalTypeId, 
                      dbo.vueAccountProjectsForReport.IsDisabled, dbo.vueAccountProjectsForReport.IsTemplate, dbo.vueAccountProjectsForReport.IsProject, 
                      dbo.vueAccountProjectsForReport.AccountProjectTemplateId, dbo.vueAccountProjectsForReport.ClientNick, 
                      dbo.vueAccountProjectsForReport.ClientName, dbo.vueAccountProjectsForReport.ProjectType, dbo.vueAccountProjectsForReport.BillingType, 
                      dbo.vueAccountProjectsForReport.Status, dbo.vueAccountProjectsForReport.EstimatedDuration, 
                      dbo.vueAccountProjectsForReport.AccountClientContactId, dbo.vueAccountProjectsForReport.AccountClientDepartmentId, 
                      dbo.vueAccountProjectsForReport.ClientDepartmentCode, dbo.vueAccountProjectsForReport.ClientDepartmentName, 
                      dbo.vueAccountProjectsForReport.ClientDepartmentLocation, dbo.vueAccountProjectsForReport.ExpenseApprovalTypeName, 
                      dbo.vueAccountProjectsForReport.TimesheetApprovalTypeName, dbo.vueAccountProjectsForReport.ClientContactName, 
                      dbo.vueAccountProjectsForReport.TeamLead, dbo.vueAccountProjectsForReport.ProjectManager, 
                      dbo.vueAccountProjectsForReport.ProjectBillingRateType, dbo.vueAccountProjectsForReport.BillableTotalHours, 
                      dbo.vueAccountProjectsForReport.NonBillableTotalHours, ISNULL(dbo.vueAccountProjectsForReport.TotalEmployeeCost, 0) AS TotalEmployeeCost, 
                      SUM(dbo.rptvueAccountProjectTasks.EstimatedCost) AS TotalTaskEstimatedCost, SUM(dbo.rptvueAccountProjectTasks.EstimatedHours) 
                      AS TotalTaskEstimatedHours, dbo.vueAccountProjectsForReport.TotalHours, dbo.vueAccountProjectsForReport.BillableTimeAmount, 
                      dbo.vueAccountProjectsForReport.NonBillableTimeAmount, dbo.vueAccountProjectsForReport.TotalTimeAmount
FROM         dbo.vueAccountProjectsForReport LEFT OUTER JOIN
                      dbo.rptvueAccountProjectTasks ON dbo.vueAccountProjectsForReport.AccountProjectId = dbo.rptvueAccountProjectTasks.AccountProjectId
GROUP BY dbo.vueAccountProjectsForReport.AccountProjectId, dbo.vueAccountProjectsForReport.AccountId, 
                      dbo.vueAccountProjectsForReport.AccountProjectTypeId, dbo.vueAccountProjectsForReport.AccountClientId, 
                      dbo.vueAccountProjectsForReport.ProjectBillingTypeId, dbo.vueAccountProjectsForReport.ProjectName, 
                      dbo.vueAccountProjectsForReport.ProjectDescription, dbo.vueAccountProjectsForReport.StartDate, 
                      dbo.vueAccountProjectsForReport.AccountMilestoneId, dbo.vueAccountProjectsForReport.Deadline, 
                      dbo.vueAccountProjectsForReport.LeaderEmployeeId, dbo.vueAccountProjectsForReport.ProjectManagerEmployeeId, 
                      dbo.vueAccountProjectsForReport.EstimatedTime, dbo.vueAccountProjectsForReport.EstimatedDurationUnit, 
                      dbo.vueAccountProjectsForReport.ProjectCode, dbo.vueAccountProjectsForReport.IsActive, dbo.vueAccountProjectsForReport.ProjectStatusId, 
                      dbo.vueAccountProjectsForReport.DefaultBillingRate, dbo.vueAccountProjectsForReport.AccountPriorityId, 
                      dbo.vueAccountProjectsForReport.CreatedOn, dbo.vueAccountProjectsForReport.CreatedByEmployeeId, dbo.vueAccountProjectsForReport.ModifiedOn, 
                      dbo.vueAccountProjectsForReport.ModifiedByEmployeeId, dbo.vueAccountProjectsForReport.ProjectBillingRateTypeId, 
                      dbo.vueAccountProjectsForReport.TimeSheetApprovalTypeId, dbo.vueAccountProjectsForReport.ExpenseApprovalTypeId, 
                      dbo.vueAccountProjectsForReport.IsDisabled, dbo.vueAccountProjectsForReport.IsTemplate, dbo.vueAccountProjectsForReport.IsProject, 
                      dbo.vueAccountProjectsForReport.AccountProjectTemplateId, dbo.vueAccountProjectsForReport.ClientNick, 
                      dbo.vueAccountProjectsForReport.ClientName, dbo.vueAccountProjectsForReport.ProjectType, dbo.vueAccountProjectsForReport.BillingType, 
                      dbo.vueAccountProjectsForReport.Status, dbo.vueAccountProjectsForReport.EstimatedDuration, 
                      dbo.vueAccountProjectsForReport.AccountClientContactId, dbo.vueAccountProjectsForReport.AccountClientDepartmentId, 
                      dbo.vueAccountProjectsForReport.ClientDepartmentCode, dbo.vueAccountProjectsForReport.ClientDepartmentName, 
                      dbo.vueAccountProjectsForReport.ClientDepartmentLocation, dbo.vueAccountProjectsForReport.ExpenseApprovalTypeName, 
                      dbo.vueAccountProjectsForReport.TimesheetApprovalTypeName, dbo.vueAccountProjectsForReport.ClientContactName, 
                      dbo.vueAccountProjectsForReport.TeamLead, dbo.vueAccountProjectsForReport.ProjectManager, 
                      dbo.vueAccountProjectsForReport.ProjectBillingRateType, dbo.vueAccountProjectsForReport.BillableTotalHours, 
                      dbo.vueAccountProjectsForReport.NonBillableTotalHours, dbo.vueAccountProjectsForReport.TotalEmployeeCost, 
                      dbo.vueAccountProjectsForReport.TotalHours, dbo.vueAccountProjectsForReport.BillableTimeAmount, 
                      dbo.vueAccountProjectsForReport.NonBillableTimeAmount, dbo.vueAccountProjectsForReport.TotalTimeAmount'
GO
-- Drop View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForEmployeeManager
Print 'Drop View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForEmployeeManager'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForEmployeeManager' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForEmployeeManager]
GO
-- Drop View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForProjectManager
Print 'Drop View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForProjectManager'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForProjectManager' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForProjectManager]
GO
-- Drop View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForTeamLead
Print 'Drop View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForTeamLead'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForTeamLead' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForTeamLead]
GO
-- Drop View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreference
Print 'Drop View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreference'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreference' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreference]
GO
-- Drop View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForAdministrator
Print 'Drop View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForAdministrator'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForAdministrator' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForAdministrator]
GO
-- Drop View vueAccountEmployeeTimeEntryApprovalPendingEmailWithPreference
Print 'Drop View vueAccountEmployeeTimeEntryApprovalPendingEmailWithPreference'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryApprovalPendingEmailWithPreference' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryApprovalPendingEmailWithPreference]
GO
-- Drop View vueAccountEMailNotificationPreference
Print 'Drop View vueAccountEMailNotificationPreference'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEMailNotificationPreference' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEMailNotificationPreference]
GO
-- Drop View vueAccountExpenseEntryApprovalPendingEmailWithPreference
Print 'Drop View vueAccountExpenseEntryApprovalPendingEmailWithPreference'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryApprovalPendingEmailWithPreference' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountExpenseEntryApprovalPendingEmailWithPreference]
GO
-- Drop View vueAccountEmployeeTimeEntryApprovalPendingEMail
Print 'Drop View vueAccountEmployeeTimeEntryApprovalPendingEMail'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryApprovalPendingEMail' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryApprovalPendingEMail]
GO
-- Drop View vueAccountExpenseEntryApprovalPendingEmail
Print 'Drop View vueAccountExpenseEntryApprovalPendingEmail'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryApprovalPendingEmail' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountExpenseEntryApprovalPendingEmail]
GO
-- Add Column Monday to AccountEMailNotificationPreference
Print 'Add Column Monday to AccountEMailNotificationPreference'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEMailNotificationPreference' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='Monday' AND TABLE_NAME='AccountEMailNotificationPreference'))
ALTER TABLE [dbo].[AccountEMailNotificationPreference]
	ADD [Monday] bit NULL
GO
-- Add Column Tuesday to AccountEMailNotificationPreference
Print 'Add Column Tuesday to AccountEMailNotificationPreference'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEMailNotificationPreference' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='Tuesday' AND TABLE_NAME='AccountEMailNotificationPreference'))
ALTER TABLE [dbo].[AccountEMailNotificationPreference]
	ADD [Tuesday] bit NULL
GO
-- Add Column Wednesday to AccountEMailNotificationPreference
Print 'Add Column Wednesday to AccountEMailNotificationPreference'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEMailNotificationPreference' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='Wednesday' AND TABLE_NAME='AccountEMailNotificationPreference'))
ALTER TABLE [dbo].[AccountEMailNotificationPreference]
	ADD [Wednesday] bit NULL
GO
-- Add Column Thursday to AccountEMailNotificationPreference
Print 'Add Column Thursday to AccountEMailNotificationPreference'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEMailNotificationPreference' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='Thursday' AND TABLE_NAME='AccountEMailNotificationPreference'))
ALTER TABLE [dbo].[AccountEMailNotificationPreference]
	ADD [Thursday] bit NULL
GO
-- Add Column Friday to AccountEMailNotificationPreference
Print 'Add Column Friday to AccountEMailNotificationPreference'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEMailNotificationPreference' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='Friday' AND TABLE_NAME='AccountEMailNotificationPreference'))
ALTER TABLE [dbo].[AccountEMailNotificationPreference]
	ADD [Friday] bit NULL
GO
-- Add Column Saturday to AccountEMailNotificationPreference
Print 'Add Column Saturday to AccountEMailNotificationPreference'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEMailNotificationPreference' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='Saturday' AND TABLE_NAME='AccountEMailNotificationPreference'))
ALTER TABLE [dbo].[AccountEMailNotificationPreference]
	ADD [Saturday] bit NULL
GO
-- Add Column Sunday to AccountEMailNotificationPreference
Print 'Add Column Sunday to AccountEMailNotificationPreference'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEMailNotificationPreference' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='Sunday' AND TABLE_NAME='AccountEMailNotificationPreference'))
ALTER TABLE [dbo].[AccountEMailNotificationPreference]
	ADD [Sunday] bit NULL
GO
-- Add Column IsWeekDayAllow to SystemEMailNotification
Print 'Add Column IsWeekDayAllow to SystemEMailNotification'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'SystemEMailNotification' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='IsWeekDayAllow' AND TABLE_NAME='SystemEMailNotification'))
ALTER TABLE [dbo].[SystemEMailNotification]
	ADD [IsWeekDayAllow] bit NULL
GO
-- Create View vueAccountExpenseEntryApprovalPendingEmail
Print 'Create View vueAccountExpenseEntryApprovalPendingEmail'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryApprovalPendingEmail' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountExpenseEntryApprovalPendingEmail
AS
SELECT     dbo.vueAccountExpenseEntryApprovalPendingApprover.AccountProjectId, dbo.vueAccountExpenseEntryApprovalPendingApprover.LeaderEmployeeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingApprover.ProjectManagerEmployeeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingApprover.ApprovalTypeName, 
                      dbo.vueAccountExpenseEntryApprovalPendingApprover.AccountApprovalPathId, 
                      dbo.vueAccountExpenseEntryApprovalPendingApprover.AccountApprovalTypeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingApprover.SystemApproverTypeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingApprover.AccountExternalUserId, 
                      dbo.vueAccountExpenseEntryApprovalPendingApprover.AccountEmployeeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingApprover.ApprovalPathSequence, 
                      dbo.vueAccountExpenseEntryApprovalPendingApprover.AccountExpenseEntryId, 
                      dbo.vueAccountExpenseEntryApprovalPendingApprover.ExpenseApprovalId, 
                      dbo.vueAccountExpenseEntryApprovalPendingApprover.ExpenseApprovalPathId, dbo.vueAccountExpenseEntryApprovalPendingApprover.ProjectName, 
                      dbo.vueAccountExpenseEntryApprovalPendingApprover.ProjectCode, dbo.vueAccountExpenseEntryApprovalPendingApprover.ProjectDescription, 
                      dbo.vueAccountExpenseEntryApprovalPendingApprover.EmployeeName, dbo.vueAccountExpenseEntryApprovalPendingApprover.Approved, 
                      dbo.vueAccountExpenseEntryApprovalPendingApprover.ExpenseApprovalTypeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingApprover.AccountExpenseEntryDate, 
                      dbo.vueAccountExpenseEntryApprovalPendingApprover.Comments, dbo.vueAccountExpenseEntryApprovalPendingApprover.IsRejected, 
                      dbo.vueAccountExpenseEntryApprovalPendingApprover.IsApproved, dbo.vueAccountExpenseEntryApprovalPendingApprover.Amount, 
                      dbo.vueAccountExpenseEntryApprovalPendingApprover.AccountExpenseName, dbo.vueAccountExpenseEntryApprovalPendingApprover.IsBillable, 
                      dbo.vueAccountExpenseEntryApprovalPendingApprover.ExpenseEntryAccountEmployeeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingApprover.Description, 
                      dbo.vueAccountExpenseEntryApprovalPendingApprover.MaxApprovalPathSequence, 
                      dbo.vueAccountExpenseEntryApprovalPendingApprover.ApproverEmployeeId, dbo.vueAccountExpenseEntryApprovalPendingApprover.AccountId, 
                      dbo.vueAccountExpenseEntryApprovalPendingApprover.EMailAddress, dbo.vueAccountExpenseEntryApprovalPendingApprover.EmployeeManagerId, 
                      dbo.vueAccountExpenseEntryApprovalPendingApprover.AccountEmployeeExpenseSheetId, 
                      dbo.vueAccountExpenseEntryApprovalPendingApprover.MasterDescription, 
                      dbo.vueAccountExpenseEntryApprovalPendingApprover.ExpenseSheetDate, 
                      dbo.vueAccountExpenseEntryApprovalPendingApprover.BaseCurrencyCode, dbo.vueAccountExpenseEntryApprovalPendingApprover.SubmittedDate, 
                      AccountEMailNotificationPreference_1.Monday, AccountEMailNotificationPreference_1.Tuesday, AccountEMailNotificationPreference_1.Wednesday, 
                      AccountEMailNotificationPreference_1.Thursday, AccountEMailNotificationPreference_1.Friday, AccountEMailNotificationPreference_1.Saturday, 
                      AccountEMailNotificationPreference_1.Sunday
FROM         dbo.vueAccountExpenseEntryApprovalPendingApprover LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_2 ON 
                      dbo.vueAccountExpenseEntryApprovalPendingApprover.AccountProjectId = AccountEMailNotificationPreference_2.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_1 ON 
                      dbo.vueAccountExpenseEntryApprovalPendingApprover.AccountId = AccountEMailNotificationPreference_1.AccountId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference ON 
                      dbo.vueAccountExpenseEntryApprovalPendingApprover.ApproverEmployeeId = dbo.AccountEMailNotificationPreference.AccountEmployeeId
WHERE     (AccountEMailNotificationPreference_1.SystemEMailNotificationId = 26) AND (AccountEMailNotificationPreference_1.Enabled = 1) AND 
                      (AccountEMailNotificationPreference_2.SystemEMailNotificationId = 27) AND (AccountEMailNotificationPreference_2.Enabled = 1) AND 
                      (dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = 28) AND (dbo.AccountEMailNotificationPreference.Enabled = 1)'
GO
-- Create View vueAccountExpenseEntryApprovalPendingEmailWithPreference
Print 'Create View vueAccountExpenseEntryApprovalPendingEmailWithPreference'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryApprovalPendingEmailWithPreference' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountExpenseEntryApprovalPendingEmailWithPreference
AS
SELECT     dbo.vueAccountExpenseEntryApprovalPendingEmail.AccountProjectId, dbo.vueAccountExpenseEntryApprovalPendingEmail.LeaderEmployeeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.ProjectManagerEmployeeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.ApprovalTypeName, dbo.vueAccountExpenseEntryApprovalPendingEmail.AccountApprovalPathId, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.AccountApprovalTypeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.SystemApproverTypeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.AccountExternalUserId, dbo.vueAccountExpenseEntryApprovalPendingEmail.AccountEmployeeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.ApprovalPathSequence, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.AccountExpenseEntryId, dbo.vueAccountExpenseEntryApprovalPendingEmail.ExpenseApprovalId, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.ExpenseApprovalPathId, dbo.vueAccountExpenseEntryApprovalPendingEmail.ProjectName, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.ProjectCode, dbo.vueAccountExpenseEntryApprovalPendingEmail.ProjectDescription, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.EmployeeName, dbo.vueAccountExpenseEntryApprovalPendingEmail.Approved, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.ExpenseApprovalTypeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.AccountExpenseEntryDate, dbo.vueAccountExpenseEntryApprovalPendingEmail.Comments, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.IsRejected, dbo.vueAccountExpenseEntryApprovalPendingEmail.IsApproved, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.Amount, dbo.vueAccountExpenseEntryApprovalPendingEmail.AccountExpenseName, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.IsBillable, dbo.vueAccountExpenseEntryApprovalPendingEmail.ExpenseEntryAccountEmployeeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.Description, dbo.vueAccountExpenseEntryApprovalPendingEmail.MaxApprovalPathSequence, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.ApproverEmployeeId, dbo.vueAccountExpenseEntryApprovalPendingEmail.AccountId, 
                      dbo.AccountEmployee.EMailAddress AS ApproverEmailAddress, dbo.AccountPreferences.ScheduledEmailSendTime, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.EMailAddress, dbo.vueAccountExpenseEntryApprovalPendingEmail.EmployeeManagerId, 
                      dbo.AccountPreferences.CultureInfoName, dbo.vueAccountExpenseEntryApprovalPendingEmail.AccountEmployeeExpenseSheetId, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.MasterDescription, dbo.vueAccountExpenseEntryApprovalPendingEmail.ExpenseSheetDate, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.BaseCurrencyCode, dbo.vueAccountExpenseEntryApprovalPendingEmail.SubmittedDate, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.vueAccountExpenseEntryApprovalPendingEmail.Monday, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.Tuesday, dbo.vueAccountExpenseEntryApprovalPendingEmail.Wednesday, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.Thursday, dbo.vueAccountExpenseEntryApprovalPendingEmail.Friday, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.Saturday, dbo.vueAccountExpenseEntryApprovalPendingEmail.Sunday
FROM         dbo.vueAccountExpenseEntryApprovalPendingEmail LEFT OUTER JOIN
                      dbo.AccountPreferences ON dbo.vueAccountExpenseEntryApprovalPendingEmail.AccountId = dbo.AccountPreferences.AccountId LEFT OUTER JOIN
                      dbo.AccountEmployee ON 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.ApproverEmployeeId = dbo.AccountEmployee.AccountEmployeeId
WHERE     (dbo.AccountEmployee.IsDeleted <> 1)'
GO
-- Create View vueAccountEmployeeTimeEntryApprovalPendingEMail
Print 'Create View vueAccountEmployeeTimeEntryApprovalPendingEMail'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryApprovalPendingEMail' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail
AS
SELECT     dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.AccountProjectId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.ProjectManagerEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.ApprovalTypeName, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.AccountApprovalPathId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.AccountApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.SystemApproverTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.AccountExternalUserId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.ApprovalPathSequence, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.AccountEmployeeTimeEntryId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.TimeSheetApprovalId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.TimeSheetApprovalPathId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.ProjectName, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.ProjectDescription, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.ProjectCode, dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.TaskName, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.AccountProjectTaskId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.TaskDescription, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.EmployeeName, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.Approved, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.TotalTime, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.TimeEntryDate, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.Comments, dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.IsReject, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.IsApproved, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.MaxApprovalPathSequence, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.TimeEntryAccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.AccountId, dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.EMailAddress, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.ApproverEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.Description, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.EmployeeManagerId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.TotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.NonBillableTotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.BillableTotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.AccountEmployeeTimeEntryPeriodId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.EmployeeWeekStartDay, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.TimeEntryStartDate, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.TimeEntryEndDate, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.TimeEntryViewType, AccountEMailNotificationPreference_1.Monday, 
                      AccountEMailNotificationPreference_1.Tuesday, AccountEMailNotificationPreference_1.Wednesday, AccountEMailNotificationPreference_1.Thursday, 
                      AccountEMailNotificationPreference_1.Friday, AccountEMailNotificationPreference_1.Saturday, AccountEMailNotificationPreference_1.Sunday
FROM         dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference ON 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.ApproverEmployeeId = dbo.AccountEMailNotificationPreference.AccountEmployeeId LEFT
                       OUTER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_2 ON 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.AccountProjectId = AccountEMailNotificationPreference_2.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_1 ON 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApprover.AccountId = AccountEMailNotificationPreference_1.AccountId
WHERE     (AccountEMailNotificationPreference_1.SystemEMailNotificationId = 11) AND (AccountEMailNotificationPreference_1.Enabled = 1) AND 
                      (AccountEMailNotificationPreference_2.SystemEMailNotificationId = 12) AND (AccountEMailNotificationPreference_2.Enabled = 1) AND 
                      (dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = 13) AND (dbo.AccountEMailNotificationPreference.Enabled = 1)'
GO
-- Create View vueAccountEMailNotificationPreference
Print 'Create View vueAccountEMailNotificationPreference'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEMailNotificationPreference' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEMailNotificationPreference
AS
SELECT     dbo.AccountEMailNotificationPreference.AccountEMailNotificationPreferenceId, dbo.AccountEMailNotificationPreference.AccountId, 
                      dbo.AccountEMailNotificationPreference.AccountProjectId, dbo.AccountEMailNotificationPreference.AccountEmployeeId, 
                      dbo.AccountEMailNotificationPreference.SystemEMailNotificationId, dbo.AccountEMailNotificationPreference.SystemEMailNotificationTypeId, 
                      dbo.AccountEMailNotificationPreference.Enabled, dbo.SystemEMailNotification.SystemEMailNotification, 
                      dbo.SystemEMailNotificationType.SystemEMailNotificationType, dbo.AccountEMailNotificationPreference.Monday, 
                      dbo.AccountEMailNotificationPreference.Tuesday, dbo.AccountEMailNotificationPreference.Wednesday, 
                      dbo.AccountEMailNotificationPreference.Thursday, dbo.AccountEMailNotificationPreference.Friday, dbo.AccountEMailNotificationPreference.Saturday, 
                      dbo.AccountEMailNotificationPreference.Sunday, dbo.SystemEMailNotification.IsWeekDayAllow
FROM         dbo.AccountEMailNotificationPreference LEFT OUTER JOIN
                      dbo.SystemEMailNotification ON 
                      dbo.AccountEMailNotificationPreference.SystemEMailNotificationTypeId = dbo.SystemEMailNotification.SystemEMailNotificationTypeId AND 
                      dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = dbo.SystemEMailNotification.SystemEMailNotificationId LEFT OUTER JOIN
                      dbo.SystemEMailNotificationType ON 
                      dbo.SystemEMailNotification.SystemEMailNotificationTypeId = dbo.SystemEMailNotificationType.SystemEMailNotificationTypeId'
GO
-- Create View vueAccountEmployeeTimeEntryApprovalPendingEmailWithPreference
Print 'Create View vueAccountEmployeeTimeEntryApprovalPendingEmailWithPreference'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryApprovalPendingEmailWithPreference' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailWithPreference
AS
SELECT     dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountProjectId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.ProjectManagerEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.ApprovalTypeName, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountApprovalPathId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.SystemApproverTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountExternalUserId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.ApprovalPathSequence, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountEmployeeTimeEntryId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TimeSheetApprovalId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TimeSheetApprovalPathId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.ProjectName, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.ProjectDescription, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.ProjectCode, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TaskName, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountProjectTaskId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TaskDescription, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.EmployeeName, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.Approved, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TotalTime, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TimeEntryDate, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.Comments, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.IsReject, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.IsApproved, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.MaxApprovalPathSequence, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TimeEntryAccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountId, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.EMailAddress, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.ApproverEmployeeId, dbo.AccountPreferences.ScheduledEmailSendTime, 
                      dbo.AccountEmployee.EMailAddress AS ApproverEMailAddress, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.Description, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.EmployeeManagerId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.NonBillableTotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.BillableTotalMinutes, dbo.AccountPreferences.CultureInfoName, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountEmployeeTimeEntryPeriodId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TimeEntryStartDate, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.EmployeeWeekStartDay, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TimeEntryEndDate, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TimeEntryViewType, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.Monday, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.Tuesday, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.Wednesday, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.Thursday, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.Friday, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.Saturday, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.Sunday
FROM         dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail LEFT OUTER JOIN
                      dbo.AccountEmployee ON 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.ApproverEmployeeId = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountPreferences ON dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountId = dbo.AccountPreferences.AccountId
WHERE     (dbo.AccountEmployee.IsDeleted <> 1)'
GO
-- Create View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForAdministrator
Print 'Create View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForAdministrator'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForAdministrator' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForAdministrator
AS
SELECT     dbo.AccountPreferences.ScheduledEmailSendTime, dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, 
                      dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.AccountId, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountRole.Role, dbo.AccountRole.MasterAccountRoleId, 
                      CASE WHEN dbo.AccountPreferences.CultureInfoName IS NULL 
                      THEN ''en-us'' WHEN dbo.AccountPreferences.CultureInfoName = ''auto'' THEN ''en-us'' ELSE CultureInfoName END AS CultureInfoName, 
                      dbo.AccountEMailNotificationPreference.Monday, dbo.AccountEMailNotificationPreference.Tuesday, 
                      dbo.AccountEMailNotificationPreference.Wednesday, dbo.AccountEMailNotificationPreference.Thursday, 
                      dbo.AccountEMailNotificationPreference.Friday, dbo.AccountEMailNotificationPreference.Saturday, 
                      dbo.AccountEMailNotificationPreference.Sunday
FROM         dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_2 RIGHT OUTER JOIN
                      dbo.AccountRole INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountRole.AccountRoleId = dbo.AccountEmployee.AccountRoleId ON 
                      AccountEMailNotificationPreference_2.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference ON dbo.AccountEmployee.AccountId = dbo.AccountEMailNotificationPreference.AccountId LEFT OUTER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployee.AccountId = dbo.AccountPreferences.AccountId
WHERE     (AccountEMailNotificationPreference_2.SystemEMailNotificationId = 34) AND (AccountEMailNotificationPreference_2.Enabled = 1) AND 
                      (dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = 33) AND (dbo.AccountEMailNotificationPreference.Enabled = 1) AND 
                      (dbo.AccountEmployee.EmployeeTypeId <> 2 OR
                      dbo.AccountEmployee.EmployeeTypeId IS NULL) AND (dbo.AccountRole.MasterAccountRoleId = 1) AND (dbo.AccountEmployee.IsDeleted <> 1)'
GO
-- Create View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreference
Print 'Create View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreference'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreference' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreference
AS
SELECT     dbo.AccountPreferences.ScheduledEmailSendTime, dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, 
                      dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.AccountId, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountEMailNotificationPreference.Monday, 
                      dbo.AccountEMailNotificationPreference.Tuesday, dbo.AccountEMailNotificationPreference.Wednesday, 
                      dbo.AccountEMailNotificationPreference.Thursday, dbo.AccountEMailNotificationPreference.Friday, dbo.AccountEMailNotificationPreference.Saturday, 
                      dbo.AccountEMailNotificationPreference.Sunday
FROM         dbo.AccountEMailNotificationPreference RIGHT OUTER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_2 RIGHT OUTER JOIN
                      dbo.AccountEmployee ON AccountEMailNotificationPreference_2.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId ON 
                      dbo.AccountEMailNotificationPreference.AccountId = dbo.AccountEmployee.AccountId LEFT OUTER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployee.AccountId = dbo.AccountPreferences.AccountId
WHERE     (AccountEMailNotificationPreference_2.SystemEMailNotificationId = 30) AND (AccountEMailNotificationPreference_2.Enabled = 1) AND 
                      (dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = 29) AND (dbo.AccountEMailNotificationPreference.Enabled = 1) AND 
                      (dbo.AccountEmployee.EmployeeTypeId <> 2 OR
                      dbo.AccountEmployee.EmployeeTypeId IS NULL) AND (dbo.AccountEmployee.IsDeleted <> 1)'
GO
-- Create View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForTeamLead
Print 'Create View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForTeamLead'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForTeamLead' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForTeamLead
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, MAX(dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName) AS EmployeeName, 
                      MAX(dbo.AccountEmployee.EMailAddress) AS EMailAddress, dbo.AccountEmployee.LastScheduledEmailSentTime, 
                      dbo.AccountPreferences.ScheduledEmailSendTime, dbo.AccountEmployee.AccountId, CASE WHEN MAX(dbo.AccountPreferences.CultureInfoName) 
                      IS NULL THEN ''en-us'' WHEN MAX(dbo.AccountPreferences.CultureInfoName) 
                      = ''auto'' THEN ''en-us'' ELSE MAX(dbo.AccountPreferences.CultureInfoName) END AS CultureInfoName, dbo.AccountEMailNotificationPreference.Monday, 
                      dbo.AccountEMailNotificationPreference.Tuesday, dbo.AccountEMailNotificationPreference.Wednesday, 
                      dbo.AccountEMailNotificationPreference.Thursday, dbo.AccountEMailNotificationPreference.Friday, dbo.AccountEMailNotificationPreference.Saturday, 
                      dbo.AccountEMailNotificationPreference.Sunday
FROM         dbo.AccountProject INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountProject.LeaderEmployeeId = dbo.AccountEmployee.AccountEmployeeId INNER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployee.AccountId = dbo.AccountPreferences.AccountId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference ON dbo.AccountEmployee.AccountId = dbo.AccountEMailNotificationPreference.AccountId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_1 ON 
                      dbo.AccountEmployee.AccountEmployeeId = AccountEMailNotificationPreference_1.AccountEmployeeId
WHERE     (dbo.AccountEmployee.EmployeeTypeId <> 2 OR
                      dbo.AccountEmployee.EmployeeTypeId IS NULL) AND (dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = 37) AND 
                      (dbo.AccountEMailNotificationPreference.Enabled = 1) AND (AccountEMailNotificationPreference_1.SystemEMailNotificationId = 38) AND 
                      (AccountEMailNotificationPreference_1.Enabled = 1) AND (dbo.AccountEmployee.IsDeleted <> 1)
GROUP BY dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountPreferences.ScheduledEmailSendTime, 
                      dbo.AccountEmployee.AccountId, dbo.AccountEMailNotificationPreference.Monday, dbo.AccountEMailNotificationPreference.Tuesday, 
                      dbo.AccountEMailNotificationPreference.Wednesday, dbo.AccountEMailNotificationPreference.Thursday, 
                      dbo.AccountEMailNotificationPreference.Friday, dbo.AccountEMailNotificationPreference.Saturday, dbo.AccountEMailNotificationPreference.Sunday'
GO
-- Create View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForProjectManager
Print 'Create View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForProjectManager'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForProjectManager' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForProjectManager
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, MAX(dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName) AS EmployeeName, 
                      MAX(dbo.AccountEmployee.EMailAddress) AS EMailAddress, dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountEmployee.AccountId, 
                      dbo.AccountPreferences.ScheduledEmailSendTime, CASE WHEN MAX(dbo.AccountPreferences.CultureInfoName) IS NULL 
                      THEN ''en-us'' WHEN MAX(dbo.AccountPreferences.CultureInfoName) = ''auto'' THEN ''en-us'' ELSE MAX(dbo.AccountPreferences.CultureInfoName) 
                      END AS CultureInfoName, AccountEMailNotificationPreference_1.Monday, AccountEMailNotificationPreference_1.Tuesday, 
                      AccountEMailNotificationPreference_1.Wednesday, AccountEMailNotificationPreference_1.Thursday, AccountEMailNotificationPreference_1.Friday, 
                      AccountEMailNotificationPreference_1.Saturday, AccountEMailNotificationPreference_1.Sunday
FROM         dbo.AccountProject INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountProject.ProjectManagerEmployeeId = dbo.AccountEmployee.AccountEmployeeId INNER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployee.AccountId = dbo.AccountPreferences.AccountId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference ON 
                      dbo.AccountEmployee.AccountEmployeeId = dbo.AccountEMailNotificationPreference.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_1 ON 
                      dbo.AccountEmployee.AccountId = AccountEMailNotificationPreference_1.AccountId
WHERE     (dbo.AccountEmployee.EmployeeTypeId <> 2 OR
                      dbo.AccountEmployee.EmployeeTypeId IS NULL) AND (dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = 36) AND 
                      (dbo.AccountEMailNotificationPreference.Enabled = 1) AND (AccountEMailNotificationPreference_1.SystemEMailNotificationId = 35) AND 
                      (AccountEMailNotificationPreference_1.Enabled = 1) AND (dbo.AccountEmployee.IsDeleted <> 1)
GROUP BY dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountEmployee.AccountId, 
                      dbo.AccountPreferences.ScheduledEmailSendTime, AccountEMailNotificationPreference_1.Monday, AccountEMailNotificationPreference_1.Tuesday, 
                      AccountEMailNotificationPreference_1.Wednesday, AccountEMailNotificationPreference_1.Thursday, AccountEMailNotificationPreference_1.Friday, 
                      AccountEMailNotificationPreference_1.Saturday, AccountEMailNotificationPreference_1.Sunday'
GO
-- Create View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForEmployeeManager
Print 'Create View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForEmployeeManager'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForEmployeeManager' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForEmployeeManager
AS
SELECT     dbo.AccountPreferences.ScheduledEmailSendTime, MAX(dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName) AS EmployeeName, 
                      AccountEmployee_1.AccountId, dbo.AccountEmployee.LastScheduledEmailSentTime, MAX(dbo.AccountEmployee.EMailAddress) AS EMailAddress, 
                      dbo.AccountEmployee.AccountEmployeeId, CASE WHEN MAX(dbo.AccountPreferences.CultureInfoName) IS NULL 
                      THEN ''en-us'' WHEN MAX(dbo.AccountPreferences.CultureInfoName) = ''auto'' THEN ''en-us'' ELSE MAX(dbo.AccountPreferences.CultureInfoName) 
                      END AS CultureInfoName, dbo.AccountEMailNotificationPreference.Monday, dbo.AccountEMailNotificationPreference.Tuesday, 
                      dbo.AccountEMailNotificationPreference.Wednesday, dbo.AccountEMailNotificationPreference.Thursday, 
                      dbo.AccountEMailNotificationPreference.Friday, dbo.AccountEMailNotificationPreference.Saturday, 
                      dbo.AccountEMailNotificationPreference.Sunday
FROM         dbo.AccountEmployee INNER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_2 INNER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON 
                      AccountEMailNotificationPreference_2.AccountEmployeeId = AccountEmployee_1.EmployeeManagerId ON 
                      dbo.AccountEmployee.AccountEmployeeId = AccountEmployee_1.EmployeeManagerId RIGHT OUTER JOIN
                      dbo.AccountEMailNotificationPreference ON AccountEmployee_1.AccountId = dbo.AccountEMailNotificationPreference.AccountId LEFT OUTER JOIN
                      dbo.AccountPreferences ON AccountEmployee_1.AccountId = dbo.AccountPreferences.AccountId
WHERE     (AccountEMailNotificationPreference_2.SystemEMailNotificationId = 32) AND (AccountEMailNotificationPreference_2.Enabled = 1) AND 
                      (dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = 31) AND (dbo.AccountEMailNotificationPreference.Enabled = 1) AND 
                      (AccountEmployee_1.EmployeeTypeId <> 2 OR
                      AccountEmployee_1.EmployeeTypeId IS NULL) AND (dbo.AccountEmployee.IsDeleted <> 1)
GROUP BY dbo.AccountPreferences.ScheduledEmailSendTime, AccountEmployee_1.AccountId, dbo.AccountEmployee.LastScheduledEmailSentTime, 
                      dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEMailNotificationPreference.Monday, dbo.AccountEMailNotificationPreference.Tuesday, 
                      dbo.AccountEMailNotificationPreference.Wednesday, dbo.AccountEMailNotificationPreference.Thursday, 
                      dbo.AccountEMailNotificationPreference.Friday, dbo.AccountEMailNotificationPreference.Saturday, dbo.AccountEMailNotificationPreference.Sunday'
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemEMailNotification]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemEMailNotification]'

UPDATE [dbo].[SystemEMailNotification] SET [IsWeekDayAllow]=1 WHERE [SystemEMailNotificationId]=11
UPDATE [dbo].[SystemEMailNotification] SET [IsWeekDayAllow]=1 WHERE [SystemEMailNotificationId]=26
UPDATE [dbo].[SystemEMailNotification] SET [IsWeekDayAllow]=1 WHERE [SystemEMailNotificationId]=29
UPDATE [dbo].[SystemEMailNotification] SET [IsWeekDayAllow]=1 WHERE [SystemEMailNotificationId]=31
UPDATE [dbo].[SystemEMailNotification] SET [IsWeekDayAllow]=1 WHERE [SystemEMailNotificationId]=33
UPDATE [dbo].[SystemEMailNotification] SET [IsWeekDayAllow]=1 WHERE [SystemEMailNotificationId]=35
UPDATE [dbo].[SystemEMailNotification] SET [IsWeekDayAllow]=1 WHERE [SystemEMailNotificationId]=37
GO
If exists(Select * from SystemData where version = '3.2.3')
BEGIN
Update AccountEmailNotificationPreference Set Monday=1,Tuesday=1,Wednesday=1,Thursday=1,Friday=1,Saturday=1,Sunday=1
END
GO
Update SystemData Set Version = '3.6.1' Where Version = '3.2.3' And SystemDataId = 1

GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'
If exists(Select * from SystemReportDataSourceField where SystemReportDataSourceFieldId = '7cd392f9-dc9d-4653-b681-49b1a2a7d9c2')
DELETE FROM [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId]='7cd392f9-dc9d-4653-b681-49b1a2a7d9c2'
GO
-- Drop View vueAccountEmployeeExpenseSheetForReport
Print 'Drop View vueAccountEmployeeExpenseSheetForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeExpenseSheetForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeExpenseSheetForReport]
GO
-- Create View vueAccountEmployeeExpenseSheetForReport
Print 'Create View vueAccountEmployeeExpenseSheetForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeExpenseSheetForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeExpenseSheetForReport
AS
SELECT     dbo.vueAccountEmployeeExpenseSheet.AccountEmployeeExpenseSheetId, dbo.vueAccountEmployeeExpenseSheet.AccountId, 
                      dbo.vueAccountEmployeeExpenseSheet.AccountEmployeeId, dbo.vueAccountEmployeeExpenseSheet.Description, 
                      dbo.vueAccountEmployeeExpenseSheet.ExpenseSheetDate, dbo.vueAccountEmployeeExpenseSheet.Amount, 
                      dbo.vueAccountEmployeeExpenseSheet.Currency, dbo.vueAccountEmployeeExpenseSheet.CurrencyCode, 
                      dbo.vueAccountEmployeeExpenseSheet.AccountCurrencyId, dbo.vueAccountEmployeeExpenseSheet.Status, 
                      dbo.vueAccountEmployeeExpenseSheet.InApproval, dbo.vueAccountEmployeeExpenseSheet.Submitted, 
                      dbo.vueAccountEmployeeExpenseSheet.Rejected, dbo.vueAccountEmployeeExpenseSheet.Approved, 
                      dbo.vueAccountEmployeeExpenseSheet.SubmittedDate, dbo.vueAccountEmployeeExpenseSheet.EmployeeName, 
                      dbo.vueAccountEmployeeExpenseSheet.EMailAddress, { fn DAYOFMONTH(dbo.vueAccountEmployeeExpenseSheet.ExpenseSheetDate) } AS DayNo, 
                      MONTH(dbo.vueAccountEmployeeExpenseSheet.ExpenseSheetDate) AS MonthNo, DATEPART(week, 
                      dbo.vueAccountEmployeeExpenseSheet.ExpenseSheetDate) - DATEPART(week, DATEADD(month, DATEDIFF(month, 0, 
                      dbo.vueAccountEmployeeExpenseSheet.ExpenseSheetDate), 0)) + 1 AS WeekNo, YEAR(dbo.vueAccountEmployeeExpenseSheet.ExpenseSheetDate) 
                      AS Year, LEFT({ fn MONTHNAME(dbo.vueAccountEmployeeExpenseSheet.ExpenseSheetDate) }, 3) + '' - '' + CONVERT(nvarchar(10), 
                      YEAR(dbo.vueAccountEmployeeExpenseSheet.ExpenseSheetDate)) AS Period, 
                      { fn DAYNAME(dbo.vueAccountEmployeeExpenseSheet.ExpenseSheetDate) } AS WeekDayName, dbo.vueAccountEmployee.DepartmentName, 
                      dbo.vueAccountEmployee.Role, dbo.vueAccountEmployee.AccountLocation, dbo.vueAccountEmployee.AccountDepartmentId, 
                      dbo.vueAccountEmployee.AccountLocationId, dbo.vueAccountEmployee.AccountRoleId, dbo.vueAccountEmployee.EmployeeCode, 
                      dbo.AccountDepartment.DepartmentCode, dbo.vueAccountEmployeeExpenseSheet.ExchangeRate, 
                      CASE WHEN dbo.vueAccountEmployeeExpenseSheet.ExchangeRate > 0 THEN dbo.vueAccountEmployeeExpenseSheet.Amount / dbo.vueAccountEmployeeExpenseSheet.ExchangeRate
                       ELSE 0 END AS CurrencyAmount, dbo.vueAccountEmployeeExpenseSheet.ApprovedOn, 
                      dbo.vueAccountEmployeeExpenseSheet.ApprovedByEmployeeId, dbo.vueAccountEmployeeExpenseSheet.RejectedOn, 
                      dbo.vueAccountEmployeeExpenseSheet.RejectedByEmployeeId
FROM         dbo.vueAccountEmployeeExpenseSheet LEFT OUTER JOIN
                      dbo.vueAccountEmployee ON 
                      dbo.vueAccountEmployeeExpenseSheet.AccountEmployeeId = dbo.vueAccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.vueAccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId'
GO
-- Add Column IsDeleted to AccountProject
Print 'Add Column IsDeleted to AccountProject'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProject' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='IsDeleted' AND TABLE_NAME='AccountProject'))
ALTER TABLE [dbo].[AccountProject]
	ADD [IsDeleted] bit NULL
GO
-- Drop View vueAccountProjects
Print 'Drop View vueAccountProjects'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountProjects' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountProjects]
GO
-- Create View vueAccountProjects
Print 'Create View vueAccountProjects'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountProjects' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountProjects
AS
SELECT     dbo.AccountProject.AccountProjectId, dbo.AccountProject.ProjectName, dbo.AccountProject.StartDate, dbo.AccountProject.ProjectCode, 
                      dbo.AccountParty.PartyName, dbo.AccountProject.AccountClientId, dbo.AccountProject.LeaderEmployeeId, 
                      dbo.AccountProject.ProjectManagerEmployeeId, AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName AS LeaderName, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS ProjectManagerName, dbo.AccountProject.AccountId, 
                      dbo.AccountProject.IsActive, dbo.AccountProject.Deadline, dbo.AccountProject.EstimatedDuration, dbo.AccountProject.EstimatedDurationUnit, 
                      dbo.AccountProject.ProjectStatusId, dbo.AccountStatus.Status, dbo.AccountProject.IsDisabled, dbo.AccountProject.ProjectDescription, 
                      dbo.AccountProject.IsTemplate, dbo.AccountProject.IsProject, dbo.AccountProject.AccountProjectTemplateId, 
                      dbo.SystemProjectBillingRateType.SystemProjectBillingRateType, dbo.AccountProject.AccountProjectTypeId, dbo.AccountProjectType.ProjectType, 
                      dbo.AccountProjectType.MasterAccountProjectTypeId, dbo.AccountProject.IsDeleted
FROM         dbo.AccountEmployee RIGHT OUTER JOIN
                      dbo.AccountStatus RIGHT OUTER JOIN
                      dbo.AccountProject INNER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId INNER JOIN
                      dbo.AccountProjectType ON dbo.AccountProject.AccountProjectTypeId = dbo.AccountProjectType.AccountProjectTypeId LEFT OUTER JOIN
                      dbo.SystemProjectBillingRateType ON 
                      dbo.AccountProject.ProjectBillingRateTypeId = dbo.SystemProjectBillingRateType.SystemProjectBillingRateTypeId ON 
                      dbo.AccountStatus.AccountStatusId = dbo.AccountProject.ProjectStatusId ON 
                      dbo.AccountEmployee.AccountEmployeeId = dbo.AccountProject.ProjectManagerEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON dbo.AccountProject.LeaderEmployeeId = AccountEmployee_1.AccountEmployeeId'

GO
-- Drop View vueAccountStatus
Print 'Drop View vueAccountStatus'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountStatus' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountStatus]

GO
-- Create View vueAccountStatus
Print 'Create View vueAccountStatus'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountStatus' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountStatus
AS
SELECT     dbo.AccountStatus.AccountStatusId, dbo.AccountStatus.AccountId, dbo.AccountStatus.StatusTypeId, dbo.AccountStatus.Status, 
                      dbo.SystemStatusType.SystemStatusType, dbo.AccountStatus.IsDisabled, dbo.AccountStatus.MasterAccountStatusId
FROM         dbo.AccountStatus LEFT OUTER JOIN
                      dbo.SystemStatusType ON dbo.AccountStatus.StatusTypeId = dbo.SystemStatusType.SystemStatusTypeId'

GO
-- Drop View rptvueAccountEmployeeTimeEntry
Print 'Drop View rptvueAccountEmployeeTimeEntry'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeEntry' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountEmployeeTimeEntry]

GO
-- Drop View vueAccountEmployeeTimeEntryForReport
Print 'Drop View vueAccountEmployeeTimeEntryForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryForReport]

GO
-- Drop View vueAccountEmployeeTimeEntryWithTimeOffForReport
Print 'Drop View vueAccountEmployeeTimeEntryWithTimeOffForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithTimeOffForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryWithTimeOffForReport]

GO
-- Create View vueAccountEmployeeTimeEntryWithTimeOffForReport
Print 'Create View vueAccountEmployeeTimeEntryWithTimeOffForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithTimeOffForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport
AS
SELECT     dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountProject.ProjectName, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 1 THEN dbo.AccountProjectTask.TaskName ELSE dbo.AccountTimeOffType.AccountTimeOffType END AS TaskName,
                       dbo.AccountEmployeeTimeEntry.TotalTime, dbo.AccountEmployeeTimeEntry.Approved, dbo.AccountEmployee.AccountEmployeeId, 
                      dbo.AccountProject.AccountProjectId, dbo.AccountEmployeeTimeEntry.TeamLeadApproved, dbo.AccountEmployeeTimeEntry.ProjectManagerApproved, 
                      dbo.AccountEmployeeTimeEntry.AdministratorApproved, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, dbo.AccountEmployeeTimeEntry.StartTime, 
                      dbo.AccountEmployeeTimeEntry.EndTime, dbo.AccountEmployeeTimeEntry.TimeEntryDate, dbo.AccountEmployeeTimeEntry.Description, 
                      ISNULL(dbo.AccountProject.AccountId, dbo.AccountTimeOffType.AccountId) AS AccountId, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime) AS TotalMinutes, DATEPART(dw, dbo.AccountEmployeeTimeEntry.TimeEntryDate) AS WeekDay, 
                      dbo.AccountParty.AccountPartyId, dbo.AccountParty.PartyName, dbo.AccountProjectTask.AccountProjectTaskId, dbo.AccountBillingType.BillingType, 
                      dbo.AccountProject.LeaderEmployeeId, dbo.AccountProject.ProjectManagerEmployeeId, dbo.AccountProject.TimeSheetApprovalTypeId, 
                      dbo.AccountProject.ExpenseApprovalTypeId, dbo.AccountProjectTask.IsBillable, dbo.AccountEmployeeTimeEntry.Rejected, 
                      dbo.AccountEmployeeTimeEntry.BillingRate, dbo.AccountProject.ProjectBillingRateTypeId, dbo.AccountEmployee.EmployeeCode, 
                      dbo.AccountEmployee.AccountDepartmentId, dbo.AccountDepartment.DepartmentName, dbo.AccountProjectTask.EstimatedCost, 
                      dbo.AccountProjectTask.EstimatedTimeSpent, dbo.AccountEmployeeTimeEntry.Submitted, dbo.AccountWorkType.AccountWorkType, 
                      dbo.AccountEmployee.EMailAddress, dbo.AccountLocation.AccountLocation, dbo.AccountCostCenter.AccountCostCenter, 
                      dbo.AccountCostCenter.AccountCostCenterCode, dbo.AccountWorkType.AccountWorkTypeCode, dbo.AccountProject.ProjectCode, dbo.AccountProjectTask.TaskCode, 
                      dbo.AccountLocation.AccountLocationId, dbo.vueAccountEmployeeTimeEntryApprovalLastAction.Comments, dbo.AccountEmployeeTimeEntry.BillingRateCurrencyId, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateCurrencyId, dbo.AccountEmployeeTimeEntry.BillingRateExchangeRate, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateExchangeRate, dbo.AccountEmployeeTimeEntry.AccountBaseCurrencyId, dbo.AccountProjectTask.AccountTaskTypeId, 
                      dbo.AccountProjectTask.TaskStatusId, dbo.AccountProjectTask.AccountPriorityId, dbo.AccountProjectTask.AccountProjectMilestoneId, 
                      dbo.AccountDepartment.DepartmentCode, dbo.AccountParty.PartyNick, dbo.AccountProjectTask.EstimatedCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction.ApprovedOn, dbo.AccountEmployeeTimeEntry.EmployeeRate, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountRole.Role, dbo.AccountProject.AccountProjectTypeId, dbo.AccountProject.ProjectDescription, dbo.AccountProjectTask.TaskDescription, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeExpenseBillingTimesheetId, dbo.AccountEmployeeTimeEntry.Billed, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Submitted = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS SubmittedHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Approved = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS ApprovedHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Rejected = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS RejectedHours, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, 
                      dbo.AccountPartyContact.FirstName + N'' '' + dbo.AccountPartyContact.LastName AS ClientContactName, 
                      dbo.AccountPartyDepartment.PartyDepartmentCode AS ClientDepartmentCode, dbo.AccountPartyDepartment.PartyDepartmentName AS ClientDepartmentName, 
                      dbo.AccountPartyDepartment.PartyDepartmentLocation AS ClientDepartmentLocation, dbo.AccountEmployeeTimeEntry.IsTimeOff, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId, CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 0 THEN ROUND(CONVERT(float, DATEPART(hh, 
                      dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS TimeOffHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS TimesheetHours, dbo.AccountWorkType.AccountWorkTypeId, 
                      dbo.AccountStatus.Status AS ProjectStatus
FROM         dbo.AccountProject LEFT OUTER JOIN
                      dbo.AccountStatus ON dbo.AccountProject.ProjectStatusId = dbo.AccountStatus.AccountStatusId RIGHT OUTER JOIN
                      dbo.AccountEmployeeTimeEntry INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeEntry.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId ON 
                      dbo.AccountProject.AccountProjectId = dbo.AccountEmployeeTimeEntry.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountProjectTask ON dbo.AccountEmployeeTimeEntry.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId LEFT OUTER JOIN
                      dbo.AccountTimeOffType ON dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId LEFT OUTER JOIN
                      dbo.AccountPartyDepartment ON dbo.AccountProject.AccountPartyDepartmentId = dbo.AccountPartyDepartment.AccountPartyDepartmentId LEFT OUTER JOIN
                      dbo.AccountPartyContact ON dbo.AccountProject.AccountPartyContactId = dbo.AccountPartyContact.AccountPartyContactId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryPeriod ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId LEFT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryApprovalLastAction.AccountEmployeeTimeEntryId LEFT OUTER JOIN
                      dbo.AccountCostCenter ON dbo.AccountEmployeeTimeEntry.AccountCostCenterId = dbo.AccountCostCenter.AccountCostCenterId LEFT OUTER JOIN
                      dbo.AccountWorkType ON dbo.AccountEmployeeTimeEntry.AccountWorkTypeId = dbo.AccountWorkType.AccountWorkTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId LEFT OUTER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId'

GO
-- Create View vueAccountEmployeeTimeEntryForReport
Print 'Create View vueAccountEmployeeTimeEntryForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryForReport
AS
SELECT     dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeName, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskName, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalTime, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Approved, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TeamLeadApproved, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectManagerApproved, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AdministratorApproved, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeTimeEntryId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.StartTime, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EndTime, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Description, N'''') AS Description, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.WeekDay, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountPartyId AS AccountClientId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.PartyName AS ClientName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectTaskId, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingType, N'''') 
                      AS BillingType, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectManagerEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ExpenseApprovalTypeId, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.IsBillable, 0) 
                      AS IsBillable, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Rejected, 0) AS Rejected, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRate, 0) AS BillingRate, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectBillingRateTypeId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeCode, N'''') AS EmployeeCode, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountDepartmentId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.DepartmentName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedCost, 0) AS EstimatedCost, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedTimeSpent, 0) AS EstimatedHours, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Submitted, 0) AS Submitted, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountWorkType, N'''') AS AccountWorkType, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EMailAddress, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountLocation, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountCostCenter, N'''') AS AccountCostCenter, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountCostCenterCode, N'''') AS AccountCostCenterCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountWorkTypeCode, N'''') AS AccountWorkTypeCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectCode, N'''') AS ProjectCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCode, N'''') AS TaskCode, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountLocationId, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Comments, N'''') 
                      AS ApproverComments, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes * dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRate / 60, 0) 
                      AS Amount, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRateCurrencyId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateExchangeRate, 0) AS BillingRateExchangeRate, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRateExchangeRate, 0) AS EmployeeRateExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountBaseCurrencyId, dbo.vueAccountCurrency.CurrencyCode AS BillingRateCurrencyCode, 
                      dbo.vueAccountCurrency.CurrencyCode AS AmountCurrencyCode, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountTaskTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskStatusId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountPriorityId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectMilestoneId, dbo.AccountTaskType.TaskType, dbo.AccountStatus.Status AS TaskStatus, 
                      dbo.AccountProjectMilestone.MilestoneDescription, dbo.AccountPriority.Priority, ROUND(CONVERT(float, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes) / 60, 2) AS TotalHours, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.DepartmentCode, N'''') AS DepartmentCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.PartyNick, N'''') AS ClientNick, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedCurrencyId, vueAccountCurrency_1.CurrencyCode AS EstimatedCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ApprovedOn, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRate, 0) 
                      AS EmployeeRate, vueAccountCurrency_2.CurrencyCode AS EmployeeRateCurrencyCode, 
                      AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName AS TeamLeader, 
                      AccountEmployee_2.FirstName + '' '' + AccountEmployee_2.LastName AS ProjectManager, 
                      ISNULL(dbo.AccountEmployee.FirstName + N'' '' + dbo.AccountEmployee.LastName, N'''') AS EmployeeManager, 
                      vueAccountCurrency_1.ExchangeRate AS EstimatedCurrencyExchangeRate, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes * dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRate / 60, 0) 
                      AS EmployeeCost, { fn DAYOFMONTH(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) } AS DayNo, 
                      MONTH(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) AS MonthNo, DATEPART(week, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) - DATEPART(week, DATEADD(month, DATEDIFF(month, 0, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate), 0)) + 1 AS WeekNo, 
                      YEAR(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) AS Year, 
                      LEFT({ fn MONTHNAME(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) }, 3) + '' - '' + CONVERT(nvarchar(10), 
                      YEAR(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate)) AS Period, 
                      { fn DAYNAME(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) } AS WeekDayName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountRoleId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Role, 
                      dbo.AccountProjectType.ProjectType, dbo.AccountRole.Role AS ProjectRole, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectDescription, N'''') 
                      AS ProjectDescription, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskDescription, N'''') AS TaskDescription, 
                      dbo.AccountTimeExpenseBilling.InvoiceNumber, dbo.AccountTimeExpenseBilling.InvoiceDate, dbo.AccountProjectType.AccountProjectTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Billed, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeTimeEntryPeriodId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientContactName, N'''') AS ClientContactName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentCode, N'''') AS ClientDepartmentCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentName, N'''') AS ClientDepartmentName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentLocation, N'''') AS ClientDepartmentLocation, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.IsTimeOff, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountWorkTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectStatus
FROM         dbo.AccountRole INNER JOIN
                      dbo.AccountProjectEmployee ON dbo.AccountRole.AccountRoleId = dbo.AccountProjectEmployee.AccountRoleId RIGHT OUTER JOIN
                      dbo.AccountTimeExpenseBillingTimesheet INNER JOIN
                      dbo.AccountTimeExpenseBilling ON 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingId = dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId RIGHT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport LEFT OUTER JOIN
                      dbo.AccountProjectType ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectTypeId = dbo.AccountProjectType.AccountProjectTypeId LEFT OUTER JOIN
                      dbo.AccountProjectMilestone ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectMilestoneId = dbo.AccountProjectMilestone.AccountProjectMilestoneId LEFT OUTER JOIN
                      dbo.AccountStatus ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskStatusId = dbo.AccountStatus.AccountStatusId LEFT OUTER JOIN
                      dbo.AccountPriority ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountPriorityId = dbo.AccountPriority.AccountPriorityId LEFT OUTER JOIN
                      dbo.AccountTaskType ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountTaskTypeId = dbo.AccountTaskType.AccountTaskTypeId ON 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingTimesheetId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountTimeExpenseBillingTimesheetId
                       ON dbo.AccountProjectEmployee.AccountEmployeeId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeId AND 
                      dbo.AccountProjectEmployee.AccountProjectId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.LeaderEmployeeId = AccountEmployee_1.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_2 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectManagerEmployeeId = AccountEmployee_2.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.AccountEmployee AS AccountEmployee_3 ON dbo.AccountEmployee.AccountEmployeeId = AccountEmployee_3.EmployeeManagerId ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeId = AccountEmployee_3.AccountEmployeeId LEFT OUTER JOIN
                      dbo.vueAccountCurrency AS vueAccountCurrency_2 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRateCurrencyId = vueAccountCurrency_2.AccountCurrencyId LEFT OUTER JOIN
                      dbo.vueAccountCurrency AS vueAccountCurrency_1 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedCurrencyId = vueAccountCurrency_1.AccountCurrencyId LEFT OUTER JOIN
                      dbo.vueAccountCurrency ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateCurrencyId = dbo.vueAccountCurrency.AccountCurrencyId'

GO
-- Create View rptvueAccountEmployeeTimeEntry
Print 'Create View rptvueAccountEmployeeTimeEntry'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeEntry' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountEmployeeTimeEntry
AS
SELECT     dbo.vueAccountEmployeeTimeEntryForReport.EmployeeName, dbo.vueAccountEmployeeTimeEntryForReport.ProjectName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskName, dbo.vueAccountEmployeeTimeEntryForReport.TotalTime, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Approved, dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectId, dbo.vueAccountEmployeeTimeEntryForReport.TeamLeadApproved, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManagerApproved, dbo.vueAccountEmployeeTimeEntryForReport.AdministratorApproved, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeTimeEntryId, dbo.vueAccountEmployeeTimeEntryForReport.StartTime, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EndTime, dbo.vueAccountEmployeeTimeEntryForReport.TimeEntryDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Description, dbo.vueAccountEmployeeTimeEntryForReport.AccountId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TotalMinutes, dbo.vueAccountEmployeeTimeEntryForReport.WeekDay, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientName, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectTaskId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingType, dbo.vueAccountEmployeeTimeEntryForReport.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManagerEmployeeId, dbo.vueAccountEmployeeTimeEntryForReport.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ExpenseApprovalTypeId, dbo.vueAccountEmployeeTimeEntryForReport.IsBillable, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Rejected, dbo.vueAccountEmployeeTimeEntryForReport.BillingRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectBillingRateTypeId, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountDepartmentId, dbo.vueAccountEmployeeTimeEntryForReport.DepartmentName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCost, dbo.vueAccountEmployeeTimeEntryForReport.EstimatedHours, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Submitted, dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkType, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EMailAddress, dbo.vueAccountEmployeeTimeEntryForReport.AccountLocation, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountCostCenter, dbo.vueAccountEmployeeTimeEntryForReport.AccountCostCenterCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkTypeCode, dbo.vueAccountEmployeeTimeEntryForReport.ProjectCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCode, dbo.vueAccountEmployeeTimeEntryForReport.AccountLocationId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ApproverComments, dbo.vueAccountEmployeeTimeEntryForReport.Amount, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingRateCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountBaseCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.BillingRateCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AmountCurrencyCode, CASE WHEN vueAccountEmployeeTimeEntryForReport.Submitted = 1 AND 
                      vueAccountEmployeeTimeEntryForReport.Approved = 0 THEN ''Submitted'' WHEN vueAccountEmployeeTimeEntryForReport.Approved = 1 THEN ''Approved'' WHEN vueAccountEmployeeTimeEntryForReport.Rejected
                       = 1 THEN ''Rejected'' WHEN vueAccountEmployeeTimeEntryForReport.Submitted = 0 AND vueAccountEmployeeTimeEntryForReport.Approved = 0 AND 
                      vueAccountEmployeeTimeEntryForReport.Rejected = 0 THEN ''Not Submitted'' END AS ApprovalStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountTaskTypeId, dbo.vueAccountEmployeeTimeEntryForReport.TaskStatusId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountPriorityId, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectMilestoneId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskType, dbo.vueAccountEmployeeTimeEntryForReport.TaskStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.MilestoneDescription, dbo.vueAccountEmployeeTimeEntryForReport.Priority, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TotalHours, dbo.vueAccountEmployeeTimeEntryForReport.DepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientNick, dbo.vueAccountEmployeeTimeEntryForReport.AccountClientId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ApprovedOn, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateCurrencyCode, dbo.vueAccountEmployeeTimeEntryForReport.TeamLeader, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManager, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeManager, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate, 0) AS EstimatedCurrencyExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCost, dbo.vueAccountEmployeeTimeEntryForReport.AccountRoleId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Role, dbo.vueAccountEmployeeTimeEntryForReport.WeekDayName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Period, dbo.vueAccountEmployeeTimeEntryForReport.Year, dbo.vueAccountEmployeeTimeEntryForReport.WeekNo, 
                      dbo.vueAccountEmployeeTimeEntryForReport.MonthNo, dbo.vueAccountEmployeeTimeEntryForReport.DayNo, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 1 THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours ELSE 0 END AS BillableTotalHours,
                       CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable
                       IS NULL THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours ELSE 0 END AS NonBillableTotalHours, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCost / dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate
                       ELSE 0 END AS CurrencyEmployeeCost, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.Amount / dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate
                       ELSE 0 END AS CurrencyAmount, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCost / dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate
                       ELSE 0 END AS CurrencyEstimatedCost, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate / dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate
                       ELSE 0 END AS CurrencyBillingRate, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRate / dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate
                       ELSE 0 END AS CurrencyEmployeeRate, dbo.vueAccountEmployeeTimeEntryForReport.ProjectRole, dbo.vueAccountEmployeeTimeEntryForReport.ProjectType, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectDescription, dbo.vueAccountEmployeeTimeEntryForReport.TaskDescription, 
                      dbo.vueAccountEmployeeTimeEntryForReport.InvoiceNumber, dbo.vueAccountEmployeeTimeEntryForReport.InvoiceDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectTypeId, dbo.vueAccountEmployeeTimeEntryForReport.Billed, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientContactName, dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentName, dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentLocation, 
                      dbo.vueAccountEmployeeTimeEntryForReport.IsTimeOff, dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkTypeId, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 1 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate * dbo.vueAccountEmployeeTimeEntryForReport.TotalHours
                       ELSE 0 END AS BillableTotalAmount, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate * dbo.vueAccountEmployeeTimeEntryForReport.TotalHours
                       ELSE 0 END AS NonBillableTotalAmount, dbo.vueAccountEmployeeTimeEntryForReport.ProjectStatus
FROM         dbo.vueAccountEmployeeTimeEntryForReport INNER JOIN
                      dbo.vueAccountEmployeeTimeEntryWithLastStatus ON 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryWithLastStatus.AccountEmployeeTimeEntryId'

GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'
if not exists(Select * from [dbo].[SystemReportDataSourceField] where [SystemReportDataSourceFieldId] = '84d7a879-f6b9-4989-a4ef-58733f565a7e')
BEGIN
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('84d7a879-f6b9-4989-a4ef-58733f565a7e', '3a080202-6842-4eca-8c79-a945978810b4', N'ProjectStatus', 125, 0, NULL, NULL, 66, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Project Status', 0, 0)
END
GO
-- Drop Trigger AuditTriggerAccountEmployeeTimeEntryPeriod
Print 'Drop Trigger AuditTriggerAccountEmployeeTimeEntryPeriod'
GO
IF (EXISTS(SELECT * FROM sysobjects WHERE id = OBJECT_ID(N'[dbo].[AuditTriggerAccountEmployeeTimeEntryPeriod]') AND [type]='TR'))
DROP TRIGGER [dbo].[AuditTriggerAccountEmployeeTimeEntryPeriod]
GO
-- Drop Trigger tr_trigtest
Print 'Drop Trigger tr_trigtest'
GO
IF (EXISTS(SELECT * FROM sysobjects WHERE id = OBJECT_ID(N'[dbo].[tr_trigtest]') AND [type]='TR'))
DROP TRIGGER [dbo].[tr_trigtest]
GO
-- Drop Trigger AuditTriggerAccountExpenseEntry
Print 'Drop Trigger AuditTriggerAccountExpenseEntry'
GO
IF (EXISTS(SELECT * FROM sysobjects WHERE id = OBJECT_ID(N'[dbo].[AuditTriggerAccountExpenseEntry]') AND [type]='TR'))
DROP TRIGGER [dbo].[AuditTriggerAccountExpenseEntry]
GO
-- Drop Trigger AuditTriggerAccountEmployeeTimeEntry
Print 'Drop Trigger AuditTriggerAccountEmployeeTimeEntry'
GO
IF (EXISTS(SELECT * FROM sysobjects WHERE id = OBJECT_ID(N'[dbo].[AuditTriggerAccountEmployeeTimeEntry]') AND [type]='TR'))
DROP TRIGGER [dbo].[AuditTriggerAccountEmployeeTimeEntry]
GO
-- Drop Trigger AuditTriggerAccountEmployeeExpenseSheet
Print 'Drop Trigger AuditTriggerAccountEmployeeExpenseSheet'
GO
IF (EXISTS(SELECT * FROM sysobjects WHERE id = OBJECT_ID(N'[dbo].[AuditTriggerAccountEmployeeExpenseSheet]') AND [type]='TR'))
DROP TRIGGER [dbo].[AuditTriggerAccountEmployeeExpenseSheet]
GO
-- Create Trigger AuditTriggerAccountEmployeeExpenseSheet
Print 'Create Trigger AuditTriggerAccountEmployeeExpenseSheet'
GO
IF NOT (EXISTS(SELECT * FROM sysobjects WHERE id = OBJECT_ID(N'[dbo].[AuditTriggerAccountEmployeeExpenseSheet]') AND [type]='TR'))
EXEC sp_executesql N'
CREATE trigger [AuditTriggerAccountEmployeeExpenseSheet] on [dbo].[AccountEmployeeExpenseSheet] for insert, update, delete
as

declare @bit int ,
	@field int ,
	@maxfield int ,
	@char int ,
	@fieldname nvarchar(256) ,
	@TableName nvarchar(256) ,
	@PKCols nvarchar(2000) ,
	@sql nvarchar(4000), 
	@UpdateDate nvarchar(42) ,
	@UserName nvarchar(256) ,
	@Type nchar(1) ,
	@PKSelect nvarchar(2000)
	
	select @TableName = ''AccountEmployeeExpenseSheet''

	-- date and user
	select 	@UserName = 0 ,
		@UpdateDate = convert(nvarchar(16), getdate(), 112) + '' '' + convert(nvarchar(16), getdate(), 114)



	-- Action
	if exists (select * from inserted)
		if exists (select * from deleted)
			Begin
				select @Type = ''U''
				select @UserName  = ModifiedByEmployeeId from inserted
			End 

	-- get list of columns
	select * into #ins from inserted
	select * into #del from deleted
	
	-- Get primary key columns for full outer join
	select	@PKCols = coalesce(@PKCols + '' and'', '' on'') + '' i.'' + c.COLUMN_NAME + '' = d.'' + c.COLUMN_NAME
	from	INFORMATION_SCHEMA.TABLE_CONSTRAINTS pk ,
		INFORMATION_SCHEMA.KEY_COLUMN_USAGE c
	where 	pk.TABLE_NAME = @TableName
	and	CONSTRAINT_TYPE = ''PRIMARY KEY''
	and	c.TABLE_NAME = pk.TABLE_NAME
	and	c.CONSTRAINT_NAME = pk.CONSTRAINT_NAME
	
	-- Get primary key select for insert
	select @PKSelect = coalesce(@PKSelect+''+'','''') + ''''''<'' + COLUMN_NAME + ''=''''+convert(nvarchar(200),coalesce(i.'' + COLUMN_NAME +'',d.'' + COLUMN_NAME + ''))+''''>'''''' 
	from	INFORMATION_SCHEMA.TABLE_CONSTRAINTS pk ,
		INFORMATION_SCHEMA.KEY_COLUMN_USAGE c
	where 	pk.TABLE_NAME = @TableName
	and	CONSTRAINT_TYPE = ''PRIMARY KEY''
	and	c.TABLE_NAME = pk.TABLE_NAME
	and	c.CONSTRAINT_NAME = pk.CONSTRAINT_NAME
	
	if @PKCols is null
	begin
		raiserror(''no PK on table %s'', 16, -1, @TableName)
		return
	end
	
	select @field = 0, @maxfield = max(ORDINAL_POSITION) from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME = @TableName
	while @field < @maxfield
	begin
		select @field = min(ORDINAL_POSITION) from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME = @TableName and ORDINAL_POSITION > @field
		select @bit = (@field - 1 )% 8 + 1
		select @bit = power(2,@bit - 1)
		select @char = ((@field - 1) / 8) + 1
		if substring(COLUMNS_UPDATED(),@char, 1) & @bit > 0 or @Type in (''I'',''D'')
		begin
			select @fieldname = COLUMN_NAME from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME = @TableName and ORDINAL_POSITION = @field
			select @sql = 		''insert Audit (Type, TableName, PK, FieldName, OldValue, NewValue, UpdateDate, UserName)''
			select @sql = @sql + 	'' select '''''' + @Type + ''''''''
			select @sql = @sql + 	'','''''' + @TableName + ''''''''
			select @sql = @sql + 	'','' + Replace(Replace(@PKSelect,''<AccountEmployeeExpenseSheetId='',''''),''>'','''')
			select @sql = @sql + 	'','''''' + @fieldname + ''''''''
			select @sql = @sql + 	'',convert(nvarchar(2000),d.'' + @fieldname + '')''
			select @sql = @sql + 	'',convert(nvarchar(2000),i.'' + @fieldname + '')''
			select @sql = @sql + 	'','''''' + @UpdateDate + ''''''''
			select @sql = @sql + 	'','''''' + @UserName + ''''''''
			select @sql = @sql + 	'' from #ins i full outer join #del d''
			select @sql = @sql + 	@PKCols
			select @sql = @sql + 	'' where i.'' + @fieldname + '' <> d.'' + @fieldname 
			select @sql = @sql + 	'' or (i.'' + @fieldname + '' is null and  d.'' + @fieldname + '' is not null)'' 
			select @sql = @sql + 	'' or (i.'' + @fieldname + '' is not null and  d.'' + @fieldname + '' is null)'' 
			exec (@sql)
		end
	end'
GO
-- Create Trigger AuditTriggerAccountEmployeeTimeEntry
Print 'Create Trigger AuditTriggerAccountEmployeeTimeEntry'
GO
IF NOT (EXISTS(SELECT * FROM sysobjects WHERE id = OBJECT_ID(N'[dbo].[AuditTriggerAccountEmployeeTimeEntry]') AND [type]='TR'))
EXEC sp_executesql N'
CREATE trigger [AuditTriggerAccountEmployeeTimeEntry] on [dbo].[AccountEmployeeTimeEntry] for update, delete
as

declare @bit int ,
	@field int ,
	@maxfield int ,
	@char int ,
	@fieldname nvarchar(256) ,
	@TableName nvarchar(256) ,
	@PKCols nvarchar(2000) ,
	@sql nvarchar(4000), 
	@UpdateDate nvarchar(42) ,
	@UserName nvarchar(256) ,
	@Type nchar(1) ,
	@PKSelect nvarchar(2000)
	
	select @TableName = ''AccountEmployeeTimeEntry''

	-- date and user
	select 	@UserName = 0 ,
		@UpdateDate = convert(nvarchar(16), getdate(), 112) + '' '' + convert(nvarchar(16), getdate(), 114)



	-- Action
	if exists (select * from inserted)
		if exists (select * from deleted)
			Begin
				select @Type = ''U''
				select @UserName  = ModifiedByEmployeeId from inserted
			End 

	
	-- get list of columns
	select * into #ins from inserted
	select * into #del from deleted
	
	-- Get primary key columns for full outer join
	select	@PKCols = coalesce(@PKCols + '' and'', '' on'') + '' i.'' + c.COLUMN_NAME + '' = d.'' + c.COLUMN_NAME
	from	INFORMATION_SCHEMA.TABLE_CONSTRAINTS pk ,
		INFORMATION_SCHEMA.KEY_COLUMN_USAGE c
	where 	pk.TABLE_NAME = @TableName
	and	CONSTRAINT_TYPE = ''PRIMARY KEY''
	and	c.TABLE_NAME = pk.TABLE_NAME
	and	c.CONSTRAINT_NAME = pk.CONSTRAINT_NAME
	
	-- Get primary key select for insert
	select @PKSelect = coalesce(@PKSelect+''+'','''') + ''''''<'' + COLUMN_NAME + ''=''''+convert(nvarchar(200),coalesce(i.'' + COLUMN_NAME +'',d.'' + COLUMN_NAME + ''))+''''>'''''' 
	from	INFORMATION_SCHEMA.TABLE_CONSTRAINTS pk ,
		INFORMATION_SCHEMA.KEY_COLUMN_USAGE c
	where 	pk.TABLE_NAME = @TableName
	and	CONSTRAINT_TYPE = ''PRIMARY KEY''
	and	c.TABLE_NAME = pk.TABLE_NAME
	and	c.CONSTRAINT_NAME = pk.CONSTRAINT_NAME
	
	if @PKCols is null
	begin
		raiserror(''no PK on table %s'', 16, -1, @TableName)
		return
	end
	
	select @field = 0, @maxfield = max(ORDINAL_POSITION) from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME = @TableName
	while @field < @maxfield
	begin
		select @field = min(ORDINAL_POSITION) from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME = @TableName and ORDINAL_POSITION > @field
		select @bit = (@field - 1 )% 8 + 1
		select @bit = power(2,@bit - 1)
		select @char = ((@field - 1) / 8) + 1
		if substring(COLUMNS_UPDATED(),@char, 1) & @bit > 0 or @Type in (''I'',''D'')
		begin
			select @fieldname = COLUMN_NAME from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME = @TableName and ORDINAL_POSITION = @field
			select @sql = 		''insert Audit (Type, TableName, PK, FieldName, OldValue, NewValue, UpdateDate, UserName)''
			select @sql = @sql + 	'' select '''''' + @Type + ''''''''
			select @sql = @sql + 	'','''''' + @TableName + ''''''''
			select @sql = @sql + 	'','' + Replace(Replace(@PKSelect,''<AccountEmployeeTimeEntryId='',''''),''>'','''')
			select @sql = @sql + 	'','''''' + @fieldname + ''''''''
			select @sql = @sql + 	'',convert(nvarchar(2000),d.'' + @fieldname + '')''
			select @sql = @sql + 	'',convert(nvarchar(2000),i.'' + @fieldname + '')''
			select @sql = @sql + 	'','''''' + @UpdateDate + ''''''''
			select @sql = @sql + 	'','''''' + @UserName + ''''''''
			select @sql = @sql + 	'' from #ins i full outer join #del d''
			select @sql = @sql + 	@PKCols
			select @sql = @sql + 	'' where i.'' + @fieldname + '' <> d.'' + @fieldname 
			select @sql = @sql + 	'' or (i.'' + @fieldname + '' is null and  d.'' + @fieldname + '' is not null)'' 
			select @sql = @sql + 	'' or (i.'' + @fieldname + '' is not null and  d.'' + @fieldname + '' is null)'' 
			exec (@sql)
		end
	end'
GO
-- Create Trigger AuditTriggerAccountExpenseEntry
Print 'Create Trigger AuditTriggerAccountExpenseEntry'
GO
IF NOT (EXISTS(SELECT * FROM sysobjects WHERE id = OBJECT_ID(N'[dbo].[AuditTriggerAccountExpenseEntry]') AND [type]='TR'))
EXEC sp_executesql N'
CREATE trigger [AuditTriggerAccountExpenseEntry] on [dbo].[AccountExpenseEntry] for insert, update, delete
as

declare @bit int ,
	@field int ,
	@maxfield int ,
	@char int ,
	@fieldname nvarchar(256) ,
	@TableName nvarchar(256) ,
	@PKCols nvarchar(2000) ,
	@sql nvarchar(4000), 
	@UpdateDate nvarchar(42) ,
	@UserName nvarchar(256) ,
	@Type nchar(1) ,
	@PKSelect nvarchar(2000)
	
	select @TableName = ''AccountExpenseEntry''

	-- date and user
	select 	@UserName = 0 ,
		@UpdateDate = convert(nvarchar(16), getdate(), 112) + '' '' + convert(nvarchar(16), getdate(), 114)



	-- Action
	if exists (select * from inserted)
		if exists (select * from deleted)
			Begin
				select @Type = ''U''
				select @UserName  = ModifiedByEmployeeId from inserted
			End 
	
	-- get list of columns
	select * into #ins from inserted
	select * into #del from deleted
	
	-- Get primary key columns for full outer join
	select	@PKCols = coalesce(@PKCols + '' and'', '' on'') + '' i.'' + c.COLUMN_NAME + '' = d.'' + c.COLUMN_NAME
	from	INFORMATION_SCHEMA.TABLE_CONSTRAINTS pk ,
		INFORMATION_SCHEMA.KEY_COLUMN_USAGE c
	where 	pk.TABLE_NAME = @TableName
	and	CONSTRAINT_TYPE = ''PRIMARY KEY''
	and	c.TABLE_NAME = pk.TABLE_NAME
	and	c.CONSTRAINT_NAME = pk.CONSTRAINT_NAME
	
	-- Get primary key select for insert
	select @PKSelect = coalesce(@PKSelect+''+'','''') + ''''''<'' + COLUMN_NAME + ''=''''+convert(nvarchar(200),coalesce(i.'' + COLUMN_NAME +'',d.'' + COLUMN_NAME + ''))+''''>'''''' 
	from	INFORMATION_SCHEMA.TABLE_CONSTRAINTS pk ,
		INFORMATION_SCHEMA.KEY_COLUMN_USAGE c
	where 	pk.TABLE_NAME = @TableName
	and	CONSTRAINT_TYPE = ''PRIMARY KEY''
	and	c.TABLE_NAME = pk.TABLE_NAME
	and	c.CONSTRAINT_NAME = pk.CONSTRAINT_NAME
	
	if @PKCols is null
	begin
		raiserror(''no PK on table %s'', 16, -1, @TableName)
		return
	end
	
	select @field = 0, @maxfield = max(ORDINAL_POSITION) from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME = @TableName
	while @field < @maxfield
	begin
		select @field = min(ORDINAL_POSITION) from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME = @TableName and ORDINAL_POSITION > @field
		select @bit = (@field - 1 )% 8 + 1
		select @bit = power(2,@bit - 1)
		select @char = ((@field - 1) / 8) + 1
		if substring(COLUMNS_UPDATED(),@char, 1) & @bit > 0 or @Type in (''I'',''D'')
		begin
			select @fieldname = COLUMN_NAME from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME = @TableName and ORDINAL_POSITION = @field
			select @sql = 		''insert Audit (Type, TableName, PK, FieldName, OldValue, NewValue, UpdateDate, UserName)''
			select @sql = @sql + 	'' select '''''' + @Type + ''''''''
			select @sql = @sql + 	'','''''' + @TableName + ''''''''
			select @sql = @sql + 	'','' + Replace(Replace(@PKSelect,''<AccountExpenseEntryId='',''''),''>'','''')
			select @sql = @sql + 	'','''''' + @fieldname + ''''''''
			select @sql = @sql + 	'',convert(nvarchar(2000),d.'' + @fieldname + '')''
			select @sql = @sql + 	'',convert(nvarchar(2000),i.'' + @fieldname + '')''
			select @sql = @sql + 	'','''''' + @UpdateDate + ''''''''
			select @sql = @sql + 	'','''''' + @UserName + ''''''''
			select @sql = @sql + 	'' from #ins i full outer join #del d''
			select @sql = @sql + 	@PKCols
			select @sql = @sql + 	'' where i.'' + @fieldname + '' <> d.'' + @fieldname 
			select @sql = @sql + 	'' or (i.'' + @fieldname + '' is null and  d.'' + @fieldname + '' is not null)'' 
			select @sql = @sql + 	'' or (i.'' + @fieldname + '' is not null and  d.'' + @fieldname + '' is null)'' 
			exec (@sql)
		end
	end'
GO
-- Create Trigger tr_trigtest
Print 'Create Trigger tr_trigtest'
GO
IF NOT (EXISTS(SELECT * FROM sysobjects WHERE id = OBJECT_ID(N'[dbo].[tr_trigtest]') AND [type]='TR'))
EXEC sp_executesql N'
CREATE trigger [tr_trigtest] on [dbo].[AccountProjectTask] for update, delete
as

declare @bit int ,
	@field int ,
	@maxfield int ,
	@char int ,
	@fieldname nvarchar(256) ,
	@TableName nvarchar(256) ,
	@PKCols nvarchar(2000) ,
	@sql nvarchar(4000), 
	@UpdateDate nvarchar(42) ,
	@UserName nvarchar(256) ,
	@Type nchar(1) ,
	@PKSelect nvarchar(2000)
	
	select @TableName = ''AccountProjectTask''

	-- date and user
	select 	@UserName = 0 ,
		@UpdateDate = convert(nvarchar(16), getdate(), 112) + '' '' + convert(nvarchar(16), getdate(), 114)



	-- Action
	if exists (select * from inserted)
		if exists (select * from deleted)
			Begin
				select @Type = ''U''
				select @UserName  = ModifiedByEmployeeId from inserted
			End 
		else
			Begin
				select @UserName  = CreatedByEmployeeId from inserted
				select @Type = ''I''
			End
	else
		Begin
			select @Type = ''D''
			select @UserName  = ModifiedByEmployeeId from deleted
		End 
	
	-- get list of columns
	select * into #ins from inserted
	select * into #del from deleted
	
	-- Get primary key columns for full outer join
	select	@PKCols = coalesce(@PKCols + '' and'', '' on'') + '' i.'' + c.COLUMN_NAME + '' = d.'' + c.COLUMN_NAME
	from	INFORMATION_SCHEMA.TABLE_CONSTRAINTS pk ,
		INFORMATION_SCHEMA.KEY_COLUMN_USAGE c
	where 	pk.TABLE_NAME = @TableName
	and	CONSTRAINT_TYPE = ''PRIMARY KEY''
	and	c.TABLE_NAME = pk.TABLE_NAME
	and	c.CONSTRAINT_NAME = pk.CONSTRAINT_NAME
	
	-- Get primary key select for insert
	select @PKSelect = coalesce(@PKSelect+''+'','''') + ''''''<'' + COLUMN_NAME + ''=''''+convert(nvarchar(200),coalesce(i.'' + COLUMN_NAME +'',d.'' + COLUMN_NAME + ''))+''''>'''''' 
	from	INFORMATION_SCHEMA.TABLE_CONSTRAINTS pk ,
		INFORMATION_SCHEMA.KEY_COLUMN_USAGE c
	where 	pk.TABLE_NAME = @TableName
	and	CONSTRAINT_TYPE = ''PRIMARY KEY''
	and	c.TABLE_NAME = pk.TABLE_NAME
	and	c.CONSTRAINT_NAME = pk.CONSTRAINT_NAME
	
	if @PKCols is null
	begin
		raiserror(''no PK on table %s'', 16, -1, @TableName)
		return
	end
	
	select @field = 0, @maxfield = max(ORDINAL_POSITION) from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME = @TableName
	while @field < @maxfield
	begin
		select @field = min(ORDINAL_POSITION) from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME = @TableName and ORDINAL_POSITION > @field
		select @bit = (@field - 1 )% 8 + 1
		select @bit = power(2,@bit - 1)
		select @char = ((@field - 1) / 8) + 1
		if substring(COLUMNS_UPDATED(),@char, 1) & @bit > 0 or @Type in (''I'',''D'')
		begin
			select @fieldname = COLUMN_NAME from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME = @TableName and ORDINAL_POSITION = @field
			select @sql = 		''insert Audit (Type, TableName, PK, FieldName, OldValue, NewValue, UpdateDate, UserName)''
			select @sql = @sql + 	'' select '''''' + @Type + ''''''''
			select @sql = @sql + 	'','''''' + @TableName + ''''''''
			select @sql = @sql + 	'','' + Replace(Replace(@PKSelect,''<AccountProjectTaskId='',''''),''>'','''')
			select @sql = @sql + 	'','''''' + @fieldname + ''''''''
			select @sql = @sql + 	'',convert(nvarchar(2000),d.'' + @fieldname + '')''
			select @sql = @sql + 	'',convert(nvarchar(2000),i.'' + @fieldname + '')''
			select @sql = @sql + 	'','''''' + @UpdateDate + ''''''''
			select @sql = @sql + 	'','''''' + @UserName + ''''''''
			select @sql = @sql + 	'' from #ins i full outer join #del d''
			select @sql = @sql + 	@PKCols
			select @sql = @sql + 	'' where i.'' + @fieldname + '' <> d.'' + @fieldname 
			select @sql = @sql + 	'' or (i.'' + @fieldname + '' is null and  d.'' + @fieldname + '' is not null)'' 
			select @sql = @sql + 	'' or (i.'' + @fieldname + '' is not null and  d.'' + @fieldname + '' is null)'' 
			exec (@sql)
		end
	end'
GO
-- Create Trigger AuditTriggerAccountEmployeeTimeEntryPeriod
Print 'Create Trigger AuditTriggerAccountEmployeeTimeEntryPeriod'
GO
IF NOT (EXISTS(SELECT * FROM sysobjects WHERE id = OBJECT_ID(N'[dbo].[AuditTriggerAccountEmployeeTimeEntryPeriod]') AND [type]='TR'))
EXEC sp_executesql N'
CREATE trigger [AuditTriggerAccountEmployeeTimeEntryPeriod] on [dbo].[AccountEmployeeTimeEntryPeriod] for insert, update, delete
as

declare @bit int ,
	@field int ,
	@maxfield int ,
	@char int ,
	@fieldname nvarchar(256) ,
	@TableName nvarchar(256) ,
	@PKCols nvarchar(2000) ,
	@sql nvarchar(4000), 
	@UpdateDate nvarchar(42) ,
	@UserName nvarchar(256) ,
	@Type nchar(1) ,
	@PKSelect nvarchar(2000)
	
	select @TableName = ''AccountEmployeeTimeEntryPeriod''

	-- date and user
	select 	@UserName = 0 ,
		@UpdateDate = convert(nvarchar(16), getdate(), 112) + '' '' + convert(nvarchar(16), getdate(), 114)



	-- Action
	if exists (select * from inserted)
		if exists (select * from deleted)
			Begin
				select @Type = ''U''
				select @UserName  = ModifiedByEmployeeId from inserted
			End 
	
	-- get list of columns
	select * into #ins from inserted
	select * into #del from deleted
	
	-- Get primary key columns for full outer join
	select	@PKCols = coalesce(@PKCols + '' and'', '' on'') + '' i.'' + c.COLUMN_NAME + '' = d.'' + c.COLUMN_NAME
	from	INFORMATION_SCHEMA.TABLE_CONSTRAINTS pk ,
		INFORMATION_SCHEMA.KEY_COLUMN_USAGE c
	where 	pk.TABLE_NAME = @TableName
	and	CONSTRAINT_TYPE = ''PRIMARY KEY''
	and	c.TABLE_NAME = pk.TABLE_NAME
	and	c.CONSTRAINT_NAME = pk.CONSTRAINT_NAME
	
	-- Get primary key select for insert
	select @PKSelect = coalesce(@PKSelect+''+'','''') + ''''''<'' + COLUMN_NAME + ''=''''+convert(nvarchar(200),coalesce(i.'' + COLUMN_NAME +'',d.'' + COLUMN_NAME + ''))+''''>'''''' 
	from	INFORMATION_SCHEMA.TABLE_CONSTRAINTS pk ,
		INFORMATION_SCHEMA.KEY_COLUMN_USAGE c
	where 	pk.TABLE_NAME = @TableName
	and	CONSTRAINT_TYPE = ''PRIMARY KEY''
	and	c.TABLE_NAME = pk.TABLE_NAME
	and	c.CONSTRAINT_NAME = pk.CONSTRAINT_NAME
	
	if @PKCols is null
	begin
		raiserror(''no PK on table %s'', 16, -1, @TableName)
		return
	end
	
	select @field = 0, @maxfield = max(ORDINAL_POSITION) from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME = @TableName
	while @field < @maxfield
	begin
		select @field = min(ORDINAL_POSITION) from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME = @TableName and ORDINAL_POSITION > @field
		select @bit = (@field - 1 )% 8 + 1
		select @bit = power(2,@bit - 1)
		select @char = ((@field - 1) / 8) + 1
		if substring(COLUMNS_UPDATED(),@char, 1) & @bit > 0 or @Type in (''I'',''D'')
		begin
			select @fieldname = COLUMN_NAME from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME = @TableName and ORDINAL_POSITION = @field
			select @sql = 		''insert Audit (Type, TableName, PK, FieldName, OldValue, NewValue, UpdateDate, UserName)''
			select @sql = @sql + 	'' select '''''' + @Type + ''''''''
			select @sql = @sql + 	'','''''' + @TableName + ''''''''
			select @sql = @sql + 	'','' + Replace(Replace(@PKSelect,''<AccountEmployeeTimeEntryPeriodId='',''''),''>'','''')
			select @sql = @sql + 	'','''''' + @fieldname + ''''''''
			select @sql = @sql + 	'',convert(nvarchar(2000),d.'' + @fieldname + '')''
			select @sql = @sql + 	'',convert(nvarchar(2000),i.'' + @fieldname + '')''
			select @sql = @sql + 	'','''''' + @UpdateDate + ''''''''
			select @sql = @sql + 	'','''''' + @UserName + ''''''''
			select @sql = @sql + 	'' from #ins i full outer join #del d''
			select @sql = @sql + 	@PKCols
			select @sql = @sql + 	'' where i.'' + @fieldname + '' <> d.'' + @fieldname 
			select @sql = @sql + 	'' or (i.'' + @fieldname + '' is null and  d.'' + @fieldname + '' is not null)'' 
			select @sql = @sql + 	'' or (i.'' + @fieldname + '' is not null and  d.'' + @fieldname + '' is null)'' 
			exec (@sql)
		end
	end'
GO
If exists(Select * from SystemData where version = '3.6.1')
BEGIN
IF EXISTS(Select * From AccountPagePermission Where SystemSecurityCategoryPageId IN (144) AND AccountRoleId IN (Select AccountRoleId From AccountRole Where MasterAccountRoleId = 2))
BEGIN
Delete From AccountPagePermission 
Where SystemSecurityCategoryPageId IN (144) AND AccountRoleId IN 
(Select AccountRoleId From AccountRole Where MasterAccountRoleId = 2)
END
END
GO
Update SystemData Set Version = '3.6.2' Where Version = '3.6.1' And SystemDataId = 1
GO
-- =======================================================
-- Foreign Key Constraint Nochecks's for Table: [dbo].[AccountReportSummary]
-- =======================================================
Print ' Foreign Key Constraint Nochecks''s for Table: [dbo].[AccountReportSummary]'

ALTER TABLE [dbo].[AccountReportSummary] NOCHECK CONSTRAINT [FK_AccountReportSummary_AccountReport]
GO
-- =======================================================
-- Foreign Key Constraint Nochecks's for Table: [dbo].[AccountReportGroup]
-- =======================================================
Print ' Foreign Key Constraint Nochecks''s for Table: [dbo].[AccountReportGroup]'

ALTER TABLE [dbo].[AccountReportGroup] NOCHECK CONSTRAINT [FK_AccountReportGroup_AccountReport]
GO
-- =======================================================
-- Foreign Key Constraint Nochecks's for Table: [dbo].[AccountReportDataSourceMapping]
-- =======================================================
Print ' Foreign Key Constraint Nochecks''s for Table: [dbo].[AccountReportDataSourceMapping]'

ALTER TABLE [dbo].[AccountReportDataSourceMapping] NOCHECK CONSTRAINT [FK_AccountReportDataSourceMapping_AccountReport]
GO
-- =======================================================
-- Foreign Key Constraint Nochecks's for Table: [dbo].[AccountReportColumn]
-- =======================================================
Print ' Foreign Key Constraint Nochecks''s for Table: [dbo].[AccountReportColumn]'

ALTER TABLE [dbo].[AccountReportColumn] NOCHECK CONSTRAINT [FK_AccountReportColumn_AccountReport]
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[AccountReportColumn]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[AccountReportColumn]'
IF Exists(Select * From [dbo].[AccountReportColumn] WHERE [AccountReportColumnId]='e12b2f27-f7e6-4545-a7c1-3ebbf3fe0abe')
BEGIN
DELETE FROM [dbo].[AccountReportColumn] WHERE [AccountReportColumnId]='e12b2f27-f7e6-4545-a7c1-3ebbf3fe0abe'
DELETE FROM [dbo].[AccountReportColumn] WHERE [AccountReportColumnId]='87ea4556-d805-414b-b028-a3b6023c78cb'
DELETE FROM [dbo].[AccountReportColumn] WHERE [AccountReportColumnId]='e6eeab9d-ad37-4614-af0f-52ac2365aa2d'
DELETE FROM [dbo].[AccountReportColumn] WHERE [AccountReportColumnId]='0e4f96e3-de72-4dfd-b5db-9c2965a94c6a'
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'
IF Exists(Select * From [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId]='f36bde04-540f-4b27-82b8-e593d6aa3db0')
BEGIN
DELETE FROM [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId]='f36bde04-540f-4b27-82b8-e593d6aa3db0'
DELETE FROM [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId]='ca6c370e-bf1d-4f70-a050-2bffd678287b'
DELETE FROM [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId]='ef24fc5f-8ebc-44e8-87f8-ec729c13639e'
DELETE FROM [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId]='eebe5f66-ac43-4a15-ad87-2116b6acbf33'
DELETE FROM [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId]='2ca0b468-10cc-43bd-a521-137f55aba30a'
DELETE FROM [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId]='f76749a9-2b8b-4632-bf67-f38fecdce317'
DELETE FROM [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId]='ccc9aea9-6c2c-421c-86eb-08ef9d1a6562'
DELETE FROM [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId]='83362ab3-beb7-4dae-8b15-2abd01cee204'
DELETE FROM [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId]='40687ecf-7a13-4c07-9251-27d5bdcbc924'
DELETE FROM [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId]='1aa5bce3-bfbb-4699-a999-05c438329d4f'
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[AccountReport]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[AccountReport]'
IF NOT Exists(Select * From [dbo].[AccountReport] WHERE [AccountReportId]='eb0fc9d4-ef60-451b-834f-261dfb0228be')
BEGIN
INSERT INTO [dbo].[AccountReport] ([AccountReportId], [AccountReportCategoryId], [ReportName], [ReportDescription], [ReportIconPath], [AccountId], [SystemReportTypeId], [SystemReportId], [IsConsolidated], [ReportPageName], [ReportOrder], [ShowCompanyLogo], [ReportTitle], [ReportHeader], [ReportFooter]) VALUES ('eb0fc9d4-ef60-451b-834f-261dfb0228be', '98f4aa0d-7c01-466c-8b72-0e42e7f40f38', N'Employee Time Off Request', N'Employee Time Off Request', NULL, NULL, NULL, NULL, 0, NULL, 12, 0, N'Employee Time Off Request', N'', N'')
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSource]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSource]'
IF NOT Exists(Select * From [dbo].[SystemReportDataSource] WHERE [SystemReportDataSourceId]='07c1c8c9-c148-40c0-a700-af2fb1a0a149')
BEGIN
INSERT INTO [dbo].[SystemReportDataSource] ([SystemReportDataSourceId], [ReportDataSourceName], [ReportDatasource], [ReportDataSourceType], [DefaultIconPath]) VALUES ('07c1c8c9-c148-40c0-a700-af2fb1a0a149', N'Time Off Request', N'rptvueAccountEmployeeTimeOffRequest', N'View', NULL)
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'
IF NOT Exists(Select * From [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId]='2d369e05-45ad-4ef5-8edb-3dbabffeb13a')
BEGIN
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('2d369e05-45ad-4ef5-8edb-3dbabffeb13a', '07c1c8c9-c148-40c0-a700-af2fb1a0a149', N'Submitted', 70, 1, NULL, NULL, 8, 'b2cb6685-3a4b-4cf9-a15a-d01a63031e2b', N'Submitted', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('203c900a-79e3-4aa3-876f-2909a968a53d', '07c1c8c9-c148-40c0-a700-af2fb1a0a149', N'ProjectName', 250, 1, NULL, NULL, 7, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Project Name', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('bcbdc840-0f4b-40ae-96fc-3b9ae36bfe69', '07c1c8c9-c148-40c0-a700-af2fb1a0a149', N'AccountTimeOffPolicy', 175, 0, NULL, NULL, 17, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Time Off Policy', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('1e233e48-f077-499c-a119-0dca896e338a', '07c1c8c9-c148-40c0-a700-af2fb1a0a149', N'StartDate', 90, 1, NULL, NULL, 2, '48b9ef68-b4f6-4c75-b8de-c547939179ce', N'Start Date', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('7cfa214f-dd66-4559-8f73-12c36dad4061', '07c1c8c9-c148-40c0-a700-af2fb1a0a149', N'HoursOff', 70, 1, NULL, NULL, 4, '0da31ddc-9040-46fa-a33a-74e06a645050', N'Hours Off', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('3199fe4f-7271-4455-bde4-115874c9abc1', '07c1c8c9-c148-40c0-a700-af2fb1a0a149', N'EndDate', 90, 1, NULL, NULL, 3, '48b9ef68-b4f6-4c75-b8de-c547939179ce', N'End Date', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('f2553353-7b53-461f-aee1-074e92f5013d', '07c1c8c9-c148-40c0-a700-af2fb1a0a149', N'AccountTimeOffType', 175, 1, NULL, NULL, 1, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Time Off Type', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('b25c765b-ccc5-4455-bd11-5b487e7eaec5', '07c1c8c9-c148-40c0-a700-af2fb1a0a149', N'ApprovedOn', 90, 0, NULL, NULL, 13, '48b9ef68-b4f6-4c75-b8de-c547939179ce', N'Approved On', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('a09ff865-9016-4472-8f77-2db69d9cae39', '07c1c8c9-c148-40c0-a700-af2fb1a0a149', N'ProjectDescription', 300, 0, NULL, NULL, 22, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Project Description', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('41ffae66-848c-4bb3-8a88-418a6d396cfa', '07c1c8c9-c148-40c0-a700-af2fb1a0a149', N'Approved', 70, 1, NULL, NULL, 9, 'b2cb6685-3a4b-4cf9-a15a-d01a63031e2b', N'Approved', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('001c6567-8155-4089-8c72-41a582f0dcdd', '07c1c8c9-c148-40c0-a700-af2fb1a0a149', N'Rejected', 70, 1, NULL, NULL, 10, 'b2cb6685-3a4b-4cf9-a15a-d01a63031e2b', N'Rejected', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('72f08a75-7886-489e-9719-2317e36dd558', '07c1c8c9-c148-40c0-a700-af2fb1a0a149', N'Description', 325, 1, NULL, NULL, 6, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Description', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('ecaedf87-78fc-446e-872c-4b2023c06b2a', '07c1c8c9-c148-40c0-a700-af2fb1a0a149', N'InApproval', 70, 0, NULL, NULL, 11, 'b2cb6685-3a4b-4cf9-a15a-d01a63031e2b', N'In Approval', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('79ce00b3-518e-4512-9735-8bd1e5f8832f', '07c1c8c9-c148-40c0-a700-af2fb1a0a149', N'Role', 115, 0, NULL, NULL, 21, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Role', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('bb5e4ac7-dce9-4141-8056-305dd54d6113', '07c1c8c9-c148-40c0-a700-af2fb1a0a149', N'EmployeeName', 175, 0, NULL, NULL, 16, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Employee Name', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('354362cd-2706-47ba-b3b2-20279cf61430', '07c1c8c9-c148-40c0-a700-af2fb1a0a149', N'DayOff', 70, 1, NULL, NULL, 5, '0da31ddc-9040-46fa-a33a-74e06a645050', N'Days Off', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('81c3f2cd-40ed-4279-92aa-4fbe597df399', '07c1c8c9-c148-40c0-a700-af2fb1a0a149', N'RequestSubmitDate', 90, 0, NULL, NULL, 12, '48b9ef68-b4f6-4c75-b8de-c547939179ce', N'Submitted Date', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('da9cc1d1-b5e3-480d-bd4e-7eb5f9b76bac', '07c1c8c9-c148-40c0-a700-af2fb1a0a149', N'ApprovedByEmployeeName', 175, 0, NULL, NULL, 14, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Approved By', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('84f232d3-d5a2-4afd-b57c-89c920e054eb', '07c1c8c9-c148-40c0-a700-af2fb1a0a149', N'DepartmentName', 175, 0, NULL, NULL, 20, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Department Name', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('7d5fbdd3-00c9-496e-8da3-85ddbaa24f1b', '07c1c8c9-c148-40c0-a700-af2fb1a0a149', N'AccountLocation', 150, 0, NULL, NULL, 18, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Location', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('bc8dd8f1-f408-46a2-9df7-81bc9d7379f7', '07c1c8c9-c148-40c0-a700-af2fb1a0a149', N'IsTimeOffRequestRequired', 70, 0, NULL, NULL, 15, 'b2cb6685-3a4b-4cf9-a15a-d01a63031e2b', N'Request Required', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('f79836f6-b362-4087-b217-899272e69ad0', '07c1c8c9-c148-40c0-a700-af2fb1a0a149', N'DepartmentCode', 115, 0, NULL, NULL, 19, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Department Code', 0, 0)
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportFilterSourceMapping]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportFilterSourceMapping]'
IF NOT Exists(Select * From [dbo].[SystemReportFilterSourceMapping] WHERE [SystemReportFilterMappingId]='21171f0a-ea4e-4879-becb-53d82c330e56')
BEGIN
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('21171f0a-ea4e-4879-becb-53d82c330e56', '39e77f67-6659-45aa-8eef-6bc28103b617', '07c1c8c9-c148-40c0-a700-af2fb1a0a149', 1, 1, 3)
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('074e431c-0868-4ce5-b0bb-33a0173a91a9', '8f7f0cc7-e5e4-4f40-924a-60a126092cc0', '07c1c8c9-c148-40c0-a700-af2fb1a0a149', 1, 1, 2)
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('2070604a-ea1f-4b83-9095-cb0b8b55b26f', '40a2a9c4-d975-4167-91c7-c38fa497c9da', '07c1c8c9-c148-40c0-a700-af2fb1a0a149', 1, 1, 8)
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('16138f51-53d6-42da-8597-f88ddf6971aa', '5a1515da-e197-49c1-83fc-b0d5a9a3034a', '07c1c8c9-c148-40c0-a700-af2fb1a0a149', 1, 0, 10)
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('dcb6a958-1b5d-4fdf-ae34-d72086583e64', 'c29a0dd3-3337-43b7-9c3f-abf8e9ae9978', '07c1c8c9-c148-40c0-a700-af2fb1a0a149', 1, 1, 9)
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('b26a9e5c-c637-458a-bf87-1dcf83f41bf2', '4f471b5b-2394-4379-a666-d696e2dfb0ef', '07c1c8c9-c148-40c0-a700-af2fb1a0a149', 1, 1, 1)
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('def72fb1-9777-4ea7-9389-c1f46ff4914a', '0f76fe84-54e7-474a-a9e4-ca8584c03b72', '07c1c8c9-c148-40c0-a700-af2fb1a0a149', 1, 1, 7)
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('85867fc1-a4c8-4ead-9033-82d5d407e92b', '875614cd-c8ac-410d-aeae-af024a772739', '07c1c8c9-c148-40c0-a700-af2fb1a0a149', 1, 1, 5)
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('0c874adf-0807-4f97-ba5d-b1331cde2940', '0c06bda4-cfc8-4dd5-8510-cee57d47744d', '07c1c8c9-c148-40c0-a700-af2fb1a0a149', 1, 1, 6)
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('caf22afa-e064-4c36-915e-75222b3b46f6', '7feed6f5-67ab-4699-8866-8deddac27b9f', '07c1c8c9-c148-40c0-a700-af2fb1a0a149', 1, 1, 4)
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportPermission]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportPermission]'
IF NOT Exists(Select * From [dbo].[SystemReportPermission] WHERE [SystemReportPermissionId]='961f3d2a-cd06-44bb-9bf0-42a39a1419eb')
BEGIN
INSERT INTO [dbo].[SystemReportPermission] ([SystemReportPermissionId], [AccountReportId], [MasterAccountRoleId], [ShowReport], [AllowCustomization], [AllowAllUser], [AllowOwnReport], [AllowOwnTeam], [AllowOwnProject], [AllowOwnSubOrdinates], [AllowOwnApproval]) VALUES ('961f3d2a-cd06-44bb-9bf0-42a39a1419eb', 'eb0fc9d4-ef60-451b-834f-261dfb0228be', 2, 1, NULL, NULL, 1, NULL, NULL, NULL, NULL)
INSERT INTO [dbo].[SystemReportPermission] ([SystemReportPermissionId], [AccountReportId], [MasterAccountRoleId], [ShowReport], [AllowCustomization], [AllowAllUser], [AllowOwnReport], [AllowOwnTeam], [AllowOwnProject], [AllowOwnSubOrdinates], [AllowOwnApproval]) VALUES ('7e53ea7e-4b0a-450c-8ce3-6bc57a022916', 'eb0fc9d4-ef60-451b-834f-261dfb0228be', 100, 1, NULL, NULL, NULL, 1, NULL, NULL, NULL)
INSERT INTO [dbo].[SystemReportPermission] ([SystemReportPermissionId], [AccountReportId], [MasterAccountRoleId], [ShowReport], [AllowCustomization], [AllowAllUser], [AllowOwnReport], [AllowOwnTeam], [AllowOwnProject], [AllowOwnSubOrdinates], [AllowOwnApproval]) VALUES ('a939557f-07b0-4766-8e07-fb6a4b48e250', 'eb0fc9d4-ef60-451b-834f-261dfb0228be', 1, 1, 1, 1, NULL, NULL, NULL, NULL, NULL)
INSERT INTO [dbo].[SystemReportPermission] ([SystemReportPermissionId], [AccountReportId], [MasterAccountRoleId], [ShowReport], [AllowCustomization], [AllowAllUser], [AllowOwnReport], [AllowOwnTeam], [AllowOwnProject], [AllowOwnSubOrdinates], [AllowOwnApproval]) VALUES ('fa0b50fa-1d8f-4090-a6dd-a34c954c534f', 'eb0fc9d4-ef60-451b-834f-261dfb0228be', 101, 1, NULL, NULL, NULL, NULL, 1, NULL, NULL)
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[AccountReportColumn]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[AccountReportColumn]'
IF NOT Exists(Select * From [dbo].[AccountReportColumn] WHERE [AccountReportColumnId]='c53bd215-64e6-4337-bd35-2c8cfa045e2f')
BEGIN
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('c53bd215-64e6-4337-bd35-2c8cfa045e2f', 'eb0fc9d4-ef60-451b-834f-261dfb0228be', N'Time Off Type', 'f2553353-7b53-461f-aee1-074e92f5013d', 1, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('2a234732-e489-45c8-b150-2487692c3284', 'eb0fc9d4-ef60-451b-834f-261dfb0228be', N'Rejected', '001c6567-8155-4089-8c72-41a582f0dcdd', 10, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('e48ccb32-862e-4342-b346-7f9bbb741e0f', 'eb0fc9d4-ef60-451b-834f-261dfb0228be', N'Project Name', '203c900a-79e3-4aa3-876f-2909a968a53d', 7, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('64d66837-0a1f-4f06-8e9e-aff26ac9fe8a', 'eb0fc9d4-ef60-451b-834f-261dfb0228be', N'Days Off', '354362cd-2706-47ba-b3b2-20279cf61430', 5, 'd3c0763b-8f05-4fd5-aa69-37dbe17479ef', NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('17c12145-80af-4c99-8541-36eb6cab32ac', 'eb0fc9d4-ef60-451b-834f-261dfb0228be', N'Submitted', '2d369e05-45ad-4ef5-8edb-3dbabffeb13a', 8, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('49e27652-cf9e-4186-bf88-5b274a5bbfb9', 'eb0fc9d4-ef60-451b-834f-261dfb0228be', N'Description', '72f08a75-7886-489e-9719-2317e36dd558', 6, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('6f3d618e-d548-46b2-b564-7e959252a058', 'eb0fc9d4-ef60-451b-834f-261dfb0228be', N'Approved', '41ffae66-848c-4bb3-8a88-418a6d396cfa', 9, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('cad9dbc8-7303-4099-b0bb-d78e603a4340', 'eb0fc9d4-ef60-451b-834f-261dfb0228be', N'Start Date', '1e233e48-f077-499c-a119-0dca896e338a', 2, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('fb2c01d7-8a8d-4e1e-bda5-8371a3e52f7c', 'eb0fc9d4-ef60-451b-834f-261dfb0228be', N'End Date', '3199fe4f-7271-4455-bde4-115874c9abc1', 3, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('f5e500e8-2747-4450-90b7-4608c8dc6d76', 'eb0fc9d4-ef60-451b-834f-261dfb0228be', N'Hours Off', '7cfa214f-dd66-4559-8f73-12c36dad4061', 4, 'd3c0763b-8f05-4fd5-aa69-37dbe17479ef', NULL)
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[AccountReportDataSourceMapping]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[AccountReportDataSourceMapping]'
IF NOT Exists(Select * From [dbo].[AccountReportDataSourceMapping] WHERE [AccountReportDataSourceMappingId]='5cec9371-e780-48e3-a2a1-3c4e66f08a52')
BEGIN
INSERT INTO [dbo].[AccountReportDataSourceMapping] ([AccountReportDataSourceMappingId], [AccountReportId], [SystemReportDataSourceId]) VALUES ('5cec9371-e780-48e3-a2a1-3c4e66f08a52', 'eb0fc9d4-ef60-451b-834f-261dfb0228be', '07c1c8c9-c148-40c0-a700-af2fb1a0a149')
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[AccountReportGroup]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[AccountReportGroup]'
IF NOT Exists(Select * From [dbo].[AccountReportGroup] WHERE [AccountReportGroupId]='3222b16e-cfd2-4fc5-bddd-f07e05e9213f')
BEGIN
INSERT INTO [dbo].[AccountReportGroup] ([AccountReportGroupId], [AccountReportId], [ReportGroup], [ReportGroupFieldLabel], [ReportGroupFieldOrder], [SystemReportDataSourceFieldId]) VALUES ('3222b16e-cfd2-4fc5-bddd-f07e05e9213f', 'eb0fc9d4-ef60-451b-834f-261dfb0228be', N'EmployeeName', N'Employee Name', 0, 'bb5e4ac7-dce9-4141-8056-305dd54d6113')
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[AccountReportSummary]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[AccountReportSummary]'
IF NOT Exists(Select * From [dbo].[AccountReportSummary] WHERE [AccountReportSummaryId]='e1ec9257-013d-4bcc-a98f-53ac0b4525e4')
BEGIN
INSERT INTO [dbo].[AccountReportSummary] ([AccountReportSummaryId], [AccountReportGroupId], [AccountReportId], [SystemReportCalculationTypeId], [AccountReportColumnId], [SummaryCaption], [IsShowGroupTotal], [IsShowGrandTotal]) VALUES ('e1ec9257-013d-4bcc-a98f-53ac0b4525e4', '3222b16e-cfd2-4fc5-bddd-f07e05e9213f', 'eb0fc9d4-ef60-451b-834f-261dfb0228be', 'd3c0763b-8f05-4fd5-aa69-37dbe17479ef', 'f5e500e8-2747-4450-90b7-4608c8dc6d76', N'HoursOff', 1, 1)
INSERT INTO [dbo].[AccountReportSummary] ([AccountReportSummaryId], [AccountReportGroupId], [AccountReportId], [SystemReportCalculationTypeId], [AccountReportColumnId], [SummaryCaption], [IsShowGroupTotal], [IsShowGrandTotal]) VALUES ('293ad6f3-b1ed-46fd-a4ab-cb3ff4e9387a', '3222b16e-cfd2-4fc5-bddd-f07e05e9213f', 'eb0fc9d4-ef60-451b-834f-261dfb0228be', 'd3c0763b-8f05-4fd5-aa69-37dbe17479ef', '64d66837-0a1f-4f06-8e9e-aff26ac9fe8a', N'DaysOff', 1, 1)
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'

UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportFieldTypeId]='4af62dd1-d310-48fc-ac2f-9694ee0bf323' WHERE [SystemReportDataSourceFieldId]='f37fa646-d977-40ed-8838-a7223ceba5f5'
UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceField]=N'TotalHours', [SystemReportFieldTypeId]='f29d78e1-2a29-47b3-84b5-aee49740dce6', [SystemReportDataSourceFieldCaption]=N'Hours' WHERE [SystemReportDataSourceFieldId]='a34a37af-8b6c-4c87-9bbd-ea8e0cc440f8'
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[AccountReportColumn]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[AccountReportColumn]'

UPDATE [dbo].[AccountReportColumn] SET [Caption]=N'Hours' WHERE [AccountReportColumnId]='9d6942c9-88fb-4742-9426-1872ecfcc58e'
GO
-- =======================================================
-- Foreign Key Constraint Check's for Table: [dbo].[AccountReportColumn]
-- =======================================================
Print ' Foreign Key Constraint Check''s for Table: [dbo].[AccountReportColumn]'

ALTER TABLE [dbo].[AccountReportColumn] CHECK CONSTRAINT [FK_AccountReportColumn_AccountReport]
GO
-- =======================================================
-- Foreign Key Constraint Check's for Table: [dbo].[AccountReportDataSourceMapping]
-- =======================================================
Print ' Foreign Key Constraint Check''s for Table: [dbo].[AccountReportDataSourceMapping]'

ALTER TABLE [dbo].[AccountReportDataSourceMapping] CHECK CONSTRAINT [FK_AccountReportDataSourceMapping_AccountReport]
GO
-- =======================================================
-- Foreign Key Constraint Check's for Table: [dbo].[AccountReportGroup]
-- =======================================================
Print ' Foreign Key Constraint Check''s for Table: [dbo].[AccountReportGroup]'

ALTER TABLE [dbo].[AccountReportGroup] CHECK CONSTRAINT [FK_AccountReportGroup_AccountReport]
GO
-- =======================================================
-- Foreign Key Constraint Check's for Table: [dbo].[AccountReportSummary]
-- =======================================================
Print ' Foreign Key Constraint Check''s for Table: [dbo].[AccountReportSummary]'

ALTER TABLE [dbo].[AccountReportSummary] CHECK CONSTRAINT [FK_AccountReportSummary_AccountReport]
GO
-- Drop View rptvueAccountEmployeeTimeOffRequestWithTimeEntryReport
Print 'Drop View rptvueAccountEmployeeTimeOffRequestWithTimeEntryReport'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeOffRequestWithTimeEntryReport' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountEmployeeTimeOffRequestWithTimeEntryReport]
GO
-- Drop View vueAccountEmployeeTimeOffRequestWithTimeEntryReport
Print 'Drop View vueAccountEmployeeTimeOffRequestWithTimeEntryReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOffRequestWithTimeEntryReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeOffRequestWithTimeEntryReport]
GO
-- Create View vueAccountEmployeeTimeOffRequestWithTimeEntryReport
Print 'Create View vueAccountEmployeeTimeOffRequestWithTimeEntryReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOffRequestWithTimeEntryReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeOffRequestWithTimeEntryReport
AS
SELECT     dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, dbo.AccountEmployeeTimeEntry.AccountEmployeeId, 
                      dbo.AccountEmployeeTimeEntry.TimeEntryDate, dbo.AccountEmployeeTimeEntry.StartTime, dbo.AccountEmployeeTimeEntry.EndTime, 
                      dbo.AccountEmployeeTimeEntry.TotalTime, dbo.AccountEmployeeTimeEntry.Description, dbo.AccountEmployeeTimeEntry.Approved, 
                      dbo.AccountEmployeeTimeEntry.CreatedOn, dbo.AccountEmployeeTimeEntry.Submitted, dbo.AccountEmployeeTimeEntry.ModifiedOn, 
                      dbo.AccountEmployeeTimeEntry.Rejected, dbo.AccountEmployeeTimeEntry.IsTimeOff, dbo.AccountEmployeeTimeEntry.Hours, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeOffRequestId, 
                      dbo.AccountTimeOffType.AccountTimeOffType, dbo.AccountTimeOffType.IsTimeOffRequestRequired, dbo.AccountTimeOffType.AccountId, 
                      AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName AS EmployeeName, AccountEmployee_1.EMailAddress, 
                      dbo.AccountDepartment.DepartmentCode, dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountLocation.AccountLocation, 
                      AccountEmployee_1.EmployeeCode, dbo.AccountTimeOffPolicy.AccountTimeOffPolicy, dbo.AccountTimeOffPolicy.AccountTimeOffPolicyId, 
                      dbo.AccountLocation.AccountLocationId, dbo.AccountDepartment.AccountDepartmentId, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountEmployeeTimeEntry.AccountProjectId, dbo.AccountProject.ProjectName, ROUND(CONVERT(float, DATEPART(hh, 
                      dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) AS TotalHours
FROM         dbo.AccountTimeOffType RIGHT OUTER JOIN
                      dbo.AccountDepartment RIGHT OUTER JOIN
                      dbo.AccountEmployeeTimeEntry LEFT OUTER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeId = AccountEmployee_1.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountRole ON AccountEmployee_1.AccountRoleId = dbo.AccountRole.AccountRoleId LEFT OUTER JOIN
                      dbo.AccountLocation ON AccountEmployee_1.AccountLocationId = dbo.AccountLocation.AccountLocationId ON 
                      dbo.AccountDepartment.AccountDepartmentId = AccountEmployee_1.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountTimeOffPolicy ON AccountEmployee_1.AccountTimeOffPolicyId = dbo.AccountTimeOffPolicy.AccountTimeOffPolicyId ON 
                      dbo.AccountTimeOffType.AccountTimeOffTypeId = dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId
WHERE     (dbo.AccountEmployeeTimeEntry.IsTimeOff = 1)'
GO
-- Create View vueAccountEmployeeTimeOffRequestForReport
Print 'Create View vueAccountEmployeeTimeOffRequestForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOffRequestForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeOffRequestForReport
AS
SELECT     dbo.AccountEmployeeTimeOffRequest.AccountEmployeeTimeOffRequestId, dbo.AccountEmployeeTimeOffRequest.AccountTimeOffTypeId, 
                      dbo.AccountEmployeeTimeOffRequest.AccountEmployeeId, dbo.AccountEmployeeTimeOffRequest.RequestSubmitDate, 
                      dbo.AccountEmployeeTimeOffRequest.HoursOff, dbo.AccountEmployeeTimeOffRequest.StartDate, dbo.AccountEmployeeTimeOffRequest.EndDate, 
                      dbo.AccountEmployeeTimeOffRequest.InApproval, dbo.AccountEmployeeTimeOffRequest.Approved, dbo.AccountEmployeeTimeOffRequest.Rejected, 
                      dbo.AccountEmployeeTimeOffRequest.Description, dbo.AccountEmployeeTimeOffRequest.ApprovedOn, 
                      dbo.AccountEmployeeTimeOffRequest.ApprovedBy, dbo.AccountEmployeeTimeOffRequest.DayOff, 
                      dbo.AccountEmployeeTimeOffRequest.CreatedByEmployee, dbo.AccountEmployeeTimeOffRequest.CreatedOn, 
                      dbo.AccountEmployeeTimeOffRequest.ModifiedByEmployeeId, dbo.AccountEmployeeTimeOffRequest.ModifiedOn, 
                      dbo.AccountEmployeeTimeOffRequest.AccountId, dbo.AccountEmployeeTimeOffRequest.AccountProjectId, 
                      dbo.AccountTimeOffType.AccountTimeOffType, dbo.AccountTimeOffType.IsTimeOffRequestRequired, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountLocation.AccountLocationId, dbo.AccountTimeOffPolicy.AccountTimeOffPolicy, dbo.AccountDepartment.AccountDepartmentId, 
                      dbo.AccountDepartment.DepartmentCode, dbo.AccountDepartment.DepartmentName, dbo.AccountRole.AccountRoleId, dbo.AccountRole.Role, 
                      AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName AS ApprovedByEmployeeName, dbo.AccountProject.ProjectName, 
                      dbo.AccountProject.ProjectDescription, CASE WHEN rejected = 0 THEN CONVERT(bit, 1) ELSE CONVERT(bit, 0) END AS Submitted, 
                      dbo.AccountTimeOffPolicy.AccountTimeOffPolicyId
FROM         dbo.AccountLocation RIGHT OUTER JOIN
                      dbo.AccountTimeOffPolicy RIGHT OUTER JOIN
                      dbo.AccountRole RIGHT OUTER JOIN
                      dbo.AccountEmployeeTimeOffRequest LEFT OUTER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeOffRequest.AccountProjectId = dbo.AccountProject.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeOffRequest.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON dbo.AccountEmployeeTimeOffRequest.ApprovedBy = AccountEmployee_1.AccountEmployeeId ON 
                      dbo.AccountRole.AccountRoleId = dbo.AccountEmployee.AccountRoleId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId ON 
                      dbo.AccountTimeOffPolicy.AccountTimeOffPolicyId = dbo.AccountEmployee.AccountTimeOffPolicyId ON 
                      dbo.AccountLocation.AccountLocationId = dbo.AccountEmployee.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountTimeOffType ON dbo.AccountEmployeeTimeOffRequest.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId'
GO
-- Create View rptvueAccountEmployeeTimeOffRequestWithTimeEntryReport
Print 'Create View rptvueAccountEmployeeTimeOffRequestWithTimeEntryReport'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeOffRequestWithTimeEntryReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountEmployeeTimeOffRequestWithTimeEntryReport
AS
SELECT     AccountEmployeeTimeEntryId, AccountEmployeeId, TimeEntryDate, StartTime, EndTime, TotalTime, Description, Approved, CreatedOn, Submitted, 
                      ModifiedOn, Rejected, IsTimeOff, Hours, AccountTimeOffTypeId, AccountEmployeeTimeOffRequestId, AccountTimeOffType, IsTimeOffRequestRequired, 
                      AccountId, EmployeeName, EMailAddress, DepartmentCode, DepartmentName, Role, AccountLocation, EmployeeCode, AccountTimeOffPolicy, 
                      AccountTimeOffPolicyId, AccountLocationId, AccountDepartmentId, AccountRoleId, AccountProjectId, ProjectName, TotalHours
FROM         dbo.vueAccountEmployeeTimeOffRequestWithTimeEntryReport'
GO
-- Create View rptvueAccountEmployeeTimeOffRequest
Print 'Create View rptvueAccountEmployeeTimeOffRequest'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeOffRequest' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountEmployeeTimeOffRequest
AS
SELECT     AccountEmployeeTimeOffRequestId, AccountTimeOffTypeId, AccountEmployeeId, RequestSubmitDate, HoursOff, StartDate, EndDate, InApproval, 
                      Submitted, Approved, Rejected, Description, ApprovedOn, ApprovedBy, DayOff, CreatedByEmployee, CreatedOn, ModifiedByEmployeeId, ModifiedOn, 
                      AccountId, AccountProjectId, AccountTimeOffType, IsTimeOffRequestRequired, EmployeeName, AccountLocation, AccountLocationId, 
                      AccountTimeOffPolicy, AccountDepartmentId, DepartmentCode, DepartmentName, AccountRoleId, Role, ApprovedByEmployeeName, ProjectName, 
                      ProjectDescription, AccountTimeOffPolicyId
FROM         dbo.vueAccountEmployeeTimeOffRequestForReport'
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[AccountReport]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[AccountReport]'
Update [dbo].[AccountReport] Set [ReportIconPath]=N'/Images/EmployeeTimeOffRequest.gif' Where [AccountReportId] = 'eb0fc9d4-ef60-451b-834f-261dfb0228be'
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSource]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSource]'
Update [dbo].[SystemReportDataSource] Set [DefaultIconPath]=N'/Images/EmployeeTimeOffRequest.gif' Where [SystemReportDataSourceId] = '07c1c8c9-c148-40c0-a700-af2fb1a0a149'
GO
-- Add Column NotShowInStartupPage to SystemSecurityCategoryPage
Print 'Add Column NotShowInStartupPage to SystemSecurityCategoryPage'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'SystemSecurityCategoryPage' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='NotShowInStartupPage' AND TABLE_NAME='SystemSecurityCategoryPage'))
ALTER TABLE [dbo].[SystemSecurityCategoryPage]
	ADD [NotShowInStartupPage] bit NULL
GO
-- =======================================================
-- Foreign Key Constraint Nochecks's for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print ' Foreign Key Constraint Nochecks''s for Table: [dbo].[SystemSecurityCategoryPage]'

ALTER TABLE [dbo].[SystemSecurityCategoryPage] NOCHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory]
ALTER TABLE [dbo].[SystemSecurityCategoryPage] NOCHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory1]
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemSecurityCategoryPage]'

UPDATE [dbo].[SystemSecurityCategoryPage] SET [NotShowInStartupPage]=1 WHERE [SystemSecurityCategoryPageId]=21
UPDATE [dbo].[SystemSecurityCategoryPage] SET [NotShowInStartupPage]=1 WHERE [SystemSecurityCategoryPageId]=24
UPDATE [dbo].[SystemSecurityCategoryPage] SET [NotShowInStartupPage]=1 WHERE [SystemSecurityCategoryPageId]=30
UPDATE [dbo].[SystemSecurityCategoryPage] SET [NotShowInStartupPage]=1 WHERE [SystemSecurityCategoryPageId]=32
UPDATE [dbo].[SystemSecurityCategoryPage] SET [NotShowInStartupPage]=1 WHERE [SystemSecurityCategoryPageId]=35
UPDATE [dbo].[SystemSecurityCategoryPage] SET [NotShowInStartupPage]=1 WHERE [SystemSecurityCategoryPageId]=37
UPDATE [dbo].[SystemSecurityCategoryPage] SET [NotShowInStartupPage]=1 WHERE [SystemSecurityCategoryPageId]=80
UPDATE [dbo].[SystemSecurityCategoryPage] SET [NotShowInStartupPage]=1 WHERE [SystemSecurityCategoryPageId]=81
UPDATE [dbo].[SystemSecurityCategoryPage] SET [NotShowInStartupPage]=1 WHERE [SystemSecurityCategoryPageId]=86
UPDATE [dbo].[SystemSecurityCategoryPage] SET [NotShowInStartupPage]=1 WHERE [SystemSecurityCategoryPageId]=88
UPDATE [dbo].[SystemSecurityCategoryPage] SET [NotShowInStartupPage]=1 WHERE [SystemSecurityCategoryPageId]=95
UPDATE [dbo].[SystemSecurityCategoryPage] SET [NotShowInStartupPage]=1 WHERE [SystemSecurityCategoryPageId]=96
UPDATE [dbo].[SystemSecurityCategoryPage] SET [NotShowInStartupPage]=1 WHERE [SystemSecurityCategoryPageId]=97
UPDATE [dbo].[SystemSecurityCategoryPage] SET [NotShowInStartupPage]=1 WHERE [SystemSecurityCategoryPageId]=99
UPDATE [dbo].[SystemSecurityCategoryPage] SET [NotShowInStartupPage]=1 WHERE [SystemSecurityCategoryPageId]=100
UPDATE [dbo].[SystemSecurityCategoryPage] SET [NotShowInStartupPage]=1 WHERE [SystemSecurityCategoryPageId]=102
UPDATE [dbo].[SystemSecurityCategoryPage] SET [NotShowInStartupPage]=1 WHERE [SystemSecurityCategoryPageId]=103
UPDATE [dbo].[SystemSecurityCategoryPage] SET [NotShowInStartupPage]=1 WHERE [SystemSecurityCategoryPageId]=105
UPDATE [dbo].[SystemSecurityCategoryPage] SET [NotShowInStartupPage]=1 WHERE [SystemSecurityCategoryPageId]=108
UPDATE [dbo].[SystemSecurityCategoryPage] SET [NotShowInStartupPage]=1 WHERE [SystemSecurityCategoryPageId]=112
UPDATE [dbo].[SystemSecurityCategoryPage] SET [NotShowInStartupPage]=1 WHERE [SystemSecurityCategoryPageId]=116
UPDATE [dbo].[SystemSecurityCategoryPage] SET [NotShowInStartupPage]=1 WHERE [SystemSecurityCategoryPageId]=120
UPDATE [dbo].[SystemSecurityCategoryPage] SET [NotShowInStartupPage]=1 WHERE [SystemSecurityCategoryPageId]=125
UPDATE [dbo].[SystemSecurityCategoryPage] SET [NotShowInStartupPage]=1 WHERE [SystemSecurityCategoryPageId]=126
UPDATE [dbo].[SystemSecurityCategoryPage] SET [NotShowInStartupPage]=1 WHERE [SystemSecurityCategoryPageId]=132
UPDATE [dbo].[SystemSecurityCategoryPage] SET [NotShowInStartupPage]=1 WHERE [SystemSecurityCategoryPageId]=141
UPDATE [dbo].[SystemSecurityCategoryPage] SET [NotShowInStartupPage]=1 WHERE [SystemSecurityCategoryPageId]=145
UPDATE [dbo].[SystemSecurityCategoryPage] SET [NotShowInStartupPage]=1 WHERE [SystemSecurityCategoryPageId]=146
UPDATE [dbo].[SystemSecurityCategoryPage] SET [NotShowInStartupPage]=1 WHERE [SystemSecurityCategoryPageId]=148
GO
-- =======================================================
-- Foreign Key Constraint Check's for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print ' Foreign Key Constraint Check''s for Table: [dbo].[SystemSecurityCategoryPage]'

ALTER TABLE [dbo].[SystemSecurityCategoryPage] CHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory]
ALTER TABLE [dbo].[SystemSecurityCategoryPage] CHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory1]
GO
If exists(Select * from SystemData where version = '3.6.2')
BEGIN
Update AccountRole Set DefaultAccountPageId = NULL
Where DefaultAccountPageId In (Select SystemSecurityCategoryPageId From SystemSecurityCategoryPage
Where NotShowInStartupPage = 1)
END
GO
If exists(Select * from SystemData where version = '3.6.2')
BEGIN
Update AccountEmployeeTimeEntryPeriod Set Submitted = 0
Where Submitted = 1 And Rejected = 1 And Approved = 0
END
GO
Update SystemData Set Version = '3.6.3' Where Version = '3.6.2' And SystemDataId = 1
-- Drop View vueApprovedCountApprovalProjects
Print 'Drop View vueApprovedCountApprovalProjects'
GO
if exists (select * from information_schema.tables where table_name = 'vueApprovedCountApprovalProjects' and table_type = 'VIEW')
DROP VIEW [dbo].[vueApprovedCountApprovalProjects]
GO
-- Create View vueApprovedCountApprovalProjects
Print 'Create View vueApprovedCountApprovalProjects'
GO
if not exists (select * from information_schema.tables where table_name = 'vueApprovedCountApprovalProjects' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueApprovedCountApprovalProjects
AS
SELECT     dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId, COUNT(dbo.AccountEmployeeTimeEntry.Approved) AS ApprovedCount
FROM         dbo.AccountEmployeeTimeEntryPeriod INNER JOIN
                      dbo.AccountEmployeeTimeEntry ON 
                      dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId
WHERE     (dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeOffRequestId IS NULL) AND (dbo.AccountEmployeeTimeEntry.Submitted = 1) AND 
                      (dbo.AccountEmployeeTimeEntry.Rejected Is NULL Or dbo.AccountEmployeeTimeEntry.Rejected = 0) AND (dbo.AccountEmployeeTimeEntry.Approved = 1)
GROUP BY dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId'
GO
-- Drop View vueTotalApprovalProjects
Print 'Drop View vueTotalApprovalProjects'
GO
if exists (select * from information_schema.tables where table_name = 'vueTotalApprovalProjects' and table_type = 'VIEW')
DROP VIEW [dbo].[vueTotalApprovalProjects]
GO
-- Create View vueTotalApprovalProjects
Print 'Create View vueTotalApprovalProjects'
GO
if not exists (select * from information_schema.tables where table_name = 'vueTotalApprovalProjects' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueTotalApprovalProjects
AS
SELECT     dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId, COUNT(dbo.AccountEmployeeTimeEntry.Approved) AS TotalCount
FROM         dbo.AccountEmployeeTimeEntryPeriod INNER JOIN
                      dbo.AccountEmployeeTimeEntry ON 
                      dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId
WHERE     (dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeOffRequestId IS NULL)
GROUP BY dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId'
GO
-- Drop View vueTotalApprovedPeriods
Print 'Drop View vueTotalApprovedPeriods'
GO
if exists (select * from information_schema.tables where table_name = 'vueTotalApprovedPeriods' and table_type = 'VIEW')
DROP VIEW [dbo].[vueTotalApprovedPeriods]
GO
-- Create View vueTotalApprovedPeriods
Print 'Create View vueTotalApprovedPeriods'
GO
if not exists (select * from information_schema.tables where table_name = 'vueTotalApprovedPeriods' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueTotalApprovedPeriods
AS
SELECT     dbo.vueTotalApprovalProjects.AccountEmployeeTimeEntryPeriodId
FROM         dbo.vueTotalApprovalProjects INNER JOIN
                      dbo.vueApprovedCountApprovalProjects ON 
                      dbo.vueTotalApprovalProjects.AccountEmployeeTimeEntryPeriodId = dbo.vueApprovedCountApprovalProjects.AccountEmployeeTimeEntryPeriodId AND 
                      dbo.vueTotalApprovalProjects.TotalCount = dbo.vueApprovedCountApprovalProjects.ApprovedCount'
GO
-- Create View vueTotalNotApprovedPeriods
Print 'Create View vueTotalNotApprovedPeriods'
GO
if not exists (select * from information_schema.tables where table_name = 'vueTotalNotApprovedPeriods' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueTotalNotApprovedPeriods
AS
SELECT     dbo.vueTotalApprovalProjects.AccountEmployeeTimeEntryPeriodId
FROM         dbo.vueTotalApprovalProjects INNER JOIN
                      dbo.vueApprovedCountApprovalProjects ON 
                      dbo.vueTotalApprovalProjects.AccountEmployeeTimeEntryPeriodId = dbo.vueApprovedCountApprovalProjects.AccountEmployeeTimeEntryPeriodId AND 
                      dbo.vueTotalApprovalProjects.TotalCount <> dbo.vueApprovedCountApprovalProjects.ApprovedCount'
GO
If exists(Select * from SystemData where version = '3.6.3')
BEGIN
Update AccountEmployeeTimeEntryPeriod
Set Approved = 1 Where
AccountEmployeeTimeEntryPeriodId In (Select AccountEmployeeTimeEntryPeriodId From vueTotalApprovedPeriods)
END
GO
Update SystemData Set Version = '3.6.4' Where Version = '3.6.3' And SystemDataId = 1
GO
If exists(Select * from SystemData where version = '3.6.4')
BEGIN
Update AccountEmployeeTimeEntryPeriod
Set Approved = 1 Where
AccountEmployeeTimeEntryPeriodId In (Select AccountEmployeeTimeEntryPeriodId From vueTotalApprovedPeriods)
END
GO
If exists(Select * from SystemData where version = '3.6.4')
BEGIN
Update AccountEmployeeTimeEntryPeriod
Set Approved = 0 Where
AccountEmployeeTimeEntryPeriodId In (Select AccountEmployeeTimeEntryPeriodId From vueTotalNotApprovedPeriods)
END
GO
Update SystemData Set Version = '3.6.5' Where Version = '3.6.4' And SystemDataId = 1
GO
-- Drop Foreign Key FK_AccountTimeOffPolicyDetail_AccountTimeOffType from AccountTimeOffPolicyDetail
Print 'Drop Foreign Key FK_AccountTimeOffPolicyDetail_AccountTimeOffType from AccountTimeOffPolicyDetail'
GO
IF EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_SCHEMA='dbo' AND CONSTRAINT_NAME='FK_AccountTimeOffPolicyDetail_AccountTimeOffType' AND TABLE_NAME='AccountTimeOffPolicyDetail')
ALTER TABLE [dbo].[AccountTimeOffPolicyDetail] DROP CONSTRAINT [FK_AccountTimeOffPolicyDetail_AccountTimeOffType]
GO
-- Create Foreign Key FK_AccountTimeOffPolicyDetail_AccountTimeOffType on AccountTimeOffPolicyDetail
Print 'Create Foreign Key FK_AccountTimeOffPolicyDetail_AccountTimeOffType on AccountTimeOffPolicyDetail'
GO
IF NOT EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_SCHEMA='dbo' AND CONSTRAINT_NAME='FK_AccountTimeOffPolicyDetail_AccountTimeOffType' AND TABLE_NAME='AccountTimeOffPolicyDetail')
BEGIN
		ALTER TABLE [dbo].[AccountTimeOffPolicyDetail]
			ADD CONSTRAINT [FK_AccountTimeOffPolicyDetail_AccountTimeOffType]
			FOREIGN KEY ([AccountTimeOffTypeId]) REFERENCES [dbo].[AccountTimeOffType] ([AccountTimeOffTypeId])
			ON DELETE CASCADE
END
GO
-- Drop View vueAccountEmployeeTimeOff
Print 'Drop View vueAccountEmployeeTimeOff'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOff' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeOff]
GO
-- Drop View vueAccountTimeOffPolicyDetail
Print 'Drop View vueAccountTimeOffPolicyDetail'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountTimeOffPolicyDetail' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountTimeOffPolicyDetail]
GO
-- Create View vueAccountTimeOffPolicyDetail
Print 'Create View vueAccountTimeOffPolicyDetail'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountTimeOffPolicyDetail' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountTimeOffPolicyDetail
AS
SELECT     dbo.AccountTimeOffPolicyDetail.AccountTimeOffPolicyDetailId, dbo.AccountTimeOffPolicyDetail.AccountTimeOffPolicyId, 
                      dbo.AccountTimeOffPolicyDetail.AccountTimeOffTypeId, dbo.AccountTimeOffPolicyDetail.SystemEarnPeriodId, 
                      dbo.AccountTimeOffPolicyDetail.SystemResetToZeroTypeId, dbo.AccountTimeOffPolicyDetail.InitialSetToHours, 
                      dbo.AccountTimeOffPolicyDetail.ResetToHours, dbo.AccountTimeOffPolicyDetail.EarnHours, dbo.AccountTimeOffPolicyDetail.CarryOver, 
                      dbo.AccountTimeOffPolicyDetail.MaximumAvailable, dbo.AccountTimeOffPolicyDetail.AccountId, dbo.AccountTimeOffPolicyDetail.CreatedByEmployeeId,
                       dbo.AccountTimeOffPolicyDetail.CreatedOn, dbo.AccountTimeOffPolicyDetail.ModifiedByEmployeeId, dbo.AccountTimeOffPolicyDetail.ModifiedOn, 
                      dbo.AccountTimeOffPolicyDetail.MasterTimeOffPolicyDetailId, dbo.AccountTimeOffPolicy.AccountTimeOffPolicy, 
                      dbo.AccountTimeOffPolicy.MasterTimeOffPolicyId, dbo.AccountTimeOffType.AccountTimeOffType, dbo.AccountTimeOffType.IsTimeOffRequestRequired, 
                      dbo.AccountTimeOffType.MasterTimeOffTypeId
FROM         dbo.AccountTimeOffPolicyDetail INNER JOIN
                      dbo.AccountTimeOffPolicy ON dbo.AccountTimeOffPolicyDetail.AccountTimeOffPolicyId = dbo.AccountTimeOffPolicy.AccountTimeOffPolicyId INNER JOIN
                      dbo.AccountTimeOffType ON dbo.AccountTimeOffPolicyDetail.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId
WHERE     (dbo.AccountTimeOffType.IsDisabled <> 1)'
GO
-- Create View vueAccountEmployeeTimeOff
Print 'Create View vueAccountEmployeeTimeOff'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOff' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeOff
AS
SELECT     dbo.AccountTimeOffType.AccountTimeOffType, dbo.AccountEmployeeTimeOff.AccountEmployeeTimeOffId, 
                      dbo.AccountEmployeeTimeOff.AccountEmployeeId, dbo.AccountEmployeeTimeOff.AccountId, dbo.AccountEmployeeTimeOff.AccountTimeOffTypeId, 
                      dbo.AccountEmployeeTimeOff.Earned, dbo.AccountEmployeeTimeOff.Consume, dbo.AccountEmployeeTimeOff.Available, 
                      dbo.AccountEmployeeTimeOff.LastEarnedDate, dbo.AccountTimeOffType.IsTimeOffRequestRequired, dbo.AccountEmployeeTimeOff.CarryForward, 
                      dbo.AccountTimeOffPolicy.AccountTimeOffPolicy, dbo.AccountTimeOffPolicy.MasterTimeOffPolicyId, 
                      dbo.AccountEmployeeTimeOff.AccountTimeOffPolicyId
FROM         dbo.AccountEmployeeTimeOff INNER JOIN
                      dbo.AccountTimeOffPolicy ON 
                      dbo.AccountEmployeeTimeOff.AccountTimeOffPolicyId = dbo.AccountTimeOffPolicy.AccountTimeOffPolicyId LEFT OUTER JOIN
                      dbo.AccountTimeOffType ON dbo.AccountEmployeeTimeOff.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId
WHERE     (dbo.AccountTimeOffType.IsDisabled <> 1)'
GO
If exists(Select * from SystemData where version = '3.6.5')
BEGIN
Update AccountApprovalPath
Set AccountEmployeeId = 
(Select AccountEmployeeId From AccountEmployee a
Where AccountEmployeeId In (Select Top 1 AccountEmployeeId From AccountEmployee b
Where AccountRoleId In (Select AccountRoleId From AccountRole
Where MasterAccountRoleId = 1) And b.AccountId = AccountApprovalPath.AccountId))
Where MasterAccountApprovalPathId = 6 and accountemployeeid is null
END
GO
Update SystemData Set Version = '3.6.6' Where Version = '3.6.5' And SystemDataId = 1
GO
declare @SCHEMA_NAME varchar(200)
declare @TABLE_NAME varchar(200)
(select @SCHEMA_NAME = TABLE_SCHEMA  from information_schema.tables where table_name = 'vueProjectSummary' and table_type = 'VIEW')
if @SCHEMA_NAME <> 'dbo'
BEGIN
set @TABLE_NAME = 'DROP VIEW [' + @SCHEMA_NAME + ']' + '.[vueProjectSummary]'
exec (@TABLE_NAME)
END
GO
declare @SCHEMA_NAME varchar(200)
declare @TABLE_NAME varchar(200)
(select @SCHEMA_NAME = TABLE_SCHEMA  from information_schema.tables where table_name = 'vueAccountProjectForProjectSummary' and table_type = 'VIEW')
if @SCHEMA_NAME <> 'dbo'
BEGIN
set @TABLE_NAME = 'DROP VIEW [' + @SCHEMA_NAME + ']' + '.[vueAccountProjectForProjectSummary]'
exec (@TABLE_NAME)
END
GO
-- Create View vueAccountProjectForProjectSummary
Print 'Create View vueAccountProjectForProjectSummary'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountProjectForProjectSummary' and table_type = 'VIEW') 
EXEC sp_executesql N'CREATE  VIEW [dbo].[vueAccountProjectForProjectSummary]
AS
SELECT     dbo.AccountProject.*, dbo.AccountParty.PartyName
FROM         dbo.AccountProject INNER JOIN
                      dbo.AccountParty ON 
dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId'

GO

-- Create Table SystemFeatures
Print 'Create Table SystemFeatures'
GO
IF NOT EXISTS (select * from information_schema.tables where table_name = 'SystemFeatures' and table_type = 'BASE TABLE') 
CREATE TABLE [dbo].[SystemFeatures] (
		[SystemFeatureId]       uniqueidentifier NOT NULL,
		[SystemFeatureName]     nvarchar(100) NULL
)

GO
-- Add Primary Key PK_SystemFeatures to SystemFeatures
Print 'Add Primary Key PK_SystemFeatures to SystemFeatures'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'SystemFeatures' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_NAME='PK_SystemFeatures' AND TABLE_NAME='SystemFeatures'))
ALTER TABLE [dbo].[SystemFeatures]
	ADD
	CONSTRAINT [PK_SystemFeatures]
	PRIMARY KEY
	([SystemFeatureId])

GO
-- Add Default Constraint DF_SystemFeatures_SystemFeatureId to SystemFeatures
Print 'Add Default Constraint DF_SystemFeatures_SystemFeatureId to SystemFeatures'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'SystemFeatures' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM sysobjects WHERE name= N'DF_SystemFeatures_SystemFeatureId'))
ALTER TABLE [dbo].[SystemFeatures]
	ADD
	CONSTRAINT [DF_SystemFeatures_SystemFeatureId]
	DEFAULT (newid()) FOR [SystemFeatureId]

GO
-- Create Table [dbo].[AccountFeatures]
Print 'Create Table [dbo].[AccountFeatures]'
GO
IF NOT EXISTS (select * from information_schema.tables where table_name = 'AccountFeatures' and table_type = 'BASE TABLE') 
CREATE TABLE [dbo].[AccountFeatures] (
		[AccountFeatureId]     [uniqueidentifier] NOT NULL,
		[AccountId]            [int] NULL,
		[SystemFeatureId]      [uniqueidentifier] NULL
)
GO
-- Add Primary Key PK_AccountFeatures to [dbo].[AccountFeatures]
Print 'Add Primary Key PK_AccountFeatures to [dbo].[AccountFeatures]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountFeatures' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_NAME='PK_AccountFeatures' AND TABLE_NAME='AccountFeatures'))
ALTER TABLE [dbo].[AccountFeatures]
	ADD
	CONSTRAINT [PK_AccountFeatures]
	PRIMARY KEY
	CLUSTERED
	([AccountFeatureId])

GO
-- Add Default Constraint DF_AccountFeatures_AccountFeatureId to [dbo].[AccountFeatures]
Print 'Add Default Constraint DF_AccountFeatures_AccountFeatureId to [dbo].[AccountFeatures]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountFeatures' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM sysobjects WHERE name= N'DF_AccountFeatures_AccountFeatureId'))
ALTER TABLE [dbo].[AccountFeatures]
	ADD
	CONSTRAINT [DF_AccountFeatures_AccountFeatureId]
	DEFAULT (newid()) FOR [AccountFeatureId]

GO
-- Add Column SystemFeatureId to SystemSecurityCategoryPage
Print 'Add Column SystemFeatureId to SystemSecurityCategoryPage'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'SystemSecurityCategoryPage' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='SystemFeatureId' AND TABLE_NAME='SystemSecurityCategoryPage'))
ALTER TABLE [dbo].[SystemSecurityCategoryPage]
	ADD [SystemFeatureId] uniqueidentifier NULL

GO
-- Add Column SystemFeatureId to SystemReportDataSource
Print 'Add Column SystemFeatureId to SystemReportDataSource'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'SystemReportDataSource' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='SystemFeatureId' AND TABLE_NAME='SystemReportDataSource'))
ALTER TABLE [dbo].[SystemReportDataSource]
	ADD [SystemFeatureId] uniqueidentifier NULL

GO
-- Drop View vueAccountReport
Print 'Drop View vueAccountReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountReport]
GO

-- Drop View vueSystemSecurityCategoryPage
Print 'Drop View vueSystemSecurityCategoryPage'
GO
if exists (select * from information_schema.tables where table_name = 'vueSystemSecurityCategoryPage' and table_type = 'VIEW')
DROP VIEW [dbo].[vueSystemSecurityCategoryPage]
GO

-- Drop View vueAccountPagePermission
Print 'Drop View vueAccountPagePermission'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountPagePermission' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountPagePermission]

GO
-- Drop View vueAccountPageSecuritySiteMap
Print 'Drop View vueAccountPageSecuritySiteMap'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountPageSecuritySiteMap' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountPageSecuritySiteMap]

GO
-- Drop View vueAccountFeatures
Print 'Drop View vueAccountFeatures'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountFeatures' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountFeatures]

GO
-- Create View vueAccountPageSecuritySiteMap
Print 'Create View vueAccountPageSecuritySiteMap'
GO
if not exists (select * from information_schema.tables where table_name = '[vueAccountPageSecuritySiteMap]' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountPageSecuritySiteMap
AS
SELECT     dbo.CombineValuesForSiteMap(dbo.vueSystemPagesSiteMap.SystemSecurityCategoryPageId, dbo.vueSystemPagesSiteMap.AccountId) AS Roles, 
                      dbo.vueSystemPagesSiteMap.AccountId, dbo.vueSystemPagesSiteMap.SystemSecurityCategoryPageId, dbo.SystemSecurityCategoryPage.SequenceNumber, 
                      dbo.SystemSecurityCategoryPage.Folder, dbo.SystemSecurityCategoryPage.SystemCategoryPage, 
                      dbo.SystemSecurityCategoryPage.SystemCategoryPageDescription, dbo.SystemSecurityCategoryPage.ParentSystemSecurityCateogoryPageId, 
                      dbo.SystemSecurityCategoryPage.IsSiteMapPage, dbo.SystemSecurityCategoryPage.IsCustomizeable, dbo.SystemSecurityCategoryPage.IsAllowAdd, 
                      dbo.SystemSecurityCategoryPage.IsAllowEdit, dbo.SystemSecurityCategoryPage.IsAllowDelete, dbo.SystemSecurityCategoryPage.IsAllowList, 
                      dbo.SystemSecurityCategoryPage.IsShowDataOptions, dbo.SystemSecurityCategoryPage.IsShowTillOptions, dbo.SystemSecurityCategoryPage.IsSystemPage, 
                      dbo.SystemSecurityCategoryPage.ControlLevelPermission, dbo.SystemSecurityCategoryPage.NotShowInPermission, 
                      dbo.SystemSecurityCategoryPage.SystemSecurityCategoryId, dbo.SystemSecurityCategory.SystemSecurityCategory, 
                      SystemSecurityCategoryPage_1.Folder AS ParentFolder, SystemSecurityCategoryPage_1.SystemCategoryPage AS ParentSystemCategoryPage, 
                      SystemSecurityCategoryPage_1.SystemCategoryPageDescription AS ParentSystemCategoryPageDescription, 
                      SystemSecurityCategoryPage_1.IsSiteMapPage AS ParentIsSiteMapPage, dbo.SystemSecurityCategoryPage.SystemFeatureId
FROM         dbo.vueSystemPagesSiteMap INNER JOIN
                      dbo.SystemSecurityCategoryPage ON 
                      dbo.vueSystemPagesSiteMap.SystemSecurityCategoryPageId = dbo.SystemSecurityCategoryPage.SystemSecurityCategoryPageId INNER JOIN
                      dbo.SystemSecurityCategory ON dbo.SystemSecurityCategoryPage.SystemSecurityCategoryId = dbo.SystemSecurityCategory.SystemSecurityCategoryId AND 
                      dbo.SystemSecurityCategoryPage.SystemSecurityCategoryId = dbo.SystemSecurityCategory.SystemSecurityCategoryId LEFT OUTER JOIN
                      dbo.SystemSecurityCategoryPage AS SystemSecurityCategoryPage_1 ON 
                      dbo.SystemSecurityCategoryPage.ParentSystemSecurityCateogoryPageId = SystemSecurityCategoryPage_1.SystemSecurityCategoryPageId'

GO
-- Create View vueAccountPagePermission
Print 'Create View vueAccountPagePermission'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountPagePermission' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountPagePermission
AS
SELECT     dbo.AccountPagePermission.AccountPagePermissionId, dbo.AccountPagePermission.AccountId, dbo.AccountPagePermission.AccountRoleId, 
                      dbo.AccountPagePermission.SystemSecurityCategoryPageId, dbo.AccountPagePermission.ShowAllData, dbo.AccountPagePermission.ShowMyData, 
                      dbo.AccountPagePermission.ShowMyProjectsData, dbo.AccountPagePermission.ShowMyTeamsData, dbo.AccountPagePermission.TillDate, 
                      dbo.AccountPagePermission.TillHours, dbo.SystemSecurityCategoryPage.Folder, dbo.SystemSecurityCategoryPage.SystemCategoryPage, 
                      dbo.SystemSecurityCategoryPage.SystemCategoryPageDescription, dbo.SystemSecurityCategoryPage.IsSiteMapPage, dbo.SystemPermission.SystemPermission, 
                      dbo.AccountRole.Role, dbo.SystemSecurityCategoryPage.ParentSystemSecurityCateogoryPageId, 
                      SystemSecurityCategoryPage_1.SystemCategoryPage AS ParentSystemCategoryPage, 
                      SystemSecurityCategoryPage_1.SystemCategoryPageDescription AS ParentSystemCategoryPageDescription, 
                      SystemSecurityCategoryPage_1.IsSiteMapPage AS ParentIsSiteMapPage, SystemSecurityCategoryPage_1.Folder AS ParentFolder, 
                      dbo.SystemSecurityCategoryPage.SequenceNumber, dbo.AccountPagePermission.SystemPermissionId, dbo.SystemSecurityCategoryPage.ControlLevelPermission, 
                      dbo.AccountPagePermission.ShowMySubOrdinatesData, dbo.SystemSecurityCategoryPage.SystemFeatureId
FROM         dbo.AccountPagePermission INNER JOIN
                      dbo.SystemSecurityCategoryPage ON 
                      dbo.AccountPagePermission.SystemSecurityCategoryPageId = dbo.SystemSecurityCategoryPage.SystemSecurityCategoryPageId INNER JOIN
                      dbo.AccountRole ON dbo.AccountPagePermission.AccountRoleId = dbo.AccountRole.AccountRoleId INNER JOIN
                      dbo.SystemPermission ON dbo.AccountPagePermission.SystemPermissionId = dbo.SystemPermission.SystemPermissionId LEFT OUTER JOIN
                      dbo.SystemSecurityCategoryPage AS SystemSecurityCategoryPage_1 ON 
                      dbo.SystemSecurityCategoryPage.ParentSystemSecurityCateogoryPageId = SystemSecurityCategoryPage_1.SystemSecurityCategoryPageId'

GO
-- Create View vueSystemSecurityCategoryPage
Print 'Create View vueSystemSecurityCategoryPage'
GO
if not exists (select * from information_schema.tables where table_name = 'vueSystemSecurityCategoryPage' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueSystemSecurityCategoryPage
AS
SELECT     dbo.SystemSecurityCategoryPage.SystemSecurityCategoryPageId, dbo.SystemSecurityCategoryPage.SystemSecurityCategoryId, 
                      dbo.SystemSecurityCategoryPage.SequenceNumber, dbo.SystemSecurityCategoryPage.Folder, dbo.SystemSecurityCategoryPage.SystemCategoryPage, 
                      dbo.SystemSecurityCategoryPage.SystemCategoryPageDescription, dbo.SystemSecurityCategoryPage.ParentSystemSecurityCateogoryPageId, 
                      dbo.SystemSecurityCategoryPage.IsSiteMapPage, dbo.SystemSecurityCategoryPage.IsCustomizeable, dbo.SystemSecurityCategoryPage.IsAllowAdd, 
                      dbo.SystemSecurityCategoryPage.IsAllowEdit, dbo.SystemSecurityCategoryPage.IsAllowDelete, dbo.SystemSecurityCategoryPage.IsAllowList, 
                      dbo.SystemSecurityCategoryPage.IsShowDataOptions, dbo.SystemSecurityCategoryPage.IsShowTillOptions, dbo.SystemSecurityCategoryPage.IsSystemPage, 
                      dbo.SystemSecurityCategory.SystemSecurityCategory, dbo.SystemSecurityCategoryPage.NotShowInPermission, 
                      dbo.SystemSecurityCategoryPage.SystemFeatureId
FROM         dbo.SystemSecurityCategoryPage INNER JOIN
                      dbo.SystemSecurityCategory ON dbo.SystemSecurityCategoryPage.SystemSecurityCategoryId = dbo.SystemSecurityCategory.SystemSecurityCategoryId AND 
                      dbo.SystemSecurityCategoryPage.SystemSecurityCategoryId = dbo.SystemSecurityCategory.SystemSecurityCategoryId'

GO
-- Create View vueAccountReport
Print 'Create View vueAccountReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountReport
AS
SELECT     dbo.AccountReportCategory.AccountReportCategory, dbo.AccountReport.AccountReportId, dbo.AccountReport.AccountReportCategoryId, 
                      dbo.AccountReport.ReportName, dbo.AccountReport.ReportDescription, dbo.AccountReport.ReportIconPath, dbo.AccountReport.AccountId, 
                      dbo.AccountReport.SystemReportTypeId, dbo.AccountReport.SystemReportId, dbo.AccountReport.IsConsolidated, dbo.AccountReport.ReportPageName, 
                      dbo.AccountReport.ReportOrder, dbo.AccountReportCategory.SequenceNo, CAST(dbo.AccountReportCategory.SequenceNo AS nvarchar(4000)) 
                      + '' - '' + dbo.AccountReportCategory.AccountReportCategory AS AccountReportCategorySequence, dbo.SystemReportDataSource.SystemFeatureId
FROM         dbo.SystemReportDataSource INNER JOIN
                      dbo.AccountReportDataSourceMapping ON 
                      dbo.SystemReportDataSource.SystemReportDataSourceId = dbo.AccountReportDataSourceMapping.SystemReportDataSourceId RIGHT OUTER JOIN
                      dbo.AccountReport ON dbo.AccountReportDataSourceMapping.AccountReportId = dbo.AccountReport.AccountReportId RIGHT OUTER JOIN
                      dbo.AccountReportCategory ON dbo.AccountReport.AccountReportCategoryId = dbo.AccountReportCategory.AccountReportCategoryId'

GO
-- Create View vueAccountFeatures
Print 'Create View vueAccountFeatures'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountFeatures' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountFeatures
AS
SELECT     dbo.SystemFeatures.SystemFeatureId, dbo.SystemFeatures.SystemFeatureName, dbo.AccountFeatures.AccountId, dbo.AccountFeatures.AccountFeatureId
FROM         dbo.SystemFeatures LEFT OUTER JOIN
                      dbo.AccountFeatures ON dbo.SystemFeatures.SystemFeatureId = dbo.AccountFeatures.SystemFeatureId'

GO
IF NOT Exists(Select * From [dbo].[SystemFeatures] WHERE [SystemFeatureId]='27d3a272-d849-4942-9985-7672fb582389')
BEGIN

-- =======================================================
-- Foreign Key Constraint Nochecks's for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print ' Foreign Key Constraint Nochecks''s for Table: [dbo].[SystemSecurityCategoryPage]'

ALTER TABLE [dbo].[SystemSecurityCategoryPage] NOCHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory]
ALTER TABLE [dbo].[SystemSecurityCategoryPage] NOCHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory1]

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemSecurityCategoryPage]'

INSERT INTO [dbo].[SystemSecurityCategoryPage] ([SystemSecurityCategoryPageId], [SystemSecurityCategoryId], [SequenceNumber], [Folder], [SystemCategoryPage], [SystemCategoryPageDescription], [ParentSystemSecurityCateogoryPageId], [IsSiteMapPage], [IsCustomizeable], [IsAllowAdd], [IsAllowEdit], [IsAllowDelete], [IsAllowList], [IsShowDataOptions], [IsShowTillOptions], [IsSystemPage], [ControlLevelPermission], [NotShowInPermission], [NotShowInStartupPage]) VALUES (150, 1, N'2184012870', N'AccountAdmin', 'AccountFeatureManagement.aspx', 'Feature Management', 15, 1, 1, NULL, 1, NULL, 1, NULL, NULL, NULL, NULL, NULL, NULL)

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemFeatures]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemFeatures]'

INSERT INTO [dbo].[SystemFeatures] ([SystemFeatureId], [SystemFeatureName]) VALUES ('27d3a272-d849-4942-9985-7672fb582389', N'Project / Task Management')
INSERT INTO [dbo].[SystemFeatures] ([SystemFeatureId], [SystemFeatureName]) VALUES ('21e65278-ab96-42c6-a332-16cafbbc669e', N'Attendance')
INSERT INTO [dbo].[SystemFeatures] ([SystemFeatureId], [SystemFeatureName]) VALUES ('76aaf57e-96a4-4476-94a4-575824e9b9fa', N'Time Off')
INSERT INTO [dbo].[SystemFeatures] ([SystemFeatureId], [SystemFeatureName]) VALUES ('db17deb7-51a0-4400-bf3b-9094e01ef038', N'Timesheet Management')
INSERT INTO [dbo].[SystemFeatures] ([SystemFeatureId], [SystemFeatureName]) VALUES ('deaa2ae5-133d-4c8a-ab0c-b89eaa76116e', N'Billing')
INSERT INTO [dbo].[SystemFeatures] ([SystemFeatureId], [SystemFeatureName]) VALUES ('537f44e5-ec0f-4de6-aa29-09450961c5e9', N'Expense Management')

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSource]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSource]'

UPDATE [dbo].[SystemReportDataSource] SET [SystemFeatureId]='db17deb7-51a0-4400-bf3b-9094e01ef038' WHERE [SystemReportDataSourceId]='3a080202-6842-4eca-8c79-a945978810b4'
UPDATE [dbo].[SystemReportDataSource] SET [SystemFeatureId]='27d3a272-d849-4942-9985-7672fb582389' WHERE [SystemReportDataSourceId]='1e657f0a-881b-4f50-839a-c3a962c9a460'
UPDATE [dbo].[SystemReportDataSource] SET [SystemFeatureId]='537f44e5-ec0f-4de6-aa29-09450961c5e9' WHERE [SystemReportDataSourceId]='ee5f3316-3a5e-484e-ae9e-9b11f0380997'
UPDATE [dbo].[SystemReportDataSource] SET [SystemFeatureId]='db17deb7-51a0-4400-bf3b-9094e01ef038' WHERE [SystemReportDataSourceId]='18966956-9937-4da0-a6f3-465e6066d433'
UPDATE [dbo].[SystemReportDataSource] SET [SystemFeatureId]='537f44e5-ec0f-4de6-aa29-09450961c5e9' WHERE [SystemReportDataSourceId]='0f2d1d68-826d-400e-bf9f-95d4a9d6c4e0'
UPDATE [dbo].[SystemReportDataSource] SET [SystemFeatureId]='21e65278-ab96-42c6-a332-16cafbbc669e' WHERE [SystemReportDataSourceId]='96805a70-5415-44d8-a8db-5f0e148ea357'
UPDATE [dbo].[SystemReportDataSource] SET [SystemFeatureId]='21e65278-ab96-42c6-a332-16cafbbc669e' WHERE [SystemReportDataSourceId]='a5187c80-820c-4092-ae6d-630645bb8f0a'
UPDATE [dbo].[SystemReportDataSource] SET [SystemFeatureId]='deaa2ae5-133d-4c8a-ab0c-b89eaa76116e' WHERE [SystemReportDataSourceId]='2fd0b58b-ea6e-48c6-9a19-f970b8ec3636'
UPDATE [dbo].[SystemReportDataSource] SET [SystemFeatureId]='76aaf57e-96a4-4476-94a4-575824e9b9fa' WHERE [SystemReportDataSourceId]='996917c1-62f6-44d5-be81-30254953fce3'
UPDATE [dbo].[SystemReportDataSource] SET [SystemFeatureId]='76aaf57e-96a4-4476-94a4-575824e9b9fa' WHERE [SystemReportDataSourceId]='07c1c8c9-c148-40c0-a700-af2fb1a0a149'
UPDATE [dbo].[SystemReportDataSource] SET [SystemFeatureId]='76aaf57e-96a4-4476-94a4-575824e9b9fa' WHERE [SystemReportDataSourceId]='5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8'
UPDATE [dbo].[SystemReportDataSource] SET [SystemFeatureId]='537f44e5-ec0f-4de6-aa29-09450961c5e9' WHERE [SystemReportDataSourceId]='75c3b467-f6e1-438c-a821-031917cb0730'
UPDATE [dbo].[SystemReportDataSource] SET [SystemFeatureId]='db17deb7-51a0-4400-bf3b-9094e01ef038' WHERE [SystemReportDataSourceId]='ad0ea79d-c1d7-40ed-a7c4-03cc4f565873'
UPDATE [dbo].[SystemReportDataSource] SET [SystemFeatureId]='db17deb7-51a0-4400-bf3b-9094e01ef038' WHERE [SystemReportDataSourceId]='eb51cc06-118e-4d80-ae95-1e6d9ddc80b8'
UPDATE [dbo].[SystemReportDataSource] SET [SystemFeatureId]='27d3a272-d849-4942-9985-7672fb582389' WHERE [SystemReportDataSourceId]='7e5678a3-d1bc-4bb4-8fd1-75cab80388ba'
UPDATE [dbo].[SystemReportDataSource] SET [SystemFeatureId]='537f44e5-ec0f-4de6-aa29-09450961c5e9' WHERE [SystemReportDataSourceId]='e3803dc0-49fd-4fc8-b414-ea264ffe85aa'


-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemSecurityCategoryPage]'

UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='db17deb7-51a0-4400-bf3b-9094e01ef038' WHERE [SystemSecurityCategoryPageId]=1
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='deaa2ae5-133d-4c8a-ab0c-b89eaa76116e' WHERE [SystemSecurityCategoryPageId]=2
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='537f44e5-ec0f-4de6-aa29-09450961c5e9' WHERE [SystemSecurityCategoryPageId]=5
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='537f44e5-ec0f-4de6-aa29-09450961c5e9' WHERE [SystemSecurityCategoryPageId]=6
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='27d3a272-d849-4942-9985-7672fb582389' WHERE [SystemSecurityCategoryPageId]=8
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='27d3a272-d849-4942-9985-7672fb582389' WHERE [SystemSecurityCategoryPageId]=12
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='db17deb7-51a0-4400-bf3b-9094e01ef038' WHERE [SystemSecurityCategoryPageId]=13
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='db17deb7-51a0-4400-bf3b-9094e01ef038' WHERE [SystemSecurityCategoryPageId]=18
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='db17deb7-51a0-4400-bf3b-9094e01ef038' WHERE [SystemSecurityCategoryPageId]=19
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='537f44e5-ec0f-4de6-aa29-09450961c5e9' WHERE [SystemSecurityCategoryPageId]=20
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='27d3a272-d849-4942-9985-7672fb582389' WHERE [SystemSecurityCategoryPageId]=21
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='27d3a272-d849-4942-9985-7672fb582389' WHERE [SystemSecurityCategoryPageId]=27
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='27d3a272-d849-4942-9985-7672fb582389' WHERE [SystemSecurityCategoryPageId]=28
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='27d3a272-d849-4942-9985-7672fb582389' WHERE [SystemSecurityCategoryPageId]=30
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='27d3a272-d849-4942-9985-7672fb582389' WHERE [SystemSecurityCategoryPageId]=31
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='27d3a272-d849-4942-9985-7672fb582389' WHERE [SystemSecurityCategoryPageId]=32
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='27d3a272-d849-4942-9985-7672fb582389' WHERE [SystemSecurityCategoryPageId]=33
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='27d3a272-d849-4942-9985-7672fb582389' WHERE [SystemSecurityCategoryPageId]=35
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='537f44e5-ec0f-4de6-aa29-09450961c5e9' WHERE [SystemSecurityCategoryPageId]=36
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='db17deb7-51a0-4400-bf3b-9094e01ef038' WHERE [SystemSecurityCategoryPageId]=38
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='27d3a272-d849-4942-9985-7672fb582389' WHERE [SystemSecurityCategoryPageId]=76
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='21e65278-ab96-42c6-a332-16cafbbc669e' WHERE [SystemSecurityCategoryPageId]=80
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='27d3a272-d849-4942-9985-7672fb582389' WHERE [SystemSecurityCategoryPageId]=86
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='27d3a272-d849-4942-9985-7672fb582389' WHERE [SystemSecurityCategoryPageId]=88
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='27d3a272-d849-4942-9985-7672fb582389' WHERE [SystemSecurityCategoryPageId]=96
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='27d3a272-d849-4942-9985-7672fb582389' WHERE [SystemSecurityCategoryPageId]=97
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='27d3a272-d849-4942-9985-7672fb582389' WHERE [SystemSecurityCategoryPageId]=103
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='537f44e5-ec0f-4de6-aa29-09450961c5e9' WHERE [SystemSecurityCategoryPageId]=105
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='537f44e5-ec0f-4de6-aa29-09450961c5e9' WHERE [SystemSecurityCategoryPageId]=106
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='537f44e5-ec0f-4de6-aa29-09450961c5e9' WHERE [SystemSecurityCategoryPageId]=107
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='db17deb7-51a0-4400-bf3b-9094e01ef038' WHERE [SystemSecurityCategoryPageId]=113
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='537f44e5-ec0f-4de6-aa29-09450961c5e9' WHERE [SystemSecurityCategoryPageId]=114
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='db17deb7-51a0-4400-bf3b-9094e01ef038' WHERE [SystemSecurityCategoryPageId]=116
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='537f44e5-ec0f-4de6-aa29-09450961c5e9' WHERE [SystemSecurityCategoryPageId]=117
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='db17deb7-51a0-4400-bf3b-9094e01ef038' WHERE [SystemSecurityCategoryPageId]=118
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='27d3a272-d849-4942-9985-7672fb582389' WHERE [SystemSecurityCategoryPageId]=120
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='db17deb7-51a0-4400-bf3b-9094e01ef038' WHERE [SystemSecurityCategoryPageId]=122
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='deaa2ae5-133d-4c8a-ab0c-b89eaa76116e' WHERE [SystemSecurityCategoryPageId]=129
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='deaa2ae5-133d-4c8a-ab0c-b89eaa76116e' WHERE [SystemSecurityCategoryPageId]=130
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='deaa2ae5-133d-4c8a-ab0c-b89eaa76116e' WHERE [SystemSecurityCategoryPageId]=131
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='deaa2ae5-133d-4c8a-ab0c-b89eaa76116e' WHERE [SystemSecurityCategoryPageId]=133
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='deaa2ae5-133d-4c8a-ab0c-b89eaa76116e' WHERE [SystemSecurityCategoryPageId]=134
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='537f44e5-ec0f-4de6-aa29-09450961c5e9' WHERE [SystemSecurityCategoryPageId]=135
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='db17deb7-51a0-4400-bf3b-9094e01ef038' WHERE [SystemSecurityCategoryPageId]=136
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='db17deb7-51a0-4400-bf3b-9094e01ef038' WHERE [SystemSecurityCategoryPageId]=137
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='76aaf57e-96a4-4476-94a4-575824e9b9fa' WHERE [SystemSecurityCategoryPageId]=138
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='76aaf57e-96a4-4476-94a4-575824e9b9fa' WHERE [SystemSecurityCategoryPageId]=139
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='76aaf57e-96a4-4476-94a4-575824e9b9fa' WHERE [SystemSecurityCategoryPageId]=140
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='76aaf57e-96a4-4476-94a4-575824e9b9fa' WHERE [SystemSecurityCategoryPageId]=141
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='76aaf57e-96a4-4476-94a4-575824e9b9fa' WHERE [SystemSecurityCategoryPageId]=142
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='76aaf57e-96a4-4476-94a4-575824e9b9fa' WHERE [SystemSecurityCategoryPageId]=143
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='76aaf57e-96a4-4476-94a4-575824e9b9fa' WHERE [SystemSecurityCategoryPageId]=144
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='db17deb7-51a0-4400-bf3b-9094e01ef038' WHERE [SystemSecurityCategoryPageId]=145
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='537f44e5-ec0f-4de6-aa29-09450961c5e9' WHERE [SystemSecurityCategoryPageId]=146
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='db17deb7-51a0-4400-bf3b-9094e01ef038' WHERE [SystemSecurityCategoryPageId]=147
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='db17deb7-51a0-4400-bf3b-9094e01ef038' WHERE [SystemSecurityCategoryPageId]=148
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='db17deb7-51a0-4400-bf3b-9094e01ef038' WHERE [SystemSecurityCategoryPageId]=149


-- =======================================================
-- Foreign Key Constraint Check's for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print ' Foreign Key Constraint Check''s for Table: [dbo].[SystemSecurityCategoryPage]'

ALTER TABLE [dbo].[SystemSecurityCategoryPage] CHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory]
ALTER TABLE [dbo].[SystemSecurityCategoryPage] CHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory1]

END
--End 3.7.1
--Start 3.8
GO
-- Drop View vueAccountProjectTask
Print 'Drop View vueAccountProjectTask'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountProjectTask' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountProjectTask]
GO
-- Create View vueAccountProjectTask
Print 'Create View vueAccountProjectTask'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountProjectTask' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountProjectTask
AS
SELECT     dbo.AccountProjectTask.AccountProjectTaskId, dbo.AccountProjectTask.AccountProjectId, dbo.AccountProjectTask.ParentAccountProjectTaskId, 
                      dbo.AccountProjectTask.TaskName, dbo.AccountProjectTask.TaskDescription, dbo.AccountProjectTask.AccountTaskTypeId, 
                      dbo.AccountProjectTask.Duration, dbo.AccountProjectTask.DurationUnit, dbo.AccountProjectTask.DeadlineDate, 
                      dbo.AccountProjectTask.CompletedPercent, dbo.AccountProjectTask.Completed, dbo.AccountProjectTask.IsParentTask, 
                      dbo.AccountProjectTask.IsForAllEmployees, dbo.AccountProjectTask.AccountPriorityId, dbo.AccountProjectTask.TaskStatusId, 
                      dbo.AccountProjectTask.CreatedOn, dbo.AccountProjectTask.CreatedByEmployeeId, dbo.AccountProjectTask.ModifiedOn, 
                      dbo.AccountProjectTask.ModifiedByEmployeeId, dbo.AccountStatus.Status AS TaskStatus, dbo.AccountEmployee.FirstName AS CreatedByFirstName, 
                      dbo.AccountEmployee.LastName AS CreatedByLastName, dbo.AccountPriority.Priority, dbo.AccountProject.ProjectName, 
                      dbo.AccountProject.ProjectCode, dbo.AccountTaskType.TaskType, dbo.AccountProject.AccountId, dbo.AccountProjectTask.AccountProjectMilestoneId, 
                      dbo.AccountProjectMilestone.MilestoneDescription, dbo.AccountProjectTask.IsReOpen, AccountEmployee_1.FirstName AS ModifiedByFirstName, 
                      AccountEmployee_1.LastName AS ModifiedByLastName, dbo.AccountProjectTask.EstimatedCost, dbo.AccountProjectTask.EstimatedTimeSpent, 
                      dbo.AccountProjectTask.EstimatedTimeSpentUnit, dbo.AccountEmployee.AccountEmployeeId, dbo.AccountProjectTask.IsDisabled, 
                      dbo.AccountProjectTask.TaskCode, dbo.AccountProject.IsTemplate, dbo.AccountProjectTask.IsForAllProjectTask, dbo.AccountProjectTask.IsBillable, 
                      dbo.AccountProjectTask.EstimatedCurrencyId, dbo.AccountParty.PartyName, dbo.AccountParty.PartyNick, dbo.AccountProject.AccountClientId, 
                      dbo.AccountProject.ProjectDescription, dbo.AccountProjectMilestone.MilestoneDate, dbo.AccountProject.IsDeleted AS IsProjectDeleted
FROM         dbo.AccountTaskType RIGHT OUTER JOIN
                      dbo.AccountProjectMilestone RIGHT OUTER JOIN
                      dbo.AccountProject INNER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId RIGHT OUTER JOIN
                      dbo.AccountProjectTask LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON dbo.AccountProjectTask.ModifiedByEmployeeId = AccountEmployee_1.AccountEmployeeId ON 
                      dbo.AccountProject.AccountProjectId = dbo.AccountProjectTask.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountEmployee ON dbo.AccountProjectTask.CreatedByEmployeeId = dbo.AccountEmployee.AccountEmployeeId ON 
                      dbo.AccountProjectMilestone.AccountProjectMilestoneId = dbo.AccountProjectTask.AccountProjectMilestoneId ON 
                      dbo.AccountTaskType.AccountTaskTypeId = dbo.AccountProjectTask.AccountTaskTypeId LEFT OUTER JOIN
                      dbo.AccountStatus ON dbo.AccountProjectTask.TaskStatusId = dbo.AccountStatus.AccountStatusId LEFT OUTER JOIN
                      dbo.AccountPriority ON dbo.AccountProjectTask.AccountPriorityId = dbo.AccountPriority.AccountPriorityId'
GO

-- Drop View vueAccountEmployeeTimeOffLastSchedule
Print 'Drop View vueAccountEmployeeTimeOffLastSchedule'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOffLastSchedule' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeOffLastSchedule]
GO
-- Drop View vueAccountEmployeeTimeOff
Print 'Drop View vueAccountEmployeeTimeOff'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOff' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeOff]
GO
-- Drop View vueAccountTimeOffPolicyDetail
Print 'Drop View vueAccountTimeOffPolicyDetail'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountTimeOffPolicyDetail' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountTimeOffPolicyDetail]
GO
-- Add Column LastResetDate to AccountEmployeeTimeOff
Print 'Add Column LastResetDate to AccountEmployeeTimeOff'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeOff' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='LastResetDate' AND TABLE_NAME='AccountEmployeeTimeOff'))
ALTER TABLE [dbo].[AccountEmployeeTimeOff]
	ADD [LastResetDate] datetime NULL
GO
-- Add Column EffectiveDate to AccountTimeOffPolicyDetail
Print 'Add Column EffectiveDate to AccountTimeOffPolicyDetail'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountTimeOffPolicyDetail' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='EffectiveDate' AND TABLE_NAME='AccountTimeOffPolicyDetail'))
ALTER TABLE [dbo].[AccountTimeOffPolicyDetail]
	ADD [EffectiveDate] datetime NULL
GO
-- Create View vueAccountTimeOffPolicyDetail
Print 'Create View vueAccountTimeOffPolicyDetail'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountTimeOffPolicyDetail' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountTimeOffPolicyDetail
AS
SELECT     dbo.AccountTimeOffPolicyDetail.AccountTimeOffPolicyDetailId, dbo.AccountTimeOffPolicyDetail.AccountTimeOffPolicyId, 
                      dbo.AccountTimeOffPolicyDetail.AccountTimeOffTypeId, dbo.AccountTimeOffPolicyDetail.SystemEarnPeriodId, 
                      dbo.AccountTimeOffPolicyDetail.SystemResetToZeroTypeId, dbo.AccountTimeOffPolicyDetail.InitialSetToHours, 
                      dbo.AccountTimeOffPolicyDetail.ResetToHours, dbo.AccountTimeOffPolicyDetail.EarnHours, dbo.AccountTimeOffPolicyDetail.CarryOver, 
                      dbo.AccountTimeOffPolicyDetail.MaximumAvailable, dbo.AccountTimeOffPolicyDetail.AccountId, dbo.AccountTimeOffPolicyDetail.CreatedByEmployeeId,
                       dbo.AccountTimeOffPolicyDetail.CreatedOn, dbo.AccountTimeOffPolicyDetail.ModifiedByEmployeeId, dbo.AccountTimeOffPolicyDetail.ModifiedOn, 
                      dbo.AccountTimeOffPolicyDetail.MasterTimeOffPolicyDetailId, dbo.AccountTimeOffPolicy.AccountTimeOffPolicy, 
                      dbo.AccountTimeOffPolicy.MasterTimeOffPolicyId, dbo.AccountTimeOffType.AccountTimeOffType, dbo.AccountTimeOffType.IsTimeOffRequestRequired, 
                      dbo.AccountTimeOffType.MasterTimeOffTypeId, dbo.AccountTimeOffPolicyDetail.EffectiveDate
FROM         dbo.AccountTimeOffPolicyDetail INNER JOIN
                      dbo.AccountTimeOffPolicy ON dbo.AccountTimeOffPolicyDetail.AccountTimeOffPolicyId = dbo.AccountTimeOffPolicy.AccountTimeOffPolicyId INNER JOIN
                      dbo.AccountTimeOffType ON dbo.AccountTimeOffPolicyDetail.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId
WHERE     (dbo.AccountTimeOffType.IsDisabled <> 1)'
GO
-- Create View vueAccountEmployeeTimeOffLastSchedule
Print 'Create View vueAccountEmployeeTimeOffLastSchedule'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOffLastSchedule' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeOffLastSchedule
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.AccountId, dbo.AccountEmployee.AccountTimeOffPolicyId, 
                      dbo.AccountEmployee.TimeOffApprovalTypeId, dbo.AccountEmployee.LastTimeOffCalculationScheduledTime, DATEDIFF(Year, 
                      dbo.AccountEmployeeTimeOff.LastEarnedDate, GETDATE()) AS TotalYears, DATEDIFF(day, dbo.AccountEmployeeTimeOff.LastEarnedDate, GETDATE()) 
                      AS TotalDays, DATEDIFF(month, dbo.AccountEmployeeTimeOff.LastEarnedDate, GETDATE()) AS TotalMonth, DATEDIFF(week, 
                      dbo.AccountEmployeeTimeOff.LastEarnedDate, GETDATE()) AS TotalWeeks, dbo.AccountTimeOffPolicy.AccountTimeOffPolicy, 
                      dbo.AccountTimeOffPolicy.MasterTimeOffPolicyId, dbo.AccountTimeOffPolicyDetail.AccountTimeOffPolicyDetailId, 
                      dbo.AccountTimeOffPolicyDetail.AccountTimeOffTypeId, dbo.AccountTimeOffPolicyDetail.SystemEarnPeriodId, 
                      dbo.AccountTimeOffPolicyDetail.SystemResetToZeroTypeId, dbo.AccountTimeOffPolicyDetail.ResetToHours, 
                      dbo.AccountTimeOffPolicyDetail.EarnHours, dbo.AccountTimeOffPolicyDetail.CarryOver, dbo.AccountTimeOffPolicyDetail.MaximumAvailable, 
                      dbo.AccountTimeOffPolicyDetail.MasterTimeOffPolicyDetailId, dbo.SystemEarnPeriod.SystemEarnPeriod, 
                      dbo.AccountTimeOffType.AccountTimeOffType, dbo.AccountTimeOffType.IsTimeOffRequestRequired, dbo.AccountTimeOffPolicyDetail.InitialSetToHours, 
                      dbo.AccountEmployee.InitialPolicy, dbo.SystemResetToZeroType.SystemResetToZeroType, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountTimeOffPolicyDetail.EffectiveDate, dbo.AccountEmployee.HiredDate, dbo.AccountEmployeeTimeOff.LastEarnedDate, DATEDIFF(day, 
                      dbo.AccountEmployeeTimeOff.LastResetDate, GETDATE()) AS ResetTotalDays, DATEDIFF(month, dbo.AccountEmployeeTimeOff.LastResetDate, 
                      GETDATE()) AS ResetTotalMonth, dbo.AccountEmployeeTimeOff.LastResetDate
FROM         dbo.SystemResetToZeroType RIGHT OUTER JOIN
                      dbo.AccountTimeOffPolicyDetail INNER JOIN
                      dbo.AccountTimeOffType ON 
                      dbo.AccountTimeOffPolicyDetail.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId RIGHT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.AccountTimeOffPolicy ON dbo.AccountEmployee.AccountTimeOffPolicyId = dbo.AccountTimeOffPolicy.AccountTimeOffPolicyId INNER JOIN
                      dbo.AccountEmployeeTimeOff ON dbo.AccountEmployee.AccountEmployeeId = dbo.AccountEmployeeTimeOff.AccountEmployeeId ON 
                      dbo.AccountTimeOffType.AccountTimeOffTypeId = dbo.AccountEmployeeTimeOff.AccountTimeOffTypeId AND 
                      dbo.AccountTimeOffPolicyDetail.AccountTimeOffPolicyId = dbo.AccountTimeOffPolicy.AccountTimeOffPolicyId LEFT OUTER JOIN
                      dbo.SystemEarnPeriod ON dbo.AccountTimeOffPolicyDetail.SystemEarnPeriodId = dbo.SystemEarnPeriod.SystemEarnPeriodId ON 
                      dbo.SystemResetToZeroType.SystemResetToZeroTypeId = dbo.AccountTimeOffPolicyDetail.SystemResetToZeroTypeId'
GO
-- Create View vueAccountEmployeeTimeOff
Print 'Create View vueAccountEmployeeTimeOff'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOff' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeOff
AS
SELECT     dbo.AccountTimeOffType.AccountTimeOffType, dbo.AccountEmployeeTimeOff.AccountEmployeeTimeOffId, 
                      dbo.AccountEmployeeTimeOff.AccountEmployeeId, dbo.AccountEmployeeTimeOff.AccountId, dbo.AccountEmployeeTimeOff.AccountTimeOffTypeId, 
                      dbo.AccountEmployeeTimeOff.Earned, dbo.AccountEmployeeTimeOff.Consume, dbo.AccountEmployeeTimeOff.Available, 
                      dbo.AccountEmployeeTimeOff.LastEarnedDate, dbo.AccountTimeOffType.IsTimeOffRequestRequired, dbo.AccountEmployeeTimeOff.CarryForward, 
                      dbo.AccountTimeOffPolicy.AccountTimeOffPolicy, dbo.AccountTimeOffPolicy.MasterTimeOffPolicyId, 
                      dbo.AccountEmployeeTimeOff.AccountTimeOffPolicyId, dbo.AccountEmployeeTimeOff.LastResetDate
FROM         dbo.AccountEmployeeTimeOff INNER JOIN
                      dbo.AccountTimeOffPolicy ON 
                      dbo.AccountEmployeeTimeOff.AccountTimeOffPolicyId = dbo.AccountTimeOffPolicy.AccountTimeOffPolicyId LEFT OUTER JOIN
                      dbo.AccountTimeOffType ON dbo.AccountEmployeeTimeOff.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId
WHERE     (dbo.AccountTimeOffType.IsDisabled <> 1)'
GO
If exists(Select * from SystemData where version = '3.6.6')
BEGIN
Update AccountEmployeeTimeOff Set AccountTimeOffPolicyId = 
(Select AccountTimeOffPolicyId from AccountEmployee Where AccountEmployeeId = AccountEmployeeTimeOff.AccountEmployeeId)
Where AccountEmployeeTimeOffId in
(Select AccountEmployeeTimeOffId from AccountEmployeeTimeOff where AccountTimeOffPolicyId not in 
(Select AccountTimeOffPolicyId from AccountEmployee 
Where AccountEmployeeiD = AccountEmployeeTimeOff.AccountEmployeeId))
END
GO
If exists(Select * from SystemData where version = '3.6.6')
BEGIN
Update AccountEmployeeTimeOff  Set LastResetDate = 
(Select a.LastEarnedDate from AccountEmployeeTimeOff a
Where a.LastEarnedDate is not null and Accountemployeetimeoff.accountemployeetimeoffid
= a.accountemployeetimeoffid)
Where LastEarnedDate is not null
END


GO

-- Drop Procedure CreateTableforAccountEmployeeTimesheetSubmissionStatus
Print 'Drop Procedure CreateTableforAccountEmployeeTimesheetSubmissionStatus'
GO
DROP PROCEDURE [dbo].[CreateTableforAccountEmployeeTimesheetSubmissionStatus]

GO
-- Drop Procedure InsertAbsentDate
Print 'Drop Procedure InsertAbsentDate'
GO
DROP PROCEDURE [dbo].[InsertAbsentDate]

GO
-- Create Procedure InsertAbsentDate
Print 'Create Procedure InsertAbsentDate'
GO

CREATE PROCEDURE [dbo].[InsertAbsentDate]
    (
@startdate datetime,    
@enddate datetime,
@AccountEmployeeId integer,
@AccountId integer
            )
AS

    SET NOCOUNT ON

IF NOT EXISTS (SELECT * FROM tempdb.dbo.sysobjects WHERE NAME = '##temp')
create table ##temp(AbsentDate datetime, 
AccountEmployeeId int,
AccountId int)


IF EXISTS (SELECT * FROM tempdb.dbo.sysobjects WHERE NAME = '##temp')
delete from ##temp where AccountId = @AccountId and AccountEmployeeId = @AccountEmployeeId

insert into ##temp(AbsentDate, AccountEmployeeId, AccountId) 
Select dateadd(day,number,@startdate), @AccountEmployeeId as AccountEmployeeId, @AccountId as AccountId
from master.dbo.spt_values  where master.dbo.spt_values.type='P' 
and dateadd(day,number,@startdate)<=@enddate  



-- Create Procedure CreateTableforAccountEmployeeTimesheetSubmissionStatus
Print 'Create Procedure CreateTableforAccountEmployeeTimesheetSubmissionStatus'
GO

CREATE PROCEDURE [dbo].[CreateTableforAccountEmployeeTimesheetSubmissionStatus]
    (
@startdate datetime,    
@enddate datetime,
@AccountEmployeeId varchar,
@AccountId integer
            )
AS

    SET NOCOUNT ON

IF EXISTS (SELECT * FROM tempdb.dbo.sysobjects WHERE NAME = '##tempAccountEmployeeTimesheetSubmissionStatusALL')
drop table ##tempAccountEmployeeTimesheetSubmissionStatusALL 


create table ##tempAccountEmployeeTimesheetSubmissionStatusALL 
(AccountEmployeeId int,
EmployeeName varchar(200),
DepartmentName varchar(200),
TimeEntryDate datetime,
NotEntered int,
Entered int,
Submitted int,
Approved int,
Rejected int,
Role varchar(100),
AccountId int)


insert into ##tempAccountEmployeeTimesheetSubmissionStatusALL
(AccountEmployeeId,
EmployeeName,
DepartmentName, 
TimeEntryDate,
NotEntered,
Entered, 
Submitted,
Approved,
Rejected,
Role,
AccountId)
SELECT     [##temp].AccountEmployeeId, dbo.AccountEmployee.FirstName + N' ' + dbo.AccountEmployee.LastName AS EmployeeName, 
                      dbo.AccountDepartment.DepartmentName, AbsentDate AS TimeEntryDate, (CASE WHEN NOT IsNull(AccountEmployeeTimeEntry.TimeEntryDate, 0) 
                      = 0 THEN 0 ELSE 1 END) AS NotEntered, COUNT(dbo.AccountEmployeeTimeEntry.TimeEntryDate) AS Entered, 
                      (CASE WHEN dbo.AccountEmployeeTimeEntry.Submitted = 1 THEN COUNT(dbo.AccountEmployeeTimeEntry.Submitted) ELSE 0 END) AS Submitted, 
                      SUM(CASE WHEN Approved = 1 THEN 1 ELSE 0 END) AS Approved, SUM(CASE WHEN Rejected = 1 THEN 1 ELSE 0 END) AS Rejected, dbo.AccountRole.Role, 
                      [##temp].AccountId
FROM         dbo.AccountEmployeeTimeEntry RIGHT OUTER JOIN
                      dbo.tempdb.[##temp] ON dbo.[##temp].AccountEmployeeId = dbo.AccountEmployeeTimeEntry.AccountEmployeeId AND 
                      dbo.[##temp].AbsentDate = dbo.AccountEmployeeTimeEntry.TimeEntryDate INNER JOIN
                      dbo.AccountEmployee ON [##temp].AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId INNER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId
GROUP BY [##temp].AccountId, [##temp].AccountEmployeeId, AbsentDate, dbo.AccountEmployeeTimeEntry.Submitted, dbo.AccountEmployeeTimeEntry.TimeEntryDate, 
                      dbo.AccountEmployee.FirstName + N' ' + dbo.AccountEmployee.LastName, dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role

GO
Update SystemData Set Version = '3.6.7' Where Version = '3.6.6' And SystemDataId = 1


-- Alter Column Duration on AccountProjectTask
Print 'Alter Column Duration on AccountProjectTask'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProjectTask' AND TABLE_TYPE='BASE TABLE')) AND (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='Duration' AND TABLE_NAME='AccountProjectTask'))
ALTER TABLE [dbo].[AccountProjectTask]
	 ALTER COLUMN [Duration] float NULL

GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemSecurityCategoryPage]'
GO
If exists(Select * from SystemData where version = '3.6.7')

BEGIN
UPDATE [dbo].[SystemSecurityCategoryPage] SET [SystemFeatureId]='deaa2ae5-133d-4c8a-ab0c-b89eaa76116e' WHERE [SystemSecurityCategoryPageId]=132
END

GO
Update SystemData Set Version = '3.6.8' Where Version = '3.6.7' And SystemDataId = 1

GO

-- Alter Column EstimatedDuration on AccountProject
Print 'Alter Column EstimatedDuration on AccountProject'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProject' AND TABLE_TYPE='BASE TABLE')) AND (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='EstimatedDuration' AND TABLE_NAME='AccountProject'))
ALTER TABLE [dbo].[AccountProject]
	 ALTER COLUMN [EstimatedDuration] float NULL
GO
-- Drop View vueAccountExpenseEntryWithLastStatus
Print 'Drop View vueAccountExpenseEntryWithLastStatus'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryWithLastStatus' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountExpenseEntryWithLastStatus]
GO
-- Drop View vueAccountExpenseEntry
Print 'Drop View vueAccountExpenseEntry'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntry' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountExpenseEntry]
GO
-- Drop View vueAccountEmployee
Print 'Drop View vueAccountEmployee'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployee]
GO
-- Add Column IsForcePasswordChange to AccountEmployee
Print 'Add Column IsForcePasswordChange to AccountEmployee'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployee' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='IsForcePasswordChange' AND TABLE_NAME='AccountEmployee'))
ALTER TABLE [dbo].[AccountEmployee]
	ADD [IsForcePasswordChange] bit NOT NULL
    CONSTRAINT [DF_AccountEmployee_IsForcePasswordChange_1] DEFAULT ((0))
GO
-- Add Column PasswordChangedDate to AccountEmployee
Print 'Add Column PasswordChangedDate to AccountEmployee'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployee' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='PasswordChangedDate' AND TABLE_NAME='AccountEmployee'))
ALTER TABLE [dbo].[AccountEmployee]
	ADD [PasswordChangedDate] datetime NULL
GO
-- Add Column PasswordExpiryPeriod to AccountPreferences
Print 'Add Column PasswordExpiryPeriod to AccountPreferences'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountPreferences' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='PasswordExpiryPeriod' AND TABLE_NAME='AccountPreferences'))
ALTER TABLE [dbo].[AccountPreferences]
	ADD [PasswordExpiryPeriod] int NULL

GO
-- Create View vueAccountEmployee
Print 'Create View vueAccountEmployee'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployee
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountEmployee.AccountId, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.Password, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountLocationId, 
                      dbo.AccountEmployee.BillingTypeId, dbo.AccountBillingType.BillingType, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountPreferences.ShowClockStartEnd, 
                      dbo.Account.TimeZoneId, dbo.AccountRole.MasterAccountRoleId, dbo.Account.DefaultCurrencyId, dbo.Account.CountryId, 
                      dbo.AccountPreferences.CultureInfoName, dbo.AccountPreferences.TimeEntryFormat, dbo.AccountEmployee.AllowedAccessFromIP, 
                      dbo.AccountRole.AccountRoleId, dbo.AccountPreferences.AccountSessionTimeout, dbo.AccountPreferences.ShowCompletedTasksInTimeSheet, 
                      dbo.AccountPreferences.CurrencySymbol, dbo.AccountPreferences.IsCompanyOwnLogo, dbo.Account.AccountExpiryActivation, 
                      dbo.Account.LicenseActivation, dbo.AccountEmployee.EmployeeTypeId, dbo.AccountEmployee.ExternalUserClientId, 
                      dbo.AccountEmployee.AccountBillingRateId, dbo.AccountPreferences.ScheduledEmailSendTime, dbo.AccountEmployee.Username, 
                      dbo.AccountEmployee.IsDisabled, dbo.AccountPreferences.FromEmailAddress, dbo.AccountPreferences.FromEmailAddressDisplayName, 
                      dbo.AccountEmployee.EmployeeCode, dbo.AccountPreferences.Version, dbo.AccountPreferences.LockSubmittedRecords, 
                      dbo.AccountPreferences.LockApprovedRecords, ISNULL(dbo.AccountEmployee.EmployeeCode + '' - '', '''') 
                      + dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeNameWithCode, 
                      dbo.AccountPreferences.ShowWorkTypeInTimeSheet, dbo.AccountPreferences.NumberOfBlankRowsInTimeEntry, 
                      dbo.AccountPreferences.ShowCostCenterInTimeSheet, dbo.AccountPreferences.WeekStartDay, dbo.AccountPreferences.AccountBaseCurrencyId, 
                      dbo.AccountPreferences.UserInterfaceLanguage, dbo.AccountEmployee.EmployeeManagerId, dbo.AccountPreferences.DefaultTimeEntryMode, 
                      dbo.AccountPreferences.PageSize, dbo.AccountEmployee.TimeZoneId AS EmployeeTimeZoneId, dbo.AccountEmployee.TerminationDate, 
                      dbo.AccountEmployee.StatusId, dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.EmployeePayTypeId, dbo.AccountEmployee.HiredDate, 
                      dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountWorkingDayType, dbo.AccountWorkingDayType.HoursPerDay, 
                      dbo.AccountWorkingDayType.WeekStartDay AS EmployeeWeekStartDay, dbo.AccountPreferences.ShowClientInTimesheet, 
                      dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, 
                      dbo.AccountPreferences.ShowDescriptionInWeekView, dbo.AccountPreferences.InvoiceNoPrefix, 
                      dbo.AccountPreferences.ShowAdditionalTaskInformationType, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, ISNULL(dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, 1) 
                      AS InitialDayOfTheMonth, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, 1) 
                      AS SystemInitialDayOfFirstPeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod, 16) AS SystemInitialDayOfLastPeriod, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountPreferences.TimesheetPrintFooter, 
                      dbo.AccountPreferences.ExpenseSheetPrintFooter, dbo.AccountPreferences.ShowCompletedProjectsInTimeSheet, 
                      dbo.AccountPreferences.ShowProjectForTimeOff, dbo.AccountPreferences.ShowTimeOffInTimesheet, dbo.AccountEmployee.IsDeleted, 
                      dbo.AccountEmployee.IsForcePasswordChange, dbo.AccountEmployee.PasswordChangedDate, dbo.AccountPreferences.PasswordExpiryPeriod
FROM         dbo.vueAccountTimesheetPeriodType RIGHT OUTER JOIN
                      dbo.AccountWorkingDayType ON 
                      dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId = dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId RIGHT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.Account ON dbo.AccountEmployee.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId ON 
                      dbo.AccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployee.AccountId = dbo.AccountPreferences.AccountId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId'
GO
-- Create View vueAccountExpenseEntry
Print 'Create View vueAccountExpenseEntry'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntry' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountExpenseEntry
AS
SELECT     dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountExpense.AccountExpenseName, 
                      dbo.AccountProject.ProjectName, dbo.AccountExpenseEntry.AccountExpenseEntryId, dbo.AccountExpenseEntry.AccountExpenseEntryDate, 
                      dbo.AccountExpenseEntry.AccountId, dbo.AccountExpenseEntry.AccountEmployeeId, dbo.AccountExpenseEntry.AccountProjectId, 
                      dbo.AccountExpenseEntry.AccountExpenseId, dbo.AccountExpenseEntry.Amount, dbo.AccountExpenseEntry.TeamLeadApproved, 
                      dbo.AccountExpenseEntry.ProjectManagerApproved, dbo.AccountExpenseEntry.AdministratorApproved, dbo.AccountExpenseEntry.Approved, 
                      dbo.AccountExpenseEntry.CreatedOn, dbo.AccountExpenseEntry.CreatedByEmployeeId, dbo.AccountExpenseEntry.ModifiedOn, 
                      dbo.AccountExpenseEntry.ModifiedByEmployeeId, dbo.AccountParty.PartyName, dbo.AccountProject.AccountClientId, 
                      dbo.AccountExpenseEntry.Description, dbo.AccountExpenseType.ExpenseType, dbo.AccountExpense.AccountExpenseTypeId, 
                      dbo.AccountProject.LeaderEmployeeId, dbo.AccountExpenseEntry.IsBillable, dbo.AccountExpenseEntry.Rejected, 
                      dbo.AccountEmployee.EmployeeCode, dbo.AccountExpenseEntry.Reimburse, dbo.AccountExpenseEntry.AccountCurrencyId, 
                      dbo.SystemCurrency.CurrencyCode, dbo.AccountExpenseType.IsQuantityField, dbo.AccountExpenseType.QuantityFieldCaption, 
                      dbo.AccountExpenseEntry.AccountBaseCurrencyId, dbo.AccountExpenseEntry.ExchangeRate, ISNULL(dbo.AccountExpenseEntry.TaxAmount, 0) 
                      AS TaxAmount, ISNULL(dbo.AccountExpenseEntry.AmountBeforeTax, 0) AS NetAmount, dbo.AccountExpenseEntry.Submitted, 
                      dbo.AccountProject.TimeSheetApprovalTypeId, dbo.AccountProject.ExpenseApprovalTypeId, dbo.AccountProject.ProjectManagerEmployeeId, 
                      dbo.AccountExpenseEntry.TimeSheetApprovalPathId, dbo.AccountEmployee.EMailAddress, dbo.AccountDepartment.DepartmentName, 
                      dbo.AccountLocation.AccountLocation, dbo.AccountTaxZone.AccountTaxZone, dbo.AccountExpenseEntry.Quantity, dbo.AccountExpenseEntry.Rate, 
                      dbo.AccountPaymentMethod.PaymentMethod, dbo.AccountLocation.AccountLocationId, dbo.AccountParty.PartyNick, 
                      dbo.AccountProject.ProjectDescription, dbo.AccountProject.ProjectCode, dbo.AccountDepartment.DepartmentCode, 
                      dbo.vueAccountExpenseEntryApprovalLastAction.Comments, dbo.vueAccountExpenseEntryApprovalLastAction.ApprovedOn, 
                      dbo.AccountDepartment.AccountDepartmentId, dbo.AccountRole.Role, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountExpenseEntry.AccountTimeExpenseBillingExpenseId, dbo.AccountExpenseEntry.Billed, dbo.AccountTimeExpenseBilling.InvoiceNumber, 
                      dbo.AccountTimeExpenseBilling.InvoiceDate, dbo.AccountProjectType.AccountProjectTypeId, dbo.AccountProjectType.ProjectType, 
                      dbo.AccountExpenseEntry.AccountEmployeeExpenseSheetId, dbo.AccountEmployeeExpenseSheet.Description AS ExpenseSheetDescription, 
                      dbo.AccountEmployeeExpenseSheet.ExpenseSheetDate, dbo.AccountEmployeeExpenseSheet.SubmittedDate, 
                      dbo.AccountEmployeeExpenseSheet.Approved AS SheetApproved, dbo.AccountEmployeeExpenseSheet.Rejected AS SheetRejected, 
                      dbo.AccountEmployeeExpenseSheet.Submitted AS SheetSubmitted, dbo.AccountEmployeeExpenseSheet.InApproval AS SheetInApproval, 
                      dbo.AccountTaxCode.TaxCode, dbo.AccountTaxCode.Formula, dbo.AccountTaxCode.AccountTaxCodeId
FROM         dbo.AccountDepartment RIGHT OUTER JOIN
                      dbo.AccountParty RIGHT OUTER JOIN
                      dbo.AccountProject LEFT OUTER JOIN
                      dbo.AccountProjectType ON dbo.AccountProject.AccountProjectTypeId = dbo.AccountProjectType.AccountProjectTypeId ON 
                      dbo.AccountParty.AccountPartyId = dbo.AccountProject.AccountClientId RIGHT OUTER JOIN
                      dbo.SystemCurrency RIGHT OUTER JOIN
                      dbo.AccountCurrency RIGHT OUTER JOIN
                      dbo.AccountPaymentMethod RIGHT OUTER JOIN
                      dbo.vueAccountExpenseEntryApprovalLastAction RIGHT OUTER JOIN
                      dbo.AccountEmployee RIGHT OUTER JOIN
                      dbo.AccountTaxZone RIGHT OUTER JOIN
                      dbo.AccountTaxCode RIGHT OUTER JOIN
                      dbo.AccountExpenseType INNER JOIN
                      dbo.AccountExpenseEntry INNER JOIN
                      dbo.AccountExpense ON dbo.AccountExpenseEntry.AccountExpenseId = dbo.AccountExpense.AccountExpenseId ON 
                      dbo.AccountExpenseType.AccountExpenseTypeId = dbo.AccountExpense.AccountExpenseTypeId LEFT OUTER JOIN
                      dbo.AccountExpenseTypeTaxCode ON dbo.AccountExpenseEntry.AccountTaxZoneId = dbo.AccountExpenseTypeTaxCode.AccountTaxZoneId AND 
                      dbo.AccountExpenseType.AccountExpenseTypeId = dbo.AccountExpenseTypeTaxCode.AccountExpenseTypeId ON 
                      dbo.AccountTaxCode.AccountTaxCodeId = dbo.AccountExpenseTypeTaxCode.AccountTaxCodeId ON 
                      dbo.AccountTaxZone.AccountTaxZoneId = dbo.AccountExpenseEntry.AccountTaxZoneId LEFT OUTER JOIN
                      dbo.AccountEmployeeExpenseSheet ON 
                      dbo.AccountExpenseEntry.AccountEmployeeExpenseSheetId = dbo.AccountEmployeeExpenseSheet.AccountEmployeeExpenseSheetId ON 
                      dbo.AccountEmployee.AccountEmployeeId = dbo.AccountExpenseEntry.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountTimeExpenseBillingExpense INNER JOIN
                      dbo.AccountTimeExpenseBilling ON 
                      dbo.AccountTimeExpenseBillingExpense.AccountTimeExpenseBillingId = dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId ON 
                      dbo.AccountExpenseEntry.AccountTimeExpenseBillingExpenseId = dbo.AccountTimeExpenseBillingExpense.AccountTimeExpenseBillingExpenseId ON
                       dbo.vueAccountExpenseEntryApprovalLastAction.AccountExpenseEntryId = dbo.AccountExpenseEntry.AccountExpenseEntryId ON 
                      dbo.AccountPaymentMethod.AccountPaymentMethodId = dbo.AccountExpenseEntry.AccountPaymentMethodId ON 
                      dbo.AccountCurrency.AccountCurrencyId = dbo.AccountExpenseEntry.AccountCurrencyId ON 
                      dbo.SystemCurrency.CurrencyId = dbo.AccountCurrency.SystemCurrencyId ON 
                      dbo.AccountProject.AccountProjectId = dbo.AccountExpenseEntry.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId ON 
                      dbo.AccountDepartment.AccountDepartmentId = dbo.AccountEmployee.AccountDepartmentId'
GO
-- Create View vueAccountExpenseEntryWithLastStatus
Print 'Create View vueAccountExpenseEntryWithLastStatus'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryWithLastStatus' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountExpenseEntryWithLastStatus
AS
SELECT     dbo.vueAccountExpenseEntryWithLastAction.IsRejected, dbo.vueAccountExpenseEntryWithLastAction.IsApproved, 
                      dbo.vueAccountExpenseEntry.EmployeeName, dbo.vueAccountExpenseEntry.AccountExpenseName, dbo.vueAccountExpenseEntry.ProjectName, 
                      dbo.vueAccountExpenseEntry.AccountExpenseEntryId, dbo.vueAccountExpenseEntry.AccountExpenseEntryDate, 
                      dbo.vueAccountExpenseEntry.AccountId, dbo.vueAccountExpenseEntry.AccountEmployeeId, dbo.vueAccountExpenseEntry.AccountProjectId, 
                      dbo.vueAccountExpenseEntry.AccountExpenseId, dbo.vueAccountExpenseEntry.Amount, dbo.vueAccountExpenseEntry.TeamLeadApproved, 
                      dbo.vueAccountExpenseEntry.ProjectManagerApproved, dbo.vueAccountExpenseEntry.AdministratorApproved, 
                      dbo.vueAccountExpenseEntry.Approved, dbo.vueAccountExpenseEntry.CreatedOn, dbo.vueAccountExpenseEntry.CreatedByEmployeeId, 
                      dbo.vueAccountExpenseEntry.ModifiedOn, dbo.vueAccountExpenseEntry.ModifiedByEmployeeId, dbo.vueAccountExpenseEntry.PartyName, 
                      dbo.vueAccountExpenseEntry.AccountClientId, dbo.vueAccountExpenseEntry.Description, dbo.vueAccountExpenseEntry.ExpenseType, 
                      dbo.vueAccountExpenseEntry.AccountExpenseTypeId, dbo.vueAccountExpenseEntry.LeaderEmployeeId, dbo.vueAccountExpenseEntry.IsBillable, 
                      dbo.vueAccountExpenseEntry.Rejected, dbo.vueAccountExpenseEntry.EmployeeCode, dbo.vueAccountExpenseEntry.Reimburse, 
                      dbo.vueAccountExpenseEntry.AccountCurrencyId, dbo.vueAccountExpenseEntry.CurrencyCode, dbo.vueAccountExpenseEntry.IsQuantityField, 
                      dbo.vueAccountExpenseEntry.QuantityFieldCaption, dbo.vueAccountExpenseEntry.Submitted, 
                      dbo.vueAccountExpenseEntry.AccountEmployeeExpenseSheetId, dbo.vueAccountExpenseEntry.SubmittedDate, 
                      dbo.vueAccountExpenseEntry.ExpenseSheetDate, dbo.vueAccountExpenseEntry.ExpenseSheetDescription, 
                      dbo.vueAccountExpenseEntry.ExchangeRate, dbo.vueAccountExpenseEntry.TaxAmount, dbo.vueAccountExpenseEntry.NetAmount, 
                      dbo.vueAccountExpenseEntry.PaymentMethod, dbo.vueAccountExpenseEntry.Quantity, dbo.vueAccountExpenseEntry.Rate, 
                      dbo.vueAccountExpenseEntry.AccountTaxCodeId, dbo.vueAccountExpenseEntry.TaxCode
FROM         dbo.vueAccountExpenseEntryWithLastAction RIGHT OUTER JOIN
                      dbo.vueAccountExpenseEntry ON 
                      dbo.vueAccountExpenseEntryWithLastAction.AccountExpenseEntryId = dbo.vueAccountExpenseEntry.AccountExpenseEntryId'

GO
-- Drop View vueAccountProjectForProjectSummary
Print 'Drop View vueAccountProjectForProjectSummary'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountProjectForProjectSummary' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountProjectForProjectSummary]

GO
-- Create View vueAccountProjectForProjectSummary
Print 'Create View vueAccountProjectForProjectSummary'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountProjectForProjectSummary' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountProjectForProjectSummary
AS
SELECT     dbo.AccountProject.AccountProjectId, dbo.AccountProject.AccountId, dbo.AccountProject.AccountProjectTypeId, dbo.AccountProject.AccountClientId, 
                      dbo.AccountProject.ProjectBillingTypeId, dbo.AccountProject.ProjectName, dbo.AccountProject.ProjectDescription, dbo.AccountProject.StartDate, 
                      dbo.AccountProject.AccountMilestoneId, dbo.AccountProject.Deadline, dbo.AccountProject.LeaderEmployeeId, dbo.AccountProject.ProjectManagerEmployeeId, 
                      dbo.AccountProject.EstimatedTime, dbo.AccountProject.EstimatedDuration, dbo.AccountProject.EstimatedDurationUnit, dbo.AccountProject.ProjectCode, 
                      dbo.AccountProject.DefaultBillingRate, dbo.AccountProject.IsActive, dbo.AccountProject.ProjectStatusId, dbo.AccountProject.AccountPriorityId, 
                      dbo.AccountProject.TimeSheetApprovalTypeId, dbo.AccountProject.ExpenseApprovalTypeId, dbo.AccountProject.CreatedOn, dbo.AccountProject.CreatedByEmployeeId, 
                      dbo.AccountProject.ModifiedOn, dbo.AccountProject.ModifiedByEmployeeId, dbo.AccountProject.ProjectBillingRateTypeId, dbo.AccountProject.AccountPartyContactId, 
                      dbo.AccountProject.AccountPartyDepartmentId, dbo.AccountProject.IsDisabled, dbo.AccountProject.IsTemplate, dbo.AccountProject.IsProject, 
                      dbo.AccountProject.AccountProjectTemplateId, dbo.AccountProject.Completed, dbo.AccountProject.IsDeleted, dbo.AccountParty.PartyName
FROM         dbo.AccountProject INNER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId'

GO
If exists(Select * from SystemData where version = '3.6.8')
BEGIN
Delete From a From AccountFeatures a 
Where a.AccountFeatureId Is NOt NULL And a.AccountFeatureId not In
(Select Top 1 b.AccountFeatureId From AccountFeatures b 
Where b.AccountId = a.AccountId and b.SystemFeatureId = a.SystemFeatureId)
END

GO
-- Create Index IX_SystemFeatures on AccountFeatures
Print 'Create Index IX_SystemFeatures on AccountFeatures'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountFeatures' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountFeatures]') AND name = N'IX_SystemFeatures'))
CREATE UNIQUE INDEX [IX_SystemFeatures]
	ON [dbo].[AccountFeatures] ([SystemFeatureId], [AccountId])

GO
Update SystemData Set Version = '3.6.9' Where Version = '3.6.8' And SystemDataId = 1

GO
-- Drop View vueAccountEmployeeTimeEntryForReport
Print 'Drop View vueAccountEmployeeTimeEntryForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryForReport]

GO

-- Drop View vueAccountEmployeeTimeEntryWithTimeOffForReport
Print 'Drop View vueAccountEmployeeTimeEntryWithTimeOffForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithTimeOffForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryWithTimeOffForReport]

GO
-- Drop View rptvueAccountEmployeeTimeEntry
Print 'Drop View rptvueAccountEmployeeTimeEntry'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeEntry' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountEmployeeTimeEntry]

GO
-- Create View vueAccountEmployeeTimeEntryWithTimeOffForReport
Print 'Create View vueAccountEmployeeTimeEntryWithTimeOffForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithTimeOffForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport
AS
SELECT     dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountProject.ProjectName, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 1 THEN dbo.AccountProjectTask.TaskName ELSE dbo.AccountTimeOffType.AccountTimeOffType END AS TaskName,
                       dbo.AccountEmployeeTimeEntry.TotalTime, dbo.AccountEmployeeTimeEntry.Approved, dbo.AccountEmployee.AccountEmployeeId, 
                      dbo.AccountProject.AccountProjectId, dbo.AccountEmployeeTimeEntry.TeamLeadApproved, dbo.AccountEmployeeTimeEntry.ProjectManagerApproved, 
                      dbo.AccountEmployeeTimeEntry.AdministratorApproved, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, dbo.AccountEmployeeTimeEntry.StartTime, 
                      dbo.AccountEmployeeTimeEntry.EndTime, dbo.AccountEmployeeTimeEntry.TimeEntryDate, dbo.AccountEmployeeTimeEntry.Description, 
                      ISNULL(dbo.AccountProject.AccountId, dbo.AccountTimeOffType.AccountId) AS AccountId, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime) AS TotalMinutes, DATEPART(dw, dbo.AccountEmployeeTimeEntry.TimeEntryDate) AS WeekDay, 
                      dbo.AccountParty.AccountPartyId, dbo.AccountParty.PartyName, dbo.AccountProjectTask.AccountProjectTaskId, dbo.AccountBillingType.BillingType, 
                      dbo.AccountProject.LeaderEmployeeId, dbo.AccountProject.ProjectManagerEmployeeId, dbo.AccountProject.TimeSheetApprovalTypeId, 
                      dbo.AccountProject.ExpenseApprovalTypeId, dbo.AccountProjectTask.IsBillable, dbo.AccountEmployeeTimeEntry.Rejected, 
                      dbo.AccountEmployeeTimeEntry.BillingRate, dbo.AccountProject.ProjectBillingRateTypeId, dbo.AccountEmployee.EmployeeCode, 
                      dbo.AccountEmployee.AccountDepartmentId, dbo.AccountDepartment.DepartmentName, dbo.AccountProjectTask.EstimatedCost, 
                      dbo.AccountProjectTask.EstimatedTimeSpent, dbo.AccountEmployeeTimeEntry.Submitted, dbo.AccountWorkType.AccountWorkType, 
                      dbo.AccountEmployee.EMailAddress, dbo.AccountLocation.AccountLocation, dbo.AccountCostCenter.AccountCostCenter, 
                      dbo.AccountCostCenter.AccountCostCenterCode, dbo.AccountWorkType.AccountWorkTypeCode, dbo.AccountProject.ProjectCode, dbo.AccountProjectTask.TaskCode, 
                      dbo.AccountLocation.AccountLocationId, dbo.vueAccountEmployeeTimeEntryApprovalLastAction.Comments, dbo.AccountEmployeeTimeEntry.BillingRateCurrencyId, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateCurrencyId, dbo.AccountEmployeeTimeEntry.BillingRateExchangeRate, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateExchangeRate, dbo.AccountEmployeeTimeEntry.AccountBaseCurrencyId, dbo.AccountProjectTask.AccountTaskTypeId, 
                      dbo.AccountProjectTask.TaskStatusId, dbo.AccountProjectTask.AccountPriorityId, dbo.AccountProjectTask.AccountProjectMilestoneId, 
                      dbo.AccountDepartment.DepartmentCode, dbo.AccountParty.PartyNick, dbo.AccountProjectTask.EstimatedCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction.ApprovedOn, dbo.AccountEmployeeTimeEntry.EmployeeRate, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountRole.Role, dbo.AccountProject.AccountProjectTypeId, dbo.AccountProject.ProjectDescription, dbo.AccountProjectTask.TaskDescription, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeExpenseBillingTimesheetId, dbo.AccountEmployeeTimeEntry.Billed, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Submitted = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS SubmittedHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Approved = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS ApprovedHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Rejected = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS RejectedHours, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, 
                      dbo.AccountPartyContact.FirstName + N'' '' + dbo.AccountPartyContact.LastName AS ClientContactName, 
                      dbo.AccountPartyDepartment.PartyDepartmentCode AS ClientDepartmentCode, dbo.AccountPartyDepartment.PartyDepartmentName AS ClientDepartmentName, 
                      dbo.AccountPartyDepartment.PartyDepartmentLocation AS ClientDepartmentLocation, dbo.AccountEmployeeTimeEntry.IsTimeOff, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId, CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 0 THEN ROUND(CONVERT(float, DATEPART(hh, 
                      dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS TimeOffHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS TimesheetHours, dbo.AccountWorkType.AccountWorkTypeId, 
                      dbo.AccountStatus.Status AS ProjectStatus, 
                      CASE WHEN dbo.AccountProjectTask.ParentAccountProjectTaskId <> 0 THEN dbo.AccountProjectTask.TaskName END AS ParentTaskName, 
                      dbo.AccountProjectTask.ParentAccountProjectTaskId
FROM         dbo.AccountProject LEFT OUTER JOIN
                      dbo.AccountStatus ON dbo.AccountProject.ProjectStatusId = dbo.AccountStatus.AccountStatusId RIGHT OUTER JOIN
                      dbo.AccountEmployeeTimeEntry INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeEntry.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId ON 
                      dbo.AccountProject.AccountProjectId = dbo.AccountEmployeeTimeEntry.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountProjectTask ON dbo.AccountEmployeeTimeEntry.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId LEFT OUTER JOIN
                      dbo.AccountTimeOffType ON dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId LEFT OUTER JOIN
                      dbo.AccountPartyDepartment ON dbo.AccountProject.AccountPartyDepartmentId = dbo.AccountPartyDepartment.AccountPartyDepartmentId LEFT OUTER JOIN
                      dbo.AccountPartyContact ON dbo.AccountProject.AccountPartyContactId = dbo.AccountPartyContact.AccountPartyContactId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryPeriod ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId LEFT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryApprovalLastAction.AccountEmployeeTimeEntryId LEFT OUTER JOIN
                      dbo.AccountCostCenter ON dbo.AccountEmployeeTimeEntry.AccountCostCenterId = dbo.AccountCostCenter.AccountCostCenterId LEFT OUTER JOIN
                      dbo.AccountWorkType ON dbo.AccountEmployeeTimeEntry.AccountWorkTypeId = dbo.AccountWorkType.AccountWorkTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId LEFT OUTER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId'

GO
-- Create View vueAccountEmployeeTimeEntryForReport
Print 'Create View vueAccountEmployeeTimeEntryForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryForReport
AS
SELECT     dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeName, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskName, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalTime, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Approved, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TeamLeadApproved, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectManagerApproved, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AdministratorApproved, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeTimeEntryId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.StartTime, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EndTime, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Description, N'''') AS Description, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.WeekDay, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountPartyId AS AccountClientId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.PartyName AS ClientName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectTaskId, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingType, N'''') 
                      AS BillingType, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectManagerEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ExpenseApprovalTypeId, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.IsBillable, 0) 
                      AS IsBillable, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Rejected, 0) AS Rejected, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRate, 0) AS BillingRate, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectBillingRateTypeId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeCode, N'''') AS EmployeeCode, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountDepartmentId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.DepartmentName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedCost, 0) AS EstimatedCost, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedTimeSpent, 0) AS EstimatedHours, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Submitted, 0) AS Submitted, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountWorkType, N'''') AS AccountWorkType, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EMailAddress, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountLocation, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountCostCenter, N'''') AS AccountCostCenter, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountCostCenterCode, N'''') AS AccountCostCenterCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountWorkTypeCode, N'''') AS AccountWorkTypeCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectCode, N'''') AS ProjectCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCode, N'''') AS TaskCode, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountLocationId, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Comments, N'''') 
                      AS ApproverComments, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes * dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRate / 60, 0) 
                      AS Amount, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRateCurrencyId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateExchangeRate, 0) AS BillingRateExchangeRate, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRateExchangeRate, 0) AS EmployeeRateExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountBaseCurrencyId, dbo.vueAccountCurrency.CurrencyCode AS BillingRateCurrencyCode, 
                      dbo.vueAccountCurrency.CurrencyCode AS AmountCurrencyCode, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountTaskTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskStatusId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountPriorityId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectMilestoneId, dbo.AccountTaskType.TaskType, dbo.AccountStatus.Status AS TaskStatus, 
                      dbo.AccountProjectMilestone.MilestoneDescription, dbo.AccountPriority.Priority, ROUND(CONVERT(float, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes) / 60, 2) AS TotalHours, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.DepartmentCode, N'''') AS DepartmentCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.PartyNick, N'''') AS ClientNick, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedCurrencyId, vueAccountCurrency_1.CurrencyCode AS EstimatedCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ApprovedOn, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRate, 0) 
                      AS EmployeeRate, vueAccountCurrency_2.CurrencyCode AS EmployeeRateCurrencyCode, 
                      AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName AS TeamLeader, 
                      AccountEmployee_2.FirstName + '' '' + AccountEmployee_2.LastName AS ProjectManager, 
                      ISNULL(dbo.AccountEmployee.FirstName + N'' '' + dbo.AccountEmployee.LastName, N'''') AS EmployeeManager, 
                      vueAccountCurrency_1.ExchangeRate AS EstimatedCurrencyExchangeRate, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes * dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRate / 60, 0) 
                      AS EmployeeCost, { fn DAYOFMONTH(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) } AS DayNo, 
                      MONTH(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) AS MonthNo, DATEPART(week, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) - DATEPART(week, DATEADD(month, DATEDIFF(month, 0, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate), 0)) + 1 AS WeekNo, 
                      YEAR(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) AS Year, 
                      LEFT({ fn MONTHNAME(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) }, 3) + '' - '' + CONVERT(nvarchar(10), 
                      YEAR(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate)) AS Period, 
                      { fn DAYNAME(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) } AS WeekDayName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountRoleId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Role, 
                      dbo.AccountProjectType.ProjectType, dbo.AccountRole.Role AS ProjectRole, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectDescription, N'''') 
                      AS ProjectDescription, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskDescription, N'''') AS TaskDescription, 
                      dbo.AccountTimeExpenseBilling.InvoiceNumber, dbo.AccountTimeExpenseBilling.InvoiceDate, dbo.AccountProjectType.AccountProjectTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Billed, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeTimeEntryPeriodId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientContactName, N'''') AS ClientContactName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentCode, N'''') AS ClientDepartmentCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentName, N'''') AS ClientDepartmentName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentLocation, N'''') AS ClientDepartmentLocation, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.IsTimeOff, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountWorkTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectStatus, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ParentTaskName
FROM         dbo.AccountRole INNER JOIN
                      dbo.AccountProjectEmployee ON dbo.AccountRole.AccountRoleId = dbo.AccountProjectEmployee.AccountRoleId RIGHT OUTER JOIN
                      dbo.AccountTimeExpenseBillingTimesheet INNER JOIN
                      dbo.AccountTimeExpenseBilling ON 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingId = dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId RIGHT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport LEFT OUTER JOIN
                      dbo.AccountProjectType ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectTypeId = dbo.AccountProjectType.AccountProjectTypeId LEFT OUTER JOIN
                      dbo.AccountProjectMilestone ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectMilestoneId = dbo.AccountProjectMilestone.AccountProjectMilestoneId LEFT OUTER JOIN
                      dbo.AccountStatus ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskStatusId = dbo.AccountStatus.AccountStatusId LEFT OUTER JOIN
                      dbo.AccountPriority ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountPriorityId = dbo.AccountPriority.AccountPriorityId LEFT OUTER JOIN
                      dbo.AccountTaskType ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountTaskTypeId = dbo.AccountTaskType.AccountTaskTypeId ON 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingTimesheetId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountTimeExpenseBillingTimesheetId
                       ON dbo.AccountProjectEmployee.AccountEmployeeId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeId AND 
                      dbo.AccountProjectEmployee.AccountProjectId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.LeaderEmployeeId = AccountEmployee_1.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_2 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectManagerEmployeeId = AccountEmployee_2.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.AccountEmployee AS AccountEmployee_3 ON dbo.AccountEmployee.AccountEmployeeId = AccountEmployee_3.EmployeeManagerId ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeId = AccountEmployee_3.AccountEmployeeId LEFT OUTER JOIN
                      dbo.vueAccountCurrency AS vueAccountCurrency_2 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRateCurrencyId = vueAccountCurrency_2.AccountCurrencyId LEFT OUTER JOIN
                      dbo.vueAccountCurrency AS vueAccountCurrency_1 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedCurrencyId = vueAccountCurrency_1.AccountCurrencyId LEFT OUTER JOIN
                      dbo.vueAccountCurrency ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateCurrencyId = dbo.vueAccountCurrency.AccountCurrencyId'

GO
-- Create View rptvueAccountEmployeeTimeEntry
Print 'Create View rptvueAccountEmployeeTimeEntry'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeEntry' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountEmployeeTimeEntry
AS
SELECT     dbo.vueAccountEmployeeTimeEntryForReport.EmployeeName, dbo.vueAccountEmployeeTimeEntryForReport.ProjectName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskName, dbo.vueAccountEmployeeTimeEntryForReport.TotalTime, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Approved, dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectId, dbo.vueAccountEmployeeTimeEntryForReport.TeamLeadApproved, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManagerApproved, dbo.vueAccountEmployeeTimeEntryForReport.AdministratorApproved, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeTimeEntryId, dbo.vueAccountEmployeeTimeEntryForReport.StartTime, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EndTime, dbo.vueAccountEmployeeTimeEntryForReport.TimeEntryDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Description, dbo.vueAccountEmployeeTimeEntryForReport.AccountId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TotalMinutes, dbo.vueAccountEmployeeTimeEntryForReport.WeekDay, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientName, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectTaskId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingType, dbo.vueAccountEmployeeTimeEntryForReport.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManagerEmployeeId, dbo.vueAccountEmployeeTimeEntryForReport.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ExpenseApprovalTypeId, dbo.vueAccountEmployeeTimeEntryForReport.IsBillable, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Rejected, dbo.vueAccountEmployeeTimeEntryForReport.BillingRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectBillingRateTypeId, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountDepartmentId, dbo.vueAccountEmployeeTimeEntryForReport.DepartmentName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCost, dbo.vueAccountEmployeeTimeEntryForReport.EstimatedHours, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Submitted, dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkType, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EMailAddress, dbo.vueAccountEmployeeTimeEntryForReport.AccountLocation, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountCostCenter, dbo.vueAccountEmployeeTimeEntryForReport.AccountCostCenterCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkTypeCode, dbo.vueAccountEmployeeTimeEntryForReport.ProjectCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCode, dbo.vueAccountEmployeeTimeEntryForReport.AccountLocationId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ApproverComments, dbo.vueAccountEmployeeTimeEntryForReport.Amount, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingRateCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountBaseCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.BillingRateCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AmountCurrencyCode, CASE WHEN vueAccountEmployeeTimeEntryForReport.Submitted = 1 AND 
                      vueAccountEmployeeTimeEntryForReport.Approved = 0 THEN ''Submitted'' WHEN vueAccountEmployeeTimeEntryForReport.Approved = 1 THEN ''Approved'' WHEN vueAccountEmployeeTimeEntryForReport.Rejected
                       = 1 THEN ''Rejected'' WHEN vueAccountEmployeeTimeEntryForReport.Submitted = 0 AND vueAccountEmployeeTimeEntryForReport.Approved = 0 AND 
                      vueAccountEmployeeTimeEntryForReport.Rejected = 0 THEN ''Not Submitted'' END AS ApprovalStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountTaskTypeId, dbo.vueAccountEmployeeTimeEntryForReport.TaskStatusId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountPriorityId, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectMilestoneId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskType, dbo.vueAccountEmployeeTimeEntryForReport.TaskStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.MilestoneDescription, dbo.vueAccountEmployeeTimeEntryForReport.Priority, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TotalHours, dbo.vueAccountEmployeeTimeEntryForReport.DepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientNick, dbo.vueAccountEmployeeTimeEntryForReport.AccountClientId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ApprovedOn, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateCurrencyCode, dbo.vueAccountEmployeeTimeEntryForReport.TeamLeader, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManager, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeManager, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate, 0) AS EstimatedCurrencyExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCost, dbo.vueAccountEmployeeTimeEntryForReport.AccountRoleId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Role, dbo.vueAccountEmployeeTimeEntryForReport.WeekDayName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Period, dbo.vueAccountEmployeeTimeEntryForReport.Year, dbo.vueAccountEmployeeTimeEntryForReport.WeekNo, 
                      dbo.vueAccountEmployeeTimeEntryForReport.MonthNo, dbo.vueAccountEmployeeTimeEntryForReport.DayNo, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 1 THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours ELSE 0 END AS BillableTotalHours,
                       CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable
                       IS NULL THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours ELSE 0 END AS NonBillableTotalHours, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCost / dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate
                       ELSE 0 END AS CurrencyEmployeeCost, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.Amount / dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate
                       ELSE 0 END AS CurrencyAmount, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCost / dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate
                       ELSE 0 END AS CurrencyEstimatedCost, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate / dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate
                       ELSE 0 END AS CurrencyBillingRate, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRate / dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate
                       ELSE 0 END AS CurrencyEmployeeRate, dbo.vueAccountEmployeeTimeEntryForReport.ProjectRole, dbo.vueAccountEmployeeTimeEntryForReport.ProjectType, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectDescription, dbo.vueAccountEmployeeTimeEntryForReport.TaskDescription, 
                      dbo.vueAccountEmployeeTimeEntryForReport.InvoiceNumber, dbo.vueAccountEmployeeTimeEntryForReport.InvoiceDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectTypeId, dbo.vueAccountEmployeeTimeEntryForReport.Billed, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientContactName, dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentName, dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentLocation, 
                      dbo.vueAccountEmployeeTimeEntryForReport.IsTimeOff, dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkTypeId, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 1 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate * dbo.vueAccountEmployeeTimeEntryForReport.TotalHours
                       ELSE 0 END AS BillableTotalAmount, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate * dbo.vueAccountEmployeeTimeEntryForReport.TotalHours
                       ELSE 0 END AS NonBillableTotalAmount, dbo.vueAccountEmployeeTimeEntryForReport.ProjectStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ParentTaskName
FROM         dbo.vueAccountEmployeeTimeEntryForReport INNER JOIN
                      dbo.vueAccountEmployeeTimeEntryWithLastStatus ON 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryWithLastStatus.AccountEmployeeTimeEntryId'
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'
IF NOT Exists(Select * From [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId]='075fb0f0-de57-46b9-9556-bf385720077c')
BEGIN
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('075fb0f0-de57-46b9-9556-bf385720077c', '3a080202-6842-4eca-8c79-a945978810b4', N'ParentTaskName', 250, 0, NULL, NULL, 67, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Parent Task Name', 0, 0)
END
GO
-- Create View vueAccountEmployeeHolidayTypesWithDetail
Print 'Create View vueAccountEmployeeHolidayTypesWithDetail'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeHolidayTypesWithDetail' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeHolidayTypesWithDetail
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.AccountHolidayTypeId, dbo.AccountHolidayType.AccountHolidayType, 
                      dbo.AccountEmployee.AccountId, dbo.AccountHolidayTypeDetail.HolidayName, dbo.AccountHolidayTypeDetail.HolidayDate
FROM         dbo.AccountEmployee INNER JOIN
                      dbo.AccountHolidayType ON dbo.AccountEmployee.AccountHolidayTypeId = dbo.AccountHolidayType.AccountHolidayTypeId INNER JOIN
                      dbo.AccountHolidayTypeDetail ON dbo.AccountHolidayType.AccountHolidayTypeId = dbo.AccountHolidayTypeDetail.AccountHolidayTypeId'


GO
If exists(Select * from SystemData where version = '3.6.9')
BEGIN
Update AccountWorkType set IsDisabled = 0
where systemworktypeid = 1
END

GO
Update SystemData Set Version = '3.7.3' Where Version = '3.6.9' And SystemDataId = 1

GO

-- Drop View vueAccountEmployeeTimeEntryWithTimeOffForReport
Print 'Drop View vueAccountEmployeeTimeEntryWithTimeOffForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithTimeOffForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryWithTimeOffForReport]

GO
-- Create View vueAccountEmployeeTimeEntryWithTimeOffForReport
Print 'Create View vueAccountEmployeeTimeEntryWithTimeOffForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithTimeOffForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport
AS
SELECT     dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountProject.ProjectName, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 1 THEN AccountProjectTask_1.TaskName ELSE dbo.AccountTimeOffType.AccountTimeOffType
                       END AS TaskName, dbo.AccountEmployeeTimeEntry.TotalTime, dbo.AccountEmployeeTimeEntry.Approved, dbo.AccountEmployee.AccountEmployeeId, 
                      dbo.AccountProject.AccountProjectId, dbo.AccountEmployeeTimeEntry.TeamLeadApproved, dbo.AccountEmployeeTimeEntry.ProjectManagerApproved, 
                      dbo.AccountEmployeeTimeEntry.AdministratorApproved, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, 
                      dbo.AccountEmployeeTimeEntry.StartTime, dbo.AccountEmployeeTimeEntry.EndTime, dbo.AccountEmployeeTimeEntry.TimeEntryDate, 
                      dbo.AccountEmployeeTimeEntry.Description, ISNULL(dbo.AccountProject.AccountId, dbo.AccountTimeOffType.AccountId) AS AccountId, DATEPART(hh, 
                      dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime) AS TotalMinutes, DATEPART(dw, 
                      dbo.AccountEmployeeTimeEntry.TimeEntryDate) AS WeekDay, dbo.AccountParty.AccountPartyId, dbo.AccountParty.PartyName, 
                      AccountProjectTask_1.AccountProjectTaskId, dbo.AccountBillingType.BillingType, dbo.AccountProject.LeaderEmployeeId, 
                      dbo.AccountProject.ProjectManagerEmployeeId, dbo.AccountProject.TimeSheetApprovalTypeId, dbo.AccountProject.ExpenseApprovalTypeId, 
                      AccountProjectTask_1.IsBillable, dbo.AccountEmployeeTimeEntry.Rejected, dbo.AccountEmployeeTimeEntry.BillingRate, 
                      dbo.AccountProject.ProjectBillingRateTypeId, dbo.AccountEmployee.EmployeeCode, dbo.AccountEmployee.AccountDepartmentId, 
                      dbo.AccountDepartment.DepartmentName, AccountProjectTask_1.EstimatedCost, AccountProjectTask_1.EstimatedTimeSpent, 
                      dbo.AccountEmployeeTimeEntry.Submitted, dbo.AccountWorkType.AccountWorkType, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountLocation.AccountLocation, dbo.AccountCostCenter.AccountCostCenter, dbo.AccountCostCenter.AccountCostCenterCode, 
                      dbo.AccountWorkType.AccountWorkTypeCode, dbo.AccountProject.ProjectCode, AccountProjectTask_1.TaskCode, 
                      dbo.AccountLocation.AccountLocationId, dbo.vueAccountEmployeeTimeEntryApprovalLastAction.Comments, 
                      dbo.AccountEmployeeTimeEntry.BillingRateCurrencyId, dbo.AccountEmployeeTimeEntry.EmployeeRateCurrencyId, 
                      dbo.AccountEmployeeTimeEntry.BillingRateExchangeRate, dbo.AccountEmployeeTimeEntry.EmployeeRateExchangeRate, 
                      dbo.AccountEmployeeTimeEntry.AccountBaseCurrencyId, AccountProjectTask_1.AccountTaskTypeId, AccountProjectTask_1.TaskStatusId, 
                      AccountProjectTask_1.AccountPriorityId, AccountProjectTask_1.AccountProjectMilestoneId, dbo.AccountDepartment.DepartmentCode, 
                      dbo.AccountParty.PartyNick, AccountProjectTask_1.EstimatedCurrencyId, dbo.vueAccountEmployeeTimeEntryApprovalLastAction.ApprovedOn, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRate, dbo.AccountRole.AccountRoleId, dbo.AccountRole.Role, dbo.AccountProject.AccountProjectTypeId, 
                      dbo.AccountProject.ProjectDescription, AccountProjectTask_1.TaskDescription, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeExpenseBillingTimesheetId, dbo.AccountEmployeeTimeEntry.Billed, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Submitted = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS SubmittedHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Approved = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS ApprovedHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Rejected = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS RejectedHours, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, 
                      dbo.AccountPartyContact.FirstName + N'' '' + dbo.AccountPartyContact.LastName AS ClientContactName, 
                      dbo.AccountPartyDepartment.PartyDepartmentCode AS ClientDepartmentCode, 
                      dbo.AccountPartyDepartment.PartyDepartmentName AS ClientDepartmentName, 
                      dbo.AccountPartyDepartment.PartyDepartmentLocation AS ClientDepartmentLocation, dbo.AccountEmployeeTimeEntry.IsTimeOff, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId, CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 0 THEN ROUND(CONVERT(float, 
                      DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) 
                      END AS TimeOffHours, CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 1 THEN ROUND(CONVERT(float, DATEPART(hh, 
                      dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS TimesheetHours, 
                      dbo.AccountWorkType.AccountWorkTypeId, dbo.AccountStatus.Status AS ProjectStatus, AccountProjectTask_1.ParentAccountProjectTaskId, 
                      dbo.AccountProjectTask.TaskName AS ParentTaskName
FROM         dbo.AccountProjectTask AS AccountProjectTask_1 LEFT OUTER JOIN
                      dbo.AccountProjectTask ON AccountProjectTask_1.ParentAccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId RIGHT OUTER JOIN
                      dbo.AccountEmployeeTimeEntry INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeEntry.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId ON 
                      AccountProjectTask_1.AccountProjectTaskId = dbo.AccountEmployeeTimeEntry.AccountProjectTaskId LEFT OUTER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountStatus ON dbo.AccountProject.ProjectStatusId = dbo.AccountStatus.AccountStatusId LEFT OUTER JOIN
                      dbo.AccountTimeOffType ON 
                      dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId LEFT OUTER JOIN
                      dbo.AccountPartyDepartment ON 
                      dbo.AccountProject.AccountPartyDepartmentId = dbo.AccountPartyDepartment.AccountPartyDepartmentId LEFT OUTER JOIN
                      dbo.AccountPartyContact ON dbo.AccountProject.AccountPartyContactId = dbo.AccountPartyContact.AccountPartyContactId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryPeriod ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId LEFT
                       OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId LEFT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryApprovalLastAction.AccountEmployeeTimeEntryId LEFT
                       OUTER JOIN
                      dbo.AccountCostCenter ON dbo.AccountEmployeeTimeEntry.AccountCostCenterId = dbo.AccountCostCenter.AccountCostCenterId LEFT OUTER JOIN
                      dbo.AccountWorkType ON dbo.AccountEmployeeTimeEntry.AccountWorkTypeId = dbo.AccountWorkType.AccountWorkTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId LEFT OUTER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId'


GO

-- Drop View vueAccountProjectsOnlyForReport
Print 'Drop View vueAccountProjectsOnlyForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountProjectsOnlyForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountProjectsOnlyForReport]

GO
-- Create View vueAccountProjectsOnlyForReport
Print 'Create View vueAccountProjectsOnlyForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountProjectsOnlyForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountProjectsOnlyForReport
AS
SELECT     dbo.AccountProject.AccountProjectId, dbo.AccountProject.AccountId, dbo.AccountProject.AccountProjectTypeId, dbo.AccountProject.AccountClientId, 
                      dbo.AccountProject.ProjectBillingTypeId, dbo.AccountProject.ProjectName, dbo.AccountProject.ProjectDescription, dbo.AccountProject.StartDate, 
                      dbo.AccountProject.AccountMilestoneId, dbo.AccountProject.Deadline, dbo.AccountProject.LeaderEmployeeId, dbo.AccountProject.ProjectManagerEmployeeId, 
                      dbo.AccountProject.EstimatedTime, dbo.AccountProject.EstimatedDurationUnit, dbo.AccountProject.ProjectCode, dbo.AccountProject.DefaultBillingRate, 
                      dbo.AccountProject.IsActive, dbo.AccountProject.ProjectStatusId, dbo.AccountProject.AccountPriorityId, dbo.AccountProject.CreatedOn, 
                      dbo.AccountProject.CreatedByEmployeeId, dbo.AccountProject.ModifiedOn, dbo.AccountProject.ModifiedByEmployeeId, dbo.AccountProject.ProjectBillingRateTypeId, 
                      dbo.AccountProject.TimeSheetApprovalTypeId, dbo.AccountProject.ExpenseApprovalTypeId, dbo.AccountProject.AccountPartyContactId AS AccountClientContactId, 
                      dbo.AccountProject.AccountPartyDepartmentId AS AccountClientDepartmentId, dbo.AccountProject.IsDisabled, dbo.AccountProject.IsTemplate, 
                      dbo.AccountProject.IsProject, dbo.AccountProject.AccountProjectTemplateId, dbo.AccountParty.PartyNick AS ClientNick, dbo.AccountParty.PartyName AS ClientName, 
                      dbo.AccountProjectType.ProjectType, dbo.AccountBillingType.BillingType, dbo.AccountStatus.Status, CONVERT(nvarchar(200), dbo.AccountProject.EstimatedDuration) 
                      AS EstimatedDuration, dbo.AccountPartyDepartment.PartyDepartmentCode AS ClientDepartmentCode, 
                      dbo.AccountPartyDepartment.PartyDepartmentName AS ClientDepartmentName, dbo.AccountPartyDepartment.PartyDepartmentLocation AS ClientDepartmentLocation, 
                      dbo.AccountPartyContact.FirstName + '' '' + dbo.AccountPartyContact.LastName AS ClientContactName, 
                      AccountApprovalType_1.ApprovalTypeName AS ExpenseApprovalTypeName, dbo.AccountApprovalType.ApprovalTypeName AS TimesheetApprovalTypeName, 
                      AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName AS TeamLead, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS ProjectManager, 
                      dbo.SystemProjectBillingRateType.SystemProjectBillingRateType AS ProjectBillingRateType
FROM         dbo.AccountPartyContact RIGHT OUTER JOIN
                      dbo.AccountProject INNER JOIN
                      dbo.Account ON dbo.AccountProject.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId AND dbo.Account.AccountId = dbo.AccountParty.AccountId INNER JOIN
                      dbo.AccountProjectType ON dbo.AccountProject.AccountProjectTypeId = dbo.AccountProjectType.AccountProjectTypeId AND 
                      dbo.Account.AccountId = dbo.AccountProjectType.AccountId INNER JOIN
                      dbo.AccountBillingType ON dbo.AccountProject.ProjectBillingTypeId = dbo.AccountBillingType.AccountBillingTypeId AND 
                      dbo.Account.AccountId = dbo.AccountBillingType.AccountId INNER JOIN
                      dbo.AccountStatus ON dbo.AccountProject.ProjectStatusId = dbo.AccountStatus.AccountStatusId AND 
                      dbo.Account.AccountId = dbo.AccountStatus.AccountId LEFT OUTER JOIN
                      dbo.SystemProjectBillingRateType ON 
                      dbo.AccountProject.ProjectBillingRateTypeId = dbo.SystemProjectBillingRateType.SystemProjectBillingRateTypeId LEFT OUTER JOIN
                      dbo.AccountEmployee ON dbo.AccountProject.ProjectManagerEmployeeId = dbo.AccountEmployee.AccountEmployeeId AND 
                      dbo.Account.AccountId = dbo.AccountEmployee.AccountId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON dbo.AccountProject.LeaderEmployeeId = AccountEmployee_1.AccountEmployeeId AND 
                      dbo.Account.AccountId = AccountEmployee_1.AccountId LEFT OUTER JOIN
                      dbo.AccountApprovalType ON dbo.AccountProject.TimeSheetApprovalTypeId = dbo.AccountApprovalType.AccountApprovalTypeId AND 
                      dbo.Account.AccountId = dbo.AccountApprovalType.AccountId LEFT OUTER JOIN
                      dbo.AccountApprovalType AS AccountApprovalType_1 ON dbo.AccountProject.ExpenseApprovalTypeId = AccountApprovalType_1.AccountApprovalTypeId AND 
                      dbo.Account.AccountId = AccountApprovalType_1.AccountId LEFT OUTER JOIN
                      dbo.AccountPartyDepartment ON dbo.AccountProject.AccountPartyDepartmentId = dbo.AccountPartyDepartment.AccountPartyDepartmentId ON 
                      dbo.AccountPartyContact.AccountPartyContactId = dbo.AccountProject.AccountPartyContactId
WHERE     (dbo.AccountProject.IsTemplate <> 1) AND (dbo.AccountProject.IsDeleted IS NULL OR
                      dbo.AccountProject.IsDeleted <> 1)'
GO
If exists(Select * from SystemData where version = '3.7.3')
BEGIN
UPDATE    AccountEmployee
SET              Prefix = 'Mr.'
WHERE     (Prefix = '') OR
                      (Prefix = 'False')
END
GO
Update SystemData Set Version = '3.7.5' Where Version = '3.7.3' And SystemDataId = 1

GO
-- Drop Procedure DeleteScript
Print 'Drop Procedure DeleteScript'
GO
IF EXISTS(SELECT * FROM sysobjects WHERE name = 'DeleteScript' AND type = 'P')
DROP PROCEDURE [dbo].[DeleteScript]

-- Create Procedure DeleteScript
Print 'Create Procedure DeleteScript'
GO

CREATE PROCEDURE [dbo].[DeleteScript] 
    (
@AccountId integer
            )
AS
	SET NOCOUNT ON

IF EXISTS (SELECT * FROM AccountAttachments WHERE AccountExpenseEntryId in (Select AccountExpenseEntryId from AccountExpenseEntry Where AccountId <> @AccountId))
BEGIN
delete from AccountAttachments Where AccountExpenseEntryId in (Select AccountExpenseEntryId from AccountExpenseEntry Where AccountId <> @AccountId)
END

IF EXISTS (SELECT * FROM AccountExpenseEntry WHERE AccountId = @AccountId)
BEGIN
delete from AccountExpenseEntry where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountTimeExpenseBillingExpense WHERE AccountId = @AccountId)
BEGIN
delete from AccountTimeExpenseBillingExpense where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountTimeExpenseBillingTimesheet WHERE AccountId = @AccountId)
BEGIN
delete from AccountTimeExpenseBillingTimesheet where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountTimeExpenseBilling WHERE AccountId = @AccountId)
BEGIN
delete from AccountTimeExpenseBilling where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM accountholidaytypedetail WHERE AccountId = @AccountId)
BEGIN
delete from accountholidaytypedetail where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM accountholidaytype WHERE AccountId = @AccountId)
BEGIN
delete from accountholidaytype where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountExpense WHERE AccountId = @AccountId)
BEGIN
delete from AccountExpense where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountExpenseTypeTaxCode WHERE AccountId = @AccountId)
BEGIN
delete From AccountExpenseTypeTaxCode where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountExpenseType WHERE AccountId = @AccountId)
BEGIN
delete from AccountExpenseType where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountTaxCode WHERE AccountId = @AccountId)
BEGIN
delete from AccountTaxCode where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountPaymentMethod WHERE AccountId = @AccountId)
BEGIN
delete from AccountPaymentMethod where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountPreferences WHERE AccountId = @AccountId)
BEGIN
delete from AccountPreferences where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountWorkTypeBillingRate WHERE AccountId = @AccountId)
BEGIN
delete from AccountWorkTypeBillingRate where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountParty WHERE AccountId = @AccountId)
BEGIN
delete from AccountParty where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountEmployeeTimeEntry Where AccountProjectId in (Select AccountProjectId from AccountProject Where AccountId <> @AccountId))
BEGIN
delete from AccountEmployeeTimeEntry 
Where AccountProjectId in (Select AccountProjectId from AccountProject Where AccountId <> @AccountId)
END


IF EXISTS (SELECT * FROM AccountEmployeeTimeEntry Where AccountProjectTaskId in (Select AccountProjectTaskId from AccountProjectTask Where AccountProjectId  in (Select AccountProjectId from AccountProject Where AccountId <> @AccountId)))
BEGIN
delete from AccountEmployeeTimeEntry 
Where AccountProjectTaskId in (Select AccountProjectTaskId from AccountProjectTask Where AccountProjectId  in (Select AccountProjectId from AccountProject Where AccountId <> @AccountId))
END


IF EXISTS (SELECT * FROM AccountProjectTask Where AccountProjectId in (Select AccountProjectId from AccountProject Where AccountId <> @AccountId))
BEGIN
Delete From AccountProjectTask 
Where AccountProjectId in (Select AccountProjectId from AccountProject Where AccountId <> @AccountId)
END



IF EXISTS (SELECT * FROM AccountProjectMilestone Where AccountProjectId in (Select AccountProjectId from AccountProject Where AccountId <> @AccountId))
BEGIN
delete from AccountProjectMilestone 
Where AccountProjectId in (Select AccountProjectId from AccountProject Where AccountId <> @AccountId)
END


IF EXISTS (SELECT * FROM accountemailnotificationpreference where accountprojectid not in (Select AccountProjectId from AccountProject where accountid = @AccountId))
BEGIN
delete from accountemailnotificationpreference 
where accountprojectid not in (Select AccountProjectId from AccountProject where accountid = @AccountId)
END


IF EXISTS (SELECT * FROM accountemailnotificationpreference where AccountEmployeeId not in (Select AccountEmployeeId from AccountEmployee where accountid = @AccountId))
BEGIN
delete from accountemailnotificationpreference
where AccountEmployeeId not in (Select AccountEmployeeId from AccountEmployee where accountid = @AccountId)
END

IF EXISTS (SELECT * FROM accountemailnotificationpreference where AccountId <> @AccountId)
BEGIN
delete from accountemailnotificationpreference where AccountId <> @AccountId
END

IF EXISTS (SELECT * FROM AccountEmployeeTimeEntry Where AccountEmployeeId in (Select AccountEmployeeId from AccountEmployee Where AccountId <> @AccountId))
BEGIN
delete from AccountEmployeeTimeEntry 
Where AccountEmployeeId in (Select AccountEmployeeId from AccountEmployee Where AccountId <> @AccountId)
END

IF EXISTS (SELECT * FROM AccountEmployeeTimeEntryApprovalProject Where TimeEntryAccountEmployeeId in (Select AccountEmployeeId from AccountEmployee Where AccountId <> @AccountId))
BEGIN
delete from AccountEmployeeTimeEntryApprovalProject 
Where TimeEntryAccountEmployeeId in (Select AccountEmployeeId from AccountEmployee Where AccountId <> @AccountId)
END

IF EXISTS (SELECT * FROM AccountEmployeeTimeEntryPeriod where AccountId <> @AccountId)
BEGIN
delete from AccountEmployeeTimeEntryPeriod
where AccountId <> @AccountId
END

IF EXISTS (SELECT * FROM AccountProjectRole Where AccountProjectId in (Select AccountProjectId from AccountProject Where AccountId <> @AccountId))
BEGIN
delete From AccountProjectRole
Where AccountProjectId in (Select AccountProjectId from AccountProject Where AccountId <> @AccountId)
END


IF EXISTS (SELECT * FROM AccountEmployeeTimeOffRequest where AccountEmployeeId in (Select AccountEmployeeId from AccountEmployee where accountid <> @AccountId))
BEGIN
delete from AccountEmployeeTimeOffRequest
where AccountEmployeeId in (Select AccountEmployeeId from AccountEmployee where accountid <> @AccountId)
END

IF EXISTS (SELECT * FROM AccountProject where accountid <> @AccountId)
BEGIN
delete from AccountProject where accountid <> @AccountId
END


IF EXISTS (SELECT * FROM EmailMessage where EmailTo in (Select EmailAddress from AccountEmployee Where AccountId <> @AccountId))
BEGIN
delete From EmailMessage where EmailTo in (Select EmailAddress from AccountEmployee Where AccountId <> @AccountId)
END

IF EXISTS (SELECT * FROM accountemployeeattendance where accountid <> @AccountId)
BEGIN
delete from accountemployeeattendance where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountEmployeeExpenseSheet where accountid <> @AccountId)
BEGIN
delete from AccountEmployeeExpenseSheet
where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountApprovalPath where accountid <> @AccountId)
BEGIN
delete from AccountApprovalPath
where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM accountemployee where accountid <> @AccountId)
BEGIN
delete from accountemployee where accountid  <> @AccountId
END

IF EXISTS (SELECT * FROM accountstatus where accountid <> @AccountId)
BEGIN
delete from accountstatus where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM accountworkingdaytype where accountid <> @AccountId)
BEGIN
delete from accountworkingdaytype where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM accounttimesheetperiodtype where accountid <> @AccountId)
BEGIN
delete from accounttimesheetperiodtype where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM accountcostcenter where accountid <> @AccountId)
BEGIN
delete from accountcostcenter where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM Account where accountid <> @AccountId)
BEGIN
delete from Account where accountid <> @AccountId
END


IF EXISTS (SELECT * FROM AccountPriority where accountid <> @AccountId)
BEGIN
delete From AccountPriority where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountWorkTypeBillingRate where accountid <> @AccountId)
BEGIN
delete from AccountWorkTypeBillingRate where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountBillingRate where accountid <> @AccountId)
BEGIN
delete From AccountBillingRate where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountCurrency where accountid <> @AccountId)
BEGIN
delete from AccountCurrency where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountCurrencyExchangeRate where accountid <> @AccountId)
BEGIN
delete from AccountCurrencyExchangeRate where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountTimeOffPolicy where accountid <> @AccountId)
BEGIN
delete from AccountTimeOffPolicy where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountTimeOffType where accountid <> @AccountId)
BEGIN
delete from AccountTimeOffType where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountTaxZone where accountid <> @AccountId)
BEGIN
delete From AccountTaxZone where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountCostCenter where accountid <> @AccountId)
BEGIN
delete From AccountCostCenter where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountWorkType where accountid <> @AccountId)
BEGIN
delete From AccountWorkType where accountid <> @AccountId
END

BEGIN
delete From LTCustomer 
delete From LTCustomerPayment
delete from EmailMessage
delete From Audit
END

GO
IF NOT EXISTS (SELECT * FROM [dbo].[SystemSecurityCategoryPage] WHERE [SystemSecurityCategoryPageId] = 151)
BEGIN
-- =======================================================
-- Foreign Key Constraint Nochecks's for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print ' Foreign Key Constraint Nochecks''s for Table: [dbo].[SystemSecurityCategoryPage]'

ALTER TABLE [dbo].[SystemSecurityCategoryPage] NOCHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory]
ALTER TABLE [dbo].[SystemSecurityCategoryPage] NOCHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory1]

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemSecurityCategoryPage]'

INSERT INTO [dbo].[SystemSecurityCategoryPage] ([SystemSecurityCategoryPageId], [SystemSecurityCategoryId], [SequenceNumber], [Folder], [SystemCategoryPage], [SystemCategoryPageDescription], [ParentSystemSecurityCateogoryPageId], [IsSiteMapPage], [IsCustomizeable], [IsAllowAdd], [IsAllowEdit], [IsAllowDelete], [IsAllowList], [IsShowDataOptions], [IsShowTillOptions], [IsSystemPage], [ControlLevelPermission], [NotShowInPermission], [NotShowInStartupPage], [SystemFeatureId]) VALUES (151, 1, N'2184012871', N'AccountAdmin', 'DatabaseBackup.aspx', 'Database Backup', 15, 1, 1, NULL, NULL, NULL, 1, NULL, NULL, NULL, NULL, NULL, NULL, NULL)

-- =======================================================
-- Foreign Key Constraint Check's for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print ' Foreign Key Constraint Check''s for Table: [dbo].[SystemSecurityCategoryPage]'


ALTER TABLE [dbo].[SystemSecurityCategoryPage] CHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory]
ALTER TABLE [dbo].[SystemSecurityCategoryPage] CHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory1]

END

GO

-- Drop View rptvueAccountEmployees
Print 'Drop View rptvueAccountEmployees'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployees' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountEmployees]

GO
-- Drop View vueAccountEmployeesForReport
Print 'Drop View vueAccountEmployeesForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeesForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeesForReport]

GO
-- Create View vueAccountEmployeesForReport
Print 'Create View vueAccountEmployeesForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeesForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeesForReport
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.Password, dbo.AccountEmployee.Prefix, dbo.AccountEmployee.FirstName, 
                      dbo.AccountEmployee.LastName, ISNULL(dbo.AccountEmployee.MiddleName, N'''') AS MiddleName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountEmployee.AccountId, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountRoleId, dbo.AccountEmployee.AccountLocationId, 
                      ISNULL(dbo.AccountEmployee.Notes, N'''') AS Notes, ISNULL(dbo.AccountEmployee.AddressLine1, N'''') AS AddressLine1, ISNULL(dbo.AccountEmployee.AddressLine2, 
                      N'''') AS AddressLine2, ISNULL(dbo.AccountEmployee.State, N'''') AS State, ISNULL(dbo.AccountEmployee.City, N'''') AS City, ISNULL(dbo.AccountEmployee.Zip, N'''') 
                      AS Zip, dbo.AccountEmployee.CountryId, ISNULL(dbo.AccountEmployee.HomePhoneNo, N'''') AS HomePhoneNo, ISNULL(dbo.AccountEmployee.WorkPhoneNo, N'''') 
                      AS WorkPhoneNo, ISNULL(dbo.AccountEmployee.MobilePhoneNo, N'''') AS MobilePhoneNo, dbo.AccountEmployee.TimeEntryApprovalPathId, 
                      dbo.AccountEmployee.BillingRateStateDate, dbo.AccountEmployee.BillingTypeId, dbo.AccountEmployee.StartDate, dbo.AccountEmployee.TerminationDate, 
                      dbo.AccountEmployee.StatusId, dbo.AccountEmployee.IsDeleted, dbo.AccountEmployee.IsDisabled, dbo.AccountEmployee.DefaultProjectId, 
                      dbo.AccountEmployee.TimeZoneId, dbo.AccountEmployee.DefaultEmployee, dbo.AccountEmployee.CreatedOn, dbo.AccountEmployee.CreatedByEmployeeId, 
                      dbo.AccountEmployee.ModifiedOn, dbo.AccountEmployee.ModifiedByEmployeeId, dbo.AccountEmployee.AllowedAccessFromIP, 
                      dbo.AccountEmployee.ExternalUserClientId, dbo.AccountEmployee.EmployeeTypeId, dbo.AccountEmployee.AccountBillingRateId, dbo.AccountEmployee.Username, 
                      ISNULL(dbo.AccountEmployee.EmployeeCode, N'''') AS EmployeeCode, dbo.AccountEmployee.EmployeeManagerId, 
                      dbo.AccountEmployee.FirstName + N'' '' + dbo.AccountEmployee.LastName AS EmployeeName, ISNULL(dbo.AccountDepartment.DepartmentCode, N'''') 
                      AS DepartmentCode, dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountLocation.AccountLocation, ISNULL(dbo.SystemCountry.Country, N'''') 
                      AS Country, ISNULL(AccountEmployee_1.FirstName + N'' '' + AccountEmployee_1.LastName, N'''') AS EmployeeManager, 
                      ISNULL(dbo.vueAccountWorkTypeBillingRate.AccountWorkTypeCode, N'''') AS AccountWorkTypeCode, ISNULL(dbo.vueAccountWorkTypeBillingRate.AccountWorkType, 
                      N'''') AS AccountWorkType, ISNULL(dbo.vueAccountWorkTypeBillingRate.BillingRate, 0) AS BillingRate, ISNULL(dbo.vueAccountWorkTypeBillingRate.EmployeeRate, 0) 
                      AS EmployeeRate, dbo.vueAccountWorkTypeBillingRate.EmployeeRateCurrencyCode, dbo.vueAccountWorkTypeBillingRate.BillingRateCurrencyCode, 
                      dbo.AccountEmployee.HiredDate, ISNULL(dbo.AccountStatus.Status, N'''') AS EmployeeStatus, ISNULL(dbo.AccountEmployeeType.AccountEmployeeType, N'''') 
                      AS EmployeeType
FROM         dbo.AccountEmployee INNER JOIN
                      dbo.Account ON dbo.AccountEmployee.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId AND 
                      dbo.Account.AccountId = dbo.AccountDepartment.AccountId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId AND dbo.Account.AccountId = dbo.AccountRole.AccountId INNER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId AND 
                      dbo.Account.AccountId = dbo.AccountLocation.AccountId INNER JOIN
                      dbo.SystemCountry ON dbo.AccountEmployee.CountryId = dbo.SystemCountry.CountryId LEFT OUTER JOIN
                      dbo.AccountEmployeeType ON dbo.AccountEmployee.EmployeePayTypeId = dbo.AccountEmployeeType.AccountEmployeeTypeId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON dbo.Account.AccountId = AccountEmployee_1.AccountId AND 
                      dbo.AccountEmployee.EmployeeManagerId = AccountEmployee_1.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountStatus ON dbo.AccountEmployee.StatusId = dbo.AccountStatus.AccountStatusId AND 
                      dbo.Account.AccountId = dbo.AccountStatus.AccountId LEFT OUTER JOIN
                      dbo.vueAccountWorkTypeBillingRate ON dbo.Account.AccountId = dbo.vueAccountWorkTypeBillingRate.AccountId AND 
                      dbo.AccountEmployee.AccountEmployeeId = dbo.vueAccountWorkTypeBillingRate.AccountEmployeeId
WHERE     (dbo.AccountEmployee.EmployeeTypeId IS NULL)'

GO
-- Create View rptvueAccountEmployees
Print 'Create View rptvueAccountEmployees'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployees' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountEmployees
AS
SELECT     AccountEmployeeId, Password, Prefix, FirstName, LastName, MiddleName, EMailAddress, AccountId, AccountDepartmentId, AccountRoleId, AccountLocationId, Notes, 
                      AddressLine1, AddressLine2, State, City, Zip, CountryId, HomePhoneNo, WorkPhoneNo, MobilePhoneNo, TimeEntryApprovalPathId, BillingRateStateDate, 
                      BillingTypeId, StartDate, TerminationDate, StatusId, IsDeleted, IsDisabled, DefaultProjectId, TimeZoneId, DefaultEmployee, CreatedOn, CreatedByEmployeeId, 
                      ModifiedOn, ModifiedByEmployeeId, AllowedAccessFromIP, ExternalUserClientId, EmployeeTypeId, AccountBillingRateId, Username, EmployeeCode, 
                      EmployeeManagerId, EmployeeName, DepartmentCode, DepartmentName, Role, AccountLocation, Country, ISNULL(EmployeeManager, '''') AS EmployeeManager, 
                      AccountWorkTypeCode, AccountWorkType, BillingRate, EmployeeRate, EmployeeRateCurrencyCode, BillingRateCurrencyCode, HiredDate, EmployeeStatus, 
                      EmployeeType
FROM         dbo.vueAccountEmployeesForReport
WHERE     (IsDeleted <> 1)'

GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'
if not exists(Select * from [dbo].[SystemReportDataSourceField] where [SystemReportDataSourceFieldId] = '78e13baa-2232-41f7-b122-0c60ef256e1e')
BEGIN
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('78e13baa-2232-41f7-b122-0c60ef256e1e', '14428dea-801b-4f8e-b2e3-afa8cb644ac8', N'EmployeeType', 125, 0, NULL, NULL, 92, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Employee Type', 0, 0)
END

GO
-- Drop Procedure DeleteScript
Print 'Drop Procedure DeleteScript'
GO
IF EXISTS(SELECT * FROM sysobjects WHERE name = 'DeleteScript' AND type = 'P')
DROP PROCEDURE [dbo].[DeleteScript]

GO
-- Create Procedure DeleteScript
Print 'Create Procedure DeleteScript'
GO
CREATE PROCEDURE [dbo].[DeleteScript] 
    (
@AccountId integer
            )
AS
	SET NOCOUNT ON

IF EXISTS (SELECT * FROM AccountAttachments WHERE AccountExpenseEntryId in (Select AccountExpenseEntryId from AccountExpenseEntry Where AccountId <> @AccountId))
BEGIN
delete from AccountAttachments Where AccountExpenseEntryId in (Select AccountExpenseEntryId from AccountExpenseEntry Where AccountId <> @AccountId)
END

IF EXISTS (SELECT * FROM AccountExpenseEntry WHERE AccountId = @AccountId)
BEGIN
delete from AccountExpenseEntry where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountTimeExpenseBillingExpense WHERE AccountId = @AccountId)
BEGIN
delete from AccountTimeExpenseBillingExpense where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountTimeExpenseBillingTimesheet WHERE AccountId = @AccountId)
BEGIN
delete from AccountTimeExpenseBillingTimesheet where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountTimeExpenseBilling WHERE AccountId = @AccountId)
BEGIN
delete from AccountTimeExpenseBilling where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM accountholidaytypedetail WHERE AccountId = @AccountId)
BEGIN
delete from accountholidaytypedetail where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM accountholidaytype WHERE AccountId = @AccountId)
BEGIN
delete from accountholidaytype where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountExpense WHERE AccountId = @AccountId)
BEGIN
delete from AccountExpense where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountExpenseTypeTaxCode WHERE AccountId = @AccountId)
BEGIN
delete From AccountExpenseTypeTaxCode where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountExpenseType WHERE AccountId = @AccountId)
BEGIN
delete from AccountExpenseType where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountTaxCode WHERE AccountId = @AccountId)
BEGIN
delete from AccountTaxCode where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountPaymentMethod WHERE AccountId = @AccountId)
BEGIN
delete from AccountPaymentMethod where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountPreferences WHERE AccountId = @AccountId)
BEGIN
delete from AccountPreferences where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountWorkTypeBillingRate WHERE AccountId = @AccountId)
BEGIN
delete from AccountWorkTypeBillingRate where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountEmployeeTimeEntry Where AccountProjectId in (Select AccountProjectId from AccountProject Where AccountId <> @AccountId))
BEGIN
delete from AccountEmployeeTimeEntry 
Where AccountProjectId in (Select AccountProjectId from AccountProject Where AccountId <> @AccountId)
END


IF EXISTS (SELECT * FROM AccountEmployeeTimeEntry Where AccountProjectTaskId in (Select AccountProjectTaskId from AccountProjectTask Where AccountProjectId  in (Select AccountProjectId from AccountProject Where AccountId <> @AccountId)))
BEGIN
delete from AccountEmployeeTimeEntry 
Where AccountProjectTaskId in (Select AccountProjectTaskId from AccountProjectTask Where AccountProjectId  in (Select AccountProjectId from AccountProject Where AccountId <> @AccountId))
END


IF EXISTS (SELECT * FROM AccountProjectTask Where AccountProjectId in (Select AccountProjectId from AccountProject Where AccountId <> @AccountId))
BEGIN
Delete From AccountProjectTask 
Where AccountProjectId in (Select AccountProjectId from AccountProject Where AccountId <> @AccountId)
END



IF EXISTS (SELECT * FROM AccountProjectMilestone Where AccountProjectId in (Select AccountProjectId from AccountProject Where AccountId <> @AccountId))
BEGIN
delete from AccountProjectMilestone 
Where AccountProjectId in (Select AccountProjectId from AccountProject Where AccountId <> @AccountId)
END


IF EXISTS (SELECT * FROM accountemailnotificationpreference where accountprojectid not in (Select AccountProjectId from AccountProject where accountid = @AccountId))
BEGIN
delete from accountemailnotificationpreference 
where accountprojectid not in (Select AccountProjectId from AccountProject where accountid = @AccountId)
END


IF EXISTS (SELECT * FROM accountemailnotificationpreference where AccountEmployeeId not in (Select AccountEmployeeId from AccountEmployee where accountid = @AccountId))
BEGIN
delete from accountemailnotificationpreference
where AccountEmployeeId not in (Select AccountEmployeeId from AccountEmployee where accountid = @AccountId)
END

IF EXISTS (SELECT * FROM accountemailnotificationpreference where AccountId <> @AccountId)
BEGIN
delete from accountemailnotificationpreference where AccountId <> @AccountId
END

IF EXISTS (SELECT * FROM AccountEmployeeTimeEntry Where AccountEmployeeId in (Select AccountEmployeeId from AccountEmployee Where AccountId <> @AccountId))
BEGIN
delete from AccountEmployeeTimeEntry 
Where AccountEmployeeId in (Select AccountEmployeeId from AccountEmployee Where AccountId <> @AccountId)
END

IF EXISTS (SELECT * FROM AccountEmployeeTimeEntryApprovalProject Where TimeEntryAccountEmployeeId in (Select AccountEmployeeId from AccountEmployee Where AccountId <> @AccountId))
BEGIN
delete from AccountEmployeeTimeEntryApprovalProject 
Where TimeEntryAccountEmployeeId in (Select AccountEmployeeId from AccountEmployee Where AccountId <> @AccountId)
END

IF EXISTS (SELECT * FROM AccountEmployeeTimeEntryPeriod where AccountId <> @AccountId)
BEGIN
delete from AccountEmployeeTimeEntryPeriod
where AccountId <> @AccountId
END

IF EXISTS (SELECT * FROM AccountProjectRole Where AccountProjectId in (Select AccountProjectId from AccountProject Where AccountId <> @AccountId))
BEGIN
delete From AccountProjectRole
Where AccountProjectId in (Select AccountProjectId from AccountProject Where AccountId <> @AccountId)
END


IF EXISTS (SELECT * FROM AccountEmployeeTimeOffRequest where AccountEmployeeId in (Select AccountEmployeeId from AccountEmployee where accountid <> @AccountId))
BEGIN
delete from AccountEmployeeTimeOffRequest
where AccountEmployeeId in (Select AccountEmployeeId from AccountEmployee where accountid <> @AccountId)
END

IF EXISTS (SELECT * FROM AccountProject where accountid <> @AccountId)
BEGIN
delete from AccountProject where accountid <> @AccountId
END


IF EXISTS (SELECT * FROM EmailMessage where EmailTo in (Select EmailAddress from AccountEmployee Where AccountId <> @AccountId))
BEGIN
delete From EmailMessage where EmailTo in (Select EmailAddress from AccountEmployee Where AccountId <> @AccountId)
END

IF EXISTS (SELECT * FROM accountemployeeattendance where accountid <> @AccountId)
BEGIN
delete from accountemployeeattendance where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountEmployeeExpenseSheet where accountid <> @AccountId)
BEGIN
delete from AccountEmployeeExpenseSheet
where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountApprovalPath where accountid <> @AccountId)
BEGIN
delete from AccountApprovalPath
where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM accountemployee where accountid <> @AccountId)
BEGIN
delete from accountemployee where accountid  <> @AccountId
END

IF EXISTS (SELECT * FROM AccountParty WHERE AccountId = @AccountId)
BEGIN
delete from AccountParty where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM accountstatus where accountid <> @AccountId)
BEGIN
delete from accountstatus where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM accountworkingdaytype where accountid <> @AccountId)
BEGIN
delete from accountworkingdaytype where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM accounttimesheetperiodtype where accountid <> @AccountId)
BEGIN
delete from accounttimesheetperiodtype where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM accountcostcenter where accountid <> @AccountId)
BEGIN
delete from accountcostcenter where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM Account where accountid <> @AccountId)
BEGIN
delete from Account where accountid <> @AccountId
END


IF EXISTS (SELECT * FROM AccountPriority where accountid <> @AccountId)
BEGIN
delete From AccountPriority where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountWorkTypeBillingRate where accountid <> @AccountId)
BEGIN
delete from AccountWorkTypeBillingRate where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountBillingRate where accountid <> @AccountId)
BEGIN
delete From AccountBillingRate where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountCurrency where accountid <> @AccountId)
BEGIN
delete from AccountCurrency where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountCurrencyExchangeRate where accountid <> @AccountId)
BEGIN
delete from AccountCurrencyExchangeRate where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountTimeOffPolicy where accountid <> @AccountId)
BEGIN
delete from AccountTimeOffPolicy where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountTimeOffType where accountid <> @AccountId)
BEGIN
delete from AccountTimeOffType where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountTaxZone where accountid <> @AccountId)
BEGIN
delete From AccountTaxZone where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountCostCenter where accountid <> @AccountId)
BEGIN
delete From AccountCostCenter where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM AccountWorkType where accountid <> @AccountId)
BEGIN
delete From AccountWorkType where accountid <> @AccountId
END

BEGIN
delete From LTCustomer 
delete From LTCustomerPayment
delete from EmailMessage
delete From Audit
END

GO
-- Drop View rptvueAccountEmployeeTimeEntry
Print 'Drop View rptvueAccountEmployeeTimeEntry'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeEntry' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountEmployeeTimeEntry]

GO
-- Drop View vueAccountEmployeeTimeEntryForReport
Print 'Drop View vueAccountEmployeeTimeEntryForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryForReport]

GO
-- Drop View vueAccountEmployeeTimeEntryWithTimeOffForReport
Print 'Drop View vueAccountEmployeeTimeEntryWithTimeOffForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithTimeOffForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryWithTimeOffForReport]

GO
-- Drop View vueAccountEmployeeExpenseSheet
Print 'Drop View vueAccountEmployeeExpenseSheet'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeExpenseSheet' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeExpenseSheet]

GO
-- Drop View vueAccountExpenseEntry
Print 'Drop View vueAccountExpenseEntry'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntry' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountExpenseEntry]

GO
-- Create View vueAccountExpenseEntry
Print 'Create View vueAccountExpenseEntry'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntry' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountExpenseEntry
AS
SELECT     CASE WHEN dbo.AccountEmployee.IsDisabled = 1 THEN dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE dbo.AccountEmployee.FirstName
                       + '' '' + dbo.AccountEmployee.LastName END AS EmployeeName, dbo.AccountExpense.AccountExpenseName, dbo.AccountProject.ProjectName, dbo.AccountExpenseEntry.AccountExpenseEntryId, 
                      dbo.AccountExpenseEntry.AccountExpenseEntryDate, dbo.AccountExpenseEntry.AccountId, dbo.AccountExpenseEntry.AccountEmployeeId, 
                      dbo.AccountExpenseEntry.AccountProjectId, dbo.AccountExpenseEntry.AccountExpenseId, dbo.AccountExpenseEntry.Amount, 
                      dbo.AccountExpenseEntry.TeamLeadApproved, dbo.AccountExpenseEntry.ProjectManagerApproved, dbo.AccountExpenseEntry.AdministratorApproved, 
                      dbo.AccountExpenseEntry.Approved, dbo.AccountExpenseEntry.CreatedOn, dbo.AccountExpenseEntry.CreatedByEmployeeId, dbo.AccountExpenseEntry.ModifiedOn, 
                      dbo.AccountExpenseEntry.ModifiedByEmployeeId, dbo.AccountParty.PartyName, dbo.AccountProject.AccountClientId, dbo.AccountExpenseEntry.Description, 
                      dbo.AccountExpenseType.ExpenseType, dbo.AccountExpense.AccountExpenseTypeId, dbo.AccountProject.LeaderEmployeeId, dbo.AccountExpenseEntry.IsBillable, 
                      dbo.AccountExpenseEntry.Rejected, dbo.AccountEmployee.EmployeeCode, dbo.AccountExpenseEntry.Reimburse, dbo.AccountExpenseEntry.AccountCurrencyId, 
                      dbo.SystemCurrency.CurrencyCode, dbo.AccountExpenseType.IsQuantityField, dbo.AccountExpenseType.QuantityFieldCaption, 
                      dbo.AccountExpenseEntry.AccountBaseCurrencyId, dbo.AccountExpenseEntry.ExchangeRate, ISNULL(dbo.AccountExpenseEntry.TaxAmount, 0) AS TaxAmount, 
                      ISNULL(dbo.AccountExpenseEntry.AmountBeforeTax, 0) AS NetAmount, dbo.AccountExpenseEntry.Submitted, dbo.AccountProject.TimeSheetApprovalTypeId, 
                      dbo.AccountProject.ExpenseApprovalTypeId, dbo.AccountProject.ProjectManagerEmployeeId, dbo.AccountExpenseEntry.TimeSheetApprovalPathId, 
                      dbo.AccountEmployee.EMailAddress, dbo.AccountDepartment.DepartmentName, dbo.AccountLocation.AccountLocation, dbo.AccountTaxZone.AccountTaxZone, 
                      dbo.AccountExpenseEntry.Quantity, dbo.AccountExpenseEntry.Rate, dbo.AccountPaymentMethod.PaymentMethod, dbo.AccountLocation.AccountLocationId, 
                      dbo.AccountParty.PartyNick, dbo.AccountProject.ProjectDescription, dbo.AccountProject.ProjectCode, dbo.AccountDepartment.DepartmentCode, 
                      dbo.vueAccountExpenseEntryApprovalLastAction.Comments, dbo.vueAccountExpenseEntryApprovalLastAction.ApprovedOn, 
                      dbo.AccountDepartment.AccountDepartmentId, dbo.AccountRole.Role, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountExpenseEntry.AccountTimeExpenseBillingExpenseId, dbo.AccountExpenseEntry.Billed, dbo.AccountTimeExpenseBilling.InvoiceNumber, 
                      dbo.AccountTimeExpenseBilling.InvoiceDate, dbo.AccountProjectType.AccountProjectTypeId, dbo.AccountProjectType.ProjectType, 
                      dbo.AccountExpenseEntry.AccountEmployeeExpenseSheetId, dbo.AccountEmployeeExpenseSheet.Description AS ExpenseSheetDescription, 
                      dbo.AccountEmployeeExpenseSheet.ExpenseSheetDate, dbo.AccountEmployeeExpenseSheet.SubmittedDate, 
                      dbo.AccountEmployeeExpenseSheet.Approved AS SheetApproved, dbo.AccountEmployeeExpenseSheet.Rejected AS SheetRejected, 
                      dbo.AccountEmployeeExpenseSheet.Submitted AS SheetSubmitted, dbo.AccountEmployeeExpenseSheet.InApproval AS SheetInApproval, 
                      dbo.AccountTaxCode.TaxCode, dbo.AccountTaxCode.Formula, dbo.AccountTaxCode.AccountTaxCodeId
FROM         dbo.AccountDepartment RIGHT OUTER JOIN
                      dbo.AccountParty RIGHT OUTER JOIN
                      dbo.AccountProject LEFT OUTER JOIN
                      dbo.AccountProjectType ON dbo.AccountProject.AccountProjectTypeId = dbo.AccountProjectType.AccountProjectTypeId ON 
                      dbo.AccountParty.AccountPartyId = dbo.AccountProject.AccountClientId RIGHT OUTER JOIN
                      dbo.SystemCurrency RIGHT OUTER JOIN
                      dbo.AccountCurrency RIGHT OUTER JOIN
                      dbo.AccountPaymentMethod RIGHT OUTER JOIN
                      dbo.vueAccountExpenseEntryApprovalLastAction RIGHT OUTER JOIN
                      dbo.AccountEmployee RIGHT OUTER JOIN
                      dbo.AccountTaxZone RIGHT OUTER JOIN
                      dbo.AccountTaxCode RIGHT OUTER JOIN
                      dbo.AccountExpenseType INNER JOIN
                      dbo.AccountExpenseEntry INNER JOIN
                      dbo.AccountExpense ON dbo.AccountExpenseEntry.AccountExpenseId = dbo.AccountExpense.AccountExpenseId ON 
                      dbo.AccountExpenseType.AccountExpenseTypeId = dbo.AccountExpense.AccountExpenseTypeId LEFT OUTER JOIN
                      dbo.AccountExpenseTypeTaxCode ON dbo.AccountExpenseEntry.AccountTaxZoneId = dbo.AccountExpenseTypeTaxCode.AccountTaxZoneId AND 
                      dbo.AccountExpenseType.AccountExpenseTypeId = dbo.AccountExpenseTypeTaxCode.AccountExpenseTypeId ON 
                      dbo.AccountTaxCode.AccountTaxCodeId = dbo.AccountExpenseTypeTaxCode.AccountTaxCodeId ON 
                      dbo.AccountTaxZone.AccountTaxZoneId = dbo.AccountExpenseEntry.AccountTaxZoneId LEFT OUTER JOIN
                      dbo.AccountEmployeeExpenseSheet ON 
                      dbo.AccountExpenseEntry.AccountEmployeeExpenseSheetId = dbo.AccountEmployeeExpenseSheet.AccountEmployeeExpenseSheetId ON 
                      dbo.AccountEmployee.AccountEmployeeId = dbo.AccountExpenseEntry.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountTimeExpenseBillingExpense INNER JOIN
                      dbo.AccountTimeExpenseBilling ON 
                      dbo.AccountTimeExpenseBillingExpense.AccountTimeExpenseBillingId = dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId ON 
                      dbo.AccountExpenseEntry.AccountTimeExpenseBillingExpenseId = dbo.AccountTimeExpenseBillingExpense.AccountTimeExpenseBillingExpenseId ON 
                      dbo.vueAccountExpenseEntryApprovalLastAction.AccountExpenseEntryId = dbo.AccountExpenseEntry.AccountExpenseEntryId ON 
                      dbo.AccountPaymentMethod.AccountPaymentMethodId = dbo.AccountExpenseEntry.AccountPaymentMethodId ON 
                      dbo.AccountCurrency.AccountCurrencyId = dbo.AccountExpenseEntry.AccountCurrencyId ON 
                      dbo.SystemCurrency.CurrencyId = dbo.AccountCurrency.SystemCurrencyId ON 
                      dbo.AccountProject.AccountProjectId = dbo.AccountExpenseEntry.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId ON 
                      dbo.AccountDepartment.AccountDepartmentId = dbo.AccountEmployee.AccountDepartmentId'

GO
-- Create View vueAccountEmployeeExpenseSheet
Print 'Create View vueAccountEmployeeExpenseSheet'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeExpenseSheet' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeExpenseSheet
AS
SELECT     dbo.AccountEmployeeExpenseSheet.AccountEmployeeExpenseSheetId, dbo.AccountEmployeeExpenseSheet.AccountId, 
                      dbo.AccountEmployeeExpenseSheet.AccountEmployeeId, dbo.AccountEmployeeExpenseSheet.Description, dbo.AccountEmployeeExpenseSheet.ExpenseSheetDate, 
                      MAX(dbo.vueAccountCurrency.Currency) AS Currency, MAX(dbo.vueAccountCurrency.CurrencyCode) AS CurrencyCode, 
                      MAX(dbo.vueAccountCurrency.AccountCurrencyId) AS AccountCurrencyId, CASE WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 0 AND dbo.AccountEmployeeExpenseSheet.Rejected = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.InApproval = 0 THEN ''Not Submitted'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Rejected = 0 THEN ''Approved'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.Rejected = 1 THEN ''Rejected'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 0 AND dbo.AccountEmployeeExpenseSheet.Rejected = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.InApproval = 1 THEN ''Submitted'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 0 AND dbo.AccountEmployeeExpenseSheet.Rejected = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.InApproval = 0 THEN ''Submitted'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 1 THEN ''Not Submitted'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.InApproval = 1 THEN ''Not Submitted'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 1 AND dbo.AccountEmployeeExpenseSheet.Rejected = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.InApproval = 1 THEN ''Approved'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Rejected = 1 THEN ''Submitted'' END AS Status, dbo.AccountEmployeeExpenseSheet.InApproval, 
                      dbo.AccountEmployeeExpenseSheet.Submitted, dbo.AccountEmployeeExpenseSheet.Rejected, dbo.AccountEmployeeExpenseSheet.Approved, 
                      dbo.AccountEmployeeExpenseSheet.SubmittedDate, 
                      CASE WHEN dbo.AccountEmployee.IsDisabled = 1 THEN dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE dbo.AccountEmployee.FirstName
                       + '' '' + dbo.AccountEmployee.LastName END AS EmployeeName, dbo.AccountEmployee.EMailAddress, MAX(dbo.vueAccountCurrency.ExchangeRate) 
                      AS ExchangeRate, dbo.AccountEmployeeExpenseSheet.ApprovedOn, dbo.AccountEmployeeExpenseSheet.ApprovedByEmployeeId, 
                      dbo.AccountEmployeeExpenseSheet.RejectedOn, dbo.AccountEmployeeExpenseSheet.RejectedByEmployeeId, 
                      SUM(ISNULL(dbo.vueAccountEmployeeExpenseSheetOnlyAmount.Amount * dbo.vueAccountCurrency.ExchangeRate, 0)) AS Amount
FROM         dbo.AccountExpenseEntry INNER JOIN
                      dbo.vueAccountEmployeeExpenseSheetOnlyAmount ON 
                      dbo.AccountExpenseEntry.AccountEmployeeExpenseSheetId = dbo.vueAccountEmployeeExpenseSheetOnlyAmount.AccountEmployeeExpenseSheetId AND 
                      dbo.AccountExpenseEntry.AccountExpenseEntryId = dbo.vueAccountEmployeeExpenseSheetOnlyAmount.AccountExpenseEntryId RIGHT OUTER JOIN
                      dbo.AccountEmployeeExpenseSheet INNER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployeeExpenseSheet.AccountId = dbo.AccountPreferences.AccountId INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeExpenseSheet.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId ON 
                      dbo.AccountExpenseEntry.AccountEmployeeExpenseSheetId = dbo.AccountEmployeeExpenseSheet.AccountEmployeeExpenseSheetId LEFT OUTER JOIN
                      dbo.vueAccountCurrency ON dbo.AccountPreferences.AccountBaseCurrencyId = dbo.vueAccountCurrency.AccountCurrencyId
GROUP BY dbo.AccountEmployeeExpenseSheet.AccountEmployeeExpenseSheetId, dbo.AccountEmployeeExpenseSheet.AccountId, 
                      dbo.AccountEmployeeExpenseSheet.AccountEmployeeId, dbo.AccountEmployeeExpenseSheet.Description, dbo.AccountEmployeeExpenseSheet.ExpenseSheetDate, 
                      dbo.AccountEmployeeExpenseSheet.InApproval, dbo.AccountEmployeeExpenseSheet.Submitted, dbo.AccountEmployeeExpenseSheet.Rejected, 
                      dbo.AccountEmployeeExpenseSheet.Approved, dbo.AccountEmployeeExpenseSheet.SubmittedDate, dbo.AccountEmployee.FirstName, 
                      dbo.AccountEmployee.LastName, dbo.AccountEmployee.EMailAddress, dbo.AccountEmployeeExpenseSheet.ApprovedOn, 
                      dbo.AccountEmployeeExpenseSheet.ApprovedByEmployeeId, dbo.AccountEmployeeExpenseSheet.RejectedOn, 
                      dbo.AccountEmployeeExpenseSheet.RejectedByEmployeeId, dbo.AccountEmployee.IsDisabled'

GO
-- Create View vueAccountEmployeeTimeEntryWithTimeOffForReport
Print 'Create View vueAccountEmployeeTimeEntryWithTimeOffForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithTimeOffForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport
AS
SELECT     CASE WHEN dbo.AccountEmployee.IsDisabled = 1 THEN dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE dbo.AccountEmployee.FirstName
                       + '' '' + dbo.AccountEmployee.LastName END AS EmployeeName, dbo.AccountProject.ProjectName, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 1 THEN AccountProjectTask_1.TaskName ELSE dbo.AccountTimeOffType.AccountTimeOffType END AS TaskName,
                       dbo.AccountEmployeeTimeEntry.TotalTime, dbo.AccountEmployeeTimeEntry.Approved, dbo.AccountEmployee.AccountEmployeeId, 
                      dbo.AccountProject.AccountProjectId, dbo.AccountEmployeeTimeEntry.TeamLeadApproved, dbo.AccountEmployeeTimeEntry.ProjectManagerApproved, 
                      dbo.AccountEmployeeTimeEntry.AdministratorApproved, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, dbo.AccountEmployeeTimeEntry.StartTime, 
                      dbo.AccountEmployeeTimeEntry.EndTime, dbo.AccountEmployeeTimeEntry.TimeEntryDate, dbo.AccountEmployeeTimeEntry.Description, 
                      ISNULL(dbo.AccountProject.AccountId, dbo.AccountTimeOffType.AccountId) AS AccountId, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime) AS TotalMinutes, DATEPART(dw, dbo.AccountEmployeeTimeEntry.TimeEntryDate) AS WeekDay, 
                      dbo.AccountParty.AccountPartyId, dbo.AccountParty.PartyName, AccountProjectTask_1.AccountProjectTaskId, dbo.AccountBillingType.BillingType, 
                      dbo.AccountProject.LeaderEmployeeId, dbo.AccountProject.ProjectManagerEmployeeId, dbo.AccountProject.TimeSheetApprovalTypeId, 
                      dbo.AccountProject.ExpenseApprovalTypeId, AccountProjectTask_1.IsBillable, dbo.AccountEmployeeTimeEntry.Rejected, dbo.AccountEmployeeTimeEntry.BillingRate, 
                      dbo.AccountProject.ProjectBillingRateTypeId, dbo.AccountEmployee.EmployeeCode, dbo.AccountEmployee.AccountDepartmentId, 
                      dbo.AccountDepartment.DepartmentName, AccountProjectTask_1.EstimatedCost, AccountProjectTask_1.EstimatedTimeSpent, 
                      dbo.AccountEmployeeTimeEntry.Submitted, dbo.AccountWorkType.AccountWorkType, dbo.AccountEmployee.EMailAddress, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountCostCenter.AccountCostCenter, dbo.AccountCostCenter.AccountCostCenterCode, dbo.AccountWorkType.AccountWorkTypeCode, 
                      dbo.AccountProject.ProjectCode, AccountProjectTask_1.TaskCode, dbo.AccountLocation.AccountLocationId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction.Comments, dbo.AccountEmployeeTimeEntry.BillingRateCurrencyId, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateCurrencyId, dbo.AccountEmployeeTimeEntry.BillingRateExchangeRate, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateExchangeRate, dbo.AccountEmployeeTimeEntry.AccountBaseCurrencyId, AccountProjectTask_1.AccountTaskTypeId, 
                      AccountProjectTask_1.TaskStatusId, AccountProjectTask_1.AccountPriorityId, AccountProjectTask_1.AccountProjectMilestoneId, 
                      dbo.AccountDepartment.DepartmentCode, dbo.AccountParty.PartyNick, AccountProjectTask_1.EstimatedCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction.ApprovedOn, dbo.AccountEmployeeTimeEntry.EmployeeRate, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountRole.Role, dbo.AccountProject.AccountProjectTypeId, dbo.AccountProject.ProjectDescription, AccountProjectTask_1.TaskDescription, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeExpenseBillingTimesheetId, dbo.AccountEmployeeTimeEntry.Billed, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Submitted = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS SubmittedHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Approved = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS ApprovedHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Rejected = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS RejectedHours, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, 
                      dbo.AccountPartyContact.FirstName + N'' '' + dbo.AccountPartyContact.LastName AS ClientContactName, 
                      dbo.AccountPartyDepartment.PartyDepartmentCode AS ClientDepartmentCode, dbo.AccountPartyDepartment.PartyDepartmentName AS ClientDepartmentName, 
                      dbo.AccountPartyDepartment.PartyDepartmentLocation AS ClientDepartmentLocation, dbo.AccountEmployeeTimeEntry.IsTimeOff, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId, CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 0 THEN ROUND(CONVERT(float, DATEPART(hh, 
                      dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS TimeOffHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS TimesheetHours, dbo.AccountWorkType.AccountWorkTypeId, 
                      dbo.AccountStatus.Status AS ProjectStatus, AccountProjectTask_1.ParentAccountProjectTaskId, dbo.AccountProjectTask.TaskName AS ParentTaskName, 
                      dbo.AccountEmployee.IsDisabled, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, ISNULL(dbo.AccountEmployeeType.AccountEmployeeType, N'''') 
                      AS EmployeeType
FROM         dbo.AccountEmployeeType RIGHT OUTER JOIN
                      dbo.AccountEmployeeTimeEntry INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeEntry.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId ON 
                      dbo.AccountEmployeeType.AccountEmployeeTypeId = dbo.AccountEmployee.EmployeePayTypeId LEFT OUTER JOIN
                      dbo.AccountProjectTask AS AccountProjectTask_1 LEFT OUTER JOIN
                      dbo.AccountProjectTask ON AccountProjectTask_1.ParentAccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId ON 
                      dbo.AccountEmployeeTimeEntry.AccountProjectTaskId = AccountProjectTask_1.AccountProjectTaskId LEFT OUTER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountStatus ON dbo.AccountProject.ProjectStatusId = dbo.AccountStatus.AccountStatusId LEFT OUTER JOIN
                      dbo.AccountTimeOffType ON dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId LEFT OUTER JOIN
                      dbo.AccountPartyDepartment ON dbo.AccountProject.AccountPartyDepartmentId = dbo.AccountPartyDepartment.AccountPartyDepartmentId LEFT OUTER JOIN
                      dbo.AccountPartyContact ON dbo.AccountProject.AccountPartyContactId = dbo.AccountPartyContact.AccountPartyContactId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryPeriod ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId LEFT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryApprovalLastAction.AccountEmployeeTimeEntryId LEFT OUTER JOIN
                      dbo.AccountCostCenter ON dbo.AccountEmployeeTimeEntry.AccountCostCenterId = dbo.AccountCostCenter.AccountCostCenterId LEFT OUTER JOIN
                      dbo.AccountWorkType ON dbo.AccountEmployeeTimeEntry.AccountWorkTypeId = dbo.AccountWorkType.AccountWorkTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId LEFT OUTER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId'


GO
-- Create View vueAccountEmployeeTimeEntryForReport
Print 'Create View vueAccountEmployeeTimeEntryForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryForReport
AS
SELECT     dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeName, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskName, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalTime, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Approved, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TeamLeadApproved, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectManagerApproved, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AdministratorApproved, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeTimeEntryId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.StartTime, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EndTime, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Description, N'''') AS Description, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.WeekDay, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountPartyId AS AccountClientId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.PartyName AS ClientName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectTaskId, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingType, N'''') 
                      AS BillingType, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectManagerEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ExpenseApprovalTypeId, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.IsBillable, 0) 
                      AS IsBillable, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Rejected, 0) AS Rejected, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRate, 0) AS BillingRate, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectBillingRateTypeId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeCode, N'''') AS EmployeeCode, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountDepartmentId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.DepartmentName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedCost, 0) AS EstimatedCost, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedTimeSpent, 0) AS EstimatedHours, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Submitted, 0) AS Submitted, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountWorkType, N'''') AS AccountWorkType, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EMailAddress, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountLocation, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountCostCenter, N'''') AS AccountCostCenter, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountCostCenterCode, N'''') AS AccountCostCenterCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountWorkTypeCode, N'''') AS AccountWorkTypeCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectCode, N'''') AS ProjectCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCode, N'''') AS TaskCode, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountLocationId, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Comments, N'''') 
                      AS ApproverComments, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes * dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRate / 60, 0) 
                      AS Amount, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRateCurrencyId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateExchangeRate, 0) AS BillingRateExchangeRate, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRateExchangeRate, 0) AS EmployeeRateExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountBaseCurrencyId, dbo.vueAccountCurrency.CurrencyCode AS BillingRateCurrencyCode, 
                      dbo.vueAccountCurrency.CurrencyCode AS AmountCurrencyCode, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountTaskTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskStatusId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountPriorityId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectMilestoneId, dbo.AccountTaskType.TaskType, dbo.AccountStatus.Status AS TaskStatus, 
                      dbo.AccountProjectMilestone.MilestoneDescription, dbo.AccountPriority.Priority, ROUND(CONVERT(float, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes) / 60, 2) AS TotalHours, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.DepartmentCode, N'''') AS DepartmentCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.PartyNick, N'''') AS ClientNick, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedCurrencyId, vueAccountCurrency_1.CurrencyCode AS EstimatedCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ApprovedOn, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRate, 0) 
                      AS EmployeeRate, vueAccountCurrency_2.CurrencyCode AS EmployeeRateCurrencyCode, 
                      AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName AS TeamLeader, 
                      AccountEmployee_2.FirstName + '' '' + AccountEmployee_2.LastName AS ProjectManager, 
                      ISNULL(dbo.AccountEmployee.FirstName + N'' '' + dbo.AccountEmployee.LastName, N'''') AS EmployeeManager, 
                      vueAccountCurrency_1.ExchangeRate AS EstimatedCurrencyExchangeRate, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes * dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRate / 60, 0) 
                      AS EmployeeCost, { fn DAYOFMONTH(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) } AS DayNo, 
                      MONTH(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) AS MonthNo, DATEPART(week, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) - DATEPART(week, DATEADD(month, DATEDIFF(month, 0, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate), 0)) + 1 AS WeekNo, 
                      YEAR(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) AS Year, 
                      LEFT({ fn MONTHNAME(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) }, 3) + '' - '' + CONVERT(nvarchar(10), 
                      YEAR(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate)) AS Period, 
                      { fn DAYNAME(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) } AS WeekDayName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountRoleId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Role, 
                      dbo.AccountProjectType.ProjectType, dbo.AccountRole.Role AS ProjectRole, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectDescription, N'''') 
                      AS ProjectDescription, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskDescription, N'''') AS TaskDescription, 
                      dbo.AccountTimeExpenseBilling.InvoiceNumber, dbo.AccountTimeExpenseBilling.InvoiceDate, dbo.AccountProjectType.AccountProjectTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Billed, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeTimeEntryPeriodId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientContactName, N'''') AS ClientContactName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentCode, N'''') AS ClientDepartmentCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentName, N'''') AS ClientDepartmentName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentLocation, N'''') AS ClientDepartmentLocation, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.IsTimeOff, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountWorkTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectStatus, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ParentTaskName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.FirstName, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.LastName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeType
FROM         dbo.AccountRole INNER JOIN
                      dbo.AccountProjectEmployee ON dbo.AccountRole.AccountRoleId = dbo.AccountProjectEmployee.AccountRoleId RIGHT OUTER JOIN
                      dbo.AccountTimeExpenseBillingTimesheet INNER JOIN
                      dbo.AccountTimeExpenseBilling ON 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingId = dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId RIGHT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport LEFT OUTER JOIN
                      dbo.AccountProjectType ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectTypeId = dbo.AccountProjectType.AccountProjectTypeId LEFT OUTER JOIN
                      dbo.AccountProjectMilestone ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectMilestoneId = dbo.AccountProjectMilestone.AccountProjectMilestoneId LEFT OUTER JOIN
                      dbo.AccountStatus ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskStatusId = dbo.AccountStatus.AccountStatusId LEFT OUTER JOIN
                      dbo.AccountPriority ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountPriorityId = dbo.AccountPriority.AccountPriorityId LEFT OUTER JOIN
                      dbo.AccountTaskType ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountTaskTypeId = dbo.AccountTaskType.AccountTaskTypeId ON 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingTimesheetId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountTimeExpenseBillingTimesheetId
                       ON dbo.AccountProjectEmployee.AccountEmployeeId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeId AND 
                      dbo.AccountProjectEmployee.AccountProjectId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.LeaderEmployeeId = AccountEmployee_1.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_2 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectManagerEmployeeId = AccountEmployee_2.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.AccountEmployee AS AccountEmployee_3 ON dbo.AccountEmployee.AccountEmployeeId = AccountEmployee_3.EmployeeManagerId ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeId = AccountEmployee_3.AccountEmployeeId LEFT OUTER JOIN
                      dbo.vueAccountCurrency AS vueAccountCurrency_2 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRateCurrencyId = vueAccountCurrency_2.AccountCurrencyId LEFT OUTER JOIN
                      dbo.vueAccountCurrency AS vueAccountCurrency_1 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedCurrencyId = vueAccountCurrency_1.AccountCurrencyId LEFT OUTER JOIN
                      dbo.vueAccountCurrency ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateCurrencyId = dbo.vueAccountCurrency.AccountCurrencyId'
	
GO
-- Create View rptvueAccountEmployeeTimeEntry
Print 'Create View rptvueAccountEmployeeTimeEntry'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeEntry' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountEmployeeTimeEntry
AS
SELECT     dbo.vueAccountEmployeeTimeEntryForReport.EmployeeName, dbo.vueAccountEmployeeTimeEntryForReport.ProjectName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskName, dbo.vueAccountEmployeeTimeEntryForReport.TotalTime, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Approved, dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectId, dbo.vueAccountEmployeeTimeEntryForReport.TeamLeadApproved, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManagerApproved, dbo.vueAccountEmployeeTimeEntryForReport.AdministratorApproved, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeTimeEntryId, dbo.vueAccountEmployeeTimeEntryForReport.StartTime, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EndTime, dbo.vueAccountEmployeeTimeEntryForReport.TimeEntryDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Description, dbo.vueAccountEmployeeTimeEntryForReport.AccountId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TotalMinutes, dbo.vueAccountEmployeeTimeEntryForReport.WeekDay, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientName, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectTaskId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingType, dbo.vueAccountEmployeeTimeEntryForReport.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManagerEmployeeId, dbo.vueAccountEmployeeTimeEntryForReport.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ExpenseApprovalTypeId, dbo.vueAccountEmployeeTimeEntryForReport.IsBillable, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Rejected, dbo.vueAccountEmployeeTimeEntryForReport.BillingRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectBillingRateTypeId, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountDepartmentId, dbo.vueAccountEmployeeTimeEntryForReport.DepartmentName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCost, dbo.vueAccountEmployeeTimeEntryForReport.EstimatedHours, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Submitted, dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkType, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EMailAddress, dbo.vueAccountEmployeeTimeEntryForReport.AccountLocation, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountCostCenter, dbo.vueAccountEmployeeTimeEntryForReport.AccountCostCenterCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkTypeCode, dbo.vueAccountEmployeeTimeEntryForReport.ProjectCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCode, dbo.vueAccountEmployeeTimeEntryForReport.AccountLocationId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ApproverComments, dbo.vueAccountEmployeeTimeEntryForReport.Amount, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingRateCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountBaseCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.BillingRateCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AmountCurrencyCode, CASE WHEN vueAccountEmployeeTimeEntryForReport.Submitted = 1 AND 
                      vueAccountEmployeeTimeEntryForReport.Approved = 0 THEN ''Submitted'' WHEN vueAccountEmployeeTimeEntryForReport.Approved = 1 THEN ''Approved'' WHEN vueAccountEmployeeTimeEntryForReport.Rejected
                       = 1 THEN ''Rejected'' WHEN vueAccountEmployeeTimeEntryForReport.Submitted = 0 AND vueAccountEmployeeTimeEntryForReport.Approved = 0 AND 
                      vueAccountEmployeeTimeEntryForReport.Rejected = 0 THEN ''Not Submitted'' END AS ApprovalStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountTaskTypeId, dbo.vueAccountEmployeeTimeEntryForReport.TaskStatusId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountPriorityId, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectMilestoneId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskType, dbo.vueAccountEmployeeTimeEntryForReport.TaskStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.MilestoneDescription, dbo.vueAccountEmployeeTimeEntryForReport.Priority, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TotalHours, dbo.vueAccountEmployeeTimeEntryForReport.DepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientNick, dbo.vueAccountEmployeeTimeEntryForReport.AccountClientId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ApprovedOn, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateCurrencyCode, dbo.vueAccountEmployeeTimeEntryForReport.TeamLeader, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManager, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeManager, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate, 0) AS EstimatedCurrencyExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCost, dbo.vueAccountEmployeeTimeEntryForReport.AccountRoleId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Role, dbo.vueAccountEmployeeTimeEntryForReport.WeekDayName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Period, dbo.vueAccountEmployeeTimeEntryForReport.Year, dbo.vueAccountEmployeeTimeEntryForReport.WeekNo, 
                      dbo.vueAccountEmployeeTimeEntryForReport.MonthNo, dbo.vueAccountEmployeeTimeEntryForReport.DayNo, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 1 THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours ELSE 0 END AS BillableTotalHours,
                       CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable
                       IS NULL THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours ELSE 0 END AS NonBillableTotalHours, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCost / dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate
                       ELSE 0 END AS CurrencyEmployeeCost, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.Amount / dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate
                       ELSE 0 END AS CurrencyAmount, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCost / dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate
                       ELSE 0 END AS CurrencyEstimatedCost, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate / dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate
                       ELSE 0 END AS CurrencyBillingRate, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRate / dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate
                       ELSE 0 END AS CurrencyEmployeeRate, dbo.vueAccountEmployeeTimeEntryForReport.ProjectRole, dbo.vueAccountEmployeeTimeEntryForReport.ProjectType, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectDescription, dbo.vueAccountEmployeeTimeEntryForReport.TaskDescription, 
                      dbo.vueAccountEmployeeTimeEntryForReport.InvoiceNumber, dbo.vueAccountEmployeeTimeEntryForReport.InvoiceDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectTypeId, dbo.vueAccountEmployeeTimeEntryForReport.Billed, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientContactName, dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentName, dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentLocation, 
                      dbo.vueAccountEmployeeTimeEntryForReport.IsTimeOff, dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkTypeId, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 1 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate * dbo.vueAccountEmployeeTimeEntryForReport.TotalHours
                       ELSE 0 END AS BillableTotalAmount, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate * dbo.vueAccountEmployeeTimeEntryForReport.TotalHours
                       ELSE 0 END AS NonBillableTotalAmount, dbo.vueAccountEmployeeTimeEntryForReport.ProjectStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ParentTaskName, dbo.vueAccountEmployeeTimeEntryForReport.FirstName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.LastName, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeType
FROM         dbo.vueAccountEmployeeTimeEntryForReport INNER JOIN
                      dbo.vueAccountEmployeeTimeEntryWithLastStatus ON 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryWithLastStatus.AccountEmployeeTimeEntryId'


-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'
if not exists(Select * from [dbo].[SystemReportDataSourceField] where [SystemReportDataSourceFieldId] = '40264639-bfc7-45da-86e2-34a559f549cf')
BEGIN
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('40264639-bfc7-45da-86e2-34a559f549cf', '3a080202-6842-4eca-8c79-a945978810b4', N'EmployeeType', 125, 0, NULL, NULL, 318, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Employee Type', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('7688135f-0105-40fe-80f8-bda56175dac7', '3a080202-6842-4eca-8c79-a945978810b4', N'LastName', 150, 0, NULL, NULL, 314, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Last Name', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('b6ebcfa8-cd86-451f-8380-679de2d9e9a1', '3a080202-6842-4eca-8c79-a945978810b4', N'FirstName', 150, 0, NULL, NULL, 313, '91402610-eef0-4dd0-aca3-0080f53389fa', N'First Name', 0, 0)
END

GO
-- Drop Procedure DeleteScript
Print 'Drop Procedure DeleteScript'
GO
IF EXISTS(SELECT * FROM sysobjects WHERE name = 'DeleteScript' AND type = 'P')
DROP PROCEDURE [dbo].[DeleteScript]

GO
-- Create Procedure DeleteScript
Print 'Create Procedure DeleteScript'
GO
CREATE PROCEDURE [dbo].[DeleteScript] 
    (
@AccountId integer
            )
AS
	SET NOCOUNT ON

IF EXISTS (SELECT * FROM AccountAttachments WHERE AccountExpenseEntryId in (Select AccountExpenseEntryId from AccountExpenseEntry Where AccountId <> @AccountId))
BEGIN
delete from AccountAttachments Where AccountExpenseEntryId in (Select AccountExpenseEntryId from AccountExpenseEntry Where AccountId <> @AccountId)
END
IF EXISTS (SELECT * FROM AccountExpenseEntry WHERE AccountId = @AccountId)
BEGIN
delete from AccountExpenseEntry where accountid <> @AccountId
END
IF EXISTS (SELECT * FROM AccountTimeExpenseBillingExpense WHERE AccountId = @AccountId)
BEGIN
delete from AccountTimeExpenseBillingExpense where accountid <> @AccountId
END
IF EXISTS (SELECT * FROM AccountTimeExpenseBillingTimesheet WHERE AccountId = @AccountId)
BEGIN
delete from AccountTimeExpenseBillingTimesheet where accountid <> @AccountId
END
IF EXISTS (SELECT * FROM AccountTimeExpenseBilling WHERE AccountId = @AccountId)
BEGIN
delete from AccountTimeExpenseBilling where accountid <> @AccountId
END
IF EXISTS (SELECT * FROM accountholidaytypedetail WHERE AccountId = @AccountId)
BEGIN
delete from accountholidaytypedetail where accountid <> @AccountId
END
IF EXISTS (SELECT * FROM accountholidaytype WHERE AccountId = @AccountId)
BEGIN
delete from accountholidaytype where accountid <> @AccountId
END
IF EXISTS (SELECT * FROM AccountExpense WHERE AccountId = @AccountId)
BEGIN
delete from AccountExpense where accountid <> @AccountId
END
IF EXISTS (SELECT * FROM AccountExpenseTypeTaxCode WHERE AccountId = @AccountId)
BEGIN
delete From AccountExpenseTypeTaxCode where accountid <> @AccountId
END
IF EXISTS (SELECT * FROM AccountExpenseType WHERE AccountId = @AccountId)
BEGIN
delete from AccountExpenseType where accountid <> @AccountId
END
IF EXISTS (SELECT * FROM AccountTaxCode WHERE AccountId = @AccountId)
BEGIN
delete from AccountTaxCode where accountid <> @AccountId
END
IF EXISTS (SELECT * FROM AccountPaymentMethod WHERE AccountId = @AccountId)
BEGIN
delete from AccountPaymentMethod where accountid <> @AccountId
END
IF EXISTS (SELECT * FROM AccountPreferences WHERE AccountId = @AccountId)
BEGIN
delete from AccountPreferences where accountid <> @AccountId
END
IF EXISTS (SELECT * FROM AccountWorkTypeBillingRate WHERE AccountId = @AccountId)
BEGIN
delete from AccountWorkTypeBillingRate where accountid <> @AccountId
END
IF EXISTS (SELECT * FROM AccountEmployeeTimeEntry Where AccountProjectId in (Select AccountProjectId from AccountProject Where AccountId <> @AccountId))
BEGIN
delete from AccountEmployeeTimeEntry 
Where AccountProjectId in (Select AccountProjectId from AccountProject Where AccountId <> @AccountId)
END
IF EXISTS (SELECT * FROM AccountEmployeeTimeEntry Where AccountProjectTaskId in (Select AccountProjectTaskId from AccountProjectTask Where AccountProjectId  in (Select AccountProjectId from AccountProject Where AccountId <> @AccountId)))
BEGIN
delete from AccountEmployeeTimeEntry 
Where AccountProjectTaskId in (Select AccountProjectTaskId from AccountProjectTask Where AccountProjectId  in (Select AccountProjectId from AccountProject Where AccountId <> @AccountId))
END
IF EXISTS (SELECT * FROM AccountProjectTask Where AccountProjectId in (Select AccountProjectId from AccountProject Where AccountId <> @AccountId))
BEGIN
Delete From AccountProjectTask 
Where AccountProjectId in (Select AccountProjectId from AccountProject Where AccountId <> @AccountId)
END
IF EXISTS (SELECT * FROM AccountProjectMilestone Where AccountProjectId in (Select AccountProjectId from AccountProject Where AccountId <> @AccountId))
BEGIN
delete from AccountProjectMilestone 
Where AccountProjectId in (Select AccountProjectId from AccountProject Where AccountId <> @AccountId)
END
IF EXISTS (SELECT * FROM accountemailnotificationpreference where accountprojectid not in (Select AccountProjectId from AccountProject where accountid = @AccountId))
BEGIN
delete from accountemailnotificationpreference 
where accountprojectid not in (Select AccountProjectId from AccountProject where accountid = @AccountId)
END
IF EXISTS (SELECT * FROM accountemailnotificationpreference where AccountEmployeeId not in (Select AccountEmployeeId from AccountEmployee where accountid = @AccountId))
BEGIN
delete from accountemailnotificationpreference
where AccountEmployeeId not in (Select AccountEmployeeId from AccountEmployee where accountid = @AccountId)
END
IF EXISTS (SELECT * FROM accountemailnotificationpreference where AccountId <> @AccountId)
BEGIN
delete from accountemailnotificationpreference where AccountId <> @AccountId
END
IF EXISTS (SELECT * FROM AccountEmployeeTimeEntry Where AccountEmployeeId in (Select AccountEmployeeId from AccountEmployee Where AccountId <> @AccountId))
BEGIN
delete from AccountEmployeeTimeEntry 
Where AccountEmployeeId in (Select AccountEmployeeId from AccountEmployee Where AccountId <> @AccountId)
END
IF EXISTS (SELECT * FROM AccountEmployeeTimeEntryApprovalProject Where TimeEntryAccountEmployeeId in (Select AccountEmployeeId from AccountEmployee Where AccountId <> @AccountId))
BEGIN
delete from AccountEmployeeTimeEntryApprovalProject 
Where TimeEntryAccountEmployeeId in (Select AccountEmployeeId from AccountEmployee Where AccountId <> @AccountId)
END
IF EXISTS (SELECT * FROM AccountEmployeeTimeEntryPeriod where AccountId <> @AccountId)
BEGIN
delete from AccountEmployeeTimeEntryPeriod
where AccountId <> @AccountId
END
IF EXISTS (SELECT * FROM AccountProjectRole Where AccountProjectId in (Select AccountProjectId from AccountProject Where AccountId <> @AccountId))
BEGIN
delete From AccountProjectRole
Where AccountProjectId in (Select AccountProjectId from AccountProject Where AccountId <> @AccountId)
END
IF EXISTS (SELECT * FROM AccountEmployeeTimeOffRequest where AccountEmployeeId in (Select AccountEmployeeId from AccountEmployee where accountid <> @AccountId))
BEGIN
delete from AccountEmployeeTimeOffRequest
where AccountEmployeeId in (Select AccountEmployeeId from AccountEmployee where accountid <> @AccountId)
END
IF EXISTS (SELECT * FROM AccountProject where accountid <> @AccountId)
BEGIN
delete from AccountProject where accountid <> @AccountId
END
IF EXISTS (SELECT * FROM EmailMessage where EmailTo in (Select EmailAddress from AccountEmployee Where AccountId <> @AccountId))
BEGIN
delete From EmailMessage where EmailTo in (Select EmailAddress from AccountEmployee Where AccountId <> @AccountId)
END
IF EXISTS (SELECT * FROM accountemployeeattendance where accountid <> @AccountId)
BEGIN
delete from accountemployeeattendance where accountid <> @AccountId
END
IF EXISTS (SELECT * FROM AccountEmployeeExpenseSheet where accountid <> @AccountId)
BEGIN
delete from AccountEmployeeExpenseSheet
where accountid <> @AccountId
END
IF EXISTS (SELECT * FROM AccountApprovalPath where accountid <> @AccountId)
BEGIN
delete from AccountApprovalPath
where accountid <> @AccountId
END
IF EXISTS (SELECT * FROM accountemployee where accountid <> @AccountId)
BEGIN
delete from accountemployee where accountid  <> @AccountId
END
IF EXISTS (SELECT * FROM AccountParty WHERE AccountId = @AccountId)
BEGIN
delete from AccountParty where accountid <> @AccountId
END
IF EXISTS (SELECT * FROM accountstatus where accountid <> @AccountId)
BEGIN
delete from accountstatus where accountid <> @AccountId
END
IF EXISTS (SELECT * FROM accountworkingdaytype where accountid <> @AccountId)
BEGIN
delete from accountworkingdaytype where accountid <> @AccountId
END
IF EXISTS (SELECT * FROM accounttimesheetperiodtype where accountid <> @AccountId)
BEGIN
delete from accounttimesheetperiodtype where accountid <> @AccountId
END
IF EXISTS (SELECT * FROM accountcostcenter where accountid <> @AccountId)
BEGIN
delete from accountcostcenter where accountid <> @AccountId
END

IF EXISTS (SELECT * FROM Account where accountid <> @AccountId)
BEGIN
delete from Account where accountid <> @AccountId
END


IF EXISTS (SELECT * FROM AccountPriority where accountid <> @AccountId)
BEGIN
delete From AccountPriority where accountid <> @AccountId
END
IF EXISTS (SELECT * FROM AccountWorkTypeBillingRate where accountid <> @AccountId)
BEGIN
delete from AccountWorkTypeBillingRate where accountid <> @AccountId
END
IF EXISTS (SELECT * FROM AccountBillingRate where accountid <> @AccountId)
BEGIN
delete From AccountBillingRate where accountid <> @AccountId
END
IF EXISTS (SELECT * FROM AccountCurrency where accountid <> @AccountId)
BEGIN
delete from AccountCurrency where accountid <> @AccountId
END
IF EXISTS (SELECT * FROM AccountCurrencyExchangeRate where accountid <> @AccountId)
BEGIN
delete from AccountCurrencyExchangeRate where accountid <> @AccountId
END
IF EXISTS (SELECT * FROM AccountTimeOffPolicy where accountid <> @AccountId)
BEGIN
delete from AccountTimeOffPolicy where accountid <> @AccountId
END
IF EXISTS (SELECT * FROM AccountTimeOffType where accountid <> @AccountId)
BEGIN
delete from AccountTimeOffType where accountid <> @AccountId
END
IF EXISTS (SELECT * FROM AccountTaxZone where accountid <> @AccountId)
BEGIN
delete From AccountTaxZone where accountid <> @AccountId
END
IF EXISTS (SELECT * FROM AccountCostCenter where accountid <> @AccountId)
BEGIN
delete From AccountCostCenter where accountid <> @AccountId
END
IF EXISTS (SELECT * FROM AccountWorkType where accountid <> @AccountId)
BEGIN
delete From AccountWorkType where accountid <> @AccountId
END
BEGIN
delete From LTCustomer 
delete From LTCustomerPayment
delete from EmailMessage

/****** Object:  Table [dbo].[Audit]    Script Date: 04/02/2011 17:22:25 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Audit]') AND type in (N'U'))
DROP TABLE [dbo].[Audit]

CREATE TABLE [dbo].[Audit](
	[Type] [nvarchar](2)  NULL,
	[TableName] [nvarchar](256) NULL,
	[PK] [varchar](50) NULL,
	[FieldName] [nvarchar](256) NULL,
	[OldValue] [nvarchar](2000) NULL,
	[NewValue] [nvarchar](2000) NULL,
	[UpdateDate] [datetime] NULL,
	[UserName] [int] NULL
) ON [PRIMARY]
END

GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'
BEGIN
UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=49 WHERE [SystemReportDataSourceFieldId]='baae2f19-2c86-4b3b-ab4a-24b160937405'
UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=68 WHERE [SystemReportDataSourceFieldId]='40264639-bfc7-45da-86e2-34a559f549cf'
UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=70 WHERE [SystemReportDataSourceFieldId]='7688135f-0105-40fe-80f8-bda56175dac7'
UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=50 WHERE [SystemReportDataSourceFieldId]='ca87f66e-3584-4658-833f-5eb72ed5dd46'
UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=69 WHERE [SystemReportDataSourceFieldId]='b6ebcfa8-cd86-451f-8380-679de2d9e9a1'
UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=51 WHERE [SystemReportDataSourceFieldId]='0f2d1d68-826d-400e-bf9f-95d4a9d6c4e0'
END

GO
-- Drop View vueAccountEmployeeTimesheetSubmissionStatus
Print 'Drop View vueAccountEmployeeTimesheetSubmissionStatus'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimesheetSubmissionStatus' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimesheetSubmissionStatus]

GO
-- Drop View vueAccountEmployeeTimesheetSubmissionStatusALL
Print 'Drop View vueAccountEmployeeTimesheetSubmissionStatusALL'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimesheetSubmissionStatusALL' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimesheetSubmissionStatusALL]

GO
-- Drop View vueAccountEmployeeTimeEntry
Print 'Drop View vueAccountEmployeeTimeEntry'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntry' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntry]

GO
-- Create View vueAccountEmployeeTimeEntry
Print 'Create View vueAccountEmployeeTimeEntry'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntry' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntry
AS
SELECT     CASE WHEN dbo.AccountEmployee.IsDisabled = 1 THEN dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE dbo.AccountEmployee.FirstName
                       + '' '' + dbo.AccountEmployee.LastName END AS EmployeeName, dbo.AccountProject.ProjectName, 
                      CASE WHEN dbo.AccountProjectTask.AccountProjectTaskId IS NOT NULL 
                      THEN dbo.AccountProjectTask.TaskName ELSE AccountTimeOffType.AccountTimeOffType END AS TaskName, dbo.AccountEmployeeTimeEntry.TotalTime, 
                      dbo.AccountEmployeeTimeEntry.Approved, dbo.AccountEmployee.AccountEmployeeId, dbo.AccountProject.AccountProjectId, 
                      dbo.AccountEmployeeTimeEntry.TeamLeadApproved, dbo.AccountEmployeeTimeEntry.ProjectManagerApproved, 
                      dbo.AccountEmployeeTimeEntry.AdministratorApproved, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, dbo.AccountEmployeeTimeEntry.StartTime, 
                      dbo.AccountEmployeeTimeEntry.EndTime, dbo.AccountEmployeeTimeEntry.TimeEntryDate, dbo.AccountEmployeeTimeEntry.Description, 
                      dbo.AccountEmployee.AccountId, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      AS TotalMinutes, DATEPART(dw, dbo.AccountEmployeeTimeEntry.TimeEntryDate) AS WeekDay, dbo.AccountParty.AccountPartyId, dbo.AccountParty.PartyName, 
                      dbo.AccountProjectTask.AccountProjectTaskId, dbo.AccountBillingType.BillingType, dbo.AccountProject.LeaderEmployeeId, 
                      dbo.AccountProject.ProjectManagerEmployeeId, dbo.AccountProject.TimeSheetApprovalTypeId, dbo.AccountProject.ExpenseApprovalTypeId, 
                      dbo.AccountProjectTask.IsBillable, dbo.AccountEmployeeTimeEntry.Rejected, dbo.AccountEmployeeTimeEntry.BillingRate, 
                      dbo.AccountProject.ProjectBillingRateTypeId, dbo.AccountEmployee.EmployeeCode, dbo.AccountEmployee.AccountDepartmentId, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountProjectTask.EstimatedCost, dbo.AccountProjectTask.EstimatedTimeSpent, 
                      dbo.AccountEmployeeTimeEntry.Submitted, dbo.AccountWorkType.AccountWorkType, dbo.AccountEmployee.EMailAddress, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountCostCenter.AccountCostCenter, dbo.AccountCostCenter.AccountCostCenterCode, dbo.AccountWorkType.AccountWorkTypeCode, 
                      dbo.AccountProject.ProjectCode, dbo.AccountProjectTask.TaskCode, dbo.AccountLocation.AccountLocationId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction.Comments, dbo.AccountEmployeeTimeEntry.BillingRateCurrencyId, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateCurrencyId, dbo.AccountEmployeeTimeEntry.BillingRateExchangeRate, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateExchangeRate, dbo.AccountEmployeeTimeEntry.AccountBaseCurrencyId, dbo.AccountProjectTask.AccountTaskTypeId, 
                      dbo.AccountProjectTask.TaskStatusId, dbo.AccountProjectTask.AccountPriorityId, dbo.AccountProjectTask.AccountProjectMilestoneId, 
                      dbo.AccountDepartment.DepartmentCode, dbo.AccountParty.PartyNick, dbo.AccountProjectTask.EstimatedCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction.ApprovedOn, dbo.AccountEmployeeTimeEntry.EmployeeRate, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountRole.Role, dbo.AccountProject.AccountProjectTypeId, dbo.AccountProject.ProjectDescription, dbo.AccountProjectTask.TaskDescription, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeExpenseBillingTimesheetId, dbo.AccountEmployeeTimeEntry.Billed, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Submitted = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS SubmittedHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Approved = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS ApprovedHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Rejected = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS RejectedHours, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, 
                      dbo.AccountPartyContact.FirstName + N'' '' + dbo.AccountPartyContact.LastName AS ClientContactName, 
                      dbo.AccountPartyDepartment.PartyDepartmentCode AS ClientDepartmentCode, dbo.AccountPartyDepartment.PartyDepartmentName AS ClientDepartmentName, 
                      dbo.AccountPartyDepartment.PartyDepartmentLocation AS ClientDepartmentLocation, dbo.AccountWorkType.AccountWorkTypeId, 
                      dbo.AccountEmployeeTimeEntry.IsTimeOff, dbo.AccountEmployeeTimeEntry.Hours, dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeOffRequestId
FROM         dbo.AccountEmployeeTimeEntry INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeEntry.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountTimeOffType ON dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId LEFT OUTER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountProjectTask ON dbo.AccountEmployeeTimeEntry.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId LEFT OUTER JOIN
                      dbo.AccountPartyDepartment ON dbo.AccountProject.AccountPartyDepartmentId = dbo.AccountPartyDepartment.AccountPartyDepartmentId LEFT OUTER JOIN
                      dbo.AccountPartyContact ON dbo.AccountProject.AccountPartyContactId = dbo.AccountPartyContact.AccountPartyContactId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryPeriod ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId LEFT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryApprovalLastAction.AccountEmployeeTimeEntryId LEFT OUTER JOIN
                      dbo.AccountCostCenter ON dbo.AccountEmployeeTimeEntry.AccountCostCenterId = dbo.AccountCostCenter.AccountCostCenterId LEFT OUTER JOIN
                      dbo.AccountWorkType ON dbo.AccountEmployeeTimeEntry.AccountWorkTypeId = dbo.AccountWorkType.AccountWorkTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId LEFT OUTER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId'

GO
-- Create View vueAccountEmployeeTimesheetSubmissionStatusALL
Print 'Create View vueAccountEmployeeTimesheetSubmissionStatusALL'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimesheetSubmissionStatusALL' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimesheetSubmissionStatusALL
AS
SELECT     dbo.vueAccountEmployeeTimeEntry.AccountEmployeeId, dbo.vueAccountEmployeeTimeEntry.EmployeeName, dbo.AccountDepartment.DepartmentName, 
                      dbo.vueAccountEmployeeTimeEntry.TimeEntryDate, 0 AS NotEntered, SUM(1) AS Entered, 
                      (CASE WHEN dbo.vueAccountEmployeeTimeEntry.Submitted = 1 THEN (COUNT(dbo.vueAccountEmployeeTimeEntry.Submitted)) ELSE 0 END) AS Submitted, 
                      SUM(CASE WHEN Approved = 1 THEN 1 ELSE 0 END) AS Approved, SUM(CASE WHEN Rejected = 1 THEN 1 ELSE 0 END) AS Rejected, dbo.AccountRole.Role, 
                      dbo.vueAccountEmployeeTimeEntry.AccountId, dbo.AccountEmployee.IsDisabled
FROM         dbo.vueAccountEmployeeTimeEntry INNER JOIN
                      dbo.AccountEmployee ON dbo.vueAccountEmployeeTimeEntry.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId INNER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId
GROUP BY dbo.vueAccountEmployeeTimeEntry.AccountEmployeeId, dbo.vueAccountEmployeeTimeEntry.EmployeeName, dbo.vueAccountEmployeeTimeEntry.TimeEntryDate, 
                      dbo.AccountRole.Role, dbo.vueAccountEmployeeTimeEntry.AccountId, dbo.AccountDepartment.DepartmentName, dbo.vueAccountEmployeeTimeEntry.Submitted, 
                      dbo.AccountEmployee.IsDisabled'

GO
-- Create View vueAccountEmployeeTimesheetSubmissionStatus
Print 'Create View vueAccountEmployeeTimesheetSubmissionStatus'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimesheetSubmissionStatus' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimesheetSubmissionStatus
AS
SELECT     AccountEmployeeId, EmployeeName, DepartmentName, TimeEntryDate, NotEntered, SUM(Submitted) AS Submitted, Approved, Rejected, Role, AccountId, Entered, 
                      IsDisabled
FROM         dbo.vueAccountEmployeeTimesheetSubmissionStatusALL
GROUP BY AccountEmployeeId, EmployeeName, DepartmentName, TimeEntryDate, NotEntered, Approved, Rejected, Role, AccountId, Entered, IsDisabled'

GO

-- Drop Procedure CreateTableforAccountEmployeeTimesheetSubmissionStatus
Print 'Drop Procedure CreateTableforAccountEmployeeTimesheetSubmissionStatus'
GO
IF  EXISTS (SELECT * FROM dbo.sysobjects where name = N'CreateTableforAccountEmployeeTimesheetSubmissionStatus' AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[CreateTableforAccountEmployeeTimesheetSubmissionStatus]

GO
-- Create Procedure CreateTableforAccountEmployeeTimesheetSubmissionStatus
Print 'Create Procedure CreateTableforAccountEmployeeTimesheetSubmissionStatus'
GO

CREATE PROCEDURE [dbo].[CreateTableforAccountEmployeeTimesheetSubmissionStatus]
    (
@startdate datetime,    
@enddate datetime,
@AccountEmployeeId varchar,
@AccountId integer
            )
AS

    SET NOCOUNT ON

IF EXISTS (SELECT * FROM tempdb.dbo.sysobjects WHERE NAME = '##tempAccountEmployeeTimesheetSubmissionStatusALL')
drop table ##tempAccountEmployeeTimesheetSubmissionStatusALL 


create table ##tempAccountEmployeeTimesheetSubmissionStatusALL 
(AccountEmployeeId int,
EmployeeName varchar(200),
DepartmentName varchar(200),
TimeEntryDate datetime,
NotEntered int,
Entered int,
Submitted int,
Approved int,
Rejected int,
Role varchar(100),
AccountId int)


insert into ##tempAccountEmployeeTimesheetSubmissionStatusALL
(AccountEmployeeId,
EmployeeName,
DepartmentName, 
TimeEntryDate,
NotEntered,
Entered, 
Submitted,
Approved,
Rejected,
Role,
AccountId)
SELECT     [##temp].AccountEmployeeId, CASE WHEN dbo.AccountEmployee.IsDisabled = 1 THEN dbo.AccountEmployee.FirstName + ' ' + dbo.AccountEmployee.LastName + ' ' + '(Disabled)' ELSE dbo.AccountEmployee.FirstName
                       + ' ' + dbo.AccountEmployee.LastName END AS EmployeeName, 
                      dbo.AccountDepartment.DepartmentName, AbsentDate AS TimeEntryDate, (CASE WHEN NOT IsNull(AccountEmployeeTimeEntry.TimeEntryDate, 0) 
                      = 0 THEN 0 ELSE 1 END) AS NotEntered, COUNT(dbo.AccountEmployeeTimeEntry.TimeEntryDate) AS Entered, 
                      (CASE WHEN dbo.AccountEmployeeTimeEntry.Submitted = 1 THEN COUNT(dbo.AccountEmployeeTimeEntry.Submitted) ELSE 0 END) AS Submitted, 
                      SUM(CASE WHEN Approved = 1 THEN 1 ELSE 0 END) AS Approved, SUM(CASE WHEN Rejected = 1 THEN 1 ELSE 0 END) AS Rejected, dbo.AccountRole.Role, 
                      [##temp].AccountId
FROM         dbo.AccountEmployeeTimeEntry RIGHT OUTER JOIN
                      dbo.tempdb.[##temp] ON dbo.[##temp].AccountEmployeeId = dbo.AccountEmployeeTimeEntry.AccountEmployeeId AND 
                      dbo.[##temp].AbsentDate = dbo.AccountEmployeeTimeEntry.TimeEntryDate INNER JOIN
                      dbo.AccountEmployee ON [##temp].AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId INNER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId
GROUP BY [##temp].AccountId, [##temp].AccountEmployeeId, AbsentDate, dbo.AccountEmployeeTimeEntry.Submitted, dbo.AccountEmployeeTimeEntry.TimeEntryDate, 
                      CASE WHEN dbo.AccountEmployee.IsDisabled = 1 THEN dbo.AccountEmployee.FirstName + ' ' + dbo.AccountEmployee.LastName + ' ' + '(Disabled)' ELSE dbo.AccountEmployee.FirstName
                       + ' ' + dbo.AccountEmployee.LastName END, dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role


GO

-- Drop View vueAccountEmployeeTimeEntryApprovalForReport
Print 'Drop View vueAccountEmployeeTimeEntryApprovalForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryApprovalForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryApprovalForReport]

GO
-- Drop View vueAccountEmployeesForReport
Print 'Drop View vueAccountEmployeesForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeesForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeesForReport]

GO
-- Drop View vueAccountEmployeeTimeOffRequestForReport
Print 'Drop View vueAccountEmployeeTimeOffRequestForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOffRequestForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeOffRequestForReport]

GO
-- Drop View vueAccountEmployeeTimeOffRequestWithTimeEntryReport
Print 'Drop View vueAccountEmployeeTimeOffRequestWithTimeEntryReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOffRequestWithTimeEntryReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeOffRequestWithTimeEntryReport]

GO
-- Drop View vueAccountEmployeeTimeOffForReport
Print 'Drop View vueAccountEmployeeTimeOffForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOffForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeOffForReport]

GO
-- Drop View vueAccountEmployee
Print 'Drop View vueAccountEmployee'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployee]

GO
-- Drop View vueAccountAttendance
Print 'Drop View vueAccountAttendance'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountAttendance' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountAttendance]

GO
-- Create View vueAccountAttendance
Print 'Create View vueAccountAttendance'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountAttendance' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountAttendance
AS
SELECT     dbo.AccountAbsenceType.AbsenceDescription, dbo.AccountAbsenceType.AccountAbsenceTypeId, dbo.AccountEmployeeAttendance.AttendanceDate, 
                      dbo.AccountEmployee.AccountEmployeeId, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, dbo.Account.AccountId, dbo.AccountEmployeeAttendance.InOut, 
                      dbo.AccountEmployeeAttendance.AttendanceTime, dbo.AccountEmployee.EmployeeCode, dbo.AccountEmployeeAttendance.AccountEmployeeAttendanceId
FROM         dbo.AccountAbsenceType RIGHT OUTER JOIN
                      dbo.AccountEmployeeAttendance LEFT OUTER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeAttendance.AccountId = dbo.AccountEmployee.AccountId AND 
                      dbo.AccountEmployeeAttendance.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.Account ON dbo.AccountEmployeeAttendance.AccountId = dbo.Account.AccountId ON 
                      dbo.AccountAbsenceType.AccountId = dbo.AccountEmployeeAttendance.AccountId AND 
                      dbo.AccountAbsenceType.AccountAbsenceTypeId = dbo.AccountEmployeeAttendance.AccountAbsenceTypeId'

GO
-- Create View vueAccountEmployee
Print 'Create View vueAccountEmployee'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployee
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountEmployee.AccountId, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.Password, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountLocationId, dbo.AccountEmployee.BillingTypeId, 
                      dbo.AccountBillingType.BillingType, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, dbo.AccountPreferences.ShowClockStartEnd, dbo.Account.TimeZoneId, 
                      dbo.AccountRole.MasterAccountRoleId, dbo.Account.DefaultCurrencyId, dbo.Account.CountryId, dbo.AccountPreferences.CultureInfoName, 
                      dbo.AccountPreferences.TimeEntryFormat, dbo.AccountEmployee.AllowedAccessFromIP, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountPreferences.AccountSessionTimeout, dbo.AccountPreferences.ShowCompletedTasksInTimeSheet, dbo.AccountPreferences.CurrencySymbol, 
                      dbo.AccountPreferences.IsCompanyOwnLogo, dbo.Account.AccountExpiryActivation, dbo.Account.LicenseActivation, dbo.AccountEmployee.EmployeeTypeId, 
                      dbo.AccountEmployee.ExternalUserClientId, dbo.AccountEmployee.AccountBillingRateId, dbo.AccountPreferences.ScheduledEmailSendTime, 
                      dbo.AccountEmployee.Username, dbo.AccountEmployee.IsDisabled, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.AccountEmployee.EmployeeCode, dbo.AccountPreferences.Version, 
                      dbo.AccountPreferences.LockSubmittedRecords, dbo.AccountPreferences.LockApprovedRecords, ISNULL(dbo.AccountEmployee.EmployeeCode + '' - '', '''') 
                      + dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeNameWithCode, dbo.AccountPreferences.ShowWorkTypeInTimeSheet, 
                      dbo.AccountPreferences.NumberOfBlankRowsInTimeEntry, dbo.AccountPreferences.ShowCostCenterInTimeSheet, dbo.AccountPreferences.WeekStartDay, 
                      dbo.AccountPreferences.AccountBaseCurrencyId, dbo.AccountPreferences.UserInterfaceLanguage, dbo.AccountEmployee.EmployeeManagerId, 
                      dbo.AccountPreferences.DefaultTimeEntryMode, dbo.AccountPreferences.PageSize, dbo.AccountEmployee.TimeZoneId AS EmployeeTimeZoneId, 
                      dbo.AccountEmployee.TerminationDate, dbo.AccountEmployee.StatusId, dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.EmployeePayTypeId, 
                      dbo.AccountEmployee.HiredDate, dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountWorkingDayType, 
                      dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay AS EmployeeWeekStartDay, 
                      dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountPreferences.ShowDescriptionInWeekView, 
                      dbo.AccountPreferences.InvoiceNoPrefix, dbo.AccountPreferences.ShowAdditionalTaskInformationType, 
                      dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, 
                      ISNULL(dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, 1) AS InitialDayOfTheMonth, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, 1) 
                      AS SystemInitialDayOfFirstPeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod, 16) AS SystemInitialDayOfLastPeriod, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountPreferences.TimesheetPrintFooter, dbo.AccountPreferences.ExpenseSheetPrintFooter, 
                      dbo.AccountPreferences.ShowCompletedProjectsInTimeSheet, dbo.AccountPreferences.ShowProjectForTimeOff, dbo.AccountPreferences.ShowTimeOffInTimesheet, 
                      dbo.AccountEmployee.IsDeleted, dbo.AccountEmployee.IsForcePasswordChange, dbo.AccountEmployee.PasswordChangedDate, 
                      dbo.AccountPreferences.PasswordExpiryPeriod
FROM         dbo.vueAccountTimesheetPeriodType RIGHT OUTER JOIN
                      dbo.AccountWorkingDayType ON 
                      dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId = dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId RIGHT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.Account ON dbo.AccountEmployee.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId ON 
                      dbo.AccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployee.AccountId = dbo.AccountPreferences.AccountId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId'

GO
-- Create View vueAccountEmployeeTimeOffForReport
Print 'Create View vueAccountEmployeeTimeOffForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOffForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeOffForReport
AS
SELECT     CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, dbo.AccountEmployee.EMailAddress, dbo.AccountEmployee.AccountDepartmentId, 
                      dbo.AccountEmployee.AccountRoleId, dbo.AccountEmployee.AccountLocationId, dbo.AccountEmployeeTimeOff.AccountEmployeeTimeOffId, 
                      dbo.AccountEmployeeTimeOff.AccountEmployeeId, dbo.AccountEmployeeTimeOff.AccountId, dbo.AccountEmployeeTimeOff.AccountTimeOffTypeId, 
                      ISNULL(dbo.AccountEmployeeTimeOff.Earned, 0) AS Earned, ISNULL(dbo.AccountEmployeeTimeOff.Consume, 0) AS Consume, 
                      ISNULL(dbo.AccountEmployeeTimeOff.Available, 0) AS Available, dbo.AccountEmployeeTimeOff.LastEarnedDate, dbo.AccountEmployeeTimeOff.CreatedByEmployeeId, 
                      dbo.AccountEmployeeTimeOff.CreatedOn, dbo.AccountEmployeeTimeOff.ModifiedByEmployeeId, dbo.AccountEmployeeTimeOff.ModifiedOn, 
                      ISNULL(dbo.AccountEmployeeTimeOff.CarryForward, 0) AS CarryForward, dbo.AccountEmployeeTimeOff.AccountTimeOffPolicyId, 
                      dbo.AccountTimeOffType.AccountTimeOffType, dbo.AccountTimeOffType.IsTimeOffRequestRequired, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountDepartment.DepartmentCode, dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountTimeOffPolicy.AccountTimeOffPolicy, 
                      dbo.AccountEmployee.EmployeeCode
FROM         dbo.AccountEmployee INNER JOIN
                      dbo.AccountEmployeeTimeOff ON dbo.AccountEmployee.AccountEmployeeId = dbo.AccountEmployeeTimeOff.AccountEmployeeId INNER JOIN
                      dbo.AccountTimeOffType ON dbo.AccountEmployeeTimeOff.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId INNER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId INNER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId INNER JOIN
                      dbo.AccountTimeOffPolicy ON dbo.AccountEmployeeTimeOff.AccountTimeOffPolicyId = dbo.AccountTimeOffPolicy.AccountTimeOffPolicyId'

GO
-- Create View vueAccountEmployeeTimeOffRequestWithTimeEntryReport
Print 'Create View vueAccountEmployeeTimeOffRequestWithTimeEntryReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOffRequestWithTimeEntryReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeOffRequestWithTimeEntryReport
AS
SELECT     dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, dbo.AccountEmployeeTimeEntry.AccountEmployeeId, dbo.AccountEmployeeTimeEntry.TimeEntryDate, 
                      dbo.AccountEmployeeTimeEntry.StartTime, dbo.AccountEmployeeTimeEntry.EndTime, dbo.AccountEmployeeTimeEntry.TotalTime, 
                      dbo.AccountEmployeeTimeEntry.Description, dbo.AccountEmployeeTimeEntry.Approved, dbo.AccountEmployeeTimeEntry.CreatedOn, 
                      dbo.AccountEmployeeTimeEntry.Submitted, dbo.AccountEmployeeTimeEntry.ModifiedOn, dbo.AccountEmployeeTimeEntry.Rejected, 
                      dbo.AccountEmployeeTimeEntry.IsTimeOff, dbo.AccountEmployeeTimeEntry.Hours, dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeOffRequestId, dbo.AccountTimeOffType.AccountTimeOffType, 
                      dbo.AccountTimeOffType.IsTimeOffRequestRequired, dbo.AccountTimeOffType.AccountId, 
                      CASE WHEN AccountEmployee_1.IsDisabled = 1 THEN AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee_1.FirstName
                       + '' '' + AccountEmployee_1.LastName END AS EmployeeName, AccountEmployee_1.EMailAddress, dbo.AccountDepartment.DepartmentCode, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountLocation.AccountLocation, AccountEmployee_1.EmployeeCode, 
                      dbo.AccountTimeOffPolicy.AccountTimeOffPolicy, dbo.AccountTimeOffPolicy.AccountTimeOffPolicyId, dbo.AccountLocation.AccountLocationId, 
                      dbo.AccountDepartment.AccountDepartmentId, dbo.AccountRole.AccountRoleId, dbo.AccountEmployeeTimeEntry.AccountProjectId, dbo.AccountProject.ProjectName, 
                      ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) 
                      AS TotalHours
FROM         dbo.AccountTimeOffType RIGHT OUTER JOIN
                      dbo.AccountDepartment RIGHT OUTER JOIN
                      dbo.AccountEmployeeTimeEntry LEFT OUTER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON dbo.AccountEmployeeTimeEntry.AccountEmployeeId = AccountEmployee_1.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountRole ON AccountEmployee_1.AccountRoleId = dbo.AccountRole.AccountRoleId LEFT OUTER JOIN
                      dbo.AccountLocation ON AccountEmployee_1.AccountLocationId = dbo.AccountLocation.AccountLocationId ON 
                      dbo.AccountDepartment.AccountDepartmentId = AccountEmployee_1.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountTimeOffPolicy ON AccountEmployee_1.AccountTimeOffPolicyId = dbo.AccountTimeOffPolicy.AccountTimeOffPolicyId ON 
                      dbo.AccountTimeOffType.AccountTimeOffTypeId = dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId
WHERE     (dbo.AccountEmployeeTimeEntry.IsTimeOff = 1)'

GO
-- Create View vueAccountEmployeeTimeOffRequestForReport
Print 'Create View vueAccountEmployeeTimeOffRequestForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOffRequestForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeOffRequestForReport
AS
SELECT     dbo.AccountEmployeeTimeOffRequest.AccountEmployeeTimeOffRequestId, dbo.AccountEmployeeTimeOffRequest.AccountTimeOffTypeId, 
                      dbo.AccountEmployeeTimeOffRequest.AccountEmployeeId, dbo.AccountEmployeeTimeOffRequest.RequestSubmitDate, 
                      dbo.AccountEmployeeTimeOffRequest.HoursOff, dbo.AccountEmployeeTimeOffRequest.StartDate, dbo.AccountEmployeeTimeOffRequest.EndDate, 
                      dbo.AccountEmployeeTimeOffRequest.InApproval, dbo.AccountEmployeeTimeOffRequest.Approved, dbo.AccountEmployeeTimeOffRequest.Rejected, 
                      dbo.AccountEmployeeTimeOffRequest.Description, dbo.AccountEmployeeTimeOffRequest.ApprovedOn, dbo.AccountEmployeeTimeOffRequest.ApprovedBy, 
                      dbo.AccountEmployeeTimeOffRequest.DayOff, dbo.AccountEmployeeTimeOffRequest.CreatedByEmployee, dbo.AccountEmployeeTimeOffRequest.CreatedOn, 
                      dbo.AccountEmployeeTimeOffRequest.ModifiedByEmployeeId, dbo.AccountEmployeeTimeOffRequest.ModifiedOn, dbo.AccountEmployeeTimeOffRequest.AccountId, 
                      dbo.AccountEmployeeTimeOffRequest.AccountProjectId, dbo.AccountTimeOffType.AccountTimeOffType, dbo.AccountTimeOffType.IsTimeOffRequestRequired, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, dbo.AccountLocation.AccountLocation, dbo.AccountLocation.AccountLocationId, 
                      dbo.AccountTimeOffPolicy.AccountTimeOffPolicy, dbo.AccountDepartment.AccountDepartmentId, dbo.AccountDepartment.DepartmentCode, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.AccountRoleId, dbo.AccountRole.Role, 
                      AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName AS ApprovedByEmployeeName, dbo.AccountProject.ProjectName, 
                      dbo.AccountProject.ProjectDescription, CASE WHEN rejected = 0 THEN CONVERT(bit, 1) ELSE CONVERT(bit, 0) END AS Submitted, 
                      dbo.AccountTimeOffPolicy.AccountTimeOffPolicyId
FROM         dbo.AccountLocation RIGHT OUTER JOIN
                      dbo.AccountTimeOffPolicy RIGHT OUTER JOIN
                      dbo.AccountRole RIGHT OUTER JOIN
                      dbo.AccountEmployeeTimeOffRequest LEFT OUTER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeOffRequest.AccountProjectId = dbo.AccountProject.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeOffRequest.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON dbo.AccountEmployeeTimeOffRequest.ApprovedBy = AccountEmployee_1.AccountEmployeeId ON 
                      dbo.AccountRole.AccountRoleId = dbo.AccountEmployee.AccountRoleId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId ON 
                      dbo.AccountTimeOffPolicy.AccountTimeOffPolicyId = dbo.AccountEmployee.AccountTimeOffPolicyId ON 
                      dbo.AccountLocation.AccountLocationId = dbo.AccountEmployee.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountTimeOffType ON dbo.AccountEmployeeTimeOffRequest.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId'

GO
-- Create View vueAccountEmployeesForReport
Print 'Create View vueAccountEmployeesForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeesForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeesForReport
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.Password, dbo.AccountEmployee.Prefix, dbo.AccountEmployee.FirstName, 
                      dbo.AccountEmployee.LastName, ISNULL(dbo.AccountEmployee.MiddleName, N'''') AS MiddleName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountEmployee.AccountId, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountRoleId, dbo.AccountEmployee.AccountLocationId, 
                      ISNULL(dbo.AccountEmployee.Notes, N'''') AS Notes, ISNULL(dbo.AccountEmployee.AddressLine1, N'''') AS AddressLine1, ISNULL(dbo.AccountEmployee.AddressLine2, 
                      N'''') AS AddressLine2, ISNULL(dbo.AccountEmployee.State, N'''') AS State, ISNULL(dbo.AccountEmployee.City, N'''') AS City, ISNULL(dbo.AccountEmployee.Zip, N'''') 
                      AS Zip, dbo.AccountEmployee.CountryId, ISNULL(dbo.AccountEmployee.HomePhoneNo, N'''') AS HomePhoneNo, ISNULL(dbo.AccountEmployee.WorkPhoneNo, N'''') 
                      AS WorkPhoneNo, ISNULL(dbo.AccountEmployee.MobilePhoneNo, N'''') AS MobilePhoneNo, dbo.AccountEmployee.TimeEntryApprovalPathId, 
                      dbo.AccountEmployee.BillingRateStateDate, dbo.AccountEmployee.BillingTypeId, dbo.AccountEmployee.StartDate, dbo.AccountEmployee.TerminationDate, 
                      dbo.AccountEmployee.StatusId, dbo.AccountEmployee.IsDeleted, dbo.AccountEmployee.IsDisabled, dbo.AccountEmployee.DefaultProjectId, 
                      dbo.AccountEmployee.TimeZoneId, dbo.AccountEmployee.DefaultEmployee, dbo.AccountEmployee.CreatedOn, dbo.AccountEmployee.CreatedByEmployeeId, 
                      dbo.AccountEmployee.ModifiedOn, dbo.AccountEmployee.ModifiedByEmployeeId, dbo.AccountEmployee.AllowedAccessFromIP, 
                      dbo.AccountEmployee.ExternalUserClientId, dbo.AccountEmployee.EmployeeTypeId, dbo.AccountEmployee.AccountBillingRateId, dbo.AccountEmployee.Username, 
                      ISNULL(dbo.AccountEmployee.EmployeeCode, N'''') AS EmployeeCode, dbo.AccountEmployee.EmployeeManagerId, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, ISNULL(dbo.AccountDepartment.DepartmentCode, N'''') AS DepartmentCode, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountLocation.AccountLocation, ISNULL(dbo.SystemCountry.Country, N'''') AS Country, 
                      ISNULL(AccountEmployee_1.FirstName + N'' '' + AccountEmployee_1.LastName, N'''') AS EmployeeManager, 
                      ISNULL(dbo.vueAccountWorkTypeBillingRate.AccountWorkTypeCode, N'''') AS AccountWorkTypeCode, ISNULL(dbo.vueAccountWorkTypeBillingRate.AccountWorkType, 
                      N'''') AS AccountWorkType, ISNULL(dbo.vueAccountWorkTypeBillingRate.BillingRate, 0) AS BillingRate, ISNULL(dbo.vueAccountWorkTypeBillingRate.EmployeeRate, 0) 
                      AS EmployeeRate, dbo.vueAccountWorkTypeBillingRate.EmployeeRateCurrencyCode, dbo.vueAccountWorkTypeBillingRate.BillingRateCurrencyCode, 
                      dbo.AccountEmployee.HiredDate, ISNULL(dbo.AccountStatus.Status, N'''') AS EmployeeStatus, ISNULL(dbo.AccountEmployeeType.AccountEmployeeType, N'''') 
                      AS EmployeeType
FROM         dbo.AccountEmployee INNER JOIN
                      dbo.Account ON dbo.AccountEmployee.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId AND 
                      dbo.Account.AccountId = dbo.AccountDepartment.AccountId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId AND dbo.Account.AccountId = dbo.AccountRole.AccountId INNER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId AND 
                      dbo.Account.AccountId = dbo.AccountLocation.AccountId INNER JOIN
                      dbo.SystemCountry ON dbo.AccountEmployee.CountryId = dbo.SystemCountry.CountryId LEFT OUTER JOIN
                      dbo.AccountEmployeeType ON dbo.AccountEmployee.EmployeePayTypeId = dbo.AccountEmployeeType.AccountEmployeeTypeId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON dbo.Account.AccountId = AccountEmployee_1.AccountId AND 
                      dbo.AccountEmployee.EmployeeManagerId = AccountEmployee_1.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountStatus ON dbo.AccountEmployee.StatusId = dbo.AccountStatus.AccountStatusId AND 
                      dbo.Account.AccountId = dbo.AccountStatus.AccountId LEFT OUTER JOIN
                      dbo.vueAccountWorkTypeBillingRate ON dbo.Account.AccountId = dbo.vueAccountWorkTypeBillingRate.AccountId AND 
                      dbo.AccountEmployee.AccountEmployeeId = dbo.vueAccountWorkTypeBillingRate.AccountEmployeeId
WHERE     (dbo.AccountEmployee.EmployeeTypeId IS NULL)'

GO
-- Create View vueAccountEmployeeTimeEntryApprovalForReport
Print 'Create View vueAccountEmployeeTimeEntryApprovalForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryApprovalForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryApprovalForReport
AS
SELECT     dbo.AccountEmployeeTimeEntryApproval.TimeSheetApprovalId, dbo.AccountEmployeeTimeEntryApproval.AccountEmployeeTimeEntryId, 
                      dbo.AccountEmployeeTimeEntryApproval.TimeSheetApprovalTypeId, dbo.AccountEmployeeTimeEntryApproval.TimeSheetApprovalPathId, 
                      dbo.AccountEmployeeTimeEntryApproval.ApprovedByEmployeeId, dbo.AccountEmployeeTimeEntryApproval.ApprovedOn, 
                      dbo.AccountEmployeeTimeEntryApproval.Comments, dbo.AccountEmployeeTimeEntryApproval.IsReject, dbo.AccountEmployeeTimeEntryApproval.IsApproved, 
                      dbo.AccountEmployeeTimeEntryApproval.AccountEmployeeTimeEntryPeriodId, dbo.AccountEmployeeTimeEntryApproval.PreviousStatus, 
                      dbo.AccountEmployeeTimeEntryApproval.BatchId, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, dbo.AccountEmployee.EMailAddress, dbo.AccountEmployee.AccountId, dbo.AccountProject.ProjectName, 
                      dbo.AccountEmployeeTimeEntry.AccountProjectId, dbo.AccountProject.AccountClientId, dbo.AccountParty.PartyName, dbo.AccountParty.PartyNick, 
                      AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName AS ApprovalEmployeeName, dbo.AccountEmployeeTimeEntry.AccountEmployeeId
FROM         dbo.AccountEmployee AS AccountEmployee_1 INNER JOIN
                      dbo.AccountEmployeeTimeEntryApproval ON 
                      AccountEmployee_1.AccountEmployeeId = dbo.AccountEmployeeTimeEntryApproval.ApprovedByEmployeeId LEFT OUTER JOIN
                      dbo.AccountProject INNER JOIN
                      dbo.AccountEmployeeTimeEntry ON dbo.AccountProject.AccountProjectId = dbo.AccountEmployeeTimeEntry.AccountProjectId INNER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeEntry.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId ON 
                      dbo.AccountEmployeeTimeEntryApproval.AccountEmployeeTimeEntryId = dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId'

GO

-- Add Column IsVendor to AccountEmployeeType
Print 'Add Column IsVendor to AccountEmployeeType'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='IsVendor' AND TABLE_NAME='AccountEmployeeType'))
ALTER TABLE [dbo].[AccountEmployeeType]
	ADD [IsVendor] bit NULL


GO
-- Add Column IsVendor to MasterEmployeeType
Print 'Add Column IsVendor to MasterEmployeeType'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'MasterEmployeeType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='IsVendor' AND TABLE_NAME='MasterEmployeeType'))
ALTER TABLE [dbo].[MasterEmployeeType]
	ADD [IsVendor] bit NULL

GO
If exists(Select * from SystemData where version = '3.7.5')

BEGIN
--Update MasterEMployeeType and AccountEmployeeType
UPDATE [dbo].[MasterEmployeeType] SET [IsVendor]=1 WHERE [MasterEmployeeTypeId]='1c681477-2896-484c-a581-26d3671bf78e'
UPDATE [dbo].[MasterEmployeeType] SET [IsVendor]=1 WHERE [MasterEmployeeTypeId]='116e529e-5416-4800-b651-4b2016df3d02'
UPDATE [dbo].[AccountEmployeeType] SET [IsVendor]=1 WHERE [MasterEmployeeTypeId]='1c681477-2896-484c-a581-26d3671bf78e'
UPDATE [dbo].[AccountEmployeeType] SET [IsVendor]=1 WHERE [MasterEmployeeTypeId]='116e529e-5416-4800-b651-4b2016df3d02'
END

GO
Update SystemData Set Version = '3.8.5' Where Version = '3.7.5' And SystemDataId = 1
GO
--End 3.8
--Start 3.9
-- Drop View vueAccountEmployeeProject
Print 'Drop View vueAccountEmployeeProject'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeProject' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeProject]
GO
-- Create View vueAccountEmployeeProject
Print 'Create View vueAccountEmployeeProject'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeProject' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeProject
AS
SELECT     dbo.AccountProject.AccountProjectId, dbo.AccountProject.AccountId, dbo.AccountProject.ProjectName, dbo.AccountProjectEmployee.AccountProjectEmployeeId, 
                      dbo.AccountEmployee.AccountEmployeeId, dbo.AccountProject.IsDisabled, dbo.AccountProject.IsDeleted
FROM         dbo.AccountProject INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountProject.AccountId = dbo.AccountEmployee.AccountId LEFT OUTER JOIN
                      dbo.AccountProjectEmployee ON dbo.AccountProject.AccountProjectId = dbo.AccountProjectEmployee.AccountProjectId AND 
                      dbo.AccountProject.AccountId = dbo.AccountProjectEmployee.AccountId AND 
                      dbo.AccountEmployee.AccountEmployeeId = dbo.AccountProjectEmployee.AccountEmployeeId'
GO
-- Drop View vueAccountProjectTaskWithParentForQB
Print 'Drop View vueAccountProjectTaskWithParentForQB'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountProjectTaskWithParentForQB' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountProjectTaskWithParentForQB]
GO
-- Drop View vueAccountProjectTaskForQB
Print 'Drop View vueAccountProjectTaskForQB'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountProjectTaskForQB' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountProjectTaskForQB]
GO
-- Drop View vueAccountExpenseEntryForQB
Print 'Drop View vueAccountExpenseEntryForQB'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryForQB' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountExpenseEntryForQB]
GO
-- Drop View vueAccountEmployeeForQB
Print 'Drop View vueAccountEmployeeForQB'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeForQB' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeForQB]
GO
-- Drop View vueAccountEmployeeTimeEntryForQB
Print 'Drop View vueAccountEmployeeTimeEntryForQB'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryForQB' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryForQB]
GO
-- Create View vueAccountProjectTaskWithParentForQB
Print 'Create View vueAccountProjectTaskWithParentForQB'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountProjectTaskWithParentForQB' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountProjectTaskWithParentForQB
AS
WITH tree AS (SELECT     AccountProjectId, AccountProjectTaskId, ParentAccountProjectTaskId, LEFT(CONVERT(nvarchar(MAX), TaskName), 31) AS Parents, 
                                                      0 AS TableId
                               FROM         dbo.AccountProjectTask AS t
                               UNION ALL
                               SELECT     t.AccountProjectId, t.AccountProjectTaskId, t.ParentAccountProjectTaskId, base.Parents + '':'' + LEFT(CONVERT(nvarchar(MAX), 
                                                     t.TaskName), 31) AS Expr1, 1 AS TableId
                               FROM         tree AS base INNER JOIN
                                                     dbo.AccountProjectTask AS t ON t.ParentAccountProjectTaskId = base.AccountProjectTaskId)
    SELECT     TOP 100 PERCENT AccountProjectId, AccountProjectTaskId, ParentAccountProjectTaskId, MAX(Parents) AS Parents, MAX(TableId) AS TableId
     FROM         tree AS tree_1
     WHERE     (ParentAccountProjectTaskId IS NULL) OR
                            (TableId = 1)
     GROUP BY AccountProjectId, AccountProjectTaskId, ParentAccountProjectTaskId
     ORDER BY AccountProjectTaskId'
GO
-- Create View vueAccountProjectTaskForQB
Print 'Create View vueAccountProjectTaskForQB'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountProjectTaskForQB' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountProjectTaskForQB
AS
SELECT     dbo.AccountProject.AccountId, dbo.AccountProject.ProjectName, dbo.AccountProject.ProjectDescription, dbo.AccountProject.ProjectCode, 
                      CASE WHEN dbo.AccountProjectTask.ParentAccountProjectTaskId IS NULL THEN '''' ELSE Replace(vueAccountProjectTaskWithParentForQB.Parents, 
                      '':'' + LEFT(AccountProjectTask.TaskName, 31), '''') END AS ItemParent, CASE WHEN dbo.AccountProjectTask.ParentAccountProjectTaskId IS NULL 
                      THEN LEFT(PartyName, 41) + '':'' + LEFT(ProjectName, 31) ELSE LEFT(PartyName, 41) + '':'' + LEFT(ProjectName, 31) 
                      + '':'' + Replace(vueAccountProjectTaskWithParentForQB.Parents, '':'' + LEFT(AccountProjectTask.TaskName, 31), '''') END AS JobParent, 
                      LEFT(dbo.AccountProjectTask.TaskName, 31) AS TaskName, dbo.AccountProjectTask.TaskCode, dbo.AccountProject.IsTemplate, 
                      dbo.AccountProjectTask.AccountProjectTaskId, dbo.AccountParty.PartyName
FROM         dbo.AccountParty INNER JOIN
                      dbo.AccountProjectTask INNER JOIN
                      dbo.AccountProject ON dbo.AccountProjectTask.AccountProjectId = dbo.AccountProject.AccountProjectId ON 
                      dbo.AccountParty.AccountPartyId = dbo.AccountProject.AccountClientId LEFT OUTER JOIN
                      dbo.vueAccountProjectTaskWithParentForQB ON 
                      dbo.AccountProjectTask.AccountProjectTaskId = dbo.vueAccountProjectTaskWithParentForQB.AccountProjectTaskId'
GO
-- Create View vueAccountExpenseEntryForQB
Print 'Create View vueAccountExpenseEntryForQB'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryForQB' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountExpenseEntryForQB
AS
SELECT     dbo.AccountExpenseEntry.AccountExpenseEntryDate, dbo.AccountExpenseEntry.AccountId, dbo.AccountExpenseEntry.Description, 
                      dbo.AccountExpenseEntry.Amount, dbo.AccountExpenseEntry.IsBillable, dbo.AccountExpense.AccountExpenseName, 
                      dbo.AccountParty.PartyName + '':'' + dbo.AccountProject.ProjectName AS CustomerJob, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName
FROM         dbo.AccountExpenseEntry INNER JOIN
                      dbo.AccountExpense ON dbo.AccountExpenseEntry.AccountExpenseId = dbo.AccountExpense.AccountExpenseId INNER JOIN
                      dbo.AccountProject ON dbo.AccountExpenseEntry.AccountProjectId = dbo.AccountProject.AccountProjectId INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountExpenseEntry.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId INNER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId'
GO
-- Create View vueAccountEmployeeForQB
Print 'Create View vueAccountEmployeeForQB'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeForQB' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeForQB
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.Password, dbo.AccountEmployee.Prefix, dbo.AccountEmployee.FirstName, 
                      dbo.AccountEmployee.LastName, dbo.AccountEmployee.MiddleName, dbo.AccountEmployee.EMailAddress, dbo.AccountEmployee.AccountId, 
                      dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountRoleId, dbo.AccountEmployee.AccountLocationId, 
                      dbo.AccountEmployee.Notes, dbo.AccountEmployee.AddressLine1, dbo.AccountEmployee.AddressLine2, dbo.AccountEmployee.State, 
                      dbo.AccountEmployee.City, dbo.AccountEmployee.Zip, dbo.AccountEmployee.CountryId, dbo.AccountEmployee.HomePhoneNo, 
                      dbo.AccountEmployee.WorkPhoneNo, dbo.AccountEmployee.MobilePhoneNo, dbo.AccountEmployee.TimeEntryApprovalPathId, 
                      dbo.AccountEmployee.BillingRateStateDate, dbo.AccountEmployee.BillingTypeId, dbo.AccountEmployee.StartDate, 
                      dbo.AccountEmployee.TerminationDate, dbo.AccountEmployee.StatusId, dbo.AccountEmployee.IsDeleted, dbo.AccountEmployee.IsDisabled, 
                      dbo.AccountEmployee.DefaultProjectId, dbo.AccountEmployee.TimeZoneId, dbo.AccountEmployee.DefaultEmployee, dbo.AccountEmployee.CreatedOn, 
                      dbo.AccountEmployee.CreatedByEmployeeId, dbo.AccountEmployee.ModifiedOn, dbo.AccountEmployee.ModifiedByEmployeeId, 
                      dbo.AccountEmployee.AllowedAccessFromIP, dbo.AccountEmployee.ExternalUserClientId, dbo.AccountEmployee.EmployeeTypeId, 
                      dbo.AccountEmployee.AccountBillingRateId, dbo.AccountEmployee.Username, dbo.AccountEmployee.EmployeeCode, 
                      dbo.AccountEmployee.EmployeeManagerId, dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.EmployeePayTypeId, 
                      dbo.AccountEmployee.HiredDate, dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountEmployee.LastScheduledEmailSentTime, 
                      dbo.AccountEmployee.AccountTimeOffPolicyId, dbo.AccountEmployee.TimeOffApprovalTypeId, 
                      dbo.AccountEmployee.LastTimeOffCalculationScheduledTime, dbo.AccountEmployee.InitialPolicy, dbo.AccountEmployee.AccountHolidayTypeId, 
                      dbo.AccountEmployee.IsEmailSend, dbo.AccountEmployee.IsForcePasswordChange, dbo.AccountEmployee.PasswordChangedDate, 
                      dbo.AccountEmployeeType.IsVendor, dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS FullName
FROM         dbo.AccountEmployee INNER JOIN
                      dbo.AccountEmployeeType ON dbo.AccountEmployee.EmployeePayTypeId = dbo.AccountEmployeeType.AccountEmployeeTypeId'
GO
-- Create View vueAccountEmployeeTimeEntryForQB
Print 'Create View vueAccountEmployeeTimeEntryForQB'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryForQB' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryForQB
AS
SELECT     dbo.AccountEmployeeTimeEntry.TimeEntryDate, dbo.AccountEmployeeTimeEntry.TotalTime, dbo.AccountEmployeeTimeEntry.Description, 
                      dbo.AccountProject.ProjectName, dbo.AccountProject.ProjectDescription, dbo.AccountProject.ProjectCode, dbo.AccountProject.IsDisabled, 
                      dbo.AccountProject.IsTemplate, dbo.AccountProject.IsProject, dbo.AccountProject.IsDeleted, dbo.AccountProjectTask.TaskName, 
                      dbo.AccountProjectTask.TaskDescription, dbo.AccountProjectTask.IsParentTask, dbo.AccountProjectTask.IsBillable, dbo.AccountProjectTask.TaskCode, 
                      LEFT(dbo.AccountParty.PartyName, 41) AS PartyName, dbo.AccountParty.PartyNick, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountEmployee.AccountId, 
                      dbo.AccountEmployee.EmployeeCode, dbo.vueAccountProjectTaskWithParentForQB.Parents AS ServiceItemName
FROM         dbo.AccountEmployeeTimeEntry INNER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId INNER JOIN
                      dbo.AccountProjectTask ON dbo.AccountEmployeeTimeEntry.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId AND 
                      dbo.AccountProject.AccountProjectId = dbo.AccountProjectTask.AccountProjectId INNER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeEntry.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId INNER JOIN
                      dbo.vueAccountProjectTaskWithParentForQB ON 
                      dbo.AccountProjectTask.AccountProjectTaskId = dbo.vueAccountProjectTaskWithParentForQB.AccountProjectTaskId'

GO

-- Drop View vueAccountProjectEmployeFullJoin
Print 'Drop View vueAccountProjectEmployeFullJoin'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountProjectEmployeFullJoin' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountProjectEmployeFullJoin]

GO
-- Create View vueAccountProjectEmployeFullJoin
Print 'Create View vueAccountProjectEmployeFullJoin'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountProjectEmployeFullJoin' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountProjectEmployeFullJoin
AS
SELECT     dbo.AccountProject.AccountProjectId, dbo.AccountProject.ProjectName, dbo.AccountEmployee.Password, dbo.AccountEmployee.FirstName, 
                      dbo.AccountEmployee.LastName, dbo.AccountEmployee.AccountEmployeeId, dbo.AccountProjectEmployee.AccountProjectEmployeeId, 
                      dbo.AccountEmployee.AccountId, dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS FullName, dbo.AccountProject.LeaderEmployeeId, 
                      dbo.AccountProject.ProjectManagerEmployeeId, dbo.AccountEmployee.EMailAddress, dbo.AccountEmployee.IsDisabled, dbo.AccountEmployee.IsDeleted
FROM         dbo.AccountProject INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountProject.AccountId = dbo.AccountEmployee.AccountId INNER JOIN
                      dbo.AccountProjectEmployee ON dbo.AccountProject.AccountProjectId = dbo.AccountProjectEmployee.AccountProjectId AND 
                      dbo.AccountEmployee.AccountEmployeeId = dbo.AccountProjectEmployee.AccountEmployeeId'

GO
IF NOT EXISTS (SELECT * FROM [dbo].[SystemSecurityCategoryPage] WHERE [SystemSecurityCategoryPageId] = 152)
BEGIN

-- =======================================================
-- Foreign Key Constraint Nochecks's for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print ' Foreign Key Constraint Nochecks''s for Table: [dbo].[SystemSecurityCategoryPage]'

ALTER TABLE [dbo].[SystemSecurityCategoryPage] NOCHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory]
ALTER TABLE [dbo].[SystemSecurityCategoryPage] NOCHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory1]

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemSecurityCategoryPage]'

INSERT INTO [dbo].[SystemSecurityCategoryPage] ([SystemSecurityCategoryPageId], [SystemSecurityCategoryId], [SequenceNumber], [Folder], [SystemCategoryPage], [SystemCategoryPageDescription], [ParentSystemSecurityCateogoryPageId], [IsSiteMapPage], [IsCustomizeable], [IsAllowAdd], [IsAllowEdit], [IsAllowDelete], [IsAllowList], [IsShowDataOptions], [IsShowTillOptions], [IsSystemPage], [ControlLevelPermission], [NotShowInPermission], [NotShowInStartupPage], [SystemFeatureId]) VALUES (152, 2, N'218544566', N'Employee', 'AccountEmployeeProject.aspx', 'Employee Project', 4, 1, 1, NULL, 1, NULL, 1, NULL, NULL, NULL, NULL, NULL, NULL, NULL)

-- =======================================================
-- Foreign Key Constraint Check's for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print ' Foreign Key Constraint Check''s for Table: [dbo].[SystemSecurityCategoryPage]'

ALTER TABLE [dbo].[SystemSecurityCategoryPage] CHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory]
ALTER TABLE [dbo].[SystemSecurityCategoryPage] CHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory1]

END
GO
-- Drop Procedure sp_UpdateTimeEntry
Print 'Drop Procedure sp_UpdateTimeEntry'
GO
IF EXISTS(SELECT * FROM sysobjects WHERE name = 'sp_UpdateTimeEntry' AND type = 'P')
DROP PROCEDURE [dbo].[sp_UpdateTimeEntry]

-- Create Procedure sp_UpdateTimeEntry
Print 'Create Procedure sp_UpdateTimeEntry'
GO
IF NOT (EXISTS(SELECT * FROM sysobjects WHERE id = OBJECT_ID(N'[dbo].[sp_UpdateTimeEntry]') AND [type]='P'))
EXEC sp_executesql N'
CREATE PROCEDURE [dbo].[sp_UpdateTimeEntry]
		   (@AccountEmployeeId int,
           @TimeEntryDate datetime,
           @StartTime datetime,
           @EndTime datetime,
           @TotalTime datetime,
           @AccountProjectId int,
           @AccountProjectTaskId bigint,
           @Description nvarchar(1000),
           @Approved bit,
           @Rejected bit,
           @BillingRate money,
           @Submitted bit,
           @AccountWorkTypeId int,
           @EmployeeRate money,
           @AccountCostCenterId int,
           @BillingRateCurrencyId int,
           @EmployeeRateCurrencyId int,
           @BillingRateExchangeRate float,
           @EmployeeRateExchangeRate float,
           @AccountBaseCurrencyId int,
           @AccountEmployeeTimeEntryPeriodId uniqueidentifier,
           @AccountEmployeeTimeEntryApprovalProjectId uniqueidentifier,
           @ModifiedByEmployeeId int,
           @IsTimeOff bit,
           @AccountTimeOffTypeId uniqueidentifier,
		   @AccountEmployeeTimeEntryId int)
AS 
BEGIN
UPDATE AccountEmployeeTimeEntry
   SET [AccountEmployeeId] = @AccountEmployeeId
      ,[TimeEntryDate] = @TimeEntryDate
      ,[StartTime] = @StartTime
      ,[EndTime] = @EndTime
      ,[TotalTime] = @TotalTime
      ,[AccountProjectId] = @AccountProjectId
      ,[AccountProjectTaskId] = @AccountProjectTaskId
      ,[Description] = @Description
      ,[Approved] = @Approved
      ,[Rejected] = @Rejected
      ,[BillingRate] = @BillingRate
      ,[Submitted] = @Submitted
      ,[AccountWorkTypeId] = @AccountWorkTypeId
      ,[EmployeeRate] = @EmployeeRate
      ,[AccountCostCenterId] = @AccountCostCenterId
      ,[BillingRateCurrencyId] = @BillingRateCurrencyId
      ,[EmployeeRateCurrencyId] = @EmployeeRateCurrencyId
      ,[BillingRateExchangeRate] = @BillingRateExchangeRate
      ,[EmployeeRateExchangeRate] = @EmployeeRateExchangeRate
      ,[AccountBaseCurrencyId] = @AccountBaseCurrencyId
      ,[AccountEmployeeTimeEntryPeriodId] = @AccountEmployeeTimeEntryPeriodId
      ,[AccountEmployeeTimeEntryApprovalProjectId] = @AccountEmployeeTimeEntryApprovalProjectId
      ,[ModifiedByEmployeeId] = @ModifiedByEmployeeId
      ,[IsTimeOff] = @IsTimeOff
      ,[AccountTimeOffTypeId] = @AccountTimeOffTypeId
 WHERE [AccountEmployeeTimeEntryId] = @AccountEmployeeTimeEntryId
END'
GO
-- Drop Trigger AuditTriggerAccountEmployeeTimeEntry
Print 'Drop Trigger AuditTriggerAccountEmployeeTimeEntry'
GO
IF (EXISTS(SELECT * FROM sysobjects WHERE id = OBJECT_ID(N'[dbo].[AuditTriggerAccountEmployeeTimeEntry]') AND [type]='TR'))
DROP TRIGGER [dbo].[AuditTriggerAccountEmployeeTimeEntry]
GO
-- Create Trigger AuditTriggerAccountEmployeeTimeEntry
Print 'Create Trigger AuditTriggerAccountEmployeeTimeEntry'
GO
IF NOT (EXISTS(SELECT * FROM sysobjects WHERE id = OBJECT_ID(N'[dbo].[AuditTriggerAccountEmployeeTimeEntry]') AND [type]='TR'))
EXEC sp_executesql N'
CREATE trigger [AuditTriggerAccountEmployeeTimeEntry] on [dbo].[AccountEmployeeTimeEntry] for update, delete
as
declare @bit int ,
	@field int ,
	@maxfield int ,
	@char int ,
	@fieldname nvarchar(256) ,
	@TableName nvarchar(256) ,
	@sql nvarchar(4000), 
	@UpdateDate nvarchar(42) ,
	@UserName nvarchar(256) ,
	@Type nchar(1)
	select @TableName = ''AccountEmployeeTimeEntry''
	-- date and user
	select 	@UserName = 0 ,
		@UpdateDate = convert(nvarchar(16), getdate(), 112) + '' '' + convert(nvarchar(16), getdate(), 114)
	-- Action
	if exists (select * from inserted)
		if exists (select * from deleted)
			Begin
				select @Type = ''U''
				select @UserName  = ModifiedByEmployeeId from inserted
			End 
	-- get list of columns
	select * into #ins from inserted
	select * into #del from deleted
	select @field = 0, @maxfield = max(ORDINAL_POSITION) from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME = @TableName
	while @field < @maxfield
	begin
		select @field = min(ORDINAL_POSITION) from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME = @TableName and ORDINAL_POSITION > @field
		select @bit = (@field - 1 )% 8 + 1
		select @bit = power(2,@bit - 1)
		select @char = ((@field - 1) / 8) + 1
		if substring(COLUMNS_UPDATED(),@char, 1) & @bit > 0 or @Type in (''I'',''D'')
		begin
			select @fieldname = COLUMN_NAME from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME = @TableName and ORDINAL_POSITION = @field
			select @sql = 		''insert Audit (Type, TableName, PK, FieldName, OldValue, NewValue, UpdateDate, UserName)''
			select @sql = @sql + 	'' select '''''' + @Type + ''''''''
			select @sql = @sql + 	'','''''' + @TableName + ''''''''
			select @sql = @sql + 	'','' + '''''''''''' + ''+convert(nvarchar(200),coalesce(i.AccountEmployeeTimeEntryId,d.AccountEmployeeTimeEntryId))+'' + ''''''''''''
			select @sql = @sql + 	'','''''' + @fieldname + ''''''''
			select @sql = @sql + 	'',convert(nvarchar(2000),d.'' + @fieldname + '')''
			select @sql = @sql + 	'',convert(nvarchar(2000),i.'' + @fieldname + '')''
			select @sql = @sql + 	'','''''' + @UpdateDate + ''''''''
			select @sql = @sql + 	'','''''' + @UserName + ''''''''
			select @sql = @sql + 	'' from #ins i full outer join #del d''
			select @sql = @sql + 	'' on i.AccountEmployeeTimeEntryId = d.AccountEmployeeTimeEntryId''
			select @sql = @sql + 	'' where i.'' + @fieldname + '' <> d.'' + @fieldname 
			select @sql = @sql + 	'' or (i.'' + @fieldname + '' is null and  d.'' + @fieldname + '' is not null)'' 
			select @sql = @sql + 	'' or (i.'' + @fieldname + '' is not null and  d.'' + @fieldname + '' is null)'' 
			exec (@sql)
		end
	end'

GO

-- Drop View vueAccountEmployee
Print 'Drop View vueAccountEmployee'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployee]
GO

-- Add Column ShowAllInTimesheetReadOnly to AccountPreferences
Print 'Add Column ShowAllInTimesheetReadOnly to AccountPreferences'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountPreferences' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='ShowAllInTimesheetReadOnly' AND TABLE_NAME='AccountPreferences'))
ALTER TABLE [dbo].[AccountPreferences]
	ADD [ShowAllInTimesheetReadOnly] bit NULL

GO
-- Create View vueAccountEmployee
Print 'Create View vueAccountEmployee'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployee
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountEmployee.AccountId, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.Password, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountLocationId, dbo.AccountEmployee.BillingTypeId, 
                      dbo.AccountBillingType.BillingType, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, dbo.AccountPreferences.ShowClockStartEnd, dbo.Account.TimeZoneId, 
                      dbo.AccountRole.MasterAccountRoleId, dbo.Account.DefaultCurrencyId, dbo.Account.CountryId, dbo.AccountPreferences.CultureInfoName, 
                      dbo.AccountPreferences.TimeEntryFormat, dbo.AccountEmployee.AllowedAccessFromIP, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountPreferences.AccountSessionTimeout, dbo.AccountPreferences.ShowCompletedTasksInTimeSheet, dbo.AccountPreferences.CurrencySymbol, 
                      dbo.AccountPreferences.IsCompanyOwnLogo, dbo.Account.AccountExpiryActivation, dbo.Account.LicenseActivation, dbo.AccountEmployee.EmployeeTypeId, 
                      dbo.AccountEmployee.ExternalUserClientId, dbo.AccountEmployee.AccountBillingRateId, dbo.AccountPreferences.ScheduledEmailSendTime, 
                      dbo.AccountEmployee.Username, dbo.AccountEmployee.IsDisabled, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.AccountEmployee.EmployeeCode, dbo.AccountPreferences.Version, 
                      dbo.AccountPreferences.LockSubmittedRecords, dbo.AccountPreferences.LockApprovedRecords, ISNULL(dbo.AccountEmployee.EmployeeCode + '' - '', '''') 
                      + dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeNameWithCode, dbo.AccountPreferences.ShowWorkTypeInTimeSheet, 
                      dbo.AccountPreferences.NumberOfBlankRowsInTimeEntry, dbo.AccountPreferences.ShowCostCenterInTimeSheet, dbo.AccountPreferences.WeekStartDay, 
                      dbo.AccountPreferences.AccountBaseCurrencyId, dbo.AccountPreferences.UserInterfaceLanguage, dbo.AccountEmployee.EmployeeManagerId, 
                      dbo.AccountPreferences.DefaultTimeEntryMode, dbo.AccountPreferences.PageSize, dbo.AccountEmployee.TimeZoneId AS EmployeeTimeZoneId, 
                      dbo.AccountEmployee.TerminationDate, dbo.AccountEmployee.StatusId, dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.EmployeePayTypeId, 
                      dbo.AccountEmployee.HiredDate, dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountWorkingDayType, 
                      dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay AS EmployeeWeekStartDay, 
                      dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountPreferences.ShowDescriptionInWeekView, 
                      dbo.AccountPreferences.InvoiceNoPrefix, dbo.AccountPreferences.ShowAdditionalTaskInformationType, 
                      dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, 
                      ISNULL(dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, 1) AS InitialDayOfTheMonth, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, 1) 
                      AS SystemInitialDayOfFirstPeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod, 16) AS SystemInitialDayOfLastPeriod, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountPreferences.TimesheetPrintFooter, dbo.AccountPreferences.ExpenseSheetPrintFooter, 
                      dbo.AccountPreferences.ShowCompletedProjectsInTimeSheet, dbo.AccountPreferences.ShowProjectForTimeOff, dbo.AccountPreferences.ShowTimeOffInTimesheet, 
                      dbo.AccountEmployee.IsDeleted, dbo.AccountEmployee.IsForcePasswordChange, dbo.AccountEmployee.PasswordChangedDate, 
                      dbo.AccountPreferences.PasswordExpiryPeriod, dbo.AccountPreferences.ShowAllInTimesheetReadOnly
FROM         dbo.vueAccountTimesheetPeriodType RIGHT OUTER JOIN
                      dbo.AccountWorkingDayType ON 
                      dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId = dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId RIGHT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.Account ON dbo.AccountEmployee.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId ON 
                      dbo.AccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployee.AccountId = dbo.AccountPreferences.AccountId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId'

GO
-- Add Column ShowTaskInExpenseSheet to AccountPreferences
Print 'Add Column ShowTaskInExpenseSheet to AccountPreferences'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountPreferences' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='ShowTaskInExpenseSheet' AND TABLE_NAME='AccountPreferences'))
ALTER TABLE [dbo].[AccountPreferences]
	ADD [ShowTaskInExpenseSheet] bit NULL

GO
-- Add Column AccountProjectTaskId to AccountExpenseEntry
Print 'Add Column AccountProjectTaskId to AccountExpenseEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountExpenseEntry' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='AccountProjectTaskId' AND TABLE_NAME='AccountExpenseEntry'))
ALTER TABLE [dbo].[AccountExpenseEntry]
	ADD [AccountProjectTaskId] int NULL

GO
-- Drop View vueAccountEmployee
Print 'Drop View vueAccountEmployee'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployee]

GO

-- Drop View vueAccountExpenseEntryWithLastStatus
Print 'Drop View vueAccountExpenseEntryWithLastStatus'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryWithLastStatus' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountExpenseEntryWithLastStatus]

GO
-- Drop View vueAccountExpenseEntry
Print 'Drop View vueAccountExpenseEntry'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntry' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountExpenseEntry]

GO
-- Create View vueAccountEmployee
Print 'Create View vueAccountEmployee'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployee
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountEmployee.AccountId, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.Password, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountLocationId, dbo.AccountEmployee.BillingTypeId, 
                      dbo.AccountBillingType.BillingType, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, dbo.AccountPreferences.ShowClockStartEnd, dbo.Account.TimeZoneId, 
                      dbo.AccountRole.MasterAccountRoleId, dbo.Account.DefaultCurrencyId, dbo.Account.CountryId, dbo.AccountPreferences.CultureInfoName, 
                      dbo.AccountPreferences.TimeEntryFormat, dbo.AccountEmployee.AllowedAccessFromIP, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountPreferences.AccountSessionTimeout, dbo.AccountPreferences.ShowCompletedTasksInTimeSheet, dbo.AccountPreferences.CurrencySymbol, 
                      dbo.AccountPreferences.IsCompanyOwnLogo, dbo.Account.AccountExpiryActivation, dbo.Account.LicenseActivation, dbo.AccountEmployee.EmployeeTypeId, 
                      dbo.AccountEmployee.ExternalUserClientId, dbo.AccountEmployee.AccountBillingRateId, dbo.AccountPreferences.ScheduledEmailSendTime, 
                      dbo.AccountEmployee.Username, dbo.AccountEmployee.IsDisabled, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.AccountEmployee.EmployeeCode, dbo.AccountPreferences.Version, 
                      dbo.AccountPreferences.LockSubmittedRecords, dbo.AccountPreferences.LockApprovedRecords, ISNULL(dbo.AccountEmployee.EmployeeCode + '' - '', '''') 
                      + dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeNameWithCode, dbo.AccountPreferences.ShowWorkTypeInTimeSheet, 
                      dbo.AccountPreferences.NumberOfBlankRowsInTimeEntry, dbo.AccountPreferences.ShowCostCenterInTimeSheet, dbo.AccountPreferences.WeekStartDay, 
                      dbo.AccountPreferences.AccountBaseCurrencyId, dbo.AccountPreferences.UserInterfaceLanguage, dbo.AccountEmployee.EmployeeManagerId, 
                      dbo.AccountPreferences.DefaultTimeEntryMode, dbo.AccountPreferences.PageSize, dbo.AccountEmployee.TimeZoneId AS EmployeeTimeZoneId, 
                      dbo.AccountEmployee.TerminationDate, dbo.AccountEmployee.StatusId, dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.EmployeePayTypeId, 
                      dbo.AccountEmployee.HiredDate, dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountWorkingDayType, 
                      dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay AS EmployeeWeekStartDay, 
                      dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountPreferences.ShowDescriptionInWeekView, 
                      dbo.AccountPreferences.InvoiceNoPrefix, dbo.AccountPreferences.ShowAdditionalTaskInformationType, 
                      dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, 
                      ISNULL(dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, 1) AS InitialDayOfTheMonth, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, 1) 
                      AS SystemInitialDayOfFirstPeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod, 16) AS SystemInitialDayOfLastPeriod, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountPreferences.TimesheetPrintFooter, dbo.AccountPreferences.ExpenseSheetPrintFooter, 
                      dbo.AccountPreferences.ShowCompletedProjectsInTimeSheet, dbo.AccountPreferences.ShowProjectForTimeOff, dbo.AccountPreferences.ShowTimeOffInTimesheet, 
                      dbo.AccountEmployee.IsDeleted, dbo.AccountEmployee.IsForcePasswordChange, dbo.AccountEmployee.PasswordChangedDate, 
                      dbo.AccountPreferences.PasswordExpiryPeriod, dbo.AccountPreferences.ShowAllInTimesheetReadOnly, dbo.AccountPreferences.ShowTaskInExpenseSheet
FROM         dbo.vueAccountTimesheetPeriodType RIGHT OUTER JOIN
                      dbo.AccountWorkingDayType ON 
                      dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId = dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId RIGHT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.Account ON dbo.AccountEmployee.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId ON 
                      dbo.AccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployee.AccountId = dbo.AccountPreferences.AccountId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId'

GO
-- Create View vueAccountExpenseEntry
Print 'Create View vueAccountExpenseEntry'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntry' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountExpenseEntry
AS
SELECT     CASE WHEN dbo.AccountEmployee.IsDisabled = 1 THEN dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE dbo.AccountEmployee.FirstName
                       + '' '' + dbo.AccountEmployee.LastName END AS EmployeeName, dbo.AccountExpense.AccountExpenseName, dbo.AccountProject.ProjectName, 
                      dbo.AccountExpenseEntry.AccountExpenseEntryId, dbo.AccountExpenseEntry.AccountExpenseEntryDate, dbo.AccountExpenseEntry.AccountId, 
                      dbo.AccountExpenseEntry.AccountEmployeeId, dbo.AccountExpenseEntry.AccountProjectId, dbo.AccountExpenseEntry.AccountExpenseId, 
                      dbo.AccountExpenseEntry.Amount, dbo.AccountExpenseEntry.TeamLeadApproved, dbo.AccountExpenseEntry.ProjectManagerApproved, 
                      dbo.AccountExpenseEntry.AdministratorApproved, dbo.AccountExpenseEntry.Approved, dbo.AccountExpenseEntry.CreatedOn, 
                      dbo.AccountExpenseEntry.CreatedByEmployeeId, dbo.AccountExpenseEntry.ModifiedOn, dbo.AccountExpenseEntry.ModifiedByEmployeeId, 
                      dbo.AccountParty.PartyName, dbo.AccountProject.AccountClientId, dbo.AccountExpenseEntry.Description, dbo.AccountExpenseType.ExpenseType, 
                      dbo.AccountExpense.AccountExpenseTypeId, dbo.AccountProject.LeaderEmployeeId, dbo.AccountExpenseEntry.IsBillable, dbo.AccountExpenseEntry.Rejected, 
                      dbo.AccountEmployee.EmployeeCode, dbo.AccountExpenseEntry.Reimburse, dbo.AccountExpenseEntry.AccountCurrencyId, dbo.SystemCurrency.CurrencyCode, 
                      dbo.AccountExpenseType.IsQuantityField, dbo.AccountExpenseType.QuantityFieldCaption, dbo.AccountExpenseEntry.AccountBaseCurrencyId, 
                      dbo.AccountExpenseEntry.ExchangeRate, ISNULL(dbo.AccountExpenseEntry.TaxAmount, 0) AS TaxAmount, ISNULL(dbo.AccountExpenseEntry.AmountBeforeTax, 0) 
                      AS NetAmount, dbo.AccountExpenseEntry.Submitted, dbo.AccountProject.TimeSheetApprovalTypeId, dbo.AccountProject.ExpenseApprovalTypeId, 
                      dbo.AccountProject.ProjectManagerEmployeeId, dbo.AccountExpenseEntry.TimeSheetApprovalPathId, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountLocation.AccountLocation, dbo.AccountTaxZone.AccountTaxZone, dbo.AccountExpenseEntry.Quantity, 
                      dbo.AccountExpenseEntry.Rate, dbo.AccountPaymentMethod.PaymentMethod, dbo.AccountLocation.AccountLocationId, dbo.AccountParty.PartyNick, 
                      dbo.AccountProject.ProjectDescription, dbo.AccountProject.ProjectCode, dbo.AccountDepartment.DepartmentCode, 
                      dbo.vueAccountExpenseEntryApprovalLastAction.Comments, dbo.vueAccountExpenseEntryApprovalLastAction.ApprovedOn, 
                      dbo.AccountDepartment.AccountDepartmentId, dbo.AccountRole.Role, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountExpenseEntry.AccountTimeExpenseBillingExpenseId, dbo.AccountExpenseEntry.Billed, dbo.AccountTimeExpenseBilling.InvoiceNumber, 
                      dbo.AccountTimeExpenseBilling.InvoiceDate, dbo.AccountProjectType.AccountProjectTypeId, dbo.AccountProjectType.ProjectType, 
                      dbo.AccountExpenseEntry.AccountEmployeeExpenseSheetId, dbo.AccountEmployeeExpenseSheet.Description AS ExpenseSheetDescription, 
                      dbo.AccountEmployeeExpenseSheet.ExpenseSheetDate, dbo.AccountEmployeeExpenseSheet.SubmittedDate, 
                      dbo.AccountEmployeeExpenseSheet.Approved AS SheetApproved, dbo.AccountEmployeeExpenseSheet.Rejected AS SheetRejected, 
                      dbo.AccountEmployeeExpenseSheet.Submitted AS SheetSubmitted, dbo.AccountEmployeeExpenseSheet.InApproval AS SheetInApproval, 
                      dbo.AccountTaxCode.TaxCode, dbo.AccountTaxCode.Formula, dbo.AccountTaxCode.AccountTaxCodeId, dbo.AccountProjectTask.TaskName
FROM         dbo.AccountLocation RIGHT OUTER JOIN
                      dbo.SystemCurrency RIGHT OUTER JOIN
                      dbo.AccountCurrency RIGHT OUTER JOIN
                      dbo.AccountPaymentMethod RIGHT OUTER JOIN
                      dbo.vueAccountExpenseEntryApprovalLastAction RIGHT OUTER JOIN
                      dbo.AccountTimeExpenseBillingExpense INNER JOIN
                      dbo.AccountTimeExpenseBilling ON 
                      dbo.AccountTimeExpenseBillingExpense.AccountTimeExpenseBillingId = dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId RIGHT OUTER JOIN
                      dbo.AccountEmployeeExpenseSheet RIGHT OUTER JOIN
                      dbo.AccountTaxCode RIGHT OUTER JOIN
                      dbo.AccountExpenseTypeTaxCode RIGHT OUTER JOIN
                      dbo.AccountExpenseType INNER JOIN
                      dbo.AccountExpenseEntry INNER JOIN
                      dbo.AccountExpense ON dbo.AccountExpenseEntry.AccountExpenseId = dbo.AccountExpense.AccountExpenseId ON 
                      dbo.AccountExpenseType.AccountExpenseTypeId = dbo.AccountExpense.AccountExpenseTypeId LEFT OUTER JOIN
                      dbo.AccountProjectTask ON dbo.AccountExpenseEntry.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId ON 
                      dbo.AccountExpenseTypeTaxCode.AccountTaxZoneId = dbo.AccountExpenseEntry.AccountTaxZoneId AND 
                      dbo.AccountExpenseTypeTaxCode.AccountExpenseTypeId = dbo.AccountExpenseType.AccountExpenseTypeId ON 
                      dbo.AccountTaxCode.AccountTaxCodeId = dbo.AccountExpenseTypeTaxCode.AccountTaxCodeId LEFT OUTER JOIN
                      dbo.AccountTaxZone ON dbo.AccountExpenseEntry.AccountTaxZoneId = dbo.AccountTaxZone.AccountTaxZoneId ON 
                      dbo.AccountEmployeeExpenseSheet.AccountEmployeeExpenseSheetId = dbo.AccountExpenseEntry.AccountEmployeeExpenseSheetId LEFT OUTER JOIN
                      dbo.AccountEmployee ON dbo.AccountExpenseEntry.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId ON 
                      dbo.AccountTimeExpenseBillingExpense.AccountTimeExpenseBillingExpenseId = dbo.AccountExpenseEntry.AccountTimeExpenseBillingExpenseId ON 
                      dbo.vueAccountExpenseEntryApprovalLastAction.AccountExpenseEntryId = dbo.AccountExpenseEntry.AccountExpenseEntryId ON 
                      dbo.AccountPaymentMethod.AccountPaymentMethodId = dbo.AccountExpenseEntry.AccountPaymentMethodId ON 
                      dbo.AccountCurrency.AccountCurrencyId = dbo.AccountExpenseEntry.AccountCurrencyId LEFT OUTER JOIN
                      dbo.AccountParty RIGHT OUTER JOIN
                      dbo.AccountProject LEFT OUTER JOIN
                      dbo.AccountProjectType ON dbo.AccountProject.AccountProjectTypeId = dbo.AccountProjectType.AccountProjectTypeId ON 
                      dbo.AccountParty.AccountPartyId = dbo.AccountProject.AccountClientId ON dbo.AccountExpenseEntry.AccountProjectId = dbo.AccountProject.AccountProjectId ON 
                      dbo.SystemCurrency.CurrencyId = dbo.AccountCurrency.SystemCurrencyId LEFT OUTER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId ON 
                      dbo.AccountLocation.AccountLocationId = dbo.AccountEmployee.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId'

GO
-- Create View vueAccountExpenseEntryWithLastStatus
Print 'Create View vueAccountExpenseEntryWithLastStatus'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryWithLastStatus' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountExpenseEntryWithLastStatus
AS
SELECT     dbo.vueAccountExpenseEntryWithLastAction.IsRejected, dbo.vueAccountExpenseEntryWithLastAction.IsApproved, dbo.vueAccountExpenseEntry.EmployeeName, 
                      dbo.vueAccountExpenseEntry.AccountExpenseName, dbo.vueAccountExpenseEntry.ProjectName, dbo.vueAccountExpenseEntry.AccountExpenseEntryId, 
                      dbo.vueAccountExpenseEntry.AccountExpenseEntryDate, dbo.vueAccountExpenseEntry.AccountId, dbo.vueAccountExpenseEntry.AccountEmployeeId, 
                      dbo.vueAccountExpenseEntry.AccountProjectId, dbo.vueAccountExpenseEntry.AccountExpenseId, dbo.vueAccountExpenseEntry.Amount, 
                      dbo.vueAccountExpenseEntry.TeamLeadApproved, dbo.vueAccountExpenseEntry.ProjectManagerApproved, dbo.vueAccountExpenseEntry.AdministratorApproved, 
                      dbo.vueAccountExpenseEntry.Approved, dbo.vueAccountExpenseEntry.CreatedOn, dbo.vueAccountExpenseEntry.CreatedByEmployeeId, 
                      dbo.vueAccountExpenseEntry.ModifiedOn, dbo.vueAccountExpenseEntry.ModifiedByEmployeeId, dbo.vueAccountExpenseEntry.PartyName, 
                      dbo.vueAccountExpenseEntry.AccountClientId, dbo.vueAccountExpenseEntry.Description, dbo.vueAccountExpenseEntry.ExpenseType, 
                      dbo.vueAccountExpenseEntry.AccountExpenseTypeId, dbo.vueAccountExpenseEntry.LeaderEmployeeId, dbo.vueAccountExpenseEntry.IsBillable, 
                      dbo.vueAccountExpenseEntry.Rejected, dbo.vueAccountExpenseEntry.EmployeeCode, dbo.vueAccountExpenseEntry.Reimburse, 
                      dbo.vueAccountExpenseEntry.AccountCurrencyId, dbo.vueAccountExpenseEntry.CurrencyCode, dbo.vueAccountExpenseEntry.IsQuantityField, 
                      dbo.vueAccountExpenseEntry.QuantityFieldCaption, dbo.vueAccountExpenseEntry.Submitted, dbo.vueAccountExpenseEntry.AccountEmployeeExpenseSheetId, 
                      dbo.vueAccountExpenseEntry.SubmittedDate, dbo.vueAccountExpenseEntry.ExpenseSheetDate, dbo.vueAccountExpenseEntry.ExpenseSheetDescription, 
                      dbo.vueAccountExpenseEntry.ExchangeRate, dbo.vueAccountExpenseEntry.TaxAmount, dbo.vueAccountExpenseEntry.NetAmount, 
                      dbo.vueAccountExpenseEntry.PaymentMethod, dbo.vueAccountExpenseEntry.Quantity, dbo.vueAccountExpenseEntry.Rate, 
                      dbo.vueAccountExpenseEntry.AccountTaxCodeId, dbo.vueAccountExpenseEntry.TaxCode, dbo.vueAccountExpenseEntry.TaskName
FROM         dbo.vueAccountExpenseEntryWithLastAction RIGHT OUTER JOIN
                      dbo.vueAccountExpenseEntry ON dbo.vueAccountExpenseEntryWithLastAction.AccountExpenseEntryId = dbo.vueAccountExpenseEntry.AccountExpenseEntryId'


GO

-- Drop View rptvueExpenseEntryApprovalActivity
Print 'Drop View rptvueExpenseEntryApprovalActivity'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueExpenseEntryApprovalActivity' and table_type = 'VIEW') 
DROP VIEW [dbo].[rptvueExpenseEntryApprovalActivity]

GO
-- Drop View vueExpenseEntryApprovalActivityForReport
Print 'Drop View vueExpenseEntryApprovalActivityForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueExpenseEntryApprovalActivityForReport' and table_type = 'VIEW') 
DROP VIEW [dbo].[vueExpenseEntryApprovalActivityForReport]

GO
-- Drop View rptvueAccountExpenseEntry
Print 'Drop View rptvueAccountExpenseEntry'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountExpenseEntry' and table_type = 'VIEW') 
DROP VIEW [dbo].[rptvueAccountExpenseEntry]

GO
-- Drop View vueAccountExpenseEntryForReport
Print 'Drop View vueAccountExpenseEntryForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryForReport' and table_type = 'VIEW') 
DROP VIEW [dbo].[vueAccountExpenseEntryForReport]

GO
-- Create View vueAccountExpenseEntryForReport
Print 'Create View vueAccountExpenseEntryForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountExpenseEntryForReport
AS
SELECT     EmployeeName, AccountExpenseName, ProjectName, AccountExpenseEntryId, AccountExpenseEntryDate, AccountId, AccountEmployeeId, AccountProjectId, 
                      AccountExpenseId, Amount AS NetAmount, TeamLeadApproved, ProjectManagerApproved, AdministratorApproved, ISNULL(Approved, 0) AS Approved, CreatedOn, 
                      CreatedByEmployeeId, ModifiedOn, ModifiedByEmployeeId, PartyName AS ClientName, AccountClientId, ISNULL(Description, N'''') AS Description, ExpenseType, 
                      AccountExpenseTypeId, LeaderEmployeeId, IsBillable, ISNULL(Rejected, 0) AS Rejected, ISNULL(EmployeeCode, N'''') AS EmployeeCode, Reimburse, 
                      AccountCurrencyId, CurrencyCode, IsQuantityField, ISNULL(QuantityFieldCaption, N'''') AS QuantityFieldCaption, AccountBaseCurrencyId, ISNULL(ExchangeRate, 0) 
                      AS ExchangeRate, TaxAmount, NetAmount AS Amount, ISNULL(Submitted, 0) AS Submitted, TimeSheetApprovalTypeId, ExpenseApprovalTypeId, 
                      ProjectManagerEmployeeId, TimeSheetApprovalPathId, EMailAddress, DepartmentName, AccountLocation, ISNULL(AccountTaxZone, N'''') AS AccountTaxZone, 
                      ISNULL(Quantity, 0) AS Quantity, ISNULL(Rate, 0) AS Rate, ISNULL(PaymentMethod, N'''') AS PaymentMethod, AccountLocationId, ISNULL(PartyNick, N'''') AS ClientNick, 
                      ProjectDescription, ISNULL(ProjectCode, N'''') AS ProjectCode, ISNULL(DepartmentCode, N'''') AS DepartmentCode, ISNULL(Comments, N'''') AS Comments, ApprovedOn, 
                      AccountDepartmentId, Role, AccountRoleId, { fn DAYOFMONTH(AccountExpenseEntryDate) } AS DayNo, MONTH(AccountExpenseEntryDate) AS MonthNo, 
                      DATEPART(week, AccountExpenseEntryDate) - DATEPART(week, DATEADD(month, DATEDIFF(month, 0, AccountExpenseEntryDate), 0)) + 1 AS WeekNo, 
                      YEAR(AccountExpenseEntryDate) AS Year, LEFT({ fn MONTHNAME(AccountExpenseEntryDate) }, 3) + '' - '' + CONVERT(nvarchar(10), YEAR(AccountExpenseEntryDate)) 
                      AS Period, { fn DAYNAME(AccountExpenseEntryDate) } AS WeekDayName, InvoiceNumber, InvoiceDate, AccountProjectTypeId, ProjectType, Billed, 
                      AccountEmployeeExpenseSheetId, ExpenseSheetDescription, ExpenseSheetDate, SubmittedDate, SheetApproved, SheetRejected, SheetSubmitted, SheetInApproval, 
                      TaskName
FROM         dbo.vueAccountExpenseEntry'

GO
-- Create View rptvueAccountExpenseEntry
Print 'Create View rptvueAccountExpenseEntry'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountExpenseEntry' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountExpenseEntry
AS
SELECT     EmployeeName, AccountExpenseName, ProjectName, AccountExpenseEntryId, AccountExpenseEntryDate, AccountId, AccountEmployeeId, AccountProjectId, 
                      AccountExpenseId, Amount, TeamLeadApproved, ProjectManagerApproved, AdministratorApproved, Approved, CreatedOn, CreatedByEmployeeId, ModifiedOn, 
                      ModifiedByEmployeeId, ClientName, AccountClientId, Description, ExpenseType, AccountExpenseTypeId, LeaderEmployeeId, IsBillable, Rejected, EmployeeCode, 
                      Reimburse, AccountCurrencyId, CurrencyCode, IsQuantityField, QuantityFieldCaption, AccountBaseCurrencyId, ExchangeRate, TaxAmount, NetAmount, Submitted, 
                      TimeSheetApprovalTypeId, ExpenseApprovalTypeId, ProjectManagerEmployeeId, TimeSheetApprovalPathId, EMailAddress, DepartmentName, AccountLocation, 
                      AccountTaxZone, Quantity, Rate, PaymentMethod, AccountLocationId, ClientNick, ProjectDescription, ProjectCode, DepartmentCode, 
                      CASE WHEN vueAccountExpenseEntryForReport.Submitted = 1 AND 
                      vueAccountExpenseEntryForReport.Approved = 0 THEN ''Submitted'' WHEN vueAccountExpenseEntryForReport.Approved = 1 THEN ''Approved'' WHEN vueAccountExpenseEntryForReport.Rejected
                       = 1 THEN ''Rejected'' WHEN vueAccountExpenseEntryForReport.Submitted = 0 AND vueAccountExpenseEntryForReport.Approved = 0 AND 
                      vueAccountExpenseEntryForReport.Rejected = 0 THEN ''Not Submitted'' END AS ApprovalStatus, Comments AS ApproverComments, ApprovedOn, AccountDepartmentId, 
                      Role, AccountRoleId, DayNo, MonthNo, WeekNo, Year, Period, WeekDayName, 
                      CASE WHEN dbo.vueAccountExpenseEntryForReport.ExchangeRate > 0 THEN dbo.vueAccountExpenseEntryForReport.NetAmount / dbo.vueAccountExpenseEntryForReport.ExchangeRate
                       ELSE 0 END AS CurrencyNetAmount, 
                      CASE WHEN dbo.vueAccountExpenseEntryForReport.ExchangeRate > 0 THEN dbo.vueAccountExpenseEntryForReport.Amount / dbo.vueAccountExpenseEntryForReport.ExchangeRate
                       ELSE 0 END AS CurrencyAmount, 
                      CASE WHEN dbo.vueAccountExpenseEntryForReport.ExchangeRate > 0 THEN dbo.vueAccountExpenseEntryForReport.TaxAmount / dbo.vueAccountExpenseEntryForReport.ExchangeRate
                       ELSE 0 END AS CurrencyTaxAmount, InvoiceNumber, InvoiceDate, AccountProjectTypeId, ProjectType, Billed, AccountEmployeeExpenseSheetId, 
                      ExpenseSheetDescription, ExpenseSheetDate, SubmittedDate, SheetApproved, SheetRejected, SheetSubmitted, SheetInApproval, TaskName
FROM         dbo.vueAccountExpenseEntryForReport'

GO
-- Create View vueExpenseEntryApprovalActivityForReport
Print 'Create View vueExpenseEntryApprovalActivityForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueExpenseEntryApprovalActivityForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueExpenseEntryApprovalActivityForReport
AS
SELECT     dbo.AccountExpenseEntryApproval.ExpenseApprovalId, dbo.AccountExpenseEntryApproval.AccountExpenseEntryId, 
                      dbo.AccountExpenseEntryApproval.ExpenseApprovalTypeId, dbo.AccountExpenseEntryApproval.ExpenseApprovalPathId, 
                      dbo.AccountExpenseEntryApproval.ApprovedByEmployeeId, dbo.AccountExpenseEntryApproval.ApprovedOn, dbo.AccountExpenseEntryApproval.Comments, 
                      dbo.AccountExpenseEntryApproval.IsRejected, dbo.AccountExpenseEntryApproval.IsApproved, dbo.vueAccountExpenseEntryForReport.EmployeeName, 
                      dbo.vueAccountExpenseEntryForReport.AccountExpenseName, dbo.vueAccountExpenseEntryForReport.ProjectName, 
                      dbo.vueAccountExpenseEntryForReport.AccountExpenseEntryDate, dbo.vueAccountExpenseEntryForReport.AccountId, 
                      dbo.vueAccountExpenseEntryForReport.AccountEmployeeId, dbo.vueAccountExpenseEntryForReport.AccountProjectId, 
                      dbo.vueAccountExpenseEntryForReport.AccountExpenseId, dbo.vueAccountExpenseEntryForReport.Amount, dbo.vueAccountExpenseEntryForReport.Approved, 
                      dbo.vueAccountExpenseEntryForReport.ClientName, dbo.vueAccountExpenseEntryForReport.AccountClientId, dbo.vueAccountExpenseEntryForReport.Description, 
                      dbo.vueAccountExpenseEntryForReport.ExpenseType, dbo.vueAccountExpenseEntryForReport.AccountExpenseTypeId, 
                      dbo.vueAccountExpenseEntryForReport.IsBillable, dbo.vueAccountExpenseEntryForReport.Rejected, dbo.vueAccountExpenseEntryForReport.EmployeeCode, 
                      dbo.vueAccountExpenseEntryForReport.Reimburse, dbo.vueAccountExpenseEntryForReport.AccountCurrencyId, 
                      dbo.vueAccountExpenseEntryForReport.CurrencyCode, ISNULL(dbo.vueAccountExpenseEntryForReport.ExchangeRate, 0) AS ExchangeRate, 
                      dbo.vueAccountExpenseEntryForReport.AccountBaseCurrencyId, dbo.vueAccountExpenseEntryForReport.TaxAmount, 
                      dbo.vueAccountExpenseEntryForReport.NetAmount, dbo.vueAccountExpenseEntryForReport.Submitted, dbo.vueAccountExpenseEntryForReport.EMailAddress, 
                      dbo.vueAccountExpenseEntryForReport.DepartmentName, dbo.vueAccountExpenseEntryForReport.AccountLocation, 
                      dbo.vueAccountExpenseEntryForReport.AccountTaxZone, dbo.vueAccountExpenseEntryForReport.Quantity, dbo.vueAccountExpenseEntryForReport.Rate, 
                      dbo.vueAccountExpenseEntryForReport.PaymentMethod, dbo.vueAccountExpenseEntryForReport.AccountLocationId, 
                      dbo.vueAccountExpenseEntryForReport.ClientNick, dbo.vueAccountExpenseEntryForReport.ProjectDescription, dbo.vueAccountExpenseEntryForReport.ProjectCode, 
                      dbo.vueAccountExpenseEntryForReport.DepartmentCode, dbo.vueAccountEmployee.EmployeeName AS ApproverEmployeeName, 
                      dbo.vueAccountEmployee.EMailAddress AS ApproverEMailAddress, dbo.AccountApprovalType.ApprovalTypeName, dbo.SystemApproverType.SystemApproverType, 
                      CASE WHEN dbo.AccountExpenseEntryApproval.IsApproved = 1 THEN ''Approved'' WHEN dbo.AccountExpenseEntryApproval.IsRejected = 1 THEN ''Rejected'' END AS Status,
                       dbo.vueAccountEmployee.Role, dbo.vueAccountEmployee.AccountRoleId, dbo.vueAccountEmployee.AccountDepartmentId, 
                      dbo.vueAccountExpenseEntryForReport.TaskName
FROM         dbo.SystemApproverType INNER JOIN
                      dbo.AccountApprovalPath ON dbo.SystemApproverType.SystemApproverTypeId = dbo.AccountApprovalPath.SystemApproverTypeId RIGHT OUTER JOIN
                      dbo.AccountExpenseEntryApproval ON 
                      dbo.AccountApprovalPath.AccountApprovalPathId = dbo.AccountExpenseEntryApproval.ExpenseApprovalPathId LEFT OUTER JOIN
                      dbo.AccountApprovalType ON dbo.AccountExpenseEntryApproval.ExpenseApprovalTypeId = dbo.AccountApprovalType.AccountApprovalTypeId LEFT OUTER JOIN
                      dbo.vueAccountEmployee ON dbo.AccountExpenseEntryApproval.ApprovedByEmployeeId = dbo.vueAccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.vueAccountExpenseEntryForReport ON 
                      dbo.AccountExpenseEntryApproval.AccountExpenseEntryId = dbo.vueAccountExpenseEntryForReport.AccountExpenseEntryId'

GO
-- Create View rptvueExpenseEntryApprovalActivity
Print 'Create View rptvueExpenseEntryApprovalActivity'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueExpenseEntryApprovalActivity' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueExpenseEntryApprovalActivity
AS
SELECT     ExpenseApprovalId, AccountExpenseEntryId, ExpenseApprovalTypeId, ExpenseApprovalPathId, ApprovedByEmployeeId, ApprovedOn, Comments, IsRejected, 
                      IsApproved, EmployeeName, AccountExpenseName, ProjectName, AccountExpenseEntryDate, AccountId, AccountEmployeeId, AccountProjectId, AccountExpenseId, 
                      Amount, Approved, ClientName, AccountClientId, Description, ExpenseType, AccountExpenseTypeId, IsBillable, Rejected, EmployeeCode, Reimburse, 
                      AccountCurrencyId, CurrencyCode, ExchangeRate, AccountBaseCurrencyId, TaxAmount, NetAmount, Submitted, EMailAddress, DepartmentName, AccountLocation, 
                      AccountTaxZone, Quantity, Rate, PaymentMethod, AccountLocationId, ClientNick, ProjectDescription, ProjectCode, DepartmentCode, ApproverEmployeeName, 
                      ApproverEMailAddress, ApprovalTypeName, SystemApproverType, Status, Role, AccountRoleId, AccountDepartmentId, 
                      CASE WHEN dbo.vueExpenseEntryApprovalActivityForReport.ExchangeRate > 0 THEN dbo.vueExpenseEntryApprovalActivityForReport.NetAmount / dbo.vueExpenseEntryApprovalActivityForReport.ExchangeRate
                       ELSE 0 END AS CurrencyNetAmount, 
                      CASE WHEN dbo.vueExpenseEntryApprovalActivityForReport.ExchangeRate > 0 THEN dbo.vueExpenseEntryApprovalActivityForReport.Amount / dbo.vueExpenseEntryApprovalActivityForReport.ExchangeRate
                       ELSE 0 END AS CurrencyAmount, 
                      CASE WHEN dbo.vueExpenseEntryApprovalActivityForReport.ExchangeRate > 0 THEN dbo.vueExpenseEntryApprovalActivityForReport.TaxAmount / dbo.vueExpenseEntryApprovalActivityForReport.ExchangeRate
                       ELSE 0 END AS CurrencyTaxAmount, TaskName
FROM         dbo.vueExpenseEntryApprovalActivityForReport'


GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'
if not exists(Select * from [dbo].[SystemReportDataSourceField] where [SystemReportDataSourceFieldId] = 'fd320c6a-e15e-4344-a96d-f21bca18f252')
BEGIN
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('fd320c6a-e15e-4344-a96d-f21bca18f252', 'e3803dc0-49fd-4fc8-b414-ea264ffe85aa', N'TaskName', 200, 0, NULL, NULL, 31, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Task Name', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('ffca98fa-7988-4fe5-b271-a528bd0fe543', '0f2d1d68-826d-400e-bf9f-95d4a9d6c4e0', N'TaskName', 200, 0, NULL, NULL, 52, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Task Name', 0, 0)

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'

UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=51 WHERE [SystemReportDataSourceFieldId]='d1330fda-32bb-4e00-9097-f17e0983219b'
END
GO
-- Drop View vueTimesheetSummaryForApproval
Print 'Drop View vueTimesheetSummaryForApproval'
GO
if exists (select * from information_schema.tables where table_name = 'vueTimesheetSummaryForApproval' and table_type = 'VIEW') 
DROP VIEW [dbo].[vueTimesheetSummaryForApproval]
GO
-- Drop View vueTimesheetSequenceForApproval
Print 'Drop View vueTimesheetSequenceForApproval'
GO
if exists (select * from information_schema.tables where table_name = 'vueTimesheetSequenceForApproval' and table_type = 'VIEW') 
DROP VIEW [dbo].[vueTimesheetSequenceForApproval]
GO
-- Add Column ApprovalPathSequence to AccountEmployeeTimeEntryApproval
Print 'Add Column ApprovalPathSequence to AccountEmployeeTimeEntryApproval'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntryApproval' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='ApprovalPathSequence' AND TABLE_NAME='AccountEmployeeTimeEntryApproval'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntryApproval]
	ADD [ApprovalPathSequence] tinyint NULL
GO
-- Create View vueTimesheetSequenceForApproval
Print 'Create View vueTimesheetSequenceForApproval'
GO
if not exists (select * from information_schema.tables where table_name = 'vueTimesheetSequenceForApproval' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueTimesheetSequenceForApproval
AS
SELECT     dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId, 
                      dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeId AS TimeEntryAccountEmployeeId, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, dbo.AccountEmployeeTimeEntryApproval.TimeSheetApprovalId, 
                      dbo.AccountApprovalPath.AccountApprovalPathId, dbo.AccountApprovalPath.SystemApproverTypeId, dbo.AccountApprovalPath.AccountExternalUserId, 
                      dbo.AccountApprovalPath.AccountEmployeeId, dbo.AccountApprovalPath.ApprovalPathSequence, dbo.AccountProject.LeaderEmployeeId, 
                      dbo.AccountProject.ProjectManagerEmployeeId, dbo.AccountApprovalType.AccountApprovalTypeId, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountEmployee.EmployeeManagerId, 
                      dbo.AccountProject.AccountProjectId, dbo.AccountEmployeeTimeEntryApproval.IsApproved, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountEmployeeTimeEntryApprovalProject.AccountEmployeeTimeEntryApprovalProjectId, 
                      dbo.AccountEmployeeTimeEntryApproval.PreviousStatus, dbo.AccountEmployeeTimeEntryApproval.IsReject, 
                      dbo.AccountEmployeeTimeEntryApprovalProject.Submitted, dbo.AccountEmployeeTimeEntryApprovalProject.Approved, 
                      dbo.AccountEmployeeTimeEntryApprovalProject.Rejected
FROM         dbo.AccountApprovalType INNER JOIN
                      dbo.AccountEmployeeTimeEntryApprovalProject INNER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntryApprovalProject.AccountProjectId = dbo.AccountProject.AccountProjectId ON 
                      dbo.AccountApprovalType.AccountApprovalTypeId = dbo.AccountProject.TimeSheetApprovalTypeId INNER JOIN
                      dbo.AccountApprovalPath ON dbo.AccountApprovalType.AccountApprovalTypeId = dbo.AccountApprovalPath.AccountApprovalTypeId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryApproval ON 
                      dbo.AccountApprovalPath.ApprovalPathSequence = dbo.AccountEmployeeTimeEntryApproval.ApprovalPathSequence AND 
                      dbo.AccountEmployeeTimeEntryApproval.PreviousStatus <> 1 AND dbo.AccountEmployeeTimeEntryApproval.IsReject <> 1 AND 
                      dbo.AccountEmployeeTimeEntryApprovalProject.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntryApproval.AccountEmployeeTimeEntryPeriodId
                       AND dbo.AccountEmployeeTimeEntryApprovalProject.AccountProjectId = dbo.AccountEmployeeTimeEntryApproval.AccountProjectId RIGHT OUTER JOIN
                      dbo.AccountEmployee RIGHT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryPeriod ON dbo.AccountEmployee.AccountEmployeeId = dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeId ON 
                      dbo.AccountEmployeeTimeEntryApprovalProject.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId'
GO
-- Create View vueTimesheetSummaryForApproval
Print 'Create View vueTimesheetSummaryForApproval'
GO
if not exists (select * from information_schema.tables where table_name = 'vueTimesheetSummaryForApproval' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueTimesheetSummaryForApproval
AS
SELECT     dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId, 
                      dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeId AS TimeEntryAccountEmployeeId, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, dbo.AccountEmployeeTimeEntryApproval.TimeSheetApprovalId, 
                      dbo.AccountApprovalPath.AccountApprovalPathId, dbo.AccountApprovalPath.SystemApproverTypeId, dbo.AccountApprovalPath.AccountExternalUserId, 
                      dbo.AccountApprovalPath.AccountEmployeeId, dbo.AccountApprovalPath.ApprovalPathSequence, dbo.AccountProject.LeaderEmployeeId, 
                      dbo.AccountProject.ProjectManagerEmployeeId, dbo.AccountApprovalType.AccountApprovalTypeId, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountEmployee.EmployeeManagerId, 
                      dbo.AccountProject.AccountProjectId, dbo.AccountEmployeeTimeEntryApproval.IsApproved, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountEmployeeTimeEntryApprovalProject.AccountEmployeeTimeEntryApprovalProjectId, 
                      dbo.AccountEmployeeTimeEntryApproval.PreviousStatus, dbo.AccountEmployeeTimeEntryApproval.IsReject, 
                      dbo.AccountEmployeeTimeEntryApprovalProject.Submitted, dbo.AccountEmployeeTimeEntryApprovalProject.Approved, 
                      dbo.AccountEmployeeTimeEntryApprovalProject.Rejected
FROM         dbo.AccountApprovalType INNER JOIN
                      dbo.AccountEmployeeTimeEntryApprovalProject INNER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntryApprovalProject.AccountProjectId = dbo.AccountProject.AccountProjectId ON 
                      dbo.AccountApprovalType.AccountApprovalTypeId = dbo.AccountProject.TimeSheetApprovalTypeId INNER JOIN
                      dbo.AccountApprovalPath ON dbo.AccountApprovalType.AccountApprovalTypeId = dbo.AccountApprovalPath.AccountApprovalTypeId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryApproval ON 
                      dbo.AccountApprovalPath.ApprovalPathSequence = dbo.AccountEmployeeTimeEntryApproval.ApprovalPathSequence AND 
                      dbo.AccountEmployeeTimeEntryApproval.PreviousStatus <> 1 AND dbo.AccountEmployeeTimeEntryApproval.IsReject <> 1 AND 
                      dbo.AccountEmployeeTimeEntryApprovalProject.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntryApproval.AccountEmployeeTimeEntryPeriodId
                       AND dbo.AccountEmployeeTimeEntryApprovalProject.AccountProjectId = dbo.AccountEmployeeTimeEntryApproval.AccountProjectId RIGHT OUTER JOIN
                      dbo.AccountEmployee RIGHT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryPeriod ON dbo.AccountEmployee.AccountEmployeeId = dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeId ON 
                      dbo.AccountEmployeeTimeEntryApprovalProject.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId'
GO
If exists(Select * from SystemData where version = '3.8.5')
BEGIN
Update AccountEmployeeTimeEntryApproval
Set AccountEmployeeTimeEntryApproval.ApprovalPathSequence = (Select AccountApprovalPath.ApprovalPathSequence
From AccountApprovalPath
Where AccountEmployeeTimeEntryApproval.TimeSheetApprovalPathId = AccountApprovalPath.AccountApprovalPathId)
Where AccountEmployeeTimeEntryApproval.ApprovalPathSequence Is NULL
END
GO
Update SystemData Set Version = '3.9.0' Where Version = '3.8.5' And SystemDataId = 1
GO
-- Drop View vueAccountEmployeeTimeEntryApprovalPending
Print 'Drop View vueAccountEmployeeTimeEntryApprovalPending'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryApprovalPending' and table_type = 'VIEW') 
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryApprovalPending]
GO
-- Create View vueAccountEmployeeTimeEntryApprovalPending
Print 'Create View vueAccountEmployeeTimeEntryApprovalPending'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryApprovalPending' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryApprovalPending
AS
SELECT     dbo.vueAccountEmployeeTimeEntryApproval.AccountProjectId, dbo.vueAccountEmployeeTimeEntryApproval.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApproval.ProjectManagerEmployeeId, dbo.vueAccountEmployeeTimeEntryApproval.ApprovalTypeName, 
                      dbo.vueAccountEmployeeTimeEntryApproval.AccountApprovalPathId, dbo.vueAccountEmployeeTimeEntryApproval.AccountApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApproval.SystemApproverTypeId, dbo.vueAccountEmployeeTimeEntryApproval.AccountExternalUserId, 
                      dbo.vueAccountEmployeeTimeEntryApproval.AccountEmployeeId, dbo.vueAccountEmployeeTimeEntryApproval.ApprovalPathSequence, 
                      dbo.vueAccountEmployeeTimeEntryApproval.AccountEmployeeTimeEntryId, MAX(dbo.vueAccountEmployeeTimeEntryApproval.TimeSheetApprovalId) 
                      AS TimeSheetApprovalId, dbo.vueAccountEmployeeTimeEntryApproval.TimeSheetApprovalPathId, 
                      dbo.vueAccountEmployeeTimeEntryApproval.ProjectName, dbo.vueAccountEmployeeTimeEntryApproval.ProjectDescription, 
                      dbo.vueAccountEmployeeTimeEntryApproval.ProjectCode, dbo.vueAccountEmployeeTimeEntryApproval.TaskName, 
                      dbo.vueAccountEmployeeTimeEntryApproval.AccountProjectTaskId, dbo.vueAccountEmployeeTimeEntryApproval.TaskDescription, 
                      dbo.vueAccountEmployeeTimeEntryApproval.EmployeeName, dbo.vueAccountEmployeeTimeEntryApproval.Approved, 
                      dbo.vueAccountEmployeeTimeEntryApproval.TimeSheetApprovalTypeId, dbo.vueAccountEmployeeTimeEntryApproval.TotalTime, 
                      dbo.vueAccountEmployeeTimeEntryApproval.TimeEntryDate, dbo.vueAccountEmployeeTimeEntryApproval.Comments, 
                      dbo.vueAccountEmployeeTimeEntryApproval.IsReject, dbo.vueAccountEmployeeTimeEntryApproval.IsApproved, 
                      dbo.vueAccountApproverType.MaxApprovalPathSequence, dbo.vueAccountEmployeeTimeEntryApproval.TimeEntryAccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApproval.AccountId, dbo.vueAccountEmployeeTimeEntryApproval.EMailAddress, 
                      dbo.vueAccountEmployeeTimeEntryApproval.Description, dbo.vueAccountEmployeeTimeEntryApproval.Submitted, 
                      dbo.vueAccountEmployeeTimeEntryApproval.EmployeeManagerId, dbo.vueAccountEmployeeTimeEntryApproval.TotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntryApproval.IsBillable, dbo.vueAccountEmployeeTimeEntryApproval.BillableTotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntryApproval.NonBillableTotalMinutes, dbo.vueAccountEmployeeTimeEntryApproval.Rejected, 
                      dbo.vueAccountEmployeeTimeEntryApproval.AccountEmployeeTimeEntryPeriodId, CONVERT(nvarchar(10), 
                      19000100 + ISNULL(dbo.vueAccountWorkingDay.WeekStartDay, 1)) AS EmployeeWeekStartDay, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType
FROM         dbo.AccountEmployeeTimeEntryPeriod INNER JOIN
                      dbo.vueAccountEmployeeTimeEntryApproval INNER JOIN
                      dbo.vueAccountApproverType ON 
                      dbo.vueAccountEmployeeTimeEntryApproval.AccountApprovalTypeId = dbo.vueAccountApproverType.AccountApprovalTypeId ON 
                      dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId = dbo.vueAccountEmployeeTimeEntryApproval.AccountEmployeeTimeEntryPeriodId
                       LEFT OUTER JOIN
                      dbo.vueAccountWorkingDay INNER JOIN
                      dbo.AccountEmployee ON dbo.vueAccountWorkingDay.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId ON 
                      dbo.vueAccountEmployeeTimeEntryApproval.TimeEntryAccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId
WHERE     (dbo.vueAccountEmployeeTimeEntryApproval.Approved = 0) AND (dbo.vueAccountEmployeeTimeEntryApproval.Submitted = 1) AND 
                      (dbo.vueAccountEmployeeTimeEntryApproval.Rejected IS NULL OR
                      dbo.vueAccountEmployeeTimeEntryApproval.Rejected = 0) AND 
                      (dbo.vueAccountEmployeeTimeEntryApproval.AccountEmployeeTimeEntryPeriodId IS NOT NULL) AND 
                      (dbo.vueAccountEmployeeTimeEntryApproval.ApprovalPathSequence IN
                          (SELECT     TOP 1 ApprovalPathSequence
                            FROM          dbo.vueTimesheetApprovalSequence
                            WHERE      (TimeSheetApprovalId IS NULL) AND 
                                                   (AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryApproval.AccountEmployeeTimeEntryId)))
GROUP BY dbo.vueAccountEmployeeTimeEntryApproval.AccountProjectId, dbo.vueAccountEmployeeTimeEntryApproval.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApproval.ProjectManagerEmployeeId, dbo.vueAccountEmployeeTimeEntryApproval.ApprovalTypeName, 
                      dbo.vueAccountEmployeeTimeEntryApproval.AccountApprovalTypeId, dbo.vueAccountEmployeeTimeEntryApproval.SystemApproverTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApproval.AccountExternalUserId, dbo.vueAccountEmployeeTimeEntryApproval.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApproval.ApprovalPathSequence, dbo.vueAccountEmployeeTimeEntryApproval.TimeSheetApprovalPathId, 
                      dbo.vueAccountEmployeeTimeEntryApproval.ProjectName, dbo.vueAccountEmployeeTimeEntryApproval.ProjectDescription, 
                      dbo.vueAccountEmployeeTimeEntryApproval.ProjectCode, dbo.vueAccountEmployeeTimeEntryApproval.TaskName, 
                      dbo.vueAccountEmployeeTimeEntryApproval.AccountProjectTaskId, dbo.vueAccountEmployeeTimeEntryApproval.TaskDescription, 
                      dbo.vueAccountEmployeeTimeEntryApproval.EmployeeName, dbo.vueAccountEmployeeTimeEntryApproval.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApproval.TotalTime, dbo.vueAccountEmployeeTimeEntryApproval.TimeEntryDate, 
                      dbo.vueAccountEmployeeTimeEntryApproval.Comments, dbo.vueAccountEmployeeTimeEntryApproval.IsReject, 
                      dbo.vueAccountEmployeeTimeEntryApproval.IsApproved, dbo.vueAccountApproverType.MaxApprovalPathSequence, 
                      dbo.vueAccountEmployeeTimeEntryApproval.TimeEntryAccountEmployeeId, dbo.vueAccountEmployeeTimeEntryApproval.AccountId, 
                      dbo.vueAccountEmployeeTimeEntryApproval.EMailAddress, dbo.vueAccountEmployeeTimeEntryApproval.Description, 
                      dbo.vueAccountEmployeeTimeEntryApproval.EmployeeManagerId, dbo.vueAccountEmployeeTimeEntryApproval.TotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntryApproval.IsBillable, dbo.vueAccountEmployeeTimeEntryApproval.BillableTotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntryApproval.NonBillableTotalMinutes, dbo.vueAccountEmployeeTimeEntryApproval.Rejected, 
                      dbo.vueAccountEmployeeTimeEntryApproval.AccountApprovalPathId, dbo.vueAccountEmployeeTimeEntryApproval.AccountEmployeeTimeEntryId, 
                      dbo.vueAccountEmployeeTimeEntryApproval.Approved, dbo.vueAccountEmployeeTimeEntryApproval.Submitted, 
                      dbo.vueAccountEmployeeTimeEntryApproval.AccountEmployeeTimeEntryPeriodId, dbo.vueAccountWorkingDay.WeekStartDay, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType'

GO

-- Drop View vueAccountProjectRoleBillingRate
Print 'Drop View vueAccountProjectRoleBillingRate'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountProjectRoleBillingRate' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountProjectRoleBillingRate]

GO
-- Drop View vueAccountProjectEmployeFullJoin
Print 'Drop View vueAccountProjectEmployeFullJoin'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountProjectEmployeFullJoin' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountProjectEmployeFullJoin]

GO
-- Drop View vueAccountProjectTaskEmployee
Print 'Drop View vueAccountProjectTaskEmployee'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountProjectTaskEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountProjectTaskEmployee]

GO
-- Alter Column AccountProjectTaskId on AccountExpenseEntry
Print 'Alter Column AccountProjectTaskId on AccountExpenseEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountExpenseEntry' AND TABLE_TYPE='BASE TABLE')) AND (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='AccountProjectTaskId' AND TABLE_NAME='AccountExpenseEntry'))
ALTER TABLE [dbo].[AccountExpenseEntry]
	 ALTER COLUMN [AccountProjectTaskId] bigint NULL

GO
-- Create View vueAccountProjectTaskEmployee
Print 'Create View vueAccountProjectTaskEmployee'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountProjectTaskEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountProjectTaskEmployee
AS
SELECT     dbo.AccountProjectTaskEmployee.AccountProjectTaskEmployeeId, dbo.AccountProjectTask.AccountProjectId, dbo.AccountProjectTask.AccountProjectTaskId, 
                      dbo.AccountProjectTask.TaskName, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.AccountEmployeeId, 
                      dbo.AccountProject.AccountId, dbo.AccountProject.ProjectCode, dbo.AccountProjectTask.TaskStatusId, dbo.AccountProjectTask.Completed, 
                      dbo.AccountEmployee.EMailAddress, dbo.AccountProject.ProjectName, dbo.AccountProject.IsDeleted AS IsDeletedProject
FROM         dbo.AccountProject RIGHT OUTER JOIN
                      dbo.AccountEmployee RIGHT OUTER JOIN
                      dbo.AccountProjectTaskEmployee INNER JOIN
                      dbo.AccountProjectTask ON dbo.AccountProjectTaskEmployee.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId ON 
                      dbo.AccountEmployee.AccountEmployeeId = dbo.AccountProjectTaskEmployee.AccountEmployeeId ON 
                      dbo.AccountProject.AccountProjectId = dbo.AccountProjectTask.AccountProjectId'

GO
-- Create View vueAccountProjectEmployeFullJoin
Print 'Create View vueAccountProjectEmployeFullJoin'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountProjectEmployeFullJoin' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountProjectEmployeFullJoin
AS
SELECT     dbo.AccountProject.AccountProjectId, dbo.AccountProject.ProjectName, dbo.AccountEmployee.Password, dbo.AccountEmployee.FirstName, 
                      dbo.AccountEmployee.LastName, dbo.AccountEmployee.AccountEmployeeId, dbo.AccountProjectEmployee.AccountProjectEmployeeId, 
                      dbo.AccountEmployee.AccountId, dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS FullName, dbo.AccountProject.LeaderEmployeeId, 
                      dbo.AccountProject.ProjectManagerEmployeeId, dbo.AccountEmployee.EMailAddress, dbo.AccountEmployee.IsDisabled, dbo.AccountEmployee.IsDeleted, 
                      dbo.AccountProject.IsDeleted AS IsDeletedProject
FROM         dbo.AccountProject INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountProject.AccountId = dbo.AccountEmployee.AccountId INNER JOIN
                      dbo.AccountProjectEmployee ON dbo.AccountProject.AccountProjectId = dbo.AccountProjectEmployee.AccountProjectId AND 
                      dbo.AccountEmployee.AccountEmployeeId = dbo.AccountProjectEmployee.AccountEmployeeId'

GO
-- Create View vueAccountProjectRoleBillingRate
Print 'Create View vueAccountProjectRoleBillingRate'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountProjectRoleBillingRate' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountProjectRoleBillingRate
AS
SELECT     dbo.AccountProjectRole.AccountProjectRoleId, dbo.AccountProjectRole.AccountProjectId, dbo.AccountProjectRole.AccountRoleId, 
                      dbo.AccountProjectRole.NumberOfResources, dbo.AccountProjectRole.BillingRate, dbo.AccountProjectRole.BillingTypeId, 
                      dbo.AccountProjectRole.AccountBillingRateId, dbo.AccountProjectEmployee.AccountProjectEmployeeId, dbo.AccountProjectEmployee.AccountEmployeeId, 
                      dbo.AccountEmployee.EMailAddress, dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS FullName, dbo.AccountRole.Role, 
                      dbo.AccountProject.ProjectName, dbo.AccountBillingType.BillingType, dbo.AccountProjectEmployee.AccountId, dbo.AccountProject.IsDeleted AS IsDeletedProject
FROM         dbo.AccountProjectEmployee INNER JOIN
                      dbo.AccountProjectRole ON dbo.AccountProjectEmployee.AccountProjectId = dbo.AccountProjectRole.AccountProjectId AND 
                      dbo.AccountProjectEmployee.AccountRoleId = dbo.AccountProjectRole.AccountRoleId INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountProjectEmployee.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId INNER JOIN
                      dbo.AccountBillingType ON dbo.AccountProjectRole.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId INNER JOIN
                      dbo.AccountRole ON dbo.AccountProjectRole.AccountRoleId = dbo.AccountRole.AccountRoleId INNER JOIN
                      dbo.AccountProject ON dbo.AccountProjectRole.AccountProjectId = dbo.AccountProject.AccountProjectId'

GO
-- Create Foreign Key FK_AccountExpenseEntry_AccountExpenseEntry1 on AccountExpenseEntry
Print 'Create Foreign Key FK_AccountExpenseEntry_AccountExpenseEntry1 on AccountExpenseEntry'
GO
IF NOT EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_SCHEMA='dbo' AND CONSTRAINT_NAME='FK_AccountExpenseEntry_AccountExpenseEntry1' AND TABLE_NAME='AccountExpenseEntry')
BEGIN
		ALTER TABLE [dbo].[AccountExpenseEntry]
			ADD CONSTRAINT [FK_AccountExpenseEntry_AccountExpenseEntry1]
			FOREIGN KEY ([AccountExpenseEntryId]) REFERENCES [dbo].[AccountExpenseEntry] ([AccountExpenseEntryId])
END

GO
-- Create Foreign Key FK_AccountExpenseEntry_AccountProjectTask on AccountExpenseEntry
Print 'Create Foreign Key FK_AccountExpenseEntry_AccountProjectTask on AccountExpenseEntry'
GO
IF NOT EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_SCHEMA='dbo' AND CONSTRAINT_NAME='FK_AccountExpenseEntry_AccountProjectTask' AND TABLE_NAME='AccountExpenseEntry')
BEGIN
		ALTER TABLE [dbo].[AccountExpenseEntry]
			ADD CONSTRAINT [FK_AccountExpenseEntry_AccountProjectTask]
			FOREIGN KEY ([AccountProjectTaskId]) REFERENCES [dbo].[AccountProjectTask] ([AccountProjectTaskId])
END
GO
-- Drop View vueAccountExpenseEntryApprovalPendingEmailWithPreference
Print 'Drop View vueAccountExpenseEntryApprovalPendingEmailWithPreference'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryApprovalPendingEmailWithPreference' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountExpenseEntryApprovalPendingEmailWithPreference]
GO
-- Drop View vueAccountExpenseEntryApprovalPendingEmail
Print 'Drop View vueAccountExpenseEntryApprovalPendingEmail'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryApprovalPendingEmail' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountExpenseEntryApprovalPendingEmail]
GO
-- Drop View vueAccountExpenseEntryWithLastAction
Print 'Drop View vueAccountExpenseEntryWithLastAction'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryWithLastAction' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountExpenseEntryWithLastAction]
GO
-- Drop View vueAccountExpenseEntryApprovalPending
Print 'Drop View vueAccountExpenseEntryApprovalPending'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryApprovalPending' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountExpenseEntryApprovalPending]
GO
-- Drop View vueAccountExpenseEntryApproval
Print 'Drop View vueAccountExpenseEntryApproval'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryApproval' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountExpenseEntryApproval]
GO
-- Drop View vueExpenseApprovalSequence
Print 'Drop View vueExpenseApprovalSequence'
GO
if exists (select * from information_schema.tables where table_name = 'vueExpenseApprovalSequence' and table_type = 'VIEW')
DROP VIEW [dbo].[vueExpenseApprovalSequence]
GO
-- Add Column ApprovalPathSequence to AccountExpenseEntryApproval
Print 'Add Column ApprovalPathSequence to AccountExpenseEntryApproval'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountExpenseEntryApproval' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='ApprovalPathSequence' AND TABLE_NAME='AccountExpenseEntryApproval'))
ALTER TABLE [dbo].[AccountExpenseEntryApproval]
	ADD [ApprovalPathSequence] tinyint NULL
GO
-- Create Index IX_AccountId on AccountTimeOffType
Print 'Create Index IX_AccountId on AccountTimeOffType'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountTimeOffType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountTimeOffType]') AND name = N'IX_AccountId'))
CREATE INDEX [IX_AccountId]
	ON [dbo].[AccountTimeOffType] ([AccountId])
GO
-- Create Index IX_IsTimeOffRequestRequired on AccountTimeOffType
Print 'Create Index IX_IsTimeOffRequestRequired on AccountTimeOffType'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountTimeOffType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountTimeOffType]') AND name = N'IX_IsTimeOffRequestRequired'))
CREATE INDEX [IX_IsTimeOffRequestRequired]
	ON [dbo].[AccountTimeOffType] ([IsTimeOffRequestRequired])
GO
-- Create Index IX_AccountTimeOffTypeId on AccountTimeOffType
Print 'Create Index IX_AccountTimeOffTypeId on AccountTimeOffType'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountTimeOffType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountTimeOffType]') AND name = N'IX_AccountTimeOffTypeId'))
CREATE INDEX [IX_AccountTimeOffTypeId]
	ON [dbo].[AccountTimeOffType] ([AccountTimeOffTypeId])
GO
-- Create View vueExpenseApprovalSequenceSummary
Print 'Create View vueExpenseApprovalSequenceSummary'
GO
if not exists (select * from information_schema.tables where table_name = 'vueExpenseApprovalSequenceSummary' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueExpenseApprovalSequenceSummary
AS
SELECT     dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountExpenseEntry.Amount, 
                      dbo.AccountExpenseEntry.AccountEmployeeId AS ExpenseEntryAccountEmployeeId, dbo.AccountExpenseEntry.AccountEmployeeExpenseSheetId, 
                      dbo.AccountEmployeeExpenseSheet.Description, dbo.AccountEmployeeExpenseSheet.ExpenseSheetDate, dbo.AccountProject.AccountProjectId, 
                      dbo.AccountProject.LeaderEmployeeId, dbo.AccountProject.ProjectManagerEmployeeId, dbo.AccountApprovalPath.AccountApprovalPathId, 
                      dbo.AccountApprovalPath.SystemApproverTypeId, dbo.AccountApprovalPath.AccountExternalUserId, dbo.AccountApprovalPath.ApprovalPathSequence, 
                      dbo.AccountApprovalPath.AccountEmployeeId, dbo.AccountExpenseEntryApproval.IsRejected, dbo.AccountExpenseEntryApproval.IsApproved, 
                      dbo.AccountExpenseEntryApproval.ExpenseApprovalId, dbo.AccountEmployee.EmployeeManagerId, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountEmployee.AccountId, dbo.AccountExpenseEntry.Rejected, dbo.AccountExpenseEntry.Submitted, dbo.AccountExpenseEntry.Approved
FROM         dbo.AccountExpenseEntryApproval RIGHT OUTER JOIN
                      dbo.AccountApprovalPath INNER JOIN
                      dbo.AccountProject ON dbo.AccountApprovalPath.AccountApprovalTypeId = dbo.AccountProject.ExpenseApprovalTypeId RIGHT OUTER JOIN
                      dbo.AccountEmployeeExpenseSheet RIGHT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.AccountExpenseEntry ON dbo.AccountEmployee.AccountEmployeeId = dbo.AccountExpenseEntry.AccountEmployeeId ON 
                      dbo.AccountEmployeeExpenseSheet.AccountEmployeeExpenseSheetId = dbo.AccountExpenseEntry.AccountEmployeeExpenseSheetId ON 
                      dbo.AccountProject.AccountProjectId = dbo.AccountExpenseEntry.AccountProjectId ON 
                      dbo.AccountExpenseEntryApproval.ApprovalPathSequence = dbo.AccountApprovalPath.ApprovalPathSequence AND 
                      dbo.AccountExpenseEntryApproval.AccountExpenseEntryId = dbo.AccountExpenseEntry.AccountExpenseEntryId AND 
                      dbo.AccountExpenseEntryApproval.IsRejected <> 1'
GO
-- Create View vueAccountExpenseEntryApprovalSummary
Print 'Create View vueAccountExpenseEntryApprovalSummary'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryApprovalSummary' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountExpenseEntryApprovalSummary
AS
SELECT     dbo.AccountProject.AccountProjectId, dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, 
                      CASE WHEN Isnull(dbo.AccountExpenseEntry.ExchangeRate, 0) 
                      <> 0 THEN ((dbo.AccountExpenseEntry.Amount / dbo.AccountExpenseEntry.ExchangeRate) * dbo.vueAccountCurrency.ExchangeRate) 
                      ELSE 0 END AS Amount, dbo.AccountExpenseEntry.AccountEmployeeId AS ExpenseEntryAccountEmployeeId, 
                      dbo.AccountExpenseEntry.AccountEmployeeExpenseSheetId, dbo.AccountEmployeeExpenseSheet.Description, 
                      dbo.AccountEmployeeExpenseSheet.ExpenseSheetDate, dbo.AccountProject.LeaderEmployeeId, dbo.AccountProject.ProjectManagerEmployeeId, 
                      dbo.AccountApprovalPath.AccountApprovalPathId, dbo.AccountApprovalPath.SystemApproverTypeId, dbo.AccountApprovalPath.AccountExternalUserId, 
                      dbo.AccountApprovalPath.ApprovalPathSequence, dbo.AccountApprovalPath.AccountEmployeeId, dbo.AccountExpenseEntryApproval.IsRejected, 
                      dbo.AccountExpenseEntryApproval.IsApproved, dbo.AccountExpenseEntryApproval.ExpenseApprovalId, dbo.AccountEmployee.EmployeeManagerId, 
                      dbo.AccountEmployee.EMailAddress, dbo.AccountEmployee.AccountId, dbo.AccountExpenseEntry.AccountExpenseEntryId, 
                      dbo.vueAccountCurrency.CurrencyCode, dbo.AccountExpenseEntry.Approved, dbo.AccountExpenseEntry.Rejected, 
                      dbo.AccountExpenseEntry.Submitted, dbo.AccountEmployeeExpenseSheet.SubmittedDate
FROM         dbo.AccountApprovalPath INNER JOIN
                      dbo.AccountEmployeeExpenseSheet INNER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.AccountExpenseEntry ON dbo.AccountEmployee.AccountEmployeeId = dbo.AccountExpenseEntry.AccountEmployeeId ON 
                      dbo.AccountEmployeeExpenseSheet.AccountEmployeeExpenseSheetId = dbo.AccountExpenseEntry.AccountEmployeeExpenseSheetId INNER JOIN
                      dbo.AccountProject ON dbo.AccountExpenseEntry.AccountProjectId = dbo.AccountProject.AccountProjectId INNER JOIN
                      dbo.AccountApprovalType ON dbo.AccountProject.ExpenseApprovalTypeId = dbo.AccountApprovalType.AccountApprovalTypeId ON 
                      dbo.AccountApprovalPath.AccountApprovalTypeId = dbo.AccountApprovalType.AccountApprovalTypeId INNER JOIN
                      dbo.AccountPreferences ON dbo.AccountExpenseEntry.AccountId = dbo.AccountPreferences.AccountId INNER JOIN
                      dbo.vueAccountCurrency ON dbo.AccountPreferences.AccountBaseCurrencyId = dbo.vueAccountCurrency.AccountCurrencyId LEFT OUTER JOIN
                      dbo.AccountExpenseEntryApproval ON 
                      dbo.AccountApprovalPath.ApprovalPathSequence = dbo.AccountExpenseEntryApproval.ApprovalPathSequence AND 
                      dbo.AccountExpenseEntry.AccountExpenseEntryId = dbo.AccountExpenseEntryApproval.AccountExpenseEntryId AND 
                      dbo.AccountExpenseEntryApproval.IsRejected <> 1'
GO
-- Create View vueAccountExpenseEntryApproval
Print 'Create View vueAccountExpenseEntryApproval'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryApproval' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountExpenseEntryApproval
AS
SELECT     dbo.AccountProject.AccountProjectId, dbo.AccountProject.LeaderEmployeeId, dbo.AccountProject.ProjectManagerEmployeeId, 
                      dbo.AccountApprovalType.ApprovalTypeName, dbo.AccountApprovalPath.AccountApprovalPathId, dbo.AccountApprovalPath.AccountApprovalTypeId, 
                      dbo.AccountApprovalPath.SystemApproverTypeId, dbo.AccountApprovalPath.AccountExternalUserId, dbo.AccountApprovalPath.AccountEmployeeId, 
                      dbo.AccountApprovalPath.ApprovalPathSequence, dbo.AccountExpenseEntry.AccountExpenseEntryId, 
                      dbo.AccountExpenseEntryApproval.ExpenseApprovalId, dbo.AccountExpenseEntryApproval.ExpenseApprovalPathId, dbo.AccountProject.ProjectName, 
                      dbo.AccountProject.ProjectDescription, dbo.AccountProject.ProjectCode, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountExpenseEntry.Approved, 
                      dbo.AccountProject.ExpenseApprovalTypeId, dbo.AccountExpenseEntry.AccountExpenseEntryDate, dbo.AccountExpenseEntryApproval.Comments, 
                      dbo.AccountExpenseEntryApproval.IsRejected, dbo.AccountExpenseEntryApproval.IsApproved, dbo.AccountExpenseEntry.Amount, 
                      dbo.AccountExpense.AccountExpenseName, dbo.AccountExpense.IsBillable, 
                      dbo.AccountExpenseEntry.AccountEmployeeId AS ExpenseEntryAccountEmployeeId, dbo.AccountExpenseEntry.Description, 
                      dbo.AccountExpenseEntry.AccountId, dbo.AccountEmployee.EMailAddress, dbo.AccountExpenseEntry.Submitted, 
                      dbo.AccountEmployee.EmployeeManagerId, dbo.SystemCurrency.CurrencyCode, dbo.AccountExpenseEntry.Rejected, 
                      dbo.AccountExpenseEntry.AccountEmployeeExpenseSheetId, ISNULL(dbo.AccountExpenseEntry.ExchangeRate, 0) AS ExchangeRate, 
                      dbo.AccountEmployeeExpenseSheet.Description AS MasterDescription, dbo.AccountEmployeeExpenseSheet.ExpenseSheetDate, 
                      dbo.AccountEmployeeExpenseSheet.SubmittedDate
FROM         dbo.AccountExpenseEntryApproval RIGHT OUTER JOIN
                      dbo.AccountEmployeeExpenseSheet INNER JOIN
                      dbo.AccountCurrency INNER JOIN
                      dbo.SystemCurrency ON dbo.AccountCurrency.SystemCurrencyId = dbo.SystemCurrency.CurrencyId INNER JOIN
                      dbo.AccountProject INNER JOIN
                      dbo.AccountApprovalType ON dbo.AccountProject.ExpenseApprovalTypeId = dbo.AccountApprovalType.AccountApprovalTypeId INNER JOIN
                      dbo.AccountApprovalPath ON dbo.AccountApprovalType.AccountApprovalTypeId = dbo.AccountApprovalPath.AccountApprovalTypeId INNER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.AccountExpenseEntry ON dbo.AccountEmployee.AccountEmployeeId = dbo.AccountExpenseEntry.AccountEmployeeId ON 
                      dbo.AccountProject.AccountProjectId = dbo.AccountExpenseEntry.AccountProjectId ON 
                      dbo.AccountCurrency.AccountCurrencyId = dbo.AccountExpenseEntry.AccountCurrencyId ON 
                      dbo.AccountEmployeeExpenseSheet.AccountEmployeeExpenseSheetId = dbo.AccountExpenseEntry.AccountEmployeeExpenseSheetId ON 
                      dbo.AccountExpenseEntryApproval.ExpenseApprovalPathId = dbo.AccountApprovalPath.AccountApprovalPathId AND 
                      dbo.AccountExpenseEntryApproval.AccountExpenseEntryId = dbo.AccountExpenseEntry.AccountExpenseEntryId AND 
                      dbo.AccountExpenseEntryApproval.ApprovalPathSequence = dbo.AccountApprovalPath.ApprovalPathSequence AND 
                      dbo.AccountExpenseEntryApproval.IsRejected <> 1 LEFT OUTER JOIN
                      dbo.AccountExpense ON dbo.AccountExpenseEntry.AccountExpenseId = dbo.AccountExpense.AccountExpenseId'
GO
-- Create View vueAccountExpenseEntryApprovalPendingSummary
Print 'Create View vueAccountExpenseEntryApprovalPendingSummary'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryApprovalPendingSummary' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountExpenseEntryApprovalPendingSummary
AS
SELECT     AccountProjectId, EmployeeName, SUM(Amount) AS Amount, ExpenseEntryAccountEmployeeId, AccountEmployeeExpenseSheetId, Description, 
                      ExpenseSheetDate, LeaderEmployeeId, ProjectManagerEmployeeId, AccountExternalUserId, ApprovalPathSequence, AccountEmployeeId, IsRejected, 
                      IsApproved, MAX(ExpenseApprovalId) AS ExpenseApprovalId, Approved, Rejected, Submitted, 
                      CASE WHEN systemapprovertypeid = 1 THEN LeaderEmployeeId WHEN systemapprovertypeid = 2 THEN ProjectManagerEmployeeId WHEN systemapprovertypeid
                       = 3 THEN AccountEmployeeId WHEN systemapprovertypeid = 4 THEN AccountExternalUserId WHEN systemapprovertypeid = 5 THEN EmployeeManagerId
                       END AS ApproverEmployeeId, EmployeeManagerId, EMailAddress, AccountId, SystemApproverTypeId, AccountApprovalPathId, 
                      CurrencyCode AS BaseCurrencyCode, SubmittedDate
FROM         dbo.vueAccountExpenseEntryApprovalSummary
WHERE     (ApprovalPathSequence IN
                          (SELECT     TOP 1 ApprovalPathSequence
                            FROM          dbo.vueExpenseApprovalSequenceSummary
                            WHERE      (ExpenseApprovalId IS NULL) AND 
                                                   (AccountEmployeeExpenseSheetId = dbo.vueAccountExpenseEntryApprovalSummary.AccountEmployeeExpenseSheetId)))
GROUP BY EmployeeName, ExpenseEntryAccountEmployeeId, AccountEmployeeExpenseSheetId, Description, ExpenseSheetDate, AccountProjectId, 
                      LeaderEmployeeId, ProjectManagerEmployeeId, AccountExternalUserId, ApprovalPathSequence, AccountEmployeeId, IsRejected, IsApproved, 
                      Approved, Rejected, Submitted, EmployeeManagerId, EMailAddress, AccountId, SystemApproverTypeId, AccountApprovalPathId, CurrencyCode, 
                      SubmittedDate'
GO
-- Create View vueExpenseApprovalSequence
Print 'Create View vueExpenseApprovalSequence'
GO
if not exists (select * from information_schema.tables where table_name = 'vueExpenseApprovalSequence' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueExpenseApprovalSequence
AS
SELECT     dbo.AccountProject.AccountProjectId, dbo.AccountProject.LeaderEmployeeId, dbo.AccountProject.ProjectManagerEmployeeId, 
                      dbo.AccountApprovalType.ApprovalTypeName, dbo.AccountApprovalPath.AccountApprovalPathId, dbo.AccountApprovalPath.AccountApprovalTypeId, 
                      dbo.AccountApprovalPath.SystemApproverTypeId, dbo.AccountApprovalPath.AccountExternalUserId, dbo.AccountApprovalPath.AccountEmployeeId, 
                      dbo.AccountApprovalPath.ApprovalPathSequence, dbo.AccountExpenseEntry.AccountExpenseEntryId, 
                      dbo.AccountExpenseEntryApproval.ExpenseApprovalId, dbo.AccountExpenseEntryApproval.ExpenseApprovalPathId, dbo.AccountProject.ProjectName, 
                      dbo.AccountProject.ProjectDescription, dbo.AccountProject.ProjectCode, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountExpenseEntry.Approved, 
                      dbo.AccountProject.ExpenseApprovalTypeId, dbo.AccountExpenseEntry.AccountExpenseEntryDate, dbo.AccountExpenseEntryApproval.Comments, 
                      dbo.AccountExpenseEntryApproval.IsRejected, dbo.AccountExpenseEntryApproval.IsApproved, dbo.AccountExpenseEntry.Amount, 
                      dbo.AccountExpense.AccountExpenseName, dbo.AccountExpense.IsBillable, 
                      dbo.AccountExpenseEntry.AccountEmployeeId AS ExpenseEntryAccountEmployeeId, dbo.AccountExpenseEntry.Description, 
                      dbo.AccountExpenseEntry.AccountId, dbo.AccountEmployee.EMailAddress, dbo.AccountExpenseEntry.Submitted, 
                      dbo.AccountEmployee.EmployeeManagerId, dbo.SystemCurrency.CurrencyCode, dbo.AccountExpenseEntry.Rejected, 
                      dbo.AccountExpenseEntry.AccountEmployeeExpenseSheetId, ISNULL(dbo.AccountExpenseEntry.ExchangeRate, 0) AS ExchangeRate, 
                      dbo.AccountEmployeeExpenseSheet.Description AS MasterDescription, dbo.AccountEmployeeExpenseSheet.ExpenseSheetDate, 
                      dbo.AccountEmployeeExpenseSheet.SubmittedDate
FROM         dbo.AccountExpenseEntryApproval RIGHT OUTER JOIN
                      dbo.AccountEmployeeExpenseSheet INNER JOIN
                      dbo.AccountCurrency INNER JOIN
                      dbo.SystemCurrency ON dbo.AccountCurrency.SystemCurrencyId = dbo.SystemCurrency.CurrencyId INNER JOIN
                      dbo.AccountProject INNER JOIN
                      dbo.AccountApprovalType ON dbo.AccountProject.ExpenseApprovalTypeId = dbo.AccountApprovalType.AccountApprovalTypeId INNER JOIN
                      dbo.AccountApprovalPath ON dbo.AccountApprovalType.AccountApprovalTypeId = dbo.AccountApprovalPath.AccountApprovalTypeId INNER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.AccountExpenseEntry ON dbo.AccountEmployee.AccountEmployeeId = dbo.AccountExpenseEntry.AccountEmployeeId ON 
                      dbo.AccountProject.AccountProjectId = dbo.AccountExpenseEntry.AccountProjectId ON 
                      dbo.AccountCurrency.AccountCurrencyId = dbo.AccountExpenseEntry.AccountCurrencyId ON 
                      dbo.AccountEmployeeExpenseSheet.AccountEmployeeExpenseSheetId = dbo.AccountExpenseEntry.AccountEmployeeExpenseSheetId ON 
                      dbo.AccountExpenseEntryApproval.AccountExpenseEntryId = dbo.AccountExpenseEntry.AccountExpenseEntryId AND 
                      dbo.AccountExpenseEntryApproval.ApprovalPathSequence = dbo.AccountApprovalPath.ApprovalPathSequence AND 
                      dbo.AccountExpenseEntryApproval.IsRejected <> 1 LEFT OUTER JOIN
                      dbo.AccountExpense ON dbo.AccountExpenseEntry.AccountExpenseId = dbo.AccountExpense.AccountExpenseId'
GO
-- Create View vueAccountExpenseEntryWithLastAction
Print 'Create View vueAccountExpenseEntryWithLastAction'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryWithLastAction' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountExpenseEntryWithLastAction
AS
SELECT     AccountProjectId, LeaderEmployeeId, ProjectManagerEmployeeId, AccountExternalUserId, AccountEmployeeId, ApprovalPathSequence, 
                      EmployeeName, Approved, IsRejected, IsApproved, ExpenseEntryAccountEmployeeId, AccountExpenseEntryId
FROM         dbo.vueAccountExpenseEntryApproval AS parent
WHERE     (ExpenseApprovalId =
                          (SELECT     MAX(ExpenseApprovalId) AS Expr1
                            FROM          dbo.AccountExpenseEntryApproval
                            WHERE      (AccountExpenseEntryId = parent.AccountExpenseEntryId)))
GROUP BY AccountProjectId, LeaderEmployeeId, ProjectManagerEmployeeId, AccountExternalUserId, AccountEmployeeId, ApprovalPathSequence, 
                      EmployeeName, Approved, IsRejected, IsApproved, ExpenseEntryAccountEmployeeId, AccountExpenseEntryId'
GO
-- Create View vueAccountExpenseEntryApprovalPendingEmail
Print 'Create View vueAccountExpenseEntryApprovalPendingEmail'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryApprovalPendingEmail' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountExpenseEntryApprovalPendingEmail
AS
SELECT     dbo.vueAccountExpenseEntryApprovalPendingSummary.AccountProjectId, dbo.vueAccountExpenseEntryApprovalPendingSummary.EmployeeName, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.Amount, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.ExpenseEntryAccountEmployeeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.AccountEmployeeExpenseSheetId, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.Description, dbo.vueAccountExpenseEntryApprovalPendingSummary.ExpenseSheetDate, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.LeaderEmployeeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.ProjectManagerEmployeeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.AccountExternalUserId, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.ApprovalPathSequence, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.AccountEmployeeId, dbo.vueAccountExpenseEntryApprovalPendingSummary.IsRejected, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.IsApproved, dbo.vueAccountExpenseEntryApprovalPendingSummary.ExpenseApprovalId, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.Approved, dbo.vueAccountExpenseEntryApprovalPendingSummary.Rejected, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.Submitted, dbo.vueAccountExpenseEntryApprovalPendingSummary.ApproverEmployeeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.EmployeeManagerId, dbo.vueAccountExpenseEntryApprovalPendingSummary.EMailAddress, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.AccountId, dbo.vueAccountExpenseEntryApprovalPendingSummary.SystemApproverTypeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.AccountApprovalPathId, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.BaseCurrencyCode, AccountEMailNotificationPreference_1.Monday, 
                      AccountEMailNotificationPreference_1.Tuesday, AccountEMailNotificationPreference_1.Wednesday, AccountEMailNotificationPreference_1.Thursday, 
                      AccountEMailNotificationPreference_1.Friday, AccountEMailNotificationPreference_1.Saturday, AccountEMailNotificationPreference_1.Sunday, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.SubmittedDate
FROM         dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_2 RIGHT OUTER JOIN
                      dbo.vueAccountExpenseEntryApprovalPendingSummary ON 
                      AccountEMailNotificationPreference_2.AccountProjectId = dbo.vueAccountExpenseEntryApprovalPendingSummary.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_1 ON 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.AccountId = AccountEMailNotificationPreference_1.AccountId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference ON 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.ExpenseEntryAccountEmployeeId = dbo.AccountEMailNotificationPreference.AccountEmployeeId
WHERE     (AccountEMailNotificationPreference_1.SystemEMailNotificationId = 26) AND (AccountEMailNotificationPreference_1.Enabled = 1) AND 
                      (AccountEMailNotificationPreference_2.SystemEMailNotificationId = 27) AND (AccountEMailNotificationPreference_2.Enabled = 1) AND 
                      (dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = 28) AND (dbo.AccountEMailNotificationPreference.Enabled = 1)'
GO
-- Create View vueAccountExpenseEntryApprovalPending
Print 'Create View vueAccountExpenseEntryApprovalPending'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryApprovalPending' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountExpenseEntryApprovalPending
AS
SELECT     dbo.vueAccountExpenseEntryApproval.AccountProjectId, dbo.vueAccountExpenseEntryApproval.LeaderEmployeeId, 
                      dbo.vueAccountExpenseEntryApproval.ProjectManagerEmployeeId, dbo.vueAccountExpenseEntryApproval.ApprovalTypeName, 
                      dbo.vueAccountExpenseEntryApproval.AccountApprovalPathId, dbo.vueAccountExpenseEntryApproval.AccountApprovalTypeId, 
                      dbo.vueAccountExpenseEntryApproval.SystemApproverTypeId, dbo.vueAccountExpenseEntryApproval.AccountExternalUserId, 
                      dbo.vueAccountExpenseEntryApproval.AccountEmployeeId, dbo.vueAccountExpenseEntryApproval.ApprovalPathSequence, 
                      dbo.vueAccountExpenseEntryApproval.AccountExpenseEntryId, MAX(dbo.vueAccountExpenseEntryApproval.ExpenseApprovalId) 
                      AS ExpenseApprovalId, dbo.vueAccountExpenseEntryApproval.ExpenseApprovalPathId, dbo.vueAccountExpenseEntryApproval.ProjectName, 
                      dbo.vueAccountExpenseEntryApproval.ProjectDescription, dbo.vueAccountExpenseEntryApproval.ProjectCode, 
                      dbo.vueAccountExpenseEntryApproval.EmployeeName, dbo.vueAccountExpenseEntryApproval.Approved, 
                      dbo.vueAccountExpenseEntryApproval.ExpenseApprovalTypeId, dbo.vueAccountExpenseEntryApproval.AccountExpenseEntryDate, 
                      MAX(dbo.vueAccountExpenseEntryApproval.Comments) AS Comments, dbo.vueAccountExpenseEntryApproval.IsRejected, 
                      dbo.vueAccountExpenseEntryApproval.IsApproved, CASE WHEN MAX(dbo.vueAccountExpenseEntryApproval.ExchangeRate) 
                      <> 0 THEN (dbo.vueAccountExpenseEntryApproval.Amount / MAX(dbo.vueAccountExpenseEntryApproval.ExchangeRate)) 
                      * dbo.vueAccountCurrency.ExchangeRate ELSE 0 END AS Amount, dbo.vueAccountExpenseEntryApproval.AccountExpenseName, 
                      dbo.vueAccountExpenseEntryApproval.IsBillable, dbo.vueAccountApproverType.MaxApprovalPathSequence, 
                      dbo.vueAccountExpenseEntryApproval.ExpenseEntryAccountEmployeeId, dbo.vueAccountExpenseEntryApproval.Description, 
                      dbo.vueAccountExpenseEntryApproval.AccountId, dbo.vueAccountExpenseEntryApproval.EMailAddress, 
                      dbo.vueAccountExpenseEntryApproval.Submitted, dbo.vueAccountExpenseEntryApproval.EmployeeManagerId, 
                      dbo.vueAccountExpenseEntryApproval.CurrencyCode, dbo.vueAccountExpenseEntryApproval.Rejected, 
                      dbo.vueAccountExpenseEntryApproval.AccountEmployeeExpenseSheetId, MAX(dbo.vueAccountCurrency.CurrencyCode) AS BaseCurrencyCode, 
                      MAX(dbo.vueAccountCurrency.Currency) AS BaseCurrency, dbo.vueAccountCurrency.ExchangeRate AS BaseCurrencyExchangeRate, 
                      MAX(dbo.vueAccountExpenseEntryApproval.MasterDescription) AS MasterDescription, MAX(dbo.vueAccountExpenseEntryApproval.ExpenseSheetDate) 
                      AS ExpenseSheetDate, MAX(dbo.vueAccountExpenseEntryApproval.SubmittedDate) AS SubmittedDate
FROM         dbo.vueAccountExpenseEntryApproval INNER JOIN
                      dbo.vueAccountApproverType ON 
                      dbo.vueAccountExpenseEntryApproval.AccountApprovalTypeId = dbo.vueAccountApproverType.AccountApprovalTypeId INNER JOIN
                      dbo.AccountPreferences ON dbo.vueAccountExpenseEntryApproval.AccountId = dbo.AccountPreferences.AccountId INNER JOIN
                      dbo.vueAccountCurrency ON dbo.AccountPreferences.AccountBaseCurrencyId = dbo.vueAccountCurrency.AccountCurrencyId
WHERE     (dbo.vueAccountExpenseEntryApproval.ApprovalPathSequence IN
                          (SELECT     TOP 1 ApprovalPathSequence
                            FROM          dbo.vueExpenseApprovalSequence AS vueExpenseApprovalSequence_1
                            WHERE      (ExpenseApprovalId IS NULL) AND (AccountExpenseEntryId = dbo.vueAccountExpenseEntryApproval.AccountExpenseEntryId))) AND 
                      (dbo.vueAccountExpenseEntryApproval.Approved = 0) AND (dbo.vueAccountExpenseEntryApproval.Submitted = 1) AND 
                      (dbo.vueAccountExpenseEntryApproval.Rejected IS NULL OR
                      dbo.vueAccountExpenseEntryApproval.Rejected = 0)
GROUP BY dbo.vueAccountExpenseEntryApproval.AccountProjectId, dbo.vueAccountExpenseEntryApproval.LeaderEmployeeId, 
                      dbo.vueAccountExpenseEntryApproval.ProjectManagerEmployeeId, dbo.vueAccountExpenseEntryApproval.ApprovalTypeName, 
                      dbo.vueAccountExpenseEntryApproval.AccountApprovalPathId, dbo.vueAccountExpenseEntryApproval.AccountApprovalTypeId, 
                      dbo.vueAccountExpenseEntryApproval.SystemApproverTypeId, dbo.vueAccountExpenseEntryApproval.AccountExternalUserId, 
                      dbo.vueAccountExpenseEntryApproval.AccountEmployeeId, dbo.vueAccountExpenseEntryApproval.ApprovalPathSequence, 
                      dbo.vueAccountExpenseEntryApproval.AccountExpenseEntryId, dbo.vueAccountExpenseEntryApproval.ExpenseApprovalPathId, 
                      dbo.vueAccountExpenseEntryApproval.ProjectName, dbo.vueAccountExpenseEntryApproval.ProjectDescription, 
                      dbo.vueAccountExpenseEntryApproval.ProjectCode, dbo.vueAccountExpenseEntryApproval.EmployeeName, 
                      dbo.vueAccountExpenseEntryApproval.Approved, dbo.vueAccountExpenseEntryApproval.ExpenseApprovalTypeId, 
                      dbo.vueAccountExpenseEntryApproval.AccountExpenseEntryDate, dbo.vueAccountExpenseEntryApproval.IsRejected, 
                      dbo.vueAccountExpenseEntryApproval.IsApproved, dbo.vueAccountExpenseEntryApproval.Amount, 
                      dbo.vueAccountExpenseEntryApproval.AccountExpenseName, dbo.vueAccountExpenseEntryApproval.IsBillable, 
                      dbo.vueAccountApproverType.MaxApprovalPathSequence, dbo.vueAccountExpenseEntryApproval.ExpenseEntryAccountEmployeeId, 
                      dbo.vueAccountExpenseEntryApproval.Description, dbo.vueAccountExpenseEntryApproval.AccountId, 
                      dbo.vueAccountExpenseEntryApproval.EMailAddress, dbo.vueAccountExpenseEntryApproval.Submitted, 
                      dbo.vueAccountExpenseEntryApproval.EmployeeManagerId, dbo.vueAccountExpenseEntryApproval.CurrencyCode, 
                      dbo.vueAccountExpenseEntryApproval.Rejected, dbo.vueAccountExpenseEntryApproval.AccountEmployeeExpenseSheetId, 
                      dbo.vueAccountCurrency.ExchangeRate'
GO
-- Create View vueAccountExpenseEntryApprovalPendingEmailWithPreference
Print 'Create View vueAccountExpenseEntryApprovalPendingEmailWithPreference'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryApprovalPendingEmailWithPreference' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountExpenseEntryApprovalPendingEmailWithPreference
AS
SELECT     dbo.vueAccountExpenseEntryApprovalPendingEmail.AccountProjectId, dbo.vueAccountExpenseEntryApprovalPendingEmail.LeaderEmployeeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.ProjectManagerEmployeeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.AccountApprovalPathId, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.SystemApproverTypeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.AccountExternalUserId, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.ApprovalPathSequence, dbo.vueAccountExpenseEntryApprovalPendingEmail.ExpenseApprovalId, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.EmployeeName, dbo.vueAccountExpenseEntryApprovalPendingEmail.Approved, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.IsRejected, dbo.vueAccountExpenseEntryApprovalPendingEmail.IsApproved, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.Amount, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.ExpenseEntryAccountEmployeeId AS AccountEmployeeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.Description, dbo.vueAccountExpenseEntryApprovalPendingEmail.ApproverEmployeeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.AccountId, dbo.AccountEmployee.EMailAddress AS ApproverEmailAddress, 
                      dbo.AccountPreferences.ScheduledEmailSendTime, dbo.vueAccountExpenseEntryApprovalPendingEmail.EMailAddress, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.EmployeeManagerId, CASE WHEN dbo.AccountPreferences.CultureInfoName IS NULL OR
                      dbo.AccountPreferences.CultureInfoName = ''auto'' THEN ''en-us'' ELSE dbo.AccountPreferences.CultureInfoName END AS CultureInfoName, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.AccountEmployeeExpenseSheetId, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.ExpenseSheetDate, dbo.vueAccountExpenseEntryApprovalPendingEmail.BaseCurrencyCode, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.vueAccountExpenseEntryApprovalPendingEmail.Monday, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.Tuesday, dbo.vueAccountExpenseEntryApprovalPendingEmail.Wednesday, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.Thursday, dbo.vueAccountExpenseEntryApprovalPendingEmail.Friday, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.Saturday, dbo.vueAccountExpenseEntryApprovalPendingEmail.Sunday, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.Rejected, dbo.vueAccountExpenseEntryApprovalPendingEmail.Submitted, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.SubmittedDate
FROM         dbo.vueAccountExpenseEntryApprovalPendingEmail LEFT OUTER JOIN
                      dbo.AccountPreferences ON dbo.vueAccountExpenseEntryApprovalPendingEmail.AccountId = dbo.AccountPreferences.AccountId LEFT OUTER JOIN
                      dbo.AccountEmployee ON 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.ApproverEmployeeId = dbo.AccountEmployee.AccountEmployeeId
WHERE     (dbo.AccountEmployee.IsDeleted <> 1)'
GO
If exists(Select * from SystemData where version = '3.9.0')
BEGIN
Update AccountExpenseEntryApproval
Set AccountExpenseEntryApproval.ApprovalPathSequence = (Select AccountApprovalPath.ApprovalPathSequence
From AccountApprovalPath
Where AccountExpenseEntryApproval.ExpenseApprovalPathId = AccountApprovalPath.AccountApprovalPathId)
Where AccountExpenseEntryApproval.ApprovalPathSequence Is NULL
END
GO
Update SystemData Set Version = '3.9.1' Where Version = '3.9.0' And SystemDataId = 1
GO
-- Drop View vueAccountEmployeeTimeEntryApprovalWithProject
Print 'Drop View vueAccountEmployeeTimeEntryApprovalWithProject'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryApprovalWithProject' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryApprovalWithProject]
GO
-- Create View vueAccountEmployeeTimeEntryApprovalWithProject
Print 'Create View vueAccountEmployeeTimeEntryApprovalWithProject'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryApprovalWithProject' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryApprovalWithProject
AS
SELECT     dbo.AccountEmployeeTimeEntryApproval.TimeSheetApprovalId, dbo.AccountEmployeeTimeEntryApproval.AccountEmployeeTimeEntryId, 
                      dbo.AccountEmployeeTimeEntryApproval.TimeSheetApprovalTypeId, dbo.AccountEmployeeTimeEntryApproval.TimeSheetApprovalPathId, 
                      dbo.AccountEmployeeTimeEntryApproval.ApprovedByEmployeeId, dbo.AccountEmployeeTimeEntryApproval.ApprovedOn, 
                      dbo.AccountEmployeeTimeEntryApproval.Comments, dbo.AccountEmployeeTimeEntryApproval.IsReject, 
                      dbo.AccountEmployeeTimeEntryApproval.IsApproved, dbo.AccountEmployeeTimeEntryApproval.AccountEmployeeTimeEntryPeriodId, 
                      dbo.AccountEmployeeTimeEntryApproval.AccountProjectId, dbo.AccountEmployeeTimeEntryApproval.PreviousStatus, 
                      dbo.AccountEmployeeTimeEntryApproval.BatchId, dbo.AccountEmployeeTimeEntryApproval.ApprovalPathSequence, dbo.AccountProject.ProjectName, 
                      dbo.AccountProject.ProjectDescription, dbo.AccountProject.ProjectCode
FROM         dbo.AccountEmployeeTimeEntryApproval LEFT OUTER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntryApproval.AccountProjectId = dbo.AccountProject.AccountProjectId'

GO
-- Drop View vueAccountEmployeeTimeOffRequest
Print 'Drop View vueAccountEmployeeTimeOffRequest'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOffRequest' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeOffRequest]
GO
-- Add Column IsTimeOffConsumed to AccountEmployeeTimeEntry
Print 'Add Column IsTimeOffConsumed to AccountEmployeeTimeEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntry' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='IsTimeOffConsumed' AND TABLE_NAME='AccountEmployeeTimeEntry'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntry]
	ADD [IsTimeOffConsumed] bit NULL
GO
-- Create View vueAccountEmployeeTimeOffRequest
Print 'Create View vueAccountEmployeeTimeOffRequest'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOffRequest' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeOffRequest
AS
SELECT     dbo.AccountEmployeeTimeOffRequest.AccountEmployeeTimeOffRequestId, dbo.AccountEmployeeTimeOffRequest.AccountTimeOffTypeId, 
                      dbo.AccountEmployeeTimeOffRequest.AccountEmployeeId, dbo.AccountEmployeeTimeOffRequest.RequestSubmitDate, 
                      dbo.AccountEmployeeTimeOffRequest.HoursOff, dbo.AccountEmployeeTimeOffRequest.StartDate, dbo.AccountEmployeeTimeOffRequest.EndDate, 
                      dbo.AccountEmployeeTimeOffRequest.InApproval, dbo.AccountEmployeeTimeOffRequest.Approved, dbo.AccountEmployeeTimeOffRequest.Rejected, 
                      dbo.AccountEmployeeTimeOffRequest.Description, dbo.AccountEmployeeTimeOffRequest.ApprovedOn, 
                      dbo.AccountEmployeeTimeOffRequest.ApprovedBy, dbo.AccountEmployeeTimeOffRequest.DayOff, 
                      dbo.AccountEmployeeTimeOffRequest.CreatedByEmployee, dbo.AccountEmployeeTimeOffRequest.CreatedOn, 
                      dbo.AccountEmployeeTimeOffRequest.ModifiedByEmployeeId, dbo.AccountEmployeeTimeOffRequest.ModifiedOn, 
                      dbo.AccountEmployeeTimeOffRequest.AccountId, dbo.AccountTimeOffType.AccountTimeOffType, dbo.AccountTimeOffType.IsTimeOffRequestRequired, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, 
                      CASE WHEN (dbo.AccountEmployeeTimeOffRequest.Approved IS NULL OR
                      dbo.AccountEmployeeTimeOffRequest.Approved = 0) AND (dbo.AccountEmployeeTimeOffRequest.Rejected IS NULL OR
                      dbo.AccountEmployeeTimeOffRequest.Rejected = 0) 
                      THEN ''Submitted'' WHEN dbo.AccountEmployeeTimeOffRequest.Approved = 1 THEN ''Approved'' WHEN dbo.AccountEmployeeTimeOffRequest.Rejected =
                       1 THEN ''Rejected'' END AS ApprovalStatus, dbo.AccountEmployeeTimeOff.Earned, dbo.AccountEmployeeTimeOff.Consume, 
                      dbo.AccountEmployeeTimeOff.Available, dbo.AccountEmployeeTimeOff.LastEarnedDate, dbo.AccountEmployeeTimeOff.CarryForward, 
                      dbo.AccountEmployeeTimeOff.LastResetDate
FROM         dbo.AccountEmployeeTimeOffRequest INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeOffRequest.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeOff ON dbo.AccountEmployeeTimeOffRequest.AccountEmployeeId = dbo.AccountEmployeeTimeOff.AccountEmployeeId AND 
                      dbo.AccountEmployeeTimeOffRequest.AccountTimeOffTypeId = dbo.AccountEmployeeTimeOff.AccountTimeOffTypeId LEFT OUTER JOIN
                      dbo.AccountTimeOffType ON dbo.AccountEmployeeTimeOffRequest.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId'

GO
If exists(Select * from SystemData where version = '3.9.1')
BEGIN
-- =======================================================
-- Foreign Key Constraint Nochecks's for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print ' Foreign Key Constraint Nochecks''s for Table: [dbo].[SystemSecurityCategoryPage]'

ALTER TABLE [dbo].[SystemSecurityCategoryPage] NOCHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory]
ALTER TABLE [dbo].[SystemSecurityCategoryPage] NOCHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory1]

-- =======================================================
-- Foreign Key Constraint Nochecks's for Table: [dbo].[SystemSecurityCategoryMasterAccountRole]
-- =======================================================
Print ' Foreign Key Constraint Nochecks''s for Table: [dbo].[SystemSecurityCategoryMasterAccountRole]'

ALTER TABLE [dbo].[SystemSecurityCategoryMasterAccountRole] NOCHECK CONSTRAINT [FK_SystemSecurityCategoryMasterAccountRole_MasterAccountRole]
ALTER TABLE [dbo].[SystemSecurityCategoryMasterAccountRole] NOCHECK CONSTRAINT [FK_SystemSecurityCategoryMasterAccountRole_SystemSecurityCategoryMasterAccountRole]

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemSecurityCategoryMasterAccountRole]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemSecurityCategoryMasterAccountRole]'

UPDATE [dbo].[SystemSecurityCategoryMasterAccountRole] SET [ShowAllData]=1, [ShowMyProjectsData]=NULL, [ShowMyTeamsData]=NULL WHERE [SystemSecurityCategoryMasterAccountRoleId]=4

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemSecurityCategoryPage]'

UPDATE [dbo].[SystemSecurityCategoryPage] SET [IsShowDataOptions]=1 WHERE [SystemSecurityCategoryPageId]=37

-- =======================================================
-- Foreign Key Constraint Check's for Table: [dbo].[SystemSecurityCategoryMasterAccountRole]
-- =======================================================
Print ' Foreign Key Constraint Check''s for Table: [dbo].[SystemSecurityCategoryMasterAccountRole]'

ALTER TABLE [dbo].[SystemSecurityCategoryMasterAccountRole] CHECK CONSTRAINT [FK_SystemSecurityCategoryMasterAccountRole_MasterAccountRole]
ALTER TABLE [dbo].[SystemSecurityCategoryMasterAccountRole] CHECK CONSTRAINT [FK_SystemSecurityCategoryMasterAccountRole_SystemSecurityCategoryMasterAccountRole]

-- =======================================================
-- Foreign Key Constraint Check's for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print ' Foreign Key Constraint Check''s for Table: [dbo].[SystemSecurityCategoryPage]'

ALTER TABLE [dbo].[SystemSecurityCategoryPage] CHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory]
ALTER TABLE [dbo].[SystemSecurityCategoryPage] CHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory1]
END
GO
Update SystemData Set Version = '3.9.2' Where Version = '3.9.1' And SystemDataId = 1

GO
-- Drop View rptvueAccountProjectsReport
Print 'Drop View rptvueAccountProjectsReport'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectsReport' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountProjectsReport]

GO
-- Drop View rptvueAccountProjectsTimesheet
Print 'Drop View rptvueAccountProjectsTimesheet'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectsTimesheet' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountProjectsTimesheet]

GO
-- Drop View rptvueAccountProjectsforReport
Print 'Drop View rptvueAccountProjectsforReport'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectsforReport' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountProjectsforReport]

GO
-- Create View rptvueAccountProjectsforReport
Print 'Create View rptvueAccountProjectsforReport'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectsforReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountProjectsforReport
AS
SELECT     dbo.rptvueAccountProjects.AccountProjectId, dbo.rptvueAccountProjects.AccountId, dbo.rptvueAccountProjects.AccountProjectTypeId, 
                      dbo.rptvueAccountProjects.AccountClientId, dbo.rptvueAccountProjects.ProjectBillingTypeId, dbo.rptvueAccountProjects.ProjectName, 
                      dbo.rptvueAccountProjects.ProjectDescription, dbo.rptvueAccountProjects.StartDate, dbo.rptvueAccountProjects.AccountMilestoneId, 
                      dbo.rptvueAccountProjects.Deadline, dbo.rptvueAccountProjects.LeaderEmployeeId, dbo.rptvueAccountProjects.ProjectManagerEmployeeId, 
                      dbo.rptvueAccountProjects.EstimatedTime, dbo.rptvueAccountProjects.EstimatedDurationUnit, dbo.rptvueAccountProjects.ProjectCode, 
                      dbo.rptvueAccountProjects.DefaultBillingRate, dbo.rptvueAccountProjects.IsActive, dbo.rptvueAccountProjects.ProjectStatusId, 
                      dbo.rptvueAccountProjects.AccountPriorityId, dbo.rptvueAccountProjects.CreatedOn, dbo.rptvueAccountProjects.CreatedByEmployeeId, 
                      dbo.rptvueAccountProjects.ModifiedOn, dbo.rptvueAccountProjects.ModifiedByEmployeeId, dbo.rptvueAccountProjects.ProjectBillingRateTypeId, 
                      dbo.rptvueAccountProjects.TimeSheetApprovalTypeId, dbo.rptvueAccountProjects.ExpenseApprovalTypeId, dbo.rptvueAccountProjects.IsDisabled, 
                      dbo.rptvueAccountProjects.IsTemplate, dbo.rptvueAccountProjects.IsProject, dbo.rptvueAccountProjects.AccountProjectTemplateId, 
                      dbo.rptvueAccountProjects.ClientNick, dbo.rptvueAccountProjects.ClientName, dbo.rptvueAccountProjects.ProjectType, dbo.rptvueAccountProjects.BillingType, 
                      dbo.rptvueAccountProjects.Status, dbo.rptvueAccountProjects.EstimatedDuration, dbo.rptvueAccountProjects.AccountClientContactId, 
                      dbo.rptvueAccountProjects.AccountClientDepartmentId, dbo.rptvueAccountProjects.ClientDepartmentCode, dbo.rptvueAccountProjects.ClientDepartmentName, 
                      dbo.rptvueAccountProjects.ClientDepartmentLocation, dbo.rptvueAccountProjects.ExpenseApprovalTypeName, 
                      dbo.rptvueAccountProjects.TimesheetApprovalTypeName, dbo.rptvueAccountProjects.ClientContactName, dbo.rptvueAccountProjects.TeamLead, 
                      dbo.rptvueAccountProjects.ProjectManager, dbo.rptvueAccountProjects.ProjectBillingRateType, dbo.rptvueAccountProjects.BillableTotalHours, 
                      dbo.rptvueAccountProjects.NonBillableTotalHours, dbo.rptvueAccountProjects.TotalEmployeeCost, dbo.rptvueAccountProjects.TotalTimeAmount, 
                      ISNULL(dbo.rptvueAccountProjects.TotalTaskEstimatedCost, 0) AS TotalTaskEstimatedCost, 
                      SUM(CASE WHEN dbo.rptvueAccountExpenseEntry.IsBillable = 1 THEN dbo.rptvueAccountExpenseEntry.NetAmount ELSE 0 END) AS TotalBillableExpense, 
                      SUM(CASE WHEN dbo.rptvueAccountExpenseEntry.IsBillable = 0 THEN dbo.rptvueAccountExpenseEntry.NetAmount ELSE 0 END) AS TotalNonBillableExpense, 
                      ISNULL(SUM(dbo.rptvueAccountExpenseEntry.NetAmount), 0) AS NetAmount, ISNULL(dbo.rptvueAccountProjects.TotalTaskEstimatedHours, 0) 
                      AS TotalTaskEstimatedHours, dbo.rptvueAccountProjects.TotalHours, dbo.rptvueAccountProjects.BillableTimeAmount, 
                      dbo.rptvueAccountProjects.NonBillableTimeAmount, SUM(dbo.rptvueAccountExpenseEntry.CurrencyNetAmount) AS NetAmounts, 
                      dbo.rptvueAccountExpenseEntry.ExchangeRate
FROM         dbo.rptvueAccountProjects LEFT OUTER JOIN
                      dbo.rptvueAccountExpenseEntry ON dbo.rptvueAccountExpenseEntry.AccountProjectId = dbo.rptvueAccountProjects.AccountProjectId
GROUP BY dbo.rptvueAccountProjects.AccountProjectId, dbo.rptvueAccountProjects.AccountId, dbo.rptvueAccountProjects.AccountProjectTypeId, 
                      dbo.rptvueAccountProjects.AccountClientId, dbo.rptvueAccountProjects.ProjectName, dbo.rptvueAccountProjects.ProjectBillingTypeId, 
                      dbo.rptvueAccountProjects.ProjectDescription, dbo.rptvueAccountProjects.StartDate, dbo.rptvueAccountProjects.AccountMilestoneId, 
                      dbo.rptvueAccountProjects.Deadline, dbo.rptvueAccountProjects.LeaderEmployeeId, dbo.rptvueAccountProjects.ProjectManagerEmployeeId, 
                      dbo.rptvueAccountProjects.EstimatedTime, dbo.rptvueAccountProjects.EstimatedDurationUnit, dbo.rptvueAccountProjects.ProjectCode, 
                      dbo.rptvueAccountProjects.DefaultBillingRate, dbo.rptvueAccountProjects.IsActive, dbo.rptvueAccountProjects.ProjectStatusId, 
                      dbo.rptvueAccountProjects.AccountPriorityId, dbo.rptvueAccountProjects.CreatedOn, dbo.rptvueAccountProjects.CreatedByEmployeeId, 
                      dbo.rptvueAccountProjects.ModifiedOn, dbo.rptvueAccountProjects.ModifiedByEmployeeId, dbo.rptvueAccountProjects.ProjectBillingRateTypeId, 
                      dbo.rptvueAccountProjects.TimeSheetApprovalTypeId, dbo.rptvueAccountProjects.ExpenseApprovalTypeId, dbo.rptvueAccountProjects.IsDisabled, 
                      dbo.rptvueAccountProjects.IsTemplate, dbo.rptvueAccountProjects.IsProject, dbo.rptvueAccountProjects.AccountProjectTemplateId, 
                      dbo.rptvueAccountProjects.ClientNick, dbo.rptvueAccountProjects.ClientName, dbo.rptvueAccountProjects.ProjectType, dbo.rptvueAccountProjects.BillingType, 
                      dbo.rptvueAccountProjects.Status, dbo.rptvueAccountProjects.EstimatedDuration, dbo.rptvueAccountProjects.AccountClientContactId, 
                      dbo.rptvueAccountProjects.AccountClientDepartmentId, dbo.rptvueAccountProjects.ClientDepartmentCode, dbo.rptvueAccountProjects.ClientDepartmentName, 
                      dbo.rptvueAccountProjects.ClientDepartmentLocation, dbo.rptvueAccountProjects.ExpenseApprovalTypeName, 
                      dbo.rptvueAccountProjects.TimesheetApprovalTypeName, dbo.rptvueAccountProjects.ClientContactName, dbo.rptvueAccountProjects.TeamLead, 
                      dbo.rptvueAccountProjects.ProjectManager, dbo.rptvueAccountProjects.ProjectBillingRateType, dbo.rptvueAccountProjects.BillableTotalHours, 
                      dbo.rptvueAccountProjects.NonBillableTotalHours, dbo.rptvueAccountProjects.TotalEmployeeCost, dbo.rptvueAccountProjects.TotalTimeAmount, 
                      dbo.rptvueAccountProjects.TotalTaskEstimatedCost, ISNULL(dbo.rptvueAccountProjects.TotalTaskEstimatedHours, 0), dbo.rptvueAccountProjects.TotalHours, 
                      dbo.rptvueAccountProjects.BillableTimeAmount, dbo.rptvueAccountProjects.NonBillableTimeAmount, dbo.rptvueAccountExpenseEntry.ExchangeRate'

GO
-- Create View rptvueAccountProjectsTimesheet
Print 'Create View rptvueAccountProjectsTimesheet'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectsTimesheet' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountProjectsTimesheet
AS
SELECT     dbo.rptvueAccountProjectsforReport.AccountProjectId, dbo.rptvueAccountProjectsforReport.AccountId, dbo.rptvueAccountProjectsforReport.AccountProjectTypeId, 
                      dbo.rptvueAccountProjectsforReport.AccountClientId, dbo.rptvueAccountProjectsforReport.ProjectBillingTypeId, dbo.rptvueAccountProjectsforReport.ProjectName, 
                      dbo.rptvueAccountProjectsforReport.ProjectDescription, dbo.rptvueAccountProjectsforReport.StartDate, dbo.rptvueAccountProjectsforReport.AccountMilestoneId, 
                      dbo.rptvueAccountProjectsforReport.Deadline, dbo.rptvueAccountProjectsforReport.LeaderEmployeeId, 
                      dbo.rptvueAccountProjectsforReport.ProjectManagerEmployeeId, dbo.rptvueAccountProjectsforReport.EstimatedTime, 
                      dbo.rptvueAccountProjectsforReport.EstimatedDurationUnit, dbo.rptvueAccountProjectsforReport.ProjectCode, dbo.rptvueAccountProjectsforReport.DefaultBillingRate, 
                      dbo.rptvueAccountProjectsforReport.IsActive, dbo.rptvueAccountProjectsforReport.ProjectStatusId, dbo.rptvueAccountProjectsforReport.AccountPriorityId, 
                      dbo.rptvueAccountProjectsforReport.CreatedOn, dbo.rptvueAccountProjectsforReport.CreatedByEmployeeId, dbo.rptvueAccountProjectsforReport.ModifiedOn, 
                      dbo.rptvueAccountProjectsforReport.ModifiedByEmployeeId, dbo.rptvueAccountProjectsforReport.ProjectBillingRateTypeId, 
                      dbo.rptvueAccountProjectsforReport.TimeSheetApprovalTypeId, dbo.rptvueAccountProjectsforReport.ExpenseApprovalTypeId, 
                      dbo.rptvueAccountProjectsforReport.IsDisabled, dbo.rptvueAccountProjectsforReport.IsTemplate, dbo.rptvueAccountProjectsforReport.IsProject, 
                      dbo.rptvueAccountProjectsforReport.AccountProjectTemplateId, dbo.rptvueAccountProjectsforReport.ClientNick, dbo.rptvueAccountProjectsforReport.ClientName, 
                      dbo.rptvueAccountProjectsforReport.ProjectType, dbo.rptvueAccountProjectsforReport.BillingType, dbo.rptvueAccountProjectsforReport.Status, 
                      dbo.rptvueAccountProjectsforReport.EstimatedDuration, dbo.rptvueAccountProjectsforReport.AccountClientContactId, 
                      dbo.rptvueAccountProjectsforReport.AccountClientDepartmentId, dbo.rptvueAccountProjectsforReport.ClientDepartmentCode, 
                      dbo.rptvueAccountProjectsforReport.ClientDepartmentName, dbo.rptvueAccountProjectsforReport.ClientDepartmentLocation, 
                      dbo.rptvueAccountProjectsforReport.ExpenseApprovalTypeName, dbo.rptvueAccountProjectsforReport.TimesheetApprovalTypeName, 
                      dbo.rptvueAccountProjectsforReport.ClientContactName, dbo.rptvueAccountProjectsforReport.TeamLead, dbo.rptvueAccountProjectsforReport.ProjectManager, 
                      dbo.rptvueAccountProjectsforReport.ProjectBillingRateType, dbo.rptvueAccountProjectsforReport.BillableTotalHours, 
                      dbo.rptvueAccountProjectsforReport.NonBillableTotalHours, dbo.rptvueAccountProjectsforReport.TotalEmployeeCost, 
                      dbo.rptvueAccountProjectsforReport.TotalTimeAmount, dbo.rptvueAccountProjectsforReport.TotalTaskEstimatedCost, 
                      dbo.rptvueAccountProjectsforReport.TotalBillableExpense, dbo.rptvueAccountProjectsforReport.TotalNonBillableExpense, 
                      dbo.rptvueAccountProjectsforReport.NetAmount, dbo.rptvueAccountProjectsforReport.TotalTaskEstimatedHours, dbo.rptvueAccountProjectsforReport.TotalHours, 
                      dbo.rptvueAccountProjectsforReport.BillableTimeAmount, dbo.rptvueAccountProjectsforReport.NonBillableTimeAmount, SUM(dbo.vueBillingTimesheet.TotalAmount) 
                      AS BilledTimeAmount, ISNULL(dbo.rptvueAccountProjectsforReport.NetAmounts, 0) AS CurrencyNetAmount, 
                      ISNULL(dbo.rptvueAccountProjectsforReport.ExchangeRate, 0) AS ExchangeRate
FROM         dbo.rptvueAccountProjectsforReport LEFT OUTER JOIN
                      dbo.vueBillingTimesheet ON dbo.rptvueAccountProjectsforReport.AccountProjectId = dbo.vueBillingTimesheet.AccountProjectId
GROUP BY dbo.rptvueAccountProjectsforReport.AccountProjectId, dbo.rptvueAccountProjectsforReport.AccountId, dbo.rptvueAccountProjectsforReport.AccountProjectTypeId, 
                      dbo.rptvueAccountProjectsforReport.AccountClientId, dbo.rptvueAccountProjectsforReport.ProjectBillingTypeId, dbo.rptvueAccountProjectsforReport.ProjectName, 
                      dbo.rptvueAccountProjectsforReport.ProjectDescription, dbo.rptvueAccountProjectsforReport.StartDate, dbo.rptvueAccountProjectsforReport.AccountMilestoneId, 
                      dbo.rptvueAccountProjectsforReport.Deadline, dbo.rptvueAccountProjectsforReport.LeaderEmployeeId, 
                      dbo.rptvueAccountProjectsforReport.ProjectManagerEmployeeId, dbo.rptvueAccountProjectsforReport.EstimatedTime, 
                      dbo.rptvueAccountProjectsforReport.EstimatedDurationUnit, dbo.rptvueAccountProjectsforReport.ProjectCode, dbo.rptvueAccountProjectsforReport.DefaultBillingRate, 
                      dbo.rptvueAccountProjectsforReport.IsActive, dbo.rptvueAccountProjectsforReport.ProjectStatusId, dbo.rptvueAccountProjectsforReport.AccountPriorityId, 
                      dbo.rptvueAccountProjectsforReport.CreatedOn, dbo.rptvueAccountProjectsforReport.CreatedByEmployeeId, dbo.rptvueAccountProjectsforReport.ModifiedOn, 
                      dbo.rptvueAccountProjectsforReport.ModifiedByEmployeeId, dbo.rptvueAccountProjectsforReport.ProjectBillingRateTypeId, 
                      dbo.rptvueAccountProjectsforReport.TimeSheetApprovalTypeId, dbo.rptvueAccountProjectsforReport.ExpenseApprovalTypeId, 
                      dbo.rptvueAccountProjectsforReport.IsDisabled, dbo.rptvueAccountProjectsforReport.IsTemplate, dbo.rptvueAccountProjectsforReport.IsProject, 
                      dbo.rptvueAccountProjectsforReport.AccountProjectTemplateId, dbo.rptvueAccountProjectsforReport.ClientNick, dbo.rptvueAccountProjectsforReport.ClientName, 
                      dbo.rptvueAccountProjectsforReport.ProjectType, dbo.rptvueAccountProjectsforReport.BillingType, dbo.rptvueAccountProjectsforReport.Status, 
                      dbo.rptvueAccountProjectsforReport.EstimatedDuration, dbo.rptvueAccountProjectsforReport.AccountClientContactId, 
                      dbo.rptvueAccountProjectsforReport.AccountClientDepartmentId, dbo.rptvueAccountProjectsforReport.ClientDepartmentCode, 
                      dbo.rptvueAccountProjectsforReport.ClientDepartmentName, dbo.rptvueAccountProjectsforReport.ClientDepartmentLocation, 
                      dbo.rptvueAccountProjectsforReport.ExpenseApprovalTypeName, dbo.rptvueAccountProjectsforReport.TimesheetApprovalTypeName, 
                      dbo.rptvueAccountProjectsforReport.ClientContactName, dbo.rptvueAccountProjectsforReport.TeamLead, dbo.rptvueAccountProjectsforReport.ProjectManager, 
                      dbo.rptvueAccountProjectsforReport.ProjectBillingRateType, dbo.rptvueAccountProjectsforReport.BillableTotalHours, 
                      dbo.rptvueAccountProjectsforReport.NonBillableTotalHours, dbo.rptvueAccountProjectsforReport.TotalEmployeeCost, 
                      dbo.rptvueAccountProjectsforReport.TotalTimeAmount, dbo.rptvueAccountProjectsforReport.TotalTaskEstimatedCost, 
                      dbo.rptvueAccountProjectsforReport.TotalBillableExpense, dbo.rptvueAccountProjectsforReport.TotalNonBillableExpense, 
                      dbo.rptvueAccountProjectsforReport.NetAmount, dbo.rptvueAccountProjectsforReport.TotalTaskEstimatedHours, dbo.rptvueAccountProjectsforReport.TotalHours, 
                      dbo.rptvueAccountProjectsforReport.BillableTimeAmount, dbo.rptvueAccountProjectsforReport.NonBillableTimeAmount, 
                      ISNULL(dbo.rptvueAccountProjectsforReport.NetAmounts, 0), ISNULL(dbo.rptvueAccountProjectsforReport.ExchangeRate, 0)'

GO
-- Create View rptvueAccountProjectsReport
Print 'Create View rptvueAccountProjectsReport'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectsReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountProjectsReport
AS
SELECT     dbo.rptvueAccountProjectsTimesheet.AccountProjectId, dbo.rptvueAccountProjectsTimesheet.AccountId, dbo.rptvueAccountProjectsTimesheet.AccountProjectTypeId, 
                      dbo.rptvueAccountProjectsTimesheet.AccountClientId, dbo.rptvueAccountProjectsTimesheet.ProjectBillingTypeId, dbo.rptvueAccountProjectsTimesheet.ProjectName, 
                      dbo.rptvueAccountProjectsTimesheet.ProjectDescription, dbo.rptvueAccountProjectsTimesheet.StartDate, dbo.rptvueAccountProjectsTimesheet.AccountMilestoneId, 
                      dbo.rptvueAccountProjectsTimesheet.Deadline, dbo.rptvueAccountProjectsTimesheet.LeaderEmployeeId, 
                      dbo.rptvueAccountProjectsTimesheet.ProjectManagerEmployeeId, dbo.rptvueAccountProjectsTimesheet.EstimatedTime, 
                      dbo.rptvueAccountProjectsTimesheet.EstimatedDurationUnit, dbo.rptvueAccountProjectsTimesheet.ProjectCode, 
                      dbo.rptvueAccountProjectsTimesheet.DefaultBillingRate, dbo.rptvueAccountProjectsTimesheet.IsActive, dbo.rptvueAccountProjectsTimesheet.ProjectStatusId, 
                      dbo.rptvueAccountProjectsTimesheet.AccountPriorityId, dbo.rptvueAccountProjectsTimesheet.CreatedOn, dbo.rptvueAccountProjectsTimesheet.CreatedByEmployeeId, 
                      dbo.rptvueAccountProjectsTimesheet.ModifiedOn, dbo.rptvueAccountProjectsTimesheet.ModifiedByEmployeeId, 
                      dbo.rptvueAccountProjectsTimesheet.ProjectBillingRateTypeId, dbo.rptvueAccountProjectsTimesheet.TimeSheetApprovalTypeId, 
                      dbo.rptvueAccountProjectsTimesheet.ExpenseApprovalTypeId, dbo.rptvueAccountProjectsTimesheet.IsDisabled, dbo.rptvueAccountProjectsTimesheet.IsTemplate, 
                      dbo.rptvueAccountProjectsTimesheet.IsProject, dbo.rptvueAccountProjectsTimesheet.AccountProjectTemplateId, dbo.rptvueAccountProjectsTimesheet.ClientNick, 
                      dbo.rptvueAccountProjectsTimesheet.ClientName, dbo.rptvueAccountProjectsTimesheet.ProjectType, dbo.rptvueAccountProjectsTimesheet.BillingType, 
                      dbo.rptvueAccountProjectsTimesheet.Status, dbo.rptvueAccountProjectsTimesheet.EstimatedDuration, dbo.rptvueAccountProjectsTimesheet.AccountClientContactId, 
                      dbo.rptvueAccountProjectsTimesheet.AccountClientDepartmentId, dbo.rptvueAccountProjectsTimesheet.ClientDepartmentCode, 
                      dbo.rptvueAccountProjectsTimesheet.ClientDepartmentName, dbo.rptvueAccountProjectsTimesheet.ClientDepartmentLocation, 
                      dbo.rptvueAccountProjectsTimesheet.ExpenseApprovalTypeName, dbo.rptvueAccountProjectsTimesheet.TimesheetApprovalTypeName, 
                      dbo.rptvueAccountProjectsTimesheet.ClientContactName, dbo.rptvueAccountProjectsTimesheet.TeamLead, dbo.rptvueAccountProjectsTimesheet.ProjectManager, 
                      dbo.rptvueAccountProjectsTimesheet.ProjectBillingRateType, dbo.rptvueAccountProjectsTimesheet.BillableTotalHours, 
                      dbo.rptvueAccountProjectsTimesheet.NonBillableTotalHours, dbo.rptvueAccountProjectsTimesheet.TotalEmployeeCost, 
                      dbo.rptvueAccountProjectsTimesheet.TotalTimeAmount, dbo.rptvueAccountProjectsTimesheet.TotalTaskEstimatedCost, 
                      dbo.rptvueAccountProjectsTimesheet.TotalBillableExpense, dbo.rptvueAccountProjectsTimesheet.TotalNonBillableExpense, 
                      dbo.rptvueAccountProjectsTimesheet.NetAmount, dbo.rptvueAccountProjectsTimesheet.TotalTaskEstimatedHours, dbo.rptvueAccountProjectsTimesheet.TotalHours, 
                      dbo.rptvueAccountProjectsTimesheet.BillableTimeAmount, dbo.rptvueAccountProjectsTimesheet.NonBillableTimeAmount, 
                      ISNULL(dbo.rptvueAccountProjectsTimesheet.BilledTimeAmount, 0) AS BilledTimeAmount, ISNULL(SUM(dbo.vueBillingExpense.BilledExpenseAmount), 0) 
                      AS BilledExpenseAmount, dbo.rptvueAccountProjectsTimesheet.CurrencyNetAmount, 
                      dbo.rptvueAccountProjectsTimesheet.ExchangeRate AS CurrencyExchangeRate
FROM         dbo.rptvueAccountProjectsTimesheet LEFT OUTER JOIN
                      dbo.vueBillingExpense ON dbo.rptvueAccountProjectsTimesheet.AccountProjectId = dbo.vueBillingExpense.AccountProjectId
GROUP BY dbo.rptvueAccountProjectsTimesheet.AccountProjectId, dbo.rptvueAccountProjectsTimesheet.AccountId, dbo.rptvueAccountProjectsTimesheet.AccountProjectTypeId, 
                      dbo.rptvueAccountProjectsTimesheet.AccountClientId, dbo.rptvueAccountProjectsTimesheet.ProjectBillingTypeId, dbo.rptvueAccountProjectsTimesheet.ProjectName, 
                      dbo.rptvueAccountProjectsTimesheet.ProjectDescription, dbo.rptvueAccountProjectsTimesheet.StartDate, dbo.rptvueAccountProjectsTimesheet.AccountMilestoneId, 
                      dbo.rptvueAccountProjectsTimesheet.Deadline, dbo.rptvueAccountProjectsTimesheet.LeaderEmployeeId, 
                      dbo.rptvueAccountProjectsTimesheet.ProjectManagerEmployeeId, dbo.rptvueAccountProjectsTimesheet.EstimatedTime, 
                      dbo.rptvueAccountProjectsTimesheet.EstimatedDurationUnit, dbo.rptvueAccountProjectsTimesheet.ProjectCode, 
                      dbo.rptvueAccountProjectsTimesheet.DefaultBillingRate, dbo.rptvueAccountProjectsTimesheet.IsActive, dbo.rptvueAccountProjectsTimesheet.ProjectStatusId, 
                      dbo.rptvueAccountProjectsTimesheet.AccountPriorityId, dbo.rptvueAccountProjectsTimesheet.CreatedOn, dbo.rptvueAccountProjectsTimesheet.CreatedByEmployeeId, 
                      dbo.rptvueAccountProjectsTimesheet.ModifiedOn, dbo.rptvueAccountProjectsTimesheet.ModifiedByEmployeeId, 
                      dbo.rptvueAccountProjectsTimesheet.ProjectBillingRateTypeId, dbo.rptvueAccountProjectsTimesheet.TimeSheetApprovalTypeId, 
                      dbo.rptvueAccountProjectsTimesheet.ExpenseApprovalTypeId, dbo.rptvueAccountProjectsTimesheet.IsDisabled, dbo.rptvueAccountProjectsTimesheet.IsTemplate, 
                      dbo.rptvueAccountProjectsTimesheet.IsProject, dbo.rptvueAccountProjectsTimesheet.AccountProjectTemplateId, dbo.rptvueAccountProjectsTimesheet.ClientNick, 
                      dbo.rptvueAccountProjectsTimesheet.ClientName, dbo.rptvueAccountProjectsTimesheet.ProjectType, dbo.rptvueAccountProjectsTimesheet.BillingType, 
                      dbo.rptvueAccountProjectsTimesheet.Status, dbo.rptvueAccountProjectsTimesheet.EstimatedDuration, dbo.rptvueAccountProjectsTimesheet.AccountClientContactId, 
                      dbo.rptvueAccountProjectsTimesheet.AccountClientDepartmentId, dbo.rptvueAccountProjectsTimesheet.ClientDepartmentCode, 
                      dbo.rptvueAccountProjectsTimesheet.ClientDepartmentName, dbo.rptvueAccountProjectsTimesheet.ClientDepartmentLocation, 
                      dbo.rptvueAccountProjectsTimesheet.ExpenseApprovalTypeName, dbo.rptvueAccountProjectsTimesheet.TimesheetApprovalTypeName, 
                      dbo.rptvueAccountProjectsTimesheet.ClientContactName, dbo.rptvueAccountProjectsTimesheet.TeamLead, dbo.rptvueAccountProjectsTimesheet.ProjectManager, 
                      dbo.rptvueAccountProjectsTimesheet.ProjectBillingRateType, dbo.rptvueAccountProjectsTimesheet.BillableTotalHours, 
                      dbo.rptvueAccountProjectsTimesheet.NonBillableTotalHours, dbo.rptvueAccountProjectsTimesheet.TotalEmployeeCost, 
                      dbo.rptvueAccountProjectsTimesheet.TotalTimeAmount, dbo.rptvueAccountProjectsTimesheet.TotalTaskEstimatedCost, 
                      dbo.rptvueAccountProjectsTimesheet.TotalBillableExpense, dbo.rptvueAccountProjectsTimesheet.TotalNonBillableExpense, 
                      dbo.rptvueAccountProjectsTimesheet.NetAmount, dbo.rptvueAccountProjectsTimesheet.TotalTaskEstimatedHours, dbo.rptvueAccountProjectsTimesheet.TotalHours, 
                      dbo.rptvueAccountProjectsTimesheet.BillableTimeAmount, dbo.rptvueAccountProjectsTimesheet.NonBillableTimeAmount, 
                      dbo.rptvueAccountProjectsTimesheet.BilledTimeAmount, dbo.rptvueAccountProjectsTimesheet.CurrencyNetAmount, 
                      dbo.rptvueAccountProjectsTimesheet.ExchangeRate'

GO

-- Drop View rptvueAccountExpenseEntry
Print 'Drop View rptvueAccountExpenseEntry'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountExpenseEntry' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountExpenseEntry]

GO
-- Drop View vueAccountExpenseEntryForReport
Print 'Drop View vueAccountExpenseEntryForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountExpenseEntryForReport]

GO
-- Create View vueAccountExpenseEntryForReport
Print 'Create View vueAccountExpenseEntryForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountExpenseEntryForReport
AS
SELECT     EmployeeName, AccountExpenseName, ProjectName, AccountExpenseEntryId, AccountExpenseEntryDate, AccountId, AccountEmployeeId, AccountProjectId, 
                      AccountExpenseId, Amount AS NetAmount, TeamLeadApproved, ProjectManagerApproved, AdministratorApproved, ISNULL(Approved, 0) AS Approved, CreatedOn, 
                      CreatedByEmployeeId, ModifiedOn, ModifiedByEmployeeId, PartyName AS ClientName, AccountClientId, ISNULL(Description, N'''') AS Description, ExpenseType, 
                      AccountExpenseTypeId, LeaderEmployeeId, IsBillable, ISNULL(Rejected, 0) AS Rejected, ISNULL(EmployeeCode, N'''') AS EmployeeCode, Reimburse, 
                      AccountCurrencyId, CurrencyCode, IsQuantityField, ISNULL(QuantityFieldCaption, N'''') AS QuantityFieldCaption, AccountBaseCurrencyId, ISNULL(ExchangeRate, 0) 
                      AS ExchangeRate, TaxAmount, NetAmount AS Amount, ISNULL(Submitted, 0) AS Submitted, TimeSheetApprovalTypeId, ExpenseApprovalTypeId, 
                      ProjectManagerEmployeeId, TimeSheetApprovalPathId, EMailAddress, DepartmentName, AccountLocation, ISNULL(AccountTaxZone, N'''') AS AccountTaxZone, 
                      ISNULL(Quantity, 0) AS Quantity, ISNULL(Rate, 0) AS Rate, ISNULL(PaymentMethod, N'''') AS PaymentMethod, AccountLocationId, ISNULL(PartyNick, N'''') AS ClientNick, 
                      ProjectDescription, ISNULL(ProjectCode, N'''') AS ProjectCode, ISNULL(DepartmentCode, N'''') AS DepartmentCode, ISNULL(Comments, N'''') AS Comments, ApprovedOn, 
                      AccountDepartmentId, Role, AccountRoleId, { fn DAYOFMONTH(AccountExpenseEntryDate) } AS DayNo, MONTH(AccountExpenseEntryDate) AS MonthNo, 
                      DATEPART(week, AccountExpenseEntryDate) - DATEPART(week, DATEADD(month, DATEDIFF(month, 0, AccountExpenseEntryDate), 0)) + 1 AS WeekNo, 
                      YEAR(AccountExpenseEntryDate) AS Year, LEFT({ fn MONTHNAME(AccountExpenseEntryDate) }, 3) + '' - '' + CONVERT(nvarchar(10), YEAR(AccountExpenseEntryDate)) 
                      AS Period, { fn DAYNAME(AccountExpenseEntryDate) } AS WeekDayName, InvoiceNumber, InvoiceDate, AccountProjectTypeId, ProjectType, Billed, 
                      AccountEmployeeExpenseSheetId, ExpenseSheetDescription, ExpenseSheetDate, SubmittedDate, SheetApproved, SheetRejected, SheetSubmitted, SheetInApproval, 
                      TaskName, 
                      CASE WHEN dbo.vueAccountExpenseEntry.Reimburse <> 0 THEN dbo.vueAccountExpenseEntry.Amount / dbo.vueAccountExpenseEntry.ExchangeRate ELSE 0 END AS
                       CurrencyReimbursementAmount
FROM         dbo.vueAccountExpenseEntry'

GO
-- Create View rptvueAccountExpenseEntry
Print 'Create View rptvueAccountExpenseEntry'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountExpenseEntry' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountExpenseEntry
AS
SELECT     dbo.vueAccountExpenseEntryForReport.EmployeeName, dbo.vueAccountExpenseEntryForReport.AccountExpenseName, 
                      dbo.vueAccountExpenseEntryForReport.ProjectName, dbo.vueAccountExpenseEntryForReport.AccountExpenseEntryId, 
                      dbo.vueAccountExpenseEntryForReport.AccountExpenseEntryDate, dbo.vueAccountExpenseEntryForReport.AccountId, 
                      dbo.vueAccountExpenseEntryForReport.AccountEmployeeId, dbo.vueAccountExpenseEntryForReport.AccountProjectId, 
                      dbo.vueAccountExpenseEntryForReport.AccountExpenseId, dbo.vueAccountExpenseEntryForReport.Amount, 
                      dbo.vueAccountExpenseEntryForReport.TeamLeadApproved, dbo.vueAccountExpenseEntryForReport.ProjectManagerApproved, 
                      dbo.vueAccountExpenseEntryForReport.AdministratorApproved, dbo.vueAccountExpenseEntryForReport.Approved, dbo.vueAccountExpenseEntryForReport.CreatedOn, 
                      dbo.vueAccountExpenseEntryForReport.CreatedByEmployeeId, dbo.vueAccountExpenseEntryForReport.ModifiedOn, 
                      dbo.vueAccountExpenseEntryForReport.ModifiedByEmployeeId, dbo.vueAccountExpenseEntryForReport.ClientName, 
                      dbo.vueAccountExpenseEntryForReport.AccountClientId, dbo.vueAccountExpenseEntryForReport.Description, dbo.vueAccountExpenseEntryForReport.ExpenseType, 
                      dbo.vueAccountExpenseEntryForReport.AccountExpenseTypeId, dbo.vueAccountExpenseEntryForReport.LeaderEmployeeId, 
                      dbo.vueAccountExpenseEntryForReport.IsBillable, dbo.vueAccountExpenseEntryForReport.Rejected, dbo.vueAccountExpenseEntryForReport.EmployeeCode, 
                      dbo.vueAccountExpenseEntryForReport.Reimburse, dbo.vueAccountExpenseEntryForReport.AccountCurrencyId, 
                      dbo.vueAccountExpenseEntryForReport.CurrencyCode, dbo.vueAccountExpenseEntryForReport.IsQuantityField, 
                      dbo.vueAccountExpenseEntryForReport.QuantityFieldCaption, dbo.vueAccountExpenseEntryForReport.AccountBaseCurrencyId, 
                      dbo.vueAccountExpenseEntryForReport.ExchangeRate, dbo.vueAccountExpenseEntryForReport.TaxAmount, dbo.vueAccountExpenseEntryForReport.NetAmount, 
                      dbo.vueAccountExpenseEntryForReport.Submitted, dbo.vueAccountExpenseEntryForReport.TimeSheetApprovalTypeId, 
                      dbo.vueAccountExpenseEntryForReport.ExpenseApprovalTypeId, dbo.vueAccountExpenseEntryForReport.ProjectManagerEmployeeId, 
                      dbo.vueAccountExpenseEntryForReport.TimeSheetApprovalPathId, dbo.vueAccountExpenseEntryForReport.EMailAddress, 
                      dbo.vueAccountExpenseEntryForReport.DepartmentName, dbo.vueAccountExpenseEntryForReport.AccountLocation, 
                      dbo.vueAccountExpenseEntryForReport.AccountTaxZone, dbo.vueAccountExpenseEntryForReport.Quantity, dbo.vueAccountExpenseEntryForReport.Rate, 
                      dbo.vueAccountExpenseEntryForReport.PaymentMethod, dbo.vueAccountExpenseEntryForReport.AccountLocationId, 
                      dbo.vueAccountExpenseEntryForReport.ClientNick, dbo.vueAccountExpenseEntryForReport.ProjectDescription, dbo.vueAccountExpenseEntryForReport.ProjectCode, 
                      dbo.vueAccountExpenseEntryForReport.DepartmentCode, CASE WHEN vueAccountExpenseEntryForReport.Submitted = 1 AND 
                      vueAccountExpenseEntryForReport.Approved = 0 THEN ''Submitted'' WHEN vueAccountExpenseEntryForReport.Approved = 1 THEN ''Approved'' WHEN vueAccountExpenseEntryForReport.Rejected
                       = 1 THEN ''Rejected'' WHEN vueAccountExpenseEntryForReport.Submitted = 0 AND vueAccountExpenseEntryForReport.Approved = 0 AND 
                      vueAccountExpenseEntryForReport.Rejected = 0 THEN ''Not Submitted'' END AS ApprovalStatus, 
                      dbo.vueAccountExpenseEntryForReport.Comments AS ApproverComments, dbo.vueAccountExpenseEntryForReport.ApprovedOn, 
                      dbo.vueAccountExpenseEntryForReport.AccountDepartmentId, dbo.vueAccountExpenseEntryForReport.Role, dbo.vueAccountExpenseEntryForReport.AccountRoleId, 
                      dbo.vueAccountExpenseEntryForReport.DayNo, dbo.vueAccountExpenseEntryForReport.MonthNo, dbo.vueAccountExpenseEntryForReport.WeekNo, 
                      dbo.vueAccountExpenseEntryForReport.Year, dbo.vueAccountExpenseEntryForReport.Period, dbo.vueAccountExpenseEntryForReport.WeekDayName, 
                      CASE WHEN dbo.vueAccountExpenseEntryForReport.ExchangeRate > 0 THEN dbo.vueAccountExpenseEntryForReport.NetAmount / dbo.vueAccountExpenseEntryForReport.ExchangeRate
                       ELSE 0 END AS CurrencyNetAmount, 
                      CASE WHEN dbo.vueAccountExpenseEntryForReport.ExchangeRate > 0 THEN dbo.vueAccountExpenseEntryForReport.Amount / dbo.vueAccountExpenseEntryForReport.ExchangeRate
                       ELSE 0 END AS CurrencyAmount, 
                      CASE WHEN dbo.vueAccountExpenseEntryForReport.ExchangeRate > 0 THEN dbo.vueAccountExpenseEntryForReport.TaxAmount / dbo.vueAccountExpenseEntryForReport.ExchangeRate
                       ELSE 0 END AS CurrencyTaxAmount, dbo.vueAccountExpenseEntryForReport.InvoiceNumber, dbo.vueAccountExpenseEntryForReport.InvoiceDate, 
                      dbo.vueAccountExpenseEntryForReport.AccountProjectTypeId, dbo.vueAccountExpenseEntryForReport.ProjectType, dbo.vueAccountExpenseEntryForReport.Billed, 
                      dbo.vueAccountExpenseEntryForReport.AccountEmployeeExpenseSheetId, dbo.vueAccountExpenseEntryForReport.ExpenseSheetDescription, 
                      dbo.vueAccountExpenseEntryForReport.ExpenseSheetDate, dbo.vueAccountExpenseEntryForReport.SubmittedDate, 
                      dbo.vueAccountExpenseEntryForReport.SheetApproved, dbo.vueAccountExpenseEntryForReport.SheetRejected, 
                      dbo.vueAccountExpenseEntryForReport.SheetSubmitted, dbo.vueAccountExpenseEntryForReport.SheetInApproval, dbo.vueAccountExpenseEntryForReport.TaskName, 
                      CASE WHEN dbo.vueAccountCurrency.ExchangeRate > 0 THEN dbo.vueAccountExpenseEntryForReport.CurrencyReimbursementAmount * dbo.vueAccountCurrency.ExchangeRate
                       ELSE 0 END AS ReimbursementAmount, dbo.vueAccountCurrency.ExchangeRate AS ReimbursementExchangeRate, 
                      dbo.vueAccountCurrency.CurrencyCode AS ReimbursementCurrencyCode
FROM         dbo.vueAccountExpenseEntryForReport INNER JOIN
                      dbo.AccountPreferences ON dbo.vueAccountExpenseEntryForReport.AccountId = dbo.AccountPreferences.AccountId INNER JOIN
                      dbo.vueAccountCurrency ON dbo.AccountPreferences.AccountReimbursementCurrencyId = dbo.vueAccountCurrency.AccountCurrencyId'

GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'
if not exists(Select * from [dbo].[SystemReportDataSourceField] where [SystemReportDataSourceFieldId] = 'dcae4ff1-f92d-4e4c-a463-392fce867d0a')
BEGIN
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('dcae4ff1-f92d-4e4c-a463-392fce867d0a', '7e5678a3-d1bc-4bb4-8fd1-75cab80388ba', N'BaseCurrencyNetAmount', 110, 0, N'ParameterCurrencyCode', N'CurrencyNetAmount*ParameterCurrencyExchangeRate', 45, '0da31ddc-9040-46fa-a33a-74e06a645050', N'Expense Amount (BaseCurrency)', 1, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('d9aa2266-ddc8-4f77-9c96-049af162e8f4', '0f2d1d68-826d-400e-bf9f-95d4a9d6c4e0', N'ReimbursementAmount', 120, 0, N'ReimbursementCurrencyCode', NULL, 52, '0da31ddc-9040-46fa-a33a-74e06a645050', N'Reimbursement Amount', 0, 0)

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportFilterSourceMapping]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportFilterSourceMapping]'

INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('243cca62-fcf3-4986-958a-75416c08d447', '9924da4a-2907-4368-a803-99c0c6f9ffff', '7e5678a3-d1bc-4bb4-8fd1-75cab80388ba', 0, 0, 4)

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'

UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=98 WHERE [SystemReportDataSourceFieldId]='daf2b619-50fd-4afe-9e3b-4f48587ac18b'
UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=97 WHERE [SystemReportDataSourceFieldId]='bbf83e4a-27b4-46b6-900d-21f377d460ed'
UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=95 WHERE [SystemReportDataSourceFieldId]='a5b9e183-e9e0-46b8-a721-294e543579f5'
UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=96 WHERE [SystemReportDataSourceFieldId]='2710bbd5-66b0-44ba-bf41-17fbadeac5e3'
UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=99 WHERE [SystemReportDataSourceFieldId]='5d920bfb-b7f7-4bec-a6d6-13862db32199'

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportFilterSourceMapping]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportFilterSourceMapping]'

UPDATE [dbo].[SystemReportFilterSourceMapping] SET [FilterSequence]=5 WHERE [SystemReportFilterMappingId]='921042be-fe69-4e85-8a3d-d2d960c712cb'
END
GO
-- Drop View vueAccountEmployeeTimeEntryApprovalForTimeOff
Print 'Drop View vueAccountEmployeeTimeEntryApprovalForTimeOff'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryApprovalForTimeOff' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryApprovalForTimeOff]
GO
-- Drop View vueTimeSheetApprovalSequenceForTimeOff
Print 'Drop View vueTimeSheetApprovalSequenceForTimeOff'
GO
if exists (select * from information_schema.tables where table_name = 'vueTimeSheetApprovalSequenceForTimeOff' and table_type = 'VIEW')
DROP VIEW [dbo].[vueTimeSheetApprovalSequenceForTimeOff]
GO
-- Create View vueTimeSheetApprovalSequenceForTimeOff
Print 'Create View vueTimeSheetApprovalSequenceForTimeOff'
GO
if not exists (select * from information_schema.tables where table_name = 'vueTimeSheetApprovalSequenceForTimeOff' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueTimeSheetApprovalSequenceForTimeOff
AS
SELECT     dbo.AccountApprovalType.ApprovalTypeName, dbo.AccountApprovalPath.AccountApprovalPathId, dbo.AccountApprovalPath.AccountApprovalTypeId, 
                      dbo.AccountApprovalPath.SystemApproverTypeId, dbo.AccountApprovalPath.AccountExternalUserId, dbo.AccountApprovalPath.AccountEmployeeId, 
                      dbo.AccountApprovalPath.ApprovalPathSequence, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, 
                      dbo.AccountEmployeeTimeEntryApproval.TimeSheetApprovalId, dbo.AccountEmployeeTimeEntryApproval.TimeSheetApprovalPathId, 
                      dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName
FROM         dbo.AccountEmployeeTimeEntry INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeEntry.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId INNER JOIN
                      dbo.AccountApprovalType ON dbo.AccountEmployee.TimeOffApprovalTypeId = dbo.AccountApprovalType.AccountApprovalTypeId INNER JOIN
                      dbo.AccountApprovalPath ON dbo.AccountApprovalType.AccountApprovalTypeId = dbo.AccountApprovalPath.AccountApprovalTypeId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryApproval ON 
                      dbo.AccountApprovalPath.AccountApprovalPathId = dbo.AccountEmployeeTimeEntryApproval.TimeSheetApprovalPathId AND 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId = dbo.AccountEmployeeTimeEntryApproval.AccountEmployeeTimeEntryId AND 
                      dbo.AccountEmployeeTimeEntryApproval.IsReject <> 1 AND 
                      dbo.AccountApprovalType.AccountApprovalTypeId = dbo.AccountEmployeeTimeEntryApproval.TimeSheetApprovalTypeId
WHERE     (dbo.AccountEmployeeTimeEntry.IsTimeOff = 1) AND (dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeOffRequestId IS NULL)'
GO
-- Create View vueAccountEmployeeTimeEntryApprovalForTimeOff
Print 'Create View vueAccountEmployeeTimeEntryApprovalForTimeOff'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryApprovalForTimeOff' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff
AS
SELECT     dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, dbo.AccountEmployeeTimeEntry.AccountEmployeeId AS TimeEntryAccountEmployeeId, 
                      dbo.AccountEmployeeTimeEntry.TimeEntryDate, dbo.AccountEmployeeTimeEntry.StartTime, dbo.AccountEmployeeTimeEntry.EndTime, 
                      dbo.AccountEmployeeTimeEntry.TotalTime, dbo.AccountEmployeeTimeEntry.Description, dbo.AccountEmployeeTimeEntry.Approved, 
                      dbo.AccountEmployeeTimeEntry.AdministratorApproved, dbo.AccountEmployeeTimeEntry.CreatedOn, dbo.AccountEmployeeTimeEntry.Rejected, 
                      dbo.AccountEmployeeTimeEntry.Submitted, dbo.AccountEmployeeTimeEntry.IsTimeOff, dbo.AccountEmployeeTimeEntry.Hours, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeOffRequestId, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountApprovalType.ApprovalTypeName, 
                      dbo.AccountApprovalType.AccountApprovalTypeId, dbo.AccountApprovalPath.AccountApprovalPathId, dbo.AccountApprovalPath.SystemApproverTypeId, 
                      dbo.AccountApprovalPath.AccountExternalUserId, dbo.AccountApprovalPath.ApprovalPathSequence, dbo.AccountApprovalPath.AccountEmployeeId, 
                      dbo.AccountEmployee.EmployeeManagerId, dbo.AccountEmployeeTimeEntry.ModifiedOn, 
                      dbo.AccountEmployeeTimeEntryApproval.TimeSheetApprovalId, dbo.AccountEmployeeTimeEntryApproval.ApprovedByEmployeeId, 
                      dbo.AccountEmployeeTimeEntryApproval.Comments, dbo.AccountEmployeeTimeEntryApproval.IsReject, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountTimeOffType.AccountTimeOffType, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, 
                      dbo.AccountEmployeeTimeEntry.TotalTime) AS TotalMinutes, dbo.AccountEmployeeTimeEntryApproval.IsApproved, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId
FROM         dbo.AccountEmployeeTimeEntry INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeEntry.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId INNER JOIN
                      dbo.AccountApprovalType ON dbo.AccountEmployee.TimeOffApprovalTypeId = dbo.AccountApprovalType.AccountApprovalTypeId INNER JOIN
                      dbo.AccountApprovalPath ON dbo.AccountApprovalType.AccountApprovalTypeId = dbo.AccountApprovalPath.AccountApprovalTypeId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryApproval ON 
                      dbo.AccountApprovalPath.AccountApprovalPathId = dbo.AccountEmployeeTimeEntryApproval.TimeSheetApprovalPathId AND 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId = dbo.AccountEmployeeTimeEntryApproval.AccountEmployeeTimeEntryId AND 
                      dbo.AccountEmployeeTimeEntryApproval.IsReject <> 1 AND 
                      dbo.AccountApprovalType.AccountApprovalTypeId = dbo.AccountEmployeeTimeEntryApproval.TimeSheetApprovalTypeId LEFT OUTER JOIN
                      dbo.AccountTimeOffType ON dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId
WHERE     (dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeOffRequestId IS NULL) AND (dbo.AccountEmployeeTimeEntry.IsTimeOff = 1)'

GO

-- Drop View rptvueAccountExpenseEntry
Print 'Drop View rptvueAccountExpenseEntry'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountExpenseEntry' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountExpenseEntry]

GO
-- Drop View vueAccountExpenseEntryForReport
Print 'Drop View vueAccountExpenseEntryForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountExpenseEntryForReport]

GO
-- Create View vueAccountExpenseEntryForReport
Print 'Create View vueAccountExpenseEntryForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountExpenseEntryForReport
AS
SELECT     EmployeeName, AccountExpenseName, ProjectName, AccountExpenseEntryId, AccountExpenseEntryDate, AccountId, AccountEmployeeId, AccountProjectId, 
                      AccountExpenseId, Amount AS NetAmount, TeamLeadApproved, ProjectManagerApproved, AdministratorApproved, ISNULL(Approved, 0) AS Approved, CreatedOn, 
                      CreatedByEmployeeId, ModifiedOn, ModifiedByEmployeeId, PartyName AS ClientName, AccountClientId, ISNULL(Description, N'''') AS Description, ExpenseType, 
                      AccountExpenseTypeId, LeaderEmployeeId, IsBillable, ISNULL(Rejected, 0) AS Rejected, ISNULL(EmployeeCode, N'''') AS EmployeeCode, Reimburse, 
                      AccountCurrencyId, CurrencyCode, IsQuantityField, ISNULL(QuantityFieldCaption, N'''') AS QuantityFieldCaption, AccountBaseCurrencyId, ISNULL(ExchangeRate, 0) 
                      AS ExchangeRate, TaxAmount, NetAmount AS Amount, ISNULL(Submitted, 0) AS Submitted, TimeSheetApprovalTypeId, ExpenseApprovalTypeId, 
                      ProjectManagerEmployeeId, TimeSheetApprovalPathId, EMailAddress, DepartmentName, AccountLocation, ISNULL(AccountTaxZone, N'''') AS AccountTaxZone, 
                      ISNULL(Quantity, 0) AS Quantity, ISNULL(Rate, 0) AS Rate, ISNULL(PaymentMethod, N'''') AS PaymentMethod, AccountLocationId, ISNULL(PartyNick, N'''') AS ClientNick, 
                      ProjectDescription, ISNULL(ProjectCode, N'''') AS ProjectCode, ISNULL(DepartmentCode, N'''') AS DepartmentCode, ISNULL(Comments, N'''') AS Comments, ApprovedOn, 
                      AccountDepartmentId, Role, AccountRoleId, { fn DAYOFMONTH(AccountExpenseEntryDate) } AS DayNo, MONTH(AccountExpenseEntryDate) AS MonthNo, 
                      DATEPART(week, AccountExpenseEntryDate) - DATEPART(week, DATEADD(month, DATEDIFF(month, 0, AccountExpenseEntryDate), 0)) + 1 AS WeekNo, 
                      YEAR(AccountExpenseEntryDate) AS Year, LEFT({ fn MONTHNAME(AccountExpenseEntryDate) }, 3) + '' - '' + CONVERT(nvarchar(10), YEAR(AccountExpenseEntryDate)) 
                      AS Period, { fn DAYNAME(AccountExpenseEntryDate) } AS WeekDayName, InvoiceNumber, InvoiceDate, AccountProjectTypeId, ProjectType, Billed, 
                      AccountEmployeeExpenseSheetId, ExpenseSheetDescription, ExpenseSheetDate, SubmittedDate, SheetApproved, SheetRejected, SheetSubmitted, SheetInApproval, 
                      TaskName, 
                      CASE WHEN dbo.vueAccountExpenseEntry.Reimburse <> 0 THEN dbo.vueAccountExpenseEntry.Amount / dbo.vueAccountExpenseEntry.ExchangeRate ELSE 0 END AS
                       CurrencyReimbursementAmount, 
                      CASE WHEN dbo.vueAccountExpenseEntry.IsBillable <> 0 THEN dbo.vueAccountExpenseEntry.Amount ELSE 0 END AS BillableAmount
FROM         dbo.vueAccountExpenseEntry'

GO
-- Create View rptvueAccountExpenseEntry
Print 'Create View rptvueAccountExpenseEntry'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountExpenseEntry' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountExpenseEntry
AS
SELECT     dbo.vueAccountExpenseEntryForReport.EmployeeName, dbo.vueAccountExpenseEntryForReport.AccountExpenseName, 
                      dbo.vueAccountExpenseEntryForReport.ProjectName, dbo.vueAccountExpenseEntryForReport.AccountExpenseEntryId, 
                      dbo.vueAccountExpenseEntryForReport.AccountExpenseEntryDate, dbo.vueAccountExpenseEntryForReport.AccountId, 
                      dbo.vueAccountExpenseEntryForReport.AccountEmployeeId, dbo.vueAccountExpenseEntryForReport.AccountProjectId, 
                      dbo.vueAccountExpenseEntryForReport.AccountExpenseId, dbo.vueAccountExpenseEntryForReport.Amount, 
                      dbo.vueAccountExpenseEntryForReport.TeamLeadApproved, dbo.vueAccountExpenseEntryForReport.ProjectManagerApproved, 
                      dbo.vueAccountExpenseEntryForReport.AdministratorApproved, dbo.vueAccountExpenseEntryForReport.Approved, dbo.vueAccountExpenseEntryForReport.CreatedOn, 
                      dbo.vueAccountExpenseEntryForReport.CreatedByEmployeeId, dbo.vueAccountExpenseEntryForReport.ModifiedOn, 
                      dbo.vueAccountExpenseEntryForReport.ModifiedByEmployeeId, dbo.vueAccountExpenseEntryForReport.ClientName, 
                      dbo.vueAccountExpenseEntryForReport.AccountClientId, dbo.vueAccountExpenseEntryForReport.Description, dbo.vueAccountExpenseEntryForReport.ExpenseType, 
                      dbo.vueAccountExpenseEntryForReport.AccountExpenseTypeId, dbo.vueAccountExpenseEntryForReport.LeaderEmployeeId, 
                      dbo.vueAccountExpenseEntryForReport.IsBillable, dbo.vueAccountExpenseEntryForReport.Rejected, dbo.vueAccountExpenseEntryForReport.EmployeeCode, 
                      dbo.vueAccountExpenseEntryForReport.Reimburse, dbo.vueAccountExpenseEntryForReport.AccountCurrencyId, 
                      dbo.vueAccountExpenseEntryForReport.CurrencyCode, dbo.vueAccountExpenseEntryForReport.IsQuantityField, 
                      dbo.vueAccountExpenseEntryForReport.QuantityFieldCaption, dbo.vueAccountExpenseEntryForReport.AccountBaseCurrencyId, 
                      dbo.vueAccountExpenseEntryForReport.ExchangeRate, dbo.vueAccountExpenseEntryForReport.TaxAmount, dbo.vueAccountExpenseEntryForReport.NetAmount, 
                      dbo.vueAccountExpenseEntryForReport.Submitted, dbo.vueAccountExpenseEntryForReport.TimeSheetApprovalTypeId, 
                      dbo.vueAccountExpenseEntryForReport.ExpenseApprovalTypeId, dbo.vueAccountExpenseEntryForReport.ProjectManagerEmployeeId, 
                      dbo.vueAccountExpenseEntryForReport.TimeSheetApprovalPathId, dbo.vueAccountExpenseEntryForReport.EMailAddress, 
                      dbo.vueAccountExpenseEntryForReport.DepartmentName, dbo.vueAccountExpenseEntryForReport.AccountLocation, 
                      dbo.vueAccountExpenseEntryForReport.AccountTaxZone, dbo.vueAccountExpenseEntryForReport.Quantity, dbo.vueAccountExpenseEntryForReport.Rate, 
                      dbo.vueAccountExpenseEntryForReport.PaymentMethod, dbo.vueAccountExpenseEntryForReport.AccountLocationId, 
                      dbo.vueAccountExpenseEntryForReport.ClientNick, dbo.vueAccountExpenseEntryForReport.ProjectDescription, dbo.vueAccountExpenseEntryForReport.ProjectCode, 
                      dbo.vueAccountExpenseEntryForReport.DepartmentCode, CASE WHEN vueAccountExpenseEntryForReport.Submitted = 1 AND 
                      vueAccountExpenseEntryForReport.Approved = 0 THEN ''Submitted'' WHEN vueAccountExpenseEntryForReport.Approved = 1 THEN ''Approved'' WHEN vueAccountExpenseEntryForReport.Rejected
                       = 1 THEN ''Rejected'' WHEN vueAccountExpenseEntryForReport.Submitted = 0 AND vueAccountExpenseEntryForReport.Approved = 0 AND 
                      vueAccountExpenseEntryForReport.Rejected = 0 THEN ''Not Submitted'' END AS ApprovalStatus, 
                      dbo.vueAccountExpenseEntryForReport.Comments AS ApproverComments, dbo.vueAccountExpenseEntryForReport.ApprovedOn, 
                      dbo.vueAccountExpenseEntryForReport.AccountDepartmentId, dbo.vueAccountExpenseEntryForReport.Role, dbo.vueAccountExpenseEntryForReport.AccountRoleId, 
                      dbo.vueAccountExpenseEntryForReport.DayNo, dbo.vueAccountExpenseEntryForReport.MonthNo, dbo.vueAccountExpenseEntryForReport.WeekNo, 
                      dbo.vueAccountExpenseEntryForReport.Year, dbo.vueAccountExpenseEntryForReport.Period, dbo.vueAccountExpenseEntryForReport.WeekDayName, 
                      CASE WHEN dbo.vueAccountExpenseEntryForReport.ExchangeRate > 0 THEN dbo.vueAccountExpenseEntryForReport.NetAmount / dbo.vueAccountExpenseEntryForReport.ExchangeRate
                       ELSE 0 END AS CurrencyNetAmount, 
                      CASE WHEN dbo.vueAccountExpenseEntryForReport.ExchangeRate > 0 THEN dbo.vueAccountExpenseEntryForReport.Amount / dbo.vueAccountExpenseEntryForReport.ExchangeRate
                       ELSE 0 END AS CurrencyAmount, 
                      CASE WHEN dbo.vueAccountExpenseEntryForReport.ExchangeRate > 0 THEN dbo.vueAccountExpenseEntryForReport.TaxAmount / dbo.vueAccountExpenseEntryForReport.ExchangeRate
                       ELSE 0 END AS CurrencyTaxAmount, dbo.vueAccountExpenseEntryForReport.InvoiceNumber, dbo.vueAccountExpenseEntryForReport.InvoiceDate, 
                      dbo.vueAccountExpenseEntryForReport.AccountProjectTypeId, dbo.vueAccountExpenseEntryForReport.ProjectType, dbo.vueAccountExpenseEntryForReport.Billed, 
                      dbo.vueAccountExpenseEntryForReport.AccountEmployeeExpenseSheetId, dbo.vueAccountExpenseEntryForReport.ExpenseSheetDescription, 
                      dbo.vueAccountExpenseEntryForReport.ExpenseSheetDate, dbo.vueAccountExpenseEntryForReport.SubmittedDate, 
                      dbo.vueAccountExpenseEntryForReport.SheetApproved, dbo.vueAccountExpenseEntryForReport.SheetRejected, 
                      dbo.vueAccountExpenseEntryForReport.SheetSubmitted, dbo.vueAccountExpenseEntryForReport.SheetInApproval, dbo.vueAccountExpenseEntryForReport.TaskName, 
                      CASE WHEN dbo.vueAccountCurrency.ExchangeRate > 0 THEN dbo.vueAccountExpenseEntryForReport.CurrencyReimbursementAmount * dbo.vueAccountCurrency.ExchangeRate
                       ELSE 0 END AS ReimbursementAmount, dbo.vueAccountCurrency.ExchangeRate AS ReimbursementExchangeRate, 
                      dbo.vueAccountCurrency.CurrencyCode AS ReimbursementCurrencyCode, dbo.vueAccountExpenseEntryForReport.BillableAmount
FROM         dbo.vueAccountExpenseEntryForReport INNER JOIN
                      dbo.AccountPreferences ON dbo.vueAccountExpenseEntryForReport.AccountId = dbo.AccountPreferences.AccountId INNER JOIN
                      dbo.vueAccountCurrency ON dbo.AccountPreferences.AccountReimbursementCurrencyId = dbo.vueAccountCurrency.AccountCurrencyId'

GO

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'
if not exists(Select * from [dbo].[SystemReportDataSourceField] where [SystemReportDataSourceFieldId] = 'd5967178-9cd8-4cb5-bc65-32cac2e1d8cb')
BEGIN
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('d5967178-9cd8-4cb5-bc65-32cac2e1d8cb', '0f2d1d68-826d-400e-bf9f-95d4a9d6c4e0', N'BillableAmount', 125, 0, NULL, NULL, 53, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Billable Amount', 0, 0)
END

GO

-- Drop View rptvueAccountProjectsReport
Print 'Drop View rptvueAccountProjectsReport'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectsReport' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountProjectsReport]

GO
-- Drop View rptvueAccountProjectsTimesheet
Print 'Drop View rptvueAccountProjectsTimesheet'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectsTimesheet' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountProjectsTimesheet]

GO
-- Drop View rptvueAccountProjectsforReport
Print 'Drop View rptvueAccountProjectsforReport'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectsforReport' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountProjectsforReport]

GO
-- Create View rptvueAccountProjectsforReport
Print 'Create View rptvueAccountProjectsforReport'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectsforReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountProjectsforReport
AS
SELECT     dbo.rptvueAccountProjects.AccountProjectId, dbo.rptvueAccountProjects.AccountId, dbo.rptvueAccountProjects.AccountProjectTypeId, 
                      dbo.rptvueAccountProjects.AccountClientId, dbo.rptvueAccountProjects.ProjectBillingTypeId, dbo.rptvueAccountProjects.ProjectName, 
                      dbo.rptvueAccountProjects.ProjectDescription, dbo.rptvueAccountProjects.StartDate, dbo.rptvueAccountProjects.AccountMilestoneId, 
                      dbo.rptvueAccountProjects.Deadline, dbo.rptvueAccountProjects.LeaderEmployeeId, dbo.rptvueAccountProjects.ProjectManagerEmployeeId, 
                      dbo.rptvueAccountProjects.EstimatedTime, dbo.rptvueAccountProjects.EstimatedDurationUnit, dbo.rptvueAccountProjects.ProjectCode, 
                      dbo.rptvueAccountProjects.DefaultBillingRate, dbo.rptvueAccountProjects.IsActive, dbo.rptvueAccountProjects.ProjectStatusId, 
                      dbo.rptvueAccountProjects.AccountPriorityId, dbo.rptvueAccountProjects.CreatedOn, dbo.rptvueAccountProjects.CreatedByEmployeeId, 
                      dbo.rptvueAccountProjects.ModifiedOn, dbo.rptvueAccountProjects.ModifiedByEmployeeId, dbo.rptvueAccountProjects.ProjectBillingRateTypeId, 
                      dbo.rptvueAccountProjects.TimeSheetApprovalTypeId, dbo.rptvueAccountProjects.ExpenseApprovalTypeId, dbo.rptvueAccountProjects.IsDisabled, 
                      dbo.rptvueAccountProjects.IsTemplate, dbo.rptvueAccountProjects.IsProject, dbo.rptvueAccountProjects.AccountProjectTemplateId, 
                      dbo.rptvueAccountProjects.ClientNick, dbo.rptvueAccountProjects.ClientName, dbo.rptvueAccountProjects.ProjectType, dbo.rptvueAccountProjects.BillingType, 
                      dbo.rptvueAccountProjects.Status, dbo.rptvueAccountProjects.EstimatedDuration, dbo.rptvueAccountProjects.AccountClientContactId, 
                      dbo.rptvueAccountProjects.AccountClientDepartmentId, dbo.rptvueAccountProjects.ClientDepartmentCode, dbo.rptvueAccountProjects.ClientDepartmentName, 
                      dbo.rptvueAccountProjects.ClientDepartmentLocation, dbo.rptvueAccountProjects.ExpenseApprovalTypeName, 
                      dbo.rptvueAccountProjects.TimesheetApprovalTypeName, dbo.rptvueAccountProjects.ClientContactName, dbo.rptvueAccountProjects.TeamLead, 
                      dbo.rptvueAccountProjects.ProjectManager, dbo.rptvueAccountProjects.ProjectBillingRateType, dbo.rptvueAccountProjects.BillableTotalHours, 
                      dbo.rptvueAccountProjects.NonBillableTotalHours, dbo.rptvueAccountProjects.TotalEmployeeCost, dbo.rptvueAccountProjects.TotalTimeAmount, 
                      ISNULL(dbo.rptvueAccountProjects.TotalTaskEstimatedCost, 0) AS TotalTaskEstimatedCost, 
                      SUM(CASE WHEN dbo.rptvueAccountExpenseEntry.IsBillable = 1 THEN dbo.rptvueAccountExpenseEntry.NetAmount ELSE 0 END) AS TotalBillableExpense, 
                      SUM(CASE WHEN dbo.rptvueAccountExpenseEntry.IsBillable = 0 THEN dbo.rptvueAccountExpenseEntry.NetAmount ELSE 0 END) AS TotalNonBillableExpense, 
                      ISNULL(SUM(dbo.rptvueAccountExpenseEntry.NetAmount), 0) AS NetAmount, ISNULL(dbo.rptvueAccountProjects.TotalTaskEstimatedHours, 0) 
                      AS TotalTaskEstimatedHours, dbo.rptvueAccountProjects.TotalHours, dbo.rptvueAccountProjects.BillableTimeAmount, 
                      dbo.rptvueAccountProjects.NonBillableTimeAmount, SUM(dbo.rptvueAccountExpenseEntry.CurrencyNetAmount) AS NetAmounts
FROM         dbo.rptvueAccountProjects LEFT OUTER JOIN
                      dbo.rptvueAccountExpenseEntry ON dbo.rptvueAccountExpenseEntry.AccountProjectId = dbo.rptvueAccountProjects.AccountProjectId
GROUP BY dbo.rptvueAccountProjects.AccountProjectId, dbo.rptvueAccountProjects.AccountId, dbo.rptvueAccountProjects.AccountProjectTypeId, 
                      dbo.rptvueAccountProjects.AccountClientId, dbo.rptvueAccountProjects.ProjectName, dbo.rptvueAccountProjects.ProjectBillingTypeId, 
                      dbo.rptvueAccountProjects.ProjectDescription, dbo.rptvueAccountProjects.StartDate, dbo.rptvueAccountProjects.AccountMilestoneId, 
                      dbo.rptvueAccountProjects.Deadline, dbo.rptvueAccountProjects.LeaderEmployeeId, dbo.rptvueAccountProjects.ProjectManagerEmployeeId, 
                      dbo.rptvueAccountProjects.EstimatedTime, dbo.rptvueAccountProjects.EstimatedDurationUnit, dbo.rptvueAccountProjects.ProjectCode, 
                      dbo.rptvueAccountProjects.DefaultBillingRate, dbo.rptvueAccountProjects.IsActive, dbo.rptvueAccountProjects.ProjectStatusId, 
                      dbo.rptvueAccountProjects.AccountPriorityId, dbo.rptvueAccountProjects.CreatedOn, dbo.rptvueAccountProjects.CreatedByEmployeeId, 
                      dbo.rptvueAccountProjects.ModifiedOn, dbo.rptvueAccountProjects.ModifiedByEmployeeId, dbo.rptvueAccountProjects.ProjectBillingRateTypeId, 
                      dbo.rptvueAccountProjects.TimeSheetApprovalTypeId, dbo.rptvueAccountProjects.ExpenseApprovalTypeId, dbo.rptvueAccountProjects.IsDisabled, 
                      dbo.rptvueAccountProjects.IsTemplate, dbo.rptvueAccountProjects.IsProject, dbo.rptvueAccountProjects.AccountProjectTemplateId, 
                      dbo.rptvueAccountProjects.ClientNick, dbo.rptvueAccountProjects.ClientName, dbo.rptvueAccountProjects.ProjectType, dbo.rptvueAccountProjects.BillingType, 
                      dbo.rptvueAccountProjects.Status, dbo.rptvueAccountProjects.EstimatedDuration, dbo.rptvueAccountProjects.AccountClientContactId, 
                      dbo.rptvueAccountProjects.AccountClientDepartmentId, dbo.rptvueAccountProjects.ClientDepartmentCode, dbo.rptvueAccountProjects.ClientDepartmentName, 
                      dbo.rptvueAccountProjects.ClientDepartmentLocation, dbo.rptvueAccountProjects.ExpenseApprovalTypeName, 
                      dbo.rptvueAccountProjects.TimesheetApprovalTypeName, dbo.rptvueAccountProjects.ClientContactName, dbo.rptvueAccountProjects.TeamLead, 
                      dbo.rptvueAccountProjects.ProjectManager, dbo.rptvueAccountProjects.ProjectBillingRateType, dbo.rptvueAccountProjects.BillableTotalHours, 
                      dbo.rptvueAccountProjects.NonBillableTotalHours, dbo.rptvueAccountProjects.TotalEmployeeCost, dbo.rptvueAccountProjects.TotalTimeAmount, 
                      dbo.rptvueAccountProjects.TotalTaskEstimatedCost, ISNULL(dbo.rptvueAccountProjects.TotalTaskEstimatedHours, 0), dbo.rptvueAccountProjects.TotalHours, 
                      dbo.rptvueAccountProjects.BillableTimeAmount, dbo.rptvueAccountProjects.NonBillableTimeAmount'

GO
-- Create View rptvueAccountProjectsTimesheet
Print 'Create View rptvueAccountProjectsTimesheet'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectsTimesheet' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountProjectsTimesheet
AS
SELECT     dbo.rptvueAccountProjectsforReport.AccountProjectId, dbo.rptvueAccountProjectsforReport.AccountId, dbo.rptvueAccountProjectsforReport.AccountProjectTypeId, 
                      dbo.rptvueAccountProjectsforReport.AccountClientId, dbo.rptvueAccountProjectsforReport.ProjectBillingTypeId, dbo.rptvueAccountProjectsforReport.ProjectName, 
                      dbo.rptvueAccountProjectsforReport.ProjectDescription, dbo.rptvueAccountProjectsforReport.StartDate, dbo.rptvueAccountProjectsforReport.AccountMilestoneId, 
                      dbo.rptvueAccountProjectsforReport.Deadline, dbo.rptvueAccountProjectsforReport.LeaderEmployeeId, 
                      dbo.rptvueAccountProjectsforReport.ProjectManagerEmployeeId, dbo.rptvueAccountProjectsforReport.EstimatedTime, 
                      dbo.rptvueAccountProjectsforReport.EstimatedDurationUnit, dbo.rptvueAccountProjectsforReport.ProjectCode, dbo.rptvueAccountProjectsforReport.DefaultBillingRate, 
                      dbo.rptvueAccountProjectsforReport.IsActive, dbo.rptvueAccountProjectsforReport.ProjectStatusId, dbo.rptvueAccountProjectsforReport.AccountPriorityId, 
                      dbo.rptvueAccountProjectsforReport.CreatedOn, dbo.rptvueAccountProjectsforReport.CreatedByEmployeeId, dbo.rptvueAccountProjectsforReport.ModifiedOn, 
                      dbo.rptvueAccountProjectsforReport.ModifiedByEmployeeId, dbo.rptvueAccountProjectsforReport.ProjectBillingRateTypeId, 
                      dbo.rptvueAccountProjectsforReport.TimeSheetApprovalTypeId, dbo.rptvueAccountProjectsforReport.ExpenseApprovalTypeId, 
                      dbo.rptvueAccountProjectsforReport.IsDisabled, dbo.rptvueAccountProjectsforReport.IsTemplate, dbo.rptvueAccountProjectsforReport.IsProject, 
                      dbo.rptvueAccountProjectsforReport.AccountProjectTemplateId, dbo.rptvueAccountProjectsforReport.ClientNick, dbo.rptvueAccountProjectsforReport.ClientName, 
                      dbo.rptvueAccountProjectsforReport.ProjectType, dbo.rptvueAccountProjectsforReport.BillingType, dbo.rptvueAccountProjectsforReport.Status, 
                      dbo.rptvueAccountProjectsforReport.EstimatedDuration, dbo.rptvueAccountProjectsforReport.AccountClientContactId, 
                      dbo.rptvueAccountProjectsforReport.AccountClientDepartmentId, dbo.rptvueAccountProjectsforReport.ClientDepartmentCode, 
                      dbo.rptvueAccountProjectsforReport.ClientDepartmentName, dbo.rptvueAccountProjectsforReport.ClientDepartmentLocation, 
                      dbo.rptvueAccountProjectsforReport.ExpenseApprovalTypeName, dbo.rptvueAccountProjectsforReport.TimesheetApprovalTypeName, 
                      dbo.rptvueAccountProjectsforReport.ClientContactName, dbo.rptvueAccountProjectsforReport.TeamLead, dbo.rptvueAccountProjectsforReport.ProjectManager, 
                      dbo.rptvueAccountProjectsforReport.ProjectBillingRateType, dbo.rptvueAccountProjectsforReport.BillableTotalHours, 
                      dbo.rptvueAccountProjectsforReport.NonBillableTotalHours, dbo.rptvueAccountProjectsforReport.TotalEmployeeCost, 
                      dbo.rptvueAccountProjectsforReport.TotalTimeAmount, dbo.rptvueAccountProjectsforReport.TotalTaskEstimatedCost, 
                      dbo.rptvueAccountProjectsforReport.TotalBillableExpense, dbo.rptvueAccountProjectsforReport.TotalNonBillableExpense, 
                      dbo.rptvueAccountProjectsforReport.NetAmount, dbo.rptvueAccountProjectsforReport.TotalTaskEstimatedHours, dbo.rptvueAccountProjectsforReport.TotalHours, 
                      dbo.rptvueAccountProjectsforReport.BillableTimeAmount, dbo.rptvueAccountProjectsforReport.NonBillableTimeAmount, SUM(dbo.vueBillingTimesheet.TotalAmount) 
                      AS BilledTimeAmount, ISNULL(dbo.rptvueAccountProjectsforReport.NetAmounts, 0) AS CurrencyNetAmount
FROM         dbo.rptvueAccountProjectsforReport LEFT OUTER JOIN
                      dbo.vueBillingTimesheet ON dbo.rptvueAccountProjectsforReport.AccountProjectId = dbo.vueBillingTimesheet.AccountProjectId
GROUP BY dbo.rptvueAccountProjectsforReport.AccountProjectId, dbo.rptvueAccountProjectsforReport.AccountId, dbo.rptvueAccountProjectsforReport.AccountProjectTypeId, 
                      dbo.rptvueAccountProjectsforReport.AccountClientId, dbo.rptvueAccountProjectsforReport.ProjectBillingTypeId, dbo.rptvueAccountProjectsforReport.ProjectName, 
                      dbo.rptvueAccountProjectsforReport.ProjectDescription, dbo.rptvueAccountProjectsforReport.StartDate, dbo.rptvueAccountProjectsforReport.AccountMilestoneId, 
                      dbo.rptvueAccountProjectsforReport.Deadline, dbo.rptvueAccountProjectsforReport.LeaderEmployeeId, 
                      dbo.rptvueAccountProjectsforReport.ProjectManagerEmployeeId, dbo.rptvueAccountProjectsforReport.EstimatedTime, 
                      dbo.rptvueAccountProjectsforReport.EstimatedDurationUnit, dbo.rptvueAccountProjectsforReport.ProjectCode, dbo.rptvueAccountProjectsforReport.DefaultBillingRate, 
                      dbo.rptvueAccountProjectsforReport.IsActive, dbo.rptvueAccountProjectsforReport.ProjectStatusId, dbo.rptvueAccountProjectsforReport.AccountPriorityId, 
                      dbo.rptvueAccountProjectsforReport.CreatedOn, dbo.rptvueAccountProjectsforReport.CreatedByEmployeeId, dbo.rptvueAccountProjectsforReport.ModifiedOn, 
                      dbo.rptvueAccountProjectsforReport.ModifiedByEmployeeId, dbo.rptvueAccountProjectsforReport.ProjectBillingRateTypeId, 
                      dbo.rptvueAccountProjectsforReport.TimeSheetApprovalTypeId, dbo.rptvueAccountProjectsforReport.ExpenseApprovalTypeId, 
                      dbo.rptvueAccountProjectsforReport.IsDisabled, dbo.rptvueAccountProjectsforReport.IsTemplate, dbo.rptvueAccountProjectsforReport.IsProject, 
                      dbo.rptvueAccountProjectsforReport.AccountProjectTemplateId, dbo.rptvueAccountProjectsforReport.ClientNick, dbo.rptvueAccountProjectsforReport.ClientName, 
                      dbo.rptvueAccountProjectsforReport.ProjectType, dbo.rptvueAccountProjectsforReport.BillingType, dbo.rptvueAccountProjectsforReport.Status, 
                      dbo.rptvueAccountProjectsforReport.EstimatedDuration, dbo.rptvueAccountProjectsforReport.AccountClientContactId, 
                      dbo.rptvueAccountProjectsforReport.AccountClientDepartmentId, dbo.rptvueAccountProjectsforReport.ClientDepartmentCode, 
                      dbo.rptvueAccountProjectsforReport.ClientDepartmentName, dbo.rptvueAccountProjectsforReport.ClientDepartmentLocation, 
                      dbo.rptvueAccountProjectsforReport.ExpenseApprovalTypeName, dbo.rptvueAccountProjectsforReport.TimesheetApprovalTypeName, 
                      dbo.rptvueAccountProjectsforReport.ClientContactName, dbo.rptvueAccountProjectsforReport.TeamLead, dbo.rptvueAccountProjectsforReport.ProjectManager, 
                      dbo.rptvueAccountProjectsforReport.ProjectBillingRateType, dbo.rptvueAccountProjectsforReport.BillableTotalHours, 
                      dbo.rptvueAccountProjectsforReport.NonBillableTotalHours, dbo.rptvueAccountProjectsforReport.TotalEmployeeCost, 
                      dbo.rptvueAccountProjectsforReport.TotalTimeAmount, dbo.rptvueAccountProjectsforReport.TotalTaskEstimatedCost, 
                      dbo.rptvueAccountProjectsforReport.TotalBillableExpense, dbo.rptvueAccountProjectsforReport.TotalNonBillableExpense, 
                      dbo.rptvueAccountProjectsforReport.NetAmount, dbo.rptvueAccountProjectsforReport.TotalTaskEstimatedHours, dbo.rptvueAccountProjectsforReport.TotalHours, 
                      dbo.rptvueAccountProjectsforReport.BillableTimeAmount, dbo.rptvueAccountProjectsforReport.NonBillableTimeAmount, 
                      ISNULL(dbo.rptvueAccountProjectsforReport.NetAmounts, 0)'


GO
-- Create View rptvueAccountProjectsReport
Print 'Create View rptvueAccountProjectsReport'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectsReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountProjectsReport
AS
SELECT     dbo.rptvueAccountProjectsTimesheet.AccountProjectId, dbo.rptvueAccountProjectsTimesheet.AccountId, dbo.rptvueAccountProjectsTimesheet.AccountProjectTypeId, 
                      dbo.rptvueAccountProjectsTimesheet.AccountClientId, dbo.rptvueAccountProjectsTimesheet.ProjectBillingTypeId, dbo.rptvueAccountProjectsTimesheet.ProjectName, 
                      dbo.rptvueAccountProjectsTimesheet.ProjectDescription, dbo.rptvueAccountProjectsTimesheet.StartDate, dbo.rptvueAccountProjectsTimesheet.AccountMilestoneId, 
                      dbo.rptvueAccountProjectsTimesheet.Deadline, dbo.rptvueAccountProjectsTimesheet.LeaderEmployeeId, 
                      dbo.rptvueAccountProjectsTimesheet.ProjectManagerEmployeeId, dbo.rptvueAccountProjectsTimesheet.EstimatedTime, 
                      dbo.rptvueAccountProjectsTimesheet.EstimatedDurationUnit, dbo.rptvueAccountProjectsTimesheet.ProjectCode, 
                      dbo.rptvueAccountProjectsTimesheet.DefaultBillingRate, dbo.rptvueAccountProjectsTimesheet.IsActive, dbo.rptvueAccountProjectsTimesheet.ProjectStatusId, 
                      dbo.rptvueAccountProjectsTimesheet.AccountPriorityId, dbo.rptvueAccountProjectsTimesheet.CreatedOn, dbo.rptvueAccountProjectsTimesheet.CreatedByEmployeeId, 
                      dbo.rptvueAccountProjectsTimesheet.ModifiedOn, dbo.rptvueAccountProjectsTimesheet.ModifiedByEmployeeId, 
                      dbo.rptvueAccountProjectsTimesheet.ProjectBillingRateTypeId, dbo.rptvueAccountProjectsTimesheet.TimeSheetApprovalTypeId, 
                      dbo.rptvueAccountProjectsTimesheet.ExpenseApprovalTypeId, dbo.rptvueAccountProjectsTimesheet.IsDisabled, dbo.rptvueAccountProjectsTimesheet.IsTemplate, 
                      dbo.rptvueAccountProjectsTimesheet.IsProject, dbo.rptvueAccountProjectsTimesheet.AccountProjectTemplateId, dbo.rptvueAccountProjectsTimesheet.ClientNick, 
                      dbo.rptvueAccountProjectsTimesheet.ClientName, dbo.rptvueAccountProjectsTimesheet.ProjectType, dbo.rptvueAccountProjectsTimesheet.BillingType, 
                      dbo.rptvueAccountProjectsTimesheet.Status, dbo.rptvueAccountProjectsTimesheet.EstimatedDuration, dbo.rptvueAccountProjectsTimesheet.AccountClientContactId, 
                      dbo.rptvueAccountProjectsTimesheet.AccountClientDepartmentId, dbo.rptvueAccountProjectsTimesheet.ClientDepartmentCode, 
                      dbo.rptvueAccountProjectsTimesheet.ClientDepartmentName, dbo.rptvueAccountProjectsTimesheet.ClientDepartmentLocation, 
                      dbo.rptvueAccountProjectsTimesheet.ExpenseApprovalTypeName, dbo.rptvueAccountProjectsTimesheet.TimesheetApprovalTypeName, 
                      dbo.rptvueAccountProjectsTimesheet.ClientContactName, dbo.rptvueAccountProjectsTimesheet.TeamLead, dbo.rptvueAccountProjectsTimesheet.ProjectManager, 
                      dbo.rptvueAccountProjectsTimesheet.ProjectBillingRateType, dbo.rptvueAccountProjectsTimesheet.BillableTotalHours, 
                      dbo.rptvueAccountProjectsTimesheet.NonBillableTotalHours, dbo.rptvueAccountProjectsTimesheet.TotalEmployeeCost, 
                      dbo.rptvueAccountProjectsTimesheet.TotalTimeAmount, dbo.rptvueAccountProjectsTimesheet.TotalTaskEstimatedCost, 
                      dbo.rptvueAccountProjectsTimesheet.TotalBillableExpense, dbo.rptvueAccountProjectsTimesheet.TotalNonBillableExpense, 
                      dbo.rptvueAccountProjectsTimesheet.NetAmount, dbo.rptvueAccountProjectsTimesheet.TotalTaskEstimatedHours, dbo.rptvueAccountProjectsTimesheet.TotalHours, 
                      dbo.rptvueAccountProjectsTimesheet.BillableTimeAmount, dbo.rptvueAccountProjectsTimesheet.NonBillableTimeAmount, 
                      ISNULL(dbo.rptvueAccountProjectsTimesheet.BilledTimeAmount, 0) AS BilledTimeAmount, ISNULL(SUM(dbo.vueBillingExpense.BilledExpenseAmount), 0) 
                      AS BilledExpenseAmount, dbo.rptvueAccountProjectsTimesheet.CurrencyNetAmount
FROM         dbo.rptvueAccountProjectsTimesheet LEFT OUTER JOIN
                      dbo.vueBillingExpense ON dbo.rptvueAccountProjectsTimesheet.AccountProjectId = dbo.vueBillingExpense.AccountProjectId
GROUP BY dbo.rptvueAccountProjectsTimesheet.AccountProjectId, dbo.rptvueAccountProjectsTimesheet.AccountId, dbo.rptvueAccountProjectsTimesheet.AccountProjectTypeId, 
                      dbo.rptvueAccountProjectsTimesheet.AccountClientId, dbo.rptvueAccountProjectsTimesheet.ProjectBillingTypeId, dbo.rptvueAccountProjectsTimesheet.ProjectName, 
                      dbo.rptvueAccountProjectsTimesheet.ProjectDescription, dbo.rptvueAccountProjectsTimesheet.StartDate, dbo.rptvueAccountProjectsTimesheet.AccountMilestoneId, 
                      dbo.rptvueAccountProjectsTimesheet.Deadline, dbo.rptvueAccountProjectsTimesheet.LeaderEmployeeId, 
                      dbo.rptvueAccountProjectsTimesheet.ProjectManagerEmployeeId, dbo.rptvueAccountProjectsTimesheet.EstimatedTime, 
                      dbo.rptvueAccountProjectsTimesheet.EstimatedDurationUnit, dbo.rptvueAccountProjectsTimesheet.ProjectCode, 
                      dbo.rptvueAccountProjectsTimesheet.DefaultBillingRate, dbo.rptvueAccountProjectsTimesheet.IsActive, dbo.rptvueAccountProjectsTimesheet.ProjectStatusId, 
                      dbo.rptvueAccountProjectsTimesheet.AccountPriorityId, dbo.rptvueAccountProjectsTimesheet.CreatedOn, dbo.rptvueAccountProjectsTimesheet.CreatedByEmployeeId, 
                      dbo.rptvueAccountProjectsTimesheet.ModifiedOn, dbo.rptvueAccountProjectsTimesheet.ModifiedByEmployeeId, 
                      dbo.rptvueAccountProjectsTimesheet.ProjectBillingRateTypeId, dbo.rptvueAccountProjectsTimesheet.TimeSheetApprovalTypeId, 
                      dbo.rptvueAccountProjectsTimesheet.ExpenseApprovalTypeId, dbo.rptvueAccountProjectsTimesheet.IsDisabled, dbo.rptvueAccountProjectsTimesheet.IsTemplate, 
                      dbo.rptvueAccountProjectsTimesheet.IsProject, dbo.rptvueAccountProjectsTimesheet.AccountProjectTemplateId, dbo.rptvueAccountProjectsTimesheet.ClientNick, 
                      dbo.rptvueAccountProjectsTimesheet.ClientName, dbo.rptvueAccountProjectsTimesheet.ProjectType, dbo.rptvueAccountProjectsTimesheet.BillingType, 
                      dbo.rptvueAccountProjectsTimesheet.Status, dbo.rptvueAccountProjectsTimesheet.EstimatedDuration, dbo.rptvueAccountProjectsTimesheet.AccountClientContactId, 
                      dbo.rptvueAccountProjectsTimesheet.AccountClientDepartmentId, dbo.rptvueAccountProjectsTimesheet.ClientDepartmentCode, 
                      dbo.rptvueAccountProjectsTimesheet.ClientDepartmentName, dbo.rptvueAccountProjectsTimesheet.ClientDepartmentLocation, 
                      dbo.rptvueAccountProjectsTimesheet.ExpenseApprovalTypeName, dbo.rptvueAccountProjectsTimesheet.TimesheetApprovalTypeName, 
                      dbo.rptvueAccountProjectsTimesheet.ClientContactName, dbo.rptvueAccountProjectsTimesheet.TeamLead, dbo.rptvueAccountProjectsTimesheet.ProjectManager, 
                      dbo.rptvueAccountProjectsTimesheet.ProjectBillingRateType, dbo.rptvueAccountProjectsTimesheet.BillableTotalHours, 
                      dbo.rptvueAccountProjectsTimesheet.NonBillableTotalHours, dbo.rptvueAccountProjectsTimesheet.TotalEmployeeCost, 
                      dbo.rptvueAccountProjectsTimesheet.TotalTimeAmount, dbo.rptvueAccountProjectsTimesheet.TotalTaskEstimatedCost, 
                      dbo.rptvueAccountProjectsTimesheet.TotalBillableExpense, dbo.rptvueAccountProjectsTimesheet.TotalNonBillableExpense, 
                      dbo.rptvueAccountProjectsTimesheet.NetAmount, dbo.rptvueAccountProjectsTimesheet.TotalTaskEstimatedHours, dbo.rptvueAccountProjectsTimesheet.TotalHours, 
                      dbo.rptvueAccountProjectsTimesheet.BillableTimeAmount, dbo.rptvueAccountProjectsTimesheet.NonBillableTimeAmount, 
                      dbo.rptvueAccountProjectsTimesheet.BilledTimeAmount, dbo.rptvueAccountProjectsTimesheet.CurrencyNetAmount'


GO
-- Drop View rptvueAccountEmployeeTimeEntry
Print 'Drop View rptvueAccountEmployeeTimeEntry'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeEntry' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountEmployeeTimeEntry]

GO
-- Drop View vueAccountEmployeeTimeEntryForReport
Print 'Drop View vueAccountEmployeeTimeEntryForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryForReport]

GO

-- Drop View vueAccountEmployeeTimeEntryWithTimeOffForReport
Print 'Drop View vueAccountEmployeeTimeEntryWithTimeOffForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithTimeOffForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryWithTimeOffForReport]


GO
-- Create View vueAccountEmployeeTimeEntryWithTimeOffForReport
Print 'Create View vueAccountEmployeeTimeEntryWithTimeOffForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithTimeOffForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport
AS
SELECT     CASE WHEN dbo.AccountEmployee.IsDisabled = 1 THEN dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE dbo.AccountEmployee.FirstName
                       + '' '' + dbo.AccountEmployee.LastName END AS EmployeeName, dbo.AccountProject.ProjectName, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 1 THEN AccountProjectTask_1.TaskName ELSE dbo.AccountTimeOffType.AccountTimeOffType END AS TaskName,
                       dbo.AccountEmployeeTimeEntry.TotalTime, dbo.AccountEmployeeTimeEntry.Approved, dbo.AccountEmployee.AccountEmployeeId, 
                      dbo.AccountProject.AccountProjectId, dbo.AccountEmployeeTimeEntry.TeamLeadApproved, dbo.AccountEmployeeTimeEntry.ProjectManagerApproved, 
                      dbo.AccountEmployeeTimeEntry.AdministratorApproved, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, dbo.AccountEmployeeTimeEntry.StartTime, 
                      dbo.AccountEmployeeTimeEntry.EndTime, dbo.AccountEmployeeTimeEntry.TimeEntryDate, dbo.AccountEmployeeTimeEntry.Description, 
                      ISNULL(dbo.AccountProject.AccountId, dbo.AccountTimeOffType.AccountId) AS AccountId, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime) AS TotalMinutes, DATEPART(dw, dbo.AccountEmployeeTimeEntry.TimeEntryDate) AS WeekDay, 
                      dbo.AccountParty.AccountPartyId, dbo.AccountParty.PartyName, AccountProjectTask_1.AccountProjectTaskId, dbo.AccountBillingType.BillingType, 
                      dbo.AccountProject.LeaderEmployeeId, dbo.AccountProject.ProjectManagerEmployeeId, dbo.AccountProject.TimeSheetApprovalTypeId, 
                      dbo.AccountProject.ExpenseApprovalTypeId, AccountProjectTask_1.IsBillable, dbo.AccountEmployeeTimeEntry.Rejected, dbo.AccountEmployeeTimeEntry.BillingRate, 
                      dbo.AccountProject.ProjectBillingRateTypeId, dbo.AccountEmployee.EmployeeCode, dbo.AccountEmployee.AccountDepartmentId, 
                      dbo.AccountDepartment.DepartmentName, AccountProjectTask_1.EstimatedCost, AccountProjectTask_1.EstimatedTimeSpent, 
                      dbo.AccountEmployeeTimeEntry.Submitted, dbo.AccountWorkType.AccountWorkType, dbo.AccountEmployee.EMailAddress, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountCostCenter.AccountCostCenter, dbo.AccountCostCenter.AccountCostCenterCode, dbo.AccountWorkType.AccountWorkTypeCode, 
                      dbo.AccountProject.ProjectCode, AccountProjectTask_1.TaskCode, dbo.AccountLocation.AccountLocationId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction.Comments, dbo.AccountEmployeeTimeEntry.BillingRateCurrencyId, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateCurrencyId, dbo.AccountEmployeeTimeEntry.BillingRateExchangeRate, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateExchangeRate, dbo.AccountEmployeeTimeEntry.AccountBaseCurrencyId, AccountProjectTask_1.AccountTaskTypeId, 
                      AccountProjectTask_1.TaskStatusId, AccountProjectTask_1.AccountPriorityId, AccountProjectTask_1.AccountProjectMilestoneId, 
                      dbo.AccountDepartment.DepartmentCode, dbo.AccountParty.PartyNick, AccountProjectTask_1.EstimatedCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction.ApprovedOn, dbo.AccountEmployeeTimeEntry.EmployeeRate, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountRole.Role, dbo.AccountProject.AccountProjectTypeId, dbo.AccountProject.ProjectDescription, AccountProjectTask_1.TaskDescription, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeExpenseBillingTimesheetId, dbo.AccountEmployeeTimeEntry.Billed, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Submitted = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS SubmittedHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Approved = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS ApprovedHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Rejected = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS RejectedHours, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, 
                      dbo.AccountPartyContact.FirstName + N'' '' + dbo.AccountPartyContact.LastName AS ClientContactName, 
                      dbo.AccountPartyDepartment.PartyDepartmentCode AS ClientDepartmentCode, dbo.AccountPartyDepartment.PartyDepartmentName AS ClientDepartmentName, 
                      dbo.AccountPartyDepartment.PartyDepartmentLocation AS ClientDepartmentLocation, dbo.AccountEmployeeTimeEntry.IsTimeOff, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId, CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 0 THEN ROUND(CONVERT(float, DATEPART(hh, 
                      dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS TimeOffHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS TimesheetHours, dbo.AccountWorkType.AccountWorkTypeId, 
                      dbo.AccountStatus.Status AS ProjectStatus, AccountProjectTask_1.ParentAccountProjectTaskId, dbo.AccountProjectTask.TaskName AS ParentTaskName, 
                      dbo.AccountEmployee.IsDisabled, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, ISNULL(dbo.AccountEmployeeType.AccountEmployeeType, N'''') 
                      AS EmployeeType, ISNULL(dbo.AccountHolidayTypeDetail.HolidayName, N'''') AS HolidayName
FROM         dbo.AccountHolidayTypeDetail RIGHT OUTER JOIN
                      dbo.AccountEmployeeTimeEntry INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeEntry.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId ON 
                      dbo.AccountHolidayTypeDetail.AccountHolidayTypeId = dbo.AccountEmployee.AccountHolidayTypeId AND 
                      dbo.AccountHolidayTypeDetail.AccountId = dbo.AccountEmployee.AccountId AND 
                      dbo.AccountHolidayTypeDetail.HolidayDate = dbo.AccountEmployeeTimeEntry.TimeEntryDate LEFT OUTER JOIN
                      dbo.AccountEmployeeType ON dbo.AccountEmployee.EmployeePayTypeId = dbo.AccountEmployeeType.AccountEmployeeTypeId LEFT OUTER JOIN
                      dbo.AccountProjectTask AS AccountProjectTask_1 LEFT OUTER JOIN
                      dbo.AccountProjectTask ON AccountProjectTask_1.ParentAccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId ON 
                      dbo.AccountEmployeeTimeEntry.AccountProjectTaskId = AccountProjectTask_1.AccountProjectTaskId LEFT OUTER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountStatus ON dbo.AccountProject.ProjectStatusId = dbo.AccountStatus.AccountStatusId LEFT OUTER JOIN
                      dbo.AccountTimeOffType ON dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId LEFT OUTER JOIN
                      dbo.AccountPartyDepartment ON dbo.AccountProject.AccountPartyDepartmentId = dbo.AccountPartyDepartment.AccountPartyDepartmentId LEFT OUTER JOIN
                      dbo.AccountPartyContact ON dbo.AccountProject.AccountPartyContactId = dbo.AccountPartyContact.AccountPartyContactId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryPeriod ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId LEFT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryApprovalLastAction.AccountEmployeeTimeEntryId LEFT OUTER JOIN
                      dbo.AccountCostCenter ON dbo.AccountEmployeeTimeEntry.AccountCostCenterId = dbo.AccountCostCenter.AccountCostCenterId LEFT OUTER JOIN
                      dbo.AccountWorkType ON dbo.AccountEmployeeTimeEntry.AccountWorkTypeId = dbo.AccountWorkType.AccountWorkTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId LEFT OUTER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId'

GO
-- Create View vueAccountEmployeeTimeEntryForReport
Print 'Create View vueAccountEmployeeTimeEntryForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryForReport
AS
SELECT     dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeName, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskName, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalTime, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Approved, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TeamLeadApproved, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectManagerApproved, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AdministratorApproved, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeTimeEntryId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.StartTime, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EndTime, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Description, N'''') AS Description, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.WeekDay, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountPartyId AS AccountClientId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.PartyName AS ClientName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectTaskId, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingType, N'''') 
                      AS BillingType, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectManagerEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ExpenseApprovalTypeId, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.IsBillable, 0) 
                      AS IsBillable, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Rejected, 0) AS Rejected, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRate, 0) AS BillingRate, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectBillingRateTypeId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeCode, N'''') AS EmployeeCode, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountDepartmentId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.DepartmentName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedCost, 0) AS EstimatedCost, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedTimeSpent, 0) AS EstimatedHours, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Submitted, 0) AS Submitted, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountWorkType, N'''') AS AccountWorkType, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EMailAddress, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountLocation, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountCostCenter, N'''') AS AccountCostCenter, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountCostCenterCode, N'''') AS AccountCostCenterCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountWorkTypeCode, N'''') AS AccountWorkTypeCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectCode, N'''') AS ProjectCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCode, N'''') AS TaskCode, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountLocationId, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Comments, N'''') 
                      AS ApproverComments, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes * dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRate / 60, 0) 
                      AS Amount, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRateCurrencyId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateExchangeRate, 0) AS BillingRateExchangeRate, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRateExchangeRate, 0) AS EmployeeRateExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountBaseCurrencyId, dbo.vueAccountCurrency.CurrencyCode AS BillingRateCurrencyCode, 
                      dbo.vueAccountCurrency.CurrencyCode AS AmountCurrencyCode, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountTaskTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskStatusId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountPriorityId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectMilestoneId, dbo.AccountTaskType.TaskType, dbo.AccountStatus.Status AS TaskStatus, 
                      dbo.AccountProjectMilestone.MilestoneDescription, dbo.AccountPriority.Priority, ROUND(CONVERT(float, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes) / 60, 2) AS TotalHours, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.DepartmentCode, N'''') AS DepartmentCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.PartyNick, N'''') AS ClientNick, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedCurrencyId, vueAccountCurrency_1.CurrencyCode AS EstimatedCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ApprovedOn, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRate, 0) 
                      AS EmployeeRate, vueAccountCurrency_2.CurrencyCode AS EmployeeRateCurrencyCode, 
                      AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName AS TeamLeader, 
                      AccountEmployee_2.FirstName + '' '' + AccountEmployee_2.LastName AS ProjectManager, 
                      ISNULL(dbo.AccountEmployee.FirstName + N'' '' + dbo.AccountEmployee.LastName, N'''') AS EmployeeManager, 
                      vueAccountCurrency_1.ExchangeRate AS EstimatedCurrencyExchangeRate, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes * dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRate / 60, 0) 
                      AS EmployeeCost, { fn DAYOFMONTH(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) } AS DayNo, 
                      MONTH(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) AS MonthNo, DATEPART(week, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) - DATEPART(week, DATEADD(month, DATEDIFF(month, 0, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate), 0)) + 1 AS WeekNo, 
                      YEAR(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) AS Year, 
                      LEFT({ fn MONTHNAME(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) }, 3) + '' - '' + CONVERT(nvarchar(10), 
                      YEAR(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate)) AS Period, 
                      { fn DAYNAME(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) } AS WeekDayName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountRoleId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Role, 
                      dbo.AccountProjectType.ProjectType, dbo.AccountRole.Role AS ProjectRole, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectDescription, N'''') 
                      AS ProjectDescription, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskDescription, N'''') AS TaskDescription, 
                      dbo.AccountTimeExpenseBilling.InvoiceNumber, dbo.AccountTimeExpenseBilling.InvoiceDate, dbo.AccountProjectType.AccountProjectTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Billed, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeTimeEntryPeriodId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientContactName, N'''') AS ClientContactName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentCode, N'''') AS ClientDepartmentCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentName, N'''') AS ClientDepartmentName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentLocation, N'''') AS ClientDepartmentLocation, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.IsTimeOff, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountWorkTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectStatus, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ParentTaskName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.FirstName, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.LastName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeType, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.HolidayName
FROM         dbo.AccountRole INNER JOIN
                      dbo.AccountProjectEmployee ON dbo.AccountRole.AccountRoleId = dbo.AccountProjectEmployee.AccountRoleId RIGHT OUTER JOIN
                      dbo.AccountTimeExpenseBillingTimesheet INNER JOIN
                      dbo.AccountTimeExpenseBilling ON 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingId = dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId RIGHT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport LEFT OUTER JOIN
                      dbo.AccountProjectType ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectTypeId = dbo.AccountProjectType.AccountProjectTypeId LEFT OUTER JOIN
                      dbo.AccountProjectMilestone ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectMilestoneId = dbo.AccountProjectMilestone.AccountProjectMilestoneId LEFT OUTER JOIN
                      dbo.AccountStatus ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskStatusId = dbo.AccountStatus.AccountStatusId LEFT OUTER JOIN
                      dbo.AccountPriority ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountPriorityId = dbo.AccountPriority.AccountPriorityId LEFT OUTER JOIN
                      dbo.AccountTaskType ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountTaskTypeId = dbo.AccountTaskType.AccountTaskTypeId ON 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingTimesheetId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountTimeExpenseBillingTimesheetId
                       ON dbo.AccountProjectEmployee.AccountEmployeeId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeId AND 
                      dbo.AccountProjectEmployee.AccountProjectId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.LeaderEmployeeId = AccountEmployee_1.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_2 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectManagerEmployeeId = AccountEmployee_2.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.AccountEmployee AS AccountEmployee_3 ON dbo.AccountEmployee.AccountEmployeeId = AccountEmployee_3.EmployeeManagerId ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeId = AccountEmployee_3.AccountEmployeeId LEFT OUTER JOIN
                      dbo.vueAccountCurrency AS vueAccountCurrency_2 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRateCurrencyId = vueAccountCurrency_2.AccountCurrencyId LEFT OUTER JOIN
                      dbo.vueAccountCurrency AS vueAccountCurrency_1 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedCurrencyId = vueAccountCurrency_1.AccountCurrencyId LEFT OUTER JOIN
                      dbo.vueAccountCurrency ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateCurrencyId = dbo.vueAccountCurrency.AccountCurrencyId'

GO
-- Create View rptvueAccountEmployeeTimeEntry
Print 'Create View rptvueAccountEmployeeTimeEntry'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeEntry' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountEmployeeTimeEntry
AS
SELECT     dbo.vueAccountEmployeeTimeEntryForReport.EmployeeName, dbo.vueAccountEmployeeTimeEntryForReport.ProjectName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskName, dbo.vueAccountEmployeeTimeEntryForReport.TotalTime, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Approved, dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectId, dbo.vueAccountEmployeeTimeEntryForReport.TeamLeadApproved, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManagerApproved, dbo.vueAccountEmployeeTimeEntryForReport.AdministratorApproved, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeTimeEntryId, dbo.vueAccountEmployeeTimeEntryForReport.StartTime, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EndTime, dbo.vueAccountEmployeeTimeEntryForReport.TimeEntryDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Description, dbo.vueAccountEmployeeTimeEntryForReport.AccountId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TotalMinutes, dbo.vueAccountEmployeeTimeEntryForReport.WeekDay, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientName, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectTaskId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingType, dbo.vueAccountEmployeeTimeEntryForReport.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManagerEmployeeId, dbo.vueAccountEmployeeTimeEntryForReport.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ExpenseApprovalTypeId, dbo.vueAccountEmployeeTimeEntryForReport.IsBillable, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Rejected, dbo.vueAccountEmployeeTimeEntryForReport.BillingRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectBillingRateTypeId, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountDepartmentId, dbo.vueAccountEmployeeTimeEntryForReport.DepartmentName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCost, dbo.vueAccountEmployeeTimeEntryForReport.EstimatedHours, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Submitted, dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkType, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EMailAddress, dbo.vueAccountEmployeeTimeEntryForReport.AccountLocation, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountCostCenter, dbo.vueAccountEmployeeTimeEntryForReport.AccountCostCenterCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkTypeCode, dbo.vueAccountEmployeeTimeEntryForReport.ProjectCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCode, dbo.vueAccountEmployeeTimeEntryForReport.AccountLocationId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ApproverComments, dbo.vueAccountEmployeeTimeEntryForReport.Amount, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingRateCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountBaseCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.BillingRateCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AmountCurrencyCode, CASE WHEN vueAccountEmployeeTimeEntryForReport.Submitted = 1 AND 
                      vueAccountEmployeeTimeEntryForReport.Approved = 0 THEN ''Submitted'' WHEN vueAccountEmployeeTimeEntryForReport.Approved = 1 THEN ''Approved'' WHEN vueAccountEmployeeTimeEntryForReport.Rejected
                       = 1 THEN ''Rejected'' WHEN vueAccountEmployeeTimeEntryForReport.Submitted = 0 AND vueAccountEmployeeTimeEntryForReport.Approved = 0 AND 
                      vueAccountEmployeeTimeEntryForReport.Rejected = 0 THEN ''Not Submitted'' END AS ApprovalStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountTaskTypeId, dbo.vueAccountEmployeeTimeEntryForReport.TaskStatusId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountPriorityId, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectMilestoneId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskType, dbo.vueAccountEmployeeTimeEntryForReport.TaskStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.MilestoneDescription, dbo.vueAccountEmployeeTimeEntryForReport.Priority, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TotalHours, dbo.vueAccountEmployeeTimeEntryForReport.DepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientNick, dbo.vueAccountEmployeeTimeEntryForReport.AccountClientId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ApprovedOn, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateCurrencyCode, dbo.vueAccountEmployeeTimeEntryForReport.TeamLeader, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManager, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeManager, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate, 0) AS EstimatedCurrencyExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCost, dbo.vueAccountEmployeeTimeEntryForReport.AccountRoleId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Role, dbo.vueAccountEmployeeTimeEntryForReport.WeekDayName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Period, dbo.vueAccountEmployeeTimeEntryForReport.Year, dbo.vueAccountEmployeeTimeEntryForReport.WeekNo, 
                      dbo.vueAccountEmployeeTimeEntryForReport.MonthNo, dbo.vueAccountEmployeeTimeEntryForReport.DayNo, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 1 THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours ELSE 0 END AS BillableTotalHours,
                       CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable
                       IS NULL THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours ELSE 0 END AS NonBillableTotalHours, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCost / dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate
                       ELSE 0 END AS CurrencyEmployeeCost, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.Amount / dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate
                       ELSE 0 END AS CurrencyAmount, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCost / dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate
                       ELSE 0 END AS CurrencyEstimatedCost, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate / dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate
                       ELSE 0 END AS CurrencyBillingRate, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRate / dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate
                       ELSE 0 END AS CurrencyEmployeeRate, dbo.vueAccountEmployeeTimeEntryForReport.ProjectRole, dbo.vueAccountEmployeeTimeEntryForReport.ProjectType, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectDescription, dbo.vueAccountEmployeeTimeEntryForReport.TaskDescription, 
                      dbo.vueAccountEmployeeTimeEntryForReport.InvoiceNumber, dbo.vueAccountEmployeeTimeEntryForReport.InvoiceDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectTypeId, dbo.vueAccountEmployeeTimeEntryForReport.Billed, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientContactName, dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentName, dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentLocation, 
                      dbo.vueAccountEmployeeTimeEntryForReport.IsTimeOff, dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkTypeId, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 1 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate * dbo.vueAccountEmployeeTimeEntryForReport.TotalHours
                       ELSE 0 END AS BillableTotalAmount, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate * dbo.vueAccountEmployeeTimeEntryForReport.TotalHours
                       ELSE 0 END AS NonBillableTotalAmount, dbo.vueAccountEmployeeTimeEntryForReport.ProjectStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ParentTaskName, dbo.vueAccountEmployeeTimeEntryForReport.FirstName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.LastName, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeType, 
                      dbo.vueAccountEmployeeTimeEntryForReport.HolidayName
FROM         dbo.vueAccountEmployeeTimeEntryForReport INNER JOIN
                      dbo.vueAccountEmployeeTimeEntryWithLastStatus ON 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryWithLastStatus.AccountEmployeeTimeEntryId
GROUP BY dbo.vueAccountEmployeeTimeEntryForReport.EmployeeName, dbo.vueAccountEmployeeTimeEntryForReport.ProjectName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskName, dbo.vueAccountEmployeeTimeEntryForReport.TotalTime, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeId, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeTimeEntryId, dbo.vueAccountEmployeeTimeEntryForReport.StartTime, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EndTime, dbo.vueAccountEmployeeTimeEntryForReport.TimeEntryDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Description, dbo.vueAccountEmployeeTimeEntryForReport.AccountId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TotalMinutes, dbo.vueAccountEmployeeTimeEntryForReport.WeekDay, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientName, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectTaskId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingType, dbo.vueAccountEmployeeTimeEntryForReport.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManagerEmployeeId, dbo.vueAccountEmployeeTimeEntryForReport.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ExpenseApprovalTypeId, dbo.vueAccountEmployeeTimeEntryForReport.BillingRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectBillingRateTypeId, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountDepartmentId, dbo.vueAccountEmployeeTimeEntryForReport.DepartmentName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCost, dbo.vueAccountEmployeeTimeEntryForReport.EstimatedHours, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkType, dbo.vueAccountEmployeeTimeEntryForReport.EMailAddress, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountLocation, dbo.vueAccountEmployeeTimeEntryForReport.AccountCostCenter, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountCostCenterCode, dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkTypeCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectCode, dbo.vueAccountEmployeeTimeEntryForReport.TaskCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountLocationId, dbo.vueAccountEmployeeTimeEntryForReport.ApproverComments, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Amount, dbo.vueAccountEmployeeTimeEntryForReport.BillingRateCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate, dbo.vueAccountEmployeeTimeEntryForReport.AccountBaseCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingRateCurrencyCode, dbo.vueAccountEmployeeTimeEntryForReport.AmountCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountTaskTypeId, dbo.vueAccountEmployeeTimeEntryForReport.TaskStatusId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountPriorityId, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectMilestoneId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskType, dbo.vueAccountEmployeeTimeEntryForReport.TaskStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.MilestoneDescription, dbo.vueAccountEmployeeTimeEntryForReport.Priority, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TotalHours, dbo.vueAccountEmployeeTimeEntryForReport.DepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientNick, dbo.vueAccountEmployeeTimeEntryForReport.AccountClientId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ApprovedOn, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateCurrencyCode, dbo.vueAccountEmployeeTimeEntryForReport.TeamLeader, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManager, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeManager, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate, 0), dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCost, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountRoleId, dbo.vueAccountEmployeeTimeEntryForReport.Role, 
                      dbo.vueAccountEmployeeTimeEntryForReport.WeekDayName, dbo.vueAccountEmployeeTimeEntryForReport.Period, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Year, dbo.vueAccountEmployeeTimeEntryForReport.WeekNo, dbo.vueAccountEmployeeTimeEntryForReport.MonthNo, 
                      dbo.vueAccountEmployeeTimeEntryForReport.DayNo, dbo.vueAccountEmployeeTimeEntryForReport.ProjectRole, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectType, dbo.vueAccountEmployeeTimeEntryForReport.ProjectDescription, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskDescription, dbo.vueAccountEmployeeTimeEntryForReport.InvoiceNumber, 
                      dbo.vueAccountEmployeeTimeEntryForReport.InvoiceDate, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectTypeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientContactName, dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentName, dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentLocation, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkTypeId, dbo.vueAccountEmployeeTimeEntryForReport.ProjectStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ParentTaskName, dbo.vueAccountEmployeeTimeEntryForReport.FirstName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.LastName, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeType, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Approved, dbo.vueAccountEmployeeTimeEntryForReport.TeamLeadApproved, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManagerApproved, dbo.vueAccountEmployeeTimeEntryForReport.AdministratorApproved, 
                      dbo.vueAccountEmployeeTimeEntryForReport.IsBillable, dbo.vueAccountEmployeeTimeEntryForReport.Rejected, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Submitted, dbo.vueAccountEmployeeTimeEntryForReport.Billed, 
                      dbo.vueAccountEmployeeTimeEntryForReport.IsTimeOff, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate * dbo.vueAccountEmployeeTimeEntryForReport.TotalHours
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 1 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate * dbo.vueAccountEmployeeTimeEntryForReport.TotalHours
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRate / dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate / dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCost / dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.Amount / dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCost / dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable
                       IS NULL THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 1 THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours ELSE 0 END, 
                      CASE WHEN vueAccountEmployeeTimeEntryForReport.Submitted = 1 AND 
                      vueAccountEmployeeTimeEntryForReport.Approved = 0 THEN ''Submitted'' WHEN vueAccountEmployeeTimeEntryForReport.Approved = 1 THEN ''Approved'' WHEN vueAccountEmployeeTimeEntryForReport.Rejected
                       = 1 THEN ''Rejected'' WHEN vueAccountEmployeeTimeEntryForReport.Submitted = 0 AND vueAccountEmployeeTimeEntryForReport.Approved = 0 AND 
                      vueAccountEmployeeTimeEntryForReport.Rejected = 0 THEN ''Not Submitted'' END, dbo.vueAccountEmployeeTimeEntryForReport.HolidayName'

GO

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'
if not exists(Select * from [dbo].[SystemReportDataSourceField] where [SystemReportDataSourceFieldId] = 'dfdfe554-78b8-493c-9c39-60f0c0f02706')
BEGIN
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('dfdfe554-78b8-493c-9c39-60f0c0f02706', '3a080202-6842-4eca-8c79-a945978810b4', N'HolidayName', 125, 0, NULL, NULL, 71, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Holiday Name', 0, 0)
END
GO
-- Drop View vueAccountEmployeeTimeEntryForEmail
Print 'Drop View vueAccountEmployeeTimeEntryForEmail'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryForEmail' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryForEmail]
GO
-- Create View vueAccountEmployeeTimeEntryForEmail
Print 'Create View vueAccountEmployeeTimeEntryForEmail'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryForEmail' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryForEmail
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, MAX(dbo.AccountEmployee.AccountId) AS AccountId, dbo.AccountEmployeeTimeEntry.TimeEntryDate, 
                      SUM(DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) AS TotalMinutes, 
                      CASE WHEN dbo.AccountPreferences.CultureInfoName IS NULL OR
                      dbo.AccountPreferences.CultureInfoName = ''auto'' THEN ''en-us'' ELSE dbo.AccountPreferences.CultureInfoName END AS CultureInfoName, 
                      MAX(dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName) AS EmployeeName, 
                      MAX(dbo.vueAccountWorkingDayType.HoursPerDay) AS HoursPerDay, MAX(dbo.vueAccountWorkingDayType.WeekStartDay) 
                      AS EmployeeWeekStartDay, MAX(dbo.vueAccountWorkingDayType.SystemTimesheetPeriodTypeId) AS SystemTimesheetPeriodTypeId, 
                      MAX(dbo.vueAccountWorkingDayType.SystemInitialDaysOfThePeriodId) AS SystemInitialDaysOfThePeriodId, 
                      MAX(ISNULL(dbo.vueAccountWorkingDayType.InitialDayOfTheMonth, 1)) AS InitialDayOfTheMonth, 
                      MAX(dbo.vueAccountWorkingDayType.SystemTimesheetPeriodType) AS SystemTimesheetPeriodType, 
                      MAX(dbo.vueAccountWorkingDayType.SystemInitialDaysOfThePeriod) AS SystemInitialDaysOfThePeriod, 
                      MAX(ISNULL(dbo.vueAccountWorkingDayType.SystemInitialDayOfFirstPeriod, 1)) AS SystemInitialDayOfFirstPeriod, 
                      MAX(ISNULL(dbo.vueAccountWorkingDayType.SystemInitialDayOfLastPeriod, 16)) AS SystemInitialDayOfLastPeriod
FROM         dbo.AccountEmployee INNER JOIN
                      dbo.AccountEmployeeTimeEntry ON dbo.AccountEmployee.AccountEmployeeId = dbo.AccountEmployeeTimeEntry.AccountEmployeeId INNER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployee.AccountId = dbo.AccountPreferences.AccountId LEFT OUTER JOIN
                      dbo.vueAccountWorkingDayType ON 
                      dbo.AccountEmployee.AccountWorkingDayTypeId = dbo.vueAccountWorkingDayType.AccountWorkingDayTypeId
GROUP BY dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployeeTimeEntry.TimeEntryDate, dbo.AccountPreferences.CultureInfoName'
GO


-- Drop View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreference
Print 'Drop View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreference'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreference' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreference]
GO

-- Create View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreference
Print 'Create View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreference'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreference' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreference
AS
SELECT     dbo.AccountPreferences.ScheduledEmailSendTime, dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, 
                      dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.AccountId, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountEMailNotificationPreference.Monday, 
                      dbo.AccountEMailNotificationPreference.Tuesday, dbo.AccountEMailNotificationPreference.Wednesday, 
                      dbo.AccountEMailNotificationPreference.Thursday, dbo.AccountEMailNotificationPreference.Friday, dbo.AccountEMailNotificationPreference.Saturday, 
                      dbo.AccountEMailNotificationPreference.Sunday, dbo.vueAccountWorkingDayType.HoursPerDay, 
                      dbo.vueAccountWorkingDayType.WeekStartDay AS EmployeeWeekStartDay, dbo.vueAccountWorkingDayType.SystemTimesheetPeriodTypeId, 
                      dbo.vueAccountWorkingDayType.SystemInitialDaysOfThePeriodId, ISNULL(dbo.vueAccountWorkingDayType.InitialDayOfTheMonth, 1) 
                      AS InitialDayOfTheMonth, dbo.vueAccountWorkingDayType.SystemTimesheetPeriodType, 
                      dbo.vueAccountWorkingDayType.SystemInitialDaysOfThePeriod, ISNULL(dbo.vueAccountWorkingDayType.SystemInitialDayOfFirstPeriod, 1) 
                      AS SystemInitialDayOfFirstPeriod, ISNULL(dbo.vueAccountWorkingDayType.SystemInitialDayOfLastPeriod, 16) AS SystemInitialDayOfLastPeriod,
	        CASE WHEN dbo.AccountPreferences.CultureInfoName IS NULL OR
                      dbo.AccountPreferences.CultureInfoName = ''auto'' THEN ''en-us'' ELSE dbo.AccountPreferences.CultureInfoName END AS CultureInfoName
FROM         dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_2 RIGHT OUTER JOIN
                      dbo.vueAccountWorkingDayType RIGHT OUTER JOIN
                      dbo.AccountEmployee ON dbo.vueAccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId ON 
                      AccountEMailNotificationPreference_2.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference ON dbo.AccountEmployee.AccountId = dbo.AccountEMailNotificationPreference.AccountId LEFT OUTER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployee.AccountId = dbo.AccountPreferences.AccountId
WHERE     (AccountEMailNotificationPreference_2.SystemEMailNotificationId = 30) AND (AccountEMailNotificationPreference_2.Enabled = 1) AND 
                      (dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = 29) AND (dbo.AccountEMailNotificationPreference.Enabled = 1) AND 
                      (dbo.AccountEmployee.EmployeeTypeId <> 2 OR
                      dbo.AccountEmployee.EmployeeTypeId IS NULL) AND (dbo.AccountEmployee.IsDeleted <> 1) AND (dbo.AccountEmployee.IsDisabled <> 1)'
GO

Update SystemData Set Version = '3.9.4' Where Version = '3.9.2' And SystemDataId = 1

GO
-- Create Function GET_TZVALUE
Print 'Create Function GET_TZVALUE'
GO
if not exists (select * from information_schema.routines where specific_name = 'GET_TZVALUE' and routine_type = 'FUNCTION') 
EXEC sp_executesql N'
CREATE FUNCTION [dbo].[GET_TZVALUE]
    (@EmployeeTimeZone as float)
RETURNS float
AS
BEGIN
-- DECLARE VARIABLES
Declare @TimezoneValue as float

Set @TimezoneValue = datediff(mi,getutcdate(),getdate()) + (@EmployeeTimeZone*60) - (datediff(mi,getutcdate(),getdate())*2)
Return @TimezoneValue
END'

GO
-- Drop View rptvueTimesheetAuditTrail
Print 'Drop View rptvueTimesheetAuditTrail'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueTimesheetAuditTrail' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueTimesheetAuditTrail]

GO
-- Drop View vueTimesheetAuditTrailForReport
Print 'Drop View vueTimesheetAuditTrailForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueTimesheetAuditTrailForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueTimesheetAuditTrailForReport]

GO
-- Create View vueTimesheetAuditTrailForReport
Print 'Create View vueTimesheetAuditTrailForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueTimesheetAuditTrailForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueTimesheetAuditTrailForReport
AS
SELECT     dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport.Type, dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport.TableName, 
                      dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport.PK, dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport.AuditFieldName, 
                      dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport.AuditOldValue, dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport.AuditNewValue, 
                      CONVERT(DateTime, CONVERT(VARCHAR(10), dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport.UpdateDate, 120), 120) AS UpdateDate, 
                      dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport.TotalTime, dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport.UserName, 
                      dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport.UpdatedBy, dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport.AccountId, dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport.OldValue, 
                      dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport.NewValue, dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport.FieldName, 
                      dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport.Date, dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport.AccountProjectId, 
                      dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport.AccountProjectTaskId, dbo.AccountProject.ProjectName, dbo.AccountProjectTask.TaskName, 
                      dbo.AccountEmployee.TimeZoneId, dbo.SystemTimeZone.TimeZoneDifference
FROM         dbo.SystemTimeZone INNER JOIN
                      dbo.AccountEmployee ON dbo.SystemTimeZone.SystemTimeZoneId = dbo.AccountEmployee.TimeZoneId RIGHT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport ON 
                      dbo.AccountEmployee.AccountEmployeeId = dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountProjectTask ON 
                      dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId LEFT OUTER JOIN
                      dbo.AccountProject ON dbo.vueAccountEmployeeTimeEnryAuditTrailUnionForReport.AccountProjectId = dbo.AccountProject.AccountProjectId'

GO
-- Create View rptvueTimesheetAuditTrail
Print 'Create View rptvueTimesheetAuditTrail'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueTimesheetAuditTrail' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueTimesheetAuditTrail
AS
SELECT     Type, TableName, PK, AuditFieldName, AuditOldValue, AuditNewValue, UpdateDate, TotalTime, UserName, UpdatedBy, AccountEmployeeId, AccountId, OldValue, 
                      NewValue, FieldName, Date, AccountProjectId, AccountProjectTaskId, ProjectName, TaskName
FROM         dbo.vueTimesheetAuditTrailForReport'
GO
-- Drop View vueTimesheetSummaryPendingForApproval
Print 'Drop View vueTimesheetSummaryPendingForApproval'
GO
if exists (select * from information_schema.tables where table_name = 'vueTimesheetSummaryPendingForApproval' and table_type = 'VIEW')
DROP VIEW [dbo].[vueTimesheetSummaryPendingForApproval]
GO
-- Drop View vueTimesheetSummaryForApproval
Print 'Drop View vueTimesheetSummaryForApproval'
GO
if exists (select * from information_schema.tables where table_name = 'vueTimesheetSummaryForApproval' and table_type = 'VIEW')
DROP VIEW [dbo].[vueTimesheetSummaryForApproval]
GO
-- Add Column IsEmailSend to AccountEmployeeTimeEntryApprovalProject
Print 'Add Column IsEmailSend to AccountEmployeeTimeEntryApprovalProject'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntryApprovalProject' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='IsEmailSend' AND TABLE_NAME='AccountEmployeeTimeEntryApprovalProject'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntryApprovalProject]
	ADD [IsEmailSend] bit NULL
GO
-- Create View vueTimesheetSummaryForApproval
Print 'Create View vueTimesheetSummaryForApproval'
GO
if not exists (select * from information_schema.tables where table_name = 'vueTimesheetSummaryForApproval' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueTimesheetSummaryForApproval
AS
SELECT     dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId, 
                      dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeId AS TimeEntryAccountEmployeeId, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, dbo.AccountEmployeeTimeEntryApproval.TimeSheetApprovalId, 
                      dbo.AccountApprovalPath.AccountApprovalPathId, dbo.AccountApprovalPath.SystemApproverTypeId, dbo.AccountApprovalPath.AccountExternalUserId, 
                      dbo.AccountApprovalPath.AccountEmployeeId, dbo.AccountApprovalPath.ApprovalPathSequence, dbo.AccountProject.LeaderEmployeeId, 
                      dbo.AccountProject.ProjectManagerEmployeeId, dbo.AccountApprovalType.AccountApprovalTypeId, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountEmployee.EmployeeManagerId, 
                      dbo.AccountProject.AccountProjectId, dbo.AccountEmployeeTimeEntryApproval.IsApproved, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountEmployeeTimeEntryApprovalProject.AccountEmployeeTimeEntryApprovalProjectId, 
                      dbo.AccountEmployeeTimeEntryApproval.PreviousStatus, dbo.AccountEmployeeTimeEntryApproval.IsReject, 
                      dbo.AccountEmployeeTimeEntryApprovalProject.Submitted, dbo.AccountEmployeeTimeEntryApprovalProject.Approved, 
                      dbo.AccountEmployeeTimeEntryApprovalProject.Rejected, dbo.AccountEmployeeTimeEntryApprovalProject.IsEmailSend, 
                      dbo.AccountEmployeeTimeEntryPeriod.SubmittedDate
FROM         dbo.AccountApprovalType INNER JOIN
                      dbo.AccountEmployeeTimeEntryApprovalProject INNER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntryApprovalProject.AccountProjectId = dbo.AccountProject.AccountProjectId ON 
                      dbo.AccountApprovalType.AccountApprovalTypeId = dbo.AccountProject.TimeSheetApprovalTypeId INNER JOIN
                      dbo.AccountApprovalPath ON dbo.AccountApprovalType.AccountApprovalTypeId = dbo.AccountApprovalPath.AccountApprovalTypeId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryApproval ON 
                      dbo.AccountApprovalPath.ApprovalPathSequence = dbo.AccountEmployeeTimeEntryApproval.ApprovalPathSequence AND 
                      dbo.AccountEmployeeTimeEntryApproval.PreviousStatus <> 1 AND dbo.AccountEmployeeTimeEntryApproval.IsReject <> 1 AND 
                      dbo.AccountEmployeeTimeEntryApprovalProject.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntryApproval.AccountEmployeeTimeEntryPeriodId
                       AND dbo.AccountEmployeeTimeEntryApprovalProject.AccountProjectId = dbo.AccountEmployeeTimeEntryApproval.AccountProjectId RIGHT OUTER JOIN
                      dbo.AccountEmployee RIGHT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryPeriod ON dbo.AccountEmployee.AccountEmployeeId = dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeId ON 
                      dbo.AccountEmployeeTimeEntryApprovalProject.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId'
GO
-- Create View vueTimesheetSummaryPendingForApproval
Print 'Create View vueTimesheetSummaryPendingForApproval'
GO
if not exists (select * from information_schema.tables where table_name = 'vueTimesheetSummaryPendingForApproval' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueTimesheetSummaryPendingForApproval
AS
SELECT     AccountEmployeeTimeEntryPeriodId, TimeEntryAccountEmployeeId, TimeEntryStartDate, TimeEntryEndDate, TimeEntryViewType, Submitted, 
                      Approved, Rejected, MAX(TimeSheetApprovalId) AS TimeSheetApprovalId, AccountApprovalPathId, SystemApproverTypeId, AccountExternalUserId, 
                      AccountEmployeeId, ApprovalPathSequence, LeaderEmployeeId, ProjectManagerEmployeeId, AccountApprovalTypeId, EmployeeName, 
                      EmployeeManagerId, AccountProjectId, 
                      CASE WHEN systemapprovertypeid = 1 THEN LeaderEmployeeId WHEN systemapprovertypeid = 2 THEN ProjectManagerEmployeeId WHEN systemapprovertypeid
                       = 3 THEN AccountEmployeeId WHEN systemapprovertypeid = 4 THEN AccountExternalUserId WHEN systemapprovertypeid = 5 THEN EmployeeManagerId
                       END AS ApproverEmployeeId, IsApproved, EMailAddress, AccountEmployeeTimeEntryApprovalProjectId, IsEmailSend, SubmittedDate
FROM         dbo.vueTimesheetSummaryForApproval
WHERE     (ApprovalPathSequence IN
                          (SELECT     TOP 1 ApprovalPathSequence
                            FROM          dbo.vueTimesheetSequenceForApproval
                            WHERE      (TimeSheetApprovalId IS NULL) AND (AccountProjectId = dbo.vueTimesheetSummaryForApproval.AccountProjectId) AND 
                                                   (AccountEmployeeTimeEntryPeriodId = dbo.vueTimesheetSummaryForApproval.AccountEmployeeTimeEntryPeriodId)))
GROUP BY AccountEmployeeTimeEntryPeriodId, TimeEntryAccountEmployeeId, TimeEntryStartDate, TimeEntryEndDate, TimeEntryViewType, Submitted, 
                      Approved, Rejected, AccountApprovalPathId, SystemApproverTypeId, AccountExternalUserId, AccountEmployeeId, ApprovalPathSequence, 
                      LeaderEmployeeId, ProjectManagerEmployeeId, AccountApprovalTypeId, EmployeeName, EmployeeManagerId, AccountProjectId, IsApproved, 
                      EMailAddress, AccountEmployeeTimeEntryApprovalProjectId, IsEmailSend, SubmittedDate'
GO
-- Drop View vueAccountProjectTaskForQB
Print 'Drop View vueAccountProjectTaskForQB'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountProjectTaskForQB' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountProjectTaskForQB]
GO
-- Create View vueAccountProjectTaskForQB
Print 'Create View vueAccountProjectTaskForQB'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountProjectTaskForQB' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountProjectTaskForQB
AS
SELECT     dbo.AccountProject.AccountId, dbo.AccountProject.ProjectName, dbo.AccountProject.ProjectDescription, dbo.AccountProject.ProjectCode, 
                      CASE WHEN dbo.AccountProjectTask.ParentAccountProjectTaskId IS NULL THEN '''' ELSE Replace(vueAccountProjectTaskWithParentForQB.Parents, 
                      '':'' + LEFT(AccountProjectTask.TaskName, 31), '''') END AS JobItemParent, CASE WHEN dbo.AccountProjectTask.ParentAccountProjectTaskId IS NULL 
                      THEN LEFT(accountproject.ProjectName, 21) ELSE LEFT(accountproject.ProjectName, 21) 
                      + '':'' + Replace(vueAccountProjectTaskWithParentForQB.Parents, '':'' + LEFT(AccountProjectTask.TaskName, 31), '''') END AS ItemParent, 
                      CASE WHEN dbo.AccountProjectTask.ParentAccountProjectTaskId IS NULL THEN LEFT(PartyName, 41) + '':'' + LEFT(ProjectName, 31) 
                      ELSE LEFT(PartyName, 41) + '':'' + LEFT(ProjectName, 31) + '':'' + Replace(vueAccountProjectTaskWithParentForQB.Parents, 
                      '':'' + LEFT(AccountProjectTask.TaskName, 31), '''') END AS JobParent, LEFT(dbo.AccountProjectTask.TaskName, 31) AS TaskName, 
                      dbo.AccountProjectTask.TaskCode, dbo.AccountProject.IsTemplate, dbo.AccountProjectTask.AccountProjectTaskId, dbo.AccountParty.PartyName
FROM         dbo.AccountParty INNER JOIN
                      dbo.AccountProjectTask INNER JOIN
                      dbo.AccountProject ON dbo.AccountProjectTask.AccountProjectId = dbo.AccountProject.AccountProjectId ON 
                      dbo.AccountParty.AccountPartyId = dbo.AccountProject.AccountClientId LEFT OUTER JOIN
                      dbo.vueAccountProjectTaskWithParentForQB ON 
                      dbo.AccountProjectTask.AccountProjectTaskId = dbo.vueAccountProjectTaskWithParentForQB.AccountProjectTaskId'

GO

-- Drop View vueAccountEmployeeTimeEntryApprovalPendingForTimeOff
Print 'Drop View vueAccountEmployeeTimeEntryApprovalPendingForTimeOff'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryApprovalPendingForTimeOff' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryApprovalPendingForTimeOff]

GO
-- Create View vueAccountEmployeeTimeEntryApprovalPendingForTimeOff
Print 'Create View vueAccountEmployeeTimeEntryApprovalPendingForTimeOff'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryApprovalPendingForTimeOff' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryApprovalPendingForTimeOff
AS
SELECT     dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountEmployeeTimeEntryId, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.TimeEntryDate, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.StartTime, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.EndTime, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.TotalTime, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Description, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Approved, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AdministratorApproved, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.CreatedOn, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Rejected, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Submitted, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.IsTimeOff, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Hours, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountTimeOffTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountEmployeeTimeOffRequestId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.ApprovalTypeName, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountApprovalPathId, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.SystemApproverTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountExternalUserId, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.ApprovalPathSequence, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.EmployeeManagerId, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.ModifiedOn, 
                      MAX(dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.TimeSheetApprovalId) AS TimeSheetApprovalId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.ApprovedByEmployeeId, MAX(dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Comments) 
                      AS Comments, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.IsReject, dbo.vueAccountApproverType.MaxApprovalPathSequence, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.TimeEntryAccountEmployeeId, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.EmployeeName, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.EMailAddress, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountTimeOffType, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.TotalMinutes, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.IsApproved, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountEmployeeTimeEntryPeriodId, dbo.AccountTimeOffType.AccountId
FROM         dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff LEFT OUTER JOIN
                      dbo.AccountTimeOffType ON 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId LEFT OUTER JOIN
                      dbo.vueAccountApproverType ON 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountApprovalTypeId = dbo.vueAccountApproverType.AccountApprovalTypeId
WHERE     (dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountApprovalPathId IN
                          (SELECT     TOP 1 AccountApprovalPathId
                            FROM          dbo.vueTimeSheetApprovalSequenceForTimeOff
                            WHERE      (TimeSheetApprovalId IS NULL) AND 
                                                   (AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountEmployeeTimeEntryId))) AND 
                      (dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Approved = 0) AND (dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Rejected IS NULL OR
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Rejected = 0) AND (dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Submitted = 1)
GROUP BY dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountEmployeeTimeEntryId, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.TimeEntryDate, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.StartTime, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.EndTime, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.TotalTime, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Description, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Approved, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AdministratorApproved, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.CreatedOn, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Rejected, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Submitted, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.IsTimeOff, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.Hours, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountTimeOffTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountEmployeeTimeOffRequestId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.ApprovalTypeName, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountApprovalPathId, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.SystemApproverTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountExternalUserId, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.ApprovalPathSequence, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.EmployeeManagerId, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.ModifiedOn, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.ApprovedByEmployeeId, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.IsReject, 
                      dbo.vueAccountApproverType.MaxApprovalPathSequence, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.TimeEntryAccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.EmployeeName, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.EMailAddress, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountTimeOffType, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.TotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.IsApproved, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountEmployeeTimeEntryPeriodId, 
                      dbo.AccountTimeOffType.AccountId'

GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemEMailNotification]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemEMailNotification]'
If Not Exists(Select * from [dbo].[SystemEMailNotification] where [SystemEMailNotificationId] = 43)
BEGIN
INSERT INTO [dbo].[SystemEMailNotification] ([SystemEMailNotificationId], [SystemEMailNotification], [SystemEMailNotificationTypeId], [Enabled], [IsWeekDayAllow]) VALUES (43, N'Daily Time Off Approval Pending Notification', 1, 1, 1)
INSERT INTO [dbo].[SystemEMailNotification] ([SystemEMailNotificationId], [SystemEMailNotification], [SystemEMailNotificationTypeId], [Enabled], [IsWeekDayAllow]) VALUES (44, N'Daily Time Off Approval Pending Notification', 3, 1, 1)
END
GO
-- Drop View vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff]

GO
-- Drop View vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff]

GO
-- Drop View vueAccountEmployeeTimeEntryApprovalPendingEmaiWithPreferencelForTimeOff
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryApprovalPendingEmaiWithPreferencelForTimeOff' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryApprovalPendingEmaiWithPreferencelForTimeOff]

GO
-- Drop View ViewAccountEmployeeTimeOffApprovalPending
if exists (select * from information_schema.tables where table_name = 'ViewAccountEmployeeTimeOffApprovalPending' and table_type = 'VIEW')
DROP VIEW [dbo].[ViewAccountEmployeeTimeOffApprovalPending]

GO
-- Drop View vueAccountEmployeeTimeOffRequestApprovalPendingEmail
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOffRequestApprovalPendingEmail' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeOffRequestApprovalPendingEmail]

GO
-- Drop View vueAccountEmployeeTimeOffRequestApprovalPendingEmailWithPreference
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOffRequestApprovalPendingEmailWithPreference' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeOffRequestApprovalPendingEmailWithPreference]

GO

-- Create View vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff
Print 'Create View vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff
AS
SELECT     AccountEmployeeTimeEntryId, AccountEmployeeId, TimeEntryDate, StartTime, EndTime, TotalTime, Description, Approved, AdministratorApproved, CreatedOn, 
                      Rejected, Submitted, IsTimeOff, Hours, AccountTimeOffTypeId, AccountEmployeeTimeOffRequestId, ApprovalTypeName, AccountApprovalTypeId, 
                      AccountApprovalPathId, SystemApproverTypeId, AccountExternalUserId, ApprovalPathSequence, EmployeeManagerId, ModifiedOn, TimeSheetApprovalId, 
                      ApprovedByEmployeeId, Comments, IsReject, MaxApprovalPathSequence, TimeEntryAccountEmployeeId, EmployeeName, EMailAddress, AccountTimeOffType, 
                      TotalMinutes, IsApproved, AccountEmployeeTimeEntryPeriodId, 
                      CASE WHEN systemapprovertypeid = 3 THEN AccountEmployeeId WHEN systemapprovertypeid = 4 THEN AccountExternalUserId WHEN systemapprovertypeid = 5 THEN
                       EmployeeManagerId END AS ApproverEmployeeId, AccountId
FROM         dbo.vueAccountEmployeeTimeEntryApprovalPendingForTimeOff'

GO
-- Create View vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff
Print 'Create View vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff
AS
SELECT     dbo.vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff.AccountEmployeeTimeEntryId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff.TimeEntryDate, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff.StartTime, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff.EndTime, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff.TotalTime, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff.Description, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff.Approved, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff.AdministratorApproved, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff.CreatedOn, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff.Rejected, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff.Submitted, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff.IsTimeOff, dbo.vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff.Hours, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff.AccountTimeOffTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff.AccountEmployeeTimeOffRequestId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff.ApprovalTypeName, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff.AccountApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff.AccountApprovalPathId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff.SystemApproverTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff.AccountExternalUserId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff.ApprovalPathSequence, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff.EmployeeManagerId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff.ModifiedOn, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff.TimeSheetApprovalId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff.ApprovedByEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff.Comments, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff.IsReject, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff.MaxApprovalPathSequence, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff.TimeEntryAccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff.EmployeeName, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff.EMailAddress, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff.AccountTimeOffType, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff.TotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff.IsApproved, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff.AccountEmployeeTimeEntryPeriodId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff.ApproverEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff.AccountId, dbo.AccountEMailNotificationPreference.Monday, 
                      dbo.AccountEMailNotificationPreference.Tuesday, dbo.AccountEMailNotificationPreference.Wednesday, dbo.AccountEMailNotificationPreference.Thursday, 
                      dbo.AccountEMailNotificationPreference.Friday, dbo.AccountEMailNotificationPreference.Saturday, dbo.AccountEMailNotificationPreference.Sunday
FROM         dbo.AccountEMailNotificationPreference INNER JOIN
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff ON 
                      dbo.AccountEMailNotificationPreference.AccountId = dbo.vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff.AccountId INNER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_1 ON 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingApproverForTimeOff.TimeEntryAccountEmployeeId = AccountEMailNotificationPreference_1.AccountEmployeeId
WHERE     (dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = 43) AND (dbo.AccountEMailNotificationPreference.Enabled = 1) AND 
                      (AccountEMailNotificationPreference_1.SystemEMailNotificationId = 44) AND (AccountEMailNotificationPreference_1.Enabled = 1)'

GO
-- Create View vueAccountEmployeeTimeEntryApprovalPendingEmaiWithPreferencelForTimeOff
Print 'Create View vueAccountEmployeeTimeEntryApprovalPendingEmaiWithPreferencelForTimeOff'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryApprovalPendingEmaiWithPreferencelForTimeOff' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryApprovalPendingEmaiWithPreferencelForTimeOff
AS
SELECT     dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.AccountEmployeeTimeEntryId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.TimeEntryDate, dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.StartTime, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.EndTime, dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.TotalTime, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.Description, dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.Approved, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.AdministratorApproved, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.CreatedOn, dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.Rejected, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.Submitted, dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.IsTimeOff, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.Hours, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.AccountTimeOffTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.AccountEmployeeTimeOffRequestId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.ApprovalTypeName, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.AccountApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.AccountApprovalPathId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.SystemApproverTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.AccountExternalUserId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.ApprovalPathSequence, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.EmployeeManagerId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.ModifiedOn, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.TimeSheetApprovalId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.ApprovedByEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.Comments, dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.IsReject, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.MaxApprovalPathSequence, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.TimeEntryAccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.EmployeeName, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.EMailAddress, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.AccountTimeOffType, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.TotalMinutes, dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.IsApproved, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.AccountEmployeeTimeEntryPeriodId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.ApproverEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.AccountId, dbo.AccountEmployee.EMailAddress AS ApproverEmailAddress, 
                      dbo.AccountPreferences.CultureInfoName, dbo.AccountPreferences.ScheduledEmailSendTime, dbo.AccountEmployee.LastScheduledEmailSentTime, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.Monday, dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.Tuesday, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.Wednesday, dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.Thursday, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.Friday, dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.Saturday, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.Sunday
FROM         dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff INNER JOIN
                      dbo.AccountEmployee ON 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.ApproverEmployeeId = dbo.AccountEmployee.AccountEmployeeId INNER JOIN
                      dbo.AccountPreferences ON dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailForTimeOff.AccountId = dbo.AccountPreferences.AccountId'

GO
-- Create View ViewAccountEmployeeTimeOffApprovalPending
Print 'Create View ViewAccountEmployeeTimeOffApprovalPending'
GO
if not exists (select * from information_schema.tables where table_name = 'ViewAccountEmployeeTimeOffApprovalPending' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.ViewAccountEmployeeTimeOffApprovalPending
AS
SELECT     dbo.vueAccountApproverType.AccountApprovalTypeId, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.IsTimeOff, 
                      dbo.vueAccountApproverType.AccountId
FROM         dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff INNER JOIN
                      dbo.vueAccountEmployeeTimeOffRequestApproval ON 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountApprovalTypeId = dbo.vueAccountEmployeeTimeOffRequestApproval.AccountApprovalTypeId INNER JOIN
                      dbo.vueAccountApproverType ON 
                      dbo.vueAccountEmployeeTimeOffRequestApproval.AccountApprovalTypeId = dbo.vueAccountApproverType.AccountApprovalTypeId AND 
                      dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.AccountApprovalTypeId = dbo.vueAccountApproverType.AccountApprovalTypeId
GROUP BY dbo.vueAccountApproverType.AccountApprovalTypeId, dbo.vueAccountEmployeeTimeEntryApprovalForTimeOff.IsTimeOff, dbo.vueAccountApproverType.AccountId'


GO
-- Create View vueAccountEmployeeTimeOffRequestApprovalPendingEmail
Print 'Create View vueAccountEmployeeTimeOffRequestApprovalPendingEmail'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOffRequestApprovalPendingEmail' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail
AS
SELECT     dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.AccountEmployeeTimeOffRequestId, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.AccountTimeOffTypeId, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.TimeOffAccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.RequestSubmitDate, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.HoursOff, dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.StartDate, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.EndDate, dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.InApproval, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.Approved, dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.Rejected, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.Description, dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.ApprovedOn, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.ApprovedBy, dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.DayOff, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.CreatedByEmployeeId, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.CreatedOn, dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.AccountId, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.ApprovalTypeName, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.AccountApprovalPathId, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.SystemApproverTypeId, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.AccountExternalUserId, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.ApprovalPathSequence, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.TimeOffApprovalPathId, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.ApprovedByEmployeeId, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.ApprovedOnApproval, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.IsRejected, dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.IsApproved, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.Comments, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.TimeOffApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.FirstName, dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.LastName, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.FullName, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.AccountTimeOffType, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.IsTimeOffRequestRequired, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.EMailAddress, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.AccountApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.MaxApprovalPathSequence, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.EmployeeManagerId, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.ApproverEmployeeId, dbo.AccountEMailNotificationPreference.Monday, 
                      dbo.AccountEMailNotificationPreference.Tuesday, dbo.AccountEMailNotificationPreference.Wednesday, dbo.AccountEMailNotificationPreference.Thursday, 
                      dbo.AccountEMailNotificationPreference.Friday, dbo.AccountEMailNotificationPreference.Saturday, dbo.AccountEMailNotificationPreference.Sunday
FROM         dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover INNER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_1 ON 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.TimeOffAccountEmployeeId = AccountEMailNotificationPreference_1.AccountEmployeeId INNER JOIN
                      dbo.AccountEMailNotificationPreference ON 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.AccountId = dbo.AccountEMailNotificationPreference.AccountId
WHERE     (dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = 43) AND (dbo.AccountEMailNotificationPreference.Enabled = 1) AND 
                      (AccountEMailNotificationPreference_1.SystemEMailNotificationId = 44) AND (AccountEMailNotificationPreference_1.Enabled = 1)'


GO
-- Create View vueAccountEmployeeTimeOffRequestApprovalPendingEmailWithPreference
Print 'Create View vueAccountEmployeeTimeOffRequestApprovalPendingEmailWithPreference'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOffRequestApprovalPendingEmailWithPreference' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmailWithPreference
AS
SELECT     dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.AccountEmployeeTimeOffRequestId, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.AccountTimeOffTypeId, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.TimeOffAccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.RequestSubmitDate, dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.HoursOff, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.StartDate, dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.EndDate, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.InApproval, dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.Approved, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.Rejected, dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.Description, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.ApprovedOn, dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.ApprovedBy, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.DayOff, dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.CreatedByEmployeeId, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.CreatedOn, dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.AccountId, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.ApprovalTypeName, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.AccountApprovalPathId, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.SystemApproverTypeId, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.AccountExternalUserId, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.ApprovalPathSequence, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.TimeOffApprovalPathId, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.ApprovedByEmployeeId, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.ApprovedOnApproval, dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.IsRejected, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.IsApproved, dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.Comments, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.TimeOffApprovalTypeId, dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.FirstName, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.LastName, dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.FullName, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.AccountTimeOffType, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.IsTimeOffRequestRequired, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.EMailAddress, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.AccountApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.MaxApprovalPathSequence, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.EmployeeManagerId, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.ApproverEmployeeId, dbo.AccountEmployee.EMailAddress AS ApproverEmailAddress, 
                      dbo.AccountPreferences.CultureInfoName, dbo.AccountPreferences.ScheduledEmailSendTime, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.Monday, dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.Tuesday, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.Wednesday, dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.Thursday, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.Friday, dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.Saturday, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.Sunday, dbo.AccountEmployee.LastScheduledEmailSentTime
FROM         dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail INNER JOIN
                      dbo.AccountEmployee ON 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.ApproverEmployeeId = dbo.AccountEmployee.AccountEmployeeId INNER JOIN
                      dbo.AccountPreferences ON dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail.AccountId = dbo.AccountPreferences.AccountId'

GO
-- Drop View vueAccountExpenseEntryApprovalPendingEmailWithPreference
Print 'Drop View vueAccountExpenseEntryApprovalPendingEmailWithPreference'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryApprovalPendingEmailWithPreference' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountExpenseEntryApprovalPendingEmailWithPreference]
GO
-- Drop View vueAccountExpenseEntryApprovalPendingEmail
Print 'Drop View vueAccountExpenseEntryApprovalPendingEmail'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryApprovalPendingEmail' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountExpenseEntryApprovalPendingEmail]
GO
-- Drop View vueAccountExpenseEntryApprovalPendingSummary
Print 'Drop View vueAccountExpenseEntryApprovalPendingSummary'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryApprovalPendingSummary' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountExpenseEntryApprovalPendingSummary]
GO
-- Drop View vueAccountExpenseEntryApprovalSummary
Print 'Drop View vueAccountExpenseEntryApprovalSummary'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryApprovalSummary' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountExpenseEntryApprovalSummary]
GO
-- Add Column IsEmailSend to AccountExpenseEntry
Print 'Add Column IsEmailSend to AccountExpenseEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountExpenseEntry' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='IsEmailSend' AND TABLE_NAME='AccountExpenseEntry'))
ALTER TABLE [dbo].[AccountExpenseEntry]
	ADD [IsEmailSend] bit NULL

GO
-- Create View vueAccountExpenseEntryApprovalSummary
Print 'Create View vueAccountExpenseEntryApprovalSummary'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryApprovalSummary' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountExpenseEntryApprovalSummary
AS
SELECT     dbo.AccountProject.AccountProjectId, dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, 
                      CASE WHEN Isnull(dbo.AccountExpenseEntry.ExchangeRate, 0) 
                      <> 0 THEN ((dbo.AccountExpenseEntry.Amount / dbo.AccountExpenseEntry.ExchangeRate) * dbo.vueAccountCurrency.ExchangeRate) 
                      ELSE 0 END AS Amount, dbo.AccountExpenseEntry.AccountEmployeeId AS ExpenseEntryAccountEmployeeId, 
                      dbo.AccountExpenseEntry.AccountEmployeeExpenseSheetId, dbo.AccountEmployeeExpenseSheet.Description, 
                      dbo.AccountEmployeeExpenseSheet.ExpenseSheetDate, dbo.AccountProject.LeaderEmployeeId, dbo.AccountProject.ProjectManagerEmployeeId, 
                      dbo.AccountApprovalPath.AccountApprovalPathId, dbo.AccountApprovalPath.SystemApproverTypeId, dbo.AccountApprovalPath.AccountExternalUserId, 
                      dbo.AccountApprovalPath.ApprovalPathSequence, dbo.AccountApprovalPath.AccountEmployeeId, dbo.AccountExpenseEntryApproval.IsRejected, 
                      dbo.AccountExpenseEntryApproval.IsApproved, dbo.AccountExpenseEntryApproval.ExpenseApprovalId, dbo.AccountEmployee.EmployeeManagerId, 
                      dbo.AccountEmployee.EMailAddress, dbo.AccountEmployee.AccountId, dbo.AccountExpenseEntry.AccountExpenseEntryId, 
                      dbo.vueAccountCurrency.CurrencyCode, dbo.AccountExpenseEntry.Approved, dbo.AccountExpenseEntry.Rejected, 
                      dbo.AccountExpenseEntry.Submitted, dbo.AccountEmployeeExpenseSheet.SubmittedDate, dbo.AccountExpenseEntry.IsEmailSend
FROM         dbo.AccountApprovalPath INNER JOIN
                      dbo.AccountEmployeeExpenseSheet INNER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.AccountExpenseEntry ON dbo.AccountEmployee.AccountEmployeeId = dbo.AccountExpenseEntry.AccountEmployeeId ON 
                      dbo.AccountEmployeeExpenseSheet.AccountEmployeeExpenseSheetId = dbo.AccountExpenseEntry.AccountEmployeeExpenseSheetId INNER JOIN
                      dbo.AccountProject ON dbo.AccountExpenseEntry.AccountProjectId = dbo.AccountProject.AccountProjectId INNER JOIN
                      dbo.AccountApprovalType ON dbo.AccountProject.ExpenseApprovalTypeId = dbo.AccountApprovalType.AccountApprovalTypeId ON 
                      dbo.AccountApprovalPath.AccountApprovalTypeId = dbo.AccountApprovalType.AccountApprovalTypeId INNER JOIN
                      dbo.AccountPreferences ON dbo.AccountExpenseEntry.AccountId = dbo.AccountPreferences.AccountId INNER JOIN
                      dbo.vueAccountCurrency ON dbo.AccountPreferences.AccountBaseCurrencyId = dbo.vueAccountCurrency.AccountCurrencyId LEFT OUTER JOIN
                      dbo.AccountExpenseEntryApproval ON 
                      dbo.AccountApprovalPath.ApprovalPathSequence = dbo.AccountExpenseEntryApproval.ApprovalPathSequence AND 
                      dbo.AccountExpenseEntry.AccountExpenseEntryId = dbo.AccountExpenseEntryApproval.AccountExpenseEntryId AND 
                      dbo.AccountExpenseEntryApproval.IsRejected <> 1'
GO
-- Create View vueAccountExpenseEntryApprovalPendingSummary
Print 'Create View vueAccountExpenseEntryApprovalPendingSummary'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryApprovalPendingSummary' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountExpenseEntryApprovalPendingSummary
AS
SELECT     AccountProjectId, EmployeeName, SUM(Amount) AS Amount, ExpenseEntryAccountEmployeeId, AccountEmployeeExpenseSheetId, Description, 
                      ExpenseSheetDate, LeaderEmployeeId, ProjectManagerEmployeeId, AccountExternalUserId, ApprovalPathSequence, AccountEmployeeId, IsRejected, 
                      IsApproved, MAX(ExpenseApprovalId) AS ExpenseApprovalId, Approved, Rejected, Submitted, 
                      CASE WHEN systemapprovertypeid = 1 THEN LeaderEmployeeId WHEN systemapprovertypeid = 2 THEN ProjectManagerEmployeeId WHEN systemapprovertypeid
                       = 3 THEN AccountEmployeeId WHEN systemapprovertypeid = 4 THEN AccountExternalUserId WHEN systemapprovertypeid = 5 THEN EmployeeManagerId
                       END AS ApproverEmployeeId, EmployeeManagerId, EMailAddress, AccountId, SystemApproverTypeId, AccountApprovalPathId, 
                      CurrencyCode AS BaseCurrencyCode, SubmittedDate, IsEmailSend
FROM         dbo.vueAccountExpenseEntryApprovalSummary
WHERE     (ApprovalPathSequence IN
                          (SELECT     TOP 1 ApprovalPathSequence
                            FROM          dbo.vueExpenseApprovalSequenceSummary
                            WHERE      (ExpenseApprovalId IS NULL) AND (AccountProjectId = dbo.vueAccountExpenseEntryApprovalSummary.AccountProjectId) AND 
                                                   (AccountEmployeeExpenseSheetId = dbo.vueAccountExpenseEntryApprovalSummary.AccountEmployeeExpenseSheetId)))
GROUP BY EmployeeName, ExpenseEntryAccountEmployeeId, AccountEmployeeExpenseSheetId, Description, ExpenseSheetDate, AccountProjectId, 
                      LeaderEmployeeId, ProjectManagerEmployeeId, AccountExternalUserId, ApprovalPathSequence, AccountEmployeeId, IsRejected, IsApproved, 
                      Approved, Rejected, Submitted, EmployeeManagerId, EMailAddress, AccountId, SystemApproverTypeId, AccountApprovalPathId, CurrencyCode, 
                      SubmittedDate, IsEmailSend'
GO
-- Create View vueAccountExpenseEntryApprovalPendingEmail
Print 'Create View vueAccountExpenseEntryApprovalPendingEmail'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryApprovalPendingEmail' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountExpenseEntryApprovalPendingEmail
AS
SELECT     dbo.vueAccountExpenseEntryApprovalPendingSummary.AccountProjectId, dbo.vueAccountExpenseEntryApprovalPendingSummary.EmployeeName, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.Amount, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.ExpenseEntryAccountEmployeeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.AccountEmployeeExpenseSheetId, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.Description, dbo.vueAccountExpenseEntryApprovalPendingSummary.ExpenseSheetDate, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.LeaderEmployeeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.ProjectManagerEmployeeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.AccountExternalUserId, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.ApprovalPathSequence, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.AccountEmployeeId, dbo.vueAccountExpenseEntryApprovalPendingSummary.IsRejected, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.IsApproved, dbo.vueAccountExpenseEntryApprovalPendingSummary.ExpenseApprovalId, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.Approved, dbo.vueAccountExpenseEntryApprovalPendingSummary.Rejected, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.Submitted, dbo.vueAccountExpenseEntryApprovalPendingSummary.ApproverEmployeeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.EmployeeManagerId, dbo.vueAccountExpenseEntryApprovalPendingSummary.EMailAddress, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.AccountId, dbo.vueAccountExpenseEntryApprovalPendingSummary.SystemApproverTypeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.AccountApprovalPathId, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.BaseCurrencyCode, AccountEMailNotificationPreference_1.Monday, 
                      AccountEMailNotificationPreference_1.Tuesday, AccountEMailNotificationPreference_1.Wednesday, AccountEMailNotificationPreference_1.Thursday, 
                      AccountEMailNotificationPreference_1.Friday, AccountEMailNotificationPreference_1.Saturday, AccountEMailNotificationPreference_1.Sunday, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.SubmittedDate, dbo.vueAccountExpenseEntryApprovalPendingSummary.IsEmailSend
FROM         dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_2 RIGHT OUTER JOIN
                      dbo.vueAccountExpenseEntryApprovalPendingSummary ON 
                      AccountEMailNotificationPreference_2.AccountProjectId = dbo.vueAccountExpenseEntryApprovalPendingSummary.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_1 ON 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.AccountId = AccountEMailNotificationPreference_1.AccountId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference ON 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.ExpenseEntryAccountEmployeeId = dbo.AccountEMailNotificationPreference.AccountEmployeeId
WHERE     (AccountEMailNotificationPreference_1.SystemEMailNotificationId = 26) AND (AccountEMailNotificationPreference_1.Enabled = 1) AND 
                      (AccountEMailNotificationPreference_2.SystemEMailNotificationId = 27) AND (AccountEMailNotificationPreference_2.Enabled = 1) AND 
                      (dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = 28) AND (dbo.AccountEMailNotificationPreference.Enabled = 1)'
GO
-- Create View vueAccountExpenseEntryApprovalPendingEmailWithPreference
Print 'Create View vueAccountExpenseEntryApprovalPendingEmailWithPreference'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryApprovalPendingEmailWithPreference' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountExpenseEntryApprovalPendingEmailWithPreference
AS
SELECT     dbo.vueAccountExpenseEntryApprovalPendingEmail.AccountProjectId, dbo.vueAccountExpenseEntryApprovalPendingEmail.LeaderEmployeeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.ProjectManagerEmployeeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.AccountApprovalPathId, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.SystemApproverTypeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.AccountExternalUserId, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.ApprovalPathSequence, dbo.vueAccountExpenseEntryApprovalPendingEmail.ExpenseApprovalId, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.EmployeeName, dbo.vueAccountExpenseEntryApprovalPendingEmail.Approved, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.IsRejected, dbo.vueAccountExpenseEntryApprovalPendingEmail.IsApproved, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.Amount, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.ExpenseEntryAccountEmployeeId AS AccountEmployeeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.Description, dbo.vueAccountExpenseEntryApprovalPendingEmail.ApproverEmployeeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.AccountId, dbo.AccountEmployee.EMailAddress AS ApproverEmailAddress, 
                      dbo.AccountPreferences.ScheduledEmailSendTime, dbo.vueAccountExpenseEntryApprovalPendingEmail.EMailAddress, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.EmployeeManagerId, CASE WHEN dbo.AccountPreferences.CultureInfoName IS NULL OR
                      dbo.AccountPreferences.CultureInfoName = ''auto'' THEN ''en-us'' ELSE dbo.AccountPreferences.CultureInfoName END AS CultureInfoName, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.AccountEmployeeExpenseSheetId, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.ExpenseSheetDate, dbo.vueAccountExpenseEntryApprovalPendingEmail.BaseCurrencyCode, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.vueAccountExpenseEntryApprovalPendingEmail.Monday, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.Tuesday, dbo.vueAccountExpenseEntryApprovalPendingEmail.Wednesday, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.Thursday, dbo.vueAccountExpenseEntryApprovalPendingEmail.Friday, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.Saturday, dbo.vueAccountExpenseEntryApprovalPendingEmail.Sunday, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.Rejected, dbo.vueAccountExpenseEntryApprovalPendingEmail.Submitted, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.SubmittedDate, dbo.vueAccountExpenseEntryApprovalPendingEmail.IsEmailSend
FROM         dbo.vueAccountExpenseEntryApprovalPendingEmail LEFT OUTER JOIN
                      dbo.AccountPreferences ON dbo.vueAccountExpenseEntryApprovalPendingEmail.AccountId = dbo.AccountPreferences.AccountId LEFT OUTER JOIN
                      dbo.AccountEmployee ON 
                      dbo.vueAccountExpenseEntryApprovalPendingEmail.ApproverEmployeeId = dbo.AccountEmployee.AccountEmployeeId
WHERE     (dbo.AccountEmployee.IsDeleted <> 1)'

GO

-- Drop View rptvueAccountEmployeeTimeEntryPeriod
Print 'Drop View rptvueAccountEmployeeTimeEntryPeriod'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeEntryPeriod' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountEmployeeTimeEntryPeriod]

GO
-- Create View rptvueAccountEmployeeTimeEntryPeriod
Print 'Create View rptvueAccountEmployeeTimeEntryPeriod'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeEntryPeriod' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountEmployeeTimeEntryPeriod
AS
SELECT     dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountEmployeeTimeEntryPeriodId, dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountId, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountEmployeeId, dbo.vueAccountEmployeeTimeEntryPeriodForReport.TimeEntryStartDate, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.TimeEntryEndDate, dbo.vueAccountEmployeeTimeEntryPeriodForReport.TimeEntryViewType, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.Submitted, dbo.vueAccountEmployeeTimeEntryPeriodForReport.Approved, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.Rejected, dbo.vueAccountEmployeeTimeEntryPeriodForReport.InApproval, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.SubmittedDate, dbo.vueAccountEmployeeTimeEntryPeriodForReport.EmployeeName, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountLocationId, dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountDepartmentId, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountLocation, dbo.vueAccountEmployeeTimeEntryPeriodForReport.Role, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.DepartmentName, dbo.vueAccountEmployeeTimeEntryPeriodForReport.EMailAddress, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountRoleId, dbo.vueAccountEmployeeTimeEntryPeriodForReport.ApprovalStatus, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.DayNo, dbo.vueAccountEmployeeTimeEntryPeriodForReport.MonthNo, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.WeekNo, dbo.vueAccountEmployeeTimeEntryPeriodForReport.Year, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.Period, dbo.vueAccountEmployeeTimeEntryPeriodForReport.WeekDayName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryPeriodForReport.TotalHours, 0) AS TotalHours, dbo.vueAccountEmployeeTimeEntryPeriodForReport.Amount, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.BillingRate, dbo.vueAccountEmployeeTimeEntryPeriodForReport.SubmittedHours, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.ApprovedHours, dbo.vueAccountEmployeeTimeEntryPeriodForReport.RejectedHours, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.EmployeeCode, 
                      CASE WHEN BillingRateExchangeRate > 0 THEN Amount / BillingRateExchangeRate ELSE 0 END AS CurrencyAmount, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryPeriodForReport.Approved = 1 THEN dbo.vueAccountEmployeeTimeEntryPeriodForReport.ApprovedOn ELSE NULL 
                      END AS ApprovedDate, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryPeriodForReport.Rejected = 1 THEN dbo.vueAccountEmployeeTimeEntryPeriodForReport.RejectedOn ELSE NULL 
                      END AS RejectedDate, AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName AS ApprovedByEmployeeName, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS RejectedByEmployeeName, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.ClientContactName, dbo.vueAccountEmployeeTimeEntryPeriodForReport.ClientDepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.ClientDepartmentName, dbo.vueAccountEmployeeTimeEntryPeriodForReport.ClientDepartmentLocation, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.TimeOffHours, dbo.vueAccountEmployeeTimeEntryPeriodForReport.TimesheetHours, 
                      dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, dbo.AccountWorkingDayType.MinimumHoursPerWeek, 
                      dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay
FROM         dbo.AccountWorkingDayType RIGHT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport ON 
                      dbo.AccountWorkingDayType.AccountId = dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountId LEFT OUTER JOIN
                      dbo.AccountEmployee ON dbo.vueAccountEmployeeTimeEntryPeriodForReport.RejectedByEmployeeId = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.ApprovedByEmployeeId = AccountEmployee_1.AccountEmployeeId'

GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'
if not exists(Select * from [dbo].[SystemReportDataSourceField] where [SystemReportDataSourceFieldId] = '52b3a70a-4b0b-4415-9fa6-63de943ebb30')
BEGIN
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('52b3a70a-4b0b-4415-9fa6-63de943ebb30', '18966956-9937-4da0-a6f3-465e6066d433', N'MinimumHoursPerDay', 125, 0, NULL, NULL, 41, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Minimum Hours Per Day', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('8d092c1a-ec80-4d0a-9dbb-b06e7c6bfe03', '18966956-9937-4da0-a6f3-465e6066d433', N'HoursPerDay', 125, 0, NULL, NULL, 40, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Hours Per Day', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('82154444-2452-4693-8c4a-99ff607a5539', '18966956-9937-4da0-a6f3-465e6066d433', N'MaximumHoursPerWeek', 110, 0, NULL, NULL, 44, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Maximum Hours Per Period', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('fe8e25da-f2be-4bc6-8761-9875af058e93', '18966956-9937-4da0-a6f3-465e6066d433', N'MaximumHoursPerDay', 100, 0, NULL, NULL, 42, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Maximum Hours Per Day', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('2c0883f5-7272-4837-804d-9bc4a72fc55a', '18966956-9937-4da0-a6f3-465e6066d433', N'MinimumHoursPerWeek', 125, 0, NULL, NULL, 43, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Minimum Hours Per Period', 0, 0)

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'

UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=35 WHERE [SystemReportDataSourceFieldId]='7345bf5c-d3d6-4333-bc8d-190dc24e2bdb'
UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=33 WHERE [SystemReportDataSourceFieldId]='31ec898a-397a-4db6-b9a4-93065f9c1164'
UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=34 WHERE [SystemReportDataSourceFieldId]='9d0158d1-c743-44a1-949e-88c862ea27fb'
UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=37 WHERE [SystemReportDataSourceFieldId]='ff04aed4-8b0f-43b1-91cd-5793882bf861'
UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=36 WHERE [SystemReportDataSourceFieldId]='3e97c0da-f348-4473-af95-b05449750a14'

END
GO

GO
-- Create View vueAccountExpenseEntryApprovalPendingEmailInstant
Print 'Create View vueAccountExpenseEntryApprovalPendingEmailInstant'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryApprovalPendingEmailInstant' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountExpenseEntryApprovalPendingEmailInstant
AS
SELECT     dbo.vueAccountExpenseEntryApprovalPendingSummary.AccountProjectId, dbo.vueAccountExpenseEntryApprovalPendingSummary.EmployeeName, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.Amount, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.ExpenseEntryAccountEmployeeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.AccountEmployeeExpenseSheetId, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.Description, dbo.vueAccountExpenseEntryApprovalPendingSummary.ExpenseSheetDate, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.LeaderEmployeeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.ProjectManagerEmployeeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.AccountExternalUserId, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.ApprovalPathSequence, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.AccountEmployeeId, dbo.vueAccountExpenseEntryApprovalPendingSummary.IsRejected, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.IsApproved, dbo.vueAccountExpenseEntryApprovalPendingSummary.ExpenseApprovalId, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.Approved, dbo.vueAccountExpenseEntryApprovalPendingSummary.Rejected, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.Submitted, dbo.vueAccountExpenseEntryApprovalPendingSummary.ApproverEmployeeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.EmployeeManagerId, dbo.vueAccountExpenseEntryApprovalPendingSummary.EMailAddress, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.AccountId, dbo.vueAccountExpenseEntryApprovalPendingSummary.SystemApproverTypeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.AccountApprovalPathId, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.BaseCurrencyCode, dbo.vueAccountExpenseEntryApprovalPendingSummary.SubmittedDate, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.IsEmailSend
FROM         dbo.vueAccountExpenseEntryApprovalPendingSummary INNER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_1 ON 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.ExpenseEntryAccountEmployeeId = AccountEMailNotificationPreference_1.AccountEmployeeId INNER
                       JOIN
                      dbo.AccountEMailNotificationPreference ON 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.AccountId = dbo.AccountEMailNotificationPreference.AccountId
WHERE     (dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = 47) AND (dbo.AccountEMailNotificationPreference.Enabled = 1) AND 
                      (AccountEMailNotificationPreference_1.SystemEMailNotificationId = 48) AND (AccountEMailNotificationPreference_1.Enabled = 1)'
GO
-- Create View vueTimesheetSummaryPendingApprovalForEmail
Print 'Create View vueTimesheetSummaryPendingApprovalForEmail'
GO
if not exists (select * from information_schema.tables where table_name = 'vueTimesheetSummaryPendingApprovalForEmail' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueTimesheetSummaryPendingApprovalForEmail
AS
SELECT    TOP 100 Percent dbo.vueTimesheetSummaryPendingForApproval.AccountEmployeeTimeEntryPeriodId, 
                      dbo.vueTimesheetSummaryPendingForApproval.TimeEntryAccountEmployeeId, dbo.vueTimesheetSummaryPendingForApproval.TimeEntryStartDate, 
                      dbo.vueTimesheetSummaryPendingForApproval.TimeEntryEndDate, dbo.vueTimesheetSummaryPendingForApproval.TimeEntryViewType, 
                      dbo.vueTimesheetSummaryPendingForApproval.EmployeeName, SUM(DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, 
                      dbo.AccountEmployeeTimeEntry.TotalTime)) AS TotalMinutes, MAX(dbo.AccountEmployeeTimeEntry.TimeEntryDate) AS TimeEntryDate, 
                      SUM(CASE WHEN dbo.AccountProjectTask.IsBillable = 1 THEN DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, 
                      dbo.AccountEmployeeTimeEntry.TotalTime) ELSE 0 END) AS BillableTotalMinutes, 
                      SUM(CASE WHEN dbo.AccountProjectTask.IsBillable = 0 THEN DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, 
                      dbo.AccountEmployeeTimeEntry.TotalTime) WHEN dbo.AccountProjectTask.IsBillable IS NULL THEN DATEPART(hh, 
                      dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime) ELSE 0 END) AS NonBillableTotalMinutes, 
                      dbo.vueTimesheetSummaryPendingForApproval.EMailAddress, dbo.vueTimesheetSummaryPendingForApproval.AccountProjectId, 
                      dbo.vueTimesheetSummaryPendingForApproval.ApproverEmployeeId, MAX(dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName) 
                      AS ApproverEmployeeName, MAX(dbo.AccountEmployee.EMailAddress) AS ApproverEMailAddress, 
                      CASE WHEN MAX(dbo.AccountPreferences.CultureInfoName) IS NULL OR
                      MAX(dbo.AccountPreferences.CultureInfoName) = ''auto'' THEN ''en-us'' ELSE MAX(dbo.AccountPreferences.CultureInfoName) END AS CultureInfoName, 
                      dbo.vueTimesheetSummaryPendingForApproval.AccountEmployeeTimeEntryApprovalProjectId, 
                      dbo.vueTimesheetSummaryPendingForApproval.SubmittedDate, dbo.AccountEmployee.AccountId, 
                      dbo.vueTimesheetSummaryPendingForApproval.IsEmailSend, dbo.vueTimesheetSummaryPendingForApproval.Submitted, 
                      dbo.vueTimesheetSummaryPendingForApproval.Approved, dbo.vueTimesheetSummaryPendingForApproval.Rejected
FROM         dbo.AccountPreferences INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountPreferences.AccountId = dbo.AccountEmployee.AccountId RIGHT OUTER JOIN
                      dbo.vueTimesheetSummaryPendingForApproval INNER JOIN
                      dbo.AccountEmployeeTimeEntry ON 
                      dbo.vueTimesheetSummaryPendingForApproval.TimeEntryAccountEmployeeId = dbo.AccountEmployeeTimeEntry.AccountEmployeeId AND 
                      dbo.vueTimesheetSummaryPendingForApproval.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId
                       AND 
                      dbo.vueTimesheetSummaryPendingForApproval.AccountEmployeeTimeEntryApprovalProjectId = dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId
                       ON dbo.AccountEmployee.AccountEmployeeId = dbo.vueTimesheetSummaryPendingForApproval.ApproverEmployeeId LEFT OUTER JOIN
                      dbo.AccountProjectTask ON dbo.AccountEmployeeTimeEntry.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId
GROUP BY dbo.vueTimesheetSummaryPendingForApproval.AccountEmployeeTimeEntryPeriodId, 
                      dbo.vueTimesheetSummaryPendingForApproval.TimeEntryAccountEmployeeId, dbo.vueTimesheetSummaryPendingForApproval.TimeEntryStartDate, 
                      dbo.vueTimesheetSummaryPendingForApproval.TimeEntryEndDate, dbo.vueTimesheetSummaryPendingForApproval.TimeEntryViewType, 
                      dbo.vueTimesheetSummaryPendingForApproval.EmployeeName, dbo.vueTimesheetSummaryPendingForApproval.EMailAddress, 
                      dbo.vueTimesheetSummaryPendingForApproval.ApproverEmployeeId, dbo.vueTimesheetSummaryPendingForApproval.AccountProjectId, 
                      dbo.vueTimesheetSummaryPendingForApproval.AccountEmployeeTimeEntryApprovalProjectId, 
                      dbo.vueTimesheetSummaryPendingForApproval.SubmittedDate, dbo.AccountEmployee.AccountId, 
                      dbo.vueTimesheetSummaryPendingForApproval.IsEmailSend, dbo.vueTimesheetSummaryPendingForApproval.Submitted, 
                      dbo.vueTimesheetSummaryPendingForApproval.Approved, dbo.vueTimesheetSummaryPendingForApproval.Rejected
ORDER BY dbo.vueTimesheetSummaryPendingForApproval.ApproverEmployeeId'
GO
-- Create View vueAccountExpenseEntryApprovalPendingEmailInstantWithPreference
Print 'Create View vueAccountExpenseEntryApprovalPendingEmailInstantWithPreference'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryApprovalPendingEmailInstantWithPreference' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountExpenseEntryApprovalPendingEmailInstantWithPreference
AS
SELECT     dbo.vueAccountExpenseEntryApprovalPendingEmailInstant.AccountProjectId, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmailInstant.EmployeeName, dbo.vueAccountExpenseEntryApprovalPendingEmailInstant.Amount, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmailInstant.ExpenseEntryAccountEmployeeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmailInstant.AccountEmployeeExpenseSheetId, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmailInstant.Description, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmailInstant.ExpenseSheetDate, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmailInstant.LeaderEmployeeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmailInstant.ProjectManagerEmployeeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmailInstant.AccountExternalUserId, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmailInstant.ApprovalPathSequence, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmailInstant.AccountEmployeeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmailInstant.IsRejected, dbo.vueAccountExpenseEntryApprovalPendingEmailInstant.IsApproved, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmailInstant.ExpenseApprovalId, dbo.vueAccountExpenseEntryApprovalPendingEmailInstant.Approved, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmailInstant.Rejected, dbo.vueAccountExpenseEntryApprovalPendingEmailInstant.Submitted, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmailInstant.ApproverEmployeeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmailInstant.EmployeeManagerId, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmailInstant.EMailAddress, dbo.vueAccountExpenseEntryApprovalPendingEmailInstant.AccountId, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmailInstant.SystemApproverTypeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmailInstant.AccountApprovalPathId, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmailInstant.BaseCurrencyCode, 
                      dbo.vueAccountExpenseEntryApprovalPendingEmailInstant.SubmittedDate, dbo.vueAccountExpenseEntryApprovalPendingEmailInstant.IsEmailSend, 
                      dbo.AccountPreferences.ScheduledEmailSendTime, dbo.AccountEmployee.EMailAddress AS ApproverEmailAddress, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, CASE WHEN dbo.AccountPreferences.CultureInfoName IS NULL OR
                      dbo.AccountPreferences.CultureInfoName = ''auto'' THEN ''en-us'' ELSE dbo.AccountPreferences.CultureInfoName END AS CultureInfoName
FROM         dbo.vueAccountExpenseEntryApprovalPendingEmailInstant INNER JOIN
                      dbo.AccountPreferences ON dbo.vueAccountExpenseEntryApprovalPendingEmailInstant.AccountId = dbo.AccountPreferences.AccountId INNER JOIN
                      dbo.AccountEmployee ON dbo.vueAccountExpenseEntryApprovalPendingEmailInstant.ApproverEmployeeId = dbo.AccountEmployee.AccountEmployeeId'
GO
-- Create View vueTimesheetSummaryPendingApprovalForEmailWithPreference
Print 'Create View vueTimesheetSummaryPendingApprovalForEmailWithPreference'
GO
if not exists (select * from information_schema.tables where table_name = 'vueTimesheetSummaryPendingApprovalForEmailWithPreference' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueTimesheetSummaryPendingApprovalForEmailWithPreference
AS
SELECT     dbo.vueTimesheetSummaryPendingApprovalForEmail.AccountEmployeeTimeEntryPeriodId, 
                      dbo.vueTimesheetSummaryPendingApprovalForEmail.TimeEntryAccountEmployeeId, 
                      dbo.vueTimesheetSummaryPendingApprovalForEmail.TimeEntryStartDate, dbo.vueTimesheetSummaryPendingApprovalForEmail.TimeEntryEndDate, 
                      dbo.vueTimesheetSummaryPendingApprovalForEmail.TimeEntryViewType, dbo.vueTimesheetSummaryPendingApprovalForEmail.EmployeeName, 
                      dbo.vueTimesheetSummaryPendingApprovalForEmail.TotalMinutes, dbo.vueTimesheetSummaryPendingApprovalForEmail.TimeEntryDate, 
                      dbo.vueTimesheetSummaryPendingApprovalForEmail.BillableTotalMinutes, 
                      dbo.vueTimesheetSummaryPendingApprovalForEmail.NonBillableTotalMinutes, dbo.vueTimesheetSummaryPendingApprovalForEmail.EMailAddress, 
                      dbo.vueTimesheetSummaryPendingApprovalForEmail.AccountProjectId, dbo.vueTimesheetSummaryPendingApprovalForEmail.ApproverEmployeeId, 
                      dbo.vueTimesheetSummaryPendingApprovalForEmail.ApproverEmployeeName, 
                      dbo.vueTimesheetSummaryPendingApprovalForEmail.ApproverEMailAddress, dbo.vueTimesheetSummaryPendingApprovalForEmail.CultureInfoName, 
                      dbo.vueTimesheetSummaryPendingApprovalForEmail.AccountEmployeeTimeEntryApprovalProjectId, 
                      dbo.vueTimesheetSummaryPendingApprovalForEmail.SubmittedDate, dbo.vueTimesheetSummaryPendingApprovalForEmail.AccountId, 
                      dbo.vueTimesheetSummaryPendingApprovalForEmail.IsEmailSend, dbo.vueTimesheetSummaryPendingApprovalForEmail.Submitted, 
                      dbo.vueTimesheetSummaryPendingApprovalForEmail.Approved, dbo.vueTimesheetSummaryPendingApprovalForEmail.Rejected
FROM         dbo.vueTimesheetSummaryPendingApprovalForEmail INNER JOIN
                      dbo.AccountEMailNotificationPreference ON 
                      dbo.vueTimesheetSummaryPendingApprovalForEmail.AccountId = dbo.AccountEMailNotificationPreference.AccountId INNER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_1 ON 
                      dbo.vueTimesheetSummaryPendingApprovalForEmail.TimeEntryAccountEmployeeId = AccountEMailNotificationPreference_1.AccountEmployeeId
WHERE     (dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = 45) AND (dbo.AccountEMailNotificationPreference.Enabled = 1) AND 
                      (AccountEMailNotificationPreference_1.SystemEMailNotificationId = 46) AND (AccountEMailNotificationPreference_1.Enabled = 1)'
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemEMailNotification]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemEMailNotification]'
IF Not Exists(Select * from [dbo].[SystemEMailNotification] where [SystemEMailNotificationId] = 45)
BEGIN
INSERT INTO [dbo].[SystemEMailNotification] ([SystemEMailNotificationId], [SystemEMailNotification], [SystemEMailNotificationTypeId], [Enabled], [IsWeekDayAllow]) VALUES (45, N'Instant Timesheet Approval Pending Notification', 1, 1, NULL)
INSERT INTO [dbo].[SystemEMailNotification] ([SystemEMailNotificationId], [SystemEMailNotification], [SystemEMailNotificationTypeId], [Enabled], [IsWeekDayAllow]) VALUES (46, N'Instant Timesheet Approval Pending Notification', 3, 1, NULL)
INSERT INTO [dbo].[SystemEMailNotification] ([SystemEMailNotificationId], [SystemEMailNotification], [SystemEMailNotificationTypeId], [Enabled], [IsWeekDayAllow]) VALUES (47, N'Instant Expense Approval Pending Notification', 1, 1, NULL)
INSERT INTO [dbo].[SystemEMailNotification] ([SystemEMailNotificationId], [SystemEMailNotification], [SystemEMailNotificationTypeId], [Enabled], [IsWeekDayAllow]) VALUES (48, N'Instant Expense Approval Pending Notification', 3, 1, NULL)
END


GO
-- Drop View VueAccountProjectTaskEmployeeForReport
Print 'Drop View VueAccountProjectTaskEmployeeForReport'
GO
If exists (select * from information_schema.tables where table_name = 'VueAccountProjectTaskEmployeeForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[VueAccountProjectTaskEmployeeForReport]

GO
-- Drop View vueAccountProjectTeamForReport
Print 'Drop View vueAccountProjectTeamForReport'
GO
If exists (select * from information_schema.tables where table_name = 'vueAccountProjectTeamForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountProjectTeamForReport]

GO
-- Drop View rptvueAccountProjectTaskEmployee
Print 'Drop View rptvueAccountProjectTaskEmployee'
GO
If exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectTaskEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountProjectTaskEmployee]

GO
-- Drop View rptvueAccountProjectTeam
Print 'Drop View rptvueAccountProjectTeam'
GO
If exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectTeam' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountProjectTeam]

GO
-- Create View VueAccountProjectTaskEmployeeForReport
Print 'Create View VueAccountProjectTaskEmployeeForReport'
GO
If not exists (select * from information_schema.tables where table_name = 'VueAccountProjectTaskEmployeeForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.VueAccountProjectTaskEmployeeForReport
AS
SELECT     dbo.AccountProjectTaskEmployee.AccountProjectTaskEmployeeId, dbo.AccountProjectTask.AccountProjectId, dbo.AccountProjectTask.AccountProjectTaskId, 
                      dbo.AccountProjectTask.TaskName, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, dbo.AccountEmployee.AccountEmployeeId, dbo.AccountProject.AccountId, 
                      dbo.AccountProject.ProjectCode, dbo.AccountProjectTask.TaskStatusId, dbo.AccountProjectTask.Completed, dbo.AccountProject.ProjectName, 
                      dbo.AccountBillingRate.BillingRate, dbo.AccountParty.PartyName, dbo.AccountProject.AccountClientId, dbo.AccountBillingRate.StartDate, 
                      dbo.AccountBillingRate.EndDate, dbo.AccountBillingRate.EmployeeRate, dbo.AccountProjectTask.TaskDescription, dbo.AccountProjectTask.Duration, 
                      dbo.AccountProjectTask.DurationUnit, dbo.AccountProjectTask.DeadlineDate, dbo.AccountProjectTask.EstimatedCost, dbo.AccountProjectTask.EstimatedTimeSpent, 
                      dbo.AccountProjectTask.EstimatedTimeSpentUnit, dbo.AccountProjectTask.TaskCode
FROM         dbo.AccountProjectTaskEmployee RIGHT OUTER JOIN
                      dbo.AccountBillingRate RIGHT OUTER JOIN
                      dbo.AccountProjectTask ON dbo.AccountBillingRate.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId ON 
                      dbo.AccountProjectTaskEmployee.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId LEFT OUTER JOIN
                      dbo.AccountEmployee ON dbo.AccountProjectTaskEmployee.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountParty INNER JOIN
                      dbo.AccountProject ON dbo.AccountParty.AccountPartyId = dbo.AccountProject.AccountClientId ON 
                      dbo.AccountProjectTask.AccountProjectId = dbo.AccountProject.AccountProjectId'

GO

-- Create View vueAccountProjectTeamForReport
Print 'Create View vueAccountProjectTeamForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountProjectTeamForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountProjectTeamForReport
AS
SELECT     dbo.AccountProjectEmployee.AccountProjectEmployeeId, dbo.AccountProjectEmployee.AccountId, dbo.AccountProjectEmployee.AccountProjectId, 
                      dbo.AccountProjectEmployee.AccountEmployeeId, dbo.AccountProjectEmployee.TaskCompletedPercentage, dbo.AccountProjectEmployee.TaskCompleted, 
                      dbo.AccountProjectEmployee.AccountRoleId, dbo.AccountProjectEmployee.AccountBillingRateId, dbo.AccountProjectEmployee.AccountProjectEmployeeTemplateId, 
                      dbo.AccountProject.ProjectName, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, dbo.AccountLocation.AccountLocation, dbo.AccountDepartment.DepartmentName, 
                      dbo.AccountParty.PartyName, dbo.AccountProjectType.ProjectType, dbo.AccountProject.ProjectDescription, dbo.AccountProject.Deadline, 
                      dbo.AccountProject.ProjectCode, dbo.AccountBillingRate.BillingRate, dbo.AccountBillingRate.StartDate, dbo.AccountBillingRate.EndDate, 
                      dbo.AccountProject.EstimatedTime, dbo.AccountProject.EstimatedDuration, dbo.AccountProject.EstimatedDurationUnit, dbo.AccountBillingRate.EmployeeRate, 
                      dbo.AccountDepartment.DepartmentCode, dbo.AccountProject.AccountClientId
FROM         dbo.AccountProjectEmployee INNER JOIN
                      dbo.AccountProject ON dbo.AccountProjectEmployee.AccountProjectId = dbo.AccountProject.AccountProjectId INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountProjectEmployee.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId INNER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId INNER JOIN
                      dbo.AccountProjectType ON dbo.AccountProject.AccountProjectTypeId = dbo.AccountProjectType.AccountProjectTypeId LEFT OUTER JOIN
                      dbo.AccountBillingRate ON dbo.AccountProjectEmployee.AccountId = dbo.AccountBillingRate.AccountId AND 
                      dbo.AccountProjectEmployee.AccountBillingRateId = dbo.AccountBillingRate.AccountBillingRateId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId'

GO
-- Create View rptvueAccountProjectTaskEmployee
Print 'Create View rptvueAccountProjectTaskEmployee'
GO
If not exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectTaskEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountProjectTaskEmployee
AS
SELECT     AccountProjectTaskEmployeeId, AccountProjectId, AccountProjectTaskId, TaskName, AccountEmployeeId, AccountId, ProjectCode, TaskStatusId, Completed, 
                      ProjectName, BillingRate, EmployeeName, ISNULL(PartyName, N''0'') AS ClientName, AccountClientId, StartDate, EndDate, EmployeeRate, TaskDescription, Duration, 
                      DurationUnit, DeadlineDate, EstimatedCost, EstimatedTimeSpent, EstimatedTimeSpentUnit, TaskCode
FROM         dbo.VueAccountProjectTaskEmployeeForReport'

GO
-- Create View rptvueAccountProjectTeam
Print 'Create View rptvueAccountProjectTeam'
GO
If not exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectTeam' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountProjectTeam
AS
SELECT     AccountProjectEmployeeId, AccountId, AccountProjectId, AccountEmployeeId, TaskCompletedPercentage, TaskCompleted, AccountRoleId, AccountBillingRateId, 
                      AccountProjectEmployeeTemplateId, ISNULL(PartyName, N''0'') AS ClientName, EmployeeName, AccountLocation, DepartmentName, ProjectType, ProjectDescription, 
                      ProjectCode, Deadline, ProjectName, BillingRate, StartDate, EndDate, EstimatedTime, EstimatedDuration, EstimatedDurationUnit, EmployeeRate, DepartmentCode, 
                      AccountClientId
FROM         dbo.vueAccountProjectTeamForReport
GROUP BY AccountProjectEmployeeId, AccountId, AccountProjectId, AccountEmployeeId, TaskCompletedPercentage, TaskCompleted, AccountRoleId, AccountBillingRateId, 
                      AccountProjectEmployeeTemplateId, ProjectName, EmployeeName, AccountLocation, DepartmentName, ProjectType, ProjectDescription, ProjectCode, Deadline, 
                      ISNULL(PartyName, N''0''), BillingRate, StartDate, EndDate, EstimatedTime, EstimatedDuration, EstimatedDurationUnit, EmployeeRate, DepartmentCode, 
                      AccountClientId'


GO
IF NOT Exists(Select * From [dbo].[AccountReport] WHERE [AccountReportId]='eb0e7c81-2afd-490e-b2ab-bb44b5757416')
BEGIN
-- =======================================================
-- Foreign Key Constraint Nochecks's for Table: [dbo].[AccountReportDataSourceMapping]
-- =======================================================
Print ' Foreign Key Constraint Nochecks''s for Table: [dbo].[AccountReportDataSourceMapping]'

ALTER TABLE [dbo].[AccountReportDataSourceMapping] NOCHECK CONSTRAINT [FK_AccountReportDataSourceMapping_AccountReport]

-- =======================================================
-- Foreign Key Constraint Nochecks's for Table: [dbo].[AccountReportColumn]
-- =======================================================
Print ' Foreign Key Constraint Nochecks''s for Table: [dbo].[AccountReportColumn]'

ALTER TABLE [dbo].[AccountReportColumn] NOCHECK CONSTRAINT [FK_AccountReportColumn_AccountReport]

-- =======================================================
-- Synchronization Script for Table: [dbo].[AccountReport]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[AccountReport]'

INSERT INTO [dbo].[AccountReport] ([AccountReportId], [AccountReportCategoryId], [ReportName], [ReportDescription], [ReportIconPath], [AccountId], [SystemReportTypeId], [SystemReportId], [IsConsolidated], [ReportPageName], [ReportOrder], [ShowCompanyLogo], [ReportTitle], [ReportHeader], [ReportFooter]) VALUES ('eb0e7c81-2afd-490e-b2ab-bb44b5757416', 'ad7a0bca-b6e0-44e7-bdd2-3b1e9e7fa0d9', N'Project Team Report', N'Project Team Report', '/Images/AttendanceDetailReport.gif', NULL, NULL, NULL, 0, NULL, 7, 0, N'Project Team Report', NULL, NULL)
INSERT INTO [dbo].[AccountReport] ([AccountReportId], [AccountReportCategoryId], [ReportName], [ReportDescription], [ReportIconPath], [AccountId], [SystemReportTypeId], [SystemReportId], [IsConsolidated], [ReportPageName], [ReportOrder], [ShowCompanyLogo], [ReportTitle], [ReportHeader], [ReportFooter]) VALUES ('ea1e4889-0be2-41c6-a751-31ead8263ad6', 'ad7a0bca-b6e0-44e7-bdd2-3b1e9e7fa0d9', N'Project Task Employee', N'Project Task Employee', NULL, NULL, NULL, NULL, 0, NULL, NULL, 0, NULL, NULL, NULL)

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSource]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSource]'

INSERT INTO [dbo].[SystemReportDataSource] ([SystemReportDataSourceId], [ReportDataSourceName], [ReportDatasource], [ReportDataSourceType], [DefaultIconPath], [SystemFeatureId]) VALUES ('cde33c76-7289-4206-9822-b47690c8f314', N'Project Team', N'rptvueAccountProjectTeam', N'View', N'/Images/ProjectReport.gif', NULL)
INSERT INTO [dbo].[SystemReportDataSource] ([SystemReportDataSourceId], [ReportDataSourceName], [ReportDatasource], [ReportDataSourceType], [DefaultIconPath], [SystemFeatureId]) VALUES ('c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'Project Task', N'rptvueAccountProjectTaskEmployee', N'View', N'/Images/ExpenseSheetAuditTrailReport.gif', NULL)

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'

INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('ad428809-2562-4cb6-a0eb-defae0c2539b', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'EmployeeName', 200, 1, NULL, NULL, 2, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Employee Name', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('47ade22d-b706-4a40-b4fe-ceb3232fb168', 'cde33c76-7289-4206-9822-b47690c8f314', N'ProjectCode', 125, 1, NULL, NULL, 9, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Project Code', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('f0d0ee4b-6a01-4022-b23c-953a43f8c533', 'cde33c76-7289-4206-9822-b47690c8f314', N'ProjectName', 200, 1, NULL, NULL, 2, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Project Name', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('7409d450-efab-473b-854c-84bc920b2201', 'cde33c76-7289-4206-9822-b47690c8f314', N'ProjectDescription', 200, 0, NULL, NULL, 7, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Project Description', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('8686ce6b-09b9-4f16-8796-a2099cc529c9', 'cde33c76-7289-4206-9822-b47690c8f314', N'Deadline', 100, 0, NULL, NULL, 8, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Deadline', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('e904a47e-cb52-4434-818b-1e1b90206707', 'cde33c76-7289-4206-9822-b47690c8f314', N'DepartmentName', 125, 0, NULL, NULL, 5, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Department Name', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('2fdc6c8d-e82c-4604-afc0-c65349742f4d', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'ProjectName', 200, 1, NULL, NULL, 3, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Project Name', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('9b673590-6871-4536-9e2a-1eb9f7f44e3b', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'TaskName', 200, 1, NULL, NULL, 4, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Task Name', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('4dc976c4-30b7-41ba-8de9-d7c8369b5a44', 'cde33c76-7289-4206-9822-b47690c8f314', N'EmployeeName', 200, 1, NULL, NULL, 1, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Employee Name', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('8a2f2ae1-fdd4-437c-a9e4-a311446a71ae', 'cde33c76-7289-4206-9822-b47690c8f314', N'ProjectType', 125, 0, NULL, NULL, 6, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Project Type', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('72435aec-8ff6-455d-919f-39f3543f1b5d', 'cde33c76-7289-4206-9822-b47690c8f314', N'AccountLocation', 125, 0, NULL, NULL, 4, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Location', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('932d07f8-ef51-4212-9293-566b512bdcd3', 'cde33c76-7289-4206-9822-b47690c8f314', N'ClientName', 150, 1, NULL, NULL, 3, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Client Name', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('edfacf04-6a52-4de2-8c31-d45d2d89bbe2', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'ClientName', 200, 1, NULL, NULL, 1, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Client Name', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('c2e54305-d08d-4023-ba79-902208c16d00', 'cde33c76-7289-4206-9822-b47690c8f314', N'FormulaField5', 150, 0, NULL, NULL, 50, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Formula Field 5', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('86818f14-1dca-4019-9039-e34f6fa3999b', 'cde33c76-7289-4206-9822-b47690c8f314', N'FormulaField1', 150, 0, NULL, NULL, 46, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Formula Field 1', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('10d35427-ac80-4a5f-bdd8-36e92f7add3c', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'FormulaField5', 125, 0, NULL, NULL, 50, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Formula Field 5', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('d26a7335-ee43-4a34-b155-eaa1f86059a3', 'cde33c76-7289-4206-9822-b47690c8f314', N'BillingRate', 125, 0, N'BillingRateCurrencyCode', NULL, 10, '0da31ddc-9040-46fa-a33a-74e06a645050', N'Billing Rate', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('10eaf036-16c5-441e-9cc4-7c1d4e1025c6', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'FormulaField3', 125, 0, NULL, NULL, 48, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Formula Field 3', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('5f47e253-ef95-47da-98b3-bfccb04263f5', 'cde33c76-7289-4206-9822-b47690c8f314', N'EstimatedTime', 125, 0, NULL, NULL, 14, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Estimated Time', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('a87d646e-8701-4287-8dc9-13ffcc28bfe4', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'FormulaField4', 125, 0, NULL, NULL, 49, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Formula Field 4', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('5a389b86-d029-43ea-bd23-9fcdfb1de0ba', 'cde33c76-7289-4206-9822-b47690c8f314', N'StartDate', 125, 0, NULL, NULL, 11, '48b9ef68-b4f6-4c75-b8de-c547939179ce', N'Start Date', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('9ee9cc92-ee40-4278-98fc-94d20eff9bfb', 'cde33c76-7289-4206-9822-b47690c8f314', N'EstimatedDurationUnit', 125, 0, NULL, NULL, 16, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Estimated Duration Unit', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('3090eb9b-e8f7-4ea9-9a8f-eb4d77d87b0a', 'cde33c76-7289-4206-9822-b47690c8f314', N'DepartmentCode', 125, 0, NULL, NULL, 17, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Department Code', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('133592b9-397a-4c94-a9bb-4979d54248e7', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'FormulaField2', 125, 0, NULL, NULL, 47, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Formula Field 2', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('fb67e3bd-2922-4813-b00a-067bb00ba5e6', 'cde33c76-7289-4206-9822-b47690c8f314', N'EstimatedDuration', 125, 0, NULL, NULL, 15, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Estimated Duration', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('442d9dcc-7b14-48ec-84a0-4f003813f4b9', 'cde33c76-7289-4206-9822-b47690c8f314', N'FormulaField2', 150, 0, NULL, NULL, 47, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Formula Field 2', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('cfa8dcda-19b5-40e0-8d3e-5b2e23649254', 'cde33c76-7289-4206-9822-b47690c8f314', N'FormulaField4', 150, 0, NULL, NULL, 49, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Formula Field 4', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('e74e35dd-f48c-4863-9b59-0a050f8ba6a5', 'cde33c76-7289-4206-9822-b47690c8f314', N'FormulaField3', 150, 0, NULL, NULL, 48, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Formula Field 3', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('2f24c6e4-959a-4008-81ef-6033f2baa307', 'cde33c76-7289-4206-9822-b47690c8f314', N'EmployeeRate', 125, 0, N'EmployeeRateCurrencyCode', NULL, 13, '0da31ddc-9040-46fa-a33a-74e06a645050', N'Employee Rate', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('15dae2ed-49df-4733-8ba4-414957588473', 'cde33c76-7289-4206-9822-b47690c8f314', N'EndDate', 125, 0, NULL, NULL, 12, '48b9ef68-b4f6-4c75-b8de-c547939179ce', N'End Date', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('59f4f0f5-3bbc-4e58-92c3-4afe3a7f533f', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'FormulaField1', 125, 0, NULL, NULL, 46, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Formula Field 1', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('1003aa0d-4273-4f13-9c83-e3be5ac45db6', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'TaskCode', 110, 0, NULL, NULL, 14, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Task Code', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('43c6d616-8463-450b-9217-5c16b934ca62', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'TaskDescription', 125, 0, NULL, NULL, 11, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Task Description', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('dad1c13a-9634-4f75-9f3a-0aea26feb010', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'Completed', 110, 0, NULL, NULL, 6, 'b2cb6685-3a4b-4cf9-a15a-d01a63031e2b', N'Completed', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('41716c57-654d-4a04-b0ac-f69b34fbe884', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'BillingRate', 110, 0, N'BillingRateCurrencyCode', NULL, 7, '0da31ddc-9040-46fa-a33a-74e06a645050', N'Billing Rate', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('cb1ae05d-92ea-42bf-8257-0c452142d7cc', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'EndDate', 110, 0, NULL, NULL, 9, '48b9ef68-b4f6-4c75-b8de-c547939179ce', N'End Date', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('af42888f-d578-46d0-ae30-ba85827ed69b', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'ProjectCode', 110, 0, NULL, NULL, 5, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Project Code', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('fa6a888f-8ead-4406-b0d8-5f6724b74a86', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'StartDate', 110, 0, NULL, NULL, 8, '48b9ef68-b4f6-4c75-b8de-c547939179ce', N'Start Date', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('95a16f9b-439b-4833-968e-fdc536382681', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'EstimatedCost', 125, 0, N'EstimatedCurrencyCode', NULL, 15, '0da31ddc-9040-46fa-a33a-74e06a645050', N'Estimated Cost', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('bed98ea6-4d0b-4e69-9a8b-c85d6514dbaf', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'Duration', 110, 0, NULL, NULL, 12, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Duration', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('f0d1bda7-fe72-4677-b10a-c1d55594ff9a', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'EmployeeRate', 110, 0, N'EmployeeRateCurrencyCode', NULL, 10, '0da31ddc-9040-46fa-a33a-74e06a645050', N'Employee Rate', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('1d34a3b2-d5f3-48b1-8ff8-20362c813e00', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'DurationUnit', 125, 0, NULL, NULL, 13, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Duration Unit', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('bce246dc-68f1-44b2-b4a5-3b4e93b4516b', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'DeadlineDate', 125, 0, NULL, NULL, 13, '48b9ef68-b4f6-4c75-b8de-c547939179ce', N'Deadline Date', 0, 0)


-- =======================================================
-- Synchronization Script for Table: [dbo].[AccountReportColumn]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[AccountReportColumn]'

INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('0476f704-0ba3-41bc-aaae-fb155d32fe2a', 'eb0e7c81-2afd-490e-b2ab-bb44b5757416', N'Project Code', '47ade22d-b706-4a40-b4fe-ceb3232fb168', 3, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('6f5f8f08-83e4-44ca-8fa5-053efaf0d1d7', 'e40212f3-8270-4fea-b432-e0ca8248a960', N'Project Name', 'f0d0ee4b-6a01-4022-b23c-953a43f8c533', 2, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('56893f0a-aae6-4257-83cb-9bd6235c1b31', 'eb0e7c81-2afd-490e-b2ab-bb44b5757416', N'Project Name', 'f0d0ee4b-6a01-4022-b23c-953a43f8c533', 4, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('66163d41-d363-401f-8eeb-1654845a8d5a', 'ea1e4889-0be2-41c6-a751-31ead8263ad6', N'Employee Name', 'ad428809-2562-4cb6-a0eb-defae0c2539b', 2, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('eba44a46-e80d-493d-b15e-c31be9e65b04', 'ea1e4889-0be2-41c6-a751-31ead8263ad6', N'Project Name', '2fdc6c8d-e82c-4604-afc0-c65349742f4d', 3, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('49096350-e189-44b1-9749-4244618a628f', 'eb0e7c81-2afd-490e-b2ab-bb44b5757416', N'Client Name', '932d07f8-ef51-4212-9293-566b512bdcd3', 2, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('4cf9cd51-f0c8-461b-96ac-20fd8c0ea475', 'eb0e7c81-2afd-490e-b2ab-bb44b5757416', N'Project Description', '7409d450-efab-473b-854c-84bc920b2201', 5, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('ad0f4652-2cc0-42be-9705-377df7ad6395', '6e5b0c09-6757-4c27-be9a-f5207602a9a0', N'Project Type', '8a2f2ae1-fdd4-437c-a9e4-a311446a71ae', 6, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('0422cc54-42ca-4986-bbd0-a9809b92d53b', '6e5b0c09-6757-4c27-be9a-f5207602a9a0', N'Department Name', 'e904a47e-cb52-4434-818b-1e1b90206707', 5, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('975a4359-5dfb-4be3-9cdb-e4b955a721ef', 'ea1e4889-0be2-41c6-a751-31ead8263ad6', N'Task Name', '9b673590-6871-4536-9e2a-1eb9f7f44e3b', 4, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('0ac94c71-db7f-4107-bb80-1d3d4cc30f52', '6e5b0c09-6757-4c27-be9a-f5207602a9a0', N'Employee Name', '4dc976c4-30b7-41ba-8de9-d7c8369b5a44', 1, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('10934a8a-94b7-48a0-b37d-afe8c946200f', 'eb0e7c81-2afd-490e-b2ab-bb44b5757416', N'Employee Name', '4dc976c4-30b7-41ba-8de9-d7c8369b5a44', 2, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('c64dd693-1bb8-48bf-9c9e-4b99ee9c04da', '6e5b0c09-6757-4c27-be9a-f5207602a9a0', N'Client Name', '932d07f8-ef51-4212-9293-566b512bdcd3', 3, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('99e3e7b4-b649-4f15-85c3-e96fe8a00627', '6e5b0c09-6757-4c27-be9a-f5207602a9a0', N'Project Code', '47ade22d-b706-4a40-b4fe-ceb3232fb168', 9, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('dad9a7c5-3c13-412e-957f-821a8d238c56', 'e40212f3-8270-4fea-b432-e0ca8248a960', N'Employee Name', '4dc976c4-30b7-41ba-8de9-d7c8369b5a44', 1, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('0f4d7bf1-04ca-4e4b-b97d-0aa34c6943d8', '6e5b0c09-6757-4c27-be9a-f5207602a9a0', N'Project Description', '7409d450-efab-473b-854c-84bc920b2201', 7, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('b332cbf1-52c8-4416-b662-c085e9ebdb64', '6e5b0c09-6757-4c27-be9a-f5207602a9a0', N'Project Name', 'f0d0ee4b-6a01-4022-b23c-953a43f8c533', 2, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('e52d48f6-b054-4520-bde1-f657d54cdcc9', '6e5b0c09-6757-4c27-be9a-f5207602a9a0', N'Location', '72435aec-8ff6-455d-919f-39f3543f1b5d', 4, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('747766fa-824a-462a-8584-0e3afd146b17', '6e5b0c09-6757-4c27-be9a-f5207602a9a0', N'Deadline', '8686ce6b-09b9-4f16-8796-a2099cc529c9', 8, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('ed6a5f0a-9b12-4d35-a8ee-eeb4633d94f4', 'ea1e4889-0be2-41c6-a751-31ead8263ad6', N'Client Name', 'edfacf04-6a52-4de2-8c31-d45d2d89bbe2', 1, NULL, NULL)

-- =======================================================
-- Synchronization Script for Table: [dbo].[AccountReportDataSourceMapping]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[AccountReportDataSourceMapping]'

INSERT INTO [dbo].[AccountReportDataSourceMapping] ([AccountReportDataSourceMappingId], [AccountReportId], [SystemReportDataSourceId]) VALUES ('25d3737c-95a4-4420-b2d0-92be13f13384', 'ea1e4889-0be2-41c6-a751-31ead8263ad6', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837')
INSERT INTO [dbo].[AccountReportDataSourceMapping] ([AccountReportDataSourceMappingId], [AccountReportId], [SystemReportDataSourceId]) VALUES ('aa7f42a5-8934-4062-938a-226a6c2d7f1e', 'eb0e7c81-2afd-490e-b2ab-bb44b5757416', 'cde33c76-7289-4206-9822-b47690c8f314')


-- =======================================================
-- Foreign Key Constraint Check's for Table: [dbo].[AccountReportColumn]
-- =======================================================
Print ' Foreign Key Constraint Check''s for Table: [dbo].[AccountReportColumn]'

ALTER TABLE [dbo].[AccountReportColumn] CHECK CONSTRAINT [FK_AccountReportColumn_AccountReport]

-- =======================================================
-- Foreign Key Constraint Check's for Table: [dbo].[AccountReportDataSourceMapping]
-- =======================================================
Print ' Foreign Key Constraint Check''s for Table: [dbo].[AccountReportDataSourceMapping]'

ALTER TABLE [dbo].[AccountReportDataSourceMapping] CHECK CONSTRAINT [FK_AccountReportDataSourceMapping_AccountReport]


-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportFilterSourceMapping]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportFilterSourceMapping]'

INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('5b285e46-6b5b-4680-a34b-89c43e6e1516', '8f7f0cc7-e5e4-4f40-924a-60a126092cc0', 'cde33c76-7289-4206-9822-b47690c8f314', 1, 1, 3)
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('69fa325e-2a86-442b-a290-3d49afc2c368', '8f7f0cc7-e5e4-4f40-924a-60a126092cc0', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', 1, 1, 3)
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('81319013-adfb-48e1-824c-9a8b4c6fcaca', '4f471b5b-2394-4379-a666-d696e2dfb0ef', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', 1, 1, 1)
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('37972872-4b12-4a21-94b8-fb2881d7dc2b', '4f471b5b-2394-4379-a666-d696e2dfb0ef', 'cde33c76-7289-4206-9822-b47690c8f314', 1, 1, 1)
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('e379b09a-f1d6-4aab-af4a-bbae9eea1254', 'eb57d46c-68fe-44ef-8663-4b1feed94372', 'cde33c76-7289-4206-9822-b47690c8f314', 1, 1, 2)
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('cda386ab-d1b3-4b9c-aaba-bcce3e0c31ba', 'eb57d46c-68fe-44ef-8663-4b1feed94372', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', 1, 1, 2)

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportPermission]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportPermission]'

INSERT INTO [dbo].[SystemReportPermission] ([SystemReportPermissionId], [AccountReportId], [MasterAccountRoleId], [ShowReport], [AllowCustomization], [AllowAllUser], [AllowOwnReport], [AllowOwnTeam], [AllowOwnProject], [AllowOwnSubOrdinates], [AllowOwnApproval]) VALUES ('d8fafe61-ec0f-4151-9b8b-b89e98668039', 'ea1e4889-0be2-41c6-a751-31ead8263ad6', 100, 1, NULL, NULL, NULL, 1, NULL, NULL, NULL)
INSERT INTO [dbo].[SystemReportPermission] ([SystemReportPermissionId], [AccountReportId], [MasterAccountRoleId], [ShowReport], [AllowCustomization], [AllowAllUser], [AllowOwnReport], [AllowOwnTeam], [AllowOwnProject], [AllowOwnSubOrdinates], [AllowOwnApproval]) VALUES ('26fef786-68f8-4854-be2c-2a4be2c57e85', 'ea1e4889-0be2-41c6-a751-31ead8263ad6', 101, 1, NULL, NULL, NULL, NULL, 1, NULL, NULL)
INSERT INTO [dbo].[SystemReportPermission] ([SystemReportPermissionId], [AccountReportId], [MasterAccountRoleId], [ShowReport], [AllowCustomization], [AllowAllUser], [AllowOwnReport], [AllowOwnTeam], [AllowOwnProject], [AllowOwnSubOrdinates], [AllowOwnApproval]) VALUES ('0aff57b2-1a3a-449f-a73c-33ba8fb2939a', 'eb0e7c81-2afd-490e-b2ab-bb44b5757416', 1, 1, 1, 1, NULL, NULL, NULL, NULL, NULL)
INSERT INTO [dbo].[SystemReportPermission] ([SystemReportPermissionId], [AccountReportId], [MasterAccountRoleId], [ShowReport], [AllowCustomization], [AllowAllUser], [AllowOwnReport], [AllowOwnTeam], [AllowOwnProject], [AllowOwnSubOrdinates], [AllowOwnApproval]) VALUES ('d56f8ab7-7102-456b-acb6-a005e5202510', 'eb0e7c81-2afd-490e-b2ab-bb44b5757416', 101, 1, NULL, NULL, NULL, NULL, 1, NULL, NULL)
INSERT INTO [dbo].[SystemReportPermission] ([SystemReportPermissionId], [AccountReportId], [MasterAccountRoleId], [ShowReport], [AllowCustomization], [AllowAllUser], [AllowOwnReport], [AllowOwnTeam], [AllowOwnProject], [AllowOwnSubOrdinates], [AllowOwnApproval]) VALUES ('13e864c5-dfa5-493c-b5ea-96658eab2055', 'eb0e7c81-2afd-490e-b2ab-bb44b5757416', 100, 1, NULL, NULL, NULL, 1, NULL, NULL, NULL)
INSERT INTO [dbo].[SystemReportPermission] ([SystemReportPermissionId], [AccountReportId], [MasterAccountRoleId], [ShowReport], [AllowCustomization], [AllowAllUser], [AllowOwnReport], [AllowOwnTeam], [AllowOwnProject], [AllowOwnSubOrdinates], [AllowOwnApproval]) VALUES ('83a846f3-4484-45b4-a691-fbe8c5369e8a', 'ea1e4889-0be2-41c6-a751-31ead8263ad6', 1, 1, 1, 1, NULL, NULL, NULL, NULL, NULL)

END


GO

-- Drop View vueAccountEmployeeTimeEntryForQB
Print 'Drop View vueAccountEmployeeTimeEntryForQB'
GO
If exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryForQB' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryForQB]

GO
-- Create View vueAccountEmployeeTimeEntryForQB
Print 'Create View vueAccountEmployeeTimeEntryForQB'
GO
If not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryForQB' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryForQB
AS
SELECT     dbo.AccountEmployeeTimeEntry.TimeEntryDate, dbo.AccountEmployeeTimeEntry.TotalTime, dbo.AccountEmployeeTimeEntry.Description, 
                      dbo.AccountProject.ProjectName, dbo.AccountProject.ProjectDescription, dbo.AccountProject.ProjectCode, dbo.AccountProject.IsDisabled, 
                      dbo.AccountProject.IsTemplate, dbo.AccountProject.IsProject, dbo.AccountProject.IsDeleted, dbo.AccountProjectTask.TaskName, 
                      dbo.AccountProjectTask.TaskDescription, dbo.AccountProjectTask.IsParentTask, dbo.AccountProjectTask.IsBillable, dbo.AccountProjectTask.TaskCode, 
                      LEFT(dbo.AccountParty.PartyName, 41) AS PartyName, dbo.AccountParty.PartyNick, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountEmployee.AccountId, 
                      dbo.AccountEmployee.EmployeeCode, dbo.AccountProjectMilestone.MilestoneDescription, dbo.AccountEmployee.AccountEmployeeId
FROM         dbo.AccountEmployeeTimeEntry INNER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId INNER JOIN
                      dbo.AccountProjectTask ON dbo.AccountEmployeeTimeEntry.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId AND 
                      dbo.AccountProject.AccountProjectId = dbo.AccountProjectTask.AccountProjectId INNER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeEntry.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId INNER JOIN
                      dbo.AccountProjectMilestone ON dbo.AccountProject.AccountProjectId = dbo.AccountProjectMilestone.AccountProjectId AND 
                      dbo.AccountProjectTask.AccountProjectMilestoneId = dbo.AccountProjectMilestone.AccountProjectMilestoneId'

GO
-- Drop View rptvueAccountProjectTaskEmployee
Print 'Drop View rptvueAccountProjectTaskEmployee'
GO
If exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectTaskEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountProjectTaskEmployee]

GO
-- Drop View rptvueAccountProjectTeam
Print 'Drop View rptvueAccountProjectTeam'
GO
If exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectTeam' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountProjectTeam]

GO
-- Drop View VueAccountProjectTaskEmployeeForReport
Print 'Drop View VueAccountProjectTaskEmployeeForReport'
GO
If exists (select * from information_schema.tables where table_name = 'VueAccountProjectTaskEmployeeForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[VueAccountProjectTaskEmployeeForReport]

GO
-- Drop View vueAccountProjectTeamForReport
Print 'Drop View vueAccountProjectTeamForReport'
GO
If exists (select * from information_schema.tables where table_name = 'vueAccountProjectTeamForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountProjectTeamForReport]


GO
-- Create View VueAccountProjectTaskEmployeeForReport
Print 'Create View VueAccountProjectTaskEmployeeForReport'
GO
If not exists (select * from information_schema.tables where table_name = 'VueAccountProjectTaskEmployeeForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.VueAccountProjectTaskEmployeeForReport
AS
SELECT     dbo.AccountProjectTaskEmployee.AccountProjectTaskEmployeeId, dbo.AccountProjectTaskEmployee.AccountId, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, dbo.AccountProjectTaskEmployee.AccountProjectTaskId, 
                      dbo.AccountProjectTaskEmployee.AccountEmployeeId, dbo.AccountProjectTask.AccountProjectId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, 
                      dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountEmployee.AccountTimeOffPolicyId, dbo.AccountEmployee.TimeOffApprovalTypeId, 
                      dbo.AccountEmployee.AccountHolidayTypeId, dbo.AccountParty.PartyName AS ClientName, dbo.AccountProjectTask.TaskName, 
                      dbo.AccountProjectTask.TaskDescription, dbo.AccountProjectTask.Duration AS TaskDuration, dbo.AccountProjectTask.DurationUnit AS TaskDurationUnit, 
                      dbo.AccountProjectTask.DeadlineDate AS TaskDeadlineDate, dbo.AccountProjectTask.Completed AS TaskCompleted, dbo.AccountProjectTask.IsParentTask, 
                      dbo.AccountProjectTask.IsForAllEmployees, dbo.AccountProjectTask.EstimatedCost AS TaskEmployeeCost, 
                      dbo.AccountProjectTask.EstimatedTimeSpent AS TaskEstimatedTimeSpent, dbo.AccountProjectTask.EstimatedTimeSpentUnit AS TaskEstimatedTimeSpentUnit, 
                      dbo.AccountProjectTask.TaskCode, dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.State, dbo.AccountEmployee.City, dbo.AccountEmployee.Zip, dbo.AccountEmployee.HomePhoneNo, dbo.AccountEmployee.WorkPhoneNo, 
                      dbo.AccountEmployee.MobilePhoneNo, dbo.AccountEmployee.BillingRateStateDate, dbo.AccountEmployee.TerminationDate, dbo.AccountEmployee.EmployeeCode, 
                      dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.HiredDate, dbo.AccountEmployeeType.AccountEmployeeType, 
                      dbo.AccountWorkingDayType.AccountWorkingDayType, dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, dbo.AccountWorkingDayType.MinimumHoursPerWeek, 
                      dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountTimeOffPolicy.AccountTimeOffPolicy, dbo.AccountProject.ProjectName, 
                      dbo.AccountProject.ProjectDescription, dbo.AccountProject.StartDate AS ProjectStartDate, dbo.AccountProject.Deadline AS ProjectDeadlineDate, 
                      dbo.AccountProject.EstimatedTime AS ProjectEstimatedTime, dbo.AccountProject.EstimatedDuration AS ProjectEstimatedDuration, 
                      dbo.AccountProject.EstimatedDurationUnit AS ProjectEstimatedDurationUnit, dbo.AccountProject.ProjectCode, dbo.AccountProject.Completed AS ProjectCompleted, 
                      dbo.AccountStatus.Status AS TaskStatus, dbo.AccountPriority.Priority, dbo.AccountProjectTask.AccountPriorityId, dbo.AccountProjectTask.TaskStatusId, 
                      dbo.AccountProjectTask.AccountTaskTypeId, dbo.AccountTaskType.TaskType, dbo.AccountBillingRate.BillingRate, 
                      dbo.AccountBillingRate.StartDate AS BillingRateStartDate, dbo.AccountBillingRate.EndDate AS BillingRateEndDate, dbo.AccountBillingRate.EmployeeRate
FROM         dbo.AccountBillingRate INNER JOIN
                      dbo.AccountTaskType INNER JOIN
                      dbo.AccountProjectTaskEmployee INNER JOIN
                      dbo.AccountParty INNER JOIN
                      dbo.AccountProject ON dbo.AccountParty.AccountPartyId = dbo.AccountProject.AccountClientId INNER JOIN
                      dbo.AccountStatus INNER JOIN
                      dbo.AccountProjectTask ON dbo.AccountStatus.AccountStatusId = dbo.AccountProjectTask.TaskStatusId INNER JOIN
                      dbo.AccountPriority ON dbo.AccountProjectTask.AccountPriorityId = dbo.AccountPriority.AccountPriorityId ON 
                      dbo.AccountProject.AccountProjectId = dbo.AccountProjectTask.AccountProjectId ON 
                      dbo.AccountProjectTaskEmployee.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountProjectTaskEmployee.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId ON 
                      dbo.AccountTaskType.AccountTaskTypeId = dbo.AccountProjectTask.AccountTaskTypeId ON 
                      dbo.AccountBillingRate.AccountBillingRateId = dbo.AccountProjectTask.AccountBillingRateId LEFT OUTER JOIN
                      dbo.AccountEmployeeType ON dbo.AccountEmployee.EmployeePayTypeId = dbo.AccountEmployeeType.AccountEmployeeTypeId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountWorkingDayType ON dbo.AccountEmployee.AccountWorkingDayTypeId = dbo.AccountWorkingDayType.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountTimeOffPolicy ON dbo.AccountEmployee.AccountTimeOffPolicyId = dbo.AccountTimeOffPolicy.AccountTimeOffPolicyId'

GO
-- Create View vueAccountProjectTeamForReport
Print 'Create View vueAccountProjectTeamForReport'
GO
If not exists (select * from information_schema.tables where table_name = 'vueAccountProjectTeamForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountProjectTeamForReport
AS
SELECT     dbo.AccountProjectEmployee.AccountProjectEmployeeId, dbo.AccountProjectEmployee.AccountId, dbo.AccountProjectEmployee.AccountProjectId, 
                      dbo.AccountProjectEmployee.AccountEmployeeId, dbo.AccountProjectEmployee.AccountRoleId, dbo.AccountProjectEmployee.AccountBillingRateId, 
                      dbo.AccountProjectEmployee.AccountProjectEmployeeTemplateId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, 
                      dbo.AccountProject.AccountClientId, dbo.AccountProject.ProjectName, dbo.AccountBillingType.BillingType AS ProjectBillingType, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountLocation.AccountLocation, dbo.AccountRole.Role, dbo.AccountEmployeeType.AccountEmployeeType, 
                      dbo.AccountParty.PartyName AS ClientName, dbo.AccountStatus.Status AS ProjectStatus, AccountStatus_1.Status AS EmployeeStatus, 
                      dbo.AccountWorkingDayType.AccountWorkingDayType, dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.MinimumHoursPerDay, 
                      dbo.AccountWorkingDayType.MaximumHoursPerDay, dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, 
                      dbo.AccountTimeOffPolicy.AccountTimeOffPolicy, AccountApprovalType_1.ApprovalTypeName AS TimeOffApprovalTypeName, 
                      dbo.AccountHolidayType.AccountHolidayType, AccountApprovalType_2.ApprovalTypeName AS ExpenseApprovalTypeName, 
                      dbo.AccountApprovalType.ApprovalTypeName AS TimesheetApprovalTypeName, dbo.AccountPartyContact.FirstName AS ClientContactFirstName, 
                      dbo.AccountPartyContact.LastName AS ClientContactLastName, dbo.AccountPartyDepartment.PartyDepartmentCode AS ClientDepartmentCode, 
                      dbo.AccountPartyDepartment.PartyDepartmentName AS ClientDepartmentName, dbo.AccountPartyDepartment.PartyDepartmentLocation AS ClientDepartmentLocation, 
                      dbo.AccountProject.ProjectStatusId, dbo.AccountProjectType.ProjectType, dbo.AccountProject.AccountProjectTypeId, dbo.AccountProject.ProjectDescription, 
                      dbo.AccountProject.StartDate AS ProjectStartDate, dbo.AccountProject.Deadline, dbo.AccountProject.EstimatedTime, dbo.AccountProject.EstimatedDuration, 
                      dbo.AccountProject.EstimatedDurationUnit, dbo.AccountProject.ProjectCode, dbo.AccountProject.DefaultBillingRate AS ProjectBillingRate, 
                      dbo.AccountProject.Completed, dbo.AccountProject.IsDisabled AS IsDisabledProject, dbo.AccountProject.IsDeleted AS IsDeletedProject, 
                      dbo.AccountParty.PartyNick AS ClientNick, dbo.AccountParty.EMailAddress AS ClientEMailAddress, dbo.AccountParty.Address1 AS ClientAddress1, 
                      dbo.AccountParty.Address2 AS ClientAddress2, dbo.AccountParty.State AS ClientState, dbo.AccountParty.City AS ClientCity, 
                      dbo.AccountParty.ZipCode AS ClientZipCode, dbo.AccountParty.Telephone1 AS ClientTelephone1, dbo.AccountParty.Telephone2 AS ClientTelephone2, 
                      dbo.AccountParty.Fax AS ClientFax, dbo.AccountEmployee.State AS EmployeeState, dbo.AccountEmployee.City AS EmployeeCity, 
                      dbo.AccountEmployee.Zip AS EmployeeZip, dbo.AccountEmployee.WorkPhoneNo AS EmployeeWorkPhoneNo, dbo.AccountEmployee.TerminationDate, 
                      dbo.AccountEmployee.EmployeeCode, dbo.AccountEmployee.HiredDate, dbo.AccountBillingRate.BillingRate, dbo.AccountBillingRate.StartDate AS BillingRateStartDate,
                       dbo.AccountBillingRate.EndDate AS BillingRateEndDate, dbo.AccountBillingRate.EmployeeRate, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName
FROM         dbo.AccountProjectEmployee INNER JOIN
                      dbo.AccountProject ON dbo.AccountProjectEmployee.AccountProjectId = dbo.AccountProject.AccountProjectId INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountProjectEmployee.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId INNER JOIN
                      dbo.AccountBillingType ON dbo.AccountProject.ProjectBillingTypeId = dbo.AccountBillingType.AccountBillingTypeId INNER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId INNER JOIN
                      dbo.AccountStatus ON dbo.AccountProject.ProjectStatusId = dbo.AccountStatus.AccountStatusId INNER JOIN
                      dbo.AccountApprovalType ON dbo.AccountProject.TimeSheetApprovalTypeId = dbo.AccountApprovalType.AccountApprovalTypeId INNER JOIN
                      dbo.AccountApprovalType AS AccountApprovalType_2 ON dbo.AccountProject.ExpenseApprovalTypeId = AccountApprovalType_2.AccountApprovalTypeId INNER JOIN
                      dbo.AccountProjectType ON dbo.AccountProject.AccountProjectTypeId = dbo.AccountProjectType.AccountProjectTypeId LEFT OUTER JOIN
                      dbo.AccountBillingRate ON dbo.AccountProjectEmployee.AccountBillingRateId = dbo.AccountBillingRate.AccountBillingRateId LEFT OUTER JOIN
                      dbo.AccountPartyDepartment ON dbo.AccountProject.AccountPartyDepartmentId = dbo.AccountPartyDepartment.AccountPartyDepartmentId LEFT OUTER JOIN
                      dbo.AccountPartyContact ON dbo.AccountProject.AccountPartyContactId = dbo.AccountPartyContact.AccountPartyContactId LEFT OUTER JOIN
                      dbo.AccountApprovalType AS AccountApprovalType_1 ON 
                      dbo.AccountEmployee.TimeOffApprovalTypeId = AccountApprovalType_1.AccountApprovalTypeId LEFT OUTER JOIN
                      dbo.AccountHolidayType ON dbo.AccountEmployee.AccountHolidayTypeId = dbo.AccountHolidayType.AccountHolidayTypeId LEFT OUTER JOIN
                      dbo.AccountWorkingDayType ON dbo.AccountEmployee.AccountWorkingDayTypeId = dbo.AccountWorkingDayType.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountTimeOffPolicy ON dbo.AccountEmployee.AccountTimeOffPolicyId = dbo.AccountTimeOffPolicy.AccountTimeOffPolicyId LEFT OUTER JOIN
                      dbo.AccountStatus AS AccountStatus_1 ON dbo.AccountEmployee.StatusId = AccountStatus_1.AccountStatusId LEFT OUTER JOIN
                      dbo.AccountEmployeeType ON dbo.AccountEmployee.EmployeePayTypeId = dbo.AccountEmployeeType.AccountEmployeeTypeId LEFT OUTER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId'

GO
-- Create View rptvueAccountProjectTaskEmployee
Print 'Create View rptvueAccountProjectTaskEmployee'
GO
If not exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectTaskEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountProjectTaskEmployee
AS
SELECT     AccountProjectTaskEmployeeId, AccountProjectId, AccountProjectTaskId, TaskName, AccountEmployeeId, AccountId, TaskDescription, TaskCode, DepartmentName, 
                      AccountLocation, AccountEmployeeType, EmployeeCode, IsParentTask, IsForAllEmployees, EmployeeName, ClientName, TaskDuration, TaskDurationUnit, 
                      TaskDeadlineDate, TaskCompleted, TaskEmployeeCost, TaskEstimatedTimeSpent, TaskEstimatedTimeSpentUnit, Role, State, City, Zip, HomePhoneNo, 
                      WorkPhoneNo, MobilePhoneNo, BillingRateStateDate, TerminationDate, JobTitle, HiredDate, AccountWorkingDayType, HoursPerDay, WeekStartDay, 
                      MinimumHoursPerDay, MaximumHoursPerDay, MaximumHoursPerWeek, MinimumHoursPerWeek, AccountTimeOffPolicy, ProjectName, ProjectDescription, 
                      ProjectStartDate, ProjectDeadlineDate, ProjectEstimatedTime, ProjectEstimatedDuration, ProjectEstimatedDurationUnit, ProjectCode, ProjectCompleted, TaskStatus, 
                      Priority, AccountPriorityId, TaskStatusId, AccountTaskTypeId, TaskType, BillingRate, BillingRateStartDate, BillingRateEndDate, EmployeeRate
FROM         dbo.VueAccountProjectTaskEmployeeForReport'

GO
-- Create View rptvueAccountProjectTeam
Print 'Create View rptvueAccountProjectTeam'
GO
If not exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectTeam' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountProjectTeam
AS
SELECT     AccountProjectEmployeeId, AccountId, AccountProjectId, AccountEmployeeId, AccountRoleId, AccountBillingRateId, AccountProjectEmployeeTemplateId, FirstName, 
                      LastName, AccountClientId, ProjectName, ProjectBillingType, DepartmentName, AccountLocation, Role, AccountEmployeeType, ClientName, ProjectStatus, 
                      EmployeeStatus, AccountWorkingDayType, HoursPerDay, MinimumHoursPerDay, MaximumHoursPerDay, MinimumHoursPerWeek, MaximumHoursPerWeek, 
                      AccountTimeOffPolicy, TimeOffApprovalTypeName, AccountHolidayType, ExpenseApprovalTypeName, TimesheetApprovalTypeName, ClientContactFirstName, 
                      ClientContactLastName, ClientDepartmentCode, ClientDepartmentName, ClientDepartmentLocation, ProjectStatusId, ProjectType, AccountProjectTypeId, 
                      ProjectDescription, ProjectStartDate, Deadline, EstimatedTime, EstimatedDuration, EstimatedDurationUnit, ProjectCode, ProjectBillingRate, Completed, 
                      IsDisabledProject, IsDeletedProject, ClientNick, ClientEMailAddress, ClientAddress1, ClientAddress2, ClientState, ClientCity, ClientZipCode, ClientTelephone1, 
                      ClientTelephone2, ClientFax, EmployeeState, EmployeeCity, EmployeeZip, EmployeeWorkPhoneNo, TerminationDate, EmployeeCode, HiredDate, BillingRate, 
                      BillingRateStartDate, BillingRateEndDate, EmployeeRate, EmployeeName
FROM         dbo.vueAccountProjectTeamForReport'

GO
IF NOT Exists(Select * From [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId]='c77a3303-4727-4eed-af35-200bcdff2ecb')
BEGIN

-- =======================================================
-- Foreign Key Constraint Nochecks's for Table: [dbo].[AccountReportGroup]
-- =======================================================
Print ' Foreign Key Constraint Nochecks''s for Table: [dbo].[AccountReportGroup]'

ALTER TABLE [dbo].[AccountReportGroup] NOCHECK CONSTRAINT [FK_AccountReportGroup_AccountReport]

-- =======================================================
-- Foreign Key Constraint Nochecks's for Table: [dbo].[AccountReportColumn]
-- =======================================================
Print ' Foreign Key Constraint Nochecks''s for Table: [dbo].[AccountReportColumn]'

ALTER TABLE [dbo].[AccountReportColumn] NOCHECK CONSTRAINT [FK_AccountReportColumn_AccountReport]

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'

INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('c77a3303-4727-4eed-af35-200bcdff2ecb', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'TaskCode', 100, 0, NULL, NULL, 3, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Task Code', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('87211d13-6b8a-44e4-946e-50afc3321493', 'cde33c76-7289-4206-9822-b47690c8f314', N'TerminationDate', 100, 1, NULL, NULL, 21, '48b9ef68-b4f6-4c75-b8de-c547939179ce', N'Termination Date', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('b4199c24-6cdb-4c7f-868b-fa1be0c841b6', 'cde33c76-7289-4206-9822-b47690c8f314', N'ClientFax', 100, 0, NULL, NULL, 40, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Client Fax', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('2afb8628-605c-4a56-9044-6ff46a086442', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'DepartmentName', 125, 1, NULL, NULL, 4, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Department Name', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('e1e64829-73bd-4824-8571-26f42237f9fa', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'ProjectName', 150, 0, NULL, NULL, 25, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Project Name', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('1f7b732d-3134-410f-90b0-219f675414e5', 'cde33c76-7289-4206-9822-b47690c8f314', N'ProjectEndDate', 110, 0, NULL, NULL, 19, '48b9ef68-b4f6-4c75-b8de-c547939179ce', N'Project End Date', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('4bf26b38-ffc4-4dd1-a4db-4f41693548ab', 'cde33c76-7289-4206-9822-b47690c8f314', N'ClientAddress1', 100, 0, NULL, NULL, 33, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Client Address 1', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('bc7b7339-7d02-4b7c-8589-7c51876fcc03', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'EmployeeName', 150, 1, NULL, NULL, 10, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Employee Name', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('c0c57b3c-48d8-46fa-9214-c822d287a0f8', 'cde33c76-7289-4206-9822-b47690c8f314', N'MaximumHoursPerDay', 125, 0, NULL, NULL, 46, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Maximum Hours Per Day', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('223ffa3d-c3f8-466e-b25e-8b5ea209aed2', 'cde33c76-7289-4206-9822-b47690c8f314', N'ClientZipCode', 75, 0, NULL, NULL, 37, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Client ZipCode', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('751ff140-ded4-4da1-b366-0d6eb07e5c78', 'cde33c76-7289-4206-9822-b47690c8f314', N'AccountWorkingDayType', 125, 1, NULL, NULL, 42, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Working Day Type', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('683d3642-2270-41c7-a13a-7849cf03b378', 'cde33c76-7289-4206-9822-b47690c8f314', N'MinimumHoursPerDay', 125, 0, NULL, NULL, 45, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Minimum Hours Per Day', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('f8a14d42-b1a1-477e-a2ce-ff15668707d4', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'HiredDate', 100, 1, NULL, NULL, 22, '48b9ef68-b4f6-4c75-b8de-c547939179ce', N'Hired Date', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('4b046845-24a5-43ee-8b0c-0cfa4320b245', 'cde33c76-7289-4206-9822-b47690c8f314', N'DepartmentCode', 100, 1, NULL, NULL, 41, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Department Code', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('d8357846-4a7c-434d-a609-bd42c7fa13e9', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'ProjectDescription', 150, 0, NULL, NULL, 26, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Project Description', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('411c0347-c250-4951-9935-e3782fd4b381', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'HomePhoneNo', 75, 0, NULL, NULL, 20, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Home Phone No', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('49e5244f-848e-4d17-bc5c-8fb3bfb1839e', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'ProjectCompleted', 100, 0, NULL, NULL, 33, 'b2cb6685-3a4b-4cf9-a15a-d01a63031e2b', N'Project Completed', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('d5f9844f-c319-4a2a-9e0b-883d448b518e', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'TaskDeadlineDate', 100, 0, NULL, NULL, 14, '48b9ef68-b4f6-4c75-b8de-c547939179ce', N'Task Deadline Date', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('31632752-fb15-4bd3-9e2b-272e4edf4f4a', 'cde33c76-7289-4206-9822-b47690c8f314', N'EmployeeStatus', 110, 0, NULL, NULL, 52, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Employee Status', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('c23adc54-86bf-4267-8510-6d15b22cd841', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'ProjectEstimatedDuration', 75, 0, NULL, NULL, 29, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Project Estimated Duration', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('7016b159-e6da-4df1-b4d5-33ffec7c743b', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'Priority', 75, 0, NULL, NULL, 32, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Priority', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('58763066-dd95-4bdb-9245-98d6ffb3b2c6', 'cde33c76-7289-4206-9822-b47690c8f314', N'WeekStartDay', 110, 0, NULL, NULL, 44, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Week Start Day', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('88228766-bf0f-48bf-9f0b-04c639fec1d8', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'TaskDurationUnit', 125, 0, NULL, NULL, 13, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Task Duration Unit', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('3b372c67-a403-452c-aa8f-2bb04d141224', 'cde33c76-7289-4206-9822-b47690c8f314', N'ClientTelephone1', 75, 0, NULL, NULL, 38, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Client Telephone 1', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('56b24167-bba3-4f83-968b-6af682135de4', 'cde33c76-7289-4206-9822-b47690c8f314', N'ProjectStatus', 100, 0, NULL, NULL, 26, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Project Status', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('f84a2870-b771-4414-a8b7-d4f7a379ccaf', 'cde33c76-7289-4206-9822-b47690c8f314', N'EmployeeCode', 100, 0, NULL, NULL, 22, '91402610-eef0-4dd0-aca3-0080f53389fa', N'EmployeeCode', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('82af1b71-4ac1-4677-953c-c107e4eff9c8', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'ClientName', 150, 0, NULL, NULL, 11, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Client Name', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('fd894576-182a-49b0-9d6f-ab398d3a0cc5', 'cde33c76-7289-4206-9822-b47690c8f314', N'MinimumHoursPerWeek', 125, 0, NULL, NULL, 47, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Minimum Hours Per Week', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('fbd6bb76-35e2-44b8-a1b1-6dda4824858a', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'City', 100, 0, NULL, NULL, 18, '91402610-eef0-4dd0-aca3-0080f53389fa', N'City', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('4ea78078-8783-42b3-bdf5-081406f60e29', 'cde33c76-7289-4206-9822-b47690c8f314', N'Role', 75, 0, NULL, NULL, 44, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Role', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('e9de837a-8587-4fb9-a041-769f2de25ff6', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'State', 100, 0, NULL, NULL, 17, '91402610-eef0-4dd0-aca3-0080f53389fa', N'State', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('6e10967c-6412-4aea-a5ca-b16a929df585', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'IsParentTask', 75, 0, NULL, NULL, 8, 'b2cb6685-3a4b-4cf9-a15a-d01a63031e2b', N'IsParent Task', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('c6c4aa7c-034e-4e7c-9d71-154cc2a441e2', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'TaskDescription', 200, 0, NULL, NULL, 2, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Task Description', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('55eda786-cf41-44f4-89cf-04846e6f4600', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'ProjectEstimatedDurationUnit', 100, 0, NULL, NULL, 30, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Project Estimated Duration Unit', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('8866c889-eeaf-43c4-8871-4835f94ce534', 'cde33c76-7289-4206-9822-b47690c8f314', N'AccountEmployeeType', 125, 1, NULL, NULL, 41, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Employee Type', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('12c9d68a-fe61-42f0-8b23-5ea2d51c31f6', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'TerminationDate', 100, 1, NULL, NULL, 21, '48b9ef68-b4f6-4c75-b8de-c547939179ce', N'Termination Date', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('63ad728e-e29f-4288-a39e-af2eca63c4f5', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'TaskCompleted', 75, 0, NULL, NULL, 15, 'b2cb6685-3a4b-4cf9-a15a-d01a63031e2b', N'Task Completed', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('c2cc1292-7244-4ed6-9fa5-bd0ffbc8cf02', 'cde33c76-7289-4206-9822-b47690c8f314', N'ClientTelephone2', 75, 0, NULL, NULL, 39, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Client Telephone 2', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('fcc86e97-e285-49c4-89ca-f556dbd50b0c', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'TaskStatus', 100, 0, NULL, NULL, 31, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Task Status', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('0d60fc9b-4699-46e2-89e2-0ffb1d3c379d', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'AccountLocation', 125, 1, NULL, NULL, 5, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Location', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('f4bccc9f-bfe1-4f48-9326-693895e04da6', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'ProjectCode', 75, 0, NULL, NULL, 31, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Project Code', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('a47bb1a2-8165-48e7-a5f1-a9e3eba06829', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'TaskDuration', 125, 0, NULL, NULL, 12, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Task Duration', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('7b683ca5-0a8a-4043-9602-9c681e117e7e', 'cde33c76-7289-4206-9822-b47690c8f314', N'ClientDepartmentCode', 125, 0, NULL, NULL, 27, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Client Department Code', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('ae9a6aa6-dd96-4f6e-850e-e2e6cf4fa8c4', 'cde33c76-7289-4206-9822-b47690c8f314', N'AccountHolidayType', 125, 0, NULL, NULL, 51, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Holiday Type', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('e8f6b9a8-75c7-422e-960b-10ca4a5dca1a', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'AccountEmployeeType', 150, 1, NULL, NULL, 6, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Employee Type', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('46fe8bae-d4de-4bbf-ab63-6ff61dc858a7', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'TaskName', 175, 0, NULL, NULL, 1, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Task Name', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('1e48e0b8-5a05-4633-b01d-4ce648918f1f', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'ProjectDeadlineDate', 125, 0, NULL, NULL, 28, '48b9ef68-b4f6-4c75-b8de-c547939179ce', N'Project Deadline Date', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('65e3e4ba-055f-4c4a-80c3-aac8cb8fc040', 'cde33c76-7289-4206-9822-b47690c8f314', N'ClientDepartmentName', 125, 0, NULL, NULL, 28, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Client Department Name', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('57d642be-3a9d-4382-af6e-1ae2e986199d', 'cde33c76-7289-4206-9822-b47690c8f314', N'ProjectBillingType', 100, 0, NULL, NULL, 25, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Project Billing Type', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('6e5982be-7341-4fad-a8ac-a3d5dc8c1f73', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'Role', 125, 0, NULL, NULL, 16, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Employee Role', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('8e76e2cd-93f2-465c-a796-ebe881bd6d06', 'cde33c76-7289-4206-9822-b47690c8f314', N'ClientContactLastName', 125, 0, NULL, NULL, 31, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Client Contact Last Name', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('d34e28cf-3fdc-4131-8b64-90b910f3245b', 'cde33c76-7289-4206-9822-b47690c8f314', N'ClientEMailAddress', 110, 0, NULL, NULL, 32, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Client Email Address', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('9cef71cf-cc1b-4534-97fe-d2016c6fe6d3', 'cde33c76-7289-4206-9822-b47690c8f314', N'MaximumHoursPerWeek', 125, 0, NULL, NULL, 48, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Maximum Hours Per Week', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('776a7ed1-e05b-49c0-bd13-0419c4546c3e', 'cde33c76-7289-4206-9822-b47690c8f314', N'ClientAddress2', 100, 0, NULL, NULL, 34, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Client Address 2 ', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('42611cd5-cedf-4cce-91ca-568dd4f7b331', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'ProjectStartDate', 125, 0, NULL, NULL, 27, '48b9ef68-b4f6-4c75-b8de-c547939179ce', N'Project Start Date', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('75f504d6-6080-4008-9eee-2de2846c440c', 'cde33c76-7289-4206-9822-b47690c8f314', N'ClientContactFirstName', 125, 0, NULL, NULL, 30, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Client Contact First Name', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('f5505ad7-9e30-482f-8683-e51a91f64796', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'Zip', 75, 0, NULL, NULL, 19, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Zip', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('1625add7-c68d-4bcf-bbf3-4c619a76a649', 'cde33c76-7289-4206-9822-b47690c8f314', N'TimeOffApprovalTypeName', 125, 0, NULL, NULL, 50, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Time Off Approval Type', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('13250bdf-75a2-41d4-91ab-d069e1b12eba', 'cde33c76-7289-4206-9822-b47690c8f314', N'ProjectCompleted', 90, 0, NULL, NULL, 24, 'b2cb6685-3a4b-4cf9-a15a-d01a63031e2b', N'Project Completed', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('dd76f6e2-385b-437a-a291-8f591d9a443e', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'AccountTimeOffPolicy', 125, 1, NULL, NULL, 24, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Time Off Policy', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('8f0123e3-ac64-4d65-ad25-8da7c71bbae0', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'AccountWorkingDayType', 125, 1, NULL, NULL, 23, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Working Day Type', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('e9225be3-32ad-4498-9bb8-cd63e9ed269c', 'cde33c76-7289-4206-9822-b47690c8f314', N'ProjectStartDate', 110, 0, NULL, NULL, 18, '48b9ef68-b4f6-4c75-b8de-c547939179ce', N'Project Start Date', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('47320de4-56ff-449a-8c59-e0fbf57d8ab3', 'cde33c76-7289-4206-9822-b47690c8f314', N'AccountTimeOffPolicy', 125, 1, NULL, NULL, 49, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Time Off Policy', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('8a5175e7-80c4-494c-8079-189d49bd8156', 'cde33c76-7289-4206-9822-b47690c8f314', N'ClientDepartmentLocation', 125, 0, NULL, NULL, 29, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Client Department Location', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('3b6ad2e8-56a3-4f98-bdf2-840fd7b9ebb4', 'cde33c76-7289-4206-9822-b47690c8f314', N'HoursPerDay', 110, 0, NULL, NULL, 43, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'HoursPerDay', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('89372ee9-25d6-46b6-b92b-a1603cff47b0', 'cde33c76-7289-4206-9822-b47690c8f314', N'ClientCity', 75, 0, NULL, NULL, 36, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Client City', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('5d23cfeb-b4c9-48ed-9639-94aac9518d8a', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'EmployeeCode', 125, 1, NULL, NULL, 7, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Employee Code', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('178758ec-ede6-46f3-be83-e7e340f38fba', 'cde33c76-7289-4206-9822-b47690c8f314', N'ClientNick', 110, 0, NULL, NULL, 20, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Client Nick', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('d9975ef4-400f-4514-b245-86be930e0448', 'cde33c76-7289-4206-9822-b47690c8f314', N'ProjectBillingRate', 75, 0, NULL, NULL, 45, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'DefaultBillingRate', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('118825f5-2694-4981-9b65-714e388e4030', 'cde33c76-7289-4206-9822-b47690c8f314', N'DepartmentName', 100, 1, NULL, NULL, 42, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Department Name', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('eb1a01f8-86b4-406a-bdfe-14f2bf00b7a1', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'IsForAllEmployees', 75, 0, NULL, NULL, 9, 'b2cb6685-3a4b-4cf9-a15a-d01a63031e2b', N'IsForAllEmployees', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('fd3e0cfa-aad8-4ca5-8dc5-0d9e00a9cc71', 'cde33c76-7289-4206-9822-b47690c8f314', N'HiredDate', 100, 1, NULL, NULL, 23, '48b9ef68-b4f6-4c75-b8de-c547939179ce', N'Hired Date', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('ebb345fb-0b30-4698-987e-a60bef00af32', 'cde33c76-7289-4206-9822-b47690c8f314', N'AccountLocation', 100, 1, NULL, NULL, 43, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Location Name', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('8592a2fd-9bf9-4832-934c-1ed66366bf0a', 'cde33c76-7289-4206-9822-b47690c8f314', N'ClientState', 75, 0, NULL, NULL, 35, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Client State', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('73003829-48e2-4e75-bd1f-aee8a5371838', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'BillingRate', 75, 0, NULL, NULL, 37, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Billing Rate', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('aca9352f-72cd-46ae-b9ef-37bd55a79e44', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'TaskType', 75, 0, NULL, NULL, 34, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Task Type', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('06251f91-aaa9-4e32-b64f-94e1d0883c5f', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'EmployeeRate', 75, 0, NULL, NULL, 38, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Employee Rate', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('aa175da0-2d30-48ec-bc5c-2d3c4637c45b', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'BillingRateEndDate', 125, 0, NULL, NULL, 36, '48b9ef68-b4f6-4c75-b8de-c547939179ce', N'Billing Rate End Date', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('65564ce8-9e5f-4d41-b278-c97f904f8992', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'BillingRateStartDate', 125, 0, NULL, NULL, 35, '48b9ef68-b4f6-4c75-b8de-c547939179ce', N'Billing Rate Start Date', 0, 0)

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportFilterSourceMapping]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportFilterSourceMapping]'

INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('40ea5077-9f16-40d6-9d01-b4f19fef3490', '45259e57-2e6a-4033-8318-b2e0fcc2863a', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', 0, 1, 4)

-- =======================================================
-- Synchronization Script for Table: [dbo].[AccountReportColumn]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[AccountReportColumn]'

INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('ebecd402-343a-4b2a-b19c-e350ef803dd1', 'ea1e4889-0be2-41c6-a751-31ead8263ad6', N'Termination Date', '12c9d68a-fe61-42f0-8b23-5ea2d51c31f6', 9, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('cedde505-b383-4940-80ae-e8dfca865cf9', 'ea1e4889-0be2-41c6-a751-31ead8263ad6', N'Hired Date', 'f8a14d42-b1a1-477e-a2ce-ff15668707d4', 10, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('181c4016-462c-4fbb-b5b0-4a330c970c2a', 'ea1e4889-0be2-41c6-a751-31ead8263ad6', N'Location', '0d60fc9b-4699-46e2-89e2-0ffb1d3c379d', 8, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('98a90c25-adc4-45ff-8a91-d2f1f80aea4d', 'eb0e7c81-2afd-490e-b2ab-bb44b5757416', N'Employee Status', '31632752-fb15-4bd3-9e2b-272e4edf4f4a', 3, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('d7895737-8871-4404-aac9-2a8458f347f2', 'eb0e7c81-2afd-490e-b2ab-bb44b5757416', N'Department Name', 'e904a47e-cb52-4434-818b-1e1b90206707', 7, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('e3ecd35b-b708-4333-8577-6198ce03663a', 'ea1e4889-0be2-41c6-a751-31ead8263ad6', N'Time Off Policy', 'dd76f6e2-385b-437a-a291-8f591d9a443e', 5, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('da809e6b-4a13-4ea1-abe1-75206c635665', 'ea1e4889-0be2-41c6-a751-31ead8263ad6', N'Employee Code', '5d23cfeb-b4c9-48ed-9639-94aac9518d8a', 1, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('39e1897b-fc8d-4169-abf8-d2156baf9f91', 'ea1e4889-0be2-41c6-a751-31ead8263ad6', N'Role', '6e5982be-7341-4fad-a8ac-a3d5dc8c1f73', 6, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('f72d0e80-90f0-4abb-bcd6-d4a723675342', 'ea1e4889-0be2-41c6-a751-31ead8263ad6', N'Department Name', '2afb8628-605c-4a56-9044-6ff46a086442', 7, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('d7c86b81-9c53-4fb7-ba80-9ed4baa23e93', 'eb0e7c81-2afd-490e-b2ab-bb44b5757416', N'Termination Date', '87211d13-6b8a-44e4-946e-50afc3321493', 10, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('cbbf7c8e-d165-4733-b99b-bf5e1451383c', 'eb0e7c81-2afd-490e-b2ab-bb44b5757416', N'Hired Date', 'fd3e0cfa-aad8-4ca5-8dc5-0d9e00a9cc71', 9, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('d6a23f9d-7618-4d67-b85f-db81baa6c3e8', 'eb0e7c81-2afd-490e-b2ab-bb44b5757416', N'Time Off Policy', '47320de4-56ff-449a-8c59-e0fbf57d8ab3', 5, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('e3f2cba3-4c12-4059-9193-8bd439da0cd4', 'eb0e7c81-2afd-490e-b2ab-bb44b5757416', N'Employee Code', 'f84a2870-b771-4414-a8b7-d4f7a379ccaf', 1, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('638f72b9-3e0c-4dcb-a81e-e62fba9429f3', 'ea1e4889-0be2-41c6-a751-31ead8263ad6', N'Employee Type', 'e8f6b9a8-75c7-422e-960b-10ca4a5dca1a', 3, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('fd884ac8-8312-4484-b776-ce39bf94c8ac', 'eb0e7c81-2afd-490e-b2ab-bb44b5757416', N'Location', '72435aec-8ff6-455d-919f-39f3543f1b5d', 8, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('8b0010cf-34f1-4a72-8842-100a05b8b7d2', 'eb0e7c81-2afd-490e-b2ab-bb44b5757416', N'Employee Type', '8866c889-eeaf-43c4-8871-4835f94ce534', 4, NULL, NULL)
INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('245cebea-af8b-47bd-a07c-c8ef34818649', 'ea1e4889-0be2-41c6-a751-31ead8263ad6', N'Working Day Type', '8f0123e3-ac64-4d65-ad25-8da7c71bbae0', 4, NULL, NULL)

-- =======================================================
-- Synchronization Script for Table: [dbo].[AccountReportGroup]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[AccountReportGroup]'

INSERT INTO [dbo].[AccountReportGroup] ([AccountReportGroupId], [AccountReportId], [ReportGroup], [ReportGroupFieldLabel], [ReportGroupFieldOrder], [SystemReportDataSourceFieldId]) VALUES ('ef066477-be3b-45d5-8a25-9a1be1be1afc', 'eb0e7c81-2afd-490e-b2ab-bb44b5757416', N'ProjectName', N'Project Name', 0, 'f0d0ee4b-6a01-4022-b23c-953a43f8c533')
INSERT INTO [dbo].[AccountReportGroup] ([AccountReportGroupId], [AccountReportId], [ReportGroup], [ReportGroupFieldLabel], [ReportGroupFieldOrder], [SystemReportDataSourceFieldId]) VALUES ('6fb8108a-49c8-4226-999f-c2a174cfdd1d', 'ea1e4889-0be2-41c6-a751-31ead8263ad6', N'ProjectName', N'Project Name', 1, 'e1e64829-73bd-4824-8571-26f42237f9fa')
INSERT INTO [dbo].[AccountReportGroup] ([AccountReportGroupId], [AccountReportId], [ReportGroup], [ReportGroupFieldLabel], [ReportGroupFieldOrder], [SystemReportDataSourceFieldId]) VALUES ('d8c925d5-9e43-48c2-a76b-a35f11f1f7f2', 'ea1e4889-0be2-41c6-a751-31ead8263ad6', N'TaskName', N'Task Name', 0, '46fe8bae-d4de-4bbf-ab63-6ff61dc858a7')
INSERT INTO [dbo].[AccountReportGroup] ([AccountReportGroupId], [AccountReportId], [ReportGroup], [ReportGroupFieldLabel], [ReportGroupFieldOrder], [SystemReportDataSourceFieldId]) VALUES ('37a597cd-4acc-40f7-95cc-16c1b7198cb6', 'eb0e7c81-2afd-490e-b2ab-bb44b5757416', N'ClientName', N'Client Name', 1, '932d07f8-ef51-4212-9293-566b512bdcd3')
INSERT INTO [dbo].[AccountReportGroup] ([AccountReportGroupId], [AccountReportId], [ReportGroup], [ReportGroupFieldLabel], [ReportGroupFieldOrder], [SystemReportDataSourceFieldId]) VALUES ('fab35cdf-4265-4eb9-b9dc-5e23c00524d3', 'ea1e4889-0be2-41c6-a751-31ead8263ad6', N'ClientName', N'Client Name', 2, '82af1b71-4ac1-4677-953c-c107e4eff9c8')


-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportFilterSourceMapping]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportFilterSourceMapping]'

INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('693ccf17-5004-4617-ba84-8e7c70dfee7f', 'd1506e3d-f481-4c3e-9b9e-3319da269bc1', 'cde33c76-7289-4206-9822-b47690c8f314', 0, 1, 5)
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('49e8c42a-6ff2-43ed-b320-b3ea1131f08f', '6f6881bc-6f4f-4b76-b096-93c32852dca9', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', 0, 1, 7)
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('6c7f4a35-9f5f-4e2e-9310-5c90b4df96fb', '0ee086ce-c9f3-4924-97b8-2c67e307561f', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', 0, 1, 5)
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('c191da4e-b734-4d34-be92-1e1f6ce38e8f', 'f0c9dff3-efef-4213-8801-8420dfa4bf92', 'cde33c76-7289-4206-9822-b47690c8f314', 0, 1, 4)
INSERT INTO [dbo].[SystemReportFilterSourceMapping] ([SystemReportFilterMappingId], [SystemReportFilterSourceId], [SystemReportDataSourceId], [IsRequired], [IsAllowAll], [FilterSequence]) VALUES ('3213934f-6541-4a05-adea-dc593813f721', 'dee8c0de-a947-4984-98c1-a9fc28afb704', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', 0, 1, 6)


-- =======================================================
-- Foreign Key Constraint Nochecks's for Table: [dbo].[AccountReportColumn]
-- =======================================================
Print ' Foreign Key Constraint Nochecks''s for Table: [dbo].[AccountReportColumn]'

ALTER TABLE [dbo].[AccountReportColumn] NOCHECK CONSTRAINT [FK_AccountReportColumn_AccountReport]

-- =======================================================
-- Synchronization Script for Table: [dbo].[AccountReportColumn]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[AccountReportColumn]'

DELETE FROM [dbo].[AccountReportColumn] WHERE [AccountReportColumnId]='0476f704-0ba3-41bc-aaae-fb155d32fe2a'
DELETE FROM [dbo].[AccountReportColumn] WHERE [AccountReportColumnId]='56893f0a-aae6-4257-83cb-9bd6235c1b31'
DELETE FROM [dbo].[AccountReportColumn] WHERE [AccountReportColumnId]='ed6a5f0a-9b12-4d35-a8ee-eeb4633d94f4'
DELETE FROM [dbo].[AccountReportColumn] WHERE [AccountReportColumnId]='eba44a46-e80d-493d-b15e-c31be9e65b04'
DELETE FROM [dbo].[AccountReportColumn] WHERE [AccountReportColumnId]='49096350-e189-44b1-9749-4244618a628f'
DELETE FROM [dbo].[AccountReportColumn] WHERE [AccountReportColumnId]='4cf9cd51-f0c8-461b-96ac-20fd8c0ea475'
DELETE FROM [dbo].[AccountReportColumn] WHERE [AccountReportColumnId]='975a4359-5dfb-4be3-9cdb-e4b955a721ef'


-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'

DELETE FROM [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId]='edfacf04-6a52-4de2-8c31-d45d2d89bbe2'
DELETE FROM [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId]='ad428809-2562-4cb6-a0eb-defae0c2539b'
DELETE FROM [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId]='1003aa0d-4273-4f13-9c83-e3be5ac45db6'
DELETE FROM [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId]='43c6d616-8463-450b-9217-5c16b934ca62'
DELETE FROM [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId]='10d35427-ac80-4a5f-bdd8-36e92f7add3c'
DELETE FROM [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId]='10eaf036-16c5-441e-9cc4-7c1d4e1025c6'
DELETE FROM [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId]='dad1c13a-9634-4f75-9f3a-0aea26feb010'
DELETE FROM [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId]='41716c57-654d-4a04-b0ac-f69b34fbe884'
DELETE FROM [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId]='cb1ae05d-92ea-42bf-8257-0c452142d7cc'
DELETE FROM [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId]='a87d646e-8701-4287-8dc9-13ffcc28bfe4'
DELETE FROM [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId]='2fdc6c8d-e82c-4604-afc0-c65349742f4d'
DELETE FROM [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId]='af42888f-d578-46d0-ae30-ba85827ed69b'
DELETE FROM [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId]='fa6a888f-8ead-4406-b0d8-5f6724b74a86'
DELETE FROM [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId]='9b673590-6871-4536-9e2a-1eb9f7f44e3b'
DELETE FROM [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId]='95a16f9b-439b-4833-968e-fdc536382681'
DELETE FROM [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId]='bed98ea6-4d0b-4e69-9a8b-c85d6514dbaf'
DELETE FROM [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId]='f0d1bda7-fe72-4677-b10a-c1d55594ff9a'
DELETE FROM [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId]='1d34a3b2-d5f3-48b1-8ff8-20362c813e00'
DELETE FROM [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId]='133592b9-397a-4c94-a9bb-4979d54248e7'
DELETE FROM [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId]='bce246dc-68f1-44b2-b4a5-3b4e93b4516b'
DELETE FROM [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId]='59f4f0f5-3bbc-4e58-92c3-4afe3a7f533f'


-- =======================================================
-- Synchronization Script for Table: [dbo].[AccountReport]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[AccountReport]'

UPDATE [dbo].[AccountReport] SET [ReportName]=N'Project Task Employee Report', [ReportOrder]=6 WHERE [AccountReportId]='ea1e4889-0be2-41c6-a751-31ead8263ad6'

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'

UPDATE [dbo].[SystemReportDataSourceField] SET [DefaultAvailable]=1 WHERE [SystemReportDataSourceFieldId]='e904a47e-cb52-4434-818b-1e1b90206707'
UPDATE [dbo].[SystemReportDataSourceField] SET [DefaultAvailable]=1 WHERE [SystemReportDataSourceFieldId]='72435aec-8ff6-455d-919f-39f3543f1b5d'

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'

UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=100 WHERE [SystemReportDataSourceFieldId]='c2e54305-d08d-4023-ba79-902208c16d00'
UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=96 WHERE [SystemReportDataSourceFieldId]='86818f14-1dca-4019-9039-e34f6fa3999b'
UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=97 WHERE [SystemReportDataSourceFieldId]='442d9dcc-7b14-48ec-84a0-4f003813f4b9'
UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=99 WHERE [SystemReportDataSourceFieldId]='cfa8dcda-19b5-40e0-8d3e-5b2e23649254'
UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportDataSourceFieldColumnOrder]=98 WHERE [SystemReportDataSourceFieldId]='e74e35dd-f48c-4863-9b59-0a050f8ba6a5'


-- =======================================================
-- Synchronization Script for Table: [dbo].[AccountReportColumn]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[AccountReportColumn]'

UPDATE [dbo].[AccountReportColumn] SET [SystemReportDataSourceFieldId]='bc7b7339-7d02-4b7c-8589-7c51876fcc03' WHERE [AccountReportColumnId]='66163d41-d363-401f-8eeb-1654845a8d5a'

-- =======================================================
-- Foreign Key Constraint Check's for Table: [dbo].[AccountReportColumn]
-- =======================================================
Print ' Foreign Key Constraint Check''s for Table: [dbo].[AccountReportColumn]'

ALTER TABLE [dbo].[AccountReportColumn] CHECK CONSTRAINT [FK_AccountReportColumn_AccountReport]

-- =======================================================
-- Foreign Key Constraint Check's for Table: [dbo].[AccountReportGroup]
-- =======================================================
Print ' Foreign Key Constraint Check''s for Table: [dbo].[AccountReportGroup]'

ALTER TABLE [dbo].[AccountReportGroup] CHECK CONSTRAINT [FK_AccountReportGroup_AccountReport]


-- =======================================================
-- Foreign Key Constraint Nochecks's for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print ' Foreign Key Constraint Nochecks''s for Table: [dbo].[SystemSecurityCategoryPage]'

ALTER TABLE [dbo].[SystemSecurityCategoryPage] NOCHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory]
ALTER TABLE [dbo].[SystemSecurityCategoryPage] NOCHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory1]

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemSecurityCategoryPage]'

UPDATE [dbo].[SystemSecurityCategoryPage] SET [IsAllowEdit]=1 WHERE [SystemSecurityCategoryPageId]=28

-- =======================================================
-- Foreign Key Constraint Check's for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print ' Foreign Key Constraint Check''s for Table: [dbo].[SystemSecurityCategoryPage]'

ALTER TABLE [dbo].[SystemSecurityCategoryPage] CHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory]
ALTER TABLE [dbo].[SystemSecurityCategoryPage] CHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory1]

END
--End 3.9
--Start 4.2.1
GO
-- Drop View rptvueExternalUsers
Print 'Drop View rptvueExternalUsers'
GO
If exists (select * from information_schema.tables where table_name = 'rptvueExternalUsers' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueExternalUsers]

GO
-- Drop View vueAccountExternalUserForReport
Print 'Drop View vueAccountExternalUserForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountExternalUserForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountExternalUserForReport]

GO
-- Create View vueAccountExternalUserForReport
Print 'Create View vueAccountExternalUserForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountExternalUserForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountExternalUserForReport
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId AS ExternalUserId, dbo.AccountEmployee.Password, dbo.AccountEmployee.Prefix, dbo.AccountEmployee.FirstName, 
                      dbo.AccountEmployee.LastName, ISNULL(dbo.AccountEmployee.MiddleName, N'''') AS MiddleName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountEmployee.AccountId, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountRoleId, dbo.AccountEmployee.AccountLocationId, 
                      dbo.AccountEmployee.Notes, dbo.AccountEmployee.AddressLine1, dbo.AccountEmployee.AddressLine2, dbo.AccountEmployee.State, dbo.AccountEmployee.City, 
                      dbo.AccountEmployee.Zip, dbo.AccountEmployee.CountryId, dbo.AccountEmployee.HomePhoneNo, dbo.AccountEmployee.WorkPhoneNo, 
                      dbo.AccountEmployee.MobilePhoneNo, dbo.AccountEmployee.TimeEntryApprovalPathId, dbo.AccountEmployee.BillingRateStateDate, 
                      dbo.AccountEmployee.BillingTypeId, dbo.AccountEmployee.StartDate, dbo.AccountEmployee.TerminationDate, dbo.AccountEmployee.StatusId, 
                      dbo.AccountEmployee.IsDeleted, dbo.AccountEmployee.IsDisabled, dbo.AccountEmployee.DefaultProjectId, dbo.AccountEmployee.TimeZoneId, 
                      dbo.AccountEmployee.DefaultEmployee, dbo.AccountEmployee.CreatedOn, dbo.AccountEmployee.CreatedByEmployeeId, dbo.AccountEmployee.ModifiedOn, 
                      dbo.AccountEmployee.ModifiedByEmployeeId, dbo.AccountEmployee.AllowedAccessFromIP, dbo.AccountEmployee.ExternalUserClientId AS AccountClientId, 
                      dbo.AccountEmployee.EmployeeTypeId, dbo.AccountEmployee.AccountBillingRateId, dbo.AccountEmployee.Username, dbo.AccountEmployee.EmployeeCode, 
                      dbo.AccountEmployee.EmployeeManagerId, ISNULL(dbo.AccountParty.PartyNick, N'''') AS ClientNick, dbo.AccountParty.PartyName AS ClientName, 
                      dbo.AccountRole.Role, dbo.AccountEmployee.FirstName + N'' '' + dbo.AccountEmployee.LastName AS ExternalUser
FROM         dbo.AccountEmployee INNER JOIN
                      dbo.AccountParty ON dbo.AccountEmployee.ExternalUserClientId = dbo.AccountParty.AccountPartyId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId
WHERE     (dbo.AccountEmployee.EmployeeTypeId = 2) AND (dbo.AccountParty.IsDeleted <> 1 OR
                      dbo.AccountParty.IsDeleted IS NULL)'
                      
GO
-- Create View rptvueExternalUsers
Print 'Create View rptvueExternalUsers'
GO
If not exists (select * from information_schema.tables where table_name = 'rptvueExternalUsers' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueExternalUsers
AS
SELECT     ExternalUserId, Password, Prefix, FirstName, LastName, MiddleName, EMailAddress, AccountId, AccountDepartmentId, AccountRoleId, AccountLocationId, Notes, 
                      AddressLine1, AddressLine2, State, City, Zip, CountryId, HomePhoneNo, WorkPhoneNo, MobilePhoneNo, TimeEntryApprovalPathId, BillingRateStateDate, 
                      BillingTypeId, StartDate, TerminationDate, StatusId, IsDeleted, IsDisabled, DefaultProjectId, TimeZoneId, DefaultEmployee, CreatedOn, CreatedByEmployeeId, 
                      ModifiedOn, ModifiedByEmployeeId, AllowedAccessFromIP, AccountClientId, EmployeeTypeId, AccountBillingRateId, Username, EmployeeCode, EmployeeManagerId, 
                      ClientNick, ClientName, Role, ExternalUser
FROM         dbo.vueAccountExternalUserForReport
WHERE     (IsDeleted <> 1)'
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemEMailNotification]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemEMailNotification]'
IF Not Exists(Select * from [dbo].[SystemEMailNotification] where [SystemEMailNotificationId] = 49)
BEGIN
INSERT INTO [dbo].[SystemEMailNotification] ([SystemEMailNotificationId], [SystemEMailNotification], [SystemEMailNotificationTypeId], [Enabled], [IsWeekDayAllow]) VALUES (49, N'Timesheet Approved Notification To Approver', 1, 1, NULL)
INSERT INTO [dbo].[SystemEMailNotification] ([SystemEMailNotificationId], [SystemEMailNotification], [SystemEMailNotificationTypeId], [Enabled], [IsWeekDayAllow]) VALUES (50, N'Timesheet Approved Notification To Approver', 3, 1, NULL)
INSERT INTO [dbo].[SystemEMailNotification] ([SystemEMailNotificationId], [SystemEMailNotification], [SystemEMailNotificationTypeId], [Enabled], [IsWeekDayAllow]) VALUES (51, N'Timesheet Rejected Notification To Approver', 1, 1, NULL)
INSERT INTO [dbo].[SystemEMailNotification] ([SystemEMailNotificationId], [SystemEMailNotification], [SystemEMailNotificationTypeId], [Enabled], [IsWeekDayAllow]) VALUES (52, N'Timesheet Rejected Notification To Approver', 3, 1, NULL)
INSERT INTO [dbo].[SystemEMailNotification] ([SystemEMailNotificationId], [SystemEMailNotification], [SystemEMailNotificationTypeId], [Enabled], [IsWeekDayAllow]) VALUES (53, N'Expense Entry Approved Notification To Approver', 1, 1, NULL)
INSERT INTO [dbo].[SystemEMailNotification] ([SystemEMailNotificationId], [SystemEMailNotification], [SystemEMailNotificationTypeId], [Enabled], [IsWeekDayAllow]) VALUES (54, N'Expense Entry Approved Notification To Approver', 3, 1, NULL)
INSERT INTO [dbo].[SystemEMailNotification] ([SystemEMailNotificationId], [SystemEMailNotification], [SystemEMailNotificationTypeId], [Enabled], [IsWeekDayAllow]) VALUES (55, N'Expense Entry Rejected Notification To Approver', 1, 1, NULL)
INSERT INTO [dbo].[SystemEMailNotification] ([SystemEMailNotificationId], [SystemEMailNotification], [SystemEMailNotificationTypeId], [Enabled], [IsWeekDayAllow]) VALUES (56, N'Expense Entry Rejected Notification To Approver', 3, 1, NULL)
END
GO
-- Create View vueAccountExpenseEntryApprovedEmailToApprover
Print 'Create View vueAccountExpenseEntryApprovedEmailToApprover'
GO
If not exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryApprovedEmailToApprover' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountExpenseEntryApprovedEmailToApprover
AS
SELECT     dbo.AccountEmployee.EMailAddress, dbo.vueAccountExpenseEntry.EmployeeName, dbo.vueAccountExpenseEntry.AccountExpenseName, 
                      dbo.vueAccountExpenseEntry.ProjectName, dbo.vueAccountExpenseEntry.AccountExpenseEntryId, dbo.vueAccountExpenseEntry.AccountExpenseEntryDate, 
                      dbo.vueAccountExpenseEntry.AccountId, dbo.vueAccountExpenseEntry.AccountEmployeeId, dbo.vueAccountExpenseEntry.AccountProjectId, 
                      dbo.vueAccountExpenseEntry.AccountExpenseId, dbo.vueAccountExpenseEntry.Amount, dbo.vueAccountExpenseEntry.TeamLeadApproved, 
                      dbo.vueAccountExpenseEntry.ProjectManagerApproved, dbo.vueAccountExpenseEntry.AdministratorApproved, dbo.vueAccountExpenseEntry.Approved, 
                      dbo.vueAccountExpenseEntry.CreatedOn, dbo.vueAccountExpenseEntry.CreatedByEmployeeId, dbo.vueAccountExpenseEntry.ModifiedOn, 
                      dbo.vueAccountExpenseEntry.ModifiedByEmployeeId, dbo.vueAccountExpenseEntry.PartyName, dbo.vueAccountExpenseEntry.AccountClientId, 
                      dbo.vueAccountExpenseEntry.Description, dbo.vueAccountExpenseEntry.ExpenseType, dbo.vueAccountExpenseEntry.AccountExpenseTypeId, 
                      dbo.vueAccountExpenseEntry.LeaderEmployeeId, dbo.vueAccountExpenseEntry.IsBillable, dbo.vueAccountExpenseEntry.Rejected, 
                      dbo.vueAccountExpenseEntry.EmployeeCode, dbo.vueAccountExpenseEntry.Reimburse, dbo.vueAccountExpenseEntry.AccountCurrencyId, 
                      dbo.vueAccountExpenseEntry.CurrencyCode, dbo.vueAccountExpenseEntry.IsQuantityField, dbo.vueAccountExpenseEntry.QuantityFieldCaption, 
                      dbo.vueAccountExpenseEntry.AccountBaseCurrencyId, dbo.vueAccountExpenseEntry.ExchangeRate, dbo.vueAccountExpenseEntry.TaxAmount, 
                      dbo.vueAccountExpenseEntry.NetAmount, dbo.vueAccountExpenseEntry.Submitted, dbo.vueAccountExpenseEntry.TimeSheetApprovalTypeId, 
                      dbo.vueAccountExpenseEntry.ExpenseApprovalTypeId, dbo.vueAccountExpenseEntry.ProjectManagerEmployeeId, 
                      dbo.vueAccountExpenseEntry.TimeSheetApprovalPathId, dbo.vueAccountExpenseEntry.DepartmentName, dbo.vueAccountExpenseEntry.AccountLocation, 
                      dbo.vueAccountExpenseEntry.AccountTaxZone, dbo.vueAccountExpenseEntry.Quantity, dbo.vueAccountExpenseEntry.Rate, 
                      dbo.vueAccountExpenseEntry.PaymentMethod, dbo.vueAccountExpenseEntry.AccountLocationId, dbo.vueAccountExpenseEntry.PartyNick, 
                      dbo.vueAccountExpenseEntry.ProjectDescription, dbo.vueAccountExpenseEntry.ProjectCode, dbo.vueAccountExpenseEntry.DepartmentCode, 
                      dbo.vueAccountExpenseEntry.ApprovedOn, dbo.vueAccountExpenseEntry.AccountDepartmentId, dbo.vueAccountExpenseEntry.Role, 
                      dbo.vueAccountExpenseEntry.AccountRoleId, dbo.vueAccountExpenseEntry.AccountTimeExpenseBillingExpenseId, dbo.vueAccountExpenseEntry.Billed, 
                      dbo.vueAccountExpenseEntry.InvoiceNumber, dbo.vueAccountExpenseEntry.InvoiceDate, dbo.vueAccountExpenseEntry.AccountProjectTypeId, 
                      dbo.vueAccountExpenseEntry.ProjectType, dbo.vueAccountExpenseEntry.AccountEmployeeExpenseSheetId, dbo.vueAccountExpenseEntry.ExpenseSheetDescription, 
                      dbo.vueAccountExpenseEntry.ExpenseSheetDate, dbo.vueAccountExpenseEntry.SubmittedDate, dbo.AccountExpenseEntryApproval.Comments, 
                      dbo.AccountExpenseEntryApproval.ExpenseApprovalId, dbo.vueAccountBaseCurrency.BaseCurrency, 
                      dbo.vueAccountBaseCurrency.CurrencyCode AS BaseCurrencyCode
FROM         dbo.AccountEmployee INNER JOIN
                      dbo.vueAccountExpenseEntry ON dbo.AccountEmployee.AccountEmployeeId = dbo.vueAccountExpenseEntry.AccountEmployeeId INNER JOIN
                      dbo.vueAccountBaseCurrency ON dbo.vueAccountExpenseEntry.AccountId = dbo.vueAccountBaseCurrency.AccountId LEFT OUTER JOIN
                      dbo.vueAccountExpenseEntryApprovalLastAction INNER JOIN
                      dbo.AccountExpenseEntryApproval ON 
                      dbo.vueAccountExpenseEntryApprovalLastAction.ExpenseApprovalId = dbo.AccountExpenseEntryApproval.ExpenseApprovalId ON 
                      dbo.vueAccountExpenseEntry.AccountExpenseEntryId = dbo.AccountExpenseEntryApproval.AccountExpenseEntryId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_1 ON 
                      dbo.vueAccountExpenseEntry.AccountEmployeeId = AccountEMailNotificationPreference_1.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_2 ON 
                      dbo.vueAccountExpenseEntry.AccountId = AccountEMailNotificationPreference_2.AccountId
WHERE     (AccountEMailNotificationPreference_1.SystemEMailNotificationId = 54) AND (AccountEMailNotificationPreference_1.Enabled = 1) AND 
                      (AccountEMailNotificationPreference_2.SystemEMailNotificationId = 53) AND (AccountEMailNotificationPreference_2.Enabled = 1)'
GO
-- Create View vueAccountExpenseEntryRejectedEmailToApprover
Print 'Create View vueAccountExpenseEntryRejectedEmailToApprover'
GO
If not exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryRejectedEmailToApprover' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountExpenseEntryRejectedEmailToApprover
AS
SELECT     dbo.AccountEmployee.EMailAddress, dbo.vueAccountExpenseEntry.EmployeeName, dbo.vueAccountExpenseEntry.AccountExpenseName, 
                      dbo.vueAccountExpenseEntry.ProjectName, dbo.vueAccountExpenseEntry.AccountExpenseEntryId, dbo.vueAccountExpenseEntry.AccountExpenseEntryDate, 
                      dbo.vueAccountExpenseEntry.AccountId, dbo.vueAccountExpenseEntry.AccountEmployeeId, dbo.vueAccountExpenseEntry.AccountProjectId, 
                      dbo.vueAccountExpenseEntry.AccountExpenseId, dbo.vueAccountExpenseEntry.Amount, dbo.vueAccountExpenseEntry.TeamLeadApproved, 
                      dbo.vueAccountExpenseEntry.ProjectManagerApproved, dbo.vueAccountExpenseEntry.AdministratorApproved, dbo.vueAccountExpenseEntry.Approved, 
                      dbo.vueAccountExpenseEntry.CreatedOn, dbo.vueAccountExpenseEntry.CreatedByEmployeeId, dbo.vueAccountExpenseEntry.ModifiedOn, 
                      dbo.vueAccountExpenseEntry.ModifiedByEmployeeId, dbo.vueAccountExpenseEntry.PartyName, dbo.vueAccountExpenseEntry.AccountClientId, 
                      dbo.vueAccountExpenseEntry.Description, dbo.vueAccountExpenseEntry.ExpenseType, dbo.vueAccountExpenseEntry.AccountExpenseTypeId, 
                      dbo.vueAccountExpenseEntry.LeaderEmployeeId, dbo.vueAccountExpenseEntry.IsBillable, dbo.vueAccountExpenseEntry.Rejected, 
                      dbo.vueAccountExpenseEntry.EmployeeCode, dbo.vueAccountExpenseEntry.Reimburse, dbo.vueAccountExpenseEntry.AccountCurrencyId, 
                      dbo.vueAccountExpenseEntry.CurrencyCode, dbo.vueAccountExpenseEntry.IsQuantityField, dbo.vueAccountExpenseEntry.QuantityFieldCaption, 
                      dbo.vueAccountExpenseEntry.AccountBaseCurrencyId, dbo.vueAccountExpenseEntry.ExchangeRate, dbo.vueAccountExpenseEntry.TaxAmount, 
                      dbo.vueAccountExpenseEntry.NetAmount, dbo.vueAccountExpenseEntry.Submitted, dbo.vueAccountExpenseEntry.TimeSheetApprovalTypeId, 
                      dbo.vueAccountExpenseEntry.ExpenseApprovalTypeId, dbo.vueAccountExpenseEntry.ProjectManagerEmployeeId, 
                      dbo.vueAccountExpenseEntry.TimeSheetApprovalPathId, dbo.vueAccountExpenseEntry.DepartmentName, dbo.vueAccountExpenseEntry.AccountLocation, 
                      dbo.vueAccountExpenseEntry.AccountTaxZone, dbo.vueAccountExpenseEntry.Quantity, dbo.vueAccountExpenseEntry.Rate, 
                      dbo.vueAccountExpenseEntry.PaymentMethod, dbo.vueAccountExpenseEntry.AccountLocationId, dbo.vueAccountExpenseEntry.PartyNick, 
                      dbo.vueAccountExpenseEntry.ProjectDescription, dbo.vueAccountExpenseEntry.ProjectCode, dbo.vueAccountExpenseEntry.DepartmentCode, 
                      dbo.vueAccountExpenseEntry.ApprovedOn, dbo.vueAccountExpenseEntry.AccountDepartmentId, dbo.vueAccountExpenseEntry.Role, 
                      dbo.vueAccountExpenseEntry.AccountRoleId, dbo.vueAccountExpenseEntry.AccountTimeExpenseBillingExpenseId, dbo.vueAccountExpenseEntry.Billed, 
                      dbo.vueAccountExpenseEntry.InvoiceNumber, dbo.vueAccountExpenseEntry.InvoiceDate, dbo.vueAccountExpenseEntry.AccountProjectTypeId, 
                      dbo.vueAccountExpenseEntry.ProjectType, dbo.vueAccountExpenseEntry.AccountEmployeeExpenseSheetId, dbo.vueAccountExpenseEntry.ExpenseSheetDescription, 
                      dbo.vueAccountExpenseEntry.ExpenseSheetDate, dbo.vueAccountExpenseEntry.SubmittedDate, dbo.AccountExpenseEntryApproval.Comments, 
                      dbo.AccountExpenseEntryApproval.ExpenseApprovalId, dbo.vueAccountBaseCurrency.BaseCurrency, 
                      dbo.vueAccountBaseCurrency.CurrencyCode AS BaseCurrencyCode
FROM         dbo.AccountEmployee INNER JOIN
                      dbo.vueAccountExpenseEntry ON dbo.AccountEmployee.AccountEmployeeId = dbo.vueAccountExpenseEntry.AccountEmployeeId INNER JOIN
                      dbo.vueAccountBaseCurrency ON dbo.vueAccountExpenseEntry.AccountId = dbo.vueAccountBaseCurrency.AccountId LEFT OUTER JOIN
                      dbo.vueAccountExpenseEntryApprovalLastAction INNER JOIN
                      dbo.AccountExpenseEntryApproval ON 
                      dbo.vueAccountExpenseEntryApprovalLastAction.ExpenseApprovalId = dbo.AccountExpenseEntryApproval.ExpenseApprovalId ON 
                      dbo.vueAccountExpenseEntry.AccountExpenseEntryId = dbo.AccountExpenseEntryApproval.AccountExpenseEntryId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_1 ON 
                      dbo.vueAccountExpenseEntry.AccountEmployeeId = AccountEMailNotificationPreference_1.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_2 ON 
                      dbo.vueAccountExpenseEntry.AccountId = AccountEMailNotificationPreference_2.AccountId
WHERE     (AccountEMailNotificationPreference_1.SystemEMailNotificationId = 56) AND (AccountEMailNotificationPreference_1.Enabled = 1) AND 
                      (AccountEMailNotificationPreference_2.SystemEMailNotificationId = 55) AND (AccountEMailNotificationPreference_2.Enabled = 1)'
GO
-- Drop View vueAccountEmployeeTimeEntryForQB
Print 'Drop View vueAccountEmployeeTimeEntryForQB'
GO
If exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryForQB' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryForQB]
GO
-- Drop View vueAccountExpenseEntryForQB
Print 'Drop View vueAccountExpenseEntryForQB'
GO
If exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryForQB' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountExpenseEntryForQB]
GO
-- Create View vueAccountExpenseEntryForQB
Print 'Create View vueAccountExpenseEntryForQB'
GO
If not exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryForQB' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountExpenseEntryForQB
AS
SELECT     dbo.AccountExpenseEntry.AccountExpenseEntryDate, dbo.AccountExpenseEntry.AccountId, dbo.AccountExpenseEntry.Description, dbo.AccountExpenseEntry.Amount, 
                      dbo.AccountExpenseEntry.IsBillable, dbo.AccountExpense.AccountExpenseName, 
                      dbo.AccountParty.PartyName + '':'' + dbo.AccountProject.ProjectName AS CustomerJob, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountEmployee.AccountEmployeeId, 
                      dbo.AccountExpenseType.ExpenseType
FROM         dbo.AccountExpenseEntry INNER JOIN
                      dbo.AccountExpense ON dbo.AccountExpenseEntry.AccountExpenseId = dbo.AccountExpense.AccountExpenseId INNER JOIN
                      dbo.AccountProject ON dbo.AccountExpenseEntry.AccountProjectId = dbo.AccountProject.AccountProjectId INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountExpenseEntry.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId INNER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId INNER JOIN
                      dbo.AccountExpenseType ON dbo.AccountExpense.AccountExpenseTypeId = dbo.AccountExpenseType.AccountExpenseTypeId'
GO
-- Create View vueAccountEmployeeTimeEntryForQB
Print 'Create View vueAccountEmployeeTimeEntryForQB'
GO
If not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryForQB' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryForQB
AS
SELECT     dbo.AccountEmployeeTimeEntry.TimeEntryDate, dbo.AccountEmployeeTimeEntry.TotalTime, dbo.AccountEmployeeTimeEntry.Description, 
                      dbo.AccountProject.ProjectName, dbo.AccountProject.ProjectDescription, dbo.AccountProject.ProjectCode, dbo.AccountProject.IsDisabled, 
                      dbo.AccountProject.IsTemplate, dbo.AccountProject.IsProject, dbo.AccountProject.IsDeleted, dbo.AccountProjectTask.TaskName, 
                      dbo.AccountProjectTask.TaskDescription, dbo.AccountProjectTask.IsParentTask, dbo.AccountProjectTask.IsBillable, dbo.AccountProjectTask.TaskCode, 
                      LEFT(dbo.AccountParty.PartyName, 41) AS PartyName, dbo.AccountParty.PartyNick, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountEmployee.AccountId, dbo.AccountEmployee.EmployeeCode, 
                      dbo.AccountProjectMilestone.MilestoneDescription, dbo.AccountEmployee.AccountEmployeeId, dbo.AccountWorkType.AccountWorkType, 
                      dbo.AccountCostCenter.AccountCostCenter, dbo.AccountDepartment.DepartmentName, dbo.AccountEmployeeType.AccountEmployeeType, 
                      dbo.vueAccountProjectTaskWithParentForQB.Parents AS ServiceItemName
FROM         dbo.AccountEmployeeTimeEntry INNER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId INNER JOIN
                      dbo.AccountProjectTask ON dbo.AccountEmployeeTimeEntry.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId INNER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeEntry.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId INNER JOIN
                      dbo.AccountProjectMilestone ON dbo.AccountProjectTask.AccountProjectMilestoneId = dbo.AccountProjectMilestone.AccountProjectMilestoneId INNER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId AND 
                      dbo.AccountEmployee.AccountId = dbo.AccountDepartment.AccountId INNER JOIN
                      dbo.AccountEmployeeType ON dbo.AccountEmployee.EmployeePayTypeId = dbo.AccountEmployeeType.AccountEmployeeTypeId AND 
                      dbo.AccountEmployee.AccountId = dbo.AccountEmployeeType.AccountId INNER JOIN
                      dbo.vueAccountProjectTaskWithParentForQB ON 
                      dbo.AccountProjectTask.AccountProjectTaskId = dbo.vueAccountProjectTaskWithParentForQB.AccountProjectTaskId LEFT OUTER JOIN
                      dbo.AccountCostCenter ON dbo.AccountEmployeeTimeEntry.AccountCostCenterId = dbo.AccountCostCenter.AccountCostCenterId LEFT OUTER JOIN
                      dbo.AccountWorkType ON dbo.AccountEmployeeTimeEntry.AccountWorkTypeId = dbo.AccountWorkType.AccountWorkTypeId'

GO
-- Create Table SystemInvoiceBillingType
Print 'Create Table SystemInvoiceBillingType'
GO
IF NOT EXISTS (select * from information_schema.tables where table_name = 'SystemInvoiceBillingType' and table_type = 'BASE TABLE') 
CREATE TABLE [dbo].[SystemInvoiceBillingType] (
		[InvoiceBillingTypeId]     uniqueidentifier NOT NULL,
		[InvoiceBillingType]       nvarchar(50) NULL
)

GO
-- Add Primary Key PK_SystemInvoiceBillingType to SystemInvoiceBillingType
Print 'Add Primary Key PK_SystemInvoiceBillingType to SystemInvoiceBillingType'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'SystemInvoiceBillingType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_NAME='PK_SystemInvoiceBillingType' AND TABLE_NAME='SystemInvoiceBillingType'))
ALTER TABLE [dbo].[SystemInvoiceBillingType]
	ADD
	CONSTRAINT [PK_SystemInvoiceBillingType]
	PRIMARY KEY
	([InvoiceBillingTypeId])

GO
-- Add Default Constraint DF_SystemInvoiceBillingType_InvoiceBillingTypeId to SystemInvoiceBillingType
Print 'Add Default Constraint DF_SystemInvoiceBillingType_InvoiceBillingTypeId to SystemInvoiceBillingType'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'SystemInvoiceBillingType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM sysobjects WHERE name= N'DF_SystemInvoiceBillingType_InvoiceBillingTypeId'))
ALTER TABLE [dbo].[SystemInvoiceBillingType]
	ADD
	CONSTRAINT [DF_SystemInvoiceBillingType_InvoiceBillingTypeId]
	DEFAULT (newid()) FOR [InvoiceBillingTypeId]

GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemInvoiceBillingType]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemInvoiceBillingType]'
if not exists(Select * from [dbo].[SystemInvoiceBillingType] where [InvoiceBillingTypeId] = 'f06cbf01-a190-4424-bfa9-0e8d58812952')
BEGIN
INSERT INTO [dbo].[SystemInvoiceBillingType] ([InvoiceBillingTypeId], [InvoiceBillingType]) VALUES ('f06cbf01-a190-4424-bfa9-0e8d58812952', N'Hours')
INSERT INTO [dbo].[SystemInvoiceBillingType] ([InvoiceBillingTypeId], [InvoiceBillingType]) VALUES ('d965607c-02ca-48a4-b681-a50f4ae8ce67', N'Days')
END

GO
-- Drop View vueAccount
Print 'Drop View vueAccount'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccount' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccount]

GO
-- Drop View vueAccountEmployee
Print 'Drop View vueAccountEmployee'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployee]

GO
-- Add Column InvoiceBillingTypeId to AccountPreferences
Print 'Add Column InvoiceBillingTypeId to AccountPreferences'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountPreferences' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='InvoiceBillingTypeId' AND TABLE_NAME='AccountPreferences'))
ALTER TABLE [dbo].[AccountPreferences]
	ADD [InvoiceBillingTypeId] uniqueidentifier NULL

GO
-- Add Column ShowBillingRateInInvoiceReport to AccountPreferences
Print 'Add Column ShowBillingRateInInvoiceReport to AccountPreferences'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountPreferences' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='ShowBillingRateInInvoiceReport' AND TABLE_NAME='AccountPreferences'))
ALTER TABLE [dbo].[AccountPreferences]
	ADD [ShowBillingRateInInvoiceReport] bit NULL

GO
-- Add Column Terms to AccountTimeExpenseBilling
Print 'Add Column Terms to AccountTimeExpenseBilling'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountTimeExpenseBilling' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='Terms' AND TABLE_NAME='AccountTimeExpenseBilling'))
ALTER TABLE [dbo].[AccountTimeExpenseBilling]
	ADD [Terms] nvarchar(1000) NULL

GO
-- Add Column BankDetails to AccountTimeExpenseBilling
Print 'Add Column BankDetails to AccountTimeExpenseBilling'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountTimeExpenseBilling' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='BankDetails' AND TABLE_NAME='AccountTimeExpenseBilling'))
ALTER TABLE [dbo].[AccountTimeExpenseBilling]
	ADD [BankDetails] nvarchar(1000) NULL

GO
-- Create View vueAccountEmployee
Print 'Create View vueAccountEmployee'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployee
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountEmployee.AccountId, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.Password, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountLocationId, dbo.AccountEmployee.BillingTypeId, 
                      dbo.AccountBillingType.BillingType, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, dbo.AccountPreferences.ShowClockStartEnd, dbo.Account.TimeZoneId, 
                      dbo.AccountRole.MasterAccountRoleId, dbo.Account.DefaultCurrencyId, dbo.Account.CountryId, dbo.AccountPreferences.CultureInfoName, 
                      dbo.AccountPreferences.TimeEntryFormat, dbo.AccountEmployee.AllowedAccessFromIP, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountPreferences.AccountSessionTimeout, dbo.AccountPreferences.ShowCompletedTasksInTimeSheet, dbo.AccountPreferences.CurrencySymbol, 
                      dbo.AccountPreferences.IsCompanyOwnLogo, dbo.Account.AccountExpiryActivation, dbo.Account.LicenseActivation, dbo.AccountEmployee.EmployeeTypeId, 
                      dbo.AccountEmployee.ExternalUserClientId, dbo.AccountEmployee.AccountBillingRateId, dbo.AccountPreferences.ScheduledEmailSendTime, 
                      dbo.AccountEmployee.Username, dbo.AccountEmployee.IsDisabled, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.AccountEmployee.EmployeeCode, dbo.AccountPreferences.Version, 
                      dbo.AccountPreferences.LockSubmittedRecords, dbo.AccountPreferences.LockApprovedRecords, ISNULL(dbo.AccountEmployee.EmployeeCode + '' - '', '''') 
                      + dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeNameWithCode, dbo.AccountPreferences.ShowWorkTypeInTimeSheet, 
                      dbo.AccountPreferences.NumberOfBlankRowsInTimeEntry, dbo.AccountPreferences.ShowCostCenterInTimeSheet, dbo.AccountPreferences.WeekStartDay, 
                      dbo.AccountPreferences.AccountBaseCurrencyId, dbo.AccountPreferences.UserInterfaceLanguage, dbo.AccountEmployee.EmployeeManagerId, 
                      dbo.AccountPreferences.DefaultTimeEntryMode, dbo.AccountPreferences.PageSize, dbo.AccountEmployee.TimeZoneId AS EmployeeTimeZoneId, 
                      dbo.AccountEmployee.TerminationDate, dbo.AccountEmployee.StatusId, dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.EmployeePayTypeId, 
                      dbo.AccountEmployee.HiredDate, dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountWorkingDayType, 
                      dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay AS EmployeeWeekStartDay, 
                      dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountPreferences.ShowDescriptionInWeekView, 
                      dbo.AccountPreferences.InvoiceNoPrefix, dbo.AccountPreferences.ShowAdditionalTaskInformationType, 
                      dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, 
                      ISNULL(dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, 1) AS InitialDayOfTheMonth, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, 1) 
                      AS SystemInitialDayOfFirstPeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod, 16) AS SystemInitialDayOfLastPeriod, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountPreferences.TimesheetPrintFooter, dbo.AccountPreferences.ExpenseSheetPrintFooter, 
                      dbo.AccountPreferences.ShowCompletedProjectsInTimeSheet, dbo.AccountPreferences.ShowProjectForTimeOff, dbo.AccountPreferences.ShowTimeOffInTimesheet, 
                      dbo.AccountEmployee.IsDeleted, dbo.AccountEmployee.IsForcePasswordChange, dbo.AccountEmployee.PasswordChangedDate, 
                      dbo.AccountPreferences.PasswordExpiryPeriod, dbo.AccountPreferences.ShowAllInTimesheetReadOnly, dbo.AccountPreferences.ShowTaskInExpenseSheet, 
                      dbo.AccountPreferences.InvoiceBillingTypeId, dbo.AccountPreferences.ShowBillingRateInInvoiceReport, dbo.SystemInvoiceBillingType.InvoiceBillingType
FROM         dbo.SystemInvoiceBillingType RIGHT OUTER JOIN
                      dbo.AccountPreferences ON dbo.SystemInvoiceBillingType.InvoiceBillingTypeId = dbo.AccountPreferences.InvoiceBillingTypeId RIGHT OUTER JOIN
                      dbo.vueAccountTimesheetPeriodType RIGHT OUTER JOIN
                      dbo.AccountWorkingDayType ON 
                      dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId = dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId RIGHT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.Account ON dbo.AccountEmployee.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId ON 
                      dbo.AccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId ON 
                      dbo.AccountPreferences.AccountId = dbo.AccountEmployee.AccountId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId'

GO
-- Create View vueAccount
Print 'Create View vueAccount'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccount' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccount
AS
SELECT     dbo.Account.AccountId, dbo.Account.AccountTypeId, dbo.Account.AccountName, dbo.Account.Address1, dbo.Account.Address2, dbo.Account.ZipCode, dbo.Account.State, 
                      dbo.Account.City, dbo.Account.CountryId, dbo.Account.EMailAddress, dbo.Account.Telephone, dbo.Account.Fax, dbo.Account.DefaultCurrencyId, 
                      dbo.Account.TimeZoneId, dbo.Account.IsDisabled, dbo.Account.IsDeleted, dbo.Account.StatusId, dbo.Account.CreatedOn, dbo.Account.ModifiedOn, 
                      dbo.Account.ModifiedByEmployeeId, dbo.AccountPreferences.ShowClockStartEnd, dbo.AccountPreferences.AccountPreferencesId, dbo.Account.LicenseKey, 
                      dbo.Account.SystemPackageTypeId, dbo.AccountPreferences.TimeEntryFormat, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.Account.MachineId, dbo.Account.ActivationLicenseKey, dbo.Account.ActivationMachineKey, 
                      dbo.Account.ActivationType, dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountPreferences.InvoiceBillingTypeId, 
                      dbo.AccountPreferences.ShowBillingRateInInvoiceReport
FROM         dbo.Account INNER JOIN
                      dbo.AccountPreferences ON dbo.Account.AccountId = dbo.AccountPreferences.AccountId'


GO

-- Drop View vueAccount
Print 'Drop View vueAccount'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccount' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccount]

GO
-- Drop View vueAccountEmployee
Print 'Drop View vueAccountEmployee'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployee]

GO
-- Add Column InvoiceFooter to AccountPreferences
Print 'Add Column InvoiceFooter to AccountPreferences'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountPreferences' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='InvoiceFooter' AND TABLE_NAME='AccountPreferences'))
ALTER TABLE [dbo].[AccountPreferences]
	ADD [InvoiceFooter] nvarchar(4000) NULL

GO
-- Create View vueAccountEmployee
Print 'Create View vueAccountEmployee'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployee
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountEmployee.AccountId, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.Password, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountLocationId, dbo.AccountEmployee.BillingTypeId, 
                      dbo.AccountBillingType.BillingType, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, dbo.AccountPreferences.ShowClockStartEnd, dbo.Account.TimeZoneId, 
                      dbo.AccountRole.MasterAccountRoleId, dbo.Account.DefaultCurrencyId, dbo.Account.CountryId, dbo.AccountPreferences.CultureInfoName, 
                      dbo.AccountPreferences.TimeEntryFormat, dbo.AccountEmployee.AllowedAccessFromIP, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountPreferences.AccountSessionTimeout, dbo.AccountPreferences.ShowCompletedTasksInTimeSheet, dbo.AccountPreferences.CurrencySymbol, 
                      dbo.AccountPreferences.IsCompanyOwnLogo, dbo.Account.AccountExpiryActivation, dbo.Account.LicenseActivation, dbo.AccountEmployee.EmployeeTypeId, 
                      dbo.AccountEmployee.ExternalUserClientId, dbo.AccountEmployee.AccountBillingRateId, dbo.AccountPreferences.ScheduledEmailSendTime, 
                      dbo.AccountEmployee.Username, dbo.AccountEmployee.IsDisabled, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.AccountEmployee.EmployeeCode, dbo.AccountPreferences.Version, 
                      dbo.AccountPreferences.LockSubmittedRecords, dbo.AccountPreferences.LockApprovedRecords, ISNULL(dbo.AccountEmployee.EmployeeCode + '' - '', '''') 
                      + dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeNameWithCode, dbo.AccountPreferences.ShowWorkTypeInTimeSheet, 
                      dbo.AccountPreferences.NumberOfBlankRowsInTimeEntry, dbo.AccountPreferences.ShowCostCenterInTimeSheet, dbo.AccountPreferences.WeekStartDay, 
                      dbo.AccountPreferences.AccountBaseCurrencyId, dbo.AccountPreferences.UserInterfaceLanguage, dbo.AccountEmployee.EmployeeManagerId, 
                      dbo.AccountPreferences.DefaultTimeEntryMode, dbo.AccountPreferences.PageSize, dbo.AccountEmployee.TimeZoneId AS EmployeeTimeZoneId, 
                      dbo.AccountEmployee.TerminationDate, dbo.AccountEmployee.StatusId, dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.EmployeePayTypeId, 
                      dbo.AccountEmployee.HiredDate, dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountWorkingDayType, 
                      dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay AS EmployeeWeekStartDay, 
                      dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountPreferences.ShowDescriptionInWeekView, 
                      dbo.AccountPreferences.InvoiceNoPrefix, dbo.AccountPreferences.ShowAdditionalTaskInformationType, 
                      dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, 
                      ISNULL(dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, 1) AS InitialDayOfTheMonth, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, 1) 
                      AS SystemInitialDayOfFirstPeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod, 16) AS SystemInitialDayOfLastPeriod, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountPreferences.TimesheetPrintFooter, dbo.AccountPreferences.ExpenseSheetPrintFooter, 
                      dbo.AccountPreferences.ShowCompletedProjectsInTimeSheet, dbo.AccountPreferences.ShowProjectForTimeOff, dbo.AccountPreferences.ShowTimeOffInTimesheet, 
                      dbo.AccountEmployee.IsDeleted, dbo.AccountEmployee.IsForcePasswordChange, dbo.AccountEmployee.PasswordChangedDate, 
                      dbo.AccountPreferences.PasswordExpiryPeriod, dbo.AccountPreferences.ShowAllInTimesheetReadOnly, dbo.AccountPreferences.ShowTaskInExpenseSheet, 
                      dbo.AccountPreferences.InvoiceBillingTypeId, dbo.AccountPreferences.ShowBillingRateInInvoiceReport, dbo.SystemInvoiceBillingType.InvoiceBillingType, 
                      dbo.AccountPreferences.InvoiceFooter
FROM         dbo.SystemInvoiceBillingType RIGHT OUTER JOIN
                      dbo.AccountPreferences ON dbo.SystemInvoiceBillingType.InvoiceBillingTypeId = dbo.AccountPreferences.InvoiceBillingTypeId RIGHT OUTER JOIN
                      dbo.vueAccountTimesheetPeriodType RIGHT OUTER JOIN
                      dbo.AccountWorkingDayType ON 
                      dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId = dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId RIGHT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.Account ON dbo.AccountEmployee.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId ON 
                      dbo.AccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId ON 
                      dbo.AccountPreferences.AccountId = dbo.AccountEmployee.AccountId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId'

GO
-- Create View vueAccount
Print 'Create View vueAccount'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccount' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccount
AS
SELECT     dbo.Account.AccountId, dbo.Account.AccountTypeId, dbo.Account.AccountName, dbo.Account.Address1, dbo.Account.Address2, dbo.Account.ZipCode, dbo.Account.State, 
                      dbo.Account.City, dbo.Account.CountryId, dbo.Account.EMailAddress, dbo.Account.Telephone, dbo.Account.Fax, dbo.Account.DefaultCurrencyId, 
                      dbo.Account.TimeZoneId, dbo.Account.IsDisabled, dbo.Account.IsDeleted, dbo.Account.StatusId, dbo.Account.CreatedOn, dbo.Account.ModifiedOn, 
                      dbo.Account.ModifiedByEmployeeId, dbo.AccountPreferences.ShowClockStartEnd, dbo.AccountPreferences.AccountPreferencesId, dbo.Account.LicenseKey, 
                      dbo.Account.SystemPackageTypeId, dbo.AccountPreferences.TimeEntryFormat, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.Account.MachineId, dbo.Account.ActivationLicenseKey, dbo.Account.ActivationMachineKey, 
                      dbo.Account.ActivationType, dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountPreferences.InvoiceBillingTypeId, 
                      dbo.AccountPreferences.ShowBillingRateInInvoiceReport, dbo.AccountPreferences.InvoiceFooter
FROM         dbo.Account INNER JOIN
                      dbo.AccountPreferences ON dbo.Account.AccountId = dbo.AccountPreferences.AccountId'
GO
-- Drop View vueAccountWorkingDayType
Print 'Drop View vueAccountWorkingDayType'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountWorkingDayType' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountWorkingDayType]
GO
-- Drop View vueAccountEmployee
Print 'Drop View vueAccountEmployee'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployee]
GO
-- Add Column TimesheetOverdueAfterDays to AccountWorkingDayType
Print 'Add Column TimesheetOverdueAfterDays to AccountWorkingDayType'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountWorkingDayType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='TimesheetOverdueAfterDays' AND TABLE_NAME='AccountWorkingDayType'))
ALTER TABLE [dbo].[AccountWorkingDayType]
	ADD [TimesheetOverdueAfterDays] smallint NULL

GO
-- Add Column TimesheetOverduePeriods to AccountPreferences
Print 'Add Column TimesheetOverduePeriods to AccountPreferences'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountPreferences' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='TimesheetOverduePeriods' AND TABLE_NAME='AccountPreferences'))
ALTER TABLE [dbo].[AccountPreferences]
	ADD [TimesheetOverduePeriods] smallint NULL

GO
-- Create View vueAccountEmployee
Print 'Create View vueAccountEmployee'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployee
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountEmployee.AccountId, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.Password, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountLocationId, dbo.AccountEmployee.BillingTypeId, 
                      dbo.AccountBillingType.BillingType, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, dbo.AccountPreferences.ShowClockStartEnd, dbo.Account.TimeZoneId, 
                      dbo.AccountRole.MasterAccountRoleId, dbo.Account.DefaultCurrencyId, dbo.Account.CountryId, dbo.AccountPreferences.CultureInfoName, 
                      dbo.AccountPreferences.TimeEntryFormat, dbo.AccountEmployee.AllowedAccessFromIP, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountPreferences.AccountSessionTimeout, dbo.AccountPreferences.ShowCompletedTasksInTimeSheet, dbo.AccountPreferences.CurrencySymbol, 
                      dbo.AccountPreferences.IsCompanyOwnLogo, dbo.Account.AccountExpiryActivation, dbo.Account.LicenseActivation, dbo.AccountEmployee.EmployeeTypeId, 
                      dbo.AccountEmployee.ExternalUserClientId, dbo.AccountEmployee.AccountBillingRateId, dbo.AccountPreferences.ScheduledEmailSendTime, 
                      dbo.AccountEmployee.Username, dbo.AccountEmployee.IsDisabled, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.AccountEmployee.EmployeeCode, dbo.AccountPreferences.Version, 
                      dbo.AccountPreferences.LockSubmittedRecords, dbo.AccountPreferences.LockApprovedRecords, ISNULL(dbo.AccountEmployee.EmployeeCode + '' - '', '''') 
                      + dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeNameWithCode, dbo.AccountPreferences.ShowWorkTypeInTimeSheet, 
                      dbo.AccountPreferences.NumberOfBlankRowsInTimeEntry, dbo.AccountPreferences.ShowCostCenterInTimeSheet, dbo.AccountPreferences.WeekStartDay, 
                      dbo.AccountPreferences.AccountBaseCurrencyId, dbo.AccountPreferences.UserInterfaceLanguage, dbo.AccountEmployee.EmployeeManagerId, 
                      dbo.AccountPreferences.DefaultTimeEntryMode, dbo.AccountPreferences.PageSize, dbo.AccountEmployee.TimeZoneId AS EmployeeTimeZoneId, 
                      dbo.AccountEmployee.TerminationDate, dbo.AccountEmployee.StatusId, dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.EmployeePayTypeId, 
                      dbo.AccountEmployee.HiredDate, dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountWorkingDayType, 
                      dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay AS EmployeeWeekStartDay, 
                      dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountPreferences.ShowDescriptionInWeekView, 
                      dbo.AccountPreferences.InvoiceNoPrefix, dbo.AccountPreferences.ShowAdditionalTaskInformationType, 
                      dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, 
                      ISNULL(dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, 1) AS InitialDayOfTheMonth, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, 1) 
                      AS SystemInitialDayOfFirstPeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod, 16) AS SystemInitialDayOfLastPeriod, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountPreferences.TimesheetPrintFooter, dbo.AccountPreferences.ExpenseSheetPrintFooter, 
                      dbo.AccountPreferences.ShowCompletedProjectsInTimeSheet, dbo.AccountPreferences.ShowProjectForTimeOff, dbo.AccountPreferences.ShowTimeOffInTimesheet, 
                      dbo.AccountEmployee.IsDeleted, dbo.AccountEmployee.IsForcePasswordChange, dbo.AccountEmployee.PasswordChangedDate, 
                      dbo.AccountPreferences.PasswordExpiryPeriod, dbo.AccountPreferences.ShowAllInTimesheetReadOnly, dbo.AccountPreferences.ShowTaskInExpenseSheet, 
                      dbo.AccountPreferences.InvoiceBillingTypeId, dbo.AccountPreferences.ShowBillingRateInInvoiceReport, dbo.SystemInvoiceBillingType.InvoiceBillingType, 
                      dbo.AccountPreferences.InvoiceFooter, dbo.AccountPreferences.TimesheetOverduePeriods, dbo.AccountWorkingDayType.TimesheetOverdueAfterDays
FROM         dbo.SystemInvoiceBillingType RIGHT OUTER JOIN
                      dbo.AccountPreferences ON dbo.SystemInvoiceBillingType.InvoiceBillingTypeId = dbo.AccountPreferences.InvoiceBillingTypeId RIGHT OUTER JOIN
                      dbo.vueAccountTimesheetPeriodType RIGHT OUTER JOIN
                      dbo.AccountWorkingDayType ON 
                      dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId = dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId RIGHT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.Account ON dbo.AccountEmployee.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId ON 
                      dbo.AccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId ON 
                      dbo.AccountPreferences.AccountId = dbo.AccountEmployee.AccountId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId'
GO
-- Create View vueAccountWorkingDayType
Print 'Create View vueAccountWorkingDayType'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountWorkingDayType' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountWorkingDayType
AS
SELECT     dbo.AccountWorkingDayType.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountId, dbo.AccountWorkingDayType.AccountWorkingDayType, 
                      dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay, dbo.AccountWorkingDayType.CreatedByEmployeeId, 
                      dbo.AccountWorkingDayType.CreatedOn, dbo.AccountWorkingDayType.ModifiedByEmployeeId, dbo.AccountWorkingDayType.ModifiedOn, 
                      dbo.AccountWorkingDayType.IsDisabled, dbo.SystemWorkingDay.WorkingDay, dbo.AccountWorkingDayType.MasterWorkingDayTypeId, 
                      dbo.SystemWorkingDay.SQLServerWeekDayNo, dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, 
                      dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, 
                      dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod, dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId, 
                      dbo.AccountWorkingDayType.TimesheetOverdueAfterDays
FROM         dbo.AccountWorkingDayType LEFT OUTER JOIN
                      dbo.vueAccountTimesheetPeriodType ON 
                      dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId = dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId LEFT OUTER JOIN
                      dbo.SystemWorkingDay ON dbo.AccountWorkingDayType.WeekStartDay = dbo.SystemWorkingDay.WorkingDayNo'
GO
-- Create View vueTimesheetOverdueNotificationWithPreference
Print 'Create View vueTimesheetOverdueNotificationWithPreference'
GO
if not exists (select * from information_schema.tables where table_name = 'vueTimesheetOverdueNotificationWithPreference' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueTimesheetOverdueNotificationWithPreference
AS
SELECT     dbo.AccountPreferences.ScheduledEmailSendTime, dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, 
                      dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.AccountId, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, CASE WHEN dbo.AccountPreferences.CultureInfoName IS NULL OR
                      dbo.AccountPreferences.CultureInfoName = ''auto'' THEN ''en-us'' ELSE dbo.AccountPreferences.CultureInfoName END AS CultureInfoName, 
                      ISNULL(dbo.vueAccountWorkingDayType.TimesheetOverdueAfterDays, 1) AS TimesheetOverdueAfterDays, 
                      ISNULL(dbo.vueAccountWorkingDayType.SystemTimesheetPeriodType, ''Weekly'') AS SystemTimesheetPeriodType, 
                      ISNULL(dbo.vueAccountWorkingDayType.WeekStartDay, 1) AS WeekStartDay, ISNULL(dbo.vueAccountWorkingDayType.SystemInitialDayOfFirstPeriod, 1) 
                      AS SystemInitialDayOfFirstPeriod, ISNULL(dbo.vueAccountWorkingDayType.SystemInitialDayOfLastPeriod, 16) AS SystemInitialDayOfLastPeriod, 
                      ISNULL(dbo.vueAccountWorkingDayType.InitialDayOfTheMonth, 1) AS InitialDayOfTheMonth
FROM         dbo.vueAccountWorkingDayType INNER JOIN
                      dbo.AccountEmployee ON dbo.vueAccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_2 ON 
                      dbo.AccountEmployee.AccountEmployeeId = AccountEMailNotificationPreference_2.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference ON dbo.AccountEmployee.AccountId = dbo.AccountEMailNotificationPreference.AccountId LEFT OUTER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployee.AccountId = dbo.AccountPreferences.AccountId
WHERE     (AccountEMailNotificationPreference_2.SystemEMailNotificationId = 60) AND (AccountEMailNotificationPreference_2.Enabled = 1) AND 
                      (dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = 59) AND (dbo.AccountEMailNotificationPreference.Enabled = 1) AND 
                      (dbo.AccountEmployee.EmployeeTypeId <> 2 OR
                      dbo.AccountEmployee.EmployeeTypeId IS NULL) AND (dbo.AccountEmployee.IsDeleted <> 1) AND (dbo.AccountEmployee.IsDisabled <> 1)'
GO
-- Create View vueTimesheetDueNotificationEmailWithPreference
Print 'Create View vueTimesheetDueNotificationEmailWithPreference'
GO
if not exists (select * from information_schema.tables where table_name = 'vueTimesheetDueNotificationEmailWithPreference' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueTimesheetDueNotificationEmailWithPreference
AS
SELECT     dbo.AccountPreferences.ScheduledEmailSendTime, dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, 
                      dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.AccountId, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, CASE WHEN dbo.AccountPreferences.CultureInfoName IS NULL OR
                      dbo.AccountPreferences.CultureInfoName = ''auto'' THEN ''en-us'' ELSE dbo.AccountPreferences.CultureInfoName END AS CultureInfoName, 
                      ISNULL(dbo.vueAccountWorkingDayType.TimesheetOverdueAfterDays, 1) AS TimesheetOverdueAfterDays, 
                      ISNULL(dbo.vueAccountWorkingDayType.SystemTimesheetPeriodType, ''Weekly'') AS SystemTimesheetPeriodType, 
                      ISNULL(dbo.vueAccountWorkingDayType.WeekStartDay, 1) AS WeekStartDay, ISNULL(dbo.vueAccountWorkingDayType.SystemInitialDayOfFirstPeriod, 1) 
                      AS SystemInitialDayOfFirstPeriod, ISNULL(dbo.vueAccountWorkingDayType.SystemInitialDayOfLastPeriod, 16) AS SystemInitialDayOfLastPeriod, 
                      ISNULL(dbo.vueAccountWorkingDayType.InitialDayOfTheMonth, 1) AS InitialDayOfTheMonth, ISNULL(dbo.AccountPreferences.TimesheetOverduePeriods, 4) 
                      AS TimesheetOverduePeriods, dbo.vueAccountWorkingDayType.MinimumHoursPerWeek, dbo.vueAccountWorkingDayType.MaximumHoursPerWeek
FROM         dbo.vueAccountWorkingDayType INNER JOIN
                      dbo.AccountEmployee ON dbo.vueAccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_2 ON 
                      dbo.AccountEmployee.AccountEmployeeId = AccountEMailNotificationPreference_2.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference ON dbo.AccountEmployee.AccountId = dbo.AccountEMailNotificationPreference.AccountId LEFT OUTER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployee.AccountId = dbo.AccountPreferences.AccountId
WHERE     (AccountEMailNotificationPreference_2.SystemEMailNotificationId = 58) AND (AccountEMailNotificationPreference_2.Enabled = 1) AND 
                      (dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = 57) AND (dbo.AccountEMailNotificationPreference.Enabled = 1) AND 
                      (dbo.AccountEmployee.EmployeeTypeId <> 2 OR
                      dbo.AccountEmployee.EmployeeTypeId IS NULL) AND (dbo.AccountEmployee.IsDeleted <> 1) AND (dbo.AccountEmployee.IsDisabled <> 1)'
GO
-- Create View vueTimesheetOverdueNotificationWithPreferenceForAdministrator
Print 'Create View vueTimesheetOverdueNotificationWithPreferenceForAdministrator'
GO
if not exists (select * from information_schema.tables where table_name = 'vueTimesheetOverdueNotificationWithPreferenceForAdministrator' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueTimesheetOverdueNotificationWithPreferenceForAdministrator
AS
SELECT     dbo.AccountPreferences.ScheduledEmailSendTime, dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, 
                      dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.AccountId, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, CASE WHEN dbo.AccountPreferences.CultureInfoName IS NULL OR
                      dbo.AccountPreferences.CultureInfoName = ''auto'' THEN ''en-us'' ELSE dbo.AccountPreferences.CultureInfoName END AS CultureInfoName, dbo.AccountRole.Role, 
                      ISNULL(dbo.vueAccountWorkingDayType.TimesheetOverdueAfterDays, 1) AS TimesheetOverdueAfterDays, 
                      ISNULL(dbo.vueAccountWorkingDayType.SystemTimesheetPeriodType, ''Weekly'') AS SystemTimesheetPeriodType, 
                      ISNULL(dbo.vueAccountWorkingDayType.WeekStartDay, 1) AS WeekStartDay, ISNULL(dbo.vueAccountWorkingDayType.SystemInitialDayOfFirstPeriod, 1) 
                      AS SystemInitialDayOfFirstPeriod, ISNULL(dbo.vueAccountWorkingDayType.SystemInitialDayOfLastPeriod, 16) AS SystemInitialDayOfLastPeriod, 
                      ISNULL(dbo.vueAccountWorkingDayType.InitialDayOfTheMonth, 1) AS InitialDayOfTheMonth
FROM         dbo.vueAccountWorkingDayType INNER JOIN
                      dbo.AccountEmployee ON dbo.vueAccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_2 ON 
                      dbo.AccountEmployee.AccountEmployeeId = AccountEMailNotificationPreference_2.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference ON dbo.AccountEmployee.AccountId = dbo.AccountEMailNotificationPreference.AccountId LEFT OUTER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployee.AccountId = dbo.AccountPreferences.AccountId
WHERE     (AccountEMailNotificationPreference_2.SystemEMailNotificationId = 62) AND (AccountEMailNotificationPreference_2.Enabled = 1) AND 
                      (dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = 61) AND (dbo.AccountEMailNotificationPreference.Enabled = 1) AND 
                      (dbo.AccountEmployee.EmployeeTypeId <> 2 OR
                      dbo.AccountEmployee.EmployeeTypeId IS NULL) AND (dbo.AccountEmployee.IsDeleted <> 1) AND (dbo.AccountRole.MasterAccountRoleId = 1)'
GO
-- Create View vueTimesheetOverdueNotificationWithPreferenceForTeamLead
Print 'Create View vueTimesheetOverdueNotificationWithPreferenceForTeamLead'
GO
if not exists (select * from information_schema.tables where table_name = 'vueTimesheetOverdueNotificationWithPreferenceForTeamLead' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueTimesheetOverdueNotificationWithPreferenceForTeamLead
AS
SELECT     dbo.AccountPreferences.ScheduledEmailSendTime, MAX(dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName) AS EmployeeName, 
                      dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.AccountId, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, CASE WHEN MAX(dbo.AccountPreferences.CultureInfoName) IS NULL OR
                      MAX(dbo.AccountPreferences.CultureInfoName) = ''auto'' THEN ''en-us'' ELSE MAX(dbo.AccountPreferences.CultureInfoName) END AS CultureInfoName, 
                      ISNULL(MAX(dbo.vueAccountWorkingDayType.TimesheetOverdueAfterDays), 1) AS TimesheetOverdueAfterDays, 
                      ISNULL(MAX(dbo.vueAccountWorkingDayType.SystemTimesheetPeriodType), ''Weekly'') AS SystemTimesheetPeriodType, 
                      ISNULL(MAX(dbo.vueAccountWorkingDayType.WeekStartDay), 1) AS WeekStartDay, ISNULL(MAX(dbo.vueAccountWorkingDayType.SystemInitialDayOfFirstPeriod), 1) 
                      AS SystemInitialDayOfFirstPeriod, ISNULL(MAX(dbo.vueAccountWorkingDayType.SystemInitialDayOfLastPeriod), 16) AS SystemInitialDayOfLastPeriod, 
                      ISNULL(MAX(dbo.vueAccountWorkingDayType.InitialDayOfTheMonth), 1) AS InitialDayOfTheMonth
FROM         dbo.vueAccountWorkingDayType INNER JOIN
                      dbo.AccountEmployee ON dbo.vueAccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId INNER JOIN
                      dbo.AccountProject ON dbo.AccountEmployee.AccountEmployeeId = dbo.AccountProject.ProjectManagerEmployeeId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_2 ON 
                      dbo.AccountEmployee.AccountEmployeeId = AccountEMailNotificationPreference_2.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference ON dbo.AccountEmployee.AccountId = dbo.AccountEMailNotificationPreference.AccountId LEFT OUTER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployee.AccountId = dbo.AccountPreferences.AccountId
WHERE     (AccountEMailNotificationPreference_2.SystemEMailNotificationId = 68) AND (AccountEMailNotificationPreference_2.Enabled = 1) AND 
                      (dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = 67) AND (dbo.AccountEMailNotificationPreference.Enabled = 1) AND 
                      (dbo.AccountEmployee.EmployeeTypeId <> 2 OR
                      dbo.AccountEmployee.EmployeeTypeId IS NULL) AND (dbo.AccountEmployee.IsDeleted <> 1) AND (dbo.AccountEmployee.IsDisabled <> 1)
GROUP BY dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.AccountId, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountPreferences.ScheduledEmailSendTime'
GO
-- Create View vueTimesheetOverdueNotificationWithPreferenceForProjectManager
Print 'Create View vueTimesheetOverdueNotificationWithPreferenceForProjectManager'
GO
if not exists (select * from information_schema.tables where table_name = 'vueTimesheetOverdueNotificationWithPreferenceForProjectManager' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueTimesheetOverdueNotificationWithPreferenceForProjectManager
AS
SELECT     dbo.AccountPreferences.ScheduledEmailSendTime, MAX(dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName) AS EmployeeName, 
                      dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.AccountId, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, CASE WHEN MAX(dbo.AccountPreferences.CultureInfoName) IS NULL OR
                      MAX(dbo.AccountPreferences.CultureInfoName) = ''auto'' THEN ''en-us'' ELSE MAX(dbo.AccountPreferences.CultureInfoName) END AS CultureInfoName, 
                      ISNULL(MAX(dbo.vueAccountWorkingDayType.TimesheetOverdueAfterDays), 1) AS TimesheetOverdueAfterDays, 
                      ISNULL(MAX(dbo.vueAccountWorkingDayType.SystemTimesheetPeriodType), ''Weekly'') AS SystemTimesheetPeriodType, 
                      ISNULL(MAX(dbo.vueAccountWorkingDayType.WeekStartDay), 1) AS WeekStartDay, ISNULL(MAX(dbo.vueAccountWorkingDayType.SystemInitialDayOfFirstPeriod), 1) 
                      AS SystemInitialDayOfFirstPeriod, ISNULL(MAX(dbo.vueAccountWorkingDayType.SystemInitialDayOfLastPeriod), 16) AS SystemInitialDayOfLastPeriod, 
                      ISNULL(MAX(dbo.vueAccountWorkingDayType.InitialDayOfTheMonth), 1) AS InitialDayOfTheMonth
FROM         dbo.vueAccountWorkingDayType INNER JOIN
                      dbo.AccountEmployee ON dbo.vueAccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId INNER JOIN
                      dbo.AccountProject ON dbo.AccountEmployee.AccountEmployeeId = dbo.AccountProject.ProjectManagerEmployeeId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_2 ON 
                      dbo.AccountEmployee.AccountEmployeeId = AccountEMailNotificationPreference_2.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference ON dbo.AccountEmployee.AccountId = dbo.AccountEMailNotificationPreference.AccountId LEFT OUTER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployee.AccountId = dbo.AccountPreferences.AccountId
WHERE     (AccountEMailNotificationPreference_2.SystemEMailNotificationId = 66) AND (AccountEMailNotificationPreference_2.Enabled = 1) AND 
                      (dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = 65) AND (dbo.AccountEMailNotificationPreference.Enabled = 1) AND 
                      (dbo.AccountEmployee.EmployeeTypeId <> 2 OR
                      dbo.AccountEmployee.EmployeeTypeId IS NULL) AND (dbo.AccountEmployee.IsDeleted <> 1) AND (dbo.AccountEmployee.IsDisabled <> 1)
GROUP BY dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.AccountId, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountPreferences.ScheduledEmailSendTime'
GO
-- Create View vueTimesheetOverdueNotificationWithPreferenceForEmployeeManager
Print 'Create View vueTimesheetOverdueNotificationWithPreferenceForEmployeeManager'
GO
if not exists (select * from information_schema.tables where table_name = 'vueTimesheetOverdueNotificationWithPreferenceForEmployeeManager' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueTimesheetOverdueNotificationWithPreferenceForEmployeeManager
AS
SELECT     dbo.AccountPreferences.ScheduledEmailSendTime, MAX(AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName) AS EmployeeName, 
                      dbo.AccountEmployee.AccountId, CASE WHEN MAX(dbo.AccountPreferences.CultureInfoName) IS NULL OR
                      MAX(dbo.AccountPreferences.CultureInfoName) = ''auto'' THEN ''en-us'' ELSE MAX(dbo.AccountPreferences.CultureInfoName) END AS CultureInfoName, 
                      ISNULL(MAX(dbo.vueAccountWorkingDayType.TimesheetOverdueAfterDays), 1) AS TimesheetOverdueAfterDays, AccountEmployee_1.AccountEmployeeId, 
                      AccountEmployee_1.EMailAddress, AccountEmployee_1.LastScheduledEmailSentTime, ISNULL(MAX(dbo.vueAccountWorkingDayType.SystemTimesheetPeriodType), 
                      ''Weekly'') AS SystemTimesheetPeriodType, ISNULL(MAX(dbo.vueAccountWorkingDayType.WeekStartDay), 1) AS WeekStartDay, 
                      ISNULL(MAX(dbo.vueAccountWorkingDayType.SystemInitialDayOfFirstPeriod), 1) AS SystemInitialDayOfFirstPeriod, 
                      ISNULL(MAX(dbo.vueAccountWorkingDayType.SystemInitialDayOfLastPeriod), 16) AS SystemInitialDayOfLastPeriod, 
                      ISNULL(MAX(dbo.vueAccountWorkingDayType.InitialDayOfTheMonth), 1) AS InitialDayOfTheMonth
FROM         dbo.AccountEmployee INNER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON dbo.AccountEmployee.EmployeeManagerId = AccountEmployee_1.AccountEmployeeId INNER JOIN
                      dbo.vueAccountWorkingDayType ON 
                      dbo.AccountEmployee.AccountWorkingDayTypeId = dbo.vueAccountWorkingDayType.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_2 ON 
                      dbo.AccountEmployee.EmployeeManagerId = AccountEMailNotificationPreference_2.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference ON dbo.AccountEmployee.AccountId = dbo.AccountEMailNotificationPreference.AccountId LEFT OUTER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployee.AccountId = dbo.AccountPreferences.AccountId
WHERE     (AccountEMailNotificationPreference_2.SystemEMailNotificationId = 64) AND (AccountEMailNotificationPreference_2.Enabled = 1) AND 
                      (dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = 63) AND (dbo.AccountEMailNotificationPreference.Enabled = 1) AND 
                      (dbo.AccountEmployee.IsDeleted <> 1) AND (dbo.AccountEmployee.EmployeeTypeId <> 2 OR
                      dbo.AccountEmployee.EmployeeTypeId IS NULL)
GROUP BY dbo.AccountPreferences.ScheduledEmailSendTime, dbo.AccountEmployee.AccountId, AccountEmployee_1.AccountEmployeeId, AccountEmployee_1.EMailAddress, 
                      AccountEmployee_1.LastScheduledEmailSentTime'
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemEMailNotification]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemEMailNotification]'
IF NOT EXISTS(Select * from [SystemEMailNotification] WHERE [SystemEMailNotificationId] = 57)
BEGIN
INSERT INTO [dbo].[SystemEMailNotification] ([SystemEMailNotificationId], [SystemEMailNotification], [SystemEMailNotificationTypeId], [Enabled], [IsWeekDayAllow]) VALUES (57, N'Timesheet Due Notification', 1, 1, NULL)
INSERT INTO [dbo].[SystemEMailNotification] ([SystemEMailNotificationId], [SystemEMailNotification], [SystemEMailNotificationTypeId], [Enabled], [IsWeekDayAllow]) VALUES (58, N'Timesheet Due Notification', 3, 1, NULL)
INSERT INTO [dbo].[SystemEMailNotification] ([SystemEMailNotificationId], [SystemEMailNotification], [SystemEMailNotificationTypeId], [Enabled], [IsWeekDayAllow]) VALUES (59, N'Timesheet Overdue Notification', 1, 1, NULL)
INSERT INTO [dbo].[SystemEMailNotification] ([SystemEMailNotificationId], [SystemEMailNotification], [SystemEMailNotificationTypeId], [Enabled], [IsWeekDayAllow]) VALUES (60, N'Timesheet Overdue Notification', 3, 1, NULL)
INSERT INTO [dbo].[SystemEMailNotification] ([SystemEMailNotificationId], [SystemEMailNotification], [SystemEMailNotificationTypeId], [Enabled], [IsWeekDayAllow]) VALUES (61, N'Timesheet Overdue Notification To Administrator', 1, 1, NULL)
INSERT INTO [dbo].[SystemEMailNotification] ([SystemEMailNotificationId], [SystemEMailNotification], [SystemEMailNotificationTypeId], [Enabled], [IsWeekDayAllow]) VALUES (62, N'Timesheet Overdue Notification To Administrator', 3, 1, NULL)
INSERT INTO [dbo].[SystemEMailNotification] ([SystemEMailNotificationId], [SystemEMailNotification], [SystemEMailNotificationTypeId], [Enabled], [IsWeekDayAllow]) VALUES (63, N'Timesheet Overdue Notification To Employee Manager', 1, 1, NULL)
INSERT INTO [dbo].[SystemEMailNotification] ([SystemEMailNotificationId], [SystemEMailNotification], [SystemEMailNotificationTypeId], [Enabled], [IsWeekDayAllow]) VALUES (64, N'Timesheet Overdue Notification To Employee Manager', 3, 1, NULL)
INSERT INTO [dbo].[SystemEMailNotification] ([SystemEMailNotificationId], [SystemEMailNotification], [SystemEMailNotificationTypeId], [Enabled], [IsWeekDayAllow]) VALUES (65, N'Timesheet Overdue Notification To Project Manager', 1, 1, NULL)
INSERT INTO [dbo].[SystemEMailNotification] ([SystemEMailNotificationId], [SystemEMailNotification], [SystemEMailNotificationTypeId], [Enabled], [IsWeekDayAllow]) VALUES (66, N'Timesheet Overdue Notification To Project Manager', 3, 1, NULL)
INSERT INTO [dbo].[SystemEMailNotification] ([SystemEMailNotificationId], [SystemEMailNotification], [SystemEMailNotificationTypeId], [Enabled], [IsWeekDayAllow]) VALUES (67, N'Timesheet Overdue Notification To Team Lead', 1, 1, NULL)
INSERT INTO [dbo].[SystemEMailNotification] ([SystemEMailNotificationId], [SystemEMailNotification], [SystemEMailNotificationTypeId], [Enabled], [IsWeekDayAllow]) VALUES (68, N'Timesheet Overdue Notification To Team Lead', 3, 1, NULL)
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemEMailNotification]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemEMailNotification]'

UPDATE [dbo].[SystemEMailNotification] SET [SystemEMailNotification]=N'Daily TimeEntry Notification' WHERE [SystemEMailNotificationId]=29
UPDATE [dbo].[SystemEMailNotification] SET [SystemEMailNotification]=N'Daily TimeEntry Notification' WHERE [SystemEMailNotificationId]=30
UPDATE [dbo].[SystemEMailNotification] SET [SystemEMailNotification]=N'Daily TimeEntry Notification To Employee Manager' WHERE [SystemEMailNotificationId]=31
UPDATE [dbo].[SystemEMailNotification] SET [SystemEMailNotification]=N'Daily TimeEntry Notification To Employee Manager' WHERE [SystemEMailNotificationId]=32
UPDATE [dbo].[SystemEMailNotification] SET [SystemEMailNotification]=N'Daily TimeEntry Notification To Administrator' WHERE [SystemEMailNotificationId]=33
UPDATE [dbo].[SystemEMailNotification] SET [SystemEMailNotification]=N'Daily TimeEntry Notification To Administrator' WHERE [SystemEMailNotificationId]=34
UPDATE [dbo].[SystemEMailNotification] SET [SystemEMailNotification]=N'Daily TimeEntry Notification To Project Manager' WHERE [SystemEMailNotificationId]=35
UPDATE [dbo].[SystemEMailNotification] SET [SystemEMailNotification]=N'Daily TimeEntry Notification To Project Manager' WHERE [SystemEMailNotificationId]=36
UPDATE [dbo].[SystemEMailNotification] SET [SystemEMailNotification]=N'Daily TimeEntry Notification To Team Lead' WHERE [SystemEMailNotificationId]=37
UPDATE [dbo].[SystemEMailNotification] SET [SystemEMailNotification]=N'Daily TimeEntry Notification To Team Lead' WHERE [SystemEMailNotificationId]=38
GO
-- Drop View vueTimesheetSummaryPendingApprovalForEmailWithPreference
Print 'Drop View vueTimesheetSummaryPendingApprovalForEmailWithPreference'
GO
if exists (select * from information_schema.tables where table_name = 'vueTimesheetSummaryPendingApprovalForEmailWithPreference' and table_type = 'VIEW')
DROP VIEW [dbo].[vueTimesheetSummaryPendingApprovalForEmailWithPreference]

GO
-- Create View vueTimesheetSummaryPendingApprovalForEmailWithPreference
Print 'Create View vueTimesheetSummaryPendingApprovalForEmailWithPreference'
GO
if not exists (select * from information_schema.tables where table_name = 'vueTimesheetSummaryPendingApprovalForEmailWithPreference' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueTimesheetSummaryPendingApprovalForEmailWithPreference
AS
SELECT     dbo.vueTimesheetSummaryPendingApprovalForEmail.AccountEmployeeTimeEntryPeriodId, 
                      dbo.vueTimesheetSummaryPendingApprovalForEmail.TimeEntryAccountEmployeeId, dbo.vueTimesheetSummaryPendingApprovalForEmail.TimeEntryStartDate, 
                      dbo.vueTimesheetSummaryPendingApprovalForEmail.TimeEntryEndDate, dbo.vueTimesheetSummaryPendingApprovalForEmail.TimeEntryViewType, 
                      dbo.vueTimesheetSummaryPendingApprovalForEmail.EmployeeName, dbo.vueTimesheetSummaryPendingApprovalForEmail.TotalMinutes, 
                      dbo.vueTimesheetSummaryPendingApprovalForEmail.TimeEntryDate, dbo.vueTimesheetSummaryPendingApprovalForEmail.BillableTotalMinutes, 
                      dbo.vueTimesheetSummaryPendingApprovalForEmail.NonBillableTotalMinutes, dbo.vueTimesheetSummaryPendingApprovalForEmail.EMailAddress, 
                      dbo.vueTimesheetSummaryPendingApprovalForEmail.AccountProjectId, dbo.vueTimesheetSummaryPendingApprovalForEmail.ApproverEmployeeId, 
                      dbo.vueTimesheetSummaryPendingApprovalForEmail.ApproverEmployeeName, dbo.vueTimesheetSummaryPendingApprovalForEmail.ApproverEMailAddress, 
                      dbo.vueTimesheetSummaryPendingApprovalForEmail.CultureInfoName, 
                      dbo.vueTimesheetSummaryPendingApprovalForEmail.AccountEmployeeTimeEntryApprovalProjectId, 
                      dbo.vueTimesheetSummaryPendingApprovalForEmail.SubmittedDate, dbo.vueTimesheetSummaryPendingApprovalForEmail.AccountId, 
                      dbo.vueTimesheetSummaryPendingApprovalForEmail.IsEmailSend, dbo.vueTimesheetSummaryPendingApprovalForEmail.Submitted, 
                      dbo.vueTimesheetSummaryPendingApprovalForEmail.Approved, dbo.vueTimesheetSummaryPendingApprovalForEmail.Rejected
FROM         dbo.vueTimesheetSummaryPendingApprovalForEmail INNER JOIN
                      dbo.AccountEMailNotificationPreference ON 
                      dbo.vueTimesheetSummaryPendingApprovalForEmail.AccountId = dbo.AccountEMailNotificationPreference.AccountId INNER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_1 ON 
                      dbo.vueTimesheetSummaryPendingApprovalForEmail.ApproverEmployeeId = AccountEMailNotificationPreference_1.AccountEmployeeId
WHERE     (dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = 45) AND (dbo.AccountEMailNotificationPreference.Enabled = 1) AND 
                      (AccountEMailNotificationPreference_1.SystemEMailNotificationId = 46) AND (AccountEMailNotificationPreference_1.Enabled = 1)'
GO
-- Drop View vueAccountExpenseEntryApprovalPendingEmailInstant
Print 'Drop View vueAccountExpenseEntryApprovalPendingEmailInstant'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryApprovalPendingEmailInstant' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountExpenseEntryApprovalPendingEmailInstant]

GO
-- Create View vueAccountExpenseEntryApprovalPendingEmailInstant
Print 'Create View vueAccountExpenseEntryApprovalPendingEmailInstant'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryApprovalPendingEmailInstant' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountExpenseEntryApprovalPendingEmailInstant
AS
SELECT     dbo.vueAccountExpenseEntryApprovalPendingSummary.AccountProjectId, dbo.vueAccountExpenseEntryApprovalPendingSummary.EmployeeName, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.Amount, dbo.vueAccountExpenseEntryApprovalPendingSummary.ExpenseEntryAccountEmployeeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.AccountEmployeeExpenseSheetId, dbo.vueAccountExpenseEntryApprovalPendingSummary.Description, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.ExpenseSheetDate, dbo.vueAccountExpenseEntryApprovalPendingSummary.LeaderEmployeeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.ProjectManagerEmployeeId, dbo.vueAccountExpenseEntryApprovalPendingSummary.AccountExternalUserId, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.ApprovalPathSequence, dbo.vueAccountExpenseEntryApprovalPendingSummary.AccountEmployeeId, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.IsRejected, dbo.vueAccountExpenseEntryApprovalPendingSummary.IsApproved, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.ExpenseApprovalId, dbo.vueAccountExpenseEntryApprovalPendingSummary.Approved, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.Rejected, dbo.vueAccountExpenseEntryApprovalPendingSummary.Submitted, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.ApproverEmployeeId, dbo.vueAccountExpenseEntryApprovalPendingSummary.EmployeeManagerId, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.EMailAddress, dbo.vueAccountExpenseEntryApprovalPendingSummary.AccountId, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.SystemApproverTypeId, dbo.vueAccountExpenseEntryApprovalPendingSummary.AccountApprovalPathId, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.BaseCurrencyCode, dbo.vueAccountExpenseEntryApprovalPendingSummary.SubmittedDate, 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.IsEmailSend
FROM         dbo.vueAccountExpenseEntryApprovalPendingSummary INNER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_1 ON 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.ApproverEmployeeId = AccountEMailNotificationPreference_1.AccountEmployeeId INNER JOIN
                      dbo.AccountEMailNotificationPreference ON 
                      dbo.vueAccountExpenseEntryApprovalPendingSummary.AccountId = dbo.AccountEMailNotificationPreference.AccountId
WHERE     (dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = 47) AND (dbo.AccountEMailNotificationPreference.Enabled = 1) AND 
                      (AccountEMailNotificationPreference_1.SystemEMailNotificationId = 48) AND (AccountEMailNotificationPreference_1.Enabled = 1)'

GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'
If exists(Select * from SystemReportDataSourceField where SystemReportDataSourceFieldId = '118825f5-2694-4981-9b65-714e388e4030')
BEGIN
Update AccountReportColumn 
Set systemreportdatasourcefieldid = 'E904A47E-CB52-4434-818B-1E1B90206707' 
Where Systemreportdatasourcefieldid = '118825F5-2694-4981-9B65-714E388E4030'
Update AccountReportColumn 
Set systemreportdatasourcefieldid = '72435AEC-8FF6-455D-919F-39F3543F1B5D' 
Where Systemreportdatasourcefieldid = 'EBB345FB-0B30-4698-987E-A60BEF00AF32'
DELETE FROM [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId]='118825f5-2694-4981-9b65-714e388e4030'
DELETE FROM [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId]='ebb345fb-0b30-4698-987e-a60bef00af32'
END

GO

-- Drop View rptvueAccountProjectTeam
Print 'Drop View rptvueAccountProjectTeam'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectTeam' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountProjectTeam]

GO
-- Drop View vueAccountProjectTeamForReport
Print 'Drop View vueAccountProjectTeamForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountProjectTeamForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountProjectTeamForReport]

GO
-- Create View vueAccountProjectTeamForReport
Print 'Create View vueAccountProjectTeamForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountProjectTeamForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountProjectTeamForReport
AS
SELECT     dbo.AccountProjectEmployee.AccountProjectEmployeeId, dbo.AccountProjectEmployee.AccountId, dbo.AccountProjectEmployee.AccountProjectId, 
                      dbo.AccountProjectEmployee.AccountEmployeeId, dbo.AccountProjectEmployee.AccountRoleId, dbo.AccountProjectEmployee.AccountBillingRateId, 
                      dbo.AccountProjectEmployee.AccountProjectEmployeeTemplateId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, 
                      dbo.AccountProject.AccountClientId, dbo.AccountProject.ProjectName, dbo.AccountBillingType.BillingType AS ProjectBillingType, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountLocation.AccountLocation, dbo.AccountRole.Role, dbo.AccountEmployeeType.AccountEmployeeType, 
                      dbo.AccountParty.PartyName AS ClientName, dbo.AccountStatus.Status AS ProjectStatus, AccountStatus_1.Status AS EmployeeStatus, 
                      dbo.AccountWorkingDayType.AccountWorkingDayType, dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.MinimumHoursPerDay, 
                      dbo.AccountWorkingDayType.MaximumHoursPerDay, dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, 
                      dbo.AccountTimeOffPolicy.AccountTimeOffPolicy, AccountApprovalType_1.ApprovalTypeName AS TimeOffApprovalTypeName, 
                      dbo.AccountHolidayType.AccountHolidayType, AccountApprovalType_2.ApprovalTypeName AS ExpenseApprovalTypeName, 
                      dbo.AccountApprovalType.ApprovalTypeName AS TimesheetApprovalTypeName, dbo.AccountPartyContact.FirstName AS ClientContactFirstName, 
                      dbo.AccountPartyContact.LastName AS ClientContactLastName, dbo.AccountPartyDepartment.PartyDepartmentCode AS ClientDepartmentCode, 
                      dbo.AccountPartyDepartment.PartyDepartmentName AS ClientDepartmentName, dbo.AccountPartyDepartment.PartyDepartmentLocation AS ClientDepartmentLocation, 
                      dbo.AccountProject.ProjectStatusId, dbo.AccountProjectType.ProjectType, dbo.AccountProject.AccountProjectTypeId, dbo.AccountProject.ProjectDescription, 
                      dbo.AccountProject.StartDate AS ProjectStartDate, dbo.AccountProject.Deadline, dbo.AccountProject.EstimatedTime, dbo.AccountProject.EstimatedDuration, 
                      dbo.AccountProject.EstimatedDurationUnit, dbo.AccountProject.ProjectCode, dbo.AccountProject.DefaultBillingRate AS ProjectBillingRate, 
                      dbo.AccountProject.Completed, dbo.AccountProject.IsDisabled AS IsDisabledProject, dbo.AccountProject.IsDeleted AS IsDeletedProject, 
                      dbo.AccountParty.PartyNick AS ClientNick, dbo.AccountParty.EMailAddress AS ClientEMailAddress, dbo.AccountParty.Address1 AS ClientAddress1, 
                      dbo.AccountParty.Address2 AS ClientAddress2, dbo.AccountParty.State AS ClientState, dbo.AccountParty.City AS ClientCity, 
                      dbo.AccountParty.ZipCode AS ClientZipCode, dbo.AccountParty.Telephone1 AS ClientTelephone1, dbo.AccountParty.Telephone2 AS ClientTelephone2, 
                      dbo.AccountParty.Fax AS ClientFax, dbo.AccountEmployee.State AS EmployeeState, dbo.AccountEmployee.City AS EmployeeCity, 
                      dbo.AccountEmployee.Zip AS EmployeeZip, dbo.AccountEmployee.WorkPhoneNo AS EmployeeWorkPhoneNo, dbo.AccountEmployee.TerminationDate, 
                      dbo.AccountEmployee.EmployeeCode, dbo.AccountEmployee.HiredDate, dbo.AccountBillingRate.BillingRate, dbo.AccountBillingRate.StartDate AS BillingRateStartDate,
                       dbo.AccountBillingRate.EndDate AS BillingRateEndDate, dbo.AccountBillingRate.EmployeeRate, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, SUM(DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, 
                      dbo.AccountEmployeeTimeEntry.TotalTime)) AS TotalMinutes
FROM         dbo.AccountProjectEmployee INNER JOIN
                      dbo.AccountProject ON dbo.AccountProjectEmployee.AccountProjectId = dbo.AccountProject.AccountProjectId INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountProjectEmployee.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId INNER JOIN
                      dbo.AccountBillingType ON dbo.AccountProject.ProjectBillingTypeId = dbo.AccountBillingType.AccountBillingTypeId INNER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId INNER JOIN
                      dbo.AccountStatus ON dbo.AccountProject.ProjectStatusId = dbo.AccountStatus.AccountStatusId INNER JOIN
                      dbo.AccountApprovalType ON dbo.AccountProject.TimeSheetApprovalTypeId = dbo.AccountApprovalType.AccountApprovalTypeId INNER JOIN
                      dbo.AccountApprovalType AS AccountApprovalType_2 ON dbo.AccountProject.ExpenseApprovalTypeId = AccountApprovalType_2.AccountApprovalTypeId INNER JOIN
                      dbo.AccountProjectType ON dbo.AccountProject.AccountProjectTypeId = dbo.AccountProjectType.AccountProjectTypeId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntry ON dbo.AccountEmployee.AccountEmployeeId = dbo.AccountEmployeeTimeEntry.AccountEmployeeId AND 
                      dbo.AccountProject.AccountProjectId = dbo.AccountEmployeeTimeEntry.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountBillingRate ON dbo.AccountProjectEmployee.AccountBillingRateId = dbo.AccountBillingRate.AccountBillingRateId LEFT OUTER JOIN
                      dbo.AccountPartyDepartment ON dbo.AccountProject.AccountPartyDepartmentId = dbo.AccountPartyDepartment.AccountPartyDepartmentId LEFT OUTER JOIN
                      dbo.AccountPartyContact ON dbo.AccountProject.AccountPartyContactId = dbo.AccountPartyContact.AccountPartyContactId LEFT OUTER JOIN
                      dbo.AccountApprovalType AS AccountApprovalType_1 ON 
                      dbo.AccountEmployee.TimeOffApprovalTypeId = AccountApprovalType_1.AccountApprovalTypeId LEFT OUTER JOIN
                      dbo.AccountHolidayType ON dbo.AccountEmployee.AccountHolidayTypeId = dbo.AccountHolidayType.AccountHolidayTypeId LEFT OUTER JOIN
                      dbo.AccountWorkingDayType ON dbo.AccountEmployee.AccountWorkingDayTypeId = dbo.AccountWorkingDayType.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountTimeOffPolicy ON dbo.AccountEmployee.AccountTimeOffPolicyId = dbo.AccountTimeOffPolicy.AccountTimeOffPolicyId LEFT OUTER JOIN
                      dbo.AccountStatus AS AccountStatus_1 ON dbo.AccountEmployee.StatusId = AccountStatus_1.AccountStatusId LEFT OUTER JOIN
                      dbo.AccountEmployeeType ON dbo.AccountEmployee.EmployeePayTypeId = dbo.AccountEmployeeType.AccountEmployeeTypeId LEFT OUTER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId
GROUP BY dbo.AccountProjectEmployee.AccountProjectEmployeeId, dbo.AccountProjectEmployee.AccountId, dbo.AccountProjectEmployee.AccountProjectId, 
                      dbo.AccountProjectEmployee.AccountEmployeeId, dbo.AccountProjectEmployee.AccountRoleId, dbo.AccountProjectEmployee.AccountBillingRateId, 
                      dbo.AccountProjectEmployee.AccountProjectEmployeeTemplateId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, 
                      dbo.AccountProject.AccountClientId, dbo.AccountProject.ProjectName, dbo.AccountBillingType.BillingType, dbo.AccountDepartment.DepartmentName, 
                      dbo.AccountLocation.AccountLocation, dbo.AccountRole.Role, dbo.AccountEmployeeType.AccountEmployeeType, dbo.AccountParty.PartyName, 
                      dbo.AccountStatus.Status, AccountStatus_1.Status, dbo.AccountWorkingDayType.AccountWorkingDayType, dbo.AccountWorkingDayType.HoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, dbo.AccountWorkingDayType.MinimumHoursPerWeek, 
                      dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountTimeOffPolicy.AccountTimeOffPolicy, AccountApprovalType_1.ApprovalTypeName, 
                      dbo.AccountHolidayType.AccountHolidayType, AccountApprovalType_2.ApprovalTypeName, dbo.AccountApprovalType.ApprovalTypeName, 
                      dbo.AccountPartyContact.FirstName, dbo.AccountPartyContact.LastName, dbo.AccountPartyDepartment.PartyDepartmentCode, 
                      dbo.AccountPartyDepartment.PartyDepartmentName, dbo.AccountPartyDepartment.PartyDepartmentLocation, dbo.AccountProject.ProjectStatusId, 
                      dbo.AccountProjectType.ProjectType, dbo.AccountProject.AccountProjectTypeId, dbo.AccountProject.ProjectDescription, dbo.AccountProject.StartDate, 
                      dbo.AccountProject.Deadline, dbo.AccountProject.EstimatedTime, dbo.AccountProject.EstimatedDuration, dbo.AccountProject.EstimatedDurationUnit, 
                      dbo.AccountProject.ProjectCode, dbo.AccountProject.DefaultBillingRate, dbo.AccountProject.Completed, dbo.AccountProject.IsDisabled, dbo.AccountProject.IsDeleted, 
                      dbo.AccountParty.PartyNick, dbo.AccountParty.EMailAddress, dbo.AccountParty.Address1, dbo.AccountParty.Address2, dbo.AccountParty.State, dbo.AccountParty.City, 
                      dbo.AccountParty.ZipCode, dbo.AccountParty.Telephone1, dbo.AccountParty.Telephone2, dbo.AccountParty.Fax, dbo.AccountEmployee.State, 
                      dbo.AccountEmployee.City, dbo.AccountEmployee.Zip, dbo.AccountEmployee.WorkPhoneNo, dbo.AccountEmployee.TerminationDate, 
                      dbo.AccountEmployee.EmployeeCode, dbo.AccountEmployee.HiredDate, dbo.AccountBillingRate.BillingRate, dbo.AccountBillingRate.StartDate, 
                      dbo.AccountBillingRate.EndDate, dbo.AccountBillingRate.EmployeeRate, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END'

GO
-- Create View rptvueAccountProjectTeam
Print 'Create View rptvueAccountProjectTeam'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectTeam' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountProjectTeam
AS
SELECT     AccountProjectEmployeeId, AccountId, AccountProjectId, AccountEmployeeId, AccountRoleId, AccountBillingRateId, AccountProjectEmployeeTemplateId, FirstName, 
                      LastName, AccountClientId, ProjectName, ProjectBillingType, DepartmentName, AccountLocation, Role, AccountEmployeeType, ClientName, ProjectStatus, 
                      EmployeeStatus, AccountWorkingDayType, HoursPerDay, MinimumHoursPerDay, MaximumHoursPerDay, MinimumHoursPerWeek, MaximumHoursPerWeek, 
                      AccountTimeOffPolicy, TimeOffApprovalTypeName, AccountHolidayType, ExpenseApprovalTypeName, TimesheetApprovalTypeName, ClientContactFirstName, 
                      ClientContactLastName, ClientDepartmentCode, ClientDepartmentName, ClientDepartmentLocation, ProjectStatusId, ProjectType, AccountProjectTypeId, 
                      ProjectDescription, ProjectStartDate, Deadline, EstimatedTime, EstimatedDuration, EstimatedDurationUnit, ProjectCode, ProjectBillingRate, Completed, 
                      IsDisabledProject, IsDeletedProject, ClientNick, ClientEMailAddress, ClientAddress1, ClientAddress2, ClientState, ClientCity, ClientZipCode, ClientTelephone1, 
                      ClientTelephone2, ClientFax, EmployeeState, EmployeeCity, EmployeeZip, EmployeeWorkPhoneNo, TerminationDate, EmployeeCode, HiredDate, BillingRate, 
                      BillingRateStartDate, BillingRateEndDate, EmployeeRate, EmployeeName, ROUND(CONVERT(float, TotalMinutes) / 60, 2) AS TotalHours, REPLACE(TotalMinutes / 60, 
                      '''', ''.00'') + '':'' + RIGHT(''0'' + REPLACE(TotalMinutes - TotalMinutes / 60 * 60, '''', ''.00''), 2) AS TotalTime
FROM         dbo.vueAccountProjectTeamForReport'

GO

-- Drop View rptvueAccountProjectTaskEmployee
Print 'Drop View rptvueAccountProjectTaskEmployee'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectTaskEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountProjectTaskEmployee]

GO
-- Drop View VueAccountProjectTaskEmployeeForReport
Print 'Drop View VueAccountProjectTaskEmployeeForReport'
GO
if exists (select * from information_schema.tables where table_name = 'VueAccountProjectTaskEmployeeForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[VueAccountProjectTaskEmployeeForReport]

GO
-- Create View VueAccountProjectTaskEmployeeForReport
Print 'Create View VueAccountProjectTaskEmployeeForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'VueAccountProjectTaskEmployeeForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.VueAccountProjectTaskEmployeeForReport
AS
SELECT     dbo.AccountProjectTaskEmployee.AccountProjectTaskEmployeeId, dbo.AccountProjectTaskEmployee.AccountId, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, dbo.AccountProjectTaskEmployee.AccountProjectTaskId, 
                      dbo.AccountProjectTaskEmployee.AccountEmployeeId, dbo.AccountProjectTask.AccountProjectId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, 
                      dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountEmployee.AccountTimeOffPolicyId, dbo.AccountEmployee.TimeOffApprovalTypeId, 
                      dbo.AccountEmployee.AccountHolidayTypeId, dbo.AccountParty.PartyName AS ClientName, dbo.AccountProjectTask.TaskName, 
                      dbo.AccountProjectTask.TaskDescription, dbo.AccountProjectTask.Duration AS TaskDuration, dbo.AccountProjectTask.DurationUnit AS TaskDurationUnit, 
                      dbo.AccountProjectTask.DeadlineDate AS TaskDeadlineDate, dbo.AccountProjectTask.Completed AS TaskCompleted, dbo.AccountProjectTask.IsParentTask, 
                      dbo.AccountProjectTask.IsForAllEmployees, dbo.AccountProjectTask.EstimatedCost AS TaskEmployeeCost, 
                      dbo.AccountProjectTask.EstimatedTimeSpent AS TaskEstimatedTimeSpent, dbo.AccountProjectTask.EstimatedTimeSpentUnit AS TaskEstimatedTimeSpentUnit, 
                      dbo.AccountProjectTask.TaskCode, dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.State, dbo.AccountEmployee.City, dbo.AccountEmployee.Zip, dbo.AccountEmployee.HomePhoneNo, dbo.AccountEmployee.WorkPhoneNo, 
                      dbo.AccountEmployee.MobilePhoneNo, dbo.AccountEmployee.BillingRateStateDate, dbo.AccountEmployee.TerminationDate, dbo.AccountEmployee.EmployeeCode, 
                      dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.HiredDate, dbo.AccountEmployeeType.AccountEmployeeType, 
                      dbo.AccountWorkingDayType.AccountWorkingDayType, dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, dbo.AccountWorkingDayType.MinimumHoursPerWeek, 
                      dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountTimeOffPolicy.AccountTimeOffPolicy, dbo.AccountProject.ProjectName, 
                      dbo.AccountProject.ProjectDescription, dbo.AccountProject.StartDate AS ProjectStartDate, dbo.AccountProject.Deadline AS ProjectDeadlineDate, 
                      dbo.AccountProject.EstimatedTime AS ProjectEstimatedTime, dbo.AccountProject.EstimatedDuration AS ProjectEstimatedDuration, 
                      dbo.AccountProject.EstimatedDurationUnit AS ProjectEstimatedDurationUnit, dbo.AccountProject.ProjectCode, dbo.AccountProject.Completed AS ProjectCompleted, 
                      dbo.AccountStatus.Status AS TaskStatus, dbo.AccountPriority.Priority, dbo.AccountProjectTask.AccountPriorityId, dbo.AccountProjectTask.TaskStatusId, 
                      dbo.AccountProjectTask.AccountTaskTypeId, dbo.AccountTaskType.TaskType, dbo.AccountBillingRate.BillingRate, 
                      dbo.AccountBillingRate.StartDate AS BillingRateStartDate, dbo.AccountBillingRate.EndDate AS BillingRateEndDate, dbo.AccountBillingRate.EmployeeRate, 
                      SUM(DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) AS TotalMinutes
FROM         dbo.AccountBillingRate INNER JOIN
                      dbo.AccountTaskType INNER JOIN
                      dbo.AccountProjectTaskEmployee INNER JOIN
                      dbo.AccountParty INNER JOIN
                      dbo.AccountProject ON dbo.AccountParty.AccountPartyId = dbo.AccountProject.AccountClientId INNER JOIN
                      dbo.AccountStatus INNER JOIN
                      dbo.AccountProjectTask ON dbo.AccountStatus.AccountStatusId = dbo.AccountProjectTask.TaskStatusId INNER JOIN
                      dbo.AccountPriority ON dbo.AccountProjectTask.AccountPriorityId = dbo.AccountPriority.AccountPriorityId ON 
                      dbo.AccountProject.AccountProjectId = dbo.AccountProjectTask.AccountProjectId ON 
                      dbo.AccountProjectTaskEmployee.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountProjectTaskEmployee.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId ON 
                      dbo.AccountTaskType.AccountTaskTypeId = dbo.AccountProjectTask.AccountTaskTypeId ON 
                      dbo.AccountBillingRate.AccountBillingRateId = dbo.AccountProjectTask.AccountBillingRateId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntry ON dbo.AccountProject.AccountProjectId = dbo.AccountEmployeeTimeEntry.AccountProjectId AND 
                      dbo.AccountProjectTask.AccountProjectTaskId = dbo.AccountEmployeeTimeEntry.AccountProjectTaskId AND 
                      dbo.AccountEmployee.AccountEmployeeId = dbo.AccountEmployeeTimeEntry.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployeeType ON dbo.AccountEmployee.EmployeePayTypeId = dbo.AccountEmployeeType.AccountEmployeeTypeId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountWorkingDayType ON dbo.AccountEmployee.AccountWorkingDayTypeId = dbo.AccountWorkingDayType.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountTimeOffPolicy ON dbo.AccountEmployee.AccountTimeOffPolicyId = dbo.AccountTimeOffPolicy.AccountTimeOffPolicyId
GROUP BY dbo.AccountProjectTaskEmployee.AccountProjectTaskEmployeeId, dbo.AccountProjectTaskEmployee.AccountId, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END, dbo.AccountProjectTaskEmployee.AccountProjectTaskId, dbo.AccountProjectTaskEmployee.AccountEmployeeId, 
                      dbo.AccountProjectTask.AccountProjectId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.AccountWorkingDayTypeId, 
                      dbo.AccountEmployee.AccountTimeOffPolicyId, dbo.AccountEmployee.TimeOffApprovalTypeId, dbo.AccountEmployee.AccountHolidayTypeId, 
                      dbo.AccountParty.PartyName, dbo.AccountProjectTask.TaskName, dbo.AccountProjectTask.TaskDescription, dbo.AccountProjectTask.Duration, 
                      dbo.AccountProjectTask.DurationUnit, dbo.AccountProjectTask.DeadlineDate, dbo.AccountProjectTask.Completed, dbo.AccountProjectTask.IsParentTask, 
                      dbo.AccountProjectTask.IsForAllEmployees, dbo.AccountProjectTask.EstimatedCost, dbo.AccountProjectTask.EstimatedTimeSpent, 
                      dbo.AccountProjectTask.EstimatedTimeSpentUnit, dbo.AccountProjectTask.TaskCode, dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, 
                      dbo.AccountLocation.AccountLocation, dbo.AccountEmployee.State, dbo.AccountEmployee.City, dbo.AccountEmployee.Zip, dbo.AccountEmployee.HomePhoneNo, 
                      dbo.AccountEmployee.WorkPhoneNo, dbo.AccountEmployee.MobilePhoneNo, dbo.AccountEmployee.BillingRateStateDate, dbo.AccountEmployee.TerminationDate, 
                      dbo.AccountEmployee.EmployeeCode, dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.HiredDate, dbo.AccountEmployeeType.AccountEmployeeType, 
                      dbo.AccountWorkingDayType.AccountWorkingDayType, dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, dbo.AccountWorkingDayType.MinimumHoursPerWeek, 
                      dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountTimeOffPolicy.AccountTimeOffPolicy, dbo.AccountProject.ProjectName, 
                      dbo.AccountProject.ProjectDescription, dbo.AccountProject.StartDate, dbo.AccountProject.Deadline, dbo.AccountProject.EstimatedTime, 
                      dbo.AccountProject.EstimatedDuration, dbo.AccountProject.EstimatedDurationUnit, dbo.AccountProject.ProjectCode, dbo.AccountProject.Completed, 
                      dbo.AccountStatus.Status, dbo.AccountPriority.Priority, dbo.AccountProjectTask.AccountPriorityId, dbo.AccountProjectTask.TaskStatusId, 
                      dbo.AccountProjectTask.AccountTaskTypeId, dbo.AccountTaskType.TaskType, dbo.AccountBillingRate.BillingRate, dbo.AccountBillingRate.StartDate, 
                      dbo.AccountBillingRate.EndDate, dbo.AccountBillingRate.EmployeeRate'

GO
-- Create View rptvueAccountProjectTaskEmployee
Print 'Create View rptvueAccountProjectTaskEmployee'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectTaskEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountProjectTaskEmployee
AS
SELECT     AccountProjectTaskEmployeeId, AccountProjectId, AccountProjectTaskId, TaskName, AccountEmployeeId, AccountId, TaskDescription, TaskCode, DepartmentName, 
                      AccountLocation, AccountEmployeeType, EmployeeCode, IsParentTask, IsForAllEmployees, EmployeeName, ClientName, TaskDuration, TaskDurationUnit, 
                      TaskDeadlineDate, TaskCompleted, TaskEmployeeCost, TaskEstimatedTimeSpent, TaskEstimatedTimeSpentUnit, Role, State, City, Zip, HomePhoneNo, 
                      WorkPhoneNo, MobilePhoneNo, BillingRateStateDate, TerminationDate, JobTitle, HiredDate, AccountWorkingDayType, HoursPerDay, WeekStartDay, 
                      MinimumHoursPerDay, MaximumHoursPerDay, MaximumHoursPerWeek, MinimumHoursPerWeek, AccountTimeOffPolicy, ProjectName, ProjectDescription, 
                      ProjectStartDate, ProjectDeadlineDate, ProjectEstimatedTime, ProjectEstimatedDuration, ProjectEstimatedDurationUnit, ProjectCode, ProjectCompleted, TaskStatus, 
                      Priority, AccountPriorityId, TaskStatusId, AccountTaskTypeId, TaskType, BillingRate, BillingRateStartDate, BillingRateEndDate, EmployeeRate, ROUND(CONVERT(float, 
                      TotalMinutes) / 60, 2) AS TotalHours, REPLACE(TotalMinutes / 60, '''', ''.00'') + '':'' + RIGHT(''0'' + REPLACE(TotalMinutes - TotalMinutes / 60 * 60, '''', ''.00''), 2) 
                      AS TotalTime
FROM         dbo.VueAccountProjectTaskEmployeeForReport'

If not exists(Select * from [dbo].[SystemReportDataSourceField] where [SystemReportDataSourceFieldId] = '0a0ed5cc-5934-480f-af8e-b4e25142652e')
BEGIN
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'

INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('0a0ed5cc-5934-480f-af8e-b4e25142652e', 'cde33c76-7289-4206-9822-b47690c8f314', N'TotalTime', 125, 0, NULL, NULL, 54, '4af62dd1-d310-48fc-ac2f-9694ee0bf323', N'Total Time Spent', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('e4c900e3-6a3c-4ef6-ab75-9cb0af447a09', 'cde33c76-7289-4206-9822-b47690c8f314', N'TotalHours', 100, 0, NULL, NULL, 53, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Total Hours Spent', 0, 0)

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'

INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('fb456f06-2357-45fd-8e3a-088fbd9153d9', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'FormulaField2', 125, 0, NULL, NULL, 97, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Formula Field 2', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('1a7bfd3b-a4bf-410f-8246-b88e963535c0', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'TotalTime', 100, 0, NULL, NULL, 40, '4af62dd1-d310-48fc-ac2f-9694ee0bf323', N'Total Time Spent', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('b54e8d56-26da-4ac0-921e-a98d940e8ffa', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'FormulaField1', 125, 0, NULL, NULL, 96, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Formula Field 1', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('7a73c5a6-d8ca-4eb0-8d5e-ef780b5e6563', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'FormulaField3', 125, 0, NULL, NULL, 98, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Formula Field 3', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('5a18ced5-f1b0-44c6-abd6-3aee98413c82', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'FormulaField4', 125, 0, NULL, NULL, 99, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Formula Field 4', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('fd5598f4-9ded-44d9-a8a9-d97607348988', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'TotalHours', 100, 0, NULL, NULL, 39, '4af62dd1-d310-48fc-ac2f-9694ee0bf323', N'Total Hours Spent', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('8e419fff-dc04-4258-9a67-ce7e51db16fe', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'FormulaField5', 125, 0, NULL, NULL, 100, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Formula Field 5', 0, 0)

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'

DELETE FROM [dbo].[SystemReportDataSourceField] WHERE [SystemReportDataSourceFieldId]='1f7b732d-3134-410f-90b0-219f675414e5'


-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'

UPDATE [dbo].[SystemReportDataSourceField] SET [SystemReportFieldTypeId]='48b9ef68-b4f6-4c75-b8de-c547939179ce' WHERE [SystemReportDataSourceFieldId]='8686ce6b-09b9-4f16-8796-a2099cc529c9'

-- =======================================================
-- Synchronization Script for Table: [dbo].[AccountReport]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[AccountReport]'

UPDATE [dbo].[AccountReport] SET [ReportOrder]=6 WHERE [AccountReportId]='eb0e7c81-2afd-490e-b2ab-bb44b5757416'

END
GO
-- Add Column PasswordVerificationCode to AccountEmployee
Print 'Add Column PasswordVerificationCode to AccountEmployee'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployee' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='PasswordVerificationCode' AND TABLE_NAME='AccountEmployee'))
ALTER TABLE [dbo].[AccountEmployee]
	ADD [PasswordVerificationCode] uniqueidentifier NULL

GO
-- Alter Column Description on AccountExpenseEntry
Print 'Alter Column Description on AccountExpenseEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountExpenseEntry' AND TABLE_TYPE='BASE TABLE')) AND (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='Description' AND TABLE_NAME='AccountExpenseEntry'))
ALTER TABLE [dbo].[AccountExpenseEntry]
	 ALTER COLUMN [Description] nvarchar(4000) NULL
GO
-- Drop View vueTimesheetOverdueNotificationWithPreferenceForEmployeeManager
Print 'Drop View vueTimesheetOverdueNotificationWithPreferenceForEmployeeManager'
GO
if exists (select * from information_schema.tables where table_name = 'vueTimesheetOverdueNotificationWithPreferenceForEmployeeManager' and table_type = 'VIEW')
DROP VIEW [dbo].[vueTimesheetOverdueNotificationWithPreferenceForEmployeeManager]
GO
-- Create View vueTimesheetOverdueNotificationWithPreferenceForEmployeeManager
Print 'Create View vueTimesheetOverdueNotificationWithPreferenceForEmployeeManager'
GO
if not exists (select * from information_schema.tables where table_name = 'vueTimesheetOverdueNotificationWithPreferenceForEmployeeManager' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueTimesheetOverdueNotificationWithPreferenceForEmployeeManager
AS
SELECT     dbo.AccountPreferences.ScheduledEmailSendTime, MAX(AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName) AS EmployeeName, 
                      dbo.AccountEmployee.AccountId, CASE WHEN MAX(dbo.AccountPreferences.CultureInfoName) IS NULL OR
                      MAX(dbo.AccountPreferences.CultureInfoName) = ''auto'' THEN ''en-us'' ELSE MAX(dbo.AccountPreferences.CultureInfoName) END AS CultureInfoName, 
                      ISNULL(MAX(dbo.vueAccountWorkingDayType.TimesheetOverdueAfterDays), 1) AS TimesheetOverdueAfterDays, AccountEmployee_1.AccountEmployeeId, 
                      AccountEmployee_1.EMailAddress, AccountEmployee_1.LastScheduledEmailSentTime, ISNULL(MAX(dbo.vueAccountWorkingDayType.SystemTimesheetPeriodType), 
                      ''Weekly'') AS SystemTimesheetPeriodType, ISNULL(MAX(dbo.vueAccountWorkingDayType.WeekStartDay), 1) AS WeekStartDay, 
                      ISNULL(MAX(dbo.vueAccountWorkingDayType.SystemInitialDayOfFirstPeriod), 1) AS SystemInitialDayOfFirstPeriod, 
                      ISNULL(MAX(dbo.vueAccountWorkingDayType.SystemInitialDayOfLastPeriod), 16) AS SystemInitialDayOfLastPeriod, 
                      ISNULL(MAX(dbo.vueAccountWorkingDayType.InitialDayOfTheMonth), 1) AS InitialDayOfTheMonth
FROM         dbo.AccountEmployee INNER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON dbo.AccountEmployee.EmployeeManagerId = AccountEmployee_1.AccountEmployeeId INNER JOIN
                      dbo.vueAccountWorkingDayType ON AccountEmployee_1.AccountWorkingDayTypeId = dbo.vueAccountWorkingDayType.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_2 ON 
                      dbo.AccountEmployee.EmployeeManagerId = AccountEMailNotificationPreference_2.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference ON dbo.AccountEmployee.AccountId = dbo.AccountEMailNotificationPreference.AccountId LEFT OUTER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployee.AccountId = dbo.AccountPreferences.AccountId
WHERE     (AccountEMailNotificationPreference_2.SystemEMailNotificationId = 64) AND (AccountEMailNotificationPreference_2.Enabled = 1) AND 
                      (dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = 63) AND (dbo.AccountEMailNotificationPreference.Enabled = 1) AND 
                      (dbo.AccountEmployee.IsDeleted <> 1) AND (dbo.AccountEmployee.EmployeeTypeId <> 2 OR
                      dbo.AccountEmployee.EmployeeTypeId IS NULL)
GROUP BY dbo.AccountPreferences.ScheduledEmailSendTime, dbo.AccountEmployee.AccountId, AccountEmployee_1.AccountEmployeeId, AccountEmployee_1.EMailAddress, 
                      AccountEmployee_1.LastScheduledEmailSentTime'


IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountCostCenter' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountCostCenter]') AND name = N'_dta_index_AccountCostCenter_10_798729998__K1'))
CREATE NONCLUSTERED INDEX [_dta_index_AccountCostCenter_10_798729998__K1] ON [dbo].[AccountCostCenter] 
(
[AccountCostCenterId] ASC
)ON [PRIMARY]

GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntry' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountEmployeeTimeEntry]') AND name = N'_dta_stat_501576825_1_7_8'))
CREATE STATISTICS [_dta_stat_501576825_1_7_8] ON [dbo].[AccountEmployeeTimeEntry]([AccountEmployeeTimeEntryId], [AccountProjectId], [AccountProjectTaskId])

GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntry' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountEmployeeTimeEntry]') AND name = N'_dta_index_AccountEmployeeTimeEntry_10_501576825__K1'))
CREATE NONCLUSTERED INDEX [_dta_index_AccountEmployeeTimeEntry_10_501576825__K1] ON [dbo].[AccountEmployeeTimeEntry] 
(
[AccountEmployeeTimeEntryId] ASC
)ON [PRIMARY]

GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProject' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountProject]') AND name = N'_dta_index_AccountProject_10_917578307__K1'))
CREATE NONCLUSTERED INDEX [_dta_index_AccountProject_10_917578307__K1] ON [dbo].[AccountProject] 
(
[AccountProjectId] ASC
)ON [PRIMARY]

GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProjectTask' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountProjectTask]') AND name = N'_dta_index_AccountProjectTask_10_851534117__K1'))
CREATE NONCLUSTERED INDEX [_dta_index_AccountProjectTask_10_851534117__K1] ON [dbo].[AccountProjectTask] 
(
[AccountProjectTaskId] ASC
) ON [PRIMARY]

GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountWorkType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountWorkType]') AND name = N'_dta_index_AccountWorkType_10_1834541669__K1_3'))
CREATE NONCLUSTERED INDEX [_dta_index_AccountWorkType_10_1834541669__K1_3] ON [dbo].[AccountWorkType] 
([AccountWorkTypeId] ASC,
[AccountWorkType] ASC) 
ON [PRIMARY]

GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'Audit' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[Audit]') AND name = N'_dta_stat_1381579960_4_7'))
CREATE STATISTICS [_dta_stat_1381579960_4_7] ON [dbo].[Audit]([FieldName], [UpdateDate])

GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'Audit' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[Audit]') AND name = N'_dta_stat_1381579960_7_2'))
CREATE STATISTICS [_dta_stat_1381579960_7_2] ON [dbo].[Audit]([UpdateDate], [TableName])


--GO
--IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'Audit' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[Audit]') AND name = N'_dta_index_Audit_10_1381579960__K8_K2_K7_3_4_5_6'))
--CREATE NONCLUSTERED INDEX [_dta_index_Audit_10_1381579960__K8_K2_K7_3_4_5_6] ON [dbo].[Audit] 
--([UserName] ASC,[TableName] ASC,[UpdateDate] ASC,
--  [PK],
--[FieldName],
--[OldValue],
--[NewValue]) ON [PRIMARY]

GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'Audit' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[Audit]') AND name = N'_dta_stat_1381579960_3_2_7'))
CREATE STATISTICS [_dta_stat_1381579960_3_2_7] ON [dbo].[Audit]([PK], [TableName], [UpdateDate])
GO
-- Drop View vueAccountEmployeeTimeEntryWithTimeOffForReport
Print 'Drop View vueAccountEmployeeTimeEntryWithTimeOffForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithTimeOffForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryWithTimeOffForReport]
GO
-- Drop View vueAccountEmployeeTimeEntryPeriodForReport
Print 'Drop View vueAccountEmployeeTimeEntryPeriodForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPeriodForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryPeriodForReport]
GO
-- Drop View vueAccountEmployee
Print 'Drop View vueAccountEmployee'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployee]
GO
-- Drop View vueAccountEmployeeTimeEntryForReport
Print 'Drop View vueAccountEmployeeTimeEntryForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryForReport]
GO
-- Create View vueAccountEmployeeTimeEntryWithTimeOffForReport
Print 'Create View vueAccountEmployeeTimeEntryWithTimeOffForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithTimeOffForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport
AS
SELECT     CASE WHEN dbo.AccountEmployee.IsDisabled = 1 THEN dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE dbo.AccountEmployee.FirstName
                       + '' '' + dbo.AccountEmployee.LastName END AS EmployeeName, dbo.AccountProject.ProjectName, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 1 THEN AccountProjectTask_1.TaskName ELSE dbo.AccountTimeOffType.AccountTimeOffType END AS TaskName,
                       dbo.AccountEmployeeTimeEntry.TotalTime, dbo.AccountEmployeeTimeEntry.Approved, dbo.AccountEmployee.AccountEmployeeId, 
                      dbo.AccountProject.AccountProjectId, dbo.AccountEmployeeTimeEntry.TeamLeadApproved, dbo.AccountEmployeeTimeEntry.ProjectManagerApproved, 
                      dbo.AccountEmployeeTimeEntry.AdministratorApproved, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, dbo.AccountEmployeeTimeEntry.StartTime, 
                      dbo.AccountEmployeeTimeEntry.EndTime, dbo.AccountEmployeeTimeEntry.TimeEntryDate, dbo.AccountEmployeeTimeEntry.Description, 
                      ISNULL(dbo.AccountProject.AccountId, dbo.AccountTimeOffType.AccountId) AS AccountId, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime) AS TotalMinutes, DATEPART(dw, dbo.AccountEmployeeTimeEntry.TimeEntryDate) AS WeekDay, 
                      dbo.AccountParty.AccountPartyId, dbo.AccountParty.PartyName, AccountProjectTask_1.AccountProjectTaskId, dbo.AccountBillingType.BillingType, 
                      dbo.AccountProject.LeaderEmployeeId, dbo.AccountProject.ProjectManagerEmployeeId, dbo.AccountProject.TimeSheetApprovalTypeId, 
                      dbo.AccountProject.ExpenseApprovalTypeId, AccountProjectTask_1.IsBillable, dbo.AccountEmployeeTimeEntry.Rejected, dbo.AccountEmployeeTimeEntry.BillingRate, 
                      dbo.AccountProject.ProjectBillingRateTypeId, dbo.AccountEmployee.EmployeeCode, dbo.AccountEmployee.AccountDepartmentId, 
                      dbo.AccountDepartment.DepartmentName, AccountProjectTask_1.EstimatedCost, AccountProjectTask_1.EstimatedTimeSpent, 
                      dbo.AccountEmployeeTimeEntry.Submitted, dbo.AccountWorkType.AccountWorkType, dbo.AccountEmployee.EMailAddress, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountCostCenter.AccountCostCenter, dbo.AccountCostCenter.AccountCostCenterCode, dbo.AccountWorkType.AccountWorkTypeCode, 
                      dbo.AccountProject.ProjectCode, AccountProjectTask_1.TaskCode, dbo.AccountLocation.AccountLocationId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction.Comments, dbo.AccountEmployeeTimeEntry.BillingRateCurrencyId, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateCurrencyId, dbo.AccountEmployeeTimeEntry.BillingRateExchangeRate, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateExchangeRate, dbo.AccountEmployeeTimeEntry.AccountBaseCurrencyId, AccountProjectTask_1.AccountTaskTypeId, 
                      AccountProjectTask_1.TaskStatusId, AccountProjectTask_1.AccountPriorityId, AccountProjectTask_1.AccountProjectMilestoneId, 
                      dbo.AccountDepartment.DepartmentCode, dbo.AccountParty.PartyNick, AccountProjectTask_1.EstimatedCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction.ApprovedOn, dbo.AccountEmployeeTimeEntry.EmployeeRate, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountRole.Role, dbo.AccountProject.AccountProjectTypeId, dbo.AccountProject.ProjectDescription, AccountProjectTask_1.TaskDescription, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeExpenseBillingTimesheetId, dbo.AccountEmployeeTimeEntry.Billed, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Submitted = 1 THEN (CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, 
                      dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS SubmittedHours, CASE WHEN dbo.AccountEmployeeTimeEntry.Approved = 1 THEN (CONVERT(float, 
                      DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS ApprovedHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Rejected = 1 THEN (CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, 
                      dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS RejectedHours, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, 
                      dbo.AccountPartyContact.FirstName + N'' '' + dbo.AccountPartyContact.LastName AS ClientContactName, 
                      dbo.AccountPartyDepartment.PartyDepartmentCode AS ClientDepartmentCode, dbo.AccountPartyDepartment.PartyDepartmentName AS ClientDepartmentName, 
                      dbo.AccountPartyDepartment.PartyDepartmentLocation AS ClientDepartmentLocation, dbo.AccountEmployeeTimeEntry.IsTimeOff, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId, CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 0 THEN (CONVERT(float, DATEPART(hh, 
                      dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS TimeOffHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 1 THEN (CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, 
                      dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS TimesheetHours, dbo.AccountWorkType.AccountWorkTypeId, dbo.AccountStatus.Status AS ProjectStatus, 
                      AccountProjectTask_1.ParentAccountProjectTaskId, dbo.AccountProjectTask.TaskName AS ParentTaskName, dbo.AccountEmployee.IsDisabled, 
                      dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, ISNULL(dbo.AccountEmployeeType.AccountEmployeeType, N'''') AS EmployeeType, 
                      ISNULL(dbo.AccountHolidayTypeDetail.HolidayName, N'''') AS HolidayName
FROM         dbo.AccountHolidayTypeDetail RIGHT OUTER JOIN
                      dbo.AccountEmployeeTimeEntry INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeEntry.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId ON 
                      dbo.AccountHolidayTypeDetail.AccountHolidayTypeId = dbo.AccountEmployee.AccountHolidayTypeId AND 
                      dbo.AccountHolidayTypeDetail.AccountId = dbo.AccountEmployee.AccountId AND 
                      dbo.AccountHolidayTypeDetail.HolidayDate = dbo.AccountEmployeeTimeEntry.TimeEntryDate LEFT OUTER JOIN
                      dbo.AccountEmployeeType ON dbo.AccountEmployee.EmployeePayTypeId = dbo.AccountEmployeeType.AccountEmployeeTypeId LEFT OUTER JOIN
                      dbo.AccountProjectTask AS AccountProjectTask_1 LEFT OUTER JOIN
                      dbo.AccountProjectTask ON AccountProjectTask_1.ParentAccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId ON 
                      dbo.AccountEmployeeTimeEntry.AccountProjectTaskId = AccountProjectTask_1.AccountProjectTaskId LEFT OUTER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountStatus ON dbo.AccountProject.ProjectStatusId = dbo.AccountStatus.AccountStatusId LEFT OUTER JOIN
                      dbo.AccountTimeOffType ON dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId LEFT OUTER JOIN
                      dbo.AccountPartyDepartment ON dbo.AccountProject.AccountPartyDepartmentId = dbo.AccountPartyDepartment.AccountPartyDepartmentId LEFT OUTER JOIN
                      dbo.AccountPartyContact ON dbo.AccountProject.AccountPartyContactId = dbo.AccountPartyContact.AccountPartyContactId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryPeriod ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId LEFT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryApprovalLastAction.AccountEmployeeTimeEntryId LEFT OUTER JOIN
                      dbo.AccountCostCenter ON dbo.AccountEmployeeTimeEntry.AccountCostCenterId = dbo.AccountCostCenter.AccountCostCenterId LEFT OUTER JOIN
                      dbo.AccountWorkType ON dbo.AccountEmployeeTimeEntry.AccountWorkTypeId = dbo.AccountWorkType.AccountWorkTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId LEFT OUTER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId'
GO
-- Create View vueAccountEmployeeTimeEntryForReport
Print 'Create View vueAccountEmployeeTimeEntryForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryForReport
AS
SELECT     dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeName, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskName, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalTime, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Approved, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TeamLeadApproved, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectManagerApproved, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AdministratorApproved, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeTimeEntryId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.StartTime, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EndTime, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Description, N'''') AS Description, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.WeekDay, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountPartyId AS AccountClientId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.PartyName AS ClientName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectTaskId, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingType, N'''') 
                      AS BillingType, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectManagerEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ExpenseApprovalTypeId, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.IsBillable, 0) 
                      AS IsBillable, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Rejected, 0) AS Rejected, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRate, 0) AS BillingRate, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectBillingRateTypeId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeCode, N'''') AS EmployeeCode, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountDepartmentId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.DepartmentName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedCost, 0) AS EstimatedCost, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedTimeSpent, 0) AS EstimatedHours, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Submitted, 0) AS Submitted, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountWorkType, N'''') AS AccountWorkType, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EMailAddress, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountLocation, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountCostCenter, N'''') AS AccountCostCenter, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountCostCenterCode, N'''') AS AccountCostCenterCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountWorkTypeCode, N'''') AS AccountWorkTypeCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectCode, N'''') AS ProjectCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCode, N'''') AS TaskCode, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountLocationId, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Comments, N'''') 
                      AS ApproverComments, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes * dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRate / 60, 0) 
                      AS Amount, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRateCurrencyId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateExchangeRate, 0) AS BillingRateExchangeRate, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRateExchangeRate, 0) AS EmployeeRateExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountBaseCurrencyId, dbo.vueAccountCurrency.CurrencyCode AS BillingRateCurrencyCode, 
                      dbo.vueAccountCurrency.CurrencyCode AS AmountCurrencyCode, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountTaskTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskStatusId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountPriorityId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectMilestoneId, dbo.AccountTaskType.TaskType, dbo.AccountStatus.Status AS TaskStatus, 
                      dbo.AccountProjectMilestone.MilestoneDescription, dbo.AccountPriority.Priority, CONVERT(float, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes) / 60 AS TotalHours, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.DepartmentCode, N'''') AS DepartmentCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.PartyNick, N'''') AS ClientNick, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedCurrencyId, vueAccountCurrency_1.CurrencyCode AS EstimatedCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ApprovedOn, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRate, 0) 
                      AS EmployeeRate, vueAccountCurrency_2.CurrencyCode AS EmployeeRateCurrencyCode, 
                      AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName AS TeamLeader, 
                      AccountEmployee_2.FirstName + '' '' + AccountEmployee_2.LastName AS ProjectManager, 
                      ISNULL(dbo.AccountEmployee.FirstName + N'' '' + dbo.AccountEmployee.LastName, N'''') AS EmployeeManager, 
                      vueAccountCurrency_1.ExchangeRate AS EstimatedCurrencyExchangeRate, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes * dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRate / 60, 0) 
                      AS EmployeeCost, { fn DAYOFMONTH(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) } AS DayNo, 
                      MONTH(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) AS MonthNo, DATEPART(week, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) - DATEPART(week, DATEADD(month, DATEDIFF(month, 0, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate), 0)) + 1 AS WeekNo, 
                      YEAR(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) AS Year, 
                      LEFT({ fn MONTHNAME(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) }, 3) + '' - '' + CONVERT(nvarchar(10), 
                      YEAR(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate)) AS Period, 
                      { fn DAYNAME(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) } AS WeekDayName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountRoleId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Role, 
                      dbo.AccountProjectType.ProjectType, dbo.AccountRole.Role AS ProjectRole, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectDescription, N'''') 
                      AS ProjectDescription, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskDescription, N'''') AS TaskDescription, 
                      dbo.AccountTimeExpenseBilling.InvoiceNumber, dbo.AccountTimeExpenseBilling.InvoiceDate, dbo.AccountProjectType.AccountProjectTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Billed, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeTimeEntryPeriodId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientContactName, N'''') AS ClientContactName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentCode, N'''') AS ClientDepartmentCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentName, N'''') AS ClientDepartmentName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentLocation, N'''') AS ClientDepartmentLocation, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.IsTimeOff, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountWorkTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectStatus, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ParentTaskName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.FirstName, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.LastName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeType, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.HolidayName
FROM         dbo.AccountRole INNER JOIN
                      dbo.AccountProjectEmployee ON dbo.AccountRole.AccountRoleId = dbo.AccountProjectEmployee.AccountRoleId RIGHT OUTER JOIN
                      dbo.AccountTimeExpenseBillingTimesheet INNER JOIN
                      dbo.AccountTimeExpenseBilling ON 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingId = dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId RIGHT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport LEFT OUTER JOIN
                      dbo.AccountProjectType ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectTypeId = dbo.AccountProjectType.AccountProjectTypeId LEFT OUTER JOIN
                      dbo.AccountProjectMilestone ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectMilestoneId = dbo.AccountProjectMilestone.AccountProjectMilestoneId LEFT OUTER JOIN
                      dbo.AccountStatus ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskStatusId = dbo.AccountStatus.AccountStatusId LEFT OUTER JOIN
                      dbo.AccountPriority ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountPriorityId = dbo.AccountPriority.AccountPriorityId LEFT OUTER JOIN
                      dbo.AccountTaskType ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountTaskTypeId = dbo.AccountTaskType.AccountTaskTypeId ON 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingTimesheetId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountTimeExpenseBillingTimesheetId
                       ON dbo.AccountProjectEmployee.AccountEmployeeId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeId AND 
                      dbo.AccountProjectEmployee.AccountProjectId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.LeaderEmployeeId = AccountEmployee_1.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_2 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectManagerEmployeeId = AccountEmployee_2.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.AccountEmployee AS AccountEmployee_3 ON dbo.AccountEmployee.AccountEmployeeId = AccountEmployee_3.EmployeeManagerId ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeId = AccountEmployee_3.AccountEmployeeId LEFT OUTER JOIN
                      dbo.vueAccountCurrency AS vueAccountCurrency_2 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRateCurrencyId = vueAccountCurrency_2.AccountCurrencyId LEFT OUTER JOIN
                      dbo.vueAccountCurrency AS vueAccountCurrency_1 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedCurrencyId = vueAccountCurrency_1.AccountCurrencyId LEFT OUTER JOIN
                      dbo.vueAccountCurrency ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateCurrencyId = dbo.vueAccountCurrency.AccountCurrencyId'
GO
-- Create View vueAccountEmployee
Print 'Create View vueAccountEmployee'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployee
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountEmployee.AccountId, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.Password, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountLocationId, dbo.AccountEmployee.BillingTypeId, 
                      dbo.AccountBillingType.BillingType, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, dbo.AccountPreferences.ShowClockStartEnd, dbo.Account.TimeZoneId, 
                      dbo.AccountRole.MasterAccountRoleId, dbo.Account.DefaultCurrencyId, dbo.Account.CountryId, dbo.AccountPreferences.CultureInfoName, 
                      dbo.AccountPreferences.TimeEntryFormat, dbo.AccountEmployee.AllowedAccessFromIP, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountPreferences.AccountSessionTimeout, dbo.AccountPreferences.ShowCompletedTasksInTimeSheet, dbo.AccountPreferences.CurrencySymbol, 
                      dbo.AccountPreferences.IsCompanyOwnLogo, dbo.Account.AccountExpiryActivation, dbo.Account.LicenseActivation, dbo.AccountEmployee.EmployeeTypeId, 
                      dbo.AccountEmployee.ExternalUserClientId, dbo.AccountEmployee.AccountBillingRateId, dbo.AccountPreferences.ScheduledEmailSendTime, 
                      dbo.AccountEmployee.Username, dbo.AccountEmployee.IsDisabled, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.AccountEmployee.EmployeeCode, dbo.AccountPreferences.Version, 
                      dbo.AccountPreferences.LockSubmittedRecords, dbo.AccountPreferences.LockApprovedRecords, ISNULL(dbo.AccountEmployee.EmployeeCode + '' - '', '''') 
                      + dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeNameWithCode, dbo.AccountPreferences.ShowWorkTypeInTimeSheet, 
                      dbo.AccountPreferences.NumberOfBlankRowsInTimeEntry, dbo.AccountPreferences.ShowCostCenterInTimeSheet, dbo.AccountPreferences.WeekStartDay, 
                      dbo.AccountPreferences.AccountBaseCurrencyId, dbo.AccountPreferences.UserInterfaceLanguage, dbo.AccountEmployee.EmployeeManagerId, 
                      dbo.AccountPreferences.DefaultTimeEntryMode, dbo.AccountPreferences.PageSize, dbo.AccountEmployee.TimeZoneId AS EmployeeTimeZoneId, 
                      dbo.AccountEmployee.TerminationDate, dbo.AccountEmployee.StatusId, dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.EmployeePayTypeId, 
                      dbo.AccountEmployee.HiredDate, dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountWorkingDayType, 
                      dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay AS EmployeeWeekStartDay, 
                      dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountPreferences.ShowDescriptionInWeekView, 
                      dbo.AccountPreferences.InvoiceNoPrefix, dbo.AccountPreferences.ShowAdditionalTaskInformationType, 
                      dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, 
                      ISNULL(dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, 1) AS InitialDayOfTheMonth, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, 1) 
                      AS SystemInitialDayOfFirstPeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod, 16) AS SystemInitialDayOfLastPeriod, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountPreferences.TimesheetPrintFooter, dbo.AccountPreferences.ExpenseSheetPrintFooter, 
                      dbo.AccountPreferences.ShowCompletedProjectsInTimeSheet, dbo.AccountPreferences.ShowProjectForTimeOff, dbo.AccountPreferences.ShowTimeOffInTimesheet, 
                      dbo.AccountEmployee.IsDeleted, dbo.AccountEmployee.IsForcePasswordChange, dbo.AccountEmployee.PasswordChangedDate, 
                      dbo.AccountPreferences.PasswordExpiryPeriod, dbo.AccountPreferences.ShowAllInTimesheetReadOnly, dbo.AccountPreferences.ShowTaskInExpenseSheet, 
                      dbo.AccountPreferences.InvoiceBillingTypeId, dbo.AccountPreferences.ShowBillingRateInInvoiceReport, dbo.SystemInvoiceBillingType.InvoiceBillingType, 
                      dbo.AccountPreferences.InvoiceFooter, dbo.AccountPreferences.TimesheetOverduePeriods, dbo.AccountWorkingDayType.TimesheetOverdueAfterDays, 
                      dbo.AccountEmployee.CreatedOn, dbo.AccountEmployee.CreatedByEmployeeId, dbo.AccountEmployee.ModifiedOn, 
                      dbo.AccountEmployee.ModifiedByEmployeeId
FROM         dbo.SystemInvoiceBillingType RIGHT OUTER JOIN
                      dbo.AccountPreferences ON dbo.SystemInvoiceBillingType.InvoiceBillingTypeId = dbo.AccountPreferences.InvoiceBillingTypeId RIGHT OUTER JOIN
                      dbo.vueAccountTimesheetPeriodType RIGHT OUTER JOIN
                      dbo.AccountWorkingDayType ON 
                      dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId = dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId RIGHT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.Account ON dbo.AccountEmployee.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId ON 
                      dbo.AccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId ON 
                      dbo.AccountPreferences.AccountId = dbo.AccountEmployee.AccountId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId'
GO
-- Create View vueAccountEmployeeTimeEntryPeriodForReport
Print 'Create View vueAccountEmployeeTimeEntryPeriodForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPeriodForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryPeriodForReport
AS
SELECT     dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId, dbo.AccountEmployeeTimeEntryPeriod.AccountId, 
                      dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeId, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, 
                      dbo.AccountEmployeeTimeEntryPeriod.Submitted, dbo.AccountEmployeeTimeEntryPeriod.Approved, dbo.AccountEmployeeTimeEntryPeriod.Rejected, 
                      dbo.AccountEmployeeTimeEntryPeriod.InApproval, dbo.AccountEmployeeTimeEntryPeriod.SubmittedDate, dbo.vueAccountEmployee.EmployeeName, 
                      dbo.vueAccountEmployee.AccountLocationId, dbo.vueAccountEmployee.AccountDepartmentId, dbo.vueAccountEmployee.AccountLocation, 
                      dbo.vueAccountEmployee.Role, dbo.vueAccountEmployee.DepartmentName, dbo.vueAccountEmployee.EMailAddress, dbo.vueAccountEmployee.AccountRoleId, 
                      CASE WHEN AccountEmployeeTimeEntryPeriod.Submitted = 1 AND 
                      AccountEmployeeTimeEntryPeriod.Approved = 0 THEN ''Submitted'' WHEN AccountEmployeeTimeEntryPeriod.Approved = 1 THEN ''Approved'' WHEN AccountEmployeeTimeEntryPeriod.Rejected
                       = 1 THEN ''Rejected'' WHEN AccountEmployeeTimeEntryPeriod.Submitted = 0 AND AccountEmployeeTimeEntryPeriod.Approved = 0 AND 
                      AccountEmployeeTimeEntryPeriod.Rejected = 0 THEN ''Not Submitted'' END AS ApprovalStatus, 
                      { fn DAYOFMONTH(dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate) } AS DayNo, MONTH(dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate) 
                      AS MonthNo, DATEPART(week, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate) - DATEPART(week, DATEADD(month, DATEDIFF(month, 0, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate), 0)) + 1 AS WeekNo, YEAR(dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate) AS Year, 
                      LEFT({ fn MONTHNAME(dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate) }, 3) + '' - '' + CONVERT(nvarchar(10), 
                      YEAR(dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate)) AS Period, { fn DAYNAME(dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate) 
                      } AS WeekDayName, SUM(CONVERT(float, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes) / 60) AS TotalHours, 
                      SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes * dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRate / 60, 0)) 
                      AS Amount, SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRate, 0)) AS BillingRate, 
                      SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.SubmittedHours, 0)) AS SubmittedHours, 
                      SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ApprovedHours, 0)) AS ApprovedHours, 
                      SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.RejectedHours, 0)) AS RejectedHours, ISNULL(dbo.vueAccountEmployee.EmployeeCode, '''') 
                      AS EmployeeCode, SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateExchangeRate, 0)) AS BillingRateExchangeRate, 
                      dbo.AccountEmployeeTimeEntryPeriod.ApprovedOn, dbo.AccountEmployeeTimeEntryPeriod.RejectedOn, 
                      dbo.AccountEmployeeTimeEntryPeriod.ApprovedByEmployeeId, dbo.AccountEmployeeTimeEntryPeriod.RejectedByEmployeeId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientContactName, N'''') AS ClientContactName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentCode, N'''') AS ClientDepartmentCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentName, N'''') AS ClientDepartmentName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentLocation, N'''') AS ClientDepartmentLocation, 
                      SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeOffHours, 0)) AS TimeOffHours, 
                      SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimesheetHours, 0)) AS TimesheetHours
FROM         dbo.AccountEmployeeTimeEntryPeriod INNER JOIN
                      dbo.vueAccountEmployee ON dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeId = dbo.vueAccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport ON 
                      dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeTimeEntryPeriodId
GROUP BY dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId, dbo.AccountEmployeeTimeEntryPeriod.AccountId, 
                      dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeId, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, 
                      dbo.AccountEmployeeTimeEntryPeriod.Submitted, dbo.AccountEmployeeTimeEntryPeriod.Approved, dbo.AccountEmployeeTimeEntryPeriod.Rejected, 
                      dbo.AccountEmployeeTimeEntryPeriod.InApproval, dbo.AccountEmployeeTimeEntryPeriod.SubmittedDate, dbo.vueAccountEmployee.EmployeeName, 
                      dbo.vueAccountEmployee.AccountLocationId, dbo.vueAccountEmployee.AccountDepartmentId, dbo.vueAccountEmployee.AccountLocation, 
                      dbo.vueAccountEmployee.Role, dbo.vueAccountEmployee.DepartmentName, dbo.vueAccountEmployee.EMailAddress, dbo.vueAccountEmployee.AccountRoleId, 
                      dbo.vueAccountEmployee.EmployeeCode, dbo.AccountEmployeeTimeEntryPeriod.ApprovedOn, dbo.AccountEmployeeTimeEntryPeriod.RejectedOn, 
                      dbo.AccountEmployeeTimeEntryPeriod.ApprovedByEmployeeId, dbo.AccountEmployeeTimeEntryPeriod.RejectedByEmployeeId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientContactName, N''''), 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentCode, N''''), 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentName, N''''), 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentLocation, N'''')'

GO
-- Drop View vueAccount
Print 'Drop View vueAccount'
GO
If exists (select * from information_schema.tables where table_name = 'vueAccount' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccount]

GO
-- Drop View vueAccountEmployee
Print 'Drop View vueAccountEmployee'
GO
If exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployee]

GO
-- Add Column ShowProjectNameInInvoiceReport to AccountPreferences
Print 'Add Column ShowProjectNameInInvoiceReport to AccountPreferences'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountPreferences' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='ShowProjectNameInInvoiceReport' AND TABLE_NAME='AccountPreferences'))
ALTER TABLE [dbo].[AccountPreferences]
	ADD [ShowProjectNameInInvoiceReport] bit NULL

GO
-- Create View vueAccountEmployee
Print 'Create View vueAccountEmployee'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployee
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountEmployee.AccountId, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.Password, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountLocationId, dbo.AccountEmployee.BillingTypeId, 
                      dbo.AccountBillingType.BillingType, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, dbo.AccountPreferences.ShowClockStartEnd, dbo.Account.TimeZoneId, 
                      dbo.AccountRole.MasterAccountRoleId, dbo.Account.DefaultCurrencyId, dbo.Account.CountryId, dbo.AccountPreferences.CultureInfoName, 
                      dbo.AccountPreferences.TimeEntryFormat, dbo.AccountEmployee.AllowedAccessFromIP, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountPreferences.AccountSessionTimeout, dbo.AccountPreferences.ShowCompletedTasksInTimeSheet, dbo.AccountPreferences.CurrencySymbol, 
                      dbo.AccountPreferences.IsCompanyOwnLogo, dbo.Account.AccountExpiryActivation, dbo.Account.LicenseActivation, dbo.AccountEmployee.EmployeeTypeId, 
                      dbo.AccountEmployee.ExternalUserClientId, dbo.AccountEmployee.AccountBillingRateId, dbo.AccountPreferences.ScheduledEmailSendTime, 
                      dbo.AccountEmployee.Username, dbo.AccountEmployee.IsDisabled, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.AccountEmployee.EmployeeCode, dbo.AccountPreferences.Version, 
                      dbo.AccountPreferences.LockSubmittedRecords, dbo.AccountPreferences.LockApprovedRecords, ISNULL(dbo.AccountEmployee.EmployeeCode + '' - '', '''') 
                      + dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeNameWithCode, dbo.AccountPreferences.ShowWorkTypeInTimeSheet, 
                      dbo.AccountPreferences.NumberOfBlankRowsInTimeEntry, dbo.AccountPreferences.ShowCostCenterInTimeSheet, dbo.AccountPreferences.WeekStartDay, 
                      dbo.AccountPreferences.AccountBaseCurrencyId, dbo.AccountPreferences.UserInterfaceLanguage, dbo.AccountEmployee.EmployeeManagerId, 
                      dbo.AccountPreferences.DefaultTimeEntryMode, dbo.AccountPreferences.PageSize, dbo.AccountEmployee.TimeZoneId AS EmployeeTimeZoneId, 
                      dbo.AccountEmployee.TerminationDate, dbo.AccountEmployee.StatusId, dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.EmployeePayTypeId, 
                      dbo.AccountEmployee.HiredDate, dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountWorkingDayType, 
                      dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay AS EmployeeWeekStartDay, 
                      dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountPreferences.ShowDescriptionInWeekView, 
                      dbo.AccountPreferences.InvoiceNoPrefix, dbo.AccountPreferences.ShowAdditionalTaskInformationType, 
                      dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, 
                      ISNULL(dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, 1) AS InitialDayOfTheMonth, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, 1) 
                      AS SystemInitialDayOfFirstPeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod, 16) AS SystemInitialDayOfLastPeriod, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountPreferences.TimesheetPrintFooter, dbo.AccountPreferences.ExpenseSheetPrintFooter, 
                      dbo.AccountPreferences.ShowCompletedProjectsInTimeSheet, dbo.AccountPreferences.ShowProjectForTimeOff, dbo.AccountPreferences.ShowTimeOffInTimesheet, 
                      dbo.AccountEmployee.IsDeleted, dbo.AccountEmployee.IsForcePasswordChange, dbo.AccountEmployee.PasswordChangedDate, 
                      dbo.AccountPreferences.PasswordExpiryPeriod, dbo.AccountPreferences.ShowAllInTimesheetReadOnly, dbo.AccountPreferences.ShowTaskInExpenseSheet, 
                      dbo.AccountPreferences.InvoiceBillingTypeId, dbo.AccountPreferences.ShowBillingRateInInvoiceReport, dbo.SystemInvoiceBillingType.InvoiceBillingType, 
                      dbo.AccountPreferences.InvoiceFooter, dbo.AccountPreferences.TimesheetOverduePeriods, dbo.AccountWorkingDayType.TimesheetOverdueAfterDays, 
                      dbo.AccountEmployee.CreatedOn, dbo.AccountEmployee.CreatedByEmployeeId, dbo.AccountEmployee.ModifiedOn, dbo.AccountEmployee.ModifiedByEmployeeId, 
                      dbo.AccountPreferences.ShowProjectNameInInvoiceReport
FROM         dbo.SystemInvoiceBillingType RIGHT OUTER JOIN
                      dbo.AccountPreferences ON dbo.SystemInvoiceBillingType.InvoiceBillingTypeId = dbo.AccountPreferences.InvoiceBillingTypeId RIGHT OUTER JOIN
                      dbo.vueAccountTimesheetPeriodType RIGHT OUTER JOIN
                      dbo.AccountWorkingDayType ON 
                      dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId = dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId RIGHT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.Account ON dbo.AccountEmployee.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId ON 
                      dbo.AccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId ON 
                      dbo.AccountPreferences.AccountId = dbo.AccountEmployee.AccountId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId'

GO
-- Create View vueAccount
Print 'Create View vueAccount'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccount' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccount
AS
SELECT     dbo.Account.AccountId, dbo.Account.AccountTypeId, dbo.Account.AccountName, dbo.Account.Address1, dbo.Account.Address2, dbo.Account.ZipCode, dbo.Account.State, 
                      dbo.Account.City, dbo.Account.CountryId, dbo.Account.EMailAddress, dbo.Account.Telephone, dbo.Account.Fax, dbo.Account.DefaultCurrencyId, 
                      dbo.Account.TimeZoneId, dbo.Account.IsDisabled, dbo.Account.IsDeleted, dbo.Account.StatusId, dbo.Account.CreatedOn, dbo.Account.ModifiedOn, 
                      dbo.Account.ModifiedByEmployeeId, dbo.AccountPreferences.ShowClockStartEnd, dbo.AccountPreferences.AccountPreferencesId, dbo.Account.LicenseKey, 
                      dbo.Account.SystemPackageTypeId, dbo.AccountPreferences.TimeEntryFormat, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.Account.MachineId, dbo.Account.ActivationLicenseKey, dbo.Account.ActivationMachineKey, 
                      dbo.Account.ActivationType, dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountPreferences.InvoiceBillingTypeId, 
                      dbo.AccountPreferences.ShowBillingRateInInvoiceReport, dbo.AccountPreferences.InvoiceFooter, dbo.AccountPreferences.ShowProjectNameInInvoiceReport
FROM         dbo.Account INNER JOIN
                      dbo.AccountPreferences ON dbo.Account.AccountId = dbo.AccountPreferences.AccountId'
GO
If exists(Select * from SystemData where version = '3.9.4')
BEGIN
--Update AccountProjectMilestoneId In AccountProjectTask.
Update AccountProjectTask Set AccountProjectMilestoneId = (Select Top 1 AccountProjectMileStoneId from AccountProjectMilestone 
WHERE AccountProjectId = AccountProjectTask.AccountProjectId)
WHERE AccountProjectMilestoneId NOT IN
(Select AccountProjectMilestoneId From AccountProjectMilestone Where AccountProjectId = AccountProjectTask.AccountProjectId)
END
GO
Update SystemData Set Version = '3.9.5' Where Version = '3.9.4' And SystemDataId = 1
GO
If exists(Select * from SystemData where version = '3.9.5')
BEGIN
Update AccountReport Set AccountId = 12341234 Where AccountReportId = '232d42fd-ab42-4e5b-9f44-d3ac04bebeb2'
END
GO
Update SystemData Set Version = '3.9.6' Where Version = '3.9.5' And SystemDataId = 1

GO

-- Drop View vueAccountEmployeeTimeOffRequestApprovalPendingEmail
Print 'Drop View vueAccountEmployeeTimeOffRequestApprovalPendingEmail'
GO
If exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOffRequestApprovalPendingEmail' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeOffRequestApprovalPendingEmail]

GO
-- Create View vueAccountEmployeeTimeOffRequestApprovalPendingEmail
Print 'Create View vueAccountEmployeeTimeOffRequestApprovalPendingEmail'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOffRequestApprovalPendingEmail' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeOffRequestApprovalPendingEmail
AS
SELECT     dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.AccountEmployeeTimeOffRequestId, dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.AccountTimeOffTypeId, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.TimeOffAccountEmployeeId, dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.RequestSubmitDate, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.HoursOff, dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.StartDate, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.EndDate, dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.InApproval, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.Approved, dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.Rejected, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.Description, dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.ApprovedOn, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.ApprovedBy, dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.DayOff, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.CreatedByEmployeeId, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.CreatedOn, dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.AccountId, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.ApprovalTypeName, dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.AccountApprovalPathId, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.SystemApproverTypeId, dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.AccountExternalUserId, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.ApprovalPathSequence, dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.TimeOffApprovalPathId, dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.ApprovedByEmployeeId, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.ApprovedOnApproval, dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.IsRejected, dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.IsApproved, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.Comments, dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.TimeOffApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.FirstName, dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.LastName, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.FullName, dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.AccountTimeOffType, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.IsTimeOffRequestRequired, dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.EMailAddress, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.AccountApprovalTypeId, dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.MaxApprovalPathSequence, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.EmployeeManagerId, 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.ApproverEmployeeId, dbo.AccountEMailNotificationPreference.Monday, 
                      dbo.AccountEMailNotificationPreference.Tuesday, dbo.AccountEMailNotificationPreference.Wednesday, dbo.AccountEMailNotificationPreference.Thursday, 
                      dbo.AccountEMailNotificationPreference.Friday, dbo.AccountEMailNotificationPreference.Saturday, dbo.AccountEMailNotificationPreference.Sunday
FROM         dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover INNER JOIN
                      dbo.AccountEMailNotificationPreference ON 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.AccountId = dbo.AccountEMailNotificationPreference.AccountId INNER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_1 ON 
                      dbo.vueAccountEmployeeTimeOffRequestApprovalPendingApprover.ApproverEmployeeId = AccountEMailNotificationPreference_1.AccountEmployeeId
WHERE     (dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = 43) AND (dbo.AccountEMailNotificationPreference.Enabled = 1) AND 
                      (AccountEMailNotificationPreference_1.SystemEMailNotificationId = 44) AND (AccountEMailNotificationPreference_1.Enabled = 1)'

GO

-- Drop View vueAccountEmployeeTimeOffForImportExport
Print 'Drop View vueAccountEmployeeTimeOffForImportExport'
GO
If exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOffForImportExport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeOffForImportExport]

GO
-- Create View vueAccountEmployeeTimeOffForImportExport
Print 'Create View vueAccountEmployeeTimeOffForImportExport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOffForImportExport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeOffForImportExport
AS
SELECT     CASE WHEN dbo.AccountEmployee.IsDisabled = 1 THEN dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE dbo.AccountEmployee.FirstName
                       + '' '' + dbo.AccountEmployee.LastName END AS EmployeeName, dbo.AccountEmployeeTimeEntry.Description, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountProject.ProjectName, dbo.AccountTimeOffType.AccountTimeOffType, dbo.AccountEmployeeTimeOffRequest.StartDate, 
                      dbo.AccountEmployeeTimeOffRequest.EndDate, dbo.AccountEmployeeTimeOffRequest.DayOff, dbo.AccountEmployeeTimeEntry.Approved, 
                      dbo.AccountEmployeeTimeEntry.Rejected, CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 0 THEN (CONVERT(float, DATEPART(hh, 
                      dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS HoursOff, 
                      dbo.AccountEmployeeTimeEntry.TimeEntryDate, dbo.AccountEmployee.AccountId, dbo.AccountEmployee.AccountEmployeeId
FROM         dbo.AccountEmployeeTimeEntry LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeOffRequest ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeOffRequestId = dbo.AccountEmployeeTimeOffRequest.AccountEmployeeTimeOffRequestId LEFT OUTER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountTimeOffType ON dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId LEFT OUTER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeEntry.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId
WHERE     (dbo.AccountEmployeeTimeEntry.IsTimeOff = 1)'

GO

-- Drop View vueAccount
Print 'Drop View vueAccount'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccount' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccount]

GO
-- Drop View vueAccountTimeExpenseBillingTimesheet
Print 'Drop View vueAccountTimeExpenseBillingTimesheet'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountTimeExpenseBillingTimesheet' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountTimeExpenseBillingTimesheet]

GO
-- Drop View vueAccountTimeExpenseBillingExpense
Print 'Drop View vueAccountTimeExpenseBillingExpense'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountTimeExpenseBillingExpense' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountTimeExpenseBillingExpense]

GO
-- Drop View vueAccountEmployee
Print 'Drop View vueAccountEmployee'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployee]

GO
-- Add Column Comments to AccountProjectMilestone
Print 'Add Column Comments to AccountProjectMilestone'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProjectMilestone' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='Comments' AND TABLE_NAME='AccountProjectMilestone'))
ALTER TABLE [dbo].[AccountProjectMilestone]
	ADD [Comments] nvarchar(500) NULL

GO
-- Add Column Completed to AccountProjectMilestone
Print 'Add Column Completed to AccountProjectMilestone'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProjectMilestone' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='Completed' AND TABLE_NAME='AccountProjectMilestone'))
ALTER TABLE [dbo].[AccountProjectMilestone]
	ADD [Completed] bit NULL

GO
-- Add Column ProjectCodePrefix to AccountPreferences
Print 'Add Column ProjectCodePrefix to AccountPreferences'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountPreferences' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='ProjectCodePrefix' AND TABLE_NAME='AccountPreferences'))
ALTER TABLE [dbo].[AccountPreferences]
	ADD [ProjectCodePrefix] nvarchar(10) NULL

GO
-- Add Column AutoGenerateProjectCode to AccountPreferences
Print 'Add Column AutoGenerateProjectCode to AccountPreferences'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountPreferences' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='AutoGenerateProjectCode' AND TABLE_NAME='AccountPreferences'))
ALTER TABLE [dbo].[AccountPreferences]
	ADD [AutoGenerateProjectCode] bit NULL

GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountPreferences' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountPreferences]') AND name = N'_dta_stat_2007886420_1_15'))
CREATE STATISTICS [_dta_stat_2007886420_1_15]
	ON [dbo].[AccountPreferences] ([AccountPreferencesId], [AccountBaseCurrencyId])

GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountPreferences' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountPreferences]') AND name = N'_dta_stat_2007886420_1_2_15'))
CREATE STATISTICS [_dta_stat_2007886420_1_2_15]
	ON [dbo].[AccountPreferences] ([AccountPreferencesId], [AccountId], [AccountBaseCurrencyId])

GO
-- Create View vueAccountEmployee
Print 'Create View vueAccountEmployee'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployee
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountEmployee.AccountId, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.Password, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountLocationId, dbo.AccountEmployee.BillingTypeId, 
                      dbo.AccountBillingType.BillingType, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, dbo.AccountPreferences.ShowClockStartEnd, dbo.Account.TimeZoneId, 
                      dbo.AccountRole.MasterAccountRoleId, dbo.Account.DefaultCurrencyId, dbo.Account.CountryId, dbo.AccountPreferences.CultureInfoName, 
                      dbo.AccountPreferences.TimeEntryFormat, dbo.AccountEmployee.AllowedAccessFromIP, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountPreferences.AccountSessionTimeout, dbo.AccountPreferences.ShowCompletedTasksInTimeSheet, dbo.AccountPreferences.CurrencySymbol, 
                      dbo.AccountPreferences.IsCompanyOwnLogo, dbo.Account.AccountExpiryActivation, dbo.Account.LicenseActivation, dbo.AccountEmployee.EmployeeTypeId, 
                      dbo.AccountEmployee.ExternalUserClientId, dbo.AccountEmployee.AccountBillingRateId, dbo.AccountPreferences.ScheduledEmailSendTime, 
                      dbo.AccountEmployee.Username, dbo.AccountEmployee.IsDisabled, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.AccountEmployee.EmployeeCode, dbo.AccountPreferences.Version, 
                      dbo.AccountPreferences.LockSubmittedRecords, dbo.AccountPreferences.LockApprovedRecords, ISNULL(dbo.AccountEmployee.EmployeeCode + '' - '', '''') 
                      + dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeNameWithCode, dbo.AccountPreferences.ShowWorkTypeInTimeSheet, 
                      dbo.AccountPreferences.NumberOfBlankRowsInTimeEntry, dbo.AccountPreferences.ShowCostCenterInTimeSheet, dbo.AccountPreferences.WeekStartDay, 
                      dbo.AccountPreferences.AccountBaseCurrencyId, dbo.AccountPreferences.UserInterfaceLanguage, dbo.AccountEmployee.EmployeeManagerId, 
                      dbo.AccountPreferences.DefaultTimeEntryMode, dbo.AccountPreferences.PageSize, dbo.AccountEmployee.TimeZoneId AS EmployeeTimeZoneId, 
                      dbo.AccountEmployee.TerminationDate, dbo.AccountEmployee.StatusId, dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.EmployeePayTypeId, 
                      dbo.AccountEmployee.HiredDate, dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountWorkingDayType, 
                      dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay AS EmployeeWeekStartDay, 
                      dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountPreferences.ShowDescriptionInWeekView, 
                      dbo.AccountPreferences.InvoiceNoPrefix, dbo.AccountPreferences.ShowAdditionalTaskInformationType, 
                      dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, 
                      ISNULL(dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, 1) AS InitialDayOfTheMonth, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, 1) 
                      AS SystemInitialDayOfFirstPeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod, 16) AS SystemInitialDayOfLastPeriod, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountPreferences.TimesheetPrintFooter, dbo.AccountPreferences.ExpenseSheetPrintFooter, 
                      dbo.AccountPreferences.ShowCompletedProjectsInTimeSheet, dbo.AccountPreferences.ShowProjectForTimeOff, dbo.AccountPreferences.ShowTimeOffInTimesheet, 
                      dbo.AccountEmployee.IsDeleted, dbo.AccountEmployee.IsForcePasswordChange, dbo.AccountEmployee.PasswordChangedDate, 
                      dbo.AccountPreferences.PasswordExpiryPeriod, dbo.AccountPreferences.ShowAllInTimesheetReadOnly, dbo.AccountPreferences.ShowTaskInExpenseSheet, 
                      dbo.AccountPreferences.InvoiceBillingTypeId, dbo.AccountPreferences.ShowBillingRateInInvoiceReport, dbo.SystemInvoiceBillingType.InvoiceBillingType, 
                      dbo.AccountPreferences.InvoiceFooter, dbo.AccountPreferences.TimesheetOverduePeriods, dbo.AccountWorkingDayType.TimesheetOverdueAfterDays, 
                      dbo.AccountEmployee.CreatedOn, dbo.AccountEmployee.CreatedByEmployeeId, dbo.AccountEmployee.ModifiedOn, dbo.AccountEmployee.ModifiedByEmployeeId, 
                      dbo.AccountPreferences.ShowProjectNameInInvoiceReport, dbo.AccountPreferences.ProjectCodePrefix, dbo.AccountPreferences.AutoGenerateProjectCode
FROM         dbo.SystemInvoiceBillingType RIGHT OUTER JOIN
                      dbo.AccountPreferences ON dbo.SystemInvoiceBillingType.InvoiceBillingTypeId = dbo.AccountPreferences.InvoiceBillingTypeId RIGHT OUTER JOIN
                      dbo.vueAccountTimesheetPeriodType RIGHT OUTER JOIN
                      dbo.AccountWorkingDayType ON 
                      dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId = dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId RIGHT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.Account ON dbo.AccountEmployee.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId ON 
                      dbo.AccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId ON 
                      dbo.AccountPreferences.AccountId = dbo.AccountEmployee.AccountId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId'

GO
-- Create View vueAccountTimeExpenseBillingExpense
Print 'Create View vueAccountTimeExpenseBillingExpense'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountTimeExpenseBillingExpense' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountTimeExpenseBillingExpense
AS
SELECT     dbo.AccountExpenseEntry.Billed, dbo.AccountProject.ProjectName, dbo.AccountProject.AccountClientId, dbo.AccountProject.AccountProjectId, 
                      dbo.AccountExpense.AccountExpenseName, dbo.AccountExpenseType.ExpenseType, dbo.AccountExpenseEntry.AccountTimeExpenseBillingExpenseId, 
                      dbo.AccountExpenseEntry.AccountExpenseEntryDate, dbo.AccountExpenseType.AccountExpenseTypeId, dbo.AccountExpense.AccountExpenseId, 
                      dbo.AccountTimeExpenseBillingExpense.BilledExpenseAmount, dbo.AccountTimeExpenseBillingExpense.Description, dbo.AccountExpenseEntry.Approved, 
                      dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId, dbo.AccountExpenseEntry.Amount, dbo.AccountExpenseEntry.ExchangeRate, 
                      dbo.AccountTimeExpenseBillingExpense.ActualExpenseAmount, dbo.AccountTimeExpenseBillingExpense.AccountTaxCodeId1, 
                      dbo.AccountTimeExpenseBillingExpense.AccountTaxCodeId2, dbo.AccountTimeExpenseBillingExpense.TaxCode1, 
                      dbo.AccountTimeExpenseBillingExpense.TaxCode2, dbo.AccountExpenseEntry.IsBillable, dbo.AccountExpenseEntry.Description AS ExpenseDescription
FROM         dbo.AccountTimeExpenseBillingExpense INNER JOIN
                      dbo.AccountTimeExpenseBilling ON 
                      dbo.AccountTimeExpenseBillingExpense.AccountTimeExpenseBillingId = dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId RIGHT OUTER JOIN
                      dbo.AccountExpenseEntry INNER JOIN
                      dbo.AccountProject ON dbo.AccountExpenseEntry.AccountProjectId = dbo.AccountProject.AccountProjectId INNER JOIN
                      dbo.AccountExpense ON dbo.AccountExpenseEntry.AccountExpenseId = dbo.AccountExpense.AccountExpenseId INNER JOIN
                      dbo.AccountExpenseType ON dbo.AccountExpenseType.AccountExpenseTypeId = dbo.AccountExpense.AccountExpenseTypeId RIGHT OUTER JOIN
                      dbo.AccountParty ON dbo.AccountParty.AccountPartyId = dbo.AccountProject.AccountClientId ON 
                      dbo.AccountTimeExpenseBillingExpense.AccountTimeExpenseBillingExpenseId = dbo.AccountExpenseEntry.AccountTimeExpenseBillingExpenseId AND 
                      dbo.AccountTimeExpenseBillingExpense.AccountProjectId = dbo.AccountExpenseEntry.AccountProjectId AND 
                      dbo.AccountTimeExpenseBillingExpense.AccountExpenseId = dbo.AccountExpenseEntry.AccountExpenseId
WHERE     (dbo.AccountExpenseEntry.Approved = 1) AND (dbo.AccountExpenseEntry.Billed <> 1)'

GO
-- Create View vueAccountTimeExpenseBillingTimesheet
Print 'Create View vueAccountTimeExpenseBillingTimesheet'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountTimeExpenseBillingTimesheet' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountTimeExpenseBillingTimesheet
AS
SELECT     dbo.AccountProject.AccountClientId, dbo.AccountProject.ProjectName, dbo.AccountProjectTask.TaskName, dbo.AccountProjectTask.AccountProjectTaskId, 
                      dbo.AccountProject.AccountProjectId, dbo.AccountEmployeeTimeEntry.AccountTimeExpenseBillingTimesheetId, dbo.AccountEmployeeTimeEntry.BillingRate, 
                      dbo.AccountEmployeeTimeEntry.BillingRateCurrencyId, dbo.AccountTimeExpenseBillingTimesheet.Description, dbo.AccountEmployeeTimeEntry.Approved, 
                      DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime) AS TotalMinutes, ROUND(CONVERT(float, 
                      DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) AS TotalHours, 
                      dbo.AccountEmployeeTimeEntry.BillingRate * DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) AS Amount, dbo.AccountEmployeeTimeEntry.TimeEntryDate, 
                      dbo.AccountTimeExpenseBillingTimesheet.BillHours, dbo.AccountTimeExpenseBillingTimesheet.ActualBillingRate, 
                      dbo.AccountTimeExpenseBillingTimesheet.TotalAmount, dbo.AccountTimeExpenseBillingTimesheet.AccountTaxCodeId1, 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountTaxCodeId2, dbo.AccountTimeExpenseBilling.SubTotal, dbo.AccountTimeExpenseBilling.TaxCode1, 
                      dbo.AccountTimeExpenseBilling.TaxCode2, dbo.AccountTimeExpenseBilling.GrandTotal, dbo.AccountParty.PartyNick, 
                      dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId, dbo.AccountEmployeeTimeEntry.Billed, dbo.AccountEmployeeTimeEntry.BillingRateExchangeRate, 
                      dbo.AccountProjectTask.IsBillable, dbo.AccountEmployeeTimeEntry.Description AS TimesheetDescription
FROM         dbo.AccountTimeExpenseBillingTimesheet RIGHT OUTER JOIN
                      dbo.AccountTimeExpenseBilling ON 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingId = dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId RIGHT OUTER JOIN
                      dbo.AccountProjectTask INNER JOIN
                      dbo.AccountEmployeeTimeEntry ON dbo.AccountProjectTask.AccountProjectTaskId = dbo.AccountEmployeeTimeEntry.AccountProjectTaskId INNER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId ON 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingTimesheetId = dbo.AccountEmployeeTimeEntry.AccountTimeExpenseBillingTimesheetId AND 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountProjectId = dbo.AccountEmployeeTimeEntry.AccountProjectId AND 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountProjectTaskId = dbo.AccountEmployeeTimeEntry.AccountProjectTaskId RIGHT OUTER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId
WHERE     (dbo.AccountEmployeeTimeEntry.Approved = 1) AND (dbo.AccountEmployeeTimeEntry.Billed <> 1)'

GO
-- Create View vueAccount
Print 'Create View vueAccount'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccount' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccount
AS
SELECT     dbo.Account.AccountId, dbo.Account.AccountTypeId, dbo.Account.AccountName, dbo.Account.Address1, dbo.Account.Address2, dbo.Account.ZipCode, dbo.Account.State, 
                      dbo.Account.City, dbo.Account.CountryId, dbo.Account.EMailAddress, dbo.Account.Telephone, dbo.Account.Fax, dbo.Account.DefaultCurrencyId, 
                      dbo.Account.TimeZoneId, dbo.Account.IsDisabled, dbo.Account.IsDeleted, dbo.Account.StatusId, dbo.Account.CreatedOn, dbo.Account.ModifiedOn, 
                      dbo.Account.ModifiedByEmployeeId, dbo.AccountPreferences.ShowClockStartEnd, dbo.AccountPreferences.AccountPreferencesId, dbo.Account.LicenseKey, 
                      dbo.Account.SystemPackageTypeId, dbo.AccountPreferences.TimeEntryFormat, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.Account.MachineId, dbo.Account.ActivationLicenseKey, dbo.Account.ActivationMachineKey, 
                      dbo.Account.ActivationType, dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountPreferences.InvoiceBillingTypeId, 
                      dbo.AccountPreferences.ShowBillingRateInInvoiceReport, dbo.AccountPreferences.InvoiceFooter, dbo.AccountPreferences.ShowProjectNameInInvoiceReport, 
                      dbo.AccountPreferences.ProjectCodePrefix, dbo.AccountPreferences.AutoGenerateProjectCode
FROM         dbo.Account INNER JOIN
                      dbo.AccountPreferences ON dbo.Account.AccountId = dbo.AccountPreferences.AccountId'

GO
-- Drop View vueAccountEmployeeTimeEntryForQB
Print 'Drop View vueAccountEmployeeTimeEntryForQB'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryForQB' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryForQB]
GO
-- Create View vueAccountEmployeeTimeEntryForQB
Print 'Create View vueAccountEmployeeTimeEntryForQB'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryForQB' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryForQB
AS
SELECT     dbo.AccountEmployeeTimeEntry.TimeEntryDate, dbo.AccountEmployeeTimeEntry.TotalTime, dbo.AccountEmployeeTimeEntry.Description, 
                      dbo.AccountProject.ProjectName, dbo.AccountProject.ProjectDescription, dbo.AccountProject.ProjectCode, dbo.AccountProject.IsDisabled, 
                      dbo.AccountProject.IsTemplate, dbo.AccountProject.IsProject, dbo.AccountProject.IsDeleted, dbo.AccountProjectTask.TaskName, 
                      dbo.AccountProjectTask.TaskDescription, dbo.AccountProjectTask.IsParentTask, dbo.AccountProjectTask.IsBillable, dbo.AccountProjectTask.TaskCode, 
                      LEFT(dbo.AccountParty.PartyName, 41) AS PartyName, dbo.AccountParty.PartyNick, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountEmployee.AccountId, dbo.AccountEmployee.EmployeeCode, 
                      dbo.AccountProjectMilestone.MilestoneDescription, dbo.AccountEmployee.AccountEmployeeId, dbo.AccountWorkType.AccountWorkType, 
                      dbo.AccountCostCenter.AccountCostCenter, dbo.AccountDepartment.DepartmentName, dbo.AccountEmployeeType.AccountEmployeeType, 
                      dbo.vueAccountProjectTaskWithParentForQB.Parents AS ServiceItemName
FROM         dbo.AccountEmployeeTimeEntry INNER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId INNER JOIN
                      dbo.AccountProjectTask ON dbo.AccountEmployeeTimeEntry.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId INNER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeEntry.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId INNER JOIN
                      dbo.AccountProjectMilestone ON dbo.AccountProjectTask.AccountProjectMilestoneId = dbo.AccountProjectMilestone.AccountProjectMilestoneId INNER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId AND 
                      dbo.AccountEmployee.AccountId = dbo.AccountDepartment.AccountId INNER JOIN
                      dbo.AccountEmployeeType ON dbo.AccountEmployee.EmployeePayTypeId = dbo.AccountEmployeeType.AccountEmployeeTypeId AND 
                      dbo.AccountEmployee.AccountId = dbo.AccountEmployeeType.AccountId INNER JOIN
                      dbo.vueAccountProjectTaskWithParentForQB ON 
                      dbo.AccountProjectTask.AccountProjectTaskId = dbo.vueAccountProjectTaskWithParentForQB.AccountProjectTaskId LEFT OUTER JOIN
                      dbo.AccountCostCenter ON dbo.AccountEmployeeTimeEntry.AccountCostCenterId = dbo.AccountCostCenter.AccountCostCenterId LEFT OUTER JOIN
                      dbo.AccountWorkType ON dbo.AccountEmployeeTimeEntry.AccountWorkTypeId = dbo.AccountWorkType.AccountWorkTypeId'

GO
-- Alter Column MilestoneDescription on AccountProjectMilestone
Print 'Alter Column MilestoneDescription on AccountProjectMilestone'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProjectMilestone' AND TABLE_TYPE='BASE TABLE')) AND (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='MilestoneDescription' AND TABLE_NAME='AccountProjectMilestone'))
ALTER TABLE [dbo].[AccountProjectMilestone]
	 ALTER COLUMN [MilestoneDescription] nvarchar(500) NOT NULL

GO

-- Drop View vueAccountEmployeeTimeOffForImportExport
Print 'Drop View vueAccountEmployeeTimeOffForImportExport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOffForImportExport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeOffForImportExport]

GO
-- Create View vueAccountEmployeeTimeOffForImportExport
Print 'Create View vueAccountEmployeeTimeOffForImportExport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOffForImportExport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeOffForImportExport
AS
SELECT     dbo.AccountEmployeeTimeEntry.TimeEntryDate, ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, 
                      dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) AS TotalTime, dbo.AccountTimeOffType.AccountTimeOffType, 
                      CASE WHEN dbo.AccountEmployee.IsDisabled = 1 THEN dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE dbo.AccountEmployee.FirstName
                       + '' '' + dbo.AccountEmployee.LastName END AS EmployeeName, dbo.AccountEmployeeTimeEntry.Description, dbo.AccountEmployeeTimeEntry.Approved, 
                      dbo.AccountEmployeeTimeEntry.Rejected, dbo.AccountProject.ProjectName, dbo.AccountEmployee.EMailAddress, dbo.AccountEmployee.AccountId, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeId, dbo.AccountEmployeeTimeEntry.Submitted
FROM         dbo.AccountEmployeeTimeEntry LEFT OUTER JOIN
                      dbo.AccountTimeOffType ON dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId LEFT OUTER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeEntry.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId
WHERE     (dbo.AccountEmployeeTimeEntry.IsTimeOff = 1) AND (dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeOffRequestId IS NULL)'

GO

-- Drop View vueAccountEmployeeTimeOffRequest
Print 'Drop View vueAccountEmployeeTimeOffRequest'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOffRequest' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeOffRequest]

GO
-- Create View vueAccountEmployeeTimeOffRequest
Print 'Create View vueAccountEmployeeTimeOffRequest'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeOffRequest' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeOffRequest
AS
SELECT     dbo.AccountEmployeeTimeOffRequest.AccountEmployeeTimeOffRequestId, dbo.AccountEmployeeTimeOffRequest.AccountTimeOffTypeId, 
                      dbo.AccountEmployeeTimeOffRequest.AccountEmployeeId, dbo.AccountEmployeeTimeOffRequest.RequestSubmitDate, 
                      dbo.AccountEmployeeTimeOffRequest.HoursOff, dbo.AccountEmployeeTimeOffRequest.StartDate, dbo.AccountEmployeeTimeOffRequest.EndDate, 
                      dbo.AccountEmployeeTimeOffRequest.InApproval, dbo.AccountEmployeeTimeOffRequest.Approved, dbo.AccountEmployeeTimeOffRequest.Rejected, 
                      dbo.AccountEmployeeTimeOffRequest.Description, dbo.AccountEmployeeTimeOffRequest.ApprovedOn, dbo.AccountEmployeeTimeOffRequest.ApprovedBy, 
                      dbo.AccountEmployeeTimeOffRequest.DayOff, dbo.AccountEmployeeTimeOffRequest.CreatedByEmployee, dbo.AccountEmployeeTimeOffRequest.CreatedOn, 
                      dbo.AccountEmployeeTimeOffRequest.ModifiedByEmployeeId, dbo.AccountEmployeeTimeOffRequest.ModifiedOn, dbo.AccountEmployeeTimeOffRequest.AccountId, 
                      dbo.AccountTimeOffType.AccountTimeOffType, dbo.AccountTimeOffType.IsTimeOffRequestRequired, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, 
                      CASE WHEN (dbo.AccountEmployeeTimeOffRequest.Approved IS NULL OR
                      dbo.AccountEmployeeTimeOffRequest.Approved = 0) AND (dbo.AccountEmployeeTimeOffRequest.Rejected IS NULL OR
                      dbo.AccountEmployeeTimeOffRequest.Rejected = 0) 
                      THEN ''Submitted'' WHEN dbo.AccountEmployeeTimeOffRequest.Approved = 1 THEN ''Approved'' WHEN dbo.AccountEmployeeTimeOffRequest.Rejected = 1 THEN ''Rejected''
                       END AS ApprovalStatus, dbo.AccountEmployeeTimeOff.Earned, dbo.AccountEmployeeTimeOff.Consume, dbo.AccountEmployeeTimeOff.Available, 
                      dbo.AccountEmployeeTimeOff.LastEarnedDate, dbo.AccountEmployeeTimeOff.CarryForward, dbo.AccountEmployeeTimeOff.LastResetDate, 
                      dbo.AccountEmployeeTimeOffRequest.AccountProjectId
FROM         dbo.AccountEmployeeTimeOffRequest INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeOffRequest.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeOff ON dbo.AccountEmployeeTimeOffRequest.AccountEmployeeId = dbo.AccountEmployeeTimeOff.AccountEmployeeId AND 
                      dbo.AccountEmployeeTimeOffRequest.AccountTimeOffTypeId = dbo.AccountEmployeeTimeOff.AccountTimeOffTypeId LEFT OUTER JOIN
                      dbo.AccountTimeOffType ON dbo.AccountEmployeeTimeOffRequest.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId'

GO
-- Create Table SystemTimeEntryHoursFormat
Print 'Create Table SystemTimeEntryHoursFormat'
GO
IF NOT EXISTS (select * from information_schema.tables where table_name = 'SystemTimeEntryHoursFormat' and table_type = 'BASE TABLE') 
CREATE TABLE [dbo].[SystemTimeEntryHoursFormat] (
		[SystemTimeEntryHoursFormatId]     uniqueidentifier NOT NULL,
		[SystemTimeEntryHoursFormat]       nvarchar(50) NULL
)

GO
-- Add Primary Key PK_SystemTimeEntryFormat to SystemTimeEntryHoursFormat
Print 'Add Primary Key PK_SystemTimeEntryHoursFormat to SystemTimeEntryHoursFormat'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'SystemTimeEntryHoursFormat' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_NAME='PK_SystemTimeEntryHoursFormat' AND TABLE_NAME='SystemTimeEntryHoursFormat'))
ALTER TABLE [dbo].[SystemTimeEntryHoursFormat]
	ADD
	CONSTRAINT [PK_SystemTimeEntryHoursFormat]
	PRIMARY KEY
	([SystemTimeEntryHoursFormatId])

GO
-- Add Default Constraint DF_SystemTimeEntryFormat_TimeEntryFormatId to SystemTimeEntryHoursFormat
Print 'Add Default Constraint DF_SystemTimeEntryHoursFormat_SystemTimeEntryHoursFormatId to SystemTimeEntryHoursFormat'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'SystemTimeEntryHoursFormat' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM sysobjects WHERE name= N'DF_SystemTimeEntryHoursFormat_SystemTimeEntryHoursFormatId'))
ALTER TABLE [dbo].[SystemTimeEntryHoursFormat]
	ADD
	CONSTRAINT [DF_SystemTimeEntryHoursFormat_SystemTimeEntryHoursFormatId]
	DEFAULT (newid()) FOR [SystemTimeEntryHoursFormatId]

GO
-- Alter Column CompletedPercent on AccountProjectTask
Print 'Alter Column CompletedPercent on AccountProjectTask'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProjectTask' AND TABLE_TYPE='BASE TABLE')) AND (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CompletedPercent' AND TABLE_NAME='AccountProjectTask'))
ALTER TABLE [dbo].[AccountProjectTask]
	 ALTER COLUMN [CompletedPercent] float NULL

GO
-- Add Column Percentage to AccountEmployeeTimeEntry
Print 'Add Column Percentage to AccountEmployeeTimeEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntry' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='Percentage' AND TABLE_NAME='AccountEmployeeTimeEntry'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntry]
	ADD [Percentage] int NULL

GO
-- Add Column TimeEntryHoursFormatId to AccountPreferences
Print 'Add Column TimeEntryHoursFormatId to AccountPreferences'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountPreferences' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='TimeEntryHoursFormatId' AND TABLE_NAME='AccountPreferences'))
ALTER TABLE [dbo].[AccountPreferences]
	ADD [TimeEntryHoursFormatId] uniqueidentifier NULL

GO
-- Add Column ShowPercentageInTimesheet to AccountPreferences
Print 'Add Column ShowPercentageInTimesheet to AccountPreferences'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountPreferences' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='ShowPercentageInTimesheet' AND TABLE_NAME='AccountPreferences'))
ALTER TABLE [dbo].[AccountPreferences]
	ADD [ShowPercentageInTimesheet] bit NULL

GO
-- Drop View vueAccount
Print 'Drop View vueAccount'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccount' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccount]

GO
-- Drop View vueAccountEmployee
Print 'Drop View vueAccountEmployee'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployee]

GO
-- Drop View vueAccountEmployeeTimeEntryWithStatus
Print 'Drop View vueAccountEmployeeTimeEntryWithStatus'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithStatus' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryWithStatus]

GO
-- Drop View vueAccountEmployeeTimeEntryWithTimeOffForReport
Print 'Drop View vueAccountEmployeeTimeEntryWithTimeOffForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithTimeOffForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryWithTimeOffForReport]

GO
-- Drop View rptvueAccountEmployeeTimeEntryPeriod
Print 'Drop View rptvueAccountEmployeeTimeEntryPeriod'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeEntryPeriod' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountEmployeeTimeEntryPeriod]

GO
-- Drop View vueAccountEmployeeTimeEntryPeriodForReport
Print 'Drop View vueAccountEmployeeTimeEntryPeriodForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPeriodForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryPeriodForReport]

GO
-- Drop View rptvueAccountEmployeeTimeEntry
Print 'Drop View rptvueAccountEmployeeTimeEntry'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeEntry' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountEmployeeTimeEntry]

GO
-- Drop View vueAccountEmployeeTimeEntryWithLastStatus
Print 'Drop View vueAccountEmployeeTimeEntryWithLastStatus'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithLastStatus' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryWithLastStatus]

GO
-- Create View vueAccount
Print 'Create View vueAccount'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccount' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccount
AS
SELECT     dbo.Account.AccountId, dbo.Account.AccountTypeId, dbo.Account.AccountName, dbo.Account.Address1, dbo.Account.Address2, dbo.Account.ZipCode, dbo.Account.State, 
                      dbo.Account.City, dbo.Account.CountryId, dbo.Account.EMailAddress, dbo.Account.Telephone, dbo.Account.Fax, dbo.Account.DefaultCurrencyId, 
                      dbo.Account.TimeZoneId, dbo.Account.IsDisabled, dbo.Account.IsDeleted, dbo.Account.StatusId, dbo.Account.CreatedOn, dbo.Account.ModifiedOn, 
                      dbo.Account.ModifiedByEmployeeId, dbo.AccountPreferences.ShowClockStartEnd, dbo.AccountPreferences.AccountPreferencesId, dbo.Account.LicenseKey, 
                      dbo.Account.SystemPackageTypeId, dbo.AccountPreferences.TimeEntryFormat, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.Account.MachineId, dbo.Account.ActivationLicenseKey, dbo.Account.ActivationMachineKey, 
                      dbo.Account.ActivationType, dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountPreferences.InvoiceBillingTypeId, 
                      dbo.AccountPreferences.ShowBillingRateInInvoiceReport, dbo.AccountPreferences.InvoiceFooter, dbo.AccountPreferences.ShowProjectNameInInvoiceReport, 
                      dbo.AccountPreferences.ProjectCodePrefix, dbo.AccountPreferences.AutoGenerateProjectCode, dbo.AccountPreferences.TimeEntryHoursFormatId, 
                      dbo.AccountPreferences.ShowPercentageInTimesheet
FROM         dbo.Account INNER JOIN
                      dbo.AccountPreferences ON dbo.Account.AccountId = dbo.AccountPreferences.AccountId'

GO
-- Create View vueAccountEmployee
Print 'Create View vueAccountEmployee'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployee
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountEmployee.AccountId, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.Password, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountLocationId, dbo.AccountEmployee.BillingTypeId, 
                      dbo.AccountBillingType.BillingType, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, dbo.AccountPreferences.ShowClockStartEnd, dbo.Account.TimeZoneId, 
                      dbo.AccountRole.MasterAccountRoleId, dbo.Account.DefaultCurrencyId, dbo.Account.CountryId, dbo.AccountPreferences.CultureInfoName, 
                      dbo.AccountPreferences.TimeEntryFormat, dbo.AccountEmployee.AllowedAccessFromIP, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountPreferences.AccountSessionTimeout, dbo.AccountPreferences.ShowCompletedTasksInTimeSheet, dbo.AccountPreferences.CurrencySymbol, 
                      dbo.AccountPreferences.IsCompanyOwnLogo, dbo.Account.AccountExpiryActivation, dbo.Account.LicenseActivation, dbo.AccountEmployee.EmployeeTypeId, 
                      dbo.AccountEmployee.ExternalUserClientId, dbo.AccountEmployee.AccountBillingRateId, dbo.AccountPreferences.ScheduledEmailSendTime, 
                      dbo.AccountEmployee.Username, dbo.AccountEmployee.IsDisabled, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.AccountEmployee.EmployeeCode, dbo.AccountPreferences.Version, 
                      dbo.AccountPreferences.LockSubmittedRecords, dbo.AccountPreferences.LockApprovedRecords, ISNULL(dbo.AccountEmployee.EmployeeCode + '' - '', '''') 
                      + dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeNameWithCode, dbo.AccountPreferences.ShowWorkTypeInTimeSheet, 
                      dbo.AccountPreferences.NumberOfBlankRowsInTimeEntry, dbo.AccountPreferences.ShowCostCenterInTimeSheet, dbo.AccountPreferences.WeekStartDay, 
                      dbo.AccountPreferences.AccountBaseCurrencyId, dbo.AccountPreferences.UserInterfaceLanguage, dbo.AccountEmployee.EmployeeManagerId, 
                      dbo.AccountPreferences.DefaultTimeEntryMode, dbo.AccountPreferences.PageSize, dbo.AccountEmployee.TimeZoneId AS EmployeeTimeZoneId, 
                      dbo.AccountEmployee.TerminationDate, dbo.AccountEmployee.StatusId, dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.EmployeePayTypeId, 
                      dbo.AccountEmployee.HiredDate, dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountWorkingDayType, 
                      dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay AS EmployeeWeekStartDay, 
                      dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountPreferences.ShowDescriptionInWeekView, 
                      dbo.AccountPreferences.InvoiceNoPrefix, dbo.AccountPreferences.ShowAdditionalTaskInformationType, 
                      dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, 
                      ISNULL(dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, 1) AS InitialDayOfTheMonth, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, 1) 
                      AS SystemInitialDayOfFirstPeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod, 16) AS SystemInitialDayOfLastPeriod, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountPreferences.TimesheetPrintFooter, dbo.AccountPreferences.ExpenseSheetPrintFooter, 
                      dbo.AccountPreferences.ShowCompletedProjectsInTimeSheet, dbo.AccountPreferences.ShowProjectForTimeOff, dbo.AccountPreferences.ShowTimeOffInTimesheet, 
                      dbo.AccountEmployee.IsDeleted, dbo.AccountEmployee.IsForcePasswordChange, dbo.AccountEmployee.PasswordChangedDate, 
                      dbo.AccountPreferences.PasswordExpiryPeriod, dbo.AccountPreferences.ShowAllInTimesheetReadOnly, dbo.AccountPreferences.ShowTaskInExpenseSheet, 
                      dbo.AccountPreferences.InvoiceBillingTypeId, dbo.AccountPreferences.ShowBillingRateInInvoiceReport, dbo.SystemInvoiceBillingType.InvoiceBillingType, 
                      dbo.AccountPreferences.InvoiceFooter, dbo.AccountPreferences.TimesheetOverduePeriods, dbo.AccountWorkingDayType.TimesheetOverdueAfterDays, 
                      dbo.AccountEmployee.CreatedOn, dbo.AccountEmployee.CreatedByEmployeeId, dbo.AccountEmployee.ModifiedOn, dbo.AccountEmployee.ModifiedByEmployeeId, 
                      dbo.AccountPreferences.ShowProjectNameInInvoiceReport, dbo.AccountPreferences.ProjectCodePrefix, dbo.AccountPreferences.AutoGenerateProjectCode, 
                      dbo.AccountPreferences.TimeEntryHoursFormatId, dbo.AccountPreferences.ShowPercentageInTimesheet
FROM         dbo.SystemInvoiceBillingType RIGHT OUTER JOIN
                      dbo.AccountPreferences ON dbo.SystemInvoiceBillingType.InvoiceBillingTypeId = dbo.AccountPreferences.InvoiceBillingTypeId RIGHT OUTER JOIN
                      dbo.vueAccountTimesheetPeriodType RIGHT OUTER JOIN
                      dbo.AccountWorkingDayType ON 
                      dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId = dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId RIGHT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.Account ON dbo.AccountEmployee.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId ON 
                      dbo.AccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId ON 
                      dbo.AccountPreferences.AccountId = dbo.AccountEmployee.AccountId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId'

GO
-- Create View vueAccountEmployeeTimeEntryWithLastStatus
Print 'Create View vueAccountEmployeeTimeEntryWithLastStatus'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithLastStatus' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryWithLastStatus
AS
SELECT     dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, dbo.AccountEmployeeTimeEntry.AccountEmployeeId, dbo.AccountEmployeeTimeEntry.TimeEntryDate, 
                      dbo.AccountEmployeeTimeEntry.StartTime, dbo.AccountEmployeeTimeEntry.EndTime, dbo.AccountEmployeeTimeEntry.TotalTime, 
                      dbo.AccountEmployeeTimeEntry.AccountProjectId, dbo.AccountEmployeeTimeEntry.AccountProjectTaskId, dbo.AccountEmployeeTimeEntry.Description, 
                      dbo.AccountEmployeeTimeEntry.TimeSheetApprovalPathId, dbo.AccountEmployeeTimeEntry.Approved, dbo.AccountEmployeeTimeEntry.TeamLeadApproved, 
                      dbo.AccountEmployeeTimeEntry.ProjectManagerApproved, dbo.AccountEmployeeTimeEntry.AdministratorApproved, dbo.AccountEmployeeTimeEntry.CreatedOn, 
                      dbo.AccountEmployeeTimeEntry.ModifiedOn, dbo.AccountEmployeeTimeEntry.Rejected, dbo.AccountEmployeeTimeEntry.BillingRate, 
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction.IsApproved, dbo.vueAccountEmployeeTimeEntryApprovalLastAction.IsReject, 
                      dbo.AccountEmployeeTimeEntry.AccountPartyId, dbo.AccountEmployeeTimeEntry.Submitted, dbo.AccountEmployeeTimeEntry.AccountWorkTypeId, 
                      dbo.AccountEmployeeTimeEntry.AccountCostCenterId, dbo.vueAccountEmployeeTimeEntryApprovalLastAction.ApprovedByEmployeeId, 
                      dbo.AccountProject.ProjectName, dbo.AccountProjectTask.TaskName, dbo.AccountCostCenter.AccountCostCenter, dbo.AccountWorkType.AccountWorkType, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId, dbo.AccountParty.PartyName, dbo.AccountParty.AccountPartyId AS AccountClientId, 
                      dbo.AccountParty.PartyNick, dbo.vueAccountEmployeeTimeEntryApprovalLastAction.ApprovedOn, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId, dbo.AccountEmployeeTimeEntry.IsTimeOff, dbo.AccountEmployeeTimeEntry.Hours, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeOffRequestId, 
                      dbo.AccountEmployeeTimeEntry.Percentage
FROM         dbo.AccountParty INNER JOIN
                      dbo.AccountProject ON dbo.AccountParty.AccountPartyId = dbo.AccountProject.AccountClientId RIGHT OUTER JOIN
                      dbo.AccountEmployeeTimeEntry LEFT OUTER JOIN
                      dbo.AccountWorkType ON dbo.AccountEmployeeTimeEntry.AccountWorkTypeId = dbo.AccountWorkType.AccountWorkTypeId ON 
                      dbo.AccountProject.AccountProjectId = dbo.AccountEmployeeTimeEntry.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountProjectTask ON dbo.AccountEmployeeTimeEntry.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId LEFT OUTER JOIN
                      dbo.AccountCostCenter ON dbo.AccountEmployeeTimeEntry.AccountCostCenterId = dbo.AccountCostCenter.AccountCostCenterId LEFT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryApprovalLastAction.AccountEmployeeTimeEntryId'

GO
-- Create View vueAccountEmployeeTimeEntryWithTimeOffForReport
Print 'Create View vueAccountEmployeeTimeEntryWithTimeOffForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithTimeOffForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport
AS
SELECT     CASE WHEN dbo.AccountEmployee.IsDisabled = 1 THEN dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE dbo.AccountEmployee.FirstName
                       + '' '' + dbo.AccountEmployee.LastName END AS EmployeeName, dbo.AccountProject.ProjectName, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 1 THEN AccountProjectTask_1.TaskName ELSE dbo.AccountTimeOffType.AccountTimeOffType END AS TaskName,
                       dbo.AccountEmployeeTimeEntry.TotalTime, dbo.AccountEmployeeTimeEntry.Approved, dbo.AccountEmployee.AccountEmployeeId, 
                      dbo.AccountProject.AccountProjectId, dbo.AccountEmployeeTimeEntry.TeamLeadApproved, dbo.AccountEmployeeTimeEntry.ProjectManagerApproved, 
                      dbo.AccountEmployeeTimeEntry.AdministratorApproved, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, dbo.AccountEmployeeTimeEntry.StartTime, 
                      dbo.AccountEmployeeTimeEntry.EndTime, dbo.AccountEmployeeTimeEntry.TimeEntryDate, dbo.AccountEmployeeTimeEntry.Description, 
                      ISNULL(dbo.AccountProject.AccountId, dbo.AccountTimeOffType.AccountId) AS AccountId, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime) AS TotalMinutes, DATEPART(dw, dbo.AccountEmployeeTimeEntry.TimeEntryDate) AS WeekDay, 
                      dbo.AccountParty.AccountPartyId, dbo.AccountParty.PartyName, AccountProjectTask_1.AccountProjectTaskId, dbo.AccountBillingType.BillingType, 
                      dbo.AccountProject.LeaderEmployeeId, dbo.AccountProject.ProjectManagerEmployeeId, dbo.AccountProject.TimeSheetApprovalTypeId, 
                      dbo.AccountProject.ExpenseApprovalTypeId, AccountProjectTask_1.IsBillable, dbo.AccountEmployeeTimeEntry.Rejected, dbo.AccountEmployeeTimeEntry.BillingRate, 
                      dbo.AccountProject.ProjectBillingRateTypeId, dbo.AccountEmployee.EmployeeCode, dbo.AccountEmployee.AccountDepartmentId, 
                      dbo.AccountDepartment.DepartmentName, AccountProjectTask_1.EstimatedCost, AccountProjectTask_1.EstimatedTimeSpent, 
                      dbo.AccountEmployeeTimeEntry.Submitted, dbo.AccountWorkType.AccountWorkType, dbo.AccountEmployee.EMailAddress, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountCostCenter.AccountCostCenter, dbo.AccountCostCenter.AccountCostCenterCode, dbo.AccountWorkType.AccountWorkTypeCode, 
                      dbo.AccountProject.ProjectCode, AccountProjectTask_1.TaskCode, dbo.AccountLocation.AccountLocationId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction.Comments, dbo.AccountEmployeeTimeEntry.BillingRateCurrencyId, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateCurrencyId, dbo.AccountEmployeeTimeEntry.BillingRateExchangeRate, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateExchangeRate, dbo.AccountEmployeeTimeEntry.AccountBaseCurrencyId, AccountProjectTask_1.AccountTaskTypeId, 
                      AccountProjectTask_1.TaskStatusId, AccountProjectTask_1.AccountPriorityId, AccountProjectTask_1.AccountProjectMilestoneId, 
                      dbo.AccountDepartment.DepartmentCode, dbo.AccountParty.PartyNick, AccountProjectTask_1.EstimatedCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction.ApprovedOn, dbo.AccountEmployeeTimeEntry.EmployeeRate, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountRole.Role, dbo.AccountProject.AccountProjectTypeId, dbo.AccountProject.ProjectDescription, AccountProjectTask_1.TaskDescription, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeExpenseBillingTimesheetId, dbo.AccountEmployeeTimeEntry.Billed, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Submitted = 1 THEN (CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, 
                      dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS SubmittedHours, CASE WHEN dbo.AccountEmployeeTimeEntry.Approved = 1 THEN (CONVERT(float, 
                      DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS ApprovedHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Rejected = 1 THEN (CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, 
                      dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS RejectedHours, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, 
                      dbo.AccountPartyContact.FirstName + N'' '' + dbo.AccountPartyContact.LastName AS ClientContactName, 
                      dbo.AccountPartyDepartment.PartyDepartmentCode AS ClientDepartmentCode, dbo.AccountPartyDepartment.PartyDepartmentName AS ClientDepartmentName, 
                      dbo.AccountPartyDepartment.PartyDepartmentLocation AS ClientDepartmentLocation, dbo.AccountEmployeeTimeEntry.IsTimeOff, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId, CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 0 THEN (CONVERT(float, DATEPART(hh, 
                      dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS TimeOffHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 1 THEN (CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, 
                      dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS TimesheetHours, dbo.AccountWorkType.AccountWorkTypeId, dbo.AccountStatus.Status AS ProjectStatus, 
                      AccountProjectTask_1.ParentAccountProjectTaskId, dbo.AccountProjectTask.TaskName AS ParentTaskName, dbo.AccountEmployee.IsDisabled, 
                      dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, ISNULL(dbo.AccountEmployeeType.AccountEmployeeType, N'''') AS EmployeeType, 
                      ISNULL(dbo.AccountHolidayTypeDetail.HolidayName, N'''') AS HolidayName, dbo.AccountEmployeeTimeEntry.Percentage
FROM         dbo.AccountHolidayTypeDetail RIGHT OUTER JOIN
                      dbo.AccountEmployeeTimeEntry INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeEntry.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId ON 
                      dbo.AccountHolidayTypeDetail.AccountHolidayTypeId = dbo.AccountEmployee.AccountHolidayTypeId AND 
                      dbo.AccountHolidayTypeDetail.AccountId = dbo.AccountEmployee.AccountId AND 
                      dbo.AccountHolidayTypeDetail.HolidayDate = dbo.AccountEmployeeTimeEntry.TimeEntryDate LEFT OUTER JOIN
                      dbo.AccountEmployeeType ON dbo.AccountEmployee.EmployeePayTypeId = dbo.AccountEmployeeType.AccountEmployeeTypeId LEFT OUTER JOIN
                      dbo.AccountProjectTask AS AccountProjectTask_1 LEFT OUTER JOIN
                      dbo.AccountProjectTask ON AccountProjectTask_1.ParentAccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId ON 
                      dbo.AccountEmployeeTimeEntry.AccountProjectTaskId = AccountProjectTask_1.AccountProjectTaskId LEFT OUTER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountStatus ON dbo.AccountProject.ProjectStatusId = dbo.AccountStatus.AccountStatusId LEFT OUTER JOIN
                      dbo.AccountTimeOffType ON dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId LEFT OUTER JOIN
                      dbo.AccountPartyDepartment ON dbo.AccountProject.AccountPartyDepartmentId = dbo.AccountPartyDepartment.AccountPartyDepartmentId LEFT OUTER JOIN
                      dbo.AccountPartyContact ON dbo.AccountProject.AccountPartyContactId = dbo.AccountPartyContact.AccountPartyContactId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryPeriod ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId LEFT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryApprovalLastAction.AccountEmployeeTimeEntryId LEFT OUTER JOIN
                      dbo.AccountCostCenter ON dbo.AccountEmployeeTimeEntry.AccountCostCenterId = dbo.AccountCostCenter.AccountCostCenterId LEFT OUTER JOIN
                      dbo.AccountWorkType ON dbo.AccountEmployeeTimeEntry.AccountWorkTypeId = dbo.AccountWorkType.AccountWorkTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId LEFT OUTER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId'

GO
-- Create View vueAccountEmployeeTimeEntryPeriodForReport
Print 'Create View vueAccountEmployeeTimeEntryPeriodForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPeriodForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryPeriodForReport
AS
SELECT     dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId, dbo.AccountEmployeeTimeEntryPeriod.AccountId, 
                      dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeId, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, 
                      dbo.AccountEmployeeTimeEntryPeriod.Submitted, dbo.AccountEmployeeTimeEntryPeriod.Approved, dbo.AccountEmployeeTimeEntryPeriod.Rejected, 
                      dbo.AccountEmployeeTimeEntryPeriod.InApproval, dbo.AccountEmployeeTimeEntryPeriod.SubmittedDate, dbo.vueAccountEmployee.EmployeeName, 
                      dbo.vueAccountEmployee.AccountLocationId, dbo.vueAccountEmployee.AccountDepartmentId, dbo.vueAccountEmployee.AccountLocation, 
                      dbo.vueAccountEmployee.Role, dbo.vueAccountEmployee.DepartmentName, dbo.vueAccountEmployee.EMailAddress, dbo.vueAccountEmployee.AccountRoleId, 
                      CASE WHEN AccountEmployeeTimeEntryPeriod.Submitted = 1 AND 
                      AccountEmployeeTimeEntryPeriod.Approved = 0 THEN ''Submitted'' WHEN AccountEmployeeTimeEntryPeriod.Approved = 1 THEN ''Approved'' WHEN AccountEmployeeTimeEntryPeriod.Rejected
                       = 1 THEN ''Rejected'' WHEN AccountEmployeeTimeEntryPeriod.Submitted = 0 AND AccountEmployeeTimeEntryPeriod.Approved = 0 AND 
                      AccountEmployeeTimeEntryPeriod.Rejected = 0 THEN ''Not Submitted'' END AS ApprovalStatus, 
                      { fn DAYOFMONTH(dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate) } AS DayNo, MONTH(dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate) 
                      AS MonthNo, DATEPART(week, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate) - DATEPART(week, DATEADD(month, DATEDIFF(month, 0, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate), 0)) + 1 AS WeekNo, YEAR(dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate) AS Year, 
                      LEFT({ fn MONTHNAME(dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate) }, 3) + '' - '' + CONVERT(nvarchar(10), 
                      YEAR(dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate)) AS Period, { fn DAYNAME(dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate) 
                      } AS WeekDayName, SUM(CONVERT(float, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes) / 60) AS TotalHours, 
                      SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes * dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRate / 60, 0)) 
                      AS Amount, SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRate, 0)) AS BillingRate, 
                      SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.SubmittedHours, 0)) AS SubmittedHours, 
                      SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ApprovedHours, 0)) AS ApprovedHours, 
                      SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.RejectedHours, 0)) AS RejectedHours, ISNULL(dbo.vueAccountEmployee.EmployeeCode, '''') 
                      AS EmployeeCode, SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateExchangeRate, 0)) AS BillingRateExchangeRate, 
                      dbo.AccountEmployeeTimeEntryPeriod.ApprovedOn, dbo.AccountEmployeeTimeEntryPeriod.RejectedOn, 
                      dbo.AccountEmployeeTimeEntryPeriod.ApprovedByEmployeeId, dbo.AccountEmployeeTimeEntryPeriod.RejectedByEmployeeId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientContactName, N'''') AS ClientContactName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentCode, N'''') AS ClientDepartmentCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentName, N'''') AS ClientDepartmentName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentLocation, N'''') AS ClientDepartmentLocation, 
                      SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeOffHours, 0)) AS TimeOffHours, 
                      SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimesheetHours, 0)) AS TimesheetHours, 
                      SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Percentage, 0)) AS Percentage
FROM         dbo.AccountEmployeeTimeEntryPeriod INNER JOIN
                      dbo.vueAccountEmployee ON dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeId = dbo.vueAccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport ON 
                      dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeTimeEntryPeriodId
GROUP BY dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId, dbo.AccountEmployeeTimeEntryPeriod.AccountId, 
                      dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeId, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, 
                      dbo.AccountEmployeeTimeEntryPeriod.Submitted, dbo.AccountEmployeeTimeEntryPeriod.Approved, dbo.AccountEmployeeTimeEntryPeriod.Rejected, 
                      dbo.AccountEmployeeTimeEntryPeriod.InApproval, dbo.AccountEmployeeTimeEntryPeriod.SubmittedDate, dbo.vueAccountEmployee.EmployeeName, 
                      dbo.vueAccountEmployee.AccountLocationId, dbo.vueAccountEmployee.AccountDepartmentId, dbo.vueAccountEmployee.AccountLocation, 
                      dbo.vueAccountEmployee.Role, dbo.vueAccountEmployee.DepartmentName, dbo.vueAccountEmployee.EMailAddress, dbo.vueAccountEmployee.AccountRoleId, 
                      dbo.vueAccountEmployee.EmployeeCode, dbo.AccountEmployeeTimeEntryPeriod.ApprovedOn, dbo.AccountEmployeeTimeEntryPeriod.RejectedOn, 
                      dbo.AccountEmployeeTimeEntryPeriod.ApprovedByEmployeeId, dbo.AccountEmployeeTimeEntryPeriod.RejectedByEmployeeId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientContactName, N''''), 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentCode, N''''), 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentName, N''''), 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentLocation, N'''')'

GO
-- Create View vueAccountEmployeeTimeEntryWithStatus
Print 'Create View vueAccountEmployeeTimeEntryWithStatus'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithStatus' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryWithStatus
AS
SELECT     dbo.AccountCostCenter.AccountCostCenter, dbo.AccountProject.ProjectName, dbo.AccountWorkType.AccountWorkType, dbo.AccountProjectTask.TaskName, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, dbo.AccountEmployeeTimeEntry.AccountEmployeeId, dbo.AccountEmployeeTimeEntry.TimeEntryDate, 
                      dbo.AccountEmployeeTimeEntry.StartTime, dbo.AccountEmployeeTimeEntry.EndTime, dbo.AccountEmployeeTimeEntry.TotalTime, 
                      dbo.AccountEmployeeTimeEntry.AccountProjectId, dbo.AccountEmployeeTimeEntry.AccountProjectTaskId, dbo.AccountEmployeeTimeEntry.Description, 
                      dbo.AccountEmployeeTimeEntry.TimeSheetApprovalPathId, dbo.AccountEmployeeTimeEntry.Approved, dbo.AccountEmployeeTimeEntry.TeamLeadApproved, 
                      dbo.AccountEmployeeTimeEntry.ProjectManagerApproved, dbo.AccountEmployeeTimeEntry.AdministratorApproved, dbo.AccountEmployeeTimeEntry.CreatedOn, 
                      dbo.AccountEmployeeTimeEntry.ModifiedOn, dbo.AccountEmployeeTimeEntry.Rejected, dbo.AccountEmployeeTimeEntry.BillingRate, 
                      dbo.AccountEmployeeTimeEntry.AccountPartyId, dbo.AccountEmployeeTimeEntry.Submitted, dbo.AccountEmployeeTimeEntry.AccountWorkTypeId, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRate, dbo.AccountEmployeeTimeEntry.AccountCostCenterId, dbo.AccountEmployeeTimeEntry.BillingRateCurrencyId, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateCurrencyId, dbo.AccountEmployeeTimeEntry.BillingRateExchangeRate, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateExchangeRate, dbo.AccountEmployeeTimeEntry.AccountBaseCurrencyId, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeExpenseBillingTimesheetId, dbo.AccountEmployeeTimeEntry.Billed, 
                      dbo.AccountEmployeeTimeEntryApprovalProject.InApproval AS IsApproved, dbo.AccountEmployeeTimeEntryApprovalProject.IsRejected AS IsReject, 
                      dbo.AccountParty.PartyName, dbo.AccountParty.PartyNick, dbo.AccountParty.AccountPartyId AS AccountClientId, 
                      dbo.AccountEmployeeTimeEntryPeriod.PeriodDescription, dbo.AccountParty.AccountId, dbo.AccountEmployeeTimeEntry.IsTimeOff, 
                      dbo.AccountEmployeeTimeEntry.Hours, dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeOffRequestId, 
                      dbo.AccountTimeOffType.AccountTimeOffType, dbo.AccountTimeOffType.IsTimeOffRequestRequired, 
                      dbo.AccountEmployeeTimeEntryApprovalProject.Approved AS ProjectApproved, dbo.AccountEmployeeTimeEntry.Percentage
FROM         dbo.AccountEmployeeTimeEntryPeriod RIGHT OUTER JOIN
                      dbo.AccountEmployeeTimeEntry LEFT OUTER JOIN
                      dbo.AccountTimeOffType ON dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId ON 
                      dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryApprovalProject ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId = dbo.AccountEmployeeTimeEntryApprovalProject.AccountEmployeeTimeEntryApprovalProjectId
                       LEFT OUTER JOIN
                      dbo.AccountParty INNER JOIN
                      dbo.AccountProject ON dbo.AccountParty.AccountPartyId = dbo.AccountProject.AccountClientId ON 
                      dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountProjectTask ON dbo.AccountEmployeeTimeEntry.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId LEFT OUTER JOIN
                      dbo.AccountWorkType ON dbo.AccountEmployeeTimeEntry.AccountWorkTypeId = dbo.AccountWorkType.AccountWorkTypeId LEFT OUTER JOIN
                      dbo.AccountCostCenter ON dbo.AccountEmployeeTimeEntry.AccountCostCenterId = dbo.AccountCostCenter.AccountCostCenterId'

GO
-- Create View rptvueAccountEmployeeTimeEntryPeriod
Print 'Create View rptvueAccountEmployeeTimeEntryPeriod'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeEntryPeriod' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountEmployeeTimeEntryPeriod
AS
SELECT     dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountEmployeeTimeEntryPeriodId, dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountId, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountEmployeeId, dbo.vueAccountEmployeeTimeEntryPeriodForReport.TimeEntryStartDate, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.TimeEntryEndDate, dbo.vueAccountEmployeeTimeEntryPeriodForReport.TimeEntryViewType, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.Submitted, dbo.vueAccountEmployeeTimeEntryPeriodForReport.Approved, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.Rejected, dbo.vueAccountEmployeeTimeEntryPeriodForReport.InApproval, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.SubmittedDate, dbo.vueAccountEmployeeTimeEntryPeriodForReport.EmployeeName, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountLocationId, dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountDepartmentId, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountLocation, dbo.vueAccountEmployeeTimeEntryPeriodForReport.Role, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.DepartmentName, dbo.vueAccountEmployeeTimeEntryPeriodForReport.EMailAddress, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountRoleId, dbo.vueAccountEmployeeTimeEntryPeriodForReport.ApprovalStatus, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.DayNo, dbo.vueAccountEmployeeTimeEntryPeriodForReport.MonthNo, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.WeekNo, dbo.vueAccountEmployeeTimeEntryPeriodForReport.Year, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.Period, dbo.vueAccountEmployeeTimeEntryPeriodForReport.WeekDayName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryPeriodForReport.TotalHours, 0) AS TotalHours, dbo.vueAccountEmployeeTimeEntryPeriodForReport.Amount, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.BillingRate, dbo.vueAccountEmployeeTimeEntryPeriodForReport.SubmittedHours, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.ApprovedHours, dbo.vueAccountEmployeeTimeEntryPeriodForReport.RejectedHours, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.EmployeeCode, 
                      CASE WHEN BillingRateExchangeRate > 0 THEN Amount / BillingRateExchangeRate ELSE 0 END AS CurrencyAmount, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryPeriodForReport.Approved = 1 THEN dbo.vueAccountEmployeeTimeEntryPeriodForReport.ApprovedOn ELSE NULL 
                      END AS ApprovedDate, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryPeriodForReport.Rejected = 1 THEN dbo.vueAccountEmployeeTimeEntryPeriodForReport.RejectedOn ELSE NULL 
                      END AS RejectedDate, AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName AS ApprovedByEmployeeName, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS RejectedByEmployeeName, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.ClientContactName, dbo.vueAccountEmployeeTimeEntryPeriodForReport.ClientDepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.ClientDepartmentName, dbo.vueAccountEmployeeTimeEntryPeriodForReport.ClientDepartmentLocation, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.TimeOffHours, dbo.vueAccountEmployeeTimeEntryPeriodForReport.TimesheetHours, 
                      dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, dbo.AccountWorkingDayType.MinimumHoursPerWeek, 
                      dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.Percentage
FROM         dbo.AccountWorkingDayType RIGHT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport ON 
                      dbo.AccountWorkingDayType.AccountId = dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountId LEFT OUTER JOIN
                      dbo.AccountEmployee ON dbo.vueAccountEmployeeTimeEntryPeriodForReport.RejectedByEmployeeId = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.ApprovedByEmployeeId = AccountEmployee_1.AccountEmployeeId'

GO
-- Create View rptvueAccountEmployeeTimeEntry
Print 'Create View rptvueAccountEmployeeTimeEntry'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeEntry' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountEmployeeTimeEntry
AS
SELECT     dbo.vueAccountEmployeeTimeEntryForReport.EmployeeName, dbo.vueAccountEmployeeTimeEntryForReport.ProjectName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskName, dbo.vueAccountEmployeeTimeEntryForReport.TotalTime, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Approved, dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectId, dbo.vueAccountEmployeeTimeEntryForReport.TeamLeadApproved, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManagerApproved, dbo.vueAccountEmployeeTimeEntryForReport.AdministratorApproved, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeTimeEntryId, dbo.vueAccountEmployeeTimeEntryForReport.StartTime, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EndTime, dbo.vueAccountEmployeeTimeEntryForReport.TimeEntryDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Description, dbo.vueAccountEmployeeTimeEntryForReport.AccountId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TotalMinutes, dbo.vueAccountEmployeeTimeEntryForReport.WeekDay, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientName, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectTaskId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingType, dbo.vueAccountEmployeeTimeEntryForReport.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManagerEmployeeId, dbo.vueAccountEmployeeTimeEntryForReport.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ExpenseApprovalTypeId, dbo.vueAccountEmployeeTimeEntryForReport.IsBillable, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Rejected, dbo.vueAccountEmployeeTimeEntryForReport.BillingRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectBillingRateTypeId, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountDepartmentId, dbo.vueAccountEmployeeTimeEntryForReport.DepartmentName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCost, dbo.vueAccountEmployeeTimeEntryForReport.EstimatedHours, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Submitted, dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkType, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EMailAddress, dbo.vueAccountEmployeeTimeEntryForReport.AccountLocation, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountCostCenter, dbo.vueAccountEmployeeTimeEntryForReport.AccountCostCenterCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkTypeCode, dbo.vueAccountEmployeeTimeEntryForReport.ProjectCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCode, dbo.vueAccountEmployeeTimeEntryForReport.AccountLocationId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ApproverComments, dbo.vueAccountEmployeeTimeEntryForReport.Amount, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingRateCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountBaseCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.BillingRateCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AmountCurrencyCode, CASE WHEN vueAccountEmployeeTimeEntryForReport.Submitted = 1 AND 
                      vueAccountEmployeeTimeEntryForReport.Approved = 0 THEN ''Submitted'' WHEN vueAccountEmployeeTimeEntryForReport.Approved = 1 THEN ''Approved'' WHEN vueAccountEmployeeTimeEntryForReport.Rejected
                       = 1 THEN ''Rejected'' WHEN vueAccountEmployeeTimeEntryForReport.Submitted = 0 AND vueAccountEmployeeTimeEntryForReport.Approved = 0 AND 
                      vueAccountEmployeeTimeEntryForReport.Rejected = 0 THEN ''Not Submitted'' END AS ApprovalStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountTaskTypeId, dbo.vueAccountEmployeeTimeEntryForReport.TaskStatusId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountPriorityId, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectMilestoneId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskType, dbo.vueAccountEmployeeTimeEntryForReport.TaskStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.MilestoneDescription, dbo.vueAccountEmployeeTimeEntryForReport.Priority, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TotalHours, dbo.vueAccountEmployeeTimeEntryForReport.DepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientNick, dbo.vueAccountEmployeeTimeEntryForReport.AccountClientId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ApprovedOn, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateCurrencyCode, dbo.vueAccountEmployeeTimeEntryForReport.TeamLeader, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManager, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeManager, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate, 0) AS EstimatedCurrencyExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCost, dbo.vueAccountEmployeeTimeEntryForReport.AccountRoleId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Role, dbo.vueAccountEmployeeTimeEntryForReport.WeekDayName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Period, dbo.vueAccountEmployeeTimeEntryForReport.Year, dbo.vueAccountEmployeeTimeEntryForReport.WeekNo, 
                      dbo.vueAccountEmployeeTimeEntryForReport.MonthNo, dbo.vueAccountEmployeeTimeEntryForReport.DayNo, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 1 THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours ELSE 0 END AS BillableTotalHours,
                       CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable
                       IS NULL THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours ELSE 0 END AS NonBillableTotalHours, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCost / dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate
                       ELSE 0 END AS CurrencyEmployeeCost, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.Amount / dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate
                       ELSE 0 END AS CurrencyAmount, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCost / dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate
                       ELSE 0 END AS CurrencyEstimatedCost, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate / dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate
                       ELSE 0 END AS CurrencyBillingRate, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRate / dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate
                       ELSE 0 END AS CurrencyEmployeeRate, dbo.vueAccountEmployeeTimeEntryForReport.ProjectRole, dbo.vueAccountEmployeeTimeEntryForReport.ProjectType, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectDescription, dbo.vueAccountEmployeeTimeEntryForReport.TaskDescription, 
                      dbo.vueAccountEmployeeTimeEntryForReport.InvoiceNumber, dbo.vueAccountEmployeeTimeEntryForReport.InvoiceDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectTypeId, dbo.vueAccountEmployeeTimeEntryForReport.Billed, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientContactName, dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentName, dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentLocation, 
                      dbo.vueAccountEmployeeTimeEntryForReport.IsTimeOff, dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkTypeId, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 1 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate * dbo.vueAccountEmployeeTimeEntryForReport.TotalHours
                       ELSE 0 END AS BillableTotalAmount, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate * dbo.vueAccountEmployeeTimeEntryForReport.TotalHours
                       ELSE 0 END AS NonBillableTotalAmount, dbo.vueAccountEmployeeTimeEntryForReport.ProjectStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ParentTaskName, dbo.vueAccountEmployeeTimeEntryForReport.FirstName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.LastName, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeType, 
                      dbo.vueAccountEmployeeTimeEntryForReport.HolidayName, SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithLastStatus.Percentage, 0)) AS Percentage
FROM         dbo.vueAccountEmployeeTimeEntryForReport INNER JOIN
                      dbo.vueAccountEmployeeTimeEntryWithLastStatus ON 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryWithLastStatus.AccountEmployeeTimeEntryId
GROUP BY dbo.vueAccountEmployeeTimeEntryForReport.EmployeeName, dbo.vueAccountEmployeeTimeEntryForReport.ProjectName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskName, dbo.vueAccountEmployeeTimeEntryForReport.TotalTime, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeId, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeTimeEntryId, dbo.vueAccountEmployeeTimeEntryForReport.StartTime, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EndTime, dbo.vueAccountEmployeeTimeEntryForReport.TimeEntryDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Description, dbo.vueAccountEmployeeTimeEntryForReport.AccountId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TotalMinutes, dbo.vueAccountEmployeeTimeEntryForReport.WeekDay, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientName, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectTaskId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingType, dbo.vueAccountEmployeeTimeEntryForReport.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManagerEmployeeId, dbo.vueAccountEmployeeTimeEntryForReport.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ExpenseApprovalTypeId, dbo.vueAccountEmployeeTimeEntryForReport.BillingRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectBillingRateTypeId, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountDepartmentId, dbo.vueAccountEmployeeTimeEntryForReport.DepartmentName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCost, dbo.vueAccountEmployeeTimeEntryForReport.EstimatedHours, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkType, dbo.vueAccountEmployeeTimeEntryForReport.EMailAddress, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountLocation, dbo.vueAccountEmployeeTimeEntryForReport.AccountCostCenter, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountCostCenterCode, dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkTypeCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectCode, dbo.vueAccountEmployeeTimeEntryForReport.TaskCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountLocationId, dbo.vueAccountEmployeeTimeEntryForReport.ApproverComments, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Amount, dbo.vueAccountEmployeeTimeEntryForReport.BillingRateCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate, dbo.vueAccountEmployeeTimeEntryForReport.AccountBaseCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingRateCurrencyCode, dbo.vueAccountEmployeeTimeEntryForReport.AmountCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountTaskTypeId, dbo.vueAccountEmployeeTimeEntryForReport.TaskStatusId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountPriorityId, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectMilestoneId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskType, dbo.vueAccountEmployeeTimeEntryForReport.TaskStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.MilestoneDescription, dbo.vueAccountEmployeeTimeEntryForReport.Priority, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TotalHours, dbo.vueAccountEmployeeTimeEntryForReport.DepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientNick, dbo.vueAccountEmployeeTimeEntryForReport.AccountClientId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ApprovedOn, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateCurrencyCode, dbo.vueAccountEmployeeTimeEntryForReport.TeamLeader, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManager, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeManager, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate, 0), dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCost, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountRoleId, dbo.vueAccountEmployeeTimeEntryForReport.Role, 
                      dbo.vueAccountEmployeeTimeEntryForReport.WeekDayName, dbo.vueAccountEmployeeTimeEntryForReport.Period, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Year, dbo.vueAccountEmployeeTimeEntryForReport.WeekNo, dbo.vueAccountEmployeeTimeEntryForReport.MonthNo, 
                      dbo.vueAccountEmployeeTimeEntryForReport.DayNo, dbo.vueAccountEmployeeTimeEntryForReport.ProjectRole, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectType, dbo.vueAccountEmployeeTimeEntryForReport.ProjectDescription, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskDescription, dbo.vueAccountEmployeeTimeEntryForReport.InvoiceNumber, 
                      dbo.vueAccountEmployeeTimeEntryForReport.InvoiceDate, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectTypeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientContactName, dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentName, dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentLocation, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkTypeId, dbo.vueAccountEmployeeTimeEntryForReport.ProjectStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ParentTaskName, dbo.vueAccountEmployeeTimeEntryForReport.FirstName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.LastName, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeType, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Approved, dbo.vueAccountEmployeeTimeEntryForReport.TeamLeadApproved, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManagerApproved, dbo.vueAccountEmployeeTimeEntryForReport.AdministratorApproved, 
                      dbo.vueAccountEmployeeTimeEntryForReport.IsBillable, dbo.vueAccountEmployeeTimeEntryForReport.Rejected, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Submitted, dbo.vueAccountEmployeeTimeEntryForReport.Billed, 
                      dbo.vueAccountEmployeeTimeEntryForReport.IsTimeOff, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate * dbo.vueAccountEmployeeTimeEntryForReport.TotalHours
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 1 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate * dbo.vueAccountEmployeeTimeEntryForReport.TotalHours
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRate / dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate / dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCost / dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.Amount / dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCost / dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable
                       IS NULL THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 1 THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours ELSE 0 END, 
                      CASE WHEN vueAccountEmployeeTimeEntryForReport.Submitted = 1 AND 
                      vueAccountEmployeeTimeEntryForReport.Approved = 0 THEN ''Submitted'' WHEN vueAccountEmployeeTimeEntryForReport.Approved = 1 THEN ''Approved'' WHEN vueAccountEmployeeTimeEntryForReport.Rejected
                       = 1 THEN ''Rejected'' WHEN vueAccountEmployeeTimeEntryForReport.Submitted = 0 AND vueAccountEmployeeTimeEntryForReport.Approved = 0 AND 
                      vueAccountEmployeeTimeEntryForReport.Rejected = 0 THEN ''Not Submitted'' END, dbo.vueAccountEmployeeTimeEntryForReport.HolidayName'

GO
if not exists(Select * from [dbo].[SystemReportDataSourceField] where [SystemReportDataSourceFieldId] = 'a9a6ed80-4c1c-46b8-bde4-61da10058229')
BEGIN

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'

INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('a9a6ed80-4c1c-46b8-bde4-61da10058229', '3a080202-6842-4eca-8c79-a945978810b4', N'Percentage', 125, 1, NULL, NULL, 72, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Percentage%', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('a49379fd-c728-4450-a608-51e2597b6132', '18966956-9937-4da0-a6f3-465e6066d433', N'Percentage', 125, 1, NULL, NULL, 45, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Percentage%', 0, 0)

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemTimeEntryHoursFormat]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemTimeEntryHoursFormat]'

INSERT INTO [dbo].[SystemTimeEntryHoursFormat] ([SystemTimeEntryHoursFormatId], [SystemTimeEntryHoursFormat]) VALUES ('074187eb-81d9-4e06-8e70-db7bc0c53784', N'Time')

END

GO
If exists(Select * from SystemData where version = '3.9.6')
--Update AccountPreferences Record
BEGIN
Update AccountPreferences 
Set TimeEntryHoursFormatId = '074187eb-81d9-4e06-8e70-db7bc0c53784'
END

GO
Update SystemData Set Version = '3.9.7' Where Version = '3.9.6' And SystemDataId = 1

GO

-- Drop Procedure sp_UpdateTimeEntry
Print 'Drop Procedure sp_UpdateTimeEntry'
GO
DROP PROCEDURE [dbo].[sp_UpdateTimeEntry]

GO
-- Create Procedure sp_UpdateTimeEntry
Print 'Create Procedure sp_UpdateTimeEntry'
GO

CREATE PROCEDURE [dbo].[sp_UpdateTimeEntry]
		   (@AccountEmployeeId int,
           @TimeEntryDate datetime,
           @StartTime datetime,
           @EndTime datetime,
           @TotalTime datetime,
           @AccountProjectId int,
           @AccountProjectTaskId bigint,
           @Description nvarchar(1000),
           @Approved bit,
           @Rejected bit,
           @BillingRate money,
           @Submitted bit,
           @AccountWorkTypeId int,
           @EmployeeRate money,
           @AccountCostCenterId int,
           @BillingRateCurrencyId int,
           @EmployeeRateCurrencyId int,
           @BillingRateExchangeRate float,
           @EmployeeRateExchangeRate float,
           @AccountBaseCurrencyId int,
           @AccountEmployeeTimeEntryPeriodId uniqueidentifier,
           @AccountEmployeeTimeEntryApprovalProjectId uniqueidentifier,
           @ModifiedByEmployeeId int,
           @IsTimeOff bit,
           @AccountTimeOffTypeId uniqueidentifier,
		   @AccountEmployeeTimeEntryId int,
		   @Percentage int)
AS 
BEGIN
UPDATE AccountEmployeeTimeEntry
   SET [AccountEmployeeId] = @AccountEmployeeId
      ,[TimeEntryDate] = @TimeEntryDate
      ,[StartTime] = @StartTime
      ,[EndTime] = @EndTime
      ,[TotalTime] = @TotalTime
      ,[AccountProjectId] = @AccountProjectId
      ,[AccountProjectTaskId] = @AccountProjectTaskId
      ,[Description] = @Description
      ,[Approved] = @Approved
      ,[Rejected] = @Rejected
      ,[BillingRate] = @BillingRate
      ,[Submitted] = @Submitted
      ,[AccountWorkTypeId] = @AccountWorkTypeId
      ,[EmployeeRate] = @EmployeeRate
      ,[AccountCostCenterId] = @AccountCostCenterId
      ,[BillingRateCurrencyId] = @BillingRateCurrencyId
      ,[EmployeeRateCurrencyId] = @EmployeeRateCurrencyId
      ,[BillingRateExchangeRate] = @BillingRateExchangeRate
      ,[EmployeeRateExchangeRate] = @EmployeeRateExchangeRate
      ,[AccountBaseCurrencyId] = @AccountBaseCurrencyId
      ,[AccountEmployeeTimeEntryPeriodId] = @AccountEmployeeTimeEntryPeriodId
      ,[AccountEmployeeTimeEntryApprovalProjectId] = @AccountEmployeeTimeEntryApprovalProjectId
      ,[ModifiedByEmployeeId] = @ModifiedByEmployeeId
      ,[IsTimeOff] = @IsTimeOff
      ,[AccountTimeOffTypeId] = @AccountTimeOffTypeId
      ,[Percentage] = @Percentage
 WHERE [AccountEmployeeTimeEntryId] = @AccountEmployeeTimeEntryId
END

GO
-- Add Column StartDate to AccountProjectTask
Print 'Add Column StartDate to AccountProjectTask'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProjectTask' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='StartDate' AND TABLE_NAME='AccountProjectTask'))
ALTER TABLE [dbo].[AccountProjectTask]
	ADD [StartDate] smalldatetime NULL

GO

-- Drop View rptvueAccountProjectTaskEmployee
Print 'Drop View rptvueAccountProjectTaskEmployee'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectTaskEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountProjectTaskEmployee]

GO
-- Drop View VueAccountProjectTaskEmployeeForReport
Print 'Drop View VueAccountProjectTaskEmployeeForReport'
GO
if exists (select * from information_schema.tables where table_name = 'VueAccountProjectTaskEmployeeForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[VueAccountProjectTaskEmployeeForReport]

GO
-- Drop View rptvueAccountProjectTasks
Print 'Drop View rptvueAccountProjectTasks'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectTasks' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountProjectTasks]

GO
-- Drop View vueAccountProjectTaskOnlyForReport
Print 'Drop View vueAccountProjectTaskOnlyForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountProjectTaskOnlyForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountProjectTaskOnlyForReport]

GO
-- Drop View vueAccountProjectTaskForReport
Print 'Drop View vueAccountProjectTaskForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountProjectTaskForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountProjectTaskForReport]

GO
-- Drop View vueAccountProjectTask
Print 'Drop View vueAccountProjectTask'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountProjectTask' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountProjectTask]

GO
-- Create View vueAccountProjectTask
Print 'Create View vueAccountProjectTask'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountProjectTask' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountProjectTask
AS
SELECT     dbo.AccountProjectTask.AccountProjectTaskId, dbo.AccountProjectTask.AccountProjectId, dbo.AccountProjectTask.ParentAccountProjectTaskId, 
                      dbo.AccountProjectTask.TaskName, dbo.AccountProjectTask.TaskDescription, dbo.AccountProjectTask.AccountTaskTypeId, dbo.AccountProjectTask.Duration, 
                      dbo.AccountProjectTask.DurationUnit, dbo.AccountProjectTask.DeadlineDate, dbo.AccountProjectTask.CompletedPercent, dbo.AccountProjectTask.Completed, 
                      dbo.AccountProjectTask.IsParentTask, dbo.AccountProjectTask.IsForAllEmployees, dbo.AccountProjectTask.AccountPriorityId, dbo.AccountProjectTask.TaskStatusId, 
                      dbo.AccountProjectTask.CreatedOn, dbo.AccountProjectTask.CreatedByEmployeeId, dbo.AccountProjectTask.ModifiedOn, 
                      dbo.AccountProjectTask.ModifiedByEmployeeId, dbo.AccountStatus.Status AS TaskStatus, dbo.AccountEmployee.FirstName AS CreatedByFirstName, 
                      dbo.AccountEmployee.LastName AS CreatedByLastName, dbo.AccountPriority.Priority, dbo.AccountProject.ProjectName, dbo.AccountProject.ProjectCode, 
                      dbo.AccountTaskType.TaskType, dbo.AccountProject.AccountId, dbo.AccountProjectTask.AccountProjectMilestoneId, 
                      dbo.AccountProjectMilestone.MilestoneDescription, dbo.AccountProjectTask.IsReOpen, AccountEmployee_1.FirstName AS ModifiedByFirstName, 
                      AccountEmployee_1.LastName AS ModifiedByLastName, dbo.AccountProjectTask.EstimatedCost, dbo.AccountProjectTask.EstimatedTimeSpent, 
                      dbo.AccountProjectTask.EstimatedTimeSpentUnit, dbo.AccountEmployee.AccountEmployeeId, dbo.AccountProjectTask.IsDisabled, dbo.AccountProjectTask.TaskCode, 
                      dbo.AccountProject.IsTemplate, dbo.AccountProjectTask.IsForAllProjectTask, dbo.AccountProjectTask.IsBillable, dbo.AccountProjectTask.EstimatedCurrencyId, 
                      dbo.AccountParty.PartyName, dbo.AccountParty.PartyNick, dbo.AccountProject.AccountClientId, dbo.AccountProject.ProjectDescription, 
                      dbo.AccountProjectMilestone.MilestoneDate, dbo.AccountProject.IsDeleted AS IsProjectDeleted, dbo.AccountProjectTask.StartDate
FROM         dbo.AccountTaskType RIGHT OUTER JOIN
                      dbo.AccountProjectMilestone RIGHT OUTER JOIN
                      dbo.AccountProject INNER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId RIGHT OUTER JOIN
                      dbo.AccountProjectTask LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON dbo.AccountProjectTask.ModifiedByEmployeeId = AccountEmployee_1.AccountEmployeeId ON 
                      dbo.AccountProject.AccountProjectId = dbo.AccountProjectTask.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountEmployee ON dbo.AccountProjectTask.CreatedByEmployeeId = dbo.AccountEmployee.AccountEmployeeId ON 
                      dbo.AccountProjectMilestone.AccountProjectMilestoneId = dbo.AccountProjectTask.AccountProjectMilestoneId ON 
                      dbo.AccountTaskType.AccountTaskTypeId = dbo.AccountProjectTask.AccountTaskTypeId LEFT OUTER JOIN
                      dbo.AccountStatus ON dbo.AccountProjectTask.TaskStatusId = dbo.AccountStatus.AccountStatusId LEFT OUTER JOIN
                      dbo.AccountPriority ON dbo.AccountProjectTask.AccountPriorityId = dbo.AccountPriority.AccountPriorityId'

GO
-- Create View vueAccountProjectTaskForReport
Print 'Create View vueAccountProjectTaskForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountProjectTaskForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountProjectTaskForReport
AS
SELECT     dbo.vueAccountProjectTask.AccountProjectTaskId, dbo.vueAccountProjectTask.AccountProjectId, dbo.vueAccountProjectTask.ParentAccountProjectTaskId, 
                      dbo.vueAccountProjectTask.TaskName, dbo.vueAccountProjectTask.TaskDescription, dbo.vueAccountProjectTask.AccountTaskTypeId, 
                      dbo.vueAccountProjectTask.DeadlineDate, dbo.vueAccountProjectTask.CompletedPercent, dbo.vueAccountProjectTask.Completed, 
                      dbo.vueAccountProjectTask.IsParentTask, dbo.vueAccountProjectTask.IsForAllEmployees, dbo.vueAccountProjectTask.AccountPriorityId, 
                      dbo.vueAccountProjectTask.TaskStatusId, dbo.vueAccountProjectTask.CreatedOn, dbo.vueAccountProjectTask.CreatedByEmployeeId, 
                      dbo.vueAccountProjectTask.ModifiedOn, dbo.vueAccountProjectTask.ModifiedByEmployeeId, dbo.vueAccountProjectTask.TaskStatus, 
                      dbo.vueAccountProjectTask.CreatedByFirstName, dbo.vueAccountProjectTask.CreatedByLastName, dbo.vueAccountProjectTask.Priority, 
                      dbo.vueAccountProjectTask.ProjectName, dbo.vueAccountProjectTask.ProjectCode, dbo.vueAccountProjectTask.TaskType, dbo.vueAccountProjectTask.AccountId, 
                      dbo.vueAccountProjectTask.AccountProjectMilestoneId, dbo.vueAccountProjectTask.MilestoneDescription, dbo.vueAccountProjectTask.IsReOpen, 
                      dbo.vueAccountProjectTask.ModifiedByFirstName, dbo.vueAccountProjectTask.ModifiedByLastName, dbo.vueAccountProjectTask.EstimatedCost, 
                      dbo.vueAccountProjectTask.EstimatedTimeSpent AS EstimatedHours, dbo.vueAccountProjectTask.EstimatedTimeSpentUnit, 
                      dbo.vueAccountProjectTask.AccountEmployeeId, dbo.vueAccountProjectTask.IsDisabled, dbo.vueAccountProjectTask.TaskCode, 
                      dbo.vueAccountProjectTask.IsTemplate, dbo.vueAccountProjectTask.IsForAllProjectTask, dbo.vueAccountProjectTask.IsBillable, 
                      dbo.AccountParty.AccountPartyId AS AccountClientId, dbo.AccountParty.PartyNick AS ClientNick, dbo.AccountParty.PartyName AS ClientName, CONVERT(nvarchar(200), 
                      dbo.vueAccountProjectTask.Duration) + '' - '' + dbo.vueAccountProjectTask.DurationUnit AS Duration, dbo.AccountProjectTask.TaskName AS ParentTaskName, 
                      dbo.vueAccountProjectTask.EstimatedCurrencyId, dbo.vueAccountCurrency.CurrencyCode AS EstimatedCurrencyCode, dbo.vueAccountProjectTask.ProjectDescription, 
                      dbo.vueAccountProjectTask.MilestoneDate, dbo.vueAccountProjectTask.StartDate
FROM         dbo.vueAccountProjectTask INNER JOIN
                      dbo.AccountProject ON dbo.vueAccountProjectTask.AccountProjectId = dbo.AccountProject.AccountProjectId INNER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId LEFT OUTER JOIN
                      dbo.vueAccountCurrency ON dbo.vueAccountProjectTask.EstimatedCurrencyId = dbo.vueAccountCurrency.AccountCurrencyId LEFT OUTER JOIN
                      dbo.AccountProjectTask ON dbo.vueAccountProjectTask.ParentAccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId'

GO
-- Create View vueAccountProjectTaskOnlyForReport
Print 'Create View vueAccountProjectTaskOnlyForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountProjectTaskOnlyForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountProjectTaskOnlyForReport
AS
SELECT     dbo.vueAccountProjectTaskForReport.AccountProjectTaskId, dbo.vueAccountProjectTaskForReport.AccountProjectId, 
                      dbo.vueAccountProjectTaskForReport.ParentAccountProjectTaskId, dbo.vueAccountProjectTaskForReport.TaskName, 
                      dbo.vueAccountProjectTaskForReport.TaskDescription, dbo.vueAccountProjectTaskForReport.AccountTaskTypeId, dbo.vueAccountProjectTaskForReport.DeadlineDate, 
                      dbo.vueAccountProjectTaskForReport.CompletedPercent, dbo.vueAccountProjectTaskForReport.Completed, dbo.vueAccountProjectTaskForReport.IsParentTask, 
                      dbo.vueAccountProjectTaskForReport.IsForAllEmployees, dbo.vueAccountProjectTaskForReport.AccountPriorityId, dbo.vueAccountProjectTaskForReport.TaskStatusId, 
                      dbo.vueAccountProjectTaskForReport.CreatedOn, dbo.vueAccountProjectTaskForReport.CreatedByEmployeeId, dbo.vueAccountProjectTaskForReport.ModifiedOn, 
                      dbo.vueAccountProjectTaskForReport.ModifiedByEmployeeId, dbo.vueAccountProjectTaskForReport.TaskStatus, 
                      dbo.vueAccountProjectTaskForReport.CreatedByFirstName, dbo.vueAccountProjectTaskForReport.CreatedByLastName, dbo.vueAccountProjectTaskForReport.Priority, 
                      dbo.vueAccountProjectTaskForReport.ProjectName, ISNULL(dbo.vueAccountProjectTaskForReport.ProjectCode, N'''') AS ProjectCode, 
                      dbo.vueAccountProjectTaskForReport.TaskType, dbo.vueAccountProjectTaskForReport.AccountId, dbo.vueAccountProjectTaskForReport.AccountProjectMilestoneId, 
                      dbo.vueAccountProjectTaskForReport.MilestoneDescription, dbo.vueAccountProjectTaskForReport.IsReOpen, 
                      dbo.vueAccountProjectTaskForReport.ModifiedByFirstName, dbo.vueAccountProjectTaskForReport.ModifiedByLastName, 
                      ISNULL(dbo.vueAccountProjectTaskForReport.EstimatedCost, 0) AS EstimatedCost, ISNULL(dbo.vueAccountProjectTaskForReport.EstimatedHours, 0) 
                      AS EstimatedHours, dbo.vueAccountProjectTaskForReport.EstimatedTimeSpentUnit, dbo.vueAccountProjectTaskForReport.AccountEmployeeId, 
                      dbo.vueAccountProjectTaskForReport.IsDisabled, ISNULL(dbo.vueAccountProjectTaskForReport.TaskCode, N'''') AS TaskCode, 
                      dbo.vueAccountProjectTaskForReport.IsTemplate, ISNULL(dbo.vueAccountProjectTaskForReport.IsForAllProjectTask, 0) AS IsForAllProjectTask, 
                      ISNULL(dbo.vueAccountProjectTaskForReport.IsBillable, 0) AS IsBillable, dbo.vueAccountProjectTaskForReport.AccountClientId, 
                      ISNULL(dbo.vueAccountProjectTaskForReport.ClientNick, N'''') AS ClientNick, dbo.vueAccountProjectTaskForReport.ClientName, 
                      dbo.vueAccountProjectTaskForReport.Duration, ISNULL(dbo.vueAccountProjectTaskForReport.ParentTaskName, N'''') AS ParentTaskName, 
                      SUM(ISNULL(dbo.rptvueAccountEmployeeTimeEntry.BillableTotalHours, 0)) AS BillableTotalHours, 
                      SUM(ISNULL(dbo.rptvueAccountEmployeeTimeEntry.NonBillableTotalHours, 0)) AS NonBillableTotalHours, dbo.vueAccountProjectTaskForReport.EstimatedCurrencyId, 
                      dbo.vueAccountProjectTaskForReport.EstimatedCurrencyCode, SUM(ISNULL(dbo.rptvueAccountEmployeeTimeEntry.TotalHours, 0)) AS TotalHours, 
                      SUM(ISNULL(dbo.rptvueAccountEmployeeTimeEntry.CurrencyEmployeeCost, 0)) AS CurrencyEmployeeCost, ISNULL(dbo.vueAccountCurrency.ExchangeRate, 0) 
                      AS EstimatedCurrencyExchangeRate, SUM(ISNULL(dbo.rptvueAccountEmployeeTimeEntry.CurrencyAmount, 0)) AS CurrencyAmount, 
                      ISNULL(dbo.vueAccountProjectTaskForReport.ProjectDescription, N'''') AS ProjectDescription, dbo.vueAccountProjectTaskForReport.MilestoneDate, 
                      dbo.vueAccountProjectTaskForReport.StartDate
FROM         dbo.vueAccountProjectTaskForReport LEFT OUTER JOIN
                      dbo.vueAccountCurrency ON dbo.vueAccountProjectTaskForReport.EstimatedCurrencyId = dbo.vueAccountCurrency.AccountCurrencyId LEFT OUTER JOIN
                      dbo.rptvueAccountEmployeeTimeEntry ON 
                      dbo.vueAccountProjectTaskForReport.AccountProjectTaskId = dbo.rptvueAccountEmployeeTimeEntry.AccountProjectTaskId
WHERE     (dbo.vueAccountProjectTaskForReport.IsParentTask <> 1)
GROUP BY dbo.vueAccountProjectTaskForReport.AccountProjectTaskId, dbo.vueAccountProjectTaskForReport.AccountProjectId, 
                      dbo.vueAccountProjectTaskForReport.ParentAccountProjectTaskId, dbo.vueAccountProjectTaskForReport.TaskName, 
                      dbo.vueAccountProjectTaskForReport.TaskDescription, dbo.vueAccountProjectTaskForReport.AccountTaskTypeId, dbo.vueAccountProjectTaskForReport.DeadlineDate, 
                      dbo.vueAccountProjectTaskForReport.CompletedPercent, dbo.vueAccountProjectTaskForReport.Completed, dbo.vueAccountProjectTaskForReport.IsParentTask, 
                      dbo.vueAccountProjectTaskForReport.IsForAllEmployees, dbo.vueAccountProjectTaskForReport.AccountPriorityId, dbo.vueAccountProjectTaskForReport.CreatedOn, 
                      dbo.vueAccountProjectTaskForReport.TaskStatusId, dbo.vueAccountProjectTaskForReport.CreatedByEmployeeId, 
                      dbo.vueAccountProjectTaskForReport.ModifiedByEmployeeId, dbo.vueAccountProjectTaskForReport.ModifiedOn, dbo.vueAccountProjectTaskForReport.TaskStatus, 
                      dbo.vueAccountProjectTaskForReport.CreatedByFirstName, dbo.vueAccountProjectTaskForReport.CreatedByLastName, dbo.vueAccountProjectTaskForReport.Priority, 
                      dbo.vueAccountProjectTaskForReport.ProjectName, ISNULL(dbo.vueAccountProjectTaskForReport.ProjectCode, N''''), dbo.vueAccountProjectTaskForReport.TaskType, 
                      dbo.vueAccountProjectTaskForReport.AccountId, dbo.vueAccountProjectTaskForReport.AccountProjectMilestoneId, dbo.vueAccountProjectTaskForReport.IsReOpen, 
                      dbo.vueAccountProjectTaskForReport.MilestoneDescription, dbo.vueAccountProjectTaskForReport.ModifiedByFirstName, 
                      dbo.vueAccountProjectTaskForReport.ModifiedByLastName, ISNULL(dbo.vueAccountProjectTaskForReport.EstimatedCost, 0), 
                      ISNULL(dbo.vueAccountProjectTaskForReport.EstimatedHours, 0), dbo.vueAccountProjectTaskForReport.EstimatedTimeSpentUnit, 
                      dbo.vueAccountProjectTaskForReport.AccountEmployeeId, dbo.vueAccountProjectTaskForReport.IsDisabled, ISNULL(dbo.vueAccountProjectTaskForReport.TaskCode, 
                      N''''), dbo.vueAccountProjectTaskForReport.IsTemplate, ISNULL(dbo.vueAccountProjectTaskForReport.IsForAllProjectTask, 0), 
                      ISNULL(dbo.vueAccountProjectTaskForReport.IsBillable, 0), dbo.vueAccountProjectTaskForReport.AccountClientId, 
                      ISNULL(dbo.vueAccountProjectTaskForReport.ClientNick, N''''), dbo.vueAccountProjectTaskForReport.ClientName, dbo.vueAccountProjectTaskForReport.Duration, 
                      ISNULL(dbo.vueAccountProjectTaskForReport.ParentTaskName, N''''), dbo.vueAccountProjectTaskForReport.EstimatedCurrencyId, 
                      dbo.vueAccountProjectTaskForReport.EstimatedCurrencyCode, dbo.vueAccountCurrency.ExchangeRate, 
                      ISNULL(dbo.vueAccountProjectTaskForReport.ProjectDescription, N''''), dbo.vueAccountProjectTaskForReport.MilestoneDate, 
                      dbo.vueAccountProjectTaskForReport.StartDate'

GO
-- Create View rptvueAccountProjectTasks
Print 'Create View rptvueAccountProjectTasks'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectTasks' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountProjectTasks
AS
SELECT     AccountProjectTaskId, AccountProjectId, ParentAccountProjectTaskId, TaskName, TaskDescription, AccountTaskTypeId, DeadlineDate, CompletedPercent, Completed, 
                      IsParentTask, IsForAllEmployees, AccountPriorityId, TaskStatusId, CreatedOn, CreatedByEmployeeId, ModifiedOn, ModifiedByEmployeeId, TaskStatus, 
                      CreatedByFirstName, CreatedByLastName, Priority, ProjectName, ProjectCode, TaskType, AccountId, AccountProjectMilestoneId, MilestoneDescription, IsReOpen, 
                      ModifiedByFirstName, ModifiedByLastName, ISNULL(EstimatedCost, 0) AS EstimatedCost, EstimatedHours, EstimatedTimeSpentUnit, AccountEmployeeId, IsDisabled, 
                      TaskCode, IsTemplate, IsForAllProjectTask, IsBillable, AccountClientId, ClientNick, ClientName, Duration, ParentTaskName, EstimatedCurrencyId, 
                      EstimatedCurrencyCode, BillableTotalHours, NonBillableTotalHours, TotalHours, CurrencyEmployeeCost, EstimatedCurrencyExchangeRate, 
                      CASE WHEN dbo.vueAccountProjectTaskOnlyForReport.EstimatedCurrencyExchangeRate > 0 THEN dbo.vueAccountProjectTaskOnlyForReport.EstimatedCost / dbo.vueAccountProjectTaskOnlyForReport.EstimatedCurrencyExchangeRate
                       ELSE 0 END AS CurrencyEstimatedCost, CurrencyAmount, ProjectDescription, MilestoneDate, StartDate
FROM         dbo.vueAccountProjectTaskOnlyForReport'

GO
-- Create View VueAccountProjectTaskEmployeeForReport
Print 'Create View VueAccountProjectTaskEmployeeForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'VueAccountProjectTaskEmployeeForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.VueAccountProjectTaskEmployeeForReport
AS
SELECT     dbo.AccountProjectTaskEmployee.AccountProjectTaskEmployeeId, dbo.AccountProjectTaskEmployee.AccountId, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, dbo.AccountProjectTaskEmployee.AccountProjectTaskId, 
                      dbo.AccountProjectTaskEmployee.AccountEmployeeId, dbo.AccountProjectTask.AccountProjectId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, 
                      dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountEmployee.AccountTimeOffPolicyId, dbo.AccountEmployee.TimeOffApprovalTypeId, 
                      dbo.AccountEmployee.AccountHolidayTypeId, dbo.AccountParty.PartyName AS ClientName, dbo.AccountProjectTask.TaskName, 
                      dbo.AccountProjectTask.TaskDescription, dbo.AccountProjectTask.Duration AS TaskDuration, dbo.AccountProjectTask.DurationUnit AS TaskDurationUnit, 
                      dbo.AccountProjectTask.DeadlineDate AS TaskDeadlineDate, dbo.AccountProjectTask.Completed AS TaskCompleted, dbo.AccountProjectTask.IsParentTask, 
                      dbo.AccountProjectTask.IsForAllEmployees, dbo.AccountProjectTask.EstimatedCost AS TaskEmployeeCost, 
                      dbo.AccountProjectTask.EstimatedTimeSpent AS TaskEstimatedTimeSpent, dbo.AccountProjectTask.EstimatedTimeSpentUnit AS TaskEstimatedTimeSpentUnit, 
                      dbo.AccountProjectTask.TaskCode, dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.State, dbo.AccountEmployee.City, dbo.AccountEmployee.Zip, dbo.AccountEmployee.HomePhoneNo, dbo.AccountEmployee.WorkPhoneNo, 
                      dbo.AccountEmployee.MobilePhoneNo, dbo.AccountEmployee.BillingRateStateDate, dbo.AccountEmployee.TerminationDate, dbo.AccountEmployee.EmployeeCode, 
                      dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.HiredDate, dbo.AccountEmployeeType.AccountEmployeeType, 
                      dbo.AccountWorkingDayType.AccountWorkingDayType, dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, dbo.AccountWorkingDayType.MinimumHoursPerWeek, 
                      dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountTimeOffPolicy.AccountTimeOffPolicy, dbo.AccountProject.ProjectName, 
                      dbo.AccountProject.ProjectDescription, dbo.AccountProject.StartDate AS ProjectStartDate, dbo.AccountProject.Deadline AS ProjectDeadlineDate, 
                      dbo.AccountProject.EstimatedTime AS ProjectEstimatedTime, dbo.AccountProject.EstimatedDuration AS ProjectEstimatedDuration, 
                      dbo.AccountProject.EstimatedDurationUnit AS ProjectEstimatedDurationUnit, dbo.AccountProject.ProjectCode, dbo.AccountProject.Completed AS ProjectCompleted, 
                      dbo.AccountStatus.Status AS TaskStatus, dbo.AccountPriority.Priority, dbo.AccountProjectTask.AccountPriorityId, dbo.AccountProjectTask.TaskStatusId, 
                      dbo.AccountProjectTask.AccountTaskTypeId, dbo.AccountTaskType.TaskType, dbo.AccountBillingRate.BillingRate, 
                      dbo.AccountBillingRate.StartDate AS BillingRateStartDate, dbo.AccountBillingRate.EndDate AS BillingRateEndDate, dbo.AccountBillingRate.EmployeeRate, 
                      SUM(DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) AS TotalMinutes, 
                      dbo.AccountProjectTask.StartDate AS TaskStartDate
FROM         dbo.AccountBillingRate INNER JOIN
                      dbo.AccountTaskType INNER JOIN
                      dbo.AccountProjectTaskEmployee INNER JOIN
                      dbo.AccountParty INNER JOIN
                      dbo.AccountProject ON dbo.AccountParty.AccountPartyId = dbo.AccountProject.AccountClientId INNER JOIN
                      dbo.AccountStatus INNER JOIN
                      dbo.AccountProjectTask ON dbo.AccountStatus.AccountStatusId = dbo.AccountProjectTask.TaskStatusId INNER JOIN
                      dbo.AccountPriority ON dbo.AccountProjectTask.AccountPriorityId = dbo.AccountPriority.AccountPriorityId ON 
                      dbo.AccountProject.AccountProjectId = dbo.AccountProjectTask.AccountProjectId ON 
                      dbo.AccountProjectTaskEmployee.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountProjectTaskEmployee.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId ON 
                      dbo.AccountTaskType.AccountTaskTypeId = dbo.AccountProjectTask.AccountTaskTypeId ON 
                      dbo.AccountBillingRate.AccountBillingRateId = dbo.AccountProjectTask.AccountBillingRateId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntry ON dbo.AccountProject.AccountProjectId = dbo.AccountEmployeeTimeEntry.AccountProjectId AND 
                      dbo.AccountProjectTask.AccountProjectTaskId = dbo.AccountEmployeeTimeEntry.AccountProjectTaskId AND 
                      dbo.AccountEmployee.AccountEmployeeId = dbo.AccountEmployeeTimeEntry.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployeeType ON dbo.AccountEmployee.EmployeePayTypeId = dbo.AccountEmployeeType.AccountEmployeeTypeId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountWorkingDayType ON dbo.AccountEmployee.AccountWorkingDayTypeId = dbo.AccountWorkingDayType.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountTimeOffPolicy ON dbo.AccountEmployee.AccountTimeOffPolicyId = dbo.AccountTimeOffPolicy.AccountTimeOffPolicyId
GROUP BY dbo.AccountProjectTaskEmployee.AccountProjectTaskEmployeeId, dbo.AccountProjectTaskEmployee.AccountId, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END, dbo.AccountProjectTaskEmployee.AccountProjectTaskId, dbo.AccountProjectTaskEmployee.AccountEmployeeId, 
                      dbo.AccountProjectTask.AccountProjectId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.AccountWorkingDayTypeId, 
                      dbo.AccountEmployee.AccountTimeOffPolicyId, dbo.AccountEmployee.TimeOffApprovalTypeId, dbo.AccountEmployee.AccountHolidayTypeId, 
                      dbo.AccountParty.PartyName, dbo.AccountProjectTask.TaskName, dbo.AccountProjectTask.TaskDescription, dbo.AccountProjectTask.Duration, 
                      dbo.AccountProjectTask.DurationUnit, dbo.AccountProjectTask.DeadlineDate, dbo.AccountProjectTask.Completed, dbo.AccountProjectTask.IsParentTask, 
                      dbo.AccountProjectTask.IsForAllEmployees, dbo.AccountProjectTask.EstimatedCost, dbo.AccountProjectTask.EstimatedTimeSpent, 
                      dbo.AccountProjectTask.EstimatedTimeSpentUnit, dbo.AccountProjectTask.TaskCode, dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, 
                      dbo.AccountLocation.AccountLocation, dbo.AccountEmployee.State, dbo.AccountEmployee.City, dbo.AccountEmployee.Zip, dbo.AccountEmployee.HomePhoneNo, 
                      dbo.AccountEmployee.WorkPhoneNo, dbo.AccountEmployee.MobilePhoneNo, dbo.AccountEmployee.BillingRateStateDate, dbo.AccountEmployee.TerminationDate, 
                      dbo.AccountEmployee.EmployeeCode, dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.HiredDate, dbo.AccountEmployeeType.AccountEmployeeType, 
                      dbo.AccountWorkingDayType.AccountWorkingDayType, dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, dbo.AccountWorkingDayType.MinimumHoursPerWeek, 
                      dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountTimeOffPolicy.AccountTimeOffPolicy, dbo.AccountProject.ProjectName, 
                      dbo.AccountProject.ProjectDescription, dbo.AccountProject.StartDate, dbo.AccountProject.Deadline, dbo.AccountProject.EstimatedTime, 
                      dbo.AccountProject.EstimatedDuration, dbo.AccountProject.EstimatedDurationUnit, dbo.AccountProject.ProjectCode, dbo.AccountProject.Completed, 
                      dbo.AccountStatus.Status, dbo.AccountPriority.Priority, dbo.AccountProjectTask.AccountPriorityId, dbo.AccountProjectTask.TaskStatusId, 
                      dbo.AccountProjectTask.AccountTaskTypeId, dbo.AccountTaskType.TaskType, dbo.AccountBillingRate.BillingRate, dbo.AccountBillingRate.StartDate, 
                      dbo.AccountBillingRate.EndDate, dbo.AccountBillingRate.EmployeeRate, dbo.AccountProjectTask.StartDate'

GO
-- Create View rptvueAccountProjectTaskEmployee
Print 'Create View rptvueAccountProjectTaskEmployee'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectTaskEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountProjectTaskEmployee
AS
SELECT     AccountProjectTaskEmployeeId, AccountProjectId, AccountProjectTaskId, TaskName, AccountEmployeeId, AccountId, TaskDescription, TaskCode, DepartmentName, 
                      AccountLocation, AccountEmployeeType, EmployeeCode, IsParentTask, IsForAllEmployees, EmployeeName, ClientName, TaskDuration, TaskDurationUnit, 
                      TaskDeadlineDate, TaskCompleted, TaskEmployeeCost, TaskEstimatedTimeSpent, TaskEstimatedTimeSpentUnit, Role, State, City, Zip, HomePhoneNo, 
                      WorkPhoneNo, MobilePhoneNo, BillingRateStateDate, TerminationDate, JobTitle, HiredDate, AccountWorkingDayType, HoursPerDay, WeekStartDay, 
                      MinimumHoursPerDay, MaximumHoursPerDay, MaximumHoursPerWeek, MinimumHoursPerWeek, AccountTimeOffPolicy, ProjectName, ProjectDescription, 
                      ProjectStartDate, ProjectDeadlineDate, ProjectEstimatedTime, ProjectEstimatedDuration, ProjectEstimatedDurationUnit, ProjectCode, ProjectCompleted, TaskStatus, 
                      Priority, AccountPriorityId, TaskStatusId, AccountTaskTypeId, TaskType, BillingRate, BillingRateStartDate, BillingRateEndDate, EmployeeRate, ROUND(CONVERT(float, 
                      TotalMinutes) / 60, 2) AS TotalHours, REPLACE(TotalMinutes / 60, '''', ''.00'') + '':'' + RIGHT(''0'' + REPLACE(TotalMinutes - TotalMinutes / 60 * 60, '''', ''.00''), 2) AS TotalTime, 
                      TaskStartDate
FROM         dbo.VueAccountProjectTaskEmployeeForReport'

GO

-- Drop View vueAccountEmployeeTimeEntry
Print 'Drop View vueAccountEmployeeTimeEntry'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntry' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntry]

GO
-- Create View vueAccountEmployeeTimeEntry
Print 'Create View vueAccountEmployeeTimeEntry'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntry' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntry
AS
SELECT     CASE WHEN dbo.AccountEmployee.IsDisabled = 1 THEN dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE dbo.AccountEmployee.FirstName
                       + '' '' + dbo.AccountEmployee.LastName END AS EmployeeName, dbo.AccountProject.ProjectName, 
                      CASE WHEN dbo.AccountProjectTask.AccountProjectTaskId IS NOT NULL 
                      THEN dbo.AccountProjectTask.TaskName ELSE AccountTimeOffType.AccountTimeOffType END AS TaskName, dbo.AccountEmployeeTimeEntry.TotalTime, 
                      dbo.AccountEmployeeTimeEntry.Approved, dbo.AccountEmployee.AccountEmployeeId, dbo.AccountProject.AccountProjectId, 
                      dbo.AccountEmployeeTimeEntry.TeamLeadApproved, dbo.AccountEmployeeTimeEntry.ProjectManagerApproved, 
                      dbo.AccountEmployeeTimeEntry.AdministratorApproved, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, dbo.AccountEmployeeTimeEntry.StartTime, 
                      dbo.AccountEmployeeTimeEntry.EndTime, dbo.AccountEmployeeTimeEntry.TimeEntryDate, dbo.AccountEmployeeTimeEntry.Description, 
                      dbo.AccountEmployee.AccountId, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      AS TotalMinutes, DATEPART(dw, dbo.AccountEmployeeTimeEntry.TimeEntryDate) AS WeekDay, dbo.AccountParty.AccountPartyId, dbo.AccountParty.PartyName, 
                      dbo.AccountProjectTask.AccountProjectTaskId, dbo.AccountBillingType.BillingType, dbo.AccountProject.LeaderEmployeeId, 
                      dbo.AccountProject.ProjectManagerEmployeeId, dbo.AccountProject.TimeSheetApprovalTypeId, dbo.AccountProject.ExpenseApprovalTypeId, 
                      dbo.AccountProjectTask.IsBillable, dbo.AccountEmployeeTimeEntry.Rejected, dbo.AccountEmployeeTimeEntry.BillingRate, 
                      dbo.AccountProject.ProjectBillingRateTypeId, dbo.AccountEmployee.EmployeeCode, dbo.AccountEmployee.AccountDepartmentId, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountProjectTask.EstimatedCost, dbo.AccountProjectTask.EstimatedTimeSpent, 
                      dbo.AccountEmployeeTimeEntry.Submitted, dbo.AccountWorkType.AccountWorkType, dbo.AccountEmployee.EMailAddress, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountCostCenter.AccountCostCenter, dbo.AccountCostCenter.AccountCostCenterCode, dbo.AccountWorkType.AccountWorkTypeCode, 
                      dbo.AccountProject.ProjectCode, dbo.AccountProjectTask.TaskCode, dbo.AccountLocation.AccountLocationId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction.Comments, dbo.AccountEmployeeTimeEntry.BillingRateCurrencyId, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateCurrencyId, dbo.AccountEmployeeTimeEntry.BillingRateExchangeRate, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateExchangeRate, dbo.AccountEmployeeTimeEntry.AccountBaseCurrencyId, dbo.AccountProjectTask.AccountTaskTypeId, 
                      dbo.AccountProjectTask.TaskStatusId, dbo.AccountProjectTask.AccountPriorityId, dbo.AccountProjectTask.AccountProjectMilestoneId, 
                      dbo.AccountDepartment.DepartmentCode, dbo.AccountParty.PartyNick, dbo.AccountProjectTask.EstimatedCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction.ApprovedOn, dbo.AccountEmployeeTimeEntry.EmployeeRate, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountRole.Role, dbo.AccountProject.AccountProjectTypeId, dbo.AccountProject.ProjectDescription, dbo.AccountProjectTask.TaskDescription, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeExpenseBillingTimesheetId, dbo.AccountEmployeeTimeEntry.Billed, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Submitted = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS SubmittedHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Approved = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS ApprovedHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Rejected = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS RejectedHours, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, 
                      dbo.AccountPartyContact.FirstName + N'' '' + dbo.AccountPartyContact.LastName AS ClientContactName, 
                      dbo.AccountPartyDepartment.PartyDepartmentCode AS ClientDepartmentCode, dbo.AccountPartyDepartment.PartyDepartmentName AS ClientDepartmentName, 
                      dbo.AccountPartyDepartment.PartyDepartmentLocation AS ClientDepartmentLocation, dbo.AccountWorkType.AccountWorkTypeId, 
                      dbo.AccountEmployeeTimeEntry.IsTimeOff, dbo.AccountEmployeeTimeEntry.Hours, dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeOffRequestId, dbo.AccountEmployeeTimeEntry.Percentage
FROM         dbo.AccountEmployeeTimeEntry INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeEntry.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountTimeOffType ON dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId LEFT OUTER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountProjectTask ON dbo.AccountEmployeeTimeEntry.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId LEFT OUTER JOIN
                      dbo.AccountPartyDepartment ON dbo.AccountProject.AccountPartyDepartmentId = dbo.AccountPartyDepartment.AccountPartyDepartmentId LEFT OUTER JOIN
                      dbo.AccountPartyContact ON dbo.AccountProject.AccountPartyContactId = dbo.AccountPartyContact.AccountPartyContactId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryPeriod ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId LEFT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryApprovalLastAction.AccountEmployeeTimeEntryId LEFT OUTER JOIN
                      dbo.AccountCostCenter ON dbo.AccountEmployeeTimeEntry.AccountCostCenterId = dbo.AccountCostCenter.AccountCostCenterId LEFT OUTER JOIN
                      dbo.AccountWorkType ON dbo.AccountEmployeeTimeEntry.AccountWorkTypeId = dbo.AccountWorkType.AccountWorkTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId LEFT OUTER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId'

GO
If exists(Select * from SystemData where version = '3.9.7')
--Update AccountPreferences Record
BEGIN
Update AccountProjectTask  Set StartDate = 
(Select a.DeadlineDate from AccountProjectTask a
Where AccountProjectTask.AccountProjectTaskId = a.AccountProjectTaskId)
END

GO
Update SystemData Set Version = '3.9.8' Where Version = '3.9.7' And SystemDataId = 1

GO
if not exists(Select * from [dbo].[SystemReportDataSourceField] where [SystemReportDataSourceFieldId] = 'fba2c555-bb4b-450e-83c6-26fdb90a4e69')
BEGIN

-- =======================================================
-- Foreign Key Constraint Nochecks's for Table: [dbo].[AccountReportColumn]
-- =======================================================
Print ' Foreign Key Constraint Nochecks''s for Table: [dbo].[AccountReportColumn]'

ALTER TABLE [dbo].[AccountReportColumn] NOCHECK CONSTRAINT [FK_AccountReportColumn_AccountReport]

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'

INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('fba2c555-bb4b-450e-83c6-26fdb90a4e69', 'c8ac5e8e-ba32-423a-804f-580e3f4ca837', N'TaskStartDate', 90, 1, NULL, NULL, 39, '48b9ef68-b4f6-4c75-b8de-c547939179ce', N'Task Start Date', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('300de3d5-d7a5-4913-8b02-212da7db6de0', '1e657f0a-881b-4f50-839a-c3a962c9a460', N'StartDate', 90, 1, NULL, NULL, 33, '48b9ef68-b4f6-4c75-b8de-c547939179ce', N'Start Date', 0, 0)

-- =======================================================
-- Synchronization Script for Table: [dbo].[AccountReportColumn]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[AccountReportColumn]'

INSERT INTO [dbo].[AccountReportColumn] ([AccountReportColumnId], [AccountReportId], [Caption], [SystemReportDataSourceFieldId], [ColumnOrder], [SystemReportCalculationTypeId], [ColumnFormula]) VALUES ('f45e3260-503c-4e4a-8eb2-af1cfb9191d2', '8decc776-b343-45ef-8661-e5cc08b53881', N'Start Date', '300de3d5-d7a5-4913-8b02-212da7db6de0', 11, NULL, NULL)

-- =======================================================
-- Synchronization Script for Table: [dbo].[AccountReportColumn]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[AccountReportColumn]'

UPDATE [dbo].[AccountReportColumn] SET [ColumnOrder]=12 WHERE [AccountReportColumnId]='d077489b-e95d-4ef5-98e9-d26227c47fbc'

-- =======================================================
-- Foreign Key Constraint Check's for Table: [dbo].[AccountReportColumn]
-- =======================================================
Print ' Foreign Key Constraint Check''s for Table: [dbo].[AccountReportColumn]'

ALTER TABLE [dbo].[AccountReportColumn] CHECK CONSTRAINT [FK_AccountReportColumn_AccountReport]

END

GO

-- Drop View vueAccountEmployeeTimeEntryForQB
Print 'Drop View vueAccountEmployeeTimeEntryForQB'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryForQB' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryForQB]

GO
-- Create View vueAccountEmployeeTimeEntryForQB
Print 'Create View vueAccountEmployeeTimeEntryForQB'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryForQB' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryForQB
AS
SELECT     dbo.AccountEmployeeTimeEntry.TimeEntryDate, dbo.AccountEmployeeTimeEntry.TotalTime, dbo.AccountEmployeeTimeEntry.Description, 
                      dbo.AccountProject.ProjectName, dbo.AccountProject.ProjectDescription, dbo.AccountProject.ProjectCode, dbo.AccountProject.IsDisabled, 
                      dbo.AccountProject.IsTemplate, dbo.AccountProject.IsProject, dbo.AccountProject.IsDeleted, dbo.AccountProjectTask.TaskName, 
                      dbo.AccountProjectTask.TaskDescription, dbo.AccountProjectTask.IsParentTask, dbo.AccountProjectTask.IsBillable, dbo.AccountProjectTask.TaskCode, 
                      LEFT(dbo.AccountParty.PartyName, 41) AS PartyName, dbo.AccountParty.PartyNick, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountEmployee.AccountId, dbo.AccountEmployee.EmployeeCode, 
                      dbo.AccountProjectMilestone.MilestoneDescription, dbo.AccountEmployee.AccountEmployeeId, dbo.AccountWorkType.AccountWorkType, 
                      dbo.AccountCostCenter.AccountCostCenter, dbo.AccountDepartment.DepartmentName, dbo.AccountEmployeeType.AccountEmployeeType, 
                      dbo.AccountProject.AccountProjectId, dbo.AccountProjectTask.AccountProjectTaskId, NULL AS ServiceItemName
FROM         dbo.AccountEmployeeTimeEntry INNER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId INNER JOIN
                      dbo.AccountProjectTask ON dbo.AccountEmployeeTimeEntry.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId INNER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeEntry.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId INNER JOIN
                      dbo.AccountProjectMilestone ON dbo.AccountProjectTask.AccountProjectMilestoneId = dbo.AccountProjectMilestone.AccountProjectMilestoneId INNER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId AND 
                      dbo.AccountEmployee.AccountId = dbo.AccountDepartment.AccountId INNER JOIN
                      dbo.AccountEmployeeType ON dbo.AccountEmployee.EmployeePayTypeId = dbo.AccountEmployeeType.AccountEmployeeTypeId AND 
                      dbo.AccountEmployee.AccountId = dbo.AccountEmployeeType.AccountId LEFT OUTER JOIN
                      dbo.AccountCostCenter ON dbo.AccountEmployeeTimeEntry.AccountCostCenterId = dbo.AccountCostCenter.AccountCostCenterId LEFT OUTER JOIN
                      dbo.AccountWorkType ON dbo.AccountEmployeeTimeEntry.AccountWorkTypeId = dbo.AccountWorkType.AccountWorkTypeId'
GO
-- Drop View vueAccount
Print 'Drop View vueAccount'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccount' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccount]

GO
-- Drop View vueAccountEmployee
Print 'Drop View vueAccountEmployee'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployee]

GO
-- Add Column EnablePasswordComplexity to AccountPreferences
Print 'Add Column EnablePasswordComplexity to AccountPreferences'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountPreferences' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='EnablePasswordComplexity' AND TABLE_NAME='AccountPreferences'))
ALTER TABLE [dbo].[AccountPreferences]
	ADD [EnablePasswordComplexity] bit NULL


GO
-- Create View vueAccountEmployee
Print 'Create View vueAccountEmployee'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployee
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountEmployee.AccountId, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.Password, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountLocationId, dbo.AccountEmployee.BillingTypeId, 
                      dbo.AccountBillingType.BillingType, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, dbo.AccountPreferences.ShowClockStartEnd, dbo.Account.TimeZoneId, 
                      dbo.AccountRole.MasterAccountRoleId, dbo.Account.DefaultCurrencyId, dbo.Account.CountryId, dbo.AccountPreferences.CultureInfoName, 
                      dbo.AccountPreferences.TimeEntryFormat, dbo.AccountEmployee.AllowedAccessFromIP, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountPreferences.AccountSessionTimeout, dbo.AccountPreferences.ShowCompletedTasksInTimeSheet, dbo.AccountPreferences.CurrencySymbol, 
                      dbo.AccountPreferences.IsCompanyOwnLogo, dbo.Account.AccountExpiryActivation, dbo.Account.LicenseActivation, dbo.AccountEmployee.EmployeeTypeId, 
                      dbo.AccountEmployee.ExternalUserClientId, dbo.AccountEmployee.AccountBillingRateId, dbo.AccountPreferences.ScheduledEmailSendTime, 
                      dbo.AccountEmployee.Username, dbo.AccountEmployee.IsDisabled, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.AccountEmployee.EmployeeCode, dbo.AccountPreferences.Version, 
                      dbo.AccountPreferences.LockSubmittedRecords, dbo.AccountPreferences.LockApprovedRecords, ISNULL(dbo.AccountEmployee.EmployeeCode + '' - '', '''') 
                      + dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeNameWithCode, dbo.AccountPreferences.ShowWorkTypeInTimeSheet, 
                      dbo.AccountPreferences.NumberOfBlankRowsInTimeEntry, dbo.AccountPreferences.ShowCostCenterInTimeSheet, dbo.AccountPreferences.WeekStartDay, 
                      dbo.AccountPreferences.AccountBaseCurrencyId, dbo.AccountPreferences.UserInterfaceLanguage, dbo.AccountEmployee.EmployeeManagerId, 
                      dbo.AccountPreferences.DefaultTimeEntryMode, dbo.AccountPreferences.PageSize, dbo.AccountEmployee.TimeZoneId AS EmployeeTimeZoneId, 
                      dbo.AccountEmployee.TerminationDate, dbo.AccountEmployee.StatusId, dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.EmployeePayTypeId, 
                      dbo.AccountEmployee.HiredDate, dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountWorkingDayType, 
                      dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay AS EmployeeWeekStartDay, 
                      dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountPreferences.ShowDescriptionInWeekView, 
                      dbo.AccountPreferences.InvoiceNoPrefix, dbo.AccountPreferences.ShowAdditionalTaskInformationType, 
                      dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, 
                      ISNULL(dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, 1) AS InitialDayOfTheMonth, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, 1) 
                      AS SystemInitialDayOfFirstPeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod, 16) AS SystemInitialDayOfLastPeriod, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountPreferences.TimesheetPrintFooter, dbo.AccountPreferences.ExpenseSheetPrintFooter, 
                      dbo.AccountPreferences.ShowCompletedProjectsInTimeSheet, dbo.AccountPreferences.ShowProjectForTimeOff, dbo.AccountPreferences.ShowTimeOffInTimesheet, 
                      dbo.AccountEmployee.IsDeleted, dbo.AccountEmployee.IsForcePasswordChange, dbo.AccountEmployee.PasswordChangedDate, 
                      dbo.AccountPreferences.PasswordExpiryPeriod, dbo.AccountPreferences.ShowAllInTimesheetReadOnly, dbo.AccountPreferences.ShowTaskInExpenseSheet, 
                      dbo.AccountPreferences.InvoiceBillingTypeId, dbo.AccountPreferences.ShowBillingRateInInvoiceReport, dbo.SystemInvoiceBillingType.InvoiceBillingType, 
                      dbo.AccountPreferences.InvoiceFooter, dbo.AccountPreferences.TimesheetOverduePeriods, dbo.AccountWorkingDayType.TimesheetOverdueAfterDays, 
                      dbo.AccountEmployee.CreatedOn, dbo.AccountEmployee.CreatedByEmployeeId, dbo.AccountEmployee.ModifiedOn, dbo.AccountEmployee.ModifiedByEmployeeId, 
                      dbo.AccountPreferences.ShowProjectNameInInvoiceReport, dbo.AccountPreferences.ProjectCodePrefix, dbo.AccountPreferences.AutoGenerateProjectCode, 
                      dbo.AccountPreferences.TimeEntryHoursFormatId, dbo.AccountPreferences.ShowPercentageInTimesheet, dbo.AccountPreferences.EnablePasswordComplexity
FROM         dbo.SystemInvoiceBillingType RIGHT OUTER JOIN
                      dbo.AccountPreferences ON dbo.SystemInvoiceBillingType.InvoiceBillingTypeId = dbo.AccountPreferences.InvoiceBillingTypeId RIGHT OUTER JOIN
                      dbo.vueAccountTimesheetPeriodType RIGHT OUTER JOIN
                      dbo.AccountWorkingDayType ON 
                      dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId = dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId RIGHT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.Account ON dbo.AccountEmployee.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId ON 
                      dbo.AccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId ON 
                      dbo.AccountPreferences.AccountId = dbo.AccountEmployee.AccountId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId'

GO
-- Create View vueAccount
Print 'Create View vueAccount'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccount' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccount
AS
SELECT     dbo.Account.AccountId, dbo.Account.AccountTypeId, dbo.Account.AccountName, dbo.Account.Address1, dbo.Account.Address2, dbo.Account.ZipCode, dbo.Account.State, 
                      dbo.Account.City, dbo.Account.CountryId, dbo.Account.EMailAddress, dbo.Account.Telephone, dbo.Account.Fax, dbo.Account.DefaultCurrencyId, 
                      dbo.Account.TimeZoneId, dbo.Account.IsDisabled, dbo.Account.IsDeleted, dbo.Account.StatusId, dbo.Account.CreatedOn, dbo.Account.ModifiedOn, 
                      dbo.Account.ModifiedByEmployeeId, dbo.AccountPreferences.ShowClockStartEnd, dbo.AccountPreferences.AccountPreferencesId, dbo.Account.LicenseKey, 
                      dbo.Account.SystemPackageTypeId, dbo.AccountPreferences.TimeEntryFormat, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.Account.MachineId, dbo.Account.ActivationLicenseKey, dbo.Account.ActivationMachineKey, 
                      dbo.Account.ActivationType, dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountPreferences.InvoiceBillingTypeId, 
                      dbo.AccountPreferences.ShowBillingRateInInvoiceReport, dbo.AccountPreferences.InvoiceFooter, dbo.AccountPreferences.ShowProjectNameInInvoiceReport, 
                      dbo.AccountPreferences.ProjectCodePrefix, dbo.AccountPreferences.AutoGenerateProjectCode, dbo.AccountPreferences.TimeEntryHoursFormatId, 
                      dbo.AccountPreferences.ShowPercentageInTimesheet, dbo.AccountPreferences.EnablePasswordComplexity
FROM         dbo.Account INNER JOIN
                      dbo.AccountPreferences ON dbo.Account.AccountId = dbo.AccountPreferences.AccountId'

GO

-- Drop View rptvueAccountProjectTaskEmployee
Print 'Drop View rptvueAccountProjectTaskEmployee'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectTaskEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountProjectTaskEmployee]

GO
-- Drop View VueAccountProjectTaskEmployeeForReport
Print 'Drop View VueAccountProjectTaskEmployeeForReport'
GO
if exists (select * from information_schema.tables where table_name = 'VueAccountProjectTaskEmployeeForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[VueAccountProjectTaskEmployeeForReport]

GO
-- Create View VueAccountProjectTaskEmployeeForReport
Print 'Create View VueAccountProjectTaskEmployeeForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'VueAccountProjectTaskEmployeeForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.VueAccountProjectTaskEmployeeForReport
AS
SELECT     dbo.AccountProjectTaskEmployee.AccountProjectTaskEmployeeId, dbo.AccountProjectTaskEmployee.AccountId, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, dbo.AccountProjectTaskEmployee.AccountProjectTaskId, 
                      dbo.AccountProjectTaskEmployee.AccountEmployeeId, dbo.AccountProjectTask.AccountProjectId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, 
                      dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountEmployee.AccountTimeOffPolicyId, dbo.AccountEmployee.TimeOffApprovalTypeId, 
                      dbo.AccountEmployee.AccountHolidayTypeId, dbo.AccountParty.PartyName AS ClientName, dbo.AccountProjectTask.TaskName, 
                      dbo.AccountProjectTask.TaskDescription, dbo.AccountProjectTask.Duration AS TaskDuration, dbo.AccountProjectTask.DurationUnit AS TaskDurationUnit, 
                      dbo.AccountProjectTask.DeadlineDate AS TaskDeadlineDate, dbo.AccountProjectTask.Completed AS TaskCompleted, dbo.AccountProjectTask.IsParentTask, 
                      dbo.AccountProjectTask.IsForAllEmployees, dbo.AccountProjectTask.EstimatedCost AS TaskEmployeeCost, 
                      dbo.AccountProjectTask.EstimatedTimeSpent AS TaskEstimatedTimeSpent, dbo.AccountProjectTask.EstimatedTimeSpentUnit AS TaskEstimatedTimeSpentUnit, 
                      dbo.AccountProjectTask.TaskCode, dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.State, dbo.AccountEmployee.City, dbo.AccountEmployee.Zip, dbo.AccountEmployee.HomePhoneNo, dbo.AccountEmployee.WorkPhoneNo, 
                      dbo.AccountEmployee.MobilePhoneNo, dbo.AccountEmployee.BillingRateStateDate, dbo.AccountEmployee.TerminationDate, dbo.AccountEmployee.EmployeeCode, 
                      dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.HiredDate, dbo.AccountEmployeeType.AccountEmployeeType, 
                      dbo.AccountWorkingDayType.AccountWorkingDayType, dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, dbo.AccountWorkingDayType.MinimumHoursPerWeek, 
                      dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountTimeOffPolicy.AccountTimeOffPolicy, dbo.AccountProject.ProjectName, 
                      dbo.AccountProject.ProjectDescription, dbo.AccountProject.StartDate AS ProjectStartDate, dbo.AccountProject.Deadline AS ProjectDeadlineDate, 
                      dbo.AccountProject.EstimatedTime AS ProjectEstimatedTime, dbo.AccountProject.EstimatedDuration AS ProjectEstimatedDuration, 
                      dbo.AccountProject.EstimatedDurationUnit AS ProjectEstimatedDurationUnit, dbo.AccountProject.ProjectCode, dbo.AccountProject.Completed AS ProjectCompleted, 
                      dbo.AccountStatus.Status AS TaskStatus, dbo.AccountPriority.Priority, dbo.AccountProjectTask.AccountPriorityId, dbo.AccountProjectTask.TaskStatusId, 
                      dbo.AccountProjectTask.AccountTaskTypeId, dbo.AccountTaskType.TaskType, dbo.AccountBillingRate.BillingRate, 
                      dbo.AccountBillingRate.StartDate AS BillingRateStartDate, dbo.AccountBillingRate.EndDate AS BillingRateEndDate, dbo.AccountBillingRate.EmployeeRate, 
                      SUM(DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) AS TotalMinutes, 
                      dbo.AccountProjectTask.StartDate AS TaskStartDate, dbo.AccountProject.AccountClientId
FROM         dbo.AccountBillingRate INNER JOIN
                      dbo.AccountTaskType INNER JOIN
                      dbo.AccountProjectTaskEmployee INNER JOIN
                      dbo.AccountParty INNER JOIN
                      dbo.AccountProject ON dbo.AccountParty.AccountPartyId = dbo.AccountProject.AccountClientId INNER JOIN
                      dbo.AccountStatus INNER JOIN
                      dbo.AccountProjectTask ON dbo.AccountStatus.AccountStatusId = dbo.AccountProjectTask.TaskStatusId INNER JOIN
                      dbo.AccountPriority ON dbo.AccountProjectTask.AccountPriorityId = dbo.AccountPriority.AccountPriorityId ON 
                      dbo.AccountProject.AccountProjectId = dbo.AccountProjectTask.AccountProjectId ON 
                      dbo.AccountProjectTaskEmployee.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountProjectTaskEmployee.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId ON 
                      dbo.AccountTaskType.AccountTaskTypeId = dbo.AccountProjectTask.AccountTaskTypeId ON 
                      dbo.AccountBillingRate.AccountBillingRateId = dbo.AccountProjectTask.AccountBillingRateId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntry ON dbo.AccountProject.AccountProjectId = dbo.AccountEmployeeTimeEntry.AccountProjectId AND 
                      dbo.AccountProjectTask.AccountProjectTaskId = dbo.AccountEmployeeTimeEntry.AccountProjectTaskId AND 
                      dbo.AccountEmployee.AccountEmployeeId = dbo.AccountEmployeeTimeEntry.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployeeType ON dbo.AccountEmployee.EmployeePayTypeId = dbo.AccountEmployeeType.AccountEmployeeTypeId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountWorkingDayType ON dbo.AccountEmployee.AccountWorkingDayTypeId = dbo.AccountWorkingDayType.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountTimeOffPolicy ON dbo.AccountEmployee.AccountTimeOffPolicyId = dbo.AccountTimeOffPolicy.AccountTimeOffPolicyId
GROUP BY dbo.AccountProjectTaskEmployee.AccountProjectTaskEmployeeId, dbo.AccountProjectTaskEmployee.AccountId, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END, dbo.AccountProjectTaskEmployee.AccountProjectTaskId, dbo.AccountProjectTaskEmployee.AccountEmployeeId, 
                      dbo.AccountProjectTask.AccountProjectId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.AccountWorkingDayTypeId, 
                      dbo.AccountEmployee.AccountTimeOffPolicyId, dbo.AccountEmployee.TimeOffApprovalTypeId, dbo.AccountEmployee.AccountHolidayTypeId, 
                      dbo.AccountParty.PartyName, dbo.AccountProjectTask.TaskName, dbo.AccountProjectTask.TaskDescription, dbo.AccountProjectTask.Duration, 
                      dbo.AccountProjectTask.DurationUnit, dbo.AccountProjectTask.DeadlineDate, dbo.AccountProjectTask.Completed, dbo.AccountProjectTask.IsParentTask, 
                      dbo.AccountProjectTask.IsForAllEmployees, dbo.AccountProjectTask.EstimatedCost, dbo.AccountProjectTask.EstimatedTimeSpent, 
                      dbo.AccountProjectTask.EstimatedTimeSpentUnit, dbo.AccountProjectTask.TaskCode, dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, 
                      dbo.AccountLocation.AccountLocation, dbo.AccountEmployee.State, dbo.AccountEmployee.City, dbo.AccountEmployee.Zip, dbo.AccountEmployee.HomePhoneNo, 
                      dbo.AccountEmployee.WorkPhoneNo, dbo.AccountEmployee.MobilePhoneNo, dbo.AccountEmployee.BillingRateStateDate, dbo.AccountEmployee.TerminationDate, 
                      dbo.AccountEmployee.EmployeeCode, dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.HiredDate, dbo.AccountEmployeeType.AccountEmployeeType, 
                      dbo.AccountWorkingDayType.AccountWorkingDayType, dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, dbo.AccountWorkingDayType.MinimumHoursPerWeek, 
                      dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountTimeOffPolicy.AccountTimeOffPolicy, dbo.AccountProject.ProjectName, 
                      dbo.AccountProject.ProjectDescription, dbo.AccountProject.StartDate, dbo.AccountProject.Deadline, dbo.AccountProject.EstimatedTime, 
                      dbo.AccountProject.EstimatedDuration, dbo.AccountProject.EstimatedDurationUnit, dbo.AccountProject.ProjectCode, dbo.AccountProject.Completed, 
                      dbo.AccountStatus.Status, dbo.AccountPriority.Priority, dbo.AccountProjectTask.AccountPriorityId, dbo.AccountProjectTask.TaskStatusId, 
                      dbo.AccountProjectTask.AccountTaskTypeId, dbo.AccountTaskType.TaskType, dbo.AccountBillingRate.BillingRate, dbo.AccountBillingRate.StartDate, 
                      dbo.AccountBillingRate.EndDate, dbo.AccountBillingRate.EmployeeRate, dbo.AccountProjectTask.StartDate, dbo.AccountProject.AccountClientId'

GO
-- Create View rptvueAccountProjectTaskEmployee
Print 'Create View rptvueAccountProjectTaskEmployee'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectTaskEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountProjectTaskEmployee
AS
SELECT     AccountProjectTaskEmployeeId, AccountProjectId, AccountProjectTaskId, TaskName, AccountEmployeeId, AccountId, TaskDescription, TaskCode, DepartmentName, 
                      AccountLocation, AccountEmployeeType, EmployeeCode, IsParentTask, IsForAllEmployees, EmployeeName, ClientName, TaskDuration, TaskDurationUnit, 
                      TaskDeadlineDate, TaskCompleted, TaskEmployeeCost, TaskEstimatedTimeSpent, TaskEstimatedTimeSpentUnit, Role, State, City, Zip, HomePhoneNo, 
                      WorkPhoneNo, MobilePhoneNo, BillingRateStateDate, TerminationDate, JobTitle, HiredDate, AccountWorkingDayType, HoursPerDay, WeekStartDay, 
                      MinimumHoursPerDay, MaximumHoursPerDay, MaximumHoursPerWeek, MinimumHoursPerWeek, AccountTimeOffPolicy, ProjectName, ProjectDescription, 
                      ProjectStartDate, ProjectDeadlineDate, ProjectEstimatedTime, ProjectEstimatedDuration, ProjectEstimatedDurationUnit, ProjectCode, ProjectCompleted, TaskStatus, 
                      Priority, AccountPriorityId, TaskStatusId, AccountTaskTypeId, TaskType, BillingRate, BillingRateStartDate, BillingRateEndDate, EmployeeRate, ROUND(CONVERT(float, 
                      TotalMinutes) / 60, 2) AS TotalHours, REPLACE(TotalMinutes / 60, '''', ''.00'') + '':'' + RIGHT(''0'' + REPLACE(TotalMinutes - TotalMinutes / 60 * 60, '''', ''.00''), 2) AS TotalTime, 
                      TaskStartDate, AccountClientId
FROM         dbo.VueAccountProjectTaskEmployeeForReport'

GO

-- Drop View vueTimesheetSummaryPendingForApproval
Print 'Drop View vueTimesheetSummaryPendingForApproval'
GO
if exists (select * from information_schema.tables where table_name = 'vueTimesheetSummaryPendingForApproval' and table_type = 'VIEW')
DROP VIEW [dbo].[vueTimesheetSummaryPendingForApproval]

GO
-- Drop View vueTimesheetSummaryForApproval
Print 'Drop View vueTimesheetSummaryForApproval'
GO
if exists (select * from information_schema.tables where table_name = 'vueTimesheetSummaryForApproval' and table_type = 'VIEW')
DROP VIEW [dbo].[vueTimesheetSummaryForApproval]

GO
-- Create View vueTimesheetSummaryForApproval
Print 'Create View vueTimesheetSummaryForApproval'
GO
if not exists (select * from information_schema.tables where table_name = 'vueTimesheetSummaryForApproval' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueTimesheetSummaryForApproval
AS
SELECT     dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId, 
                      dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeId AS TimeEntryAccountEmployeeId, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, 
                      dbo.AccountEmployeeTimeEntryApproval.TimeSheetApprovalId, dbo.AccountApprovalPath.AccountApprovalPathId, dbo.AccountApprovalPath.SystemApproverTypeId, 
                      dbo.AccountApprovalPath.AccountExternalUserId, dbo.AccountApprovalPath.AccountEmployeeId, dbo.AccountApprovalPath.ApprovalPathSequence, 
                      dbo.AccountProject.LeaderEmployeeId, dbo.AccountProject.ProjectManagerEmployeeId, dbo.AccountApprovalType.AccountApprovalTypeId, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountEmployee.EmployeeManagerId, 
                      dbo.AccountProject.AccountProjectId, dbo.AccountEmployeeTimeEntryApproval.IsApproved, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountEmployeeTimeEntryApprovalProject.AccountEmployeeTimeEntryApprovalProjectId, dbo.AccountEmployeeTimeEntryApproval.PreviousStatus, 
                      dbo.AccountEmployeeTimeEntryApproval.IsReject, dbo.AccountEmployeeTimeEntryApprovalProject.Submitted, 
                      dbo.AccountEmployeeTimeEntryApprovalProject.Approved, dbo.AccountEmployeeTimeEntryApprovalProject.Rejected, 
                      dbo.AccountEmployeeTimeEntryApprovalProject.IsEmailSend, dbo.AccountEmployeeTimeEntryPeriod.SubmittedDate, dbo.AccountEmployee.IsDisabled
FROM         dbo.AccountApprovalType INNER JOIN
                      dbo.AccountEmployeeTimeEntryApprovalProject INNER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntryApprovalProject.AccountProjectId = dbo.AccountProject.AccountProjectId ON 
                      dbo.AccountApprovalType.AccountApprovalTypeId = dbo.AccountProject.TimeSheetApprovalTypeId INNER JOIN
                      dbo.AccountApprovalPath ON dbo.AccountApprovalType.AccountApprovalTypeId = dbo.AccountApprovalPath.AccountApprovalTypeId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryApproval ON dbo.AccountApprovalPath.ApprovalPathSequence = dbo.AccountEmployeeTimeEntryApproval.ApprovalPathSequence AND 
                      dbo.AccountEmployeeTimeEntryApproval.PreviousStatus <> 1 AND dbo.AccountEmployeeTimeEntryApproval.IsReject <> 1 AND 
                      dbo.AccountEmployeeTimeEntryApprovalProject.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntryApproval.AccountEmployeeTimeEntryPeriodId AND
                       dbo.AccountEmployeeTimeEntryApprovalProject.AccountProjectId = dbo.AccountEmployeeTimeEntryApproval.AccountProjectId RIGHT OUTER JOIN
                      dbo.AccountEmployee RIGHT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryPeriod ON dbo.AccountEmployee.AccountEmployeeId = dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeId ON 
                      dbo.AccountEmployeeTimeEntryApprovalProject.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId'

GO
-- Create View vueTimesheetSummaryPendingForApproval
Print 'Create View vueTimesheetSummaryPendingForApproval'
GO
if not exists (select * from information_schema.tables where table_name = 'vueTimesheetSummaryPendingForApproval' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueTimesheetSummaryPendingForApproval
AS
SELECT     AccountEmployeeTimeEntryPeriodId, TimeEntryAccountEmployeeId, TimeEntryStartDate, TimeEntryEndDate, TimeEntryViewType, Submitted, Approved, Rejected, 
                      MAX(TimeSheetApprovalId) AS TimeSheetApprovalId, AccountApprovalPathId, SystemApproverTypeId, AccountExternalUserId, AccountEmployeeId, 
                      ApprovalPathSequence, LeaderEmployeeId, ProjectManagerEmployeeId, AccountApprovalTypeId, EmployeeName, EmployeeManagerId, AccountProjectId, 
                      CASE WHEN systemapprovertypeid = 1 THEN LeaderEmployeeId WHEN systemapprovertypeid = 2 THEN ProjectManagerEmployeeId WHEN systemapprovertypeid = 3
                       THEN AccountEmployeeId WHEN systemapprovertypeid = 4 THEN AccountExternalUserId WHEN systemapprovertypeid = 5 THEN EmployeeManagerId END AS ApproverEmployeeId,
                       IsApproved, EMailAddress, AccountEmployeeTimeEntryApprovalProjectId, IsEmailSend, SubmittedDate, IsDisabled
FROM         dbo.vueTimesheetSummaryForApproval
WHERE     (ApprovalPathSequence IN
                          (SELECT     TOP (1) ApprovalPathSequence
                            FROM          dbo.vueTimesheetSequenceForApproval
                            WHERE      (TimeSheetApprovalId IS NULL) AND (AccountProjectId = dbo.vueTimesheetSummaryForApproval.AccountProjectId) AND 
                                                   (AccountEmployeeTimeEntryPeriodId = dbo.vueTimesheetSummaryForApproval.AccountEmployeeTimeEntryPeriodId)))
GROUP BY AccountEmployeeTimeEntryPeriodId, TimeEntryAccountEmployeeId, TimeEntryStartDate, TimeEntryEndDate, TimeEntryViewType, Submitted, Approved, Rejected, 
                      AccountApprovalPathId, SystemApproverTypeId, AccountExternalUserId, AccountEmployeeId, ApprovalPathSequence, LeaderEmployeeId, ProjectManagerEmployeeId, 
                      AccountApprovalTypeId, EmployeeName, EmployeeManagerId, AccountProjectId, IsApproved, EMailAddress, AccountEmployeeTimeEntryApprovalProjectId, 
                      IsEmailSend, SubmittedDate, IsDisabled'

GO

-- Drop View vueAccountEmployeeAttendance
Print 'Drop View vueAccountEmployeeAttendance'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeAttendance' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeAttendance]

GO
-- Create View vueAccountEmployeeAttendance
Print 'Create View vueAccountEmployeeAttendance'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeAttendance' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeAttendance
AS
SELECT     dbo.AccountEmployeeAttendance.AccountEmployeeAttendanceId, dbo.AccountEmployeeAttendance.AccountId, dbo.AccountEmployeeAttendance.AccountEmployeeId, 
                      dbo.AccountEmployeeAttendance.AttendanceDate, dbo.AccountEmployeeAttendance.AccountAbsenceTypeId, dbo.AccountEmployeeAttendance.AttendanceTime, 
                      dbo.AccountEmployeeAttendance.InOut, dbo.AccountEmployeeAttendance.CreatedByEmployeeId, dbo.AccountEmployeeAttendance.CreatedOn, 
                      dbo.AccountEmployeeAttendance.ModifiedByEmployeeId, dbo.AccountEmployeeAttendance.ModifiedOn, dbo.AccountAbsenceType.AbsenceDescription, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName
FROM         dbo.AccountEmployeeAttendance LEFT OUTER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeAttendance.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountAbsenceType ON dbo.AccountEmployeeAttendance.AccountAbsenceTypeId = dbo.AccountAbsenceType.AccountAbsenceTypeId'

GO

-- Drop View vueAccountEmployeeTimeEntryApprovalPendingEmailWithPreference
Print 'Drop View vueAccountEmployeeTimeEntryApprovalPendingEmailWithPreference'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryApprovalPendingEmailWithPreference' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryApprovalPendingEmailWithPreference]

GO
-- Create View vueAccountEmployeeTimeEntryApprovalPendingEmailWithPreference
Print 'Create View vueAccountEmployeeTimeEntryApprovalPendingEmailWithPreference'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryApprovalPendingEmailWithPreference' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryApprovalPendingEmailWithPreference
AS
SELECT     dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountProjectId, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.ProjectManagerEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.ApprovalTypeName, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountApprovalPathId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.SystemApproverTypeId, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountExternalUserId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountEmployeeId, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.ApprovalPathSequence, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountEmployeeTimeEntryId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TimeSheetApprovalId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TimeSheetApprovalPathId, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.ProjectName, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.ProjectDescription, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.ProjectCode, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TaskName, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountProjectTaskId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TaskDescription, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.EmployeeName, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.Approved, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TotalTime, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TimeEntryDate, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.Comments, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.IsReject, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.IsApproved, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.MaxApprovalPathSequence, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TimeEntryAccountEmployeeId, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.EMailAddress, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.ApproverEmployeeId, 
                      dbo.AccountPreferences.ScheduledEmailSendTime, AccountEmployee_1.EMailAddress AS ApproverEMailAddress, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.Description, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.EmployeeManagerId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TotalMinutes, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.NonBillableTotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.BillableTotalMinutes, dbo.AccountPreferences.CultureInfoName, 
                      AccountEmployee_1.LastScheduledEmailSentTime, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountEmployeeTimeEntryPeriodId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TimeEntryStartDate, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.EmployeeWeekStartDay, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TimeEntryEndDate, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TimeEntryViewType, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.Monday, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.Tuesday, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.Wednesday, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.Thursday, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.Friday, dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.Saturday, 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.Sunday
FROM         dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail LEFT OUTER JOIN
                      dbo.AccountEmployee ON 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.TimeEntryAccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON 
                      dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.ApproverEmployeeId = AccountEmployee_1.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountPreferences ON dbo.vueAccountEmployeeTimeEntryApprovalPendingEMail.AccountId = dbo.AccountPreferences.AccountId
WHERE     (AccountEmployee_1.IsDeleted <> 1) AND (dbo.AccountEmployee.IsDisabled <> 1) AND (dbo.AccountEmployee.IsDeleted <> 1)'

GO
-- Drop View vueAccount
Print 'Drop View vueAccount'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccount' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccount]

GO
-- Drop View vueAccountProjects
Print 'Drop View vueAccountProjects'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountProjects' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountProjects]

GO
-- Drop View vueAccountEmployee
Print 'Drop View vueAccountEmployee'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployee]

GO
-- Add Column ShowClientDepartmentInProject to AccountPreferences
Print 'Add Column ShowClientDepartmentInProject to AccountPreferences'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountPreferences' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='ShowClientDepartmentInProject' AND TABLE_NAME='AccountPreferences'))
ALTER TABLE [dbo].[AccountPreferences]
	ADD [ShowClientDepartmentInProject] bit NULL

GO
-- Create View vueAccountEmployee
Print 'Create View vueAccountEmployee'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployee
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountEmployee.AccountId, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.Password, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountLocationId, dbo.AccountEmployee.BillingTypeId, 
                      dbo.AccountBillingType.BillingType, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, dbo.AccountPreferences.ShowClockStartEnd, dbo.Account.TimeZoneId, 
                      dbo.AccountRole.MasterAccountRoleId, dbo.Account.DefaultCurrencyId, dbo.Account.CountryId, dbo.AccountPreferences.CultureInfoName, 
                      dbo.AccountPreferences.TimeEntryFormat, dbo.AccountEmployee.AllowedAccessFromIP, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountPreferences.AccountSessionTimeout, dbo.AccountPreferences.ShowCompletedTasksInTimeSheet, dbo.AccountPreferences.CurrencySymbol, 
                      dbo.AccountPreferences.IsCompanyOwnLogo, dbo.Account.AccountExpiryActivation, dbo.Account.LicenseActivation, dbo.AccountEmployee.EmployeeTypeId, 
                      dbo.AccountEmployee.ExternalUserClientId, dbo.AccountEmployee.AccountBillingRateId, dbo.AccountPreferences.ScheduledEmailSendTime, 
                      dbo.AccountEmployee.Username, dbo.AccountEmployee.IsDisabled, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.AccountEmployee.EmployeeCode, dbo.AccountPreferences.Version, 
                      dbo.AccountPreferences.LockSubmittedRecords, dbo.AccountPreferences.LockApprovedRecords, ISNULL(dbo.AccountEmployee.EmployeeCode + '' - '', '''') 
                      + dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeNameWithCode, dbo.AccountPreferences.ShowWorkTypeInTimeSheet, 
                      dbo.AccountPreferences.NumberOfBlankRowsInTimeEntry, dbo.AccountPreferences.ShowCostCenterInTimeSheet, dbo.AccountPreferences.WeekStartDay, 
                      dbo.AccountPreferences.AccountBaseCurrencyId, dbo.AccountPreferences.UserInterfaceLanguage, dbo.AccountEmployee.EmployeeManagerId, 
                      dbo.AccountPreferences.DefaultTimeEntryMode, dbo.AccountPreferences.PageSize, dbo.AccountEmployee.TimeZoneId AS EmployeeTimeZoneId, 
                      dbo.AccountEmployee.TerminationDate, dbo.AccountEmployee.StatusId, dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.EmployeePayTypeId, 
                      dbo.AccountEmployee.HiredDate, dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountWorkingDayType, 
                      dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay AS EmployeeWeekStartDay, 
                      dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountPreferences.ShowDescriptionInWeekView, 
                      dbo.AccountPreferences.InvoiceNoPrefix, dbo.AccountPreferences.ShowAdditionalTaskInformationType, 
                      dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, 
                      ISNULL(dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, 1) AS InitialDayOfTheMonth, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, 1) 
                      AS SystemInitialDayOfFirstPeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod, 16) AS SystemInitialDayOfLastPeriod, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountPreferences.TimesheetPrintFooter, dbo.AccountPreferences.ExpenseSheetPrintFooter, 
                      dbo.AccountPreferences.ShowCompletedProjectsInTimeSheet, dbo.AccountPreferences.ShowProjectForTimeOff, dbo.AccountPreferences.ShowTimeOffInTimesheet, 
                      dbo.AccountEmployee.IsDeleted, dbo.AccountEmployee.IsForcePasswordChange, dbo.AccountEmployee.PasswordChangedDate, 
                      dbo.AccountPreferences.PasswordExpiryPeriod, dbo.AccountPreferences.ShowAllInTimesheetReadOnly, dbo.AccountPreferences.ShowTaskInExpenseSheet, 
                      dbo.AccountPreferences.InvoiceBillingTypeId, dbo.AccountPreferences.ShowBillingRateInInvoiceReport, dbo.SystemInvoiceBillingType.InvoiceBillingType, 
                      dbo.AccountPreferences.InvoiceFooter, dbo.AccountPreferences.TimesheetOverduePeriods, dbo.AccountWorkingDayType.TimesheetOverdueAfterDays, 
                      dbo.AccountEmployee.CreatedOn, dbo.AccountEmployee.CreatedByEmployeeId, dbo.AccountEmployee.ModifiedOn, dbo.AccountEmployee.ModifiedByEmployeeId, 
                      dbo.AccountPreferences.ShowProjectNameInInvoiceReport, dbo.AccountPreferences.ProjectCodePrefix, dbo.AccountPreferences.AutoGenerateProjectCode, 
                      dbo.AccountPreferences.TimeEntryHoursFormatId, dbo.AccountPreferences.ShowPercentageInTimesheet, dbo.AccountPreferences.EnablePasswordComplexity, 
                      dbo.AccountPreferences.ShowClientDepartmentInProject
FROM         dbo.SystemInvoiceBillingType RIGHT OUTER JOIN
                      dbo.AccountPreferences ON dbo.SystemInvoiceBillingType.InvoiceBillingTypeId = dbo.AccountPreferences.InvoiceBillingTypeId RIGHT OUTER JOIN
                      dbo.vueAccountTimesheetPeriodType RIGHT OUTER JOIN
                      dbo.AccountWorkingDayType ON 
                      dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId = dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId RIGHT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.Account ON dbo.AccountEmployee.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId ON 
                      dbo.AccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId ON 
                      dbo.AccountPreferences.AccountId = dbo.AccountEmployee.AccountId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId'

GO
-- Create View vueAccountProjects
Print 'Create View vueAccountProjects'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountProjects' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountProjects
AS
SELECT     dbo.AccountProject.AccountProjectId, dbo.AccountProject.ProjectName, dbo.AccountProject.StartDate, dbo.AccountProject.ProjectCode, dbo.AccountParty.PartyName, 
                      dbo.AccountProject.AccountClientId, dbo.AccountProject.LeaderEmployeeId, dbo.AccountProject.ProjectManagerEmployeeId, 
                      AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName AS LeaderName, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS ProjectManagerName, dbo.AccountProject.AccountId, dbo.AccountProject.IsActive, 
                      dbo.AccountProject.Deadline, dbo.AccountProject.EstimatedDuration, dbo.AccountProject.EstimatedDurationUnit, dbo.AccountProject.ProjectStatusId, 
                      dbo.AccountStatus.Status, dbo.AccountProject.IsDisabled, dbo.AccountProject.ProjectDescription, dbo.AccountProject.IsTemplate, dbo.AccountProject.IsProject, 
                      dbo.AccountProject.AccountProjectTemplateId, dbo.SystemProjectBillingRateType.SystemProjectBillingRateType, dbo.AccountProject.AccountProjectTypeId, 
                      dbo.AccountProjectType.ProjectType, dbo.AccountProjectType.MasterAccountProjectTypeId, dbo.AccountProject.IsDeleted, 
                      dbo.AccountPartyDepartment.PartyDepartmentName
FROM         dbo.AccountStatus RIGHT OUTER JOIN
                      dbo.SystemProjectBillingRateType RIGHT OUTER JOIN
                      dbo.AccountProject INNER JOIN
                      dbo.AccountProjectType ON dbo.AccountProject.AccountProjectTypeId = dbo.AccountProjectType.AccountProjectTypeId INNER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId LEFT OUTER JOIN
                      dbo.AccountPartyDepartment ON dbo.AccountProject.AccountPartyDepartmentId = dbo.AccountPartyDepartment.AccountPartyDepartmentId ON 
                      dbo.SystemProjectBillingRateType.SystemProjectBillingRateTypeId = dbo.AccountProject.ProjectBillingRateTypeId ON 
                      dbo.AccountStatus.AccountStatusId = dbo.AccountProject.ProjectStatusId LEFT OUTER JOIN
                      dbo.AccountEmployee ON dbo.AccountProject.ProjectManagerEmployeeId = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON dbo.AccountProject.LeaderEmployeeId = AccountEmployee_1.AccountEmployeeId'

GO
-- Create View vueAccount
Print 'Create View vueAccount'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccount' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccount
AS
SELECT     dbo.Account.AccountId, dbo.Account.AccountTypeId, dbo.Account.AccountName, dbo.Account.Address1, dbo.Account.Address2, dbo.Account.ZipCode, dbo.Account.State, 
                      dbo.Account.City, dbo.Account.CountryId, dbo.Account.EMailAddress, dbo.Account.Telephone, dbo.Account.Fax, dbo.Account.DefaultCurrencyId, 
                      dbo.Account.TimeZoneId, dbo.Account.IsDisabled, dbo.Account.IsDeleted, dbo.Account.StatusId, dbo.Account.CreatedOn, dbo.Account.ModifiedOn, 
                      dbo.Account.ModifiedByEmployeeId, dbo.AccountPreferences.ShowClockStartEnd, dbo.AccountPreferences.AccountPreferencesId, dbo.Account.LicenseKey, 
                      dbo.Account.SystemPackageTypeId, dbo.AccountPreferences.TimeEntryFormat, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.Account.MachineId, dbo.Account.ActivationLicenseKey, dbo.Account.ActivationMachineKey, 
                      dbo.Account.ActivationType, dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountPreferences.InvoiceBillingTypeId, 
                      dbo.AccountPreferences.ShowBillingRateInInvoiceReport, dbo.AccountPreferences.InvoiceFooter, dbo.AccountPreferences.ShowProjectNameInInvoiceReport, 
                      dbo.AccountPreferences.ProjectCodePrefix, dbo.AccountPreferences.AutoGenerateProjectCode, dbo.AccountPreferences.TimeEntryHoursFormatId, 
                      dbo.AccountPreferences.ShowPercentageInTimesheet, dbo.AccountPreferences.EnablePasswordComplexity, 
                      dbo.AccountPreferences.ShowClientDepartmentInProject
FROM         dbo.Account INNER JOIN
                      dbo.AccountPreferences ON dbo.Account.AccountId = dbo.AccountPreferences.AccountId'

GO
-- Drop View vueAudit
Print 'Drop View vueAudit'
GO
if exists (select * from information_schema.tables where table_name = 'vueAudit' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAudit]

GO
-- Drop View vueAccountPartyContact
Print 'Drop View vueAccountPartyContact'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountPartyContact' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountPartyContact]

GO
-- Drop View vueAccountPartyDepartment
Print 'Drop View vueAccountPartyDepartment'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountPartyDepartment' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountPartyDepartment]

GO
-- Create View vueAccountPartyContact
Print 'Create View vueAccountPartyContact'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountPartyContact' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountPartyContact
AS
SELECT     dbo.AccountPartyContact.AccountPartyContactId, dbo.AccountPartyContact.AccountPartyId, dbo.AccountPartyContact.FirstName, dbo.AccountPartyContact.LastName, 
                      dbo.AccountPartyContact.Telephone1, dbo.AccountPartyContact.Telephone2, dbo.AccountPartyContact.Fax, dbo.AccountPartyContact.EMailAddress, 
                      dbo.AccountPartyContact.State, dbo.AccountPartyContact.City, dbo.AccountPartyContact.Zip, dbo.AccountPartyContact.CountryId, dbo.AccountPartyContact.Address1, 
                      dbo.AccountPartyContact.Address2, dbo.AccountPartyContact.AccountPartyDepartmentId, dbo.AccountPartyContact.Location, dbo.AccountParty.PartyName, 
                      dbo.AccountParty.PartyNick, dbo.AccountParty.AccountId
FROM         dbo.AccountPartyContact LEFT OUTER JOIN
                      dbo.AccountParty ON dbo.AccountPartyContact.AccountPartyId = dbo.AccountParty.AccountPartyId'

GO
-- Create View vueAccountPartyDepartment
Print 'Create View vueAccountPartyDepartment'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountPartyDepartment' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountPartyDepartment
AS
SELECT     dbo.AccountParty.PartyName, dbo.AccountParty.PartyNick, dbo.AccountPartyDepartment.AccountPartyDepartmentId, dbo.AccountPartyDepartment.AccountPartyId, 
                      dbo.AccountPartyDepartment.PartyDepartmentCode, dbo.AccountPartyDepartment.PartyDepartmentName, dbo.AccountPartyDepartment.PartyDepartmentLocation, 
                      dbo.AccountParty.AccountId
FROM         dbo.AccountParty RIGHT OUTER JOIN
                      dbo.AccountPartyDepartment ON dbo.AccountParty.AccountPartyId = dbo.AccountPartyDepartment.AccountPartyId'

GO
-- Create View vueAudit
Print 'Create View vueAudit'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAudit' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAudit
AS
SELECT     dbo.Audit.Type, dbo.Audit.TableName, dbo.Audit.PK, dbo.Audit.FieldName, dbo.Audit.OldValue, dbo.Audit.NewValue, dbo.Audit.UpdateDate, dbo.Audit.UserName, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountEmployee.AccountId
FROM         dbo.Audit LEFT OUTER JOIN
                      dbo.AccountStatus ON dbo.Audit.NewValue = dbo.AccountStatus.Status AND dbo.Audit.OldValue = dbo.AccountStatus.Status AND 
                      dbo.Audit.FieldName = dbo.AccountStatus.Status AND dbo.Audit.PK = dbo.AccountStatus.AccountStatusId AND dbo.Audit.TableName = ''AccountStatus'' LEFT OUTER JOIN
                      dbo.AccountEmployee ON dbo.Audit.UserName = dbo.AccountEmployee.AccountEmployeeId'
GO
If exists(Select * from SystemData where version = '3.9.8')
--Update SystemSecurityCategoryPage Record
BEGIN
Update SystemSecurityCategoryPage Set NotShowInPermission = 1
Where SystemSecurityCategoryPageId = 126
END
GO
Update SystemData Set Version = '3.9.9' Where Version = '3.9.8' And SystemDataId = 1

GO
-- Alter Column Hours on AccountEmployeeTimeEntry
Print 'Alter Column Hours on AccountEmployeeTimeEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntry' AND TABLE_TYPE='BASE TABLE')) AND (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='Hours' AND TABLE_NAME='AccountEmployeeTimeEntry'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntry]
	 ALTER COLUMN [Hours] decimal(18, 2) NULL

GO

-- Drop Procedure sp_UpdateTimeEntry
Print 'Drop Procedure sp_UpdateTimeEntry'
GO
DROP PROCEDURE [dbo].[sp_UpdateTimeEntry]

GO
-- Create Procedure sp_UpdateTimeEntry
Print 'Create Procedure sp_UpdateTimeEntry'
GO

CREATE PROCEDURE [dbo].[sp_UpdateTimeEntry]
		   (@AccountEmployeeId int,
           @TimeEntryDate datetime,
           @StartTime datetime,
           @EndTime datetime,
           @TotalTime datetime,
           @AccountProjectId int,
           @AccountProjectTaskId bigint,
           @Description nvarchar(1000),
           @Approved bit,
           @Rejected bit,
           @BillingRate money,
           @Submitted bit,
           @AccountWorkTypeId int,
           @EmployeeRate money,
           @AccountCostCenterId int,
           @BillingRateCurrencyId int,
           @EmployeeRateCurrencyId int,
           @BillingRateExchangeRate float,
           @EmployeeRateExchangeRate float,
           @AccountBaseCurrencyId int,
           @AccountEmployeeTimeEntryPeriodId uniqueidentifier,
           @AccountEmployeeTimeEntryApprovalProjectId uniqueidentifier,
           @ModifiedByEmployeeId int,
           @IsTimeOff bit,
           @AccountTimeOffTypeId uniqueidentifier,
		   @AccountEmployeeTimeEntryId int,
		   @Percentage float,
		   @Hours decimal(18,2))
AS 
BEGIN
UPDATE AccountEmployeeTimeEntry
   SET [AccountEmployeeId] = @AccountEmployeeId
      ,[TimeEntryDate] = @TimeEntryDate
      ,[StartTime] = @StartTime
      ,[EndTime] = @EndTime
      ,[TotalTime] = @TotalTime
      ,[AccountProjectId] = @AccountProjectId
      ,[AccountProjectTaskId] = @AccountProjectTaskId
      ,[Description] = @Description
      ,[Approved] = @Approved
      ,[Rejected] = @Rejected
      ,[BillingRate] = @BillingRate
      ,[Submitted] = @Submitted
      ,[AccountWorkTypeId] = @AccountWorkTypeId
      ,[EmployeeRate] = @EmployeeRate
      ,[AccountCostCenterId] = @AccountCostCenterId
      ,[BillingRateCurrencyId] = @BillingRateCurrencyId
      ,[EmployeeRateCurrencyId] = @EmployeeRateCurrencyId
      ,[BillingRateExchangeRate] = @BillingRateExchangeRate
      ,[EmployeeRateExchangeRate] = @EmployeeRateExchangeRate
      ,[AccountBaseCurrencyId] = @AccountBaseCurrencyId
      ,[AccountEmployeeTimeEntryPeriodId] = @AccountEmployeeTimeEntryPeriodId
      ,[AccountEmployeeTimeEntryApprovalProjectId] = @AccountEmployeeTimeEntryApprovalProjectId
      ,[ModifiedByEmployeeId] = @ModifiedByEmployeeId
      ,[IsTimeOff] = @IsTimeOff
      ,[AccountTimeOffTypeId] = @AccountTimeOffTypeId
      ,[Percentage] = @Percentage
      ,[Hours] = @Hours
 WHERE [AccountEmployeeTimeEntryId] = @AccountEmployeeTimeEntryId
END

GO
If exists(Select * from SystemData where version = '3.9.9')
--Update SystemSecurityCategoryPage Record
BEGIN
Update AccountPreferences set TimeEntryHoursFormatId = '074187eb-81d9-4e06-8e70-db7bc0c53784'
where TimeEntryHoursFormatId is null
END
GO
Update SystemData Set Version = '4.0.1' Where Version = '3.9.9' And SystemDataId = 1

GO
-- Add Column ShowEntryDateInInvoiceReport to AccountPreferences
Print 'Add Column ShowEntryDateInInvoiceReport to AccountPreferences'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountPreferences' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='ShowEntryDateInInvoiceReport' AND TABLE_NAME='AccountPreferences'))
ALTER TABLE [dbo].[AccountPreferences]
	ADD [ShowEntryDateInInvoiceReport] bit NULL
	
GO
-- Add Column AccountEmployeeTimeEntryId to AccountTimeExpenseBillingTimesheet
Print 'Add Column AccountEmployeeTimeEntryId to AccountTimeExpenseBillingTimesheet'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountTimeExpenseBillingTimesheet' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='AccountEmployeeTimeEntryId' AND TABLE_NAME='AccountTimeExpenseBillingTimesheet'))
ALTER TABLE [dbo].[AccountTimeExpenseBillingTimesheet]
	ADD [AccountEmployeeTimeEntryId] int NULL
	
GO
-- Drop View vueAccount
Print 'Drop View vueAccount'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccount' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccount]

GO
-- Drop View vueAccountTimeExpenseBillingTimesheetForEdit
Print 'Drop View vueAccountTimeExpenseBillingTimesheetForEdit'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountTimeExpenseBillingTimesheetForEdit' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountTimeExpenseBillingTimesheetForEdit]

GO
-- Drop View vueAccountTimeExpenseBillingTimesheet
Print 'Drop View vueAccountTimeExpenseBillingTimesheet'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountTimeExpenseBillingTimesheet' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountTimeExpenseBillingTimesheet]

GO
-- Drop View vueAccountEmployee
Print 'Drop View vueAccountEmployee'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployee]

GO
-- Create View vueAccountEmployee
Print 'Create View vueAccountEmployee'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployee
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountEmployee.AccountId, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.Password, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountLocationId, dbo.AccountEmployee.BillingTypeId, 
                      dbo.AccountBillingType.BillingType, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, dbo.AccountPreferences.ShowClockStartEnd, dbo.Account.TimeZoneId, 
                      dbo.AccountRole.MasterAccountRoleId, dbo.Account.DefaultCurrencyId, dbo.Account.CountryId, dbo.AccountPreferences.CultureInfoName, 
                      dbo.AccountPreferences.TimeEntryFormat, dbo.AccountEmployee.AllowedAccessFromIP, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountPreferences.AccountSessionTimeout, dbo.AccountPreferences.ShowCompletedTasksInTimeSheet, dbo.AccountPreferences.CurrencySymbol, 
                      dbo.AccountPreferences.IsCompanyOwnLogo, dbo.Account.AccountExpiryActivation, dbo.Account.LicenseActivation, dbo.AccountEmployee.EmployeeTypeId, 
                      dbo.AccountEmployee.ExternalUserClientId, dbo.AccountEmployee.AccountBillingRateId, dbo.AccountPreferences.ScheduledEmailSendTime, 
                      dbo.AccountEmployee.Username, dbo.AccountEmployee.IsDisabled, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.AccountEmployee.EmployeeCode, dbo.AccountPreferences.Version, 
                      dbo.AccountPreferences.LockSubmittedRecords, dbo.AccountPreferences.LockApprovedRecords, ISNULL(dbo.AccountEmployee.EmployeeCode + '' - '', '''') 
                      + dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeNameWithCode, dbo.AccountPreferences.ShowWorkTypeInTimeSheet, 
                      dbo.AccountPreferences.NumberOfBlankRowsInTimeEntry, dbo.AccountPreferences.ShowCostCenterInTimeSheet, dbo.AccountPreferences.WeekStartDay, 
                      dbo.AccountPreferences.AccountBaseCurrencyId, dbo.AccountPreferences.UserInterfaceLanguage, dbo.AccountEmployee.EmployeeManagerId, 
                      dbo.AccountPreferences.DefaultTimeEntryMode, dbo.AccountPreferences.PageSize, dbo.AccountEmployee.TimeZoneId AS EmployeeTimeZoneId, 
                      dbo.AccountEmployee.TerminationDate, dbo.AccountEmployee.StatusId, dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.EmployeePayTypeId, 
                      dbo.AccountEmployee.HiredDate, dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountWorkingDayType, 
                      dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay AS EmployeeWeekStartDay, 
                      dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountPreferences.ShowDescriptionInWeekView, 
                      dbo.AccountPreferences.InvoiceNoPrefix, dbo.AccountPreferences.ShowAdditionalTaskInformationType, 
                      dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, 
                      ISNULL(dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, 1) AS InitialDayOfTheMonth, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, 1) 
                      AS SystemInitialDayOfFirstPeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod, 16) AS SystemInitialDayOfLastPeriod, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountPreferences.TimesheetPrintFooter, dbo.AccountPreferences.ExpenseSheetPrintFooter, 
                      dbo.AccountPreferences.ShowCompletedProjectsInTimeSheet, dbo.AccountPreferences.ShowProjectForTimeOff, dbo.AccountPreferences.ShowTimeOffInTimesheet, 
                      dbo.AccountEmployee.IsDeleted, dbo.AccountEmployee.IsForcePasswordChange, dbo.AccountEmployee.PasswordChangedDate, 
                      dbo.AccountPreferences.PasswordExpiryPeriod, dbo.AccountPreferences.ShowAllInTimesheetReadOnly, dbo.AccountPreferences.ShowTaskInExpenseSheet, 
                      dbo.AccountPreferences.InvoiceBillingTypeId, dbo.AccountPreferences.ShowBillingRateInInvoiceReport, dbo.SystemInvoiceBillingType.InvoiceBillingType, 
                      dbo.AccountPreferences.InvoiceFooter, dbo.AccountPreferences.TimesheetOverduePeriods, dbo.AccountWorkingDayType.TimesheetOverdueAfterDays, 
                      dbo.AccountEmployee.CreatedOn, dbo.AccountEmployee.CreatedByEmployeeId, dbo.AccountEmployee.ModifiedOn, dbo.AccountEmployee.ModifiedByEmployeeId, 
                      dbo.AccountPreferences.ShowProjectNameInInvoiceReport, dbo.AccountPreferences.ProjectCodePrefix, dbo.AccountPreferences.AutoGenerateProjectCode, 
                      dbo.AccountPreferences.TimeEntryHoursFormatId, dbo.AccountPreferences.ShowPercentageInTimesheet, dbo.AccountPreferences.EnablePasswordComplexity, 
                      dbo.AccountPreferences.ShowClientDepartmentInProject, dbo.AccountPreferences.ShowEntryDateInInvoiceReport
FROM         dbo.SystemInvoiceBillingType RIGHT OUTER JOIN
                      dbo.AccountPreferences ON dbo.SystemInvoiceBillingType.InvoiceBillingTypeId = dbo.AccountPreferences.InvoiceBillingTypeId RIGHT OUTER JOIN
                      dbo.vueAccountTimesheetPeriodType RIGHT OUTER JOIN
                      dbo.AccountWorkingDayType ON 
                      dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId = dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId RIGHT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.Account ON dbo.AccountEmployee.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId ON 
                      dbo.AccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId ON 
                      dbo.AccountPreferences.AccountId = dbo.AccountEmployee.AccountId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId'

GO
-- Create View vueAccountTimeExpenseBillingReport
Print 'Create View vueAccountTimeExpenseBillingReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountTimeExpenseBillingReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountTimeExpenseBillingReport
AS
SELECT     dbo.AccountTimeExpenseBilling.InvoiceNumber, dbo.AccountTimeExpenseBilling.InvoiceDate, ISNULL(dbo.AccountTimeExpenseBilling.PONumber, 0) AS PONumber, 
                      ISNULL(dbo.AccountTimeExpenseBilling.SubTotal, 0) AS SubTotal, ISNULL(dbo.AccountTimeExpenseBilling.TaxCode1, 0) AS TaxCode1, 
                      ISNULL(dbo.AccountTimeExpenseBilling.TaxCode2, 0) AS TaxCode2, ISNULL(dbo.AccountTimeExpenseBilling.GrandTotal, 0) AS GrandTotal, 
                      dbo.AccountTimeExpenseBilling.AccountId, dbo.AccountTimeExpenseBillingTimesheet.Description AS [Detail Description], 
                      ISNULL(dbo.AccountTimeExpenseBillingTimesheet.ActualBillingRate, 0) AS ActualBillingRate, ISNULL(dbo.AccountTimeExpenseBillingTimesheet.BillHours, 0) 
                      AS BillHours, ISNULL(dbo.AccountTimeExpenseBillingTimesheet.TotalAmount, 0) AS TotalAmount, dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId, 
                      dbo.AccountParty.PartyName, dbo.AccountTimeExpenseBilling.Description AS [Master Description], dbo.AccountParty.Address1, dbo.AccountParty.Address2, 
                      dbo.Account.AccountName, dbo.Account.Address1 AS AccountAddress1, dbo.Account.ZipCode, dbo.Account.State, dbo.Account.City, dbo.Account.Telephone, 
                      dbo.Account.Address2 AS AccountAddress2, dbo.AccountTimeExpenseBilling.AccountCurrencyId, dbo.SystemCurrency.CurrencyCode, 
                      dbo.AccountPreferences.InvoiceNoPrefix, dbo.AccountParty.State AS ClientState, dbo.AccountParty.City AS ClientCity, dbo.AccountParty.ZipCode AS ClientZipcode, 
                      dbo.AccountParty.Telephone1 AS ClientTelephone, dbo.AccountParty.Fax AS ClientFax, SystemCountry_1.Country AS AccountCountry, 
                      dbo.SystemCountry.Country AS ClientCountry, dbo.AccountTimeExpenseBilling.Terms, dbo.AccountTimeExpenseBilling.BankDetails, dbo.AccountProject.ProjectName, 
                      AccountProject_1.ProjectName AS MasterProjectName, dbo.AccountEmployeeTimeEntry.TimeEntryDate
FROM         dbo.AccountProject RIGHT OUTER JOIN
                      dbo.SystemCountry RIGHT OUTER JOIN
                      dbo.AccountParty ON dbo.SystemCountry.CountryId = dbo.AccountParty.CountryId RIGHT OUTER JOIN
                      dbo.Account ON dbo.AccountParty.AccountId = dbo.Account.AccountId LEFT OUTER JOIN
                      dbo.SystemCountry AS SystemCountry_1 ON dbo.Account.CountryId = SystemCountry_1.CountryId LEFT OUTER JOIN
                      dbo.AccountPreferences ON dbo.Account.AccountId = dbo.AccountPreferences.AccountId RIGHT OUTER JOIN
                      dbo.AccountProject AS AccountProject_1 RIGHT OUTER JOIN
                      dbo.AccountCurrency INNER JOIN
                      dbo.AccountTimeExpenseBilling ON dbo.AccountCurrency.AccountCurrencyId = dbo.AccountTimeExpenseBilling.AccountCurrencyId INNER JOIN
                      dbo.SystemCurrency ON dbo.AccountCurrency.SystemCurrencyId = dbo.SystemCurrency.CurrencyId ON 
                      AccountProject_1.AccountProjectId = dbo.AccountTimeExpenseBilling.AccountProjectId ON 
                      dbo.AccountParty.AccountPartyId = dbo.AccountTimeExpenseBilling.AccountClientId LEFT OUTER JOIN
                      dbo.AccountTimeExpenseBillingTimesheet ON 
                      dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId = dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingId ON 
                      dbo.AccountProject.AccountProjectId = dbo.AccountTimeExpenseBillingTimesheet.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntry ON 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountEmployeeTimeEntryId = dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId'

GO
-- Create View vueAccountTimeExpenseBillingTimesheetForEdit
Print 'Create View vueAccountTimeExpenseBillingTimesheetForEdit'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountTimeExpenseBillingTimesheetForEdit' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountTimeExpenseBillingTimesheetForEdit
AS
SELECT     dbo.AccountProject.AccountClientId, dbo.AccountProject.ProjectName, dbo.AccountProjectTask.TaskName, dbo.AccountProjectTask.AccountProjectTaskId, 
                      dbo.AccountProject.AccountProjectId, dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingTimesheetId, 
                      dbo.AccountTimeExpenseBillingTimesheet.Description, dbo.AccountTimeExpenseBillingTimesheet.BillingRate, dbo.AccountTimeExpenseBillingTimesheet.BillHours, 
                      dbo.AccountTimeExpenseBillingTimesheet.TotalAmount, dbo.AccountTimeExpenseBillingTimesheet.AccountTaxCodeId1, 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountTaxCodeId2, dbo.AccountTimeExpenseBillingTimesheet.TaxCode2, 
                      dbo.AccountTimeExpenseBillingTimesheet.TaxCode1, dbo.AccountTimeExpenseBillingTimesheet.ActualHours, 
                      dbo.AccountTimeExpenseBillingTimesheet.ActualBillingRate, dbo.AccountParty.PartyName, dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingId, 
                      dbo.AccountTimeExpenseBilling.InvoiceNumber, dbo.AccountCurrencyExchangeRate.ExchangeRate, 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountEmployeeTimeEntryId
FROM         dbo.AccountCurrency LEFT OUTER JOIN
                      dbo.AccountCurrencyExchangeRate ON 
                      dbo.AccountCurrency.AccountCurrencyExchangeRateId = dbo.AccountCurrencyExchangeRate.AccountCurrencyExchangeRateId RIGHT OUTER JOIN
                      dbo.AccountTimeExpenseBillingTimesheet INNER JOIN
                      dbo.AccountTimeExpenseBilling ON 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingId = dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId INNER JOIN
                      dbo.AccountParty ON dbo.AccountTimeExpenseBilling.AccountClientId = dbo.AccountParty.AccountPartyId AND 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountId = dbo.AccountParty.AccountId LEFT OUTER JOIN
                      dbo.AccountProjectTask ON dbo.AccountTimeExpenseBillingTimesheet.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId LEFT OUTER JOIN
                      dbo.AccountProject ON dbo.AccountTimeExpenseBillingTimesheet.AccountProjectId = dbo.AccountProject.AccountProjectId ON 
                      dbo.AccountCurrency.AccountCurrencyId = dbo.AccountTimeExpenseBilling.AccountCurrencyId'

GO
-- Create View vueAccountTimeExpenseBillingTimesheet
Print 'Create View vueAccountTimeExpenseBillingTimesheet'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountTimeExpenseBillingTimesheet' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountTimeExpenseBillingTimesheet
AS
SELECT     dbo.AccountProject.AccountClientId, dbo.AccountProject.ProjectName, dbo.AccountProjectTask.TaskName, dbo.AccountProjectTask.AccountProjectTaskId, 
                      dbo.AccountProject.AccountProjectId, dbo.AccountEmployeeTimeEntry.AccountTimeExpenseBillingTimesheetId, dbo.AccountEmployeeTimeEntry.BillingRate, 
                      dbo.AccountEmployeeTimeEntry.BillingRateCurrencyId, dbo.AccountTimeExpenseBillingTimesheet.Description, dbo.AccountEmployeeTimeEntry.Approved, 
                      DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime) AS TotalMinutes, ROUND(CONVERT(float, 
                      DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) AS TotalHours, 
                      dbo.AccountEmployeeTimeEntry.BillingRate * DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) AS Amount, dbo.AccountEmployeeTimeEntry.TimeEntryDate, 
                      dbo.AccountTimeExpenseBillingTimesheet.BillHours, dbo.AccountTimeExpenseBillingTimesheet.ActualBillingRate, 
                      dbo.AccountTimeExpenseBillingTimesheet.TotalAmount, dbo.AccountTimeExpenseBillingTimesheet.AccountTaxCodeId1, 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountTaxCodeId2, dbo.AccountTimeExpenseBilling.SubTotal, dbo.AccountTimeExpenseBilling.TaxCode1, 
                      dbo.AccountTimeExpenseBilling.TaxCode2, dbo.AccountTimeExpenseBilling.GrandTotal, dbo.AccountParty.PartyNick, 
                      dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId, dbo.AccountEmployeeTimeEntry.Billed, dbo.AccountEmployeeTimeEntry.BillingRateExchangeRate, 
                      dbo.AccountProjectTask.IsBillable, dbo.AccountEmployeeTimeEntry.Description AS TimesheetDescription, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId
FROM         dbo.AccountTimeExpenseBillingTimesheet RIGHT OUTER JOIN
                      dbo.AccountTimeExpenseBilling ON 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingId = dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId RIGHT OUTER JOIN
                      dbo.AccountProjectTask INNER JOIN
                      dbo.AccountEmployeeTimeEntry ON dbo.AccountProjectTask.AccountProjectTaskId = dbo.AccountEmployeeTimeEntry.AccountProjectTaskId INNER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId ON 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingTimesheetId = dbo.AccountEmployeeTimeEntry.AccountTimeExpenseBillingTimesheetId AND 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountProjectId = dbo.AccountEmployeeTimeEntry.AccountProjectId AND 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountProjectTaskId = dbo.AccountEmployeeTimeEntry.AccountProjectTaskId RIGHT OUTER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId
WHERE     (dbo.AccountEmployeeTimeEntry.Approved = 1) AND (dbo.AccountEmployeeTimeEntry.Billed <> 1)'

GO
-- Create View vueAccount
Print 'Create View vueAccount'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccount' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccount
AS
SELECT     dbo.Account.AccountId, dbo.Account.AccountTypeId, dbo.Account.AccountName, dbo.Account.Address1, dbo.Account.Address2, dbo.Account.ZipCode, dbo.Account.State, 
                      dbo.Account.City, dbo.Account.CountryId, dbo.Account.EMailAddress, dbo.Account.Telephone, dbo.Account.Fax, dbo.Account.DefaultCurrencyId, 
                      dbo.Account.TimeZoneId, dbo.Account.IsDisabled, dbo.Account.IsDeleted, dbo.Account.StatusId, dbo.Account.CreatedOn, dbo.Account.ModifiedOn, 
                      dbo.Account.ModifiedByEmployeeId, dbo.AccountPreferences.ShowClockStartEnd, dbo.AccountPreferences.AccountPreferencesId, dbo.Account.LicenseKey, 
                      dbo.Account.SystemPackageTypeId, dbo.AccountPreferences.TimeEntryFormat, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.Account.MachineId, dbo.Account.ActivationLicenseKey, dbo.Account.ActivationMachineKey, 
                      dbo.Account.ActivationType, dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountPreferences.InvoiceBillingTypeId, 
                      dbo.AccountPreferences.ShowBillingRateInInvoiceReport, dbo.AccountPreferences.InvoiceFooter, dbo.AccountPreferences.ShowProjectNameInInvoiceReport, 
                      dbo.AccountPreferences.ProjectCodePrefix, dbo.AccountPreferences.AutoGenerateProjectCode, dbo.AccountPreferences.TimeEntryHoursFormatId, 
                      dbo.AccountPreferences.ShowPercentageInTimesheet, dbo.AccountPreferences.EnablePasswordComplexity, dbo.AccountPreferences.ShowClientDepartmentInProject, 
                      dbo.AccountPreferences.ShowEntryDateInInvoiceReport
FROM         dbo.Account INNER JOIN
                      dbo.AccountPreferences ON dbo.Account.AccountId = dbo.AccountPreferences.AccountId'

GO

-- Drop View vueAccount
Print 'Drop View vueAccount'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccount' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccount]

GO
-- Drop View vueAccountEmployee
Print 'Drop View vueAccountEmployee'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployee]

GO
-- Add Column TimesheetSort to AccountPreferences
Print 'Add Column TimesheetSort to AccountPreferences'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountPreferences' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='TimesheetSort' AND TABLE_NAME='AccountPreferences'))
ALTER TABLE [dbo].[AccountPreferences]
	ADD [TimesheetSort] nvarchar(50) NULL


GO
-- Create View vueAccountEmployee
Print 'Create View vueAccountEmployee'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployee
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountEmployee.AccountId, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.Password, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountLocationId, dbo.AccountEmployee.BillingTypeId, 
                      dbo.AccountBillingType.BillingType, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, dbo.AccountPreferences.ShowClockStartEnd, dbo.Account.TimeZoneId, 
                      dbo.AccountRole.MasterAccountRoleId, dbo.Account.DefaultCurrencyId, dbo.Account.CountryId, dbo.AccountPreferences.CultureInfoName, 
                      dbo.AccountPreferences.TimeEntryFormat, dbo.AccountEmployee.AllowedAccessFromIP, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountPreferences.AccountSessionTimeout, dbo.AccountPreferences.ShowCompletedTasksInTimeSheet, dbo.AccountPreferences.CurrencySymbol, 
                      dbo.AccountPreferences.IsCompanyOwnLogo, dbo.Account.AccountExpiryActivation, dbo.Account.LicenseActivation, dbo.AccountEmployee.EmployeeTypeId, 
                      dbo.AccountEmployee.ExternalUserClientId, dbo.AccountEmployee.AccountBillingRateId, dbo.AccountPreferences.ScheduledEmailSendTime, 
                      dbo.AccountEmployee.Username, dbo.AccountEmployee.IsDisabled, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.AccountEmployee.EmployeeCode, dbo.AccountPreferences.Version, 
                      dbo.AccountPreferences.LockSubmittedRecords, dbo.AccountPreferences.LockApprovedRecords, ISNULL(dbo.AccountEmployee.EmployeeCode + '' - '', '''') 
                      + dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeNameWithCode, dbo.AccountPreferences.ShowWorkTypeInTimeSheet, 
                      dbo.AccountPreferences.NumberOfBlankRowsInTimeEntry, dbo.AccountPreferences.ShowCostCenterInTimeSheet, dbo.AccountPreferences.WeekStartDay, 
                      dbo.AccountPreferences.AccountBaseCurrencyId, dbo.AccountPreferences.UserInterfaceLanguage, dbo.AccountEmployee.EmployeeManagerId, 
                      dbo.AccountPreferences.DefaultTimeEntryMode, dbo.AccountPreferences.PageSize, dbo.AccountEmployee.TimeZoneId AS EmployeeTimeZoneId, 
                      dbo.AccountEmployee.TerminationDate, dbo.AccountEmployee.StatusId, dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.EmployeePayTypeId, 
                      dbo.AccountEmployee.HiredDate, dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountWorkingDayType, 
                      dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay AS EmployeeWeekStartDay, 
                      dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountPreferences.ShowDescriptionInWeekView, 
                      dbo.AccountPreferences.InvoiceNoPrefix, dbo.AccountPreferences.ShowAdditionalTaskInformationType, 
                      dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, 
                      ISNULL(dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, 1) AS InitialDayOfTheMonth, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, 1) 
                      AS SystemInitialDayOfFirstPeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod, 16) AS SystemInitialDayOfLastPeriod, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountPreferences.TimesheetPrintFooter, dbo.AccountPreferences.ExpenseSheetPrintFooter, 
                      dbo.AccountPreferences.ShowCompletedProjectsInTimeSheet, dbo.AccountPreferences.ShowProjectForTimeOff, dbo.AccountPreferences.ShowTimeOffInTimesheet, 
                      dbo.AccountEmployee.IsDeleted, dbo.AccountEmployee.IsForcePasswordChange, dbo.AccountEmployee.PasswordChangedDate, 
                      dbo.AccountPreferences.PasswordExpiryPeriod, dbo.AccountPreferences.ShowAllInTimesheetReadOnly, dbo.AccountPreferences.ShowTaskInExpenseSheet, 
                      dbo.AccountPreferences.InvoiceBillingTypeId, dbo.AccountPreferences.ShowBillingRateInInvoiceReport, dbo.SystemInvoiceBillingType.InvoiceBillingType, 
                      dbo.AccountPreferences.InvoiceFooter, dbo.AccountPreferences.TimesheetOverduePeriods, dbo.AccountWorkingDayType.TimesheetOverdueAfterDays, 
                      dbo.AccountEmployee.CreatedOn, dbo.AccountEmployee.CreatedByEmployeeId, dbo.AccountEmployee.ModifiedOn, dbo.AccountEmployee.ModifiedByEmployeeId, 
                      dbo.AccountPreferences.ShowProjectNameInInvoiceReport, dbo.AccountPreferences.ProjectCodePrefix, dbo.AccountPreferences.AutoGenerateProjectCode, 
                      dbo.AccountPreferences.TimeEntryHoursFormatId, dbo.AccountPreferences.ShowPercentageInTimesheet, dbo.AccountPreferences.EnablePasswordComplexity, 
                      dbo.AccountPreferences.ShowClientDepartmentInProject, dbo.AccountPreferences.ShowEntryDateInInvoiceReport, dbo.AccountPreferences.TimesheetSort
FROM         dbo.SystemInvoiceBillingType RIGHT OUTER JOIN
                      dbo.AccountPreferences ON dbo.SystemInvoiceBillingType.InvoiceBillingTypeId = dbo.AccountPreferences.InvoiceBillingTypeId RIGHT OUTER JOIN
                      dbo.vueAccountTimesheetPeriodType RIGHT OUTER JOIN
                      dbo.AccountWorkingDayType ON 
                      dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId = dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId RIGHT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.Account ON dbo.AccountEmployee.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId ON 
                      dbo.AccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId ON 
                      dbo.AccountPreferences.AccountId = dbo.AccountEmployee.AccountId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId'

GO
-- Create View vueAccount
Print 'Create View vueAccount'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccount' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccount
AS
SELECT     dbo.Account.AccountId, dbo.Account.AccountTypeId, dbo.Account.AccountName, dbo.Account.Address1, dbo.Account.Address2, dbo.Account.ZipCode, dbo.Account.State, 
                      dbo.Account.City, dbo.Account.CountryId, dbo.Account.EMailAddress, dbo.Account.Telephone, dbo.Account.Fax, dbo.Account.DefaultCurrencyId, 
                      dbo.Account.TimeZoneId, dbo.Account.IsDisabled, dbo.Account.IsDeleted, dbo.Account.StatusId, dbo.Account.CreatedOn, dbo.Account.ModifiedOn, 
                      dbo.Account.ModifiedByEmployeeId, dbo.AccountPreferences.ShowClockStartEnd, dbo.AccountPreferences.AccountPreferencesId, dbo.Account.LicenseKey, 
                      dbo.Account.SystemPackageTypeId, dbo.AccountPreferences.TimeEntryFormat, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.Account.MachineId, dbo.Account.ActivationLicenseKey, dbo.Account.ActivationMachineKey, 
                      dbo.Account.ActivationType, dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountPreferences.InvoiceBillingTypeId, 
                      dbo.AccountPreferences.ShowBillingRateInInvoiceReport, dbo.AccountPreferences.InvoiceFooter, dbo.AccountPreferences.ShowProjectNameInInvoiceReport, 
                      dbo.AccountPreferences.ProjectCodePrefix, dbo.AccountPreferences.AutoGenerateProjectCode, dbo.AccountPreferences.TimeEntryHoursFormatId, 
                      dbo.AccountPreferences.ShowPercentageInTimesheet, dbo.AccountPreferences.EnablePasswordComplexity, dbo.AccountPreferences.ShowClientDepartmentInProject, 
                      dbo.AccountPreferences.ShowEntryDateInInvoiceReport, dbo.AccountPreferences.TimesheetSort
FROM         dbo.Account INNER JOIN
                      dbo.AccountPreferences ON dbo.Account.AccountId = dbo.AccountPreferences.AccountId'


GO
If exists(Select * from SystemData where version = '4.0.1')
--Update SystemSecurityCategoryPage Record
BEGIN
UPDATE SystemSecurityCategoryPage
SET SystemFeatureId = NULL
WHERE SystemSecurityCategoryPageID = '107' OR SystemSecurityCategoryPageID = '117'
END
GO
Update SystemData Set Version = '4.0.2' Where Version = '4.0.1' And SystemDataId = 1

GO
-- Add Column AccountExpenseEntryId to AccountTimeExpenseBillingExpense
Print 'Add Column AccountExpenseEntryId to AccountTimeExpenseBillingExpense'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountTimeExpenseBillingExpense' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='AccountExpenseEntryId' AND TABLE_NAME='AccountTimeExpenseBillingExpense'))
ALTER TABLE [dbo].[AccountTimeExpenseBillingExpense]
	ADD [AccountExpenseEntryId] int NULL

GO

-- Drop View vueAccountTimeExpenseBillingExpenseForEdit
Print 'Drop View vueAccountTimeExpenseBillingExpenseForEdit'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountTimeExpenseBillingExpenseForEdit' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountTimeExpenseBillingExpenseForEdit]

GO
-- Drop View vueAccountTimeExpenseBillingExpense
Print 'Drop View vueAccountTimeExpenseBillingExpense'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountTimeExpenseBillingExpense' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountTimeExpenseBillingExpense]

GO
-- Create View vueAccountTimeExpenseBillingExpenseForEdit
Print 'Create View vueAccountTimeExpenseBillingExpenseForEdit'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountTimeExpenseBillingExpenseForEdit' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountTimeExpenseBillingExpenseForEdit
AS
SELECT     dbo.AccountParty.PartyName, dbo.AccountTimeExpenseBilling.InvoiceNumber, dbo.AccountTimeExpenseBilling.InvoiceDate, 
                      dbo.AccountTimeExpenseBilling.PONumber, dbo.AccountProject.ProjectName, dbo.AccountProject.AccountProjectId, 
                      dbo.AccountParty.AccountPartyId AS AccountClientId, dbo.AccountTimeExpenseBillingExpense.AccountTimeExpenseBillingExpenseId, 
                      dbo.AccountTimeExpenseBillingExpense.AccountTimeExpenseBillingId, dbo.AccountTimeExpenseBillingExpense.Description, 
                      dbo.AccountTimeExpenseBillingExpense.ActualExpenseAmount, dbo.AccountTimeExpenseBillingExpense.BilledExpenseAmount, 
                      dbo.AccountExpense.AccountExpenseId, dbo.AccountExpense.AccountExpenseName, dbo.AccountExpenseType.AccountExpenseTypeId, 
                      dbo.AccountExpenseType.ExpenseType, dbo.AccountCurrencyExchangeRate.ExchangeRate, dbo.AccountTimeExpenseBillingExpense.AccountTaxCodeId1, 
                      dbo.AccountTimeExpenseBillingExpense.AccountTaxCodeId2, dbo.AccountTimeExpenseBillingExpense.TaxCode1, 
                      dbo.AccountTimeExpenseBillingExpense.TaxCode2, dbo.AccountTimeExpenseBillingExpense.AccountExpenseEntryId
FROM         dbo.AccountCurrencyExchangeRate RIGHT OUTER JOIN
                      dbo.AccountCurrency ON 
                      dbo.AccountCurrencyExchangeRate.AccountCurrencyExchangeRateId = dbo.AccountCurrency.AccountCurrencyExchangeRateId RIGHT OUTER JOIN
                      dbo.AccountTimeExpenseBillingExpense INNER JOIN
                      dbo.AccountParty ON dbo.AccountTimeExpenseBillingExpense.AccountId = dbo.AccountParty.AccountId INNER JOIN
                      dbo.AccountTimeExpenseBilling ON 
                      dbo.AccountTimeExpenseBillingExpense.AccountTimeExpenseBillingId = dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId AND 
                      dbo.AccountParty.AccountPartyId = dbo.AccountTimeExpenseBilling.AccountClientId LEFT OUTER JOIN
                      dbo.AccountExpenseType ON dbo.AccountTimeExpenseBillingExpense.AccountExpenseTypeId = dbo.AccountExpenseType.AccountExpenseTypeId LEFT OUTER JOIN
                      dbo.AccountExpense ON dbo.AccountTimeExpenseBillingExpense.AccountExpenseId = dbo.AccountExpense.AccountExpenseId LEFT OUTER JOIN
                      dbo.AccountProject ON dbo.AccountTimeExpenseBillingExpense.AccountProjectId = dbo.AccountProject.AccountProjectId ON 
                      dbo.AccountCurrency.AccountCurrencyId = dbo.AccountTimeExpenseBilling.AccountCurrencyId'

GO
-- Create View vueAccountTimeExpenseBillingExpense
Print 'Create View vueAccountTimeExpenseBillingExpense'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountTimeExpenseBillingExpense' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountTimeExpenseBillingExpense
AS
SELECT     dbo.AccountExpenseEntry.Billed, dbo.AccountProject.ProjectName, dbo.AccountProject.AccountClientId, dbo.AccountProject.AccountProjectId, 
                      dbo.AccountExpense.AccountExpenseName, dbo.AccountExpenseType.ExpenseType, dbo.AccountExpenseEntry.AccountTimeExpenseBillingExpenseId, 
                      dbo.AccountExpenseEntry.AccountExpenseEntryDate, dbo.AccountExpenseType.AccountExpenseTypeId, dbo.AccountExpense.AccountExpenseId, 
                      dbo.AccountTimeExpenseBillingExpense.BilledExpenseAmount, dbo.AccountTimeExpenseBillingExpense.Description, dbo.AccountExpenseEntry.Approved, 
                      dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId, dbo.AccountExpenseEntry.Amount, dbo.AccountExpenseEntry.ExchangeRate, 
                      dbo.AccountTimeExpenseBillingExpense.ActualExpenseAmount, dbo.AccountTimeExpenseBillingExpense.AccountTaxCodeId1, 
                      dbo.AccountTimeExpenseBillingExpense.AccountTaxCodeId2, dbo.AccountTimeExpenseBillingExpense.TaxCode1, 
                      dbo.AccountTimeExpenseBillingExpense.TaxCode2, dbo.AccountExpenseEntry.IsBillable, dbo.AccountExpenseEntry.Description AS ExpenseDescription, 
                      dbo.AccountExpenseEntry.AccountExpenseEntryId
FROM         dbo.AccountTimeExpenseBillingExpense INNER JOIN
                      dbo.AccountTimeExpenseBilling ON 
                      dbo.AccountTimeExpenseBillingExpense.AccountTimeExpenseBillingId = dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId RIGHT OUTER JOIN
                      dbo.AccountExpenseEntry INNER JOIN
                      dbo.AccountProject ON dbo.AccountExpenseEntry.AccountProjectId = dbo.AccountProject.AccountProjectId INNER JOIN
                      dbo.AccountExpense ON dbo.AccountExpenseEntry.AccountExpenseId = dbo.AccountExpense.AccountExpenseId INNER JOIN
                      dbo.AccountExpenseType ON dbo.AccountExpenseType.AccountExpenseTypeId = dbo.AccountExpense.AccountExpenseTypeId RIGHT OUTER JOIN
                      dbo.AccountParty ON dbo.AccountParty.AccountPartyId = dbo.AccountProject.AccountClientId ON 
                      dbo.AccountTimeExpenseBillingExpense.AccountTimeExpenseBillingExpenseId = dbo.AccountExpenseEntry.AccountTimeExpenseBillingExpenseId AND 
                      dbo.AccountTimeExpenseBillingExpense.AccountProjectId = dbo.AccountExpenseEntry.AccountProjectId AND 
                      dbo.AccountTimeExpenseBillingExpense.AccountExpenseId = dbo.AccountExpenseEntry.AccountExpenseId
WHERE     (dbo.AccountExpenseEntry.Approved = 1) AND (dbo.AccountExpenseEntry.Billed <> 1)'

GO
-- Create Table AccountCostCenterEmployee
Print 'Create Table AccountCostCenterEmployee'
GO
IF NOT EXISTS (select * from information_schema.tables where table_name = 'AccountCostCenterEmployee' and table_type = 'BASE TABLE') 
CREATE TABLE [dbo].[AccountCostCenterEmployee] (
		[AccountCostCenterEmployeeId]     uniqueidentifier NOT NULL,
		[AccountCostCenterId]             int NULL,
		[AccountId]                       int NULL,
		[AccountEmployeeId]               int NULL
)

GO
-- Add Primary Key PK_AccountCostCenterEmployee to AccountCostCenterEmployee
Print 'Add Primary Key PK_AccountCostCenterEmployee to AccountCostCenterEmployee'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountCostCenterEmployee' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_NAME='PK_AccountCostCenterEmployee' AND TABLE_NAME='AccountCostCenterEmployee'))
ALTER TABLE [dbo].[AccountCostCenterEmployee]
	ADD
	CONSTRAINT [PK_AccountCostCenterEmployee]
	PRIMARY KEY
	([AccountCostCenterEmployeeId])

GO
-- Add Default Constraint DF_AccountCostCenterEmployee_AccountCostCenterEmployeeId to AccountCostCenterEmployee
Print 'Add Default Constraint DF_AccountCostCenterEmployee_AccountCostCenterEmployeeId to AccountCostCenterEmployee'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountCostCenterEmployee' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM sysobjects WHERE name= N'DF_AccountCostCenterEmployee_AccountCostCenterEmployeeId'))
ALTER TABLE [dbo].[AccountCostCenterEmployee]
	ADD
	CONSTRAINT [DF_AccountCostCenterEmployee_AccountCostCenterEmployeeId]
	DEFAULT (newid()) FOR [AccountCostCenterEmployeeId]

GO
-- Drop View vueAccountCostCenterEmployee
Print 'Drop View vueAccountCostCenterEmployee'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountCostCenterEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountCostCenterEmployee]

GO
-- Create View vueAccountCostCenterEmployee
Print 'Create View vueAccountCostCenterEmployee'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountCostCenterEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountCostCenterEmployee
AS
SELECT     dbo.AccountCostCenter.AccountCostCenterCode, dbo.AccountCostCenter.AccountCostCenter, dbo.AccountCostCenter.SortOrder, dbo.AccountCostCenter.AccountId, 
                      dbo.AccountEmployee.AccountEmployeeId, dbo.AccountCostCenterEmployee.AccountCostCenterEmployeeId, dbo.AccountCostCenter.AccountCostCenterId
FROM         dbo.AccountCostCenter INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountCostCenter.AccountId = dbo.AccountEmployee.AccountId LEFT OUTER JOIN
                      dbo.AccountCostCenterEmployee ON dbo.AccountCostCenter.AccountCostCenterId = dbo.AccountCostCenterEmployee.AccountCostCenterId AND 
                      dbo.AccountCostCenter.AccountId = dbo.AccountCostCenterEmployee.AccountId AND 
                      dbo.AccountEmployee.AccountEmployeeId = dbo.AccountCostCenterEmployee.AccountEmployeeId'

GO
-- Create Table MasterCustomDataType
Print 'Create Table MasterCustomDataType'
GO
IF NOT EXISTS (select * from information_schema.tables where table_name = 'MasterCustomDataType' and table_type = 'BASE TABLE') 
CREATE TABLE [dbo].[MasterCustomDataType] (
		[MasterCustomDataTypeId]       uniqueidentifier NOT NULL,
		[MasterCustomDataTypeName]     nvarchar(200) NOT NULL
)

GO
-- Add Primary Key PK_MasterCustomDataType to MasterCustomDataType
Print 'Add Primary Key PK_MasterCustomDataType to MasterCustomDataType'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'MasterCustomDataType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_NAME='PK_MasterCustomDataType' AND TABLE_NAME='MasterCustomDataType'))
ALTER TABLE [dbo].[MasterCustomDataType]
	ADD
	CONSTRAINT [PK_MasterCustomDataType]
	PRIMARY KEY
	([MasterCustomDataTypeId])

GO
-- Add Default Constraint DF_MasterCustomDataType_MasterCustomDataTypeId to MasterCustomDataType
Print 'Add Default Constraint DF_MasterCustomDataType_MasterCustomDataTypeId to MasterCustomDataType'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'MasterCustomDataType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM sysobjects WHERE name= N'DF_MasterCustomDataType_MasterCustomDataTypeId'))
ALTER TABLE [dbo].[MasterCustomDataType]
	ADD
	CONSTRAINT [DF_MasterCustomDataType_MasterCustomDataTypeId]
	DEFAULT (newid()) FOR [MasterCustomDataTypeId]

GO
-- Create Table MasterEntityType
Print 'Create Table MasterEntityType'
GO
IF NOT EXISTS (select * from information_schema.tables where table_name = 'MasterEntityType' and table_type = 'BASE TABLE') 
CREATE TABLE [dbo].[MasterEntityType] (
		[MasterEntityTypeId]       uniqueidentifier NOT NULL,
		[MasterEntityTypeName]     nvarchar(200) NOT NULL
)

GO
-- Add Primary Key PK_MasterEntityType to MasterEntityType
Print 'Add Primary Key PK_MasterEntityType to MasterEntityType'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'MasterEntityType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_NAME='PK_MasterEntityType' AND TABLE_NAME='MasterEntityType'))
ALTER TABLE [dbo].[MasterEntityType]
	ADD
	CONSTRAINT [PK_MasterEntityType]
	PRIMARY KEY
	([MasterEntityTypeId])

GO
-- Add Default Constraint DF_MasterEntityType_MasterEntityTypeId to MasterEntityType
Print 'Add Default Constraint DF_MasterEntityType_MasterEntityTypeId to MasterEntityType'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'MasterEntityType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM sysobjects WHERE name= N'DF_MasterEntityType_MasterEntityTypeId'))
ALTER TABLE [dbo].[MasterEntityType]
	ADD
	CONSTRAINT [DF_MasterEntityType_MasterEntityTypeId]
	DEFAULT (newid()) FOR [MasterEntityTypeId]

GO
-- Create Table AccountCustomField
Print 'Create Table AccountCustomField'
GO
IF NOT EXISTS (select * from information_schema.tables where table_name = 'AccountCustomField' and table_type = 'BASE TABLE') 
CREATE TABLE [dbo].[AccountCustomField] (
		[AccountCustomFieldId]       uniqueidentifier NOT NULL,
		[AccountId]                  int NOT NULL,
		[MasterCustomDataTypeId]     uniqueidentifier NOT NULL,
		[MasterEntityTypeId]         uniqueidentifier NOT NULL,
		[DatabaseFieldName]          nvarchar(100) NOT NULL,
		[CustomFieldName]            nvarchar(100) NOT NULL,
		[CustomFieldCaption]         nvarchar(100) NOT NULL,
		[DefaultValue]               nvarchar(500) NULL,
		[MaximumLength]              int NULL,
		[MinimumValue]               int NULL,
		[MaximumValue]               int NULL,
		[DropDownOptions]            nvarchar(3000) NULL,
		[IsRequired]                 bit NULL,
		[IsDisabled]                 bit NULL,
		[CreatedOn]                  datetime NOT NULL,
		[CreatedByEmployeeId]        int NOT NULL,
		[ModifiedOn]                 datetime NOT NULL,
		[ModifiedByEmployeeId]       int NOT NULL
)

GO
-- Add Primary Key PK_AccountCustomField to AccountCustomField
Print 'Add Primary Key PK_AccountCustomField to AccountCustomField'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountCustomField' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_NAME='PK_AccountCustomField' AND TABLE_NAME='AccountCustomField'))
ALTER TABLE [dbo].[AccountCustomField]
	ADD
	CONSTRAINT [PK_AccountCustomField]
	PRIMARY KEY
	([AccountCustomFieldId])

GO
-- Add Default Constraint DF_AccountCustomField_AccountCustomFieldId to AccountCustomField
Print 'Add Default Constraint DF_AccountCustomField_AccountCustomFieldId to AccountCustomField'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountCustomField' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM sysobjects WHERE name= N'DF_AccountCustomField_AccountCustomFieldId'))
ALTER TABLE [dbo].[AccountCustomField]
	ADD
	CONSTRAINT [DF_AccountCustomField_AccountCustomFieldId]
	DEFAULT (newid()) FOR [AccountCustomFieldId]

GO
-- Create Index IX_AccountCustomFieldId on AccountCustomField
Print 'Create Index IX_AccountCustomFieldId on AccountCustomField'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountCustomField' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountCustomField]') AND name = N'IX_AccountCustomFieldId'))
CREATE INDEX [IX_AccountCustomFieldId]
	ON [dbo].[AccountCustomField] ([AccountCustomFieldId])

GO
-- Create Index IX_AccountId on AccountCustomField
Print 'Create Index IX_AccountId on AccountCustomField'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountCustomField' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountCustomField]') AND name = N'IX_AccountId'))
CREATE INDEX [IX_AccountId]
	ON [dbo].[AccountCustomField] ([AccountId])

GO
-- Create Index IX_CreatedByEmployeeId on AccountCustomField
Print 'Create Index IX_CreatedByEmployeeId on AccountCustomField'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountCustomField' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountCustomField]') AND name = N'IX_CreatedByEmployeeId'))
CREATE INDEX [IX_CreatedByEmployeeId]
	ON [dbo].[AccountCustomField] ([CreatedByEmployeeId])

GO
-- Create Index IX_CreatedOn on AccountCustomField
Print 'Create Index IX_CreatedOn on AccountCustomField'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountCustomField' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountCustomField]') AND name = N'IX_CreatedOn'))
CREATE INDEX [IX_CreatedOn]
	ON [dbo].[AccountCustomField] ([CreatedOn])

GO
-- Create Index IX_CustomFieldCaption on AccountCustomField
Print 'Create Index IX_CustomFieldCaption on AccountCustomField'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountCustomField' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountCustomField]') AND name = N'IX_CustomFieldCaption'))
CREATE INDEX [IX_CustomFieldCaption]
	ON [dbo].[AccountCustomField] ([CustomFieldCaption])

GO
-- Create Index IX_CustomFieldName on AccountCustomField
Print 'Create Index IX_CustomFieldName on AccountCustomField'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountCustomField' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountCustomField]') AND name = N'IX_CustomFieldName'))
CREATE INDEX [IX_CustomFieldName]
	ON [dbo].[AccountCustomField] ([CustomFieldName])

GO
-- Create Index IX_DatabaseFieldName on AccountCustomField
Print 'Create Index IX_DatabaseFieldName on AccountCustomField'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountCustomField' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountCustomField]') AND name = N'IX_DatabaseFieldName'))
CREATE INDEX [IX_DatabaseFieldName]
	ON [dbo].[AccountCustomField] ([DatabaseFieldName])

GO
-- Create Index IX_IsDisabled on AccountCustomField
Print 'Create Index IX_IsDisabled on AccountCustomField'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountCustomField' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountCustomField]') AND name = N'IX_IsDisabled'))
CREATE INDEX [IX_IsDisabled]
	ON [dbo].[AccountCustomField] ([IsDisabled])

GO
-- Create Index IX_IsRequired on AccountCustomField
Print 'Create Index IX_IsRequired on AccountCustomField'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountCustomField' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountCustomField]') AND name = N'IX_IsRequired'))
CREATE INDEX [IX_IsRequired]
	ON [dbo].[AccountCustomField] ([IsRequired])

GO
-- Create Index IX_MasterCustomDataTypeId on AccountCustomField
Print 'Create Index IX_MasterCustomDataTypeId on AccountCustomField'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountCustomField' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountCustomField]') AND name = N'IX_MasterCustomDataTypeId'))
CREATE INDEX [IX_MasterCustomDataTypeId]
	ON [dbo].[AccountCustomField] ([MasterCustomDataTypeId])

GO
-- Create Index IX_MasterEntityTypeId on AccountCustomField
Print 'Create Index IX_MasterEntityTypeId on AccountCustomField'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountCustomField' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountCustomField]') AND name = N'IX_MasterEntityTypeId'))
CREATE INDEX [IX_MasterEntityTypeId]
	ON [dbo].[AccountCustomField] ([MasterEntityTypeId])

GO
-- Create Index IX_MaximumLenght on AccountCustomField
Print 'Create Index IX_MaximumLenght on AccountCustomField'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountCustomField' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountCustomField]') AND name = N'IX_MaximumLenght'))
CREATE INDEX [IX_MaximumLenght]
	ON [dbo].[AccountCustomField] ([MaximumLength])

GO
-- Create Index IX_MaximumValue on AccountCustomField
Print 'Create Index IX_MaximumValue on AccountCustomField'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountCustomField' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountCustomField]') AND name = N'IX_MaximumValue'))
CREATE INDEX [IX_MaximumValue]
	ON [dbo].[AccountCustomField] ([MaximumValue])

GO
-- Create Index IX_MinimumValue on AccountCustomField
Print 'Create Index IX_MinimumValue on AccountCustomField'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountCustomField' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountCustomField]') AND name = N'IX_MinimumValue'))
CREATE INDEX [IX_MinimumValue]
	ON [dbo].[AccountCustomField] ([MinimumValue])

GO
-- Create Index IX_ModifiedByEmployeeId on AccountCustomField
Print 'Create Index IX_ModifiedByEmployeeId on AccountCustomField'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountCustomField' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountCustomField]') AND name = N'IX_ModifiedByEmployeeId'))
CREATE INDEX [IX_ModifiedByEmployeeId]
	ON [dbo].[AccountCustomField] ([ModifiedByEmployeeId])

GO
-- Create Index IX_ModifiedOn on AccountCustomField
Print 'Create Index IX_ModifiedOn on AccountCustomField'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountCustomField' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM dbo.sysindexes WHERE id = OBJECT_ID(N'[dbo].[AccountCustomField]') AND name = N'IX_ModifiedOn'))
CREATE INDEX [IX_ModifiedOn]
	ON [dbo].[AccountCustomField] ([ModifiedOn])
	
GO
-- Add Column CustomField1 to AccountProject
Print 'Add Column CustomField1 to AccountProject'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProject' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField1' AND TABLE_NAME='AccountProject'))
ALTER TABLE [dbo].[AccountProject]
	ADD [CustomField1] nvarchar(2000) NULL


GO
-- Add Column CustomField2 to AccountProject
Print 'Add Column CustomField2 to AccountProject'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProject' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField2' AND TABLE_NAME='AccountProject'))
ALTER TABLE [dbo].[AccountProject]
	ADD [CustomField2] nvarchar(2000) NULL


GO
-- Add Column CustomField3 to AccountProject
Print 'Add Column CustomField3 to AccountProject'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProject' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField3' AND TABLE_NAME='AccountProject'))
ALTER TABLE [dbo].[AccountProject]
	ADD [CustomField3] nvarchar(2000) NULL


GO
-- Add Column CustomField4 to AccountProject
Print 'Add Column CustomField4 to AccountProject'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProject' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField4' AND TABLE_NAME='AccountProject'))
ALTER TABLE [dbo].[AccountProject]
	ADD [CustomField4] nvarchar(2000) NULL


GO
-- Add Column CustomField5 to AccountProject
Print 'Add Column CustomField5 to AccountProject'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProject' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField5' AND TABLE_NAME='AccountProject'))
ALTER TABLE [dbo].[AccountProject]
	ADD [CustomField5] nvarchar(2000) NULL


GO
-- Add Column CustomField6 to AccountProject
Print 'Add Column CustomField6 to AccountProject'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProject' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField6' AND TABLE_NAME='AccountProject'))
ALTER TABLE [dbo].[AccountProject]
	ADD [CustomField6] nvarchar(2000) NULL


GO
-- Add Column CustomField7 to AccountProject
Print 'Add Column CustomField7 to AccountProject'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProject' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField7' AND TABLE_NAME='AccountProject'))
ALTER TABLE [dbo].[AccountProject]
	ADD [CustomField7] nvarchar(2000) NULL


GO
-- Add Column CustomField8 to AccountProject
Print 'Add Column CustomField8 to AccountProject'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProject' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField8' AND TABLE_NAME='AccountProject'))
ALTER TABLE [dbo].[AccountProject]
	ADD [CustomField8] nvarchar(2000) NULL


GO
-- Add Column CustomField9 to AccountProject
Print 'Add Column CustomField9 to AccountProject'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProject' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField9' AND TABLE_NAME='AccountProject'))
ALTER TABLE [dbo].[AccountProject]
	ADD [CustomField9] nvarchar(2000) NULL


GO
-- Add Column CustomField10 to AccountProject
Print 'Add Column CustomField10 to AccountProject'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProject' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField10' AND TABLE_NAME='AccountProject'))
ALTER TABLE [dbo].[AccountProject]
	ADD [CustomField10] nvarchar(2000) NULL


GO
-- Add Column CustomField11 to AccountProject
Print 'Add Column CustomField11 to AccountProject'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProject' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField11' AND TABLE_NAME='AccountProject'))
ALTER TABLE [dbo].[AccountProject]
	ADD [CustomField11] nvarchar(2000) NULL


GO
-- Add Column CustomField12 to AccountProject
Print 'Add Column CustomField12 to AccountProject'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProject' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField12' AND TABLE_NAME='AccountProject'))
ALTER TABLE [dbo].[AccountProject]
	ADD [CustomField12] nvarchar(2000) NULL


GO
-- Add Column CustomField13 to AccountProject
Print 'Add Column CustomField13 to AccountProject'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProject' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField13' AND TABLE_NAME='AccountProject'))
ALTER TABLE [dbo].[AccountProject]
	ADD [CustomField13] nvarchar(2000) NULL


GO
-- Add Column CustomField14 to AccountProject
Print 'Add Column CustomField14 to AccountProject'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProject' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField14' AND TABLE_NAME='AccountProject'))
ALTER TABLE [dbo].[AccountProject]
	ADD [CustomField14] nvarchar(2000) NULL


GO
-- Add Column CustomField15 to AccountProject
Print 'Add Column CustomField15 to AccountProject'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProject' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField15' AND TABLE_NAME='AccountProject'))
ALTER TABLE [dbo].[AccountProject]
	ADD [CustomField15] nvarchar(2000) NULL

GO
-- Drop View vueAccountCustomFieldManage
Print 'Drop View vueAccountCustomFieldManage'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountCustomFieldManage' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountCustomFieldManage]

GO
-- Create View vueAccountCustomFieldManage
Print 'Create View vueAccountCustomFieldManage'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountCustomFieldManage' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountCustomFieldManage
AS
SELECT     dbo.AccountCustomField.AccountCustomFieldId, dbo.AccountCustomField.AccountId, dbo.AccountCustomField.MasterCustomDataTypeId, 
                      dbo.AccountCustomField.DatabaseFieldName, dbo.AccountCustomField.CustomFieldName, dbo.AccountCustomField.CustomFieldCaption, 
                      dbo.AccountCustomField.DefaultValue, dbo.AccountCustomField.MaximumLength, dbo.AccountCustomField.MinimumValue, dbo.AccountCustomField.MaximumValue, 
                      dbo.AccountCustomField.DropDownOptions, dbo.AccountCustomField.IsRequired, dbo.AccountCustomField.IsDisabled, dbo.MasterEntityType.MasterEntityTypeName, 
                      dbo.AccountCustomField.MasterEntityTypeId, dbo.MasterCustomDataType.MasterCustomDataTypeName
FROM         dbo.AccountCustomField LEFT OUTER JOIN
                      dbo.MasterEntityType ON dbo.AccountCustomField.MasterEntityTypeId = dbo.MasterEntityType.MasterEntityTypeId LEFT OUTER JOIN
                      dbo.MasterCustomDataType ON dbo.AccountCustomField.MasterCustomDataTypeId = dbo.MasterCustomDataType.MasterCustomDataTypeId'


GO
-- Create Foreign Key FK_AccountCustomField_Account on AccountCustomField
Print 'Create Foreign Key FK_AccountCustomField_Account on AccountCustomField'
GO
IF NOT EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_SCHEMA='dbo' AND CONSTRAINT_NAME='FK_AccountCustomField_Account' AND TABLE_NAME='AccountCustomField')
BEGIN
		ALTER TABLE [dbo].[AccountCustomField]
			ADD CONSTRAINT [FK_AccountCustomField_Account]
			FOREIGN KEY ([AccountId]) REFERENCES [dbo].[Account] ([AccountId])
			ON DELETE CASCADE
END

GO
-- Create Foreign Key FK_AccountCustomField_MasterCustomDataType on AccountCustomField
Print 'Create Foreign Key FK_AccountCustomField_MasterCustomDataType on AccountCustomField'
GO
IF NOT EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_SCHEMA='dbo' AND CONSTRAINT_NAME='FK_AccountCustomField_MasterCustomDataType' AND TABLE_NAME='AccountCustomField')
BEGIN
		ALTER TABLE [dbo].[AccountCustomField]
			ADD CONSTRAINT [FK_AccountCustomField_MasterCustomDataType]
			FOREIGN KEY ([MasterCustomDataTypeId]) REFERENCES [dbo].[MasterCustomDataType] ([MasterCustomDataTypeId])
END

GO
-- Create Foreign Key FK_AccountCustomField_MasterEntityType on AccountCustomField
Print 'Create Foreign Key FK_AccountCustomField_MasterEntityType on AccountCustomField'
GO
IF NOT EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_SCHEMA='dbo' AND CONSTRAINT_NAME='FK_AccountCustomField_MasterEntityType' AND TABLE_NAME='AccountCustomField')
BEGIN
		ALTER TABLE [dbo].[AccountCustomField]
			ADD CONSTRAINT [FK_AccountCustomField_MasterEntityType]
			FOREIGN KEY ([MasterEntityTypeId]) REFERENCES [dbo].[MasterEntityType] ([MasterEntityTypeId])
END

GO

-- Drop View rptvueAccountProjectsReport
Print 'Drop View rptvueAccountProjectsReport'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectsReport' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountProjectsReport]

GO
-- Drop View rptvueAccountProjectsTimesheet
Print 'Drop View rptvueAccountProjectsTimesheet'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectsTimesheet' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountProjectsTimesheet]

GO
-- Drop View rptvueAccountProjectsforReport
Print 'Drop View rptvueAccountProjectsforReport'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectsforReport' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountProjectsforReport]

GO
-- Drop View rptvueAccountProjects
Print 'Drop View rptvueAccountProjects'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountProjects' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountProjects]

GO
-- Drop View vueAccountProjectsForReport
Print 'Drop View vueAccountProjectsForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountProjectsForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountProjectsForReport]

GO
-- Drop View vueAccountProjectsOnlyForReport
Print 'Drop View vueAccountProjectsOnlyForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountProjectsOnlyForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountProjectsOnlyForReport]

GO
-- Create View vueAccountProjectsOnlyForReport
Print 'Create View vueAccountProjectsOnlyForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountProjectsOnlyForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountProjectsOnlyForReport
AS
SELECT     dbo.AccountProject.AccountProjectId, dbo.AccountProject.AccountId, dbo.AccountProject.AccountProjectTypeId, dbo.AccountProject.AccountClientId, 
                      dbo.AccountProject.ProjectBillingTypeId, dbo.AccountProject.ProjectName, dbo.AccountProject.ProjectDescription, dbo.AccountProject.StartDate, 
                      dbo.AccountProject.AccountMilestoneId, dbo.AccountProject.Deadline, dbo.AccountProject.LeaderEmployeeId, dbo.AccountProject.ProjectManagerEmployeeId, 
                      dbo.AccountProject.EstimatedTime, dbo.AccountProject.EstimatedDurationUnit, dbo.AccountProject.ProjectCode, dbo.AccountProject.DefaultBillingRate, 
                      dbo.AccountProject.IsActive, dbo.AccountProject.ProjectStatusId, dbo.AccountProject.AccountPriorityId, dbo.AccountProject.CreatedOn, 
                      dbo.AccountProject.CreatedByEmployeeId, dbo.AccountProject.ModifiedOn, dbo.AccountProject.ModifiedByEmployeeId, dbo.AccountProject.ProjectBillingRateTypeId, 
                      dbo.AccountProject.TimeSheetApprovalTypeId, dbo.AccountProject.ExpenseApprovalTypeId, dbo.AccountProject.AccountPartyContactId AS AccountClientContactId, 
                      dbo.AccountProject.AccountPartyDepartmentId AS AccountClientDepartmentId, dbo.AccountProject.IsDisabled, dbo.AccountProject.IsTemplate, 
                      dbo.AccountProject.IsProject, dbo.AccountProject.AccountProjectTemplateId, dbo.AccountParty.PartyNick AS ClientNick, dbo.AccountParty.PartyName AS ClientName, 
                      dbo.AccountProjectType.ProjectType, dbo.AccountBillingType.BillingType, dbo.AccountStatus.Status, CONVERT(nvarchar(200), dbo.AccountProject.EstimatedDuration) 
                      AS EstimatedDuration, dbo.AccountPartyDepartment.PartyDepartmentCode AS ClientDepartmentCode, 
                      dbo.AccountPartyDepartment.PartyDepartmentName AS ClientDepartmentName, dbo.AccountPartyDepartment.PartyDepartmentLocation AS ClientDepartmentLocation, 
                      dbo.AccountPartyContact.FirstName + '' '' + dbo.AccountPartyContact.LastName AS ClientContactName, 
                      AccountApprovalType_1.ApprovalTypeName AS ExpenseApprovalTypeName, dbo.AccountApprovalType.ApprovalTypeName AS TimesheetApprovalTypeName, 
                      AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName AS TeamLead, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS ProjectManager, 
                      dbo.SystemProjectBillingRateType.SystemProjectBillingRateType AS ProjectBillingRateType, dbo.AccountProject.CustomField1, dbo.AccountProject.CustomField2, 
                      dbo.AccountProject.CustomField3, dbo.AccountProject.CustomField4, dbo.AccountProject.CustomField5, dbo.AccountProject.CustomField6, 
                      dbo.AccountProject.CustomField7, dbo.AccountProject.CustomField8, dbo.AccountProject.CustomField9, dbo.AccountProject.CustomField10, 
                      dbo.AccountProject.CustomField11, dbo.AccountProject.CustomField12, dbo.AccountProject.CustomField13, dbo.AccountProject.CustomField14, 
                      dbo.AccountProject.CustomField15
FROM         dbo.AccountPartyContact RIGHT OUTER JOIN
                      dbo.AccountProject INNER JOIN
                      dbo.Account ON dbo.AccountProject.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId AND dbo.Account.AccountId = dbo.AccountParty.AccountId INNER JOIN
                      dbo.AccountProjectType ON dbo.AccountProject.AccountProjectTypeId = dbo.AccountProjectType.AccountProjectTypeId AND 
                      dbo.Account.AccountId = dbo.AccountProjectType.AccountId INNER JOIN
                      dbo.AccountBillingType ON dbo.AccountProject.ProjectBillingTypeId = dbo.AccountBillingType.AccountBillingTypeId AND 
                      dbo.Account.AccountId = dbo.AccountBillingType.AccountId INNER JOIN
                      dbo.AccountStatus ON dbo.AccountProject.ProjectStatusId = dbo.AccountStatus.AccountStatusId AND 
                      dbo.Account.AccountId = dbo.AccountStatus.AccountId LEFT OUTER JOIN
                      dbo.SystemProjectBillingRateType ON 
                      dbo.AccountProject.ProjectBillingRateTypeId = dbo.SystemProjectBillingRateType.SystemProjectBillingRateTypeId LEFT OUTER JOIN
                      dbo.AccountEmployee ON dbo.AccountProject.ProjectManagerEmployeeId = dbo.AccountEmployee.AccountEmployeeId AND 
                      dbo.Account.AccountId = dbo.AccountEmployee.AccountId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON dbo.AccountProject.LeaderEmployeeId = AccountEmployee_1.AccountEmployeeId AND 
                      dbo.Account.AccountId = AccountEmployee_1.AccountId LEFT OUTER JOIN
                      dbo.AccountApprovalType ON dbo.AccountProject.TimeSheetApprovalTypeId = dbo.AccountApprovalType.AccountApprovalTypeId AND 
                      dbo.Account.AccountId = dbo.AccountApprovalType.AccountId LEFT OUTER JOIN
                      dbo.AccountApprovalType AS AccountApprovalType_1 ON dbo.AccountProject.ExpenseApprovalTypeId = AccountApprovalType_1.AccountApprovalTypeId AND 
                      dbo.Account.AccountId = AccountApprovalType_1.AccountId LEFT OUTER JOIN
                      dbo.AccountPartyDepartment ON dbo.AccountProject.AccountPartyDepartmentId = dbo.AccountPartyDepartment.AccountPartyDepartmentId ON 
                      dbo.AccountPartyContact.AccountPartyContactId = dbo.AccountProject.AccountPartyContactId
WHERE     (dbo.AccountProject.IsTemplate <> 1) AND (dbo.AccountProject.IsDeleted IS NULL OR
                      dbo.AccountProject.IsDeleted <> 1)'

GO
-- Create View vueAccountProjectsForReport
Print 'Create View vueAccountProjectsForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountProjectsForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountProjectsForReport
AS
SELECT     dbo.vueAccountProjectsOnlyForReport.AccountProjectId, dbo.vueAccountProjectsOnlyForReport.AccountId, 
                      dbo.vueAccountProjectsOnlyForReport.AccountProjectTypeId, dbo.vueAccountProjectsOnlyForReport.AccountClientId, 
                      dbo.vueAccountProjectsOnlyForReport.ProjectBillingTypeId, dbo.vueAccountProjectsOnlyForReport.ProjectName, 
                      dbo.vueAccountProjectsOnlyForReport.ProjectDescription, dbo.vueAccountProjectsOnlyForReport.StartDate, 
                      dbo.vueAccountProjectsOnlyForReport.AccountMilestoneId, dbo.vueAccountProjectsOnlyForReport.Deadline, 
                      dbo.vueAccountProjectsOnlyForReport.LeaderEmployeeId, dbo.vueAccountProjectsOnlyForReport.ProjectManagerEmployeeId, 
                      dbo.vueAccountProjectsOnlyForReport.EstimatedTime, dbo.vueAccountProjectsOnlyForReport.EstimatedDurationUnit, 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.ProjectCode, N'''') AS ProjectCode, dbo.vueAccountProjectsOnlyForReport.DefaultBillingRate, 
                      dbo.vueAccountProjectsOnlyForReport.IsActive, dbo.vueAccountProjectsOnlyForReport.ProjectStatusId, dbo.vueAccountProjectsOnlyForReport.AccountPriorityId, 
                      dbo.vueAccountProjectsOnlyForReport.CreatedOn, dbo.vueAccountProjectsOnlyForReport.CreatedByEmployeeId, dbo.vueAccountProjectsOnlyForReport.ModifiedOn, 
                      dbo.vueAccountProjectsOnlyForReport.ModifiedByEmployeeId, dbo.vueAccountProjectsOnlyForReport.ProjectBillingRateTypeId, 
                      dbo.vueAccountProjectsOnlyForReport.TimeSheetApprovalTypeId, dbo.vueAccountProjectsOnlyForReport.ExpenseApprovalTypeId, 
                      dbo.vueAccountProjectsOnlyForReport.IsDisabled, dbo.vueAccountProjectsOnlyForReport.IsTemplate, dbo.vueAccountProjectsOnlyForReport.IsProject, 
                      dbo.vueAccountProjectsOnlyForReport.AccountProjectTemplateId, ISNULL(dbo.vueAccountProjectsOnlyForReport.ClientNick, N'''') AS ClientNick, 
                      dbo.vueAccountProjectsOnlyForReport.ClientName, dbo.vueAccountProjectsOnlyForReport.ProjectType, dbo.vueAccountProjectsOnlyForReport.BillingType, 
                      dbo.vueAccountProjectsOnlyForReport.Status, 
                      dbo.vueAccountProjectsOnlyForReport.EstimatedDuration + '' - '' + dbo.vueAccountProjectsOnlyForReport.EstimatedDurationUnit AS EstimatedDuration, 
                      dbo.vueAccountProjectsOnlyForReport.AccountClientContactId, dbo.vueAccountProjectsOnlyForReport.AccountClientDepartmentId, 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.ClientDepartmentCode, N'''') AS ClientDepartmentCode, 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.ClientDepartmentName, N'''') AS ClientDepartmentName, 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.ClientDepartmentLocation, N'''') AS ClientDepartmentLocation, 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.ExpenseApprovalTypeName, N'''') AS ExpenseApprovalTypeName, 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.TimesheetApprovalTypeName, N'''') AS TimesheetApprovalTypeName, 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.ClientContactName, N'''') AS ClientContactName, dbo.vueAccountProjectsOnlyForReport.TeamLead, 
                      dbo.vueAccountProjectsOnlyForReport.ProjectManager, dbo.vueAccountProjectsOnlyForReport.ProjectBillingRateType, 
                      ISNULL(SUM(dbo.rptvueAccountEmployeeTimeEntry.BillableTotalHours), 0) AS BillableTotalHours, 
                      ISNULL(SUM(dbo.rptvueAccountEmployeeTimeEntry.NonBillableTotalHours), 0) AS NonBillableTotalHours, SUM(dbo.rptvueAccountEmployeeTimeEntry.EmployeeCost) 
                      AS TotalEmployeeCost, ISNULL(SUM(dbo.rptvueAccountEmployeeTimeEntry.Amount), 0) AS TotalTimeAmount, 
                      ISNULL(SUM(dbo.rptvueAccountEmployeeTimeEntry.TotalHours), 0) AS TotalHours, ISNULL(SUM(dbo.rptvueAccountEmployeeTimeEntry.BillableTotalAmount), 0) 
                      AS BillableTimeAmount, ISNULL(SUM(dbo.rptvueAccountEmployeeTimeEntry.NonBillableTotalAmount), 0) AS NonBillableTimeAmount, 
                      dbo.vueAccountProjectsOnlyForReport.CustomField1, dbo.vueAccountProjectsOnlyForReport.CustomField2, dbo.vueAccountProjectsOnlyForReport.CustomField3, 
                      dbo.vueAccountProjectsOnlyForReport.CustomField4, dbo.vueAccountProjectsOnlyForReport.CustomField5, dbo.vueAccountProjectsOnlyForReport.CustomField6, 
                      dbo.vueAccountProjectsOnlyForReport.CustomField7, dbo.vueAccountProjectsOnlyForReport.CustomField8, dbo.vueAccountProjectsOnlyForReport.CustomField9, 
                      dbo.vueAccountProjectsOnlyForReport.CustomField10, dbo.vueAccountProjectsOnlyForReport.CustomField11, dbo.vueAccountProjectsOnlyForReport.CustomField12, 
                      dbo.vueAccountProjectsOnlyForReport.CustomField13, dbo.vueAccountProjectsOnlyForReport.CustomField14, 
                      dbo.vueAccountProjectsOnlyForReport.CustomField15
FROM         dbo.vueAccountProjectsOnlyForReport LEFT OUTER JOIN
                      dbo.rptvueAccountEmployeeTimeEntry ON dbo.vueAccountProjectsOnlyForReport.AccountProjectId = dbo.rptvueAccountEmployeeTimeEntry.AccountProjectId
GROUP BY dbo.vueAccountProjectsOnlyForReport.AccountProjectId, dbo.vueAccountProjectsOnlyForReport.AccountId, 
                      dbo.vueAccountProjectsOnlyForReport.AccountProjectTypeId, dbo.vueAccountProjectsOnlyForReport.AccountClientId, 
                      dbo.vueAccountProjectsOnlyForReport.ProjectBillingTypeId, dbo.vueAccountProjectsOnlyForReport.ProjectName, 
                      dbo.vueAccountProjectsOnlyForReport.ProjectDescription, dbo.vueAccountProjectsOnlyForReport.StartDate, 
                      dbo.vueAccountProjectsOnlyForReport.AccountMilestoneId, dbo.vueAccountProjectsOnlyForReport.Deadline, 
                      dbo.vueAccountProjectsOnlyForReport.LeaderEmployeeId, dbo.vueAccountProjectsOnlyForReport.ProjectManagerEmployeeId, 
                      dbo.vueAccountProjectsOnlyForReport.EstimatedTime, dbo.vueAccountProjectsOnlyForReport.EstimatedDurationUnit, 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.ProjectCode, N''''), dbo.vueAccountProjectsOnlyForReport.DefaultBillingRate, 
                      dbo.vueAccountProjectsOnlyForReport.IsActive, dbo.vueAccountProjectsOnlyForReport.ProjectStatusId, dbo.vueAccountProjectsOnlyForReport.AccountPriorityId, 
                      dbo.vueAccountProjectsOnlyForReport.CreatedOn, dbo.vueAccountProjectsOnlyForReport.CreatedByEmployeeId, dbo.vueAccountProjectsOnlyForReport.ModifiedOn, 
                      dbo.vueAccountProjectsOnlyForReport.ModifiedByEmployeeId, dbo.vueAccountProjectsOnlyForReport.ProjectBillingRateTypeId, 
                      dbo.vueAccountProjectsOnlyForReport.TimeSheetApprovalTypeId, dbo.vueAccountProjectsOnlyForReport.ExpenseApprovalTypeId, 
                      dbo.vueAccountProjectsOnlyForReport.IsDisabled, dbo.vueAccountProjectsOnlyForReport.IsTemplate, dbo.vueAccountProjectsOnlyForReport.IsProject, 
                      dbo.vueAccountProjectsOnlyForReport.AccountProjectTemplateId, ISNULL(dbo.vueAccountProjectsOnlyForReport.ClientNick, N''''), 
                      dbo.vueAccountProjectsOnlyForReport.ClientName, dbo.vueAccountProjectsOnlyForReport.ProjectType, dbo.vueAccountProjectsOnlyForReport.BillingType, 
                      dbo.vueAccountProjectsOnlyForReport.Status, 
                      dbo.vueAccountProjectsOnlyForReport.EstimatedDuration + '' - '' + dbo.vueAccountProjectsOnlyForReport.EstimatedDurationUnit, 
                      dbo.vueAccountProjectsOnlyForReport.AccountClientContactId, dbo.vueAccountProjectsOnlyForReport.AccountClientDepartmentId, 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.ClientDepartmentCode, N''''), ISNULL(dbo.vueAccountProjectsOnlyForReport.ClientDepartmentName, N''''), 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.ClientDepartmentLocation, N''''), ISNULL(dbo.vueAccountProjectsOnlyForReport.ExpenseApprovalTypeName, N''''), 
                      ISNULL(dbo.vueAccountProjectsOnlyForReport.TimesheetApprovalTypeName, N''''), ISNULL(dbo.vueAccountProjectsOnlyForReport.ClientContactName, N''''), 
                      dbo.vueAccountProjectsOnlyForReport.TeamLead, dbo.vueAccountProjectsOnlyForReport.ProjectManager, 
                      dbo.vueAccountProjectsOnlyForReport.ProjectBillingRateType, dbo.vueAccountProjectsOnlyForReport.CustomField1, 
                      dbo.vueAccountProjectsOnlyForReport.CustomField2, dbo.vueAccountProjectsOnlyForReport.CustomField3, dbo.vueAccountProjectsOnlyForReport.CustomField4, 
                      dbo.vueAccountProjectsOnlyForReport.CustomField5, dbo.vueAccountProjectsOnlyForReport.CustomField6, dbo.vueAccountProjectsOnlyForReport.CustomField7, 
                      dbo.vueAccountProjectsOnlyForReport.CustomField8, dbo.vueAccountProjectsOnlyForReport.CustomField9, dbo.vueAccountProjectsOnlyForReport.CustomField10, 
                      dbo.vueAccountProjectsOnlyForReport.CustomField11, dbo.vueAccountProjectsOnlyForReport.CustomField12, dbo.vueAccountProjectsOnlyForReport.CustomField13, 
                      dbo.vueAccountProjectsOnlyForReport.CustomField14, dbo.vueAccountProjectsOnlyForReport.CustomField15'

GO
-- Create View rptvueAccountProjects
Print 'Create View rptvueAccountProjects'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountProjects' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountProjects
AS
SELECT     dbo.vueAccountProjectsForReport.AccountProjectId, dbo.vueAccountProjectsForReport.AccountId, dbo.vueAccountProjectsForReport.AccountProjectTypeId, 
                      dbo.vueAccountProjectsForReport.AccountClientId, dbo.vueAccountProjectsForReport.ProjectBillingTypeId, dbo.vueAccountProjectsForReport.ProjectName, 
                      dbo.vueAccountProjectsForReport.ProjectDescription, dbo.vueAccountProjectsForReport.StartDate, dbo.vueAccountProjectsForReport.AccountMilestoneId, 
                      dbo.vueAccountProjectsForReport.Deadline, dbo.vueAccountProjectsForReport.LeaderEmployeeId, dbo.vueAccountProjectsForReport.ProjectManagerEmployeeId, 
                      dbo.vueAccountProjectsForReport.EstimatedTime, dbo.vueAccountProjectsForReport.EstimatedDurationUnit, dbo.vueAccountProjectsForReport.ProjectCode, 
                      dbo.vueAccountProjectsForReport.DefaultBillingRate, dbo.vueAccountProjectsForReport.IsActive, dbo.vueAccountProjectsForReport.ProjectStatusId, 
                      dbo.vueAccountProjectsForReport.AccountPriorityId, dbo.vueAccountProjectsForReport.CreatedOn, dbo.vueAccountProjectsForReport.CreatedByEmployeeId, 
                      dbo.vueAccountProjectsForReport.ModifiedOn, dbo.vueAccountProjectsForReport.ModifiedByEmployeeId, dbo.vueAccountProjectsForReport.ProjectBillingRateTypeId, 
                      dbo.vueAccountProjectsForReport.TimeSheetApprovalTypeId, dbo.vueAccountProjectsForReport.ExpenseApprovalTypeId, 
                      dbo.vueAccountProjectsForReport.IsDisabled, dbo.vueAccountProjectsForReport.IsTemplate, dbo.vueAccountProjectsForReport.IsProject, 
                      dbo.vueAccountProjectsForReport.AccountProjectTemplateId, dbo.vueAccountProjectsForReport.ClientNick, dbo.vueAccountProjectsForReport.ClientName, 
                      dbo.vueAccountProjectsForReport.ProjectType, dbo.vueAccountProjectsForReport.BillingType, dbo.vueAccountProjectsForReport.Status, 
                      dbo.vueAccountProjectsForReport.EstimatedDuration, dbo.vueAccountProjectsForReport.AccountClientContactId, 
                      dbo.vueAccountProjectsForReport.AccountClientDepartmentId, dbo.vueAccountProjectsForReport.ClientDepartmentCode, 
                      dbo.vueAccountProjectsForReport.ClientDepartmentName, dbo.vueAccountProjectsForReport.ClientDepartmentLocation, 
                      dbo.vueAccountProjectsForReport.ExpenseApprovalTypeName, dbo.vueAccountProjectsForReport.TimesheetApprovalTypeName, 
                      dbo.vueAccountProjectsForReport.ClientContactName, dbo.vueAccountProjectsForReport.TeamLead, dbo.vueAccountProjectsForReport.ProjectManager, 
                      dbo.vueAccountProjectsForReport.ProjectBillingRateType, dbo.vueAccountProjectsForReport.BillableTotalHours, 
                      dbo.vueAccountProjectsForReport.NonBillableTotalHours, ISNULL(dbo.vueAccountProjectsForReport.TotalEmployeeCost, 0) AS TotalEmployeeCost, 
                      SUM(dbo.rptvueAccountProjectTasks.EstimatedCost) AS TotalTaskEstimatedCost, SUM(dbo.rptvueAccountProjectTasks.EstimatedHours) AS TotalTaskEstimatedHours, 
                      dbo.vueAccountProjectsForReport.TotalHours, dbo.vueAccountProjectsForReport.BillableTimeAmount, dbo.vueAccountProjectsForReport.NonBillableTimeAmount, 
                      dbo.vueAccountProjectsForReport.TotalTimeAmount, dbo.vueAccountProjectsForReport.CustomField1, dbo.vueAccountProjectsForReport.CustomField2, 
                      dbo.vueAccountProjectsForReport.CustomField3, dbo.vueAccountProjectsForReport.CustomField4, dbo.vueAccountProjectsForReport.CustomField5, 
                      dbo.vueAccountProjectsForReport.CustomField6, dbo.vueAccountProjectsForReport.CustomField7, dbo.vueAccountProjectsForReport.CustomField8, 
                      dbo.vueAccountProjectsForReport.CustomField9, dbo.vueAccountProjectsForReport.CustomField10, dbo.vueAccountProjectsForReport.CustomField11, 
                      dbo.vueAccountProjectsForReport.CustomField12, dbo.vueAccountProjectsForReport.CustomField13, dbo.vueAccountProjectsForReport.CustomField14, 
                      dbo.vueAccountProjectsForReport.CustomField15
FROM         dbo.vueAccountProjectsForReport LEFT OUTER JOIN
                      dbo.rptvueAccountProjectTasks ON dbo.vueAccountProjectsForReport.AccountProjectId = dbo.rptvueAccountProjectTasks.AccountProjectId
GROUP BY dbo.vueAccountProjectsForReport.AccountProjectId, dbo.vueAccountProjectsForReport.AccountId, dbo.vueAccountProjectsForReport.AccountProjectTypeId, 
                      dbo.vueAccountProjectsForReport.AccountClientId, dbo.vueAccountProjectsForReport.ProjectBillingTypeId, dbo.vueAccountProjectsForReport.ProjectName, 
                      dbo.vueAccountProjectsForReport.ProjectDescription, dbo.vueAccountProjectsForReport.StartDate, dbo.vueAccountProjectsForReport.AccountMilestoneId, 
                      dbo.vueAccountProjectsForReport.Deadline, dbo.vueAccountProjectsForReport.LeaderEmployeeId, dbo.vueAccountProjectsForReport.ProjectManagerEmployeeId, 
                      dbo.vueAccountProjectsForReport.EstimatedTime, dbo.vueAccountProjectsForReport.EstimatedDurationUnit, dbo.vueAccountProjectsForReport.ProjectCode, 
                      dbo.vueAccountProjectsForReport.IsActive, dbo.vueAccountProjectsForReport.ProjectStatusId, dbo.vueAccountProjectsForReport.DefaultBillingRate, 
                      dbo.vueAccountProjectsForReport.AccountPriorityId, dbo.vueAccountProjectsForReport.CreatedOn, dbo.vueAccountProjectsForReport.CreatedByEmployeeId, 
                      dbo.vueAccountProjectsForReport.ModifiedOn, dbo.vueAccountProjectsForReport.ModifiedByEmployeeId, dbo.vueAccountProjectsForReport.ProjectBillingRateTypeId, 
                      dbo.vueAccountProjectsForReport.TimeSheetApprovalTypeId, dbo.vueAccountProjectsForReport.ExpenseApprovalTypeId, 
                      dbo.vueAccountProjectsForReport.IsDisabled, dbo.vueAccountProjectsForReport.IsTemplate, dbo.vueAccountProjectsForReport.IsProject, 
                      dbo.vueAccountProjectsForReport.AccountProjectTemplateId, dbo.vueAccountProjectsForReport.ClientNick, dbo.vueAccountProjectsForReport.ClientName, 
                      dbo.vueAccountProjectsForReport.ProjectType, dbo.vueAccountProjectsForReport.BillingType, dbo.vueAccountProjectsForReport.Status, 
                      dbo.vueAccountProjectsForReport.EstimatedDuration, dbo.vueAccountProjectsForReport.AccountClientContactId, 
                      dbo.vueAccountProjectsForReport.AccountClientDepartmentId, dbo.vueAccountProjectsForReport.ClientDepartmentCode, 
                      dbo.vueAccountProjectsForReport.ClientDepartmentName, dbo.vueAccountProjectsForReport.ClientDepartmentLocation, 
                      dbo.vueAccountProjectsForReport.ExpenseApprovalTypeName, dbo.vueAccountProjectsForReport.TimesheetApprovalTypeName, 
                      dbo.vueAccountProjectsForReport.ClientContactName, dbo.vueAccountProjectsForReport.TeamLead, dbo.vueAccountProjectsForReport.ProjectManager, 
                      dbo.vueAccountProjectsForReport.ProjectBillingRateType, dbo.vueAccountProjectsForReport.BillableTotalHours, 
                      dbo.vueAccountProjectsForReport.NonBillableTotalHours, dbo.vueAccountProjectsForReport.TotalEmployeeCost, dbo.vueAccountProjectsForReport.TotalHours, 
                      dbo.vueAccountProjectsForReport.BillableTimeAmount, dbo.vueAccountProjectsForReport.NonBillableTimeAmount, 
                      dbo.vueAccountProjectsForReport.TotalTimeAmount, dbo.vueAccountProjectsForReport.CustomField1, dbo.vueAccountProjectsForReport.CustomField2, 
                      dbo.vueAccountProjectsForReport.CustomField3, dbo.vueAccountProjectsForReport.CustomField4, dbo.vueAccountProjectsForReport.CustomField5, 
                      dbo.vueAccountProjectsForReport.CustomField6, dbo.vueAccountProjectsForReport.CustomField7, dbo.vueAccountProjectsForReport.CustomField8, 
                      dbo.vueAccountProjectsForReport.CustomField9, dbo.vueAccountProjectsForReport.CustomField10, dbo.vueAccountProjectsForReport.CustomField11, 
                      dbo.vueAccountProjectsForReport.CustomField12, dbo.vueAccountProjectsForReport.CustomField13, dbo.vueAccountProjectsForReport.CustomField14, 
                      dbo.vueAccountProjectsForReport.CustomField15'

GO
-- Create View rptvueAccountProjectsforReport
Print 'Create View rptvueAccountProjectsforReport'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectsforReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountProjectsforReport
AS
SELECT     dbo.rptvueAccountProjects.AccountProjectId, dbo.rptvueAccountProjects.AccountId, dbo.rptvueAccountProjects.AccountProjectTypeId, 
                      dbo.rptvueAccountProjects.AccountClientId, dbo.rptvueAccountProjects.ProjectBillingTypeId, dbo.rptvueAccountProjects.ProjectName, 
                      dbo.rptvueAccountProjects.ProjectDescription, dbo.rptvueAccountProjects.StartDate, dbo.rptvueAccountProjects.AccountMilestoneId, 
                      dbo.rptvueAccountProjects.Deadline, dbo.rptvueAccountProjects.LeaderEmployeeId, dbo.rptvueAccountProjects.ProjectManagerEmployeeId, 
                      dbo.rptvueAccountProjects.EstimatedTime, dbo.rptvueAccountProjects.EstimatedDurationUnit, dbo.rptvueAccountProjects.ProjectCode, 
                      dbo.rptvueAccountProjects.DefaultBillingRate, dbo.rptvueAccountProjects.IsActive, dbo.rptvueAccountProjects.ProjectStatusId, 
                      dbo.rptvueAccountProjects.AccountPriorityId, dbo.rptvueAccountProjects.CreatedOn, dbo.rptvueAccountProjects.CreatedByEmployeeId, 
                      dbo.rptvueAccountProjects.ModifiedOn, dbo.rptvueAccountProjects.ModifiedByEmployeeId, dbo.rptvueAccountProjects.ProjectBillingRateTypeId, 
                      dbo.rptvueAccountProjects.TimeSheetApprovalTypeId, dbo.rptvueAccountProjects.ExpenseApprovalTypeId, dbo.rptvueAccountProjects.IsDisabled, 
                      dbo.rptvueAccountProjects.IsTemplate, dbo.rptvueAccountProjects.IsProject, dbo.rptvueAccountProjects.AccountProjectTemplateId, 
                      dbo.rptvueAccountProjects.ClientNick, dbo.rptvueAccountProjects.ClientName, dbo.rptvueAccountProjects.ProjectType, dbo.rptvueAccountProjects.BillingType, 
                      dbo.rptvueAccountProjects.Status, dbo.rptvueAccountProjects.EstimatedDuration, dbo.rptvueAccountProjects.AccountClientContactId, 
                      dbo.rptvueAccountProjects.AccountClientDepartmentId, dbo.rptvueAccountProjects.ClientDepartmentCode, dbo.rptvueAccountProjects.ClientDepartmentName, 
                      dbo.rptvueAccountProjects.ClientDepartmentLocation, dbo.rptvueAccountProjects.ExpenseApprovalTypeName, 
                      dbo.rptvueAccountProjects.TimesheetApprovalTypeName, dbo.rptvueAccountProjects.ClientContactName, dbo.rptvueAccountProjects.TeamLead, 
                      dbo.rptvueAccountProjects.ProjectManager, dbo.rptvueAccountProjects.ProjectBillingRateType, dbo.rptvueAccountProjects.BillableTotalHours, 
                      dbo.rptvueAccountProjects.NonBillableTotalHours, dbo.rptvueAccountProjects.TotalEmployeeCost, dbo.rptvueAccountProjects.TotalTimeAmount, 
                      ISNULL(dbo.rptvueAccountProjects.TotalTaskEstimatedCost, 0) AS TotalTaskEstimatedCost, 
                      SUM(CASE WHEN dbo.rptvueAccountExpenseEntry.IsBillable = 1 THEN dbo.rptvueAccountExpenseEntry.NetAmount ELSE 0 END) AS TotalBillableExpense, 
                      SUM(CASE WHEN dbo.rptvueAccountExpenseEntry.IsBillable = 0 THEN dbo.rptvueAccountExpenseEntry.NetAmount ELSE 0 END) AS TotalNonBillableExpense, 
                      ISNULL(SUM(dbo.rptvueAccountExpenseEntry.NetAmount), 0) AS NetAmount, ISNULL(dbo.rptvueAccountProjects.TotalTaskEstimatedHours, 0) 
                      AS TotalTaskEstimatedHours, dbo.rptvueAccountProjects.TotalHours, dbo.rptvueAccountProjects.BillableTimeAmount, 
                      dbo.rptvueAccountProjects.NonBillableTimeAmount, SUM(dbo.rptvueAccountExpenseEntry.CurrencyNetAmount) AS NetAmounts, 
                      dbo.rptvueAccountProjects.CustomField1, dbo.rptvueAccountProjects.CustomField2, dbo.rptvueAccountProjects.CustomField3, 
                      dbo.rptvueAccountProjects.CustomField4, dbo.rptvueAccountProjects.CustomField5, dbo.rptvueAccountProjects.CustomField6, 
                      dbo.rptvueAccountProjects.CustomField7, dbo.rptvueAccountProjects.CustomField8, dbo.rptvueAccountProjects.CustomField9, 
                      dbo.rptvueAccountProjects.CustomField10, dbo.rptvueAccountProjects.CustomField11, dbo.rptvueAccountProjects.CustomField12, 
                      dbo.rptvueAccountProjects.CustomField13, dbo.rptvueAccountProjects.CustomField14, dbo.rptvueAccountProjects.CustomField15
FROM         dbo.rptvueAccountProjects LEFT OUTER JOIN
                      dbo.rptvueAccountExpenseEntry ON dbo.rptvueAccountExpenseEntry.AccountProjectId = dbo.rptvueAccountProjects.AccountProjectId
GROUP BY dbo.rptvueAccountProjects.AccountProjectId, dbo.rptvueAccountProjects.AccountId, dbo.rptvueAccountProjects.AccountProjectTypeId, 
                      dbo.rptvueAccountProjects.AccountClientId, dbo.rptvueAccountProjects.ProjectName, dbo.rptvueAccountProjects.ProjectBillingTypeId, 
                      dbo.rptvueAccountProjects.ProjectDescription, dbo.rptvueAccountProjects.StartDate, dbo.rptvueAccountProjects.AccountMilestoneId, 
                      dbo.rptvueAccountProjects.Deadline, dbo.rptvueAccountProjects.LeaderEmployeeId, dbo.rptvueAccountProjects.ProjectManagerEmployeeId, 
                      dbo.rptvueAccountProjects.EstimatedTime, dbo.rptvueAccountProjects.EstimatedDurationUnit, dbo.rptvueAccountProjects.ProjectCode, 
                      dbo.rptvueAccountProjects.DefaultBillingRate, dbo.rptvueAccountProjects.IsActive, dbo.rptvueAccountProjects.ProjectStatusId, 
                      dbo.rptvueAccountProjects.AccountPriorityId, dbo.rptvueAccountProjects.CreatedOn, dbo.rptvueAccountProjects.CreatedByEmployeeId, 
                      dbo.rptvueAccountProjects.ModifiedOn, dbo.rptvueAccountProjects.ModifiedByEmployeeId, dbo.rptvueAccountProjects.ProjectBillingRateTypeId, 
                      dbo.rptvueAccountProjects.TimeSheetApprovalTypeId, dbo.rptvueAccountProjects.ExpenseApprovalTypeId, dbo.rptvueAccountProjects.IsDisabled, 
                      dbo.rptvueAccountProjects.IsTemplate, dbo.rptvueAccountProjects.IsProject, dbo.rptvueAccountProjects.AccountProjectTemplateId, 
                      dbo.rptvueAccountProjects.ClientNick, dbo.rptvueAccountProjects.ClientName, dbo.rptvueAccountProjects.ProjectType, dbo.rptvueAccountProjects.BillingType, 
                      dbo.rptvueAccountProjects.Status, dbo.rptvueAccountProjects.EstimatedDuration, dbo.rptvueAccountProjects.AccountClientContactId, 
                      dbo.rptvueAccountProjects.AccountClientDepartmentId, dbo.rptvueAccountProjects.ClientDepartmentCode, dbo.rptvueAccountProjects.ClientDepartmentName, 
                      dbo.rptvueAccountProjects.ClientDepartmentLocation, dbo.rptvueAccountProjects.ExpenseApprovalTypeName, 
                      dbo.rptvueAccountProjects.TimesheetApprovalTypeName, dbo.rptvueAccountProjects.ClientContactName, dbo.rptvueAccountProjects.TeamLead, 
                      dbo.rptvueAccountProjects.ProjectManager, dbo.rptvueAccountProjects.ProjectBillingRateType, dbo.rptvueAccountProjects.BillableTotalHours, 
                      dbo.rptvueAccountProjects.NonBillableTotalHours, dbo.rptvueAccountProjects.TotalEmployeeCost, dbo.rptvueAccountProjects.TotalTimeAmount, 
                      dbo.rptvueAccountProjects.TotalTaskEstimatedCost, ISNULL(dbo.rptvueAccountProjects.TotalTaskEstimatedHours, 0), dbo.rptvueAccountProjects.TotalHours, 
                      dbo.rptvueAccountProjects.BillableTimeAmount, dbo.rptvueAccountProjects.NonBillableTimeAmount, dbo.rptvueAccountProjects.CustomField1, 
                      dbo.rptvueAccountProjects.CustomField2, dbo.rptvueAccountProjects.CustomField3, dbo.rptvueAccountProjects.CustomField4, 
                      dbo.rptvueAccountProjects.CustomField5, dbo.rptvueAccountProjects.CustomField6, dbo.rptvueAccountProjects.CustomField7, 
                      dbo.rptvueAccountProjects.CustomField8, dbo.rptvueAccountProjects.CustomField9, dbo.rptvueAccountProjects.CustomField10, 
                      dbo.rptvueAccountProjects.CustomField11, dbo.rptvueAccountProjects.CustomField12, dbo.rptvueAccountProjects.CustomField13, 
                      dbo.rptvueAccountProjects.CustomField14, dbo.rptvueAccountProjects.CustomField15'

GO
-- Create View rptvueAccountProjectsTimesheet
Print 'Create View rptvueAccountProjectsTimesheet'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectsTimesheet' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountProjectsTimesheet
AS
SELECT     dbo.rptvueAccountProjectsforReport.AccountProjectId, dbo.rptvueAccountProjectsforReport.AccountId, dbo.rptvueAccountProjectsforReport.AccountProjectTypeId, 
                      dbo.rptvueAccountProjectsforReport.AccountClientId, dbo.rptvueAccountProjectsforReport.ProjectBillingTypeId, dbo.rptvueAccountProjectsforReport.ProjectName, 
                      dbo.rptvueAccountProjectsforReport.ProjectDescription, dbo.rptvueAccountProjectsforReport.StartDate, dbo.rptvueAccountProjectsforReport.AccountMilestoneId, 
                      dbo.rptvueAccountProjectsforReport.Deadline, dbo.rptvueAccountProjectsforReport.LeaderEmployeeId, 
                      dbo.rptvueAccountProjectsforReport.ProjectManagerEmployeeId, dbo.rptvueAccountProjectsforReport.EstimatedTime, 
                      dbo.rptvueAccountProjectsforReport.EstimatedDurationUnit, dbo.rptvueAccountProjectsforReport.ProjectCode, dbo.rptvueAccountProjectsforReport.DefaultBillingRate, 
                      dbo.rptvueAccountProjectsforReport.IsActive, dbo.rptvueAccountProjectsforReport.ProjectStatusId, dbo.rptvueAccountProjectsforReport.AccountPriorityId, 
                      dbo.rptvueAccountProjectsforReport.CreatedOn, dbo.rptvueAccountProjectsforReport.CreatedByEmployeeId, dbo.rptvueAccountProjectsforReport.ModifiedOn, 
                      dbo.rptvueAccountProjectsforReport.ModifiedByEmployeeId, dbo.rptvueAccountProjectsforReport.ProjectBillingRateTypeId, 
                      dbo.rptvueAccountProjectsforReport.TimeSheetApprovalTypeId, dbo.rptvueAccountProjectsforReport.ExpenseApprovalTypeId, 
                      dbo.rptvueAccountProjectsforReport.IsDisabled, dbo.rptvueAccountProjectsforReport.IsTemplate, dbo.rptvueAccountProjectsforReport.IsProject, 
                      dbo.rptvueAccountProjectsforReport.AccountProjectTemplateId, dbo.rptvueAccountProjectsforReport.ClientNick, dbo.rptvueAccountProjectsforReport.ClientName, 
                      dbo.rptvueAccountProjectsforReport.ProjectType, dbo.rptvueAccountProjectsforReport.BillingType, dbo.rptvueAccountProjectsforReport.Status, 
                      dbo.rptvueAccountProjectsforReport.EstimatedDuration, dbo.rptvueAccountProjectsforReport.AccountClientContactId, 
                      dbo.rptvueAccountProjectsforReport.AccountClientDepartmentId, dbo.rptvueAccountProjectsforReport.ClientDepartmentCode, 
                      dbo.rptvueAccountProjectsforReport.ClientDepartmentName, dbo.rptvueAccountProjectsforReport.ClientDepartmentLocation, 
                      dbo.rptvueAccountProjectsforReport.ExpenseApprovalTypeName, dbo.rptvueAccountProjectsforReport.TimesheetApprovalTypeName, 
                      dbo.rptvueAccountProjectsforReport.ClientContactName, dbo.rptvueAccountProjectsforReport.TeamLead, dbo.rptvueAccountProjectsforReport.ProjectManager, 
                      dbo.rptvueAccountProjectsforReport.ProjectBillingRateType, dbo.rptvueAccountProjectsforReport.BillableTotalHours, 
                      dbo.rptvueAccountProjectsforReport.NonBillableTotalHours, dbo.rptvueAccountProjectsforReport.TotalEmployeeCost, 
                      dbo.rptvueAccountProjectsforReport.TotalTimeAmount, dbo.rptvueAccountProjectsforReport.TotalTaskEstimatedCost, 
                      dbo.rptvueAccountProjectsforReport.TotalBillableExpense, dbo.rptvueAccountProjectsforReport.TotalNonBillableExpense, 
                      dbo.rptvueAccountProjectsforReport.NetAmount, dbo.rptvueAccountProjectsforReport.TotalTaskEstimatedHours, dbo.rptvueAccountProjectsforReport.TotalHours, 
                      dbo.rptvueAccountProjectsforReport.BillableTimeAmount, dbo.rptvueAccountProjectsforReport.NonBillableTimeAmount, SUM(dbo.vueBillingTimesheet.TotalAmount) 
                      AS BilledTimeAmount, ISNULL(dbo.rptvueAccountProjectsforReport.NetAmounts, 0) AS CurrencyNetAmount, dbo.rptvueAccountProjectsforReport.CustomField1, 
                      dbo.rptvueAccountProjectsforReport.CustomField2, dbo.rptvueAccountProjectsforReport.CustomField3, dbo.rptvueAccountProjectsforReport.CustomField4, 
                      dbo.rptvueAccountProjectsforReport.CustomField5, dbo.rptvueAccountProjectsforReport.CustomField6, dbo.rptvueAccountProjectsforReport.CustomField7, 
                      dbo.rptvueAccountProjectsforReport.CustomField8, dbo.rptvueAccountProjectsforReport.CustomField9, dbo.rptvueAccountProjectsforReport.CustomField10, 
                      dbo.rptvueAccountProjectsforReport.CustomField11, dbo.rptvueAccountProjectsforReport.CustomField12, dbo.rptvueAccountProjectsforReport.CustomField13, 
                      dbo.rptvueAccountProjectsforReport.CustomField14, dbo.rptvueAccountProjectsforReport.CustomField15
FROM         dbo.rptvueAccountProjectsforReport LEFT OUTER JOIN
                      dbo.vueBillingTimesheet ON dbo.rptvueAccountProjectsforReport.AccountProjectId = dbo.vueBillingTimesheet.AccountProjectId
GROUP BY dbo.rptvueAccountProjectsforReport.AccountProjectId, dbo.rptvueAccountProjectsforReport.AccountId, dbo.rptvueAccountProjectsforReport.AccountProjectTypeId, 
                      dbo.rptvueAccountProjectsforReport.AccountClientId, dbo.rptvueAccountProjectsforReport.ProjectBillingTypeId, dbo.rptvueAccountProjectsforReport.ProjectName, 
                      dbo.rptvueAccountProjectsforReport.ProjectDescription, dbo.rptvueAccountProjectsforReport.StartDate, dbo.rptvueAccountProjectsforReport.AccountMilestoneId, 
                      dbo.rptvueAccountProjectsforReport.Deadline, dbo.rptvueAccountProjectsforReport.LeaderEmployeeId, 
                      dbo.rptvueAccountProjectsforReport.ProjectManagerEmployeeId, dbo.rptvueAccountProjectsforReport.EstimatedTime, 
                      dbo.rptvueAccountProjectsforReport.EstimatedDurationUnit, dbo.rptvueAccountProjectsforReport.ProjectCode, dbo.rptvueAccountProjectsforReport.DefaultBillingRate, 
                      dbo.rptvueAccountProjectsforReport.IsActive, dbo.rptvueAccountProjectsforReport.ProjectStatusId, dbo.rptvueAccountProjectsforReport.AccountPriorityId, 
                      dbo.rptvueAccountProjectsforReport.CreatedOn, dbo.rptvueAccountProjectsforReport.CreatedByEmployeeId, dbo.rptvueAccountProjectsforReport.ModifiedOn, 
                      dbo.rptvueAccountProjectsforReport.ModifiedByEmployeeId, dbo.rptvueAccountProjectsforReport.ProjectBillingRateTypeId, 
                      dbo.rptvueAccountProjectsforReport.TimeSheetApprovalTypeId, dbo.rptvueAccountProjectsforReport.ExpenseApprovalTypeId, 
                      dbo.rptvueAccountProjectsforReport.IsDisabled, dbo.rptvueAccountProjectsforReport.IsTemplate, dbo.rptvueAccountProjectsforReport.IsProject, 
                      dbo.rptvueAccountProjectsforReport.AccountProjectTemplateId, dbo.rptvueAccountProjectsforReport.ClientNick, dbo.rptvueAccountProjectsforReport.ClientName, 
                      dbo.rptvueAccountProjectsforReport.ProjectType, dbo.rptvueAccountProjectsforReport.BillingType, dbo.rptvueAccountProjectsforReport.Status, 
                      dbo.rptvueAccountProjectsforReport.EstimatedDuration, dbo.rptvueAccountProjectsforReport.AccountClientContactId, 
                      dbo.rptvueAccountProjectsforReport.AccountClientDepartmentId, dbo.rptvueAccountProjectsforReport.ClientDepartmentCode, 
                      dbo.rptvueAccountProjectsforReport.ClientDepartmentName, dbo.rptvueAccountProjectsforReport.ClientDepartmentLocation, 
                      dbo.rptvueAccountProjectsforReport.ExpenseApprovalTypeName, dbo.rptvueAccountProjectsforReport.TimesheetApprovalTypeName, 
                      dbo.rptvueAccountProjectsforReport.ClientContactName, dbo.rptvueAccountProjectsforReport.TeamLead, dbo.rptvueAccountProjectsforReport.ProjectManager, 
                      dbo.rptvueAccountProjectsforReport.ProjectBillingRateType, dbo.rptvueAccountProjectsforReport.BillableTotalHours, 
                      dbo.rptvueAccountProjectsforReport.NonBillableTotalHours, dbo.rptvueAccountProjectsforReport.TotalEmployeeCost, 
                      dbo.rptvueAccountProjectsforReport.TotalTimeAmount, dbo.rptvueAccountProjectsforReport.TotalTaskEstimatedCost, 
                      dbo.rptvueAccountProjectsforReport.TotalBillableExpense, dbo.rptvueAccountProjectsforReport.TotalNonBillableExpense, 
                      dbo.rptvueAccountProjectsforReport.NetAmount, dbo.rptvueAccountProjectsforReport.TotalTaskEstimatedHours, dbo.rptvueAccountProjectsforReport.TotalHours, 
                      dbo.rptvueAccountProjectsforReport.BillableTimeAmount, dbo.rptvueAccountProjectsforReport.NonBillableTimeAmount, 
                      ISNULL(dbo.rptvueAccountProjectsforReport.NetAmounts, 0), dbo.rptvueAccountProjectsforReport.CustomField1, dbo.rptvueAccountProjectsforReport.CustomField2, 
                      dbo.rptvueAccountProjectsforReport.CustomField3, dbo.rptvueAccountProjectsforReport.CustomField4, dbo.rptvueAccountProjectsforReport.CustomField5, 
                      dbo.rptvueAccountProjectsforReport.CustomField6, dbo.rptvueAccountProjectsforReport.CustomField7, dbo.rptvueAccountProjectsforReport.CustomField8, 
                      dbo.rptvueAccountProjectsforReport.CustomField9, dbo.rptvueAccountProjectsforReport.CustomField10, dbo.rptvueAccountProjectsforReport.CustomField11, 
                      dbo.rptvueAccountProjectsforReport.CustomField12, dbo.rptvueAccountProjectsforReport.CustomField13, dbo.rptvueAccountProjectsforReport.CustomField14, 
                      dbo.rptvueAccountProjectsforReport.CustomField15'

GO
-- Create View rptvueAccountProjectsReport
Print 'Create View rptvueAccountProjectsReport'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectsReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountProjectsReport
AS
SELECT     dbo.rptvueAccountProjectsTimesheet.AccountProjectId, dbo.rptvueAccountProjectsTimesheet.AccountId, dbo.rptvueAccountProjectsTimesheet.AccountProjectTypeId, 
                      dbo.rptvueAccountProjectsTimesheet.AccountClientId, dbo.rptvueAccountProjectsTimesheet.ProjectBillingTypeId, dbo.rptvueAccountProjectsTimesheet.ProjectName, 
                      dbo.rptvueAccountProjectsTimesheet.ProjectDescription, dbo.rptvueAccountProjectsTimesheet.StartDate, dbo.rptvueAccountProjectsTimesheet.AccountMilestoneId, 
                      dbo.rptvueAccountProjectsTimesheet.Deadline, dbo.rptvueAccountProjectsTimesheet.LeaderEmployeeId, 
                      dbo.rptvueAccountProjectsTimesheet.ProjectManagerEmployeeId, dbo.rptvueAccountProjectsTimesheet.EstimatedTime, 
                      dbo.rptvueAccountProjectsTimesheet.EstimatedDurationUnit, dbo.rptvueAccountProjectsTimesheet.ProjectCode, 
                      dbo.rptvueAccountProjectsTimesheet.DefaultBillingRate, dbo.rptvueAccountProjectsTimesheet.IsActive, dbo.rptvueAccountProjectsTimesheet.ProjectStatusId, 
                      dbo.rptvueAccountProjectsTimesheet.AccountPriorityId, dbo.rptvueAccountProjectsTimesheet.CreatedOn, dbo.rptvueAccountProjectsTimesheet.CreatedByEmployeeId, 
                      dbo.rptvueAccountProjectsTimesheet.ModifiedOn, dbo.rptvueAccountProjectsTimesheet.ModifiedByEmployeeId, 
                      dbo.rptvueAccountProjectsTimesheet.ProjectBillingRateTypeId, dbo.rptvueAccountProjectsTimesheet.TimeSheetApprovalTypeId, 
                      dbo.rptvueAccountProjectsTimesheet.ExpenseApprovalTypeId, dbo.rptvueAccountProjectsTimesheet.IsDisabled, dbo.rptvueAccountProjectsTimesheet.IsTemplate, 
                      dbo.rptvueAccountProjectsTimesheet.IsProject, dbo.rptvueAccountProjectsTimesheet.AccountProjectTemplateId, dbo.rptvueAccountProjectsTimesheet.ClientNick, 
                      dbo.rptvueAccountProjectsTimesheet.ClientName, dbo.rptvueAccountProjectsTimesheet.ProjectType, dbo.rptvueAccountProjectsTimesheet.BillingType, 
                      dbo.rptvueAccountProjectsTimesheet.Status, dbo.rptvueAccountProjectsTimesheet.EstimatedDuration, dbo.rptvueAccountProjectsTimesheet.AccountClientContactId, 
                      dbo.rptvueAccountProjectsTimesheet.AccountClientDepartmentId, dbo.rptvueAccountProjectsTimesheet.ClientDepartmentCode, 
                      dbo.rptvueAccountProjectsTimesheet.ClientDepartmentName, dbo.rptvueAccountProjectsTimesheet.ClientDepartmentLocation, 
                      dbo.rptvueAccountProjectsTimesheet.ExpenseApprovalTypeName, dbo.rptvueAccountProjectsTimesheet.TimesheetApprovalTypeName, 
                      dbo.rptvueAccountProjectsTimesheet.ClientContactName, dbo.rptvueAccountProjectsTimesheet.TeamLead, dbo.rptvueAccountProjectsTimesheet.ProjectManager, 
                      dbo.rptvueAccountProjectsTimesheet.ProjectBillingRateType, dbo.rptvueAccountProjectsTimesheet.BillableTotalHours, 
                      dbo.rptvueAccountProjectsTimesheet.NonBillableTotalHours, dbo.rptvueAccountProjectsTimesheet.TotalEmployeeCost, 
                      dbo.rptvueAccountProjectsTimesheet.TotalTimeAmount, dbo.rptvueAccountProjectsTimesheet.TotalTaskEstimatedCost, 
                      dbo.rptvueAccountProjectsTimesheet.TotalBillableExpense, dbo.rptvueAccountProjectsTimesheet.TotalNonBillableExpense, 
                      dbo.rptvueAccountProjectsTimesheet.NetAmount, dbo.rptvueAccountProjectsTimesheet.TotalTaskEstimatedHours, dbo.rptvueAccountProjectsTimesheet.TotalHours, 
                      dbo.rptvueAccountProjectsTimesheet.BillableTimeAmount, dbo.rptvueAccountProjectsTimesheet.NonBillableTimeAmount, 
                      ISNULL(dbo.rptvueAccountProjectsTimesheet.BilledTimeAmount, 0) AS BilledTimeAmount, ISNULL(SUM(dbo.vueBillingExpense.BilledExpenseAmount), 0) 
                      AS BilledExpenseAmount, dbo.rptvueAccountProjectsTimesheet.CurrencyNetAmount, dbo.rptvueAccountProjectsTimesheet.CustomField1, 
                      dbo.rptvueAccountProjectsTimesheet.CustomField2, dbo.rptvueAccountProjectsTimesheet.CustomField3, dbo.rptvueAccountProjectsTimesheet.CustomField4, 
                      dbo.rptvueAccountProjectsTimesheet.CustomField5, dbo.rptvueAccountProjectsTimesheet.CustomField6, dbo.rptvueAccountProjectsTimesheet.CustomField7, 
                      dbo.rptvueAccountProjectsTimesheet.CustomField8, dbo.rptvueAccountProjectsTimesheet.CustomField9, dbo.rptvueAccountProjectsTimesheet.CustomField10, 
                      dbo.rptvueAccountProjectsTimesheet.CustomField11, dbo.rptvueAccountProjectsTimesheet.CustomField12, dbo.rptvueAccountProjectsTimesheet.CustomField13, 
                      dbo.rptvueAccountProjectsTimesheet.CustomField14, dbo.rptvueAccountProjectsTimesheet.CustomField15
FROM         dbo.rptvueAccountProjectsTimesheet LEFT OUTER JOIN
                      dbo.vueBillingExpense ON dbo.rptvueAccountProjectsTimesheet.AccountProjectId = dbo.vueBillingExpense.AccountProjectId
GROUP BY dbo.rptvueAccountProjectsTimesheet.AccountProjectId, dbo.rptvueAccountProjectsTimesheet.AccountId, dbo.rptvueAccountProjectsTimesheet.AccountProjectTypeId, 
                      dbo.rptvueAccountProjectsTimesheet.AccountClientId, dbo.rptvueAccountProjectsTimesheet.ProjectBillingTypeId, dbo.rptvueAccountProjectsTimesheet.ProjectName, 
                      dbo.rptvueAccountProjectsTimesheet.ProjectDescription, dbo.rptvueAccountProjectsTimesheet.StartDate, dbo.rptvueAccountProjectsTimesheet.AccountMilestoneId, 
                      dbo.rptvueAccountProjectsTimesheet.Deadline, dbo.rptvueAccountProjectsTimesheet.LeaderEmployeeId, 
                      dbo.rptvueAccountProjectsTimesheet.ProjectManagerEmployeeId, dbo.rptvueAccountProjectsTimesheet.EstimatedTime, 
                      dbo.rptvueAccountProjectsTimesheet.EstimatedDurationUnit, dbo.rptvueAccountProjectsTimesheet.ProjectCode, 
                      dbo.rptvueAccountProjectsTimesheet.DefaultBillingRate, dbo.rptvueAccountProjectsTimesheet.IsActive, dbo.rptvueAccountProjectsTimesheet.ProjectStatusId, 
                      dbo.rptvueAccountProjectsTimesheet.AccountPriorityId, dbo.rptvueAccountProjectsTimesheet.CreatedOn, dbo.rptvueAccountProjectsTimesheet.CreatedByEmployeeId, 
                      dbo.rptvueAccountProjectsTimesheet.ModifiedOn, dbo.rptvueAccountProjectsTimesheet.ModifiedByEmployeeId, 
                      dbo.rptvueAccountProjectsTimesheet.ProjectBillingRateTypeId, dbo.rptvueAccountProjectsTimesheet.TimeSheetApprovalTypeId, 
                      dbo.rptvueAccountProjectsTimesheet.ExpenseApprovalTypeId, dbo.rptvueAccountProjectsTimesheet.IsDisabled, dbo.rptvueAccountProjectsTimesheet.IsTemplate, 
                      dbo.rptvueAccountProjectsTimesheet.IsProject, dbo.rptvueAccountProjectsTimesheet.AccountProjectTemplateId, dbo.rptvueAccountProjectsTimesheet.ClientNick, 
                      dbo.rptvueAccountProjectsTimesheet.ClientName, dbo.rptvueAccountProjectsTimesheet.ProjectType, dbo.rptvueAccountProjectsTimesheet.BillingType, 
                      dbo.rptvueAccountProjectsTimesheet.Status, dbo.rptvueAccountProjectsTimesheet.EstimatedDuration, dbo.rptvueAccountProjectsTimesheet.AccountClientContactId, 
                      dbo.rptvueAccountProjectsTimesheet.AccountClientDepartmentId, dbo.rptvueAccountProjectsTimesheet.ClientDepartmentCode, 
                      dbo.rptvueAccountProjectsTimesheet.ClientDepartmentName, dbo.rptvueAccountProjectsTimesheet.ClientDepartmentLocation, 
                      dbo.rptvueAccountProjectsTimesheet.ExpenseApprovalTypeName, dbo.rptvueAccountProjectsTimesheet.TimesheetApprovalTypeName, 
                      dbo.rptvueAccountProjectsTimesheet.ClientContactName, dbo.rptvueAccountProjectsTimesheet.TeamLead, dbo.rptvueAccountProjectsTimesheet.ProjectManager, 
                      dbo.rptvueAccountProjectsTimesheet.ProjectBillingRateType, dbo.rptvueAccountProjectsTimesheet.BillableTotalHours, 
                      dbo.rptvueAccountProjectsTimesheet.NonBillableTotalHours, dbo.rptvueAccountProjectsTimesheet.TotalEmployeeCost, 
                      dbo.rptvueAccountProjectsTimesheet.TotalTimeAmount, dbo.rptvueAccountProjectsTimesheet.TotalTaskEstimatedCost, 
                      dbo.rptvueAccountProjectsTimesheet.TotalBillableExpense, dbo.rptvueAccountProjectsTimesheet.TotalNonBillableExpense, 
                      dbo.rptvueAccountProjectsTimesheet.NetAmount, dbo.rptvueAccountProjectsTimesheet.TotalTaskEstimatedHours, dbo.rptvueAccountProjectsTimesheet.TotalHours, 
                      dbo.rptvueAccountProjectsTimesheet.BillableTimeAmount, dbo.rptvueAccountProjectsTimesheet.NonBillableTimeAmount, 
                      dbo.rptvueAccountProjectsTimesheet.BilledTimeAmount, dbo.rptvueAccountProjectsTimesheet.CurrencyNetAmount, 
                      dbo.rptvueAccountProjectsTimesheet.CustomField1, dbo.rptvueAccountProjectsTimesheet.CustomField2, dbo.rptvueAccountProjectsTimesheet.CustomField3, 
                      dbo.rptvueAccountProjectsTimesheet.CustomField4, dbo.rptvueAccountProjectsTimesheet.CustomField5, dbo.rptvueAccountProjectsTimesheet.CustomField6, 
                      dbo.rptvueAccountProjectsTimesheet.CustomField7, dbo.rptvueAccountProjectsTimesheet.CustomField8, dbo.rptvueAccountProjectsTimesheet.CustomField9, 
                      dbo.rptvueAccountProjectsTimesheet.CustomField10, dbo.rptvueAccountProjectsTimesheet.CustomField11, dbo.rptvueAccountProjectsTimesheet.CustomField12, 
                      dbo.rptvueAccountProjectsTimesheet.CustomField13, dbo.rptvueAccountProjectsTimesheet.CustomField14, dbo.rptvueAccountProjectsTimesheet.CustomField15'

GO
If exists(Select * from SystemData where version = '4.0.2')
--Update SystemSecurityCategoryPage Record
BEGIN

-- =======================================================
-- Foreign Key Constraint Nochecks's for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print ' Foreign Key Constraint Nochecks''s for Table: [dbo].[SystemSecurityCategoryPage]'

ALTER TABLE [dbo].[SystemSecurityCategoryPage] NOCHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory]
ALTER TABLE [dbo].[SystemSecurityCategoryPage] NOCHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory1]

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemSecurityCategoryPage]'

INSERT INTO [dbo].[SystemSecurityCategoryPage] ([SystemSecurityCategoryPageId], [SystemSecurityCategoryId], [SequenceNumber], [Folder], [SystemCategoryPage], [SystemCategoryPageDescription], [ParentSystemSecurityCateogoryPageId], [IsSiteMapPage], [IsCustomizeable], [IsAllowAdd], [IsAllowEdit], [IsAllowDelete], [IsAllowList], [IsShowDataOptions], [IsShowTillOptions], [IsSystemPage], [ControlLevelPermission], [NotShowInPermission], [NotShowInStartupPage], [SystemFeatureId]) VALUES (153, 1, N'218544567', N'AccountAdmin', 'AccountCustomField.aspx', 'Custom Field', 15, 1, 1, NULL, 1, NULL, 1, NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT INTO [dbo].[SystemSecurityCategoryPage] ([SystemSecurityCategoryPageId], [SystemSecurityCategoryId], [SequenceNumber], [Folder], [SystemCategoryPage], [SystemCategoryPageDescription], [ParentSystemSecurityCateogoryPageId], [IsSiteMapPage], [IsCustomizeable], [IsAllowAdd], [IsAllowEdit], [IsAllowDelete], [IsAllowList], [IsShowDataOptions], [IsShowTillOptions], [IsSystemPage], [ControlLevelPermission], [NotShowInPermission], [NotShowInStartupPage], [SystemFeatureId]) VALUES (154, 1, N'218544568', N'AccountAdmin', 'AccountCustomFieldManage.aspx', 'Custom Field Manage', 153, 1, 1, 1, 1, 1, 1, NULL, NULL, NULL, NULL, NULL, NULL, NULL)
INSERT INTO [dbo].[SystemSecurityCategoryPage] ([SystemSecurityCategoryPageId], [SystemSecurityCategoryId], [SequenceNumber], [Folder], [SystemCategoryPage], [SystemCategoryPageDescription], [ParentSystemSecurityCateogoryPageId], [IsSiteMapPage], [IsCustomizeable], [IsAllowAdd], [IsAllowEdit], [IsAllowDelete], [IsAllowList], [IsShowDataOptions], [IsShowTillOptions], [IsSystemPage], [ControlLevelPermission], [NotShowInPermission], [NotShowInStartupPage], [SystemFeatureId]) VALUES (155, 2, N'218544569', N'Employee', 'AccountCostCenterEmployee.aspx', 'Cost Center Employee', 4, 1, 1, NULL, 1, NULL, 1, NULL, NULL, NULL, NULL, NULL, NULL, NULL)

-- =======================================================
-- Foreign Key Constraint Check's for Table: [dbo].[SystemSecurityCategoryPage]
-- =======================================================
Print ' Foreign Key Constraint Check''s for Table: [dbo].[SystemSecurityCategoryPage]'

ALTER TABLE [dbo].[SystemSecurityCategoryPage] CHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory]
ALTER TABLE [dbo].[SystemSecurityCategoryPage] CHECK CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory1]

-- =======================================================
-- Synchronization Script for Table: [dbo].[MasterCustomDataType]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[MasterCustomDataType]'

INSERT INTO [dbo].[MasterCustomDataType] ([MasterCustomDataTypeId], [MasterCustomDataTypeName]) VALUES ('bacd6824-9011-4c30-864f-0899fefc004f', N'Number')
INSERT INTO [dbo].[MasterCustomDataType] ([MasterCustomDataTypeId], [MasterCustomDataTypeName]) VALUES ('7e295184-9623-4445-b99f-48f07929dce5', N'Text')
INSERT INTO [dbo].[MasterCustomDataType] ([MasterCustomDataTypeId], [MasterCustomDataTypeName]) VALUES ('574ded9c-7ad4-4649-8b39-d6741dd0ddca', N'Drop-Down')
INSERT INTO [dbo].[MasterCustomDataType] ([MasterCustomDataTypeId], [MasterCustomDataTypeName]) VALUES ('5942a0be-e7fe-4abb-b96f-f0b20d744ce3', N'Date')

-- =======================================================
-- Synchronization Script for Table: [dbo].[MasterEntityType]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[MasterEntityType]'

INSERT INTO [dbo].[MasterEntityType] ([MasterEntityTypeId], [MasterEntityTypeName]) VALUES ('13dbff37-a092-4ae2-a919-775cbed0edc0', N'Project')

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'

INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('6d7f781d-113e-4230-b122-e6661b4614fe', '7e5678a3-d1bc-4bb4-8fd1-75cab80388ba', N'CustomField6', 100, 0, NULL, NULL, 190, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 6', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('a636942c-8e20-45d5-bba0-e09e05edb54c', '7e5678a3-d1bc-4bb4-8fd1-75cab80388ba', N'CustomField12', 100, 0, NULL, NULL, 196, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 12', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('5e359450-7965-4715-824d-44828b300542', '7e5678a3-d1bc-4bb4-8fd1-75cab80388ba', N'CustomField2', 100, 0, NULL, NULL, 186, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 2', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('cbb59452-94eb-4a99-a36d-cbf4ad8256c5', '7e5678a3-d1bc-4bb4-8fd1-75cab80388ba', N'CustomField11', 100, 0, NULL, NULL, 195, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 11', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('9b805b54-7a80-4ca0-bd58-47752e40ebd3', '7e5678a3-d1bc-4bb4-8fd1-75cab80388ba', N'CustomField13', 100, 0, NULL, NULL, 197, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 13', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('5d587269-753c-4a56-8df8-1821c538a5b5', '7e5678a3-d1bc-4bb4-8fd1-75cab80388ba', N'CustomField7', 100, 0, NULL, NULL, 191, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 7', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('4bded96b-5434-4bef-9b91-692de6ac6432', '7e5678a3-d1bc-4bb4-8fd1-75cab80388ba', N'CustomField15', 100, 0, NULL, NULL, 199, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 15', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('0bf76c6f-3bd9-4aa9-ac81-2787674a49fd', '7e5678a3-d1bc-4bb4-8fd1-75cab80388ba', N'CustomField4', 100, 0, NULL, NULL, 188, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 4', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('8b6d7372-67da-40c4-9a4c-68ad287d4eb5', '7e5678a3-d1bc-4bb4-8fd1-75cab80388ba', N'CustomField10', 100, 0, NULL, NULL, 194, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 10', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('f9b59a9c-9d48-4654-87c3-5ddade2a47c4', '7e5678a3-d1bc-4bb4-8fd1-75cab80388ba', N'CustomField14', 100, 0, NULL, NULL, 198, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 14', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('2868a3a2-8a32-4777-99ac-e6d404e4c9ab', '7e5678a3-d1bc-4bb4-8fd1-75cab80388ba', N'CustomField3', 100, 0, NULL, NULL, 187, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 3', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('24c680a8-e002-496e-8f12-de7f4941b16a', '7e5678a3-d1bc-4bb4-8fd1-75cab80388ba', N'CustomField5', 100, 0, NULL, NULL, 189, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 5', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('5e3c05c2-8e24-47b9-b72a-e8f07415d4f2', '7e5678a3-d1bc-4bb4-8fd1-75cab80388ba', N'CustomField8', 100, 0, NULL, NULL, 192, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 8', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('8e2e65c3-49bb-440d-b5e2-af665c115cee', '7e5678a3-d1bc-4bb4-8fd1-75cab80388ba', N'CustomField9', 100, 0, NULL, NULL, 193, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 9', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('08409def-778e-4e10-9236-6e809636b7af', '7e5678a3-d1bc-4bb4-8fd1-75cab80388ba', N'CustomField1', 100, 0, NULL, NULL, 185, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 1', 0, 0)

END
GO
Update SystemData Set Version = '4.0.3' Where Version = '4.0.2' And SystemDataId = 1

GO
-- Drop View vueAccount
Print 'Drop View vueAccount'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccount' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccount]

GO
-- Drop View vueAccountEmployee
Print 'Drop View vueAccountEmployee'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployee]

GO
-- Add Column ShowCostCenterInTimesheetBy to AccountPreferences
Print 'Add Column ShowCostCenterInTimesheetBy to AccountPreferences'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountPreferences' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='ShowCostCenterInTimesheetBy' AND TABLE_NAME='AccountPreferences'))
ALTER TABLE [dbo].[AccountPreferences]
	ADD [ShowCostCenterInTimesheetBy] nvarchar(50) NULL


GO
-- Create View vueAccountEmployee
Print 'Create View vueAccountEmployee'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployee
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountEmployee.AccountId, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.Password, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountLocationId, dbo.AccountEmployee.BillingTypeId, 
                      dbo.AccountBillingType.BillingType, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, dbo.AccountPreferences.ShowClockStartEnd, dbo.Account.TimeZoneId, 
                      dbo.AccountRole.MasterAccountRoleId, dbo.Account.DefaultCurrencyId, dbo.Account.CountryId, dbo.AccountPreferences.CultureInfoName, 
                      dbo.AccountPreferences.TimeEntryFormat, dbo.AccountEmployee.AllowedAccessFromIP, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountPreferences.AccountSessionTimeout, dbo.AccountPreferences.ShowCompletedTasksInTimeSheet, dbo.AccountPreferences.CurrencySymbol, 
                      dbo.AccountPreferences.IsCompanyOwnLogo, dbo.Account.AccountExpiryActivation, dbo.Account.LicenseActivation, dbo.AccountEmployee.EmployeeTypeId, 
                      dbo.AccountEmployee.ExternalUserClientId, dbo.AccountEmployee.AccountBillingRateId, dbo.AccountPreferences.ScheduledEmailSendTime, 
                      dbo.AccountEmployee.Username, dbo.AccountEmployee.IsDisabled, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.AccountEmployee.EmployeeCode, dbo.AccountPreferences.Version, 
                      dbo.AccountPreferences.LockSubmittedRecords, dbo.AccountPreferences.LockApprovedRecords, ISNULL(dbo.AccountEmployee.EmployeeCode + '' - '', '''') 
                      + dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeNameWithCode, dbo.AccountPreferences.ShowWorkTypeInTimeSheet, 
                      dbo.AccountPreferences.NumberOfBlankRowsInTimeEntry, dbo.AccountPreferences.ShowCostCenterInTimeSheet, dbo.AccountPreferences.WeekStartDay, 
                      dbo.AccountPreferences.AccountBaseCurrencyId, dbo.AccountPreferences.UserInterfaceLanguage, dbo.AccountEmployee.EmployeeManagerId, 
                      dbo.AccountPreferences.DefaultTimeEntryMode, dbo.AccountPreferences.PageSize, dbo.AccountEmployee.TimeZoneId AS EmployeeTimeZoneId, 
                      dbo.AccountEmployee.TerminationDate, dbo.AccountEmployee.StatusId, dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.EmployeePayTypeId, 
                      dbo.AccountEmployee.HiredDate, dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountWorkingDayType, 
                      dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay AS EmployeeWeekStartDay, 
                      dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountPreferences.ShowDescriptionInWeekView, 
                      dbo.AccountPreferences.InvoiceNoPrefix, dbo.AccountPreferences.ShowAdditionalTaskInformationType, 
                      dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, 
                      ISNULL(dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, 1) AS InitialDayOfTheMonth, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, 1) 
                      AS SystemInitialDayOfFirstPeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod, 16) AS SystemInitialDayOfLastPeriod, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountPreferences.TimesheetPrintFooter, dbo.AccountPreferences.ExpenseSheetPrintFooter, 
                      dbo.AccountPreferences.ShowCompletedProjectsInTimeSheet, dbo.AccountPreferences.ShowProjectForTimeOff, dbo.AccountPreferences.ShowTimeOffInTimesheet, 
                      dbo.AccountEmployee.IsDeleted, dbo.AccountEmployee.IsForcePasswordChange, dbo.AccountEmployee.PasswordChangedDate, 
                      dbo.AccountPreferences.PasswordExpiryPeriod, dbo.AccountPreferences.ShowAllInTimesheetReadOnly, dbo.AccountPreferences.ShowTaskInExpenseSheet, 
                      dbo.AccountPreferences.InvoiceBillingTypeId, dbo.AccountPreferences.ShowBillingRateInInvoiceReport, dbo.SystemInvoiceBillingType.InvoiceBillingType, 
                      dbo.AccountPreferences.InvoiceFooter, dbo.AccountPreferences.TimesheetOverduePeriods, dbo.AccountWorkingDayType.TimesheetOverdueAfterDays, 
                      dbo.AccountEmployee.CreatedOn, dbo.AccountEmployee.CreatedByEmployeeId, dbo.AccountEmployee.ModifiedOn, dbo.AccountEmployee.ModifiedByEmployeeId, 
                      dbo.AccountPreferences.ShowProjectNameInInvoiceReport, dbo.AccountPreferences.ProjectCodePrefix, dbo.AccountPreferences.AutoGenerateProjectCode, 
                      dbo.AccountPreferences.TimeEntryHoursFormatId, dbo.AccountPreferences.ShowPercentageInTimesheet, dbo.AccountPreferences.EnablePasswordComplexity, 
                      dbo.AccountPreferences.ShowClientDepartmentInProject, dbo.AccountPreferences.ShowEntryDateInInvoiceReport, dbo.AccountPreferences.TimesheetSort, 
                      dbo.AccountPreferences.ShowCostCenterInTimesheetBy
FROM         dbo.SystemInvoiceBillingType RIGHT OUTER JOIN
                      dbo.AccountPreferences ON dbo.SystemInvoiceBillingType.InvoiceBillingTypeId = dbo.AccountPreferences.InvoiceBillingTypeId RIGHT OUTER JOIN
                      dbo.vueAccountTimesheetPeriodType RIGHT OUTER JOIN
                      dbo.AccountWorkingDayType ON 
                      dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId = dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId RIGHT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.Account ON dbo.AccountEmployee.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId ON 
                      dbo.AccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId ON 
                      dbo.AccountPreferences.AccountId = dbo.AccountEmployee.AccountId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId'

GO
-- Create View vueAccount
Print 'Create View vueAccount'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccount' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccount
AS
SELECT     dbo.Account.AccountId, dbo.Account.AccountTypeId, dbo.Account.AccountName, dbo.Account.Address1, dbo.Account.Address2, dbo.Account.ZipCode, dbo.Account.State, 
                      dbo.Account.City, dbo.Account.CountryId, dbo.Account.EMailAddress, dbo.Account.Telephone, dbo.Account.Fax, dbo.Account.DefaultCurrencyId, 
                      dbo.Account.TimeZoneId, dbo.Account.IsDisabled, dbo.Account.IsDeleted, dbo.Account.StatusId, dbo.Account.CreatedOn, dbo.Account.ModifiedOn, 
                      dbo.Account.ModifiedByEmployeeId, dbo.AccountPreferences.ShowClockStartEnd, dbo.AccountPreferences.AccountPreferencesId, dbo.Account.LicenseKey, 
                      dbo.Account.SystemPackageTypeId, dbo.AccountPreferences.TimeEntryFormat, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.Account.MachineId, dbo.Account.ActivationLicenseKey, dbo.Account.ActivationMachineKey, 
                      dbo.Account.ActivationType, dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountPreferences.InvoiceBillingTypeId, 
                      dbo.AccountPreferences.ShowBillingRateInInvoiceReport, dbo.AccountPreferences.InvoiceFooter, dbo.AccountPreferences.ShowProjectNameInInvoiceReport, 
                      dbo.AccountPreferences.ProjectCodePrefix, dbo.AccountPreferences.AutoGenerateProjectCode, dbo.AccountPreferences.TimeEntryHoursFormatId, 
                      dbo.AccountPreferences.ShowPercentageInTimesheet, dbo.AccountPreferences.EnablePasswordComplexity, dbo.AccountPreferences.ShowClientDepartmentInProject, 
                      dbo.AccountPreferences.ShowEntryDateInInvoiceReport, dbo.AccountPreferences.TimesheetSort, dbo.AccountPreferences.ShowCostCenterInTimesheetBy
FROM         dbo.Account INNER JOIN
                      dbo.AccountPreferences ON dbo.Account.AccountId = dbo.AccountPreferences.AccountId'

GO
-- Drop View vueAccount
Print 'Drop View vueAccount'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccount' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccount]

GO
-- Drop View vueAccountEmployee
Print 'Drop View vueAccountEmployee'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployee]

GO
-- Add Column ShowCopyTimesheetButton to AccountPreferences
Print 'Add Column ShowCopyTimesheetButton to AccountPreferences'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountPreferences' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='ShowCopyTimesheetButton' AND TABLE_NAME='AccountPreferences'))
ALTER TABLE [dbo].[AccountPreferences]
	ADD [ShowCopyTimesheetButton] bit NULL
	
GO
-- Add Column ShowCopyActivitiesButtonInTimesheet to AccountPreferences
Print 'Add Column ShowCopyActivitiesButtonInTimesheet to AccountPreferences'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountPreferences' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='ShowCopyActivitiesButtonInTimesheet' AND TABLE_NAME='AccountPreferences'))
ALTER TABLE [dbo].[AccountPreferences]
	ADD [ShowCopyActivitiesButtonInTimesheet] bit NULL


GO
-- Create View vueAccountEmployee
Print 'Create View vueAccountEmployee'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployee
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountEmployee.AccountId, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.Password, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountLocationId, dbo.AccountEmployee.BillingTypeId, 
                      dbo.AccountBillingType.BillingType, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, dbo.AccountPreferences.ShowClockStartEnd, dbo.Account.TimeZoneId, 
                      dbo.AccountRole.MasterAccountRoleId, dbo.Account.DefaultCurrencyId, dbo.Account.CountryId, dbo.AccountPreferences.CultureInfoName, 
                      dbo.AccountPreferences.TimeEntryFormat, dbo.AccountEmployee.AllowedAccessFromIP, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountPreferences.AccountSessionTimeout, dbo.AccountPreferences.ShowCompletedTasksInTimeSheet, dbo.AccountPreferences.CurrencySymbol, 
                      dbo.AccountPreferences.IsCompanyOwnLogo, dbo.Account.AccountExpiryActivation, dbo.Account.LicenseActivation, dbo.AccountEmployee.EmployeeTypeId, 
                      dbo.AccountEmployee.ExternalUserClientId, dbo.AccountEmployee.AccountBillingRateId, dbo.AccountPreferences.ScheduledEmailSendTime, 
                      dbo.AccountEmployee.Username, dbo.AccountEmployee.IsDisabled, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.AccountEmployee.EmployeeCode, dbo.AccountPreferences.Version, 
                      dbo.AccountPreferences.LockSubmittedRecords, dbo.AccountPreferences.LockApprovedRecords, ISNULL(dbo.AccountEmployee.EmployeeCode + '' - '', '''') 
                      + dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeNameWithCode, dbo.AccountPreferences.ShowWorkTypeInTimeSheet, 
                      dbo.AccountPreferences.NumberOfBlankRowsInTimeEntry, dbo.AccountPreferences.ShowCostCenterInTimeSheet, dbo.AccountPreferences.WeekStartDay, 
                      dbo.AccountPreferences.AccountBaseCurrencyId, dbo.AccountPreferences.UserInterfaceLanguage, dbo.AccountEmployee.EmployeeManagerId, 
                      dbo.AccountPreferences.DefaultTimeEntryMode, dbo.AccountPreferences.PageSize, dbo.AccountEmployee.TimeZoneId AS EmployeeTimeZoneId, 
                      dbo.AccountEmployee.TerminationDate, dbo.AccountEmployee.StatusId, dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.EmployeePayTypeId, 
                      dbo.AccountEmployee.HiredDate, dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountWorkingDayType, 
                      dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay AS EmployeeWeekStartDay, 
                      dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountPreferences.ShowDescriptionInWeekView, 
                      dbo.AccountPreferences.InvoiceNoPrefix, dbo.AccountPreferences.ShowAdditionalTaskInformationType, 
                      dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, 
                      ISNULL(dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, 1) AS InitialDayOfTheMonth, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, 1) 
                      AS SystemInitialDayOfFirstPeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod, 16) AS SystemInitialDayOfLastPeriod, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountPreferences.TimesheetPrintFooter, dbo.AccountPreferences.ExpenseSheetPrintFooter, 
                      dbo.AccountPreferences.ShowCompletedProjectsInTimeSheet, dbo.AccountPreferences.ShowProjectForTimeOff, dbo.AccountPreferences.ShowTimeOffInTimesheet, 
                      dbo.AccountEmployee.IsDeleted, dbo.AccountEmployee.IsForcePasswordChange, dbo.AccountEmployee.PasswordChangedDate, 
                      dbo.AccountPreferences.PasswordExpiryPeriod, dbo.AccountPreferences.ShowAllInTimesheetReadOnly, dbo.AccountPreferences.ShowTaskInExpenseSheet, 
                      dbo.AccountPreferences.InvoiceBillingTypeId, dbo.AccountPreferences.ShowBillingRateInInvoiceReport, dbo.SystemInvoiceBillingType.InvoiceBillingType, 
                      dbo.AccountPreferences.InvoiceFooter, dbo.AccountPreferences.TimesheetOverduePeriods, dbo.AccountWorkingDayType.TimesheetOverdueAfterDays, 
                      dbo.AccountEmployee.CreatedOn, dbo.AccountEmployee.CreatedByEmployeeId, dbo.AccountEmployee.ModifiedOn, dbo.AccountEmployee.ModifiedByEmployeeId, 
                      dbo.AccountPreferences.ShowProjectNameInInvoiceReport, dbo.AccountPreferences.ProjectCodePrefix, dbo.AccountPreferences.AutoGenerateProjectCode, 
                      dbo.AccountPreferences.TimeEntryHoursFormatId, dbo.AccountPreferences.ShowPercentageInTimesheet, dbo.AccountPreferences.EnablePasswordComplexity, 
                      dbo.AccountPreferences.ShowClientDepartmentInProject, dbo.AccountPreferences.ShowEntryDateInInvoiceReport, dbo.AccountPreferences.TimesheetSort, 
                      dbo.AccountPreferences.ShowCostCenterInTimesheetBy, ShowCopyTimesheetButton, ShowCopyActivitiesButtonInTimesheet
FROM         dbo.SystemInvoiceBillingType RIGHT OUTER JOIN
                      dbo.AccountPreferences ON dbo.SystemInvoiceBillingType.InvoiceBillingTypeId = dbo.AccountPreferences.InvoiceBillingTypeId RIGHT OUTER JOIN
                      dbo.vueAccountTimesheetPeriodType RIGHT OUTER JOIN
                      dbo.AccountWorkingDayType ON 
                      dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId = dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId RIGHT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.Account ON dbo.AccountEmployee.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId ON 
                      dbo.AccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId ON 
                      dbo.AccountPreferences.AccountId = dbo.AccountEmployee.AccountId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId'

GO
-- Create View vueAccount
Print 'Create View vueAccount'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccount' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccount
AS
SELECT     dbo.Account.AccountId, dbo.Account.AccountTypeId, dbo.Account.AccountName, dbo.Account.Address1, dbo.Account.Address2, dbo.Account.ZipCode, dbo.Account.State, 
                      dbo.Account.City, dbo.Account.CountryId, dbo.Account.EMailAddress, dbo.Account.Telephone, dbo.Account.Fax, dbo.Account.DefaultCurrencyId, 
                      dbo.Account.TimeZoneId, dbo.Account.IsDisabled, dbo.Account.IsDeleted, dbo.Account.StatusId, dbo.Account.CreatedOn, dbo.Account.ModifiedOn, 
                      dbo.Account.ModifiedByEmployeeId, dbo.AccountPreferences.ShowClockStartEnd, dbo.AccountPreferences.AccountPreferencesId, dbo.Account.LicenseKey, 
                      dbo.Account.SystemPackageTypeId, dbo.AccountPreferences.TimeEntryFormat, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.Account.MachineId, dbo.Account.ActivationLicenseKey, dbo.Account.ActivationMachineKey, 
                      dbo.Account.ActivationType, dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountPreferences.InvoiceBillingTypeId, 
                      dbo.AccountPreferences.ShowBillingRateInInvoiceReport, dbo.AccountPreferences.InvoiceFooter, dbo.AccountPreferences.ShowProjectNameInInvoiceReport, 
                      dbo.AccountPreferences.ProjectCodePrefix, dbo.AccountPreferences.AutoGenerateProjectCode, dbo.AccountPreferences.TimeEntryHoursFormatId, 
                      dbo.AccountPreferences.ShowPercentageInTimesheet, dbo.AccountPreferences.EnablePasswordComplexity, dbo.AccountPreferences.ShowClientDepartmentInProject, 
                      dbo.AccountPreferences.ShowEntryDateInInvoiceReport, dbo.AccountPreferences.TimesheetSort, dbo.AccountPreferences.ShowCostCenterInTimesheetBy,
					  dbo.AccountPreferences.ShowCopyTimesheetButton, dbo.AccountPreferences.ShowCopyActivitiesButtonInTimesheet	
FROM         dbo.Account INNER JOIN
                      dbo.AccountPreferences ON dbo.Account.AccountId = dbo.AccountPreferences.AccountId'
GO

-- Drop Procedure sp_UpdateTimeEntry
Print 'Drop Procedure sp_UpdateTimeEntry'
GO
DROP PROCEDURE [dbo].[sp_UpdateTimeEntry]
GO
-- Drop View vueAccountEmployeeTimeEntryWithStatus
Print 'Drop View vueAccountEmployeeTimeEntryWithStatus'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithStatus' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryWithStatus]
GO
-- Drop View vueAccountEmployeeTimeEntryWithLastStatus
Print 'Drop View vueAccountEmployeeTimeEntryWithLastStatus'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithLastStatus' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryWithLastStatus]
GO
-- Add Column CustomField1 to AccountEmployeeTimeEntry
Print 'Add Column CustomField1 to AccountEmployeeTimeEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntry' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField1' AND TABLE_NAME='AccountEmployeeTimeEntry'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntry]
	ADD [CustomField1] nvarchar(2000) NULL
GO
-- Add Column CustomField2 to AccountEmployeeTimeEntry
Print 'Add Column CustomField2 to AccountEmployeeTimeEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntry' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField2' AND TABLE_NAME='AccountEmployeeTimeEntry'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntry]
	ADD [CustomField2] nvarchar(2000) NULL
GO
-- Add Column CustomField3 to AccountEmployeeTimeEntry
Print 'Add Column CustomField3 to AccountEmployeeTimeEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntry' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField3' AND TABLE_NAME='AccountEmployeeTimeEntry'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntry]
	ADD [CustomField3] nvarchar(2000) NULL
GO
-- Add Column CustomField4 to AccountEmployeeTimeEntry
Print 'Add Column CustomField4 to AccountEmployeeTimeEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntry' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField4' AND TABLE_NAME='AccountEmployeeTimeEntry'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntry]
	ADD [CustomField4] nvarchar(2000) NULL
GO
-- Add Column CustomField5 to AccountEmployeeTimeEntry
Print 'Add Column CustomField5 to AccountEmployeeTimeEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntry' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField5' AND TABLE_NAME='AccountEmployeeTimeEntry'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntry]
	ADD [CustomField5] nvarchar(2000) NULL
GO
-- Add Column CustomField6 to AccountEmployeeTimeEntry
Print 'Add Column CustomField6 to AccountEmployeeTimeEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntry' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField6' AND TABLE_NAME='AccountEmployeeTimeEntry'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntry]
	ADD [CustomField6] nvarchar(2000) NULL
GO
-- Add Column CustomField7 to AccountEmployeeTimeEntry
Print 'Add Column CustomField7 to AccountEmployeeTimeEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntry' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField7' AND TABLE_NAME='AccountEmployeeTimeEntry'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntry]
	ADD [CustomField7] nvarchar(2000) NULL
GO
-- Add Column CustomField8 to AccountEmployeeTimeEntry
Print 'Add Column CustomField8 to AccountEmployeeTimeEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntry' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField8' AND TABLE_NAME='AccountEmployeeTimeEntry'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntry]
	ADD [CustomField8] nvarchar(2000) NULL
GO
-- Add Column CustomField9 to AccountEmployeeTimeEntry
Print 'Add Column CustomField9 to AccountEmployeeTimeEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntry' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField9' AND TABLE_NAME='AccountEmployeeTimeEntry'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntry]
	ADD [CustomField9] nvarchar(2000) NULL
GO
-- Add Column CustomField10 to AccountEmployeeTimeEntry
Print 'Add Column CustomField10 to AccountEmployeeTimeEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntry' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField10' AND TABLE_NAME='AccountEmployeeTimeEntry'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntry]
	ADD [CustomField10] nvarchar(2000) NULL
GO
-- Add Column CustomField11 to AccountEmployeeTimeEntry
Print 'Add Column CustomField11 to AccountEmployeeTimeEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntry' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField11' AND TABLE_NAME='AccountEmployeeTimeEntry'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntry]
	ADD [CustomField11] nvarchar(2000) NULL
GO
-- Add Column CustomField12 to AccountEmployeeTimeEntry
Print 'Add Column CustomField12 to AccountEmployeeTimeEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntry' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField12' AND TABLE_NAME='AccountEmployeeTimeEntry'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntry]
	ADD [CustomField12] nvarchar(2000) NULL
GO
-- Add Column CustomField13 to AccountEmployeeTimeEntry
Print 'Add Column CustomField13 to AccountEmployeeTimeEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntry' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField13' AND TABLE_NAME='AccountEmployeeTimeEntry'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntry]
	ADD [CustomField13] nvarchar(2000) NULL
GO
-- Add Column CustomField14 to AccountEmployeeTimeEntry
Print 'Add Column CustomField14 to AccountEmployeeTimeEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntry' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField14' AND TABLE_NAME='AccountEmployeeTimeEntry'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntry]
	ADD [CustomField14] nvarchar(2000) NULL
GO
-- Add Column CustomField15 to AccountEmployeeTimeEntry
Print 'Add Column CustomField15 to AccountEmployeeTimeEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntry' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField15' AND TABLE_NAME='AccountEmployeeTimeEntry'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntry]
	ADD [CustomField15] nvarchar(2000) NULL
GO
-- Create View vueAccountEmployeeTimeEntryWithLastStatus
Print 'Create View vueAccountEmployeeTimeEntryWithLastStatus'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithLastStatus' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryWithLastStatus
AS
SELECT     dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, dbo.AccountEmployeeTimeEntry.AccountEmployeeId, dbo.AccountEmployeeTimeEntry.TimeEntryDate, 
                      dbo.AccountEmployeeTimeEntry.StartTime, dbo.AccountEmployeeTimeEntry.EndTime, dbo.AccountEmployeeTimeEntry.TotalTime, 
                      dbo.AccountEmployeeTimeEntry.AccountProjectId, dbo.AccountEmployeeTimeEntry.AccountProjectTaskId, dbo.AccountEmployeeTimeEntry.Description, 
                      dbo.AccountEmployeeTimeEntry.TimeSheetApprovalPathId, dbo.AccountEmployeeTimeEntry.Approved, dbo.AccountEmployeeTimeEntry.TeamLeadApproved, 
                      dbo.AccountEmployeeTimeEntry.ProjectManagerApproved, dbo.AccountEmployeeTimeEntry.AdministratorApproved, dbo.AccountEmployeeTimeEntry.CreatedOn, 
                      dbo.AccountEmployeeTimeEntry.ModifiedOn, dbo.AccountEmployeeTimeEntry.Rejected, dbo.AccountEmployeeTimeEntry.BillingRate, 
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction.IsApproved, dbo.vueAccountEmployeeTimeEntryApprovalLastAction.IsReject, 
                      dbo.AccountEmployeeTimeEntry.AccountPartyId, dbo.AccountEmployeeTimeEntry.Submitted, dbo.AccountEmployeeTimeEntry.AccountWorkTypeId, 
                      dbo.AccountEmployeeTimeEntry.AccountCostCenterId, dbo.vueAccountEmployeeTimeEntryApprovalLastAction.ApprovedByEmployeeId, 
                      dbo.AccountProject.ProjectName, dbo.AccountProjectTask.TaskName, dbo.AccountCostCenter.AccountCostCenter, dbo.AccountWorkType.AccountWorkType, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId, dbo.AccountParty.PartyName, dbo.AccountParty.AccountPartyId AS AccountClientId, 
                      dbo.AccountParty.PartyNick, dbo.vueAccountEmployeeTimeEntryApprovalLastAction.ApprovedOn, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId, dbo.AccountEmployeeTimeEntry.IsTimeOff, dbo.AccountEmployeeTimeEntry.Hours, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeOffRequestId, 
                      dbo.AccountEmployeeTimeEntry.Percentage, dbo.AccountEmployeeTimeEntry.CustomField1, dbo.AccountEmployeeTimeEntry.CustomField2, 
                      dbo.AccountEmployeeTimeEntry.CustomField3, dbo.AccountEmployeeTimeEntry.CustomField4, dbo.AccountEmployeeTimeEntry.CustomField5, 
                      dbo.AccountEmployeeTimeEntry.CustomField6, dbo.AccountEmployeeTimeEntry.CustomField7, dbo.AccountEmployeeTimeEntry.CustomField8, 
                      dbo.AccountEmployeeTimeEntry.CustomField9, dbo.AccountEmployeeTimeEntry.CustomField10, dbo.AccountEmployeeTimeEntry.CustomField11, 
                      dbo.AccountEmployeeTimeEntry.CustomField12, dbo.AccountEmployeeTimeEntry.CustomField13, dbo.AccountEmployeeTimeEntry.CustomField14, 
                      dbo.AccountEmployeeTimeEntry.CustomField15
FROM         dbo.AccountParty INNER JOIN
                      dbo.AccountProject ON dbo.AccountParty.AccountPartyId = dbo.AccountProject.AccountClientId RIGHT OUTER JOIN
                      dbo.AccountEmployeeTimeEntry LEFT OUTER JOIN
                      dbo.AccountWorkType ON dbo.AccountEmployeeTimeEntry.AccountWorkTypeId = dbo.AccountWorkType.AccountWorkTypeId ON 
                      dbo.AccountProject.AccountProjectId = dbo.AccountEmployeeTimeEntry.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountProjectTask ON dbo.AccountEmployeeTimeEntry.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId LEFT OUTER JOIN
                      dbo.AccountCostCenter ON dbo.AccountEmployeeTimeEntry.AccountCostCenterId = dbo.AccountCostCenter.AccountCostCenterId LEFT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryApprovalLastAction.AccountEmployeeTimeEntryId'
GO
-- Create View vueAccountEmployeeTimeEntryWithStatus
Print 'Create View vueAccountEmployeeTimeEntryWithStatus'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithStatus' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryWithStatus
AS
SELECT     dbo.AccountCostCenter.AccountCostCenter, dbo.AccountProject.ProjectName, dbo.AccountWorkType.AccountWorkType, dbo.AccountProjectTask.TaskName, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, dbo.AccountEmployeeTimeEntry.AccountEmployeeId, dbo.AccountEmployeeTimeEntry.TimeEntryDate, 
                      dbo.AccountEmployeeTimeEntry.StartTime, dbo.AccountEmployeeTimeEntry.EndTime, dbo.AccountEmployeeTimeEntry.TotalTime, 
                      dbo.AccountEmployeeTimeEntry.AccountProjectId, dbo.AccountEmployeeTimeEntry.AccountProjectTaskId, dbo.AccountEmployeeTimeEntry.Description, 
                      dbo.AccountEmployeeTimeEntry.TimeSheetApprovalPathId, dbo.AccountEmployeeTimeEntry.Approved, dbo.AccountEmployeeTimeEntry.TeamLeadApproved, 
                      dbo.AccountEmployeeTimeEntry.ProjectManagerApproved, dbo.AccountEmployeeTimeEntry.AdministratorApproved, dbo.AccountEmployeeTimeEntry.CreatedOn, 
                      dbo.AccountEmployeeTimeEntry.ModifiedOn, dbo.AccountEmployeeTimeEntry.Rejected, dbo.AccountEmployeeTimeEntry.BillingRate, 
                      dbo.AccountEmployeeTimeEntry.AccountPartyId, dbo.AccountEmployeeTimeEntry.Submitted, dbo.AccountEmployeeTimeEntry.AccountWorkTypeId, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRate, dbo.AccountEmployeeTimeEntry.AccountCostCenterId, dbo.AccountEmployeeTimeEntry.BillingRateCurrencyId, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateCurrencyId, dbo.AccountEmployeeTimeEntry.BillingRateExchangeRate, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateExchangeRate, dbo.AccountEmployeeTimeEntry.AccountBaseCurrencyId, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeExpenseBillingTimesheetId, dbo.AccountEmployeeTimeEntry.Billed, 
                      dbo.AccountEmployeeTimeEntryApprovalProject.InApproval AS IsApproved, dbo.AccountEmployeeTimeEntryApprovalProject.IsRejected AS IsReject, 
                      dbo.AccountParty.PartyName, dbo.AccountParty.PartyNick, dbo.AccountParty.AccountPartyId AS AccountClientId, 
                      dbo.AccountEmployeeTimeEntryPeriod.PeriodDescription, dbo.AccountParty.AccountId, dbo.AccountEmployeeTimeEntry.IsTimeOff, 
                      dbo.AccountEmployeeTimeEntry.Hours, dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeOffRequestId, 
                      dbo.AccountTimeOffType.AccountTimeOffType, dbo.AccountTimeOffType.IsTimeOffRequestRequired, 
                      dbo.AccountEmployeeTimeEntryApprovalProject.Approved AS ProjectApproved, dbo.AccountEmployeeTimeEntry.Percentage, 
                      dbo.AccountEmployeeTimeEntry.CustomField1, dbo.AccountEmployeeTimeEntry.CustomField2, dbo.AccountEmployeeTimeEntry.CustomField3, 
                      dbo.AccountEmployeeTimeEntry.CustomField4, dbo.AccountEmployeeTimeEntry.CustomField5, dbo.AccountEmployeeTimeEntry.CustomField6, 
                      dbo.AccountEmployeeTimeEntry.CustomField7, dbo.AccountEmployeeTimeEntry.CustomField8, dbo.AccountEmployeeTimeEntry.CustomField9, 
                      dbo.AccountEmployeeTimeEntry.CustomField10, dbo.AccountEmployeeTimeEntry.CustomField11, dbo.AccountEmployeeTimeEntry.CustomField12, 
                      dbo.AccountEmployeeTimeEntry.CustomField13, dbo.AccountEmployeeTimeEntry.CustomField14, dbo.AccountEmployeeTimeEntry.CustomField15
FROM         dbo.AccountEmployeeTimeEntryPeriod RIGHT OUTER JOIN
                      dbo.AccountEmployeeTimeEntry LEFT OUTER JOIN
                      dbo.AccountTimeOffType ON dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId ON 
                      dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryApprovalProject ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId = dbo.AccountEmployeeTimeEntryApprovalProject.AccountEmployeeTimeEntryApprovalProjectId
                       LEFT OUTER JOIN
                      dbo.AccountParty INNER JOIN
                      dbo.AccountProject ON dbo.AccountParty.AccountPartyId = dbo.AccountProject.AccountClientId ON 
                      dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountProjectTask ON dbo.AccountEmployeeTimeEntry.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId LEFT OUTER JOIN
                      dbo.AccountWorkType ON dbo.AccountEmployeeTimeEntry.AccountWorkTypeId = dbo.AccountWorkType.AccountWorkTypeId LEFT OUTER JOIN
                      dbo.AccountCostCenter ON dbo.AccountEmployeeTimeEntry.AccountCostCenterId = dbo.AccountCostCenter.AccountCostCenterId'
GO
-- Create Procedure sp_UpdateTimeEntry
Print 'Create Procedure sp_UpdateTimeEntry'
GO
CREATE PROCEDURE [dbo].[sp_UpdateTimeEntry]
		   (@AccountEmployeeId int,
           @TimeEntryDate datetime,
           @StartTime datetime,
           @EndTime datetime,
           @TotalTime datetime,
           @AccountProjectId int,
           @AccountProjectTaskId bigint,
           @Description nvarchar(1000),
           @Approved bit,
           @Rejected bit,
           @BillingRate money,
           @Submitted bit,
           @AccountWorkTypeId int,
           @EmployeeRate money,
           @AccountCostCenterId int,
           @BillingRateCurrencyId int,
           @EmployeeRateCurrencyId int,
           @BillingRateExchangeRate float,
           @EmployeeRateExchangeRate float,
           @AccountBaseCurrencyId int,
           @AccountEmployeeTimeEntryPeriodId uniqueidentifier,
           @AccountEmployeeTimeEntryApprovalProjectId uniqueidentifier,
           @ModifiedByEmployeeId int,
           @IsTimeOff bit,
           @AccountTimeOffTypeId uniqueidentifier,
		   @AccountEmployeeTimeEntryId int,
		   @Percentage float,
		   @Hours decimal(18,2),
		   @CustomField1 nvarchar(2000),
		   @CustomField2 nvarchar(2000),
		   @CustomField3 nvarchar(2000),
		   @CustomField4 nvarchar(2000),
		   @CustomField5 nvarchar(2000),
		   @CustomField6 nvarchar(2000),
		   @CustomField7 nvarchar(2000),
		   @CustomField8 nvarchar(2000),
		   @CustomField9 nvarchar(2000),
		   @CustomField10 nvarchar(2000),
		   @CustomField11 nvarchar(2000),
		   @CustomField12 nvarchar(2000),
		   @CustomField13 nvarchar(2000),
		   @CustomField14 nvarchar(2000),
		   @CustomField15 nvarchar(2000))
AS 
BEGIN
UPDATE AccountEmployeeTimeEntry
   SET [AccountEmployeeId] = @AccountEmployeeId
      ,[TimeEntryDate] = @TimeEntryDate
      ,[StartTime] = @StartTime
      ,[EndTime] = @EndTime
      ,[TotalTime] = @TotalTime
      ,[AccountProjectId] = @AccountProjectId
      ,[AccountProjectTaskId] = @AccountProjectTaskId
      ,[Description] = @Description
      ,[Approved] = @Approved
      ,[Rejected] = @Rejected
      ,[BillingRate] = @BillingRate
      ,[Submitted] = @Submitted
      ,[AccountWorkTypeId] = @AccountWorkTypeId
      ,[EmployeeRate] = @EmployeeRate
      ,[AccountCostCenterId] = @AccountCostCenterId
      ,[BillingRateCurrencyId] = @BillingRateCurrencyId
      ,[EmployeeRateCurrencyId] = @EmployeeRateCurrencyId
      ,[BillingRateExchangeRate] = @BillingRateExchangeRate
      ,[EmployeeRateExchangeRate] = @EmployeeRateExchangeRate
      ,[AccountBaseCurrencyId] = @AccountBaseCurrencyId
      ,[AccountEmployeeTimeEntryPeriodId] = @AccountEmployeeTimeEntryPeriodId
      ,[AccountEmployeeTimeEntryApprovalProjectId] = @AccountEmployeeTimeEntryApprovalProjectId
      ,[ModifiedByEmployeeId] = @ModifiedByEmployeeId
      ,[IsTimeOff] = @IsTimeOff
      ,[AccountTimeOffTypeId] = @AccountTimeOffTypeId
      ,[Percentage] = @Percentage
      ,[Hours] = @Hours
      ,[CustomField1] = @CustomField1
      ,[CustomField2] = @CustomField2
      ,[CustomField3] = @CustomField3
      ,[CustomField4] = @CustomField4
      ,[CustomField5] = @CustomField5
      ,[CustomField6] = @CustomField6
      ,[CustomField7] = @CustomField7
      ,[CustomField8] = @CustomField8
      ,[CustomField9] = @CustomField9
      ,[CustomField10] = @CustomField10
      ,[CustomField11] = @CustomField11
      ,[CustomField12] = @CustomField12
      ,[CustomField13] = @CustomField13
      ,[CustomField14] = @CustomField14
      ,[CustomField15] = @CustomField15
 WHERE [AccountEmployeeTimeEntryId] = @AccountEmployeeTimeEntryId
END
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[MasterEntityType]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[MasterEntityType]'
If Not Exists(Select * from [dbo].[MasterEntityType] Where [MasterEntityTypeId] = '369ed0fb-d317-4244-9f20-b7d834521e2b')
Begin
INSERT INTO [dbo].[MasterEntityType] ([MasterEntityTypeId], [MasterEntityTypeName]) VALUES ('369ed0fb-d317-4244-9f20-b7d834521e2b', N'Timesheet')
INSERT INTO [dbo].[MasterEntityType] ([MasterEntityTypeId], [MasterEntityTypeName]) VALUES ('3601ae9b-3f82-4c80-9574-751f9a124fa8', N'Employee')
INSERT INTO [dbo].[MasterEntityType] ([MasterEntityTypeId], [MasterEntityTypeName]) VALUES ('e448aed9-eab5-4cf7-a171-2a86be2bba9e', N'Client')
INSERT INTO [dbo].[SystemTimeEntryHoursFormat] ([SystemTimeEntryHoursFormatId], [SystemTimeEntryHoursFormat]) VALUES ('ee9cb3b1-e1a1-4346-b9fc-a3da1c92a45e', N'Decimal')

-- =======================================================
-- Synchronization Script for Table: [dbo].[MasterEntityType]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[MasterEntityType]'

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'

INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('2ce33803-bc0f-428f-872f-5aab30caa238', 'd8b6136f-4e25-4323-85be-e3f62fe405b1', N'CustomField10', 100, 0, NULL, NULL, 90, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 10', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('db36560a-ce40-4ba8-be96-be6d52d4bf87', '14428dea-801b-4f8e-b2e3-afa8cb644ac8', N'CustomField7', 100, 0, NULL, NULL, 90, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 7', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('eb146a0a-9ab4-40a0-89b4-9b31b1d5b839', '14428dea-801b-4f8e-b2e3-afa8cb644ac8', N'CustomField9', 100, 0, NULL, NULL, 92, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 9', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('bcd8391c-0d4e-4950-8eee-37e4ca547323', '14428dea-801b-4f8e-b2e3-afa8cb644ac8', N'CustomField4', 100, 0, NULL, NULL, 87, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 4', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('f934f61d-0b42-4983-bce6-5c9d7832ca85', '14428dea-801b-4f8e-b2e3-afa8cb644ac8', N'CustomField6', 100, 0, NULL, NULL, 89, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 6', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('d508701f-eb5e-44f1-9095-d571d9852612', '3a080202-6842-4eca-8c79-a945978810b4', N'CustomField3', 100, 0, NULL, NULL, 183, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 3', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('85114724-a1a6-4936-8df9-304dad562749', '14428dea-801b-4f8e-b2e3-afa8cb644ac8', N'CustomField12', 100, 0, NULL, NULL, 95, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 12', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('1490b533-9ecf-4a00-9684-ab1b1db1235f', 'd8b6136f-4e25-4323-85be-e3f62fe405b1', N'CustomField4', 100, 0, NULL, NULL, 84, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 4', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('205dd039-1027-45ae-b3c1-f24ba8b2ae72', '3a080202-6842-4eca-8c79-a945978810b4', N'CustomField7', 100, 0, NULL, NULL, 187, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 7', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('89e9623b-3cb8-4b3e-aab8-993f08319429', 'd8b6136f-4e25-4323-85be-e3f62fe405b1', N'CustomField8', 100, 0, NULL, NULL, 88, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 8', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('328b163d-4203-4427-85a8-65afef5ed385', '3a080202-6842-4eca-8c79-a945978810b4', N'CustomField8', 100, 0, NULL, NULL, 188, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 8', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('9adb723d-b7c6-43a2-898b-2d19fd3780b0', '3a080202-6842-4eca-8c79-a945978810b4', N'CustomField9', 100, 0, NULL, NULL, 189, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 9', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('981ef840-037d-48bb-93e8-2e8859aebaf4', '3a080202-6842-4eca-8c79-a945978810b4', N'CustomField15', 100, 0, NULL, NULL, 195, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 15', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('34b9e546-d26b-4a39-b0b3-2c6372da4940', '3a080202-6842-4eca-8c79-a945978810b4', N'CustomField6', 100, 0, NULL, NULL, 186, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 6', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('76449d48-17d6-4251-80a8-ec468dfec39c', 'd8b6136f-4e25-4323-85be-e3f62fe405b1', N'CustomField6', 100, 0, NULL, NULL, 86, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 6', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('5ccbc354-d880-450b-af51-0c8daf0d515f', 'd8b6136f-4e25-4323-85be-e3f62fe405b1', N'CustomField12', 100, 0, NULL, NULL, 92, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 12', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('17fe405d-8c51-4709-9f70-54543c6e2b88', 'd8b6136f-4e25-4323-85be-e3f62fe405b1', N'CustomField15', 100, 0, NULL, NULL, 95, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 15', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('24ff735d-df6e-4c5e-a682-df35f394c814', '14428dea-801b-4f8e-b2e3-afa8cb644ac8', N'CustomField10', 100, 0, NULL, NULL, 93, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Cutom Field 10', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('e81d0a60-20e5-4da9-acfc-d014c584b0bd', '3a080202-6842-4eca-8c79-a945978810b4', N'CustomField14', 100, 0, NULL, NULL, 194, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 14', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('8d81386f-6990-47e3-926e-50ec3d8a13b9', '3a080202-6842-4eca-8c79-a945978810b4', N'CustomField11', 102, 0, NULL, NULL, 191, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 11', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('7924777a-96b1-4673-83e5-52b64ed6cc3a', '14428dea-801b-4f8e-b2e3-afa8cb644ac8', N'CustomField11', 100, 0, NULL, NULL, 94, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 11', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('d2303083-5fae-4bfd-90bc-ae3001b0b4b9', '3a080202-6842-4eca-8c79-a945978810b4', N'CustomField10', 101, 0, NULL, NULL, 190, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 10', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('f56d9a84-d4c2-4159-a2c8-5e64cb735364', '3a080202-6842-4eca-8c79-a945978810b4', N'CustomField4', 100, 0, NULL, NULL, 184, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 4', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('8ae5158e-64c0-440c-9f04-98cee39971da', 'd8b6136f-4e25-4323-85be-e3f62fe405b1', N'CustomField13', 100, 0, NULL, NULL, 93, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 13', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('0ee99599-7f52-4644-95af-aa8a7a182ed6', 'd8b6136f-4e25-4323-85be-e3f62fe405b1', N'CustomField11 ', 100, 0, NULL, NULL, 91, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 11', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('49217d9d-6c45-45ec-92d0-ef8d1021e3fb', 'd8b6136f-4e25-4323-85be-e3f62fe405b1', N'CustomField14', 100, 0, NULL, NULL, 94, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 14', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('148113a4-cc85-4d6d-b5a7-6fd5d2021148', '14428dea-801b-4f8e-b2e3-afa8cb644ac8', N'CustomField14', 100, 0, NULL, NULL, 97, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 14', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('e88d93a6-9451-45a4-80ac-1f2c0143b2b6', '14428dea-801b-4f8e-b2e3-afa8cb644ac8', N'CustomField13', 100, 0, NULL, NULL, 96, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 13', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('650e11a7-2cea-410b-b83a-5322523acec2', '14428dea-801b-4f8e-b2e3-afa8cb644ac8', N'CustomField1', 100, 0, NULL, NULL, 84, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 1', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('4a9d59ab-1719-45c1-9409-a6c152261265', '14428dea-801b-4f8e-b2e3-afa8cb644ac8', N'CustomField5', 100, 0, NULL, NULL, 88, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 5', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('a09929b4-d7aa-4513-8718-105434f7182e', '14428dea-801b-4f8e-b2e3-afa8cb644ac8', N'CustomField15', 100, 0, NULL, NULL, 98, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 15', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('4c3e41b7-82b0-41c5-9a18-3399169bcf96', '3a080202-6842-4eca-8c79-a945978810b4', N'CustomField1', 100, 0, NULL, NULL, 181, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 1', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('3f3213be-5a38-4f34-bbff-ba2018e3613e', 'd8b6136f-4e25-4323-85be-e3f62fe405b1', N'CustomField2', 100, 0, NULL, NULL, 82, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 2', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('45d7bcbe-9249-4756-b357-1bd91ccfea56', 'd8b6136f-4e25-4323-85be-e3f62fe405b1', N'CustomField5', 100, 0, NULL, NULL, 85, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 5', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('f16f3cc1-602a-4c41-b1ff-53f8a48df2cc', 'd8b6136f-4e25-4323-85be-e3f62fe405b1', N'CustomField1', 100, 0, NULL, NULL, 81, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 1', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('3c0061c1-3374-4e23-87e0-f32357c6093f', '3a080202-6842-4eca-8c79-a945978810b4', N'CustomField12', 100, 0, NULL, NULL, 192, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 12', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('ca5734c2-b37c-4662-9566-39e980e894af', '14428dea-801b-4f8e-b2e3-afa8cb644ac8', N'CustomField3', 100, 0, NULL, NULL, 86, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 3', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('e4e1ecc9-9835-4a7c-869b-20903765dee3', '14428dea-801b-4f8e-b2e3-afa8cb644ac8', N'CustomField2', 100, 0, NULL, NULL, 85, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 2', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('6b48ecd2-dd95-40ef-9d2d-e1e77c8608de', '3a080202-6842-4eca-8c79-a945978810b4', N'CustomField5', 100, 0, NULL, NULL, 185, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 5', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('ab3586d4-3036-46e4-8d4e-8ab8ade5fcb7', '3a080202-6842-4eca-8c79-a945978810b4', N'CustomField2', 100, 0, NULL, NULL, 182, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 2', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('31bdb7d4-5cdf-4157-a6a9-d04397530cc1', 'd8b6136f-4e25-4323-85be-e3f62fe405b1', N'CustomField7', 100, 0, NULL, NULL, 87, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 7', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('c2951ada-10f6-49be-a6ec-39c8abf54881', 'd8b6136f-4e25-4323-85be-e3f62fe405b1', N'CustomField3', 100, 0, NULL, NULL, 83, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 3', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('05f11be0-a5b8-45dc-9e21-547801b84e76', 'd8b6136f-4e25-4323-85be-e3f62fe405b1', N'CustomField9', 100, 0, NULL, NULL, 89, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 9', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('3d0f6df5-6905-4a7f-a608-65ef845d68b5', '14428dea-801b-4f8e-b2e3-afa8cb644ac8', N'CustomField8', 100, 0, NULL, NULL, 91, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 8', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('3674f4fe-694e-40fa-a5fa-c1ac2789e9a1', '3a080202-6842-4eca-8c79-a945978810b4', N'CustomField13', 100, 0, NULL, NULL, 193, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 13', 0, 0)

End        

GO

-- Drop View vueAccountEmployeeTimeEntryWithTimeOffForReport
Print 'Drop View vueAccountEmployeeTimeEntryWithTimeOffForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithTimeOffForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryWithTimeOffForReport]

GO
-- Drop View rptvueAccountEmployees
Print 'Drop View rptvueAccountEmployees'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployees' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountEmployees]

GO
-- Drop View rptvueAccountClients
Print 'Drop View rptvueAccountClients'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountClients' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountClients]

GO
-- Drop View vueAccountEmployeesForReport
Print 'Drop View vueAccountEmployeesForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeesForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeesForReport]

GO
-- Drop View vueAccountClientForReport
Print 'Drop View vueAccountClientForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountClientForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountClientForReport]

GO
-- Drop View vueAccountEmployeeTimeEntry
Print 'Drop View vueAccountEmployeeTimeEntry'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntry' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntry]

GO
-- Drop View rptvueAccountEmployeeTimeEntry
Print 'Drop View rptvueAccountEmployeeTimeEntry'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeEntry' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountEmployeeTimeEntry]

GO
-- Drop View vueAccountEmployeeTimeEntryForReport
Print 'Drop View vueAccountEmployeeTimeEntryForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryForReport]

GO
-- Add Column CustomField1 to AccountParty
Print 'Add Column CustomField1 to AccountParty'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountParty' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField1' AND TABLE_NAME='AccountParty'))
ALTER TABLE [dbo].[AccountParty]
	ADD [CustomField1] nvarchar(2000) NULL

GO
-- Add Column CustomField2 to AccountParty
Print 'Add Column CustomField2 to AccountParty'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountParty' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField2' AND TABLE_NAME='AccountParty'))
ALTER TABLE [dbo].[AccountParty]
	ADD [CustomField2] nvarchar(2000) NULL

GO
-- Add Column CustomField3 to AccountParty
Print 'Add Column CustomField3 to AccountParty'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountParty' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField3' AND TABLE_NAME='AccountParty'))
ALTER TABLE [dbo].[AccountParty]
	ADD [CustomField3] nvarchar(2000) NULL

GO
-- Add Column CustomField4 to AccountParty
Print 'Add Column CustomField4 to AccountParty'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountParty' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField4' AND TABLE_NAME='AccountParty'))
ALTER TABLE [dbo].[AccountParty]
	ADD [CustomField4] nvarchar(2000) NULL

GO
-- Add Column CustomField5 to AccountParty
Print 'Add Column CustomField5 to AccountParty'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountParty' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField5' AND TABLE_NAME='AccountParty'))
ALTER TABLE [dbo].[AccountParty]
	ADD [CustomField5] nvarchar(2000) NULL

GO
-- Add Column CustomField6 to AccountParty
Print 'Add Column CustomField6 to AccountParty'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountParty' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField6' AND TABLE_NAME='AccountParty'))
ALTER TABLE [dbo].[AccountParty]
	ADD [CustomField6] nvarchar(2000) NULL

GO
-- Add Column CustomField7 to AccountParty
Print 'Add Column CustomField7 to AccountParty'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountParty' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField7' AND TABLE_NAME='AccountParty'))
ALTER TABLE [dbo].[AccountParty]
	ADD [CustomField7] nvarchar(2000) NULL

GO
-- Add Column CustomField8 to AccountParty
Print 'Add Column CustomField8 to AccountParty'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountParty' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField8' AND TABLE_NAME='AccountParty'))
ALTER TABLE [dbo].[AccountParty]
	ADD [CustomField8] nvarchar(2000) NULL

GO
-- Add Column CustomField9 to AccountParty
Print 'Add Column CustomField9 to AccountParty'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountParty' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField9' AND TABLE_NAME='AccountParty'))
ALTER TABLE [dbo].[AccountParty]
	ADD [CustomField9] nvarchar(2000) NULL

GO
-- Add Column CustomField10 to AccountParty
Print 'Add Column CustomField10 to AccountParty'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountParty' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField10' AND TABLE_NAME='AccountParty'))
ALTER TABLE [dbo].[AccountParty]
	ADD [CustomField10] nvarchar(2000) NULL

GO
-- Add Column CustomField11 to AccountParty
Print 'Add Column CustomField11 to AccountParty'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountParty' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField11' AND TABLE_NAME='AccountParty'))
ALTER TABLE [dbo].[AccountParty]
	ADD [CustomField11] nvarchar(2000) NULL

GO
-- Add Column CustomField12 to AccountParty
Print 'Add Column CustomField12 to AccountParty'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountParty' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField12' AND TABLE_NAME='AccountParty'))
ALTER TABLE [dbo].[AccountParty]
	ADD [CustomField12] nvarchar(2000) NULL

GO
-- Add Column CustomField13 to AccountParty
Print 'Add Column CustomField13 to AccountParty'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountParty' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField13' AND TABLE_NAME='AccountParty'))
ALTER TABLE [dbo].[AccountParty]
	ADD [CustomField13] nvarchar(2000) NULL

GO
-- Add Column CustomField14 to AccountParty
Print 'Add Column CustomField14 to AccountParty'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountParty' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField14' AND TABLE_NAME='AccountParty'))
ALTER TABLE [dbo].[AccountParty]
	ADD [CustomField14] nvarchar(2000) NULL

GO
-- Add Column CustomField15 to AccountParty
Print 'Add Column CustomField15 to AccountParty'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountParty' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField15' AND TABLE_NAME='AccountParty'))
ALTER TABLE [dbo].[AccountParty]
	ADD [CustomField15] nvarchar(2000) NULL

GO
-- Add Column CustomField1 to AccountEmployeeTimeEntry
Print 'Add Column CustomField1 to AccountEmployeeTimeEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntry' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField1' AND TABLE_NAME='AccountEmployeeTimeEntry'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntry]
	ADD [CustomField1] nvarchar(2000) NULL

GO
-- Add Column CustomField2 to AccountEmployeeTimeEntry
Print 'Add Column CustomField2 to AccountEmployeeTimeEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntry' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField2' AND TABLE_NAME='AccountEmployeeTimeEntry'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntry]
	ADD [CustomField2] nvarchar(2000) NULL

GO
-- Add Column CustomField3 to AccountEmployeeTimeEntry
Print 'Add Column CustomField3 to AccountEmployeeTimeEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntry' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField3' AND TABLE_NAME='AccountEmployeeTimeEntry'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntry]
	ADD [CustomField3] nvarchar(2000) NULL

GO
-- Add Column CustomField4 to AccountEmployeeTimeEntry
Print 'Add Column CustomField4 to AccountEmployeeTimeEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntry' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField4' AND TABLE_NAME='AccountEmployeeTimeEntry'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntry]
	ADD [CustomField4] nvarchar(2000) NULL

GO
-- Add Column CustomField5 to AccountEmployeeTimeEntry
Print 'Add Column CustomField5 to AccountEmployeeTimeEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntry' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField5' AND TABLE_NAME='AccountEmployeeTimeEntry'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntry]
	ADD [CustomField5] nvarchar(2000) NULL

GO
-- Add Column CustomField6 to AccountEmployeeTimeEntry
Print 'Add Column CustomField6 to AccountEmployeeTimeEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntry' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField6' AND TABLE_NAME='AccountEmployeeTimeEntry'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntry]
	ADD [CustomField6] nvarchar(2000) NULL

GO
-- Add Column CustomField7 to AccountEmployeeTimeEntry
Print 'Add Column CustomField7 to AccountEmployeeTimeEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntry' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField7' AND TABLE_NAME='AccountEmployeeTimeEntry'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntry]
	ADD [CustomField7] nvarchar(2000) NULL

GO
-- Add Column CustomField8 to AccountEmployeeTimeEntry
Print 'Add Column CustomField8 to AccountEmployeeTimeEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntry' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField8' AND TABLE_NAME='AccountEmployeeTimeEntry'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntry]
	ADD [CustomField8] nvarchar(2000) NULL

GO
-- Add Column CustomField9 to AccountEmployeeTimeEntry
Print 'Add Column CustomField9 to AccountEmployeeTimeEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntry' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField9' AND TABLE_NAME='AccountEmployeeTimeEntry'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntry]
	ADD [CustomField9] nvarchar(2000) NULL

GO
-- Add Column CustomField10 to AccountEmployeeTimeEntry
Print 'Add Column CustomField10 to AccountEmployeeTimeEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntry' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField10' AND TABLE_NAME='AccountEmployeeTimeEntry'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntry]
	ADD [CustomField10] nvarchar(2000) NULL

GO
-- Add Column CustomField11 to AccountEmployeeTimeEntry
Print 'Add Column CustomField11 to AccountEmployeeTimeEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntry' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField11' AND TABLE_NAME='AccountEmployeeTimeEntry'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntry]
	ADD [CustomField11] nvarchar(2000) NULL

GO
-- Add Column CustomField12 to AccountEmployeeTimeEntry
Print 'Add Column CustomField12 to AccountEmployeeTimeEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntry' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField12' AND TABLE_NAME='AccountEmployeeTimeEntry'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntry]
	ADD [CustomField12] nvarchar(2000) NULL

GO
-- Add Column CustomField13 to AccountEmployeeTimeEntry
Print 'Add Column CustomField13 to AccountEmployeeTimeEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntry' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField13' AND TABLE_NAME='AccountEmployeeTimeEntry'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntry]
	ADD [CustomField13] nvarchar(2000) NULL

GO
-- Add Column CustomField14 to AccountEmployeeTimeEntry
Print 'Add Column CustomField14 to AccountEmployeeTimeEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntry' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField14' AND TABLE_NAME='AccountEmployeeTimeEntry'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntry]
	ADD [CustomField14] nvarchar(2000) NULL

GO
-- Add Column CustomField15 to AccountEmployeeTimeEntry
Print 'Add Column CustomField15 to AccountEmployeeTimeEntry'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeTimeEntry' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField15' AND TABLE_NAME='AccountEmployeeTimeEntry'))
ALTER TABLE [dbo].[AccountEmployeeTimeEntry]
	ADD [CustomField15] nvarchar(2000) NULL

GO
-- Add Column CustomField1 to AccountEmployee
Print 'Add Column CustomField1 to AccountEmployee'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployee' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField1' AND TABLE_NAME='AccountEmployee'))
ALTER TABLE [dbo].[AccountEmployee]
	ADD [CustomField1] nvarchar(2000) NULL

GO
-- Add Column CustomField2 to AccountEmployee
Print 'Add Column CustomField2 to AccountEmployee'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployee' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField2' AND TABLE_NAME='AccountEmployee'))
ALTER TABLE [dbo].[AccountEmployee]
	ADD [CustomField2] nvarchar(2000) NULL

GO
-- Add Column CustomField3 to AccountEmployee
Print 'Add Column CustomField3 to AccountEmployee'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployee' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField3' AND TABLE_NAME='AccountEmployee'))
ALTER TABLE [dbo].[AccountEmployee]
	ADD [CustomField3] nvarchar(2000) NULL

GO
-- Add Column CustomField4 to AccountEmployee
Print 'Add Column CustomField4 to AccountEmployee'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployee' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField4' AND TABLE_NAME='AccountEmployee'))
ALTER TABLE [dbo].[AccountEmployee]
	ADD [CustomField4] nvarchar(2000) NULL

GO
-- Add Column CustomField5 to AccountEmployee
Print 'Add Column CustomField5 to AccountEmployee'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployee' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField5' AND TABLE_NAME='AccountEmployee'))
ALTER TABLE [dbo].[AccountEmployee]
	ADD [CustomField5] nvarchar(2000) NULL

GO
-- Add Column CustomField6 to AccountEmployee
Print 'Add Column CustomField6 to AccountEmployee'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployee' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField6' AND TABLE_NAME='AccountEmployee'))
ALTER TABLE [dbo].[AccountEmployee]
	ADD [CustomField6] nvarchar(2000) NULL

GO
-- Add Column CustomField7 to AccountEmployee
Print 'Add Column CustomField7 to AccountEmployee'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployee' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField7' AND TABLE_NAME='AccountEmployee'))
ALTER TABLE [dbo].[AccountEmployee]
	ADD [CustomField7] nvarchar(2000) NULL

GO
-- Add Column CustomField8 to AccountEmployee
Print 'Add Column CustomField8 to AccountEmployee'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployee' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField8' AND TABLE_NAME='AccountEmployee'))
ALTER TABLE [dbo].[AccountEmployee]
	ADD [CustomField8] nvarchar(2000) NULL


GO
-- Add Column CustomField9 to AccountEmployee
Print 'Add Column CustomField9 to AccountEmployee'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployee' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField9' AND TABLE_NAME='AccountEmployee'))
ALTER TABLE [dbo].[AccountEmployee]
	ADD [CustomField9] nvarchar(2000) NULL

GO
-- Add Column CustomField10 to AccountEmployee
Print 'Add Column CustomField10 to AccountEmployee'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployee' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField10' AND TABLE_NAME='AccountEmployee'))
ALTER TABLE [dbo].[AccountEmployee]
	ADD [CustomField10] nvarchar(2000) NULL

GO
-- Add Column CustomField11 to AccountEmployee
Print 'Add Column CustomField11 to AccountEmployee'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployee' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField11' AND TABLE_NAME='AccountEmployee'))
ALTER TABLE [dbo].[AccountEmployee]
	ADD [CustomField11] nvarchar(2000) NULL

GO
-- Add Column CustomField12 to AccountEmployee
Print 'Add Column CustomField12 to AccountEmployee'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployee' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField12' AND TABLE_NAME='AccountEmployee'))
ALTER TABLE [dbo].[AccountEmployee]
	ADD [CustomField12] nvarchar(2000) NULL

GO
-- Add Column CustomField13 to AccountEmployee
Print 'Add Column CustomField13 to AccountEmployee'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployee' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField13' AND TABLE_NAME='AccountEmployee'))
ALTER TABLE [dbo].[AccountEmployee]
	ADD [CustomField13] nvarchar(2000) NULL

GO
-- Add Column CustomField14 to AccountEmployee
Print 'Add Column CustomField14 to AccountEmployee'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployee' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField14' AND TABLE_NAME='AccountEmployee'))
ALTER TABLE [dbo].[AccountEmployee]
	ADD [CustomField14] nvarchar(2000) NULL

GO
-- Add Column CustomField15 to AccountEmployee
Print 'Add Column CustomField15 to AccountEmployee'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployee' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField15' AND TABLE_NAME='AccountEmployee'))
ALTER TABLE [dbo].[AccountEmployee]
	ADD [CustomField15] nvarchar(2000) NULL

GO
-- Create View vueAccountEmployeeTimeEntryWithTimeOffForReport
Print 'Create View vueAccountEmployeeTimeEntryWithTimeOffForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithTimeOffForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport
AS
SELECT     CASE WHEN dbo.AccountEmployee.IsDisabled = 1 THEN dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE dbo.AccountEmployee.FirstName
                       + '' '' + dbo.AccountEmployee.LastName END AS EmployeeName, dbo.AccountProject.ProjectName, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 1 THEN AccountProjectTask_1.TaskName ELSE dbo.AccountTimeOffType.AccountTimeOffType END AS TaskName,
                       dbo.AccountEmployeeTimeEntry.TotalTime, dbo.AccountEmployeeTimeEntry.Approved, dbo.AccountEmployee.AccountEmployeeId, 
                      dbo.AccountProject.AccountProjectId, dbo.AccountEmployeeTimeEntry.TeamLeadApproved, dbo.AccountEmployeeTimeEntry.ProjectManagerApproved, 
                      dbo.AccountEmployeeTimeEntry.AdministratorApproved, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, dbo.AccountEmployeeTimeEntry.StartTime, 
                      dbo.AccountEmployeeTimeEntry.EndTime, dbo.AccountEmployeeTimeEntry.TimeEntryDate, dbo.AccountEmployeeTimeEntry.Description, 
                      ISNULL(dbo.AccountProject.AccountId, dbo.AccountTimeOffType.AccountId) AS AccountId, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime) AS TotalMinutes, DATEPART(dw, dbo.AccountEmployeeTimeEntry.TimeEntryDate) AS WeekDay, 
                      dbo.AccountParty.AccountPartyId, dbo.AccountParty.PartyName, AccountProjectTask_1.AccountProjectTaskId, dbo.AccountBillingType.BillingType, 
                      dbo.AccountProject.LeaderEmployeeId, dbo.AccountProject.ProjectManagerEmployeeId, dbo.AccountProject.TimeSheetApprovalTypeId, 
                      dbo.AccountProject.ExpenseApprovalTypeId, AccountProjectTask_1.IsBillable, dbo.AccountEmployeeTimeEntry.Rejected, dbo.AccountEmployeeTimeEntry.BillingRate, 
                      dbo.AccountProject.ProjectBillingRateTypeId, dbo.AccountEmployee.EmployeeCode, dbo.AccountEmployee.AccountDepartmentId, 
                      dbo.AccountDepartment.DepartmentName, AccountProjectTask_1.EstimatedCost, AccountProjectTask_1.EstimatedTimeSpent, 
                      dbo.AccountEmployeeTimeEntry.Submitted, dbo.AccountWorkType.AccountWorkType, dbo.AccountEmployee.EMailAddress, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountCostCenter.AccountCostCenter, dbo.AccountCostCenter.AccountCostCenterCode, dbo.AccountWorkType.AccountWorkTypeCode, 
                      dbo.AccountProject.ProjectCode, AccountProjectTask_1.TaskCode, dbo.AccountLocation.AccountLocationId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction.Comments, dbo.AccountEmployeeTimeEntry.BillingRateCurrencyId, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateCurrencyId, dbo.AccountEmployeeTimeEntry.BillingRateExchangeRate, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateExchangeRate, dbo.AccountEmployeeTimeEntry.AccountBaseCurrencyId, AccountProjectTask_1.AccountTaskTypeId, 
                      AccountProjectTask_1.TaskStatusId, AccountProjectTask_1.AccountPriorityId, AccountProjectTask_1.AccountProjectMilestoneId, 
                      dbo.AccountDepartment.DepartmentCode, dbo.AccountParty.PartyNick, AccountProjectTask_1.EstimatedCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction.ApprovedOn, dbo.AccountEmployeeTimeEntry.EmployeeRate, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountRole.Role, dbo.AccountProject.AccountProjectTypeId, dbo.AccountProject.ProjectDescription, AccountProjectTask_1.TaskDescription, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeExpenseBillingTimesheetId, dbo.AccountEmployeeTimeEntry.Billed, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Submitted = 1 THEN (CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, 
                      dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS SubmittedHours, CASE WHEN dbo.AccountEmployeeTimeEntry.Approved = 1 THEN (CONVERT(float, 
                      DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS ApprovedHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Rejected = 1 THEN (CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, 
                      dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS RejectedHours, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, 
                      dbo.AccountPartyContact.FirstName + N'' '' + dbo.AccountPartyContact.LastName AS ClientContactName, 
                      dbo.AccountPartyDepartment.PartyDepartmentCode AS ClientDepartmentCode, dbo.AccountPartyDepartment.PartyDepartmentName AS ClientDepartmentName, 
                      dbo.AccountPartyDepartment.PartyDepartmentLocation AS ClientDepartmentLocation, dbo.AccountEmployeeTimeEntry.IsTimeOff, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId, CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 0 THEN (CONVERT(float, DATEPART(hh, 
                      dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS TimeOffHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 1 THEN (CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, 
                      dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS TimesheetHours, dbo.AccountWorkType.AccountWorkTypeId, dbo.AccountStatus.Status AS ProjectStatus, 
                      AccountProjectTask_1.ParentAccountProjectTaskId, dbo.AccountProjectTask.TaskName AS ParentTaskName, dbo.AccountEmployee.IsDisabled, 
                      dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, ISNULL(dbo.AccountEmployeeType.AccountEmployeeType, N'''') AS EmployeeType, 
                      ISNULL(dbo.AccountHolidayTypeDetail.HolidayName, N'''') AS HolidayName, dbo.AccountEmployeeTimeEntry.Percentage, 
                      dbo.AccountEmployeeTimeEntry.CustomField1, dbo.AccountEmployeeTimeEntry.CustomField2, dbo.AccountEmployeeTimeEntry.CustomField3, 
                      dbo.AccountEmployeeTimeEntry.CustomField4, dbo.AccountEmployeeTimeEntry.CustomField5, dbo.AccountEmployeeTimeEntry.CustomField6, 
                      dbo.AccountEmployeeTimeEntry.CustomField7, dbo.AccountEmployeeTimeEntry.CustomField8, dbo.AccountEmployeeTimeEntry.CustomField9, 
                      dbo.AccountEmployeeTimeEntry.CustomField10, dbo.AccountEmployeeTimeEntry.CustomField11, dbo.AccountEmployeeTimeEntry.CustomField12, 
                      dbo.AccountEmployeeTimeEntry.CustomField13, dbo.AccountEmployeeTimeEntry.CustomField14, dbo.AccountEmployeeTimeEntry.CustomField15
FROM         dbo.AccountHolidayTypeDetail RIGHT OUTER JOIN
                      dbo.AccountEmployeeTimeEntry INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeEntry.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId ON 
                      dbo.AccountHolidayTypeDetail.AccountHolidayTypeId = dbo.AccountEmployee.AccountHolidayTypeId AND 
                      dbo.AccountHolidayTypeDetail.AccountId = dbo.AccountEmployee.AccountId AND 
                      dbo.AccountHolidayTypeDetail.HolidayDate = dbo.AccountEmployeeTimeEntry.TimeEntryDate LEFT OUTER JOIN
                      dbo.AccountEmployeeType ON dbo.AccountEmployee.EmployeePayTypeId = dbo.AccountEmployeeType.AccountEmployeeTypeId LEFT OUTER JOIN
                      dbo.AccountProjectTask AS AccountProjectTask_1 LEFT OUTER JOIN
                      dbo.AccountProjectTask ON AccountProjectTask_1.ParentAccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId ON 
                      dbo.AccountEmployeeTimeEntry.AccountProjectTaskId = AccountProjectTask_1.AccountProjectTaskId LEFT OUTER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountStatus ON dbo.AccountProject.ProjectStatusId = dbo.AccountStatus.AccountStatusId LEFT OUTER JOIN
                      dbo.AccountTimeOffType ON dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId LEFT OUTER JOIN
                      dbo.AccountPartyDepartment ON dbo.AccountProject.AccountPartyDepartmentId = dbo.AccountPartyDepartment.AccountPartyDepartmentId LEFT OUTER JOIN
                      dbo.AccountPartyContact ON dbo.AccountProject.AccountPartyContactId = dbo.AccountPartyContact.AccountPartyContactId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryPeriod ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId LEFT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryApprovalLastAction.AccountEmployeeTimeEntryId LEFT OUTER JOIN
                      dbo.AccountCostCenter ON dbo.AccountEmployeeTimeEntry.AccountCostCenterId = dbo.AccountCostCenter.AccountCostCenterId LEFT OUTER JOIN
                      dbo.AccountWorkType ON dbo.AccountEmployeeTimeEntry.AccountWorkTypeId = dbo.AccountWorkType.AccountWorkTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId LEFT OUTER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId'
                      
GO
-- Create View vueAccountEmployeeTimeEntryForReport
Print 'Create View vueAccountEmployeeTimeEntryForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryForReport
AS
SELECT     dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeName, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskName, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalTime, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Approved, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TeamLeadApproved, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectManagerApproved, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AdministratorApproved, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeTimeEntryId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.StartTime, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EndTime, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Description, N'''') AS Description, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.WeekDay, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountPartyId AS AccountClientId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.PartyName AS ClientName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectTaskId, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingType, N'''') 
                      AS BillingType, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectManagerEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ExpenseApprovalTypeId, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.IsBillable, 0) 
                      AS IsBillable, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Rejected, 0) AS Rejected, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRate, 0) AS BillingRate, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectBillingRateTypeId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeCode, N'''') AS EmployeeCode, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountDepartmentId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.DepartmentName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedCost, 0) AS EstimatedCost, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedTimeSpent, 0) AS EstimatedHours, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Submitted, 0) AS Submitted, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountWorkType, N'''') AS AccountWorkType, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EMailAddress, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountLocation, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountCostCenter, N'''') AS AccountCostCenter, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountCostCenterCode, N'''') AS AccountCostCenterCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountWorkTypeCode, N'''') AS AccountWorkTypeCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectCode, N'''') AS ProjectCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCode, N'''') AS TaskCode, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountLocationId, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Comments, N'''') 
                      AS ApproverComments, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes * dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRate / 60, 0) 
                      AS Amount, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRateCurrencyId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateExchangeRate, 0) AS BillingRateExchangeRate, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRateExchangeRate, 0) AS EmployeeRateExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountBaseCurrencyId, dbo.vueAccountCurrency.CurrencyCode AS BillingRateCurrencyCode, 
                      dbo.vueAccountCurrency.CurrencyCode AS AmountCurrencyCode, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountTaskTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskStatusId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountPriorityId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectMilestoneId, dbo.AccountTaskType.TaskType, dbo.AccountStatus.Status AS TaskStatus, 
                      dbo.AccountProjectMilestone.MilestoneDescription, dbo.AccountPriority.Priority, CONVERT(float, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes) / 60 AS TotalHours, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.DepartmentCode, N'''') AS DepartmentCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.PartyNick, N'''') AS ClientNick, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedCurrencyId, vueAccountCurrency_1.CurrencyCode AS EstimatedCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ApprovedOn, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRate, 0) 
                      AS EmployeeRate, vueAccountCurrency_2.CurrencyCode AS EmployeeRateCurrencyCode, 
                      AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName AS TeamLeader, 
                      AccountEmployee_2.FirstName + '' '' + AccountEmployee_2.LastName AS ProjectManager, 
                      ISNULL(dbo.AccountEmployee.FirstName + N'' '' + dbo.AccountEmployee.LastName, N'''') AS EmployeeManager, 
                      vueAccountCurrency_1.ExchangeRate AS EstimatedCurrencyExchangeRate, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes * dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRate / 60, 0) 
                      AS EmployeeCost, { fn DAYOFMONTH(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) } AS DayNo, 
                      MONTH(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) AS MonthNo, DATEPART(week, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) - DATEPART(week, DATEADD(month, DATEDIFF(month, 0, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate), 0)) + 1 AS WeekNo, 
                      YEAR(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) AS Year, 
                      LEFT({ fn MONTHNAME(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) }, 3) + '' - '' + CONVERT(nvarchar(10), 
                      YEAR(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate)) AS Period, 
                      { fn DAYNAME(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) } AS WeekDayName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountRoleId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Role, 
                      dbo.AccountProjectType.ProjectType, dbo.AccountRole.Role AS ProjectRole, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectDescription, N'''') 
                      AS ProjectDescription, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskDescription, N'''') AS TaskDescription, 
                      dbo.AccountTimeExpenseBilling.InvoiceNumber, dbo.AccountTimeExpenseBilling.InvoiceDate, dbo.AccountProjectType.AccountProjectTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Billed, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeTimeEntryPeriodId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientContactName, N'''') AS ClientContactName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentCode, N'''') AS ClientDepartmentCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentName, N'''') AS ClientDepartmentName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentLocation, N'''') AS ClientDepartmentLocation, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.IsTimeOff, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountWorkTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectStatus, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ParentTaskName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.FirstName, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.LastName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeType, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.HolidayName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField1, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField2, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField3, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField4, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField5, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField6, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField7, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField8, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField9, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField10, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField11, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField12, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField13, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField14, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField15
FROM         dbo.AccountRole INNER JOIN
                      dbo.AccountProjectEmployee ON dbo.AccountRole.AccountRoleId = dbo.AccountProjectEmployee.AccountRoleId RIGHT OUTER JOIN
                      dbo.AccountTimeExpenseBillingTimesheet INNER JOIN
                      dbo.AccountTimeExpenseBilling ON 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingId = dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId RIGHT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport LEFT OUTER JOIN
                      dbo.AccountProjectType ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectTypeId = dbo.AccountProjectType.AccountProjectTypeId LEFT OUTER JOIN
                      dbo.AccountProjectMilestone ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectMilestoneId = dbo.AccountProjectMilestone.AccountProjectMilestoneId LEFT OUTER JOIN
                      dbo.AccountStatus ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskStatusId = dbo.AccountStatus.AccountStatusId LEFT OUTER JOIN
                      dbo.AccountPriority ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountPriorityId = dbo.AccountPriority.AccountPriorityId LEFT OUTER JOIN
                      dbo.AccountTaskType ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountTaskTypeId = dbo.AccountTaskType.AccountTaskTypeId ON 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingTimesheetId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountTimeExpenseBillingTimesheetId
                       ON dbo.AccountProjectEmployee.AccountEmployeeId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeId AND 
                      dbo.AccountProjectEmployee.AccountProjectId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.LeaderEmployeeId = AccountEmployee_1.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_2 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectManagerEmployeeId = AccountEmployee_2.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.AccountEmployee AS AccountEmployee_3 ON dbo.AccountEmployee.AccountEmployeeId = AccountEmployee_3.EmployeeManagerId ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeId = AccountEmployee_3.AccountEmployeeId LEFT OUTER JOIN
                      dbo.vueAccountCurrency AS vueAccountCurrency_2 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRateCurrencyId = vueAccountCurrency_2.AccountCurrencyId LEFT OUTER JOIN
                      dbo.vueAccountCurrency AS vueAccountCurrency_1 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedCurrencyId = vueAccountCurrency_1.AccountCurrencyId LEFT OUTER JOIN
                      dbo.vueAccountCurrency ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateCurrencyId = dbo.vueAccountCurrency.AccountCurrencyId'

GO
-- Create View rptvueAccountEmployeeTimeEntry
Print 'Create View rptvueAccountEmployeeTimeEntry'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeEntry' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountEmployeeTimeEntry
AS
SELECT     dbo.vueAccountEmployeeTimeEntryForReport.EmployeeName, dbo.vueAccountEmployeeTimeEntryForReport.ProjectName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskName, dbo.vueAccountEmployeeTimeEntryForReport.TotalTime, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Approved, dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectId, dbo.vueAccountEmployeeTimeEntryForReport.TeamLeadApproved, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManagerApproved, dbo.vueAccountEmployeeTimeEntryForReport.AdministratorApproved, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeTimeEntryId, dbo.vueAccountEmployeeTimeEntryForReport.StartTime, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EndTime, dbo.vueAccountEmployeeTimeEntryForReport.TimeEntryDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Description, dbo.vueAccountEmployeeTimeEntryForReport.AccountId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TotalMinutes, dbo.vueAccountEmployeeTimeEntryForReport.WeekDay, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientName, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectTaskId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingType, dbo.vueAccountEmployeeTimeEntryForReport.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManagerEmployeeId, dbo.vueAccountEmployeeTimeEntryForReport.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ExpenseApprovalTypeId, dbo.vueAccountEmployeeTimeEntryForReport.IsBillable, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Rejected, dbo.vueAccountEmployeeTimeEntryForReport.BillingRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectBillingRateTypeId, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountDepartmentId, dbo.vueAccountEmployeeTimeEntryForReport.DepartmentName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCost, dbo.vueAccountEmployeeTimeEntryForReport.EstimatedHours, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Submitted, dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkType, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EMailAddress, dbo.vueAccountEmployeeTimeEntryForReport.AccountLocation, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountCostCenter, dbo.vueAccountEmployeeTimeEntryForReport.AccountCostCenterCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkTypeCode, dbo.vueAccountEmployeeTimeEntryForReport.ProjectCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCode, dbo.vueAccountEmployeeTimeEntryForReport.AccountLocationId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ApproverComments, dbo.vueAccountEmployeeTimeEntryForReport.Amount, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingRateCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountBaseCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.BillingRateCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AmountCurrencyCode, CASE WHEN vueAccountEmployeeTimeEntryForReport.Submitted = 1 AND 
                      vueAccountEmployeeTimeEntryForReport.Approved = 0 THEN ''Submitted'' WHEN vueAccountEmployeeTimeEntryForReport.Approved = 1 THEN ''Approved'' WHEN vueAccountEmployeeTimeEntryForReport.Rejected
                       = 1 THEN ''Rejected'' WHEN vueAccountEmployeeTimeEntryForReport.Submitted = 0 AND vueAccountEmployeeTimeEntryForReport.Approved = 0 AND 
                      vueAccountEmployeeTimeEntryForReport.Rejected = 0 THEN ''Not Submitted'' END AS ApprovalStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountTaskTypeId, dbo.vueAccountEmployeeTimeEntryForReport.TaskStatusId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountPriorityId, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectMilestoneId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskType, dbo.vueAccountEmployeeTimeEntryForReport.TaskStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.MilestoneDescription, dbo.vueAccountEmployeeTimeEntryForReport.Priority, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TotalHours, dbo.vueAccountEmployeeTimeEntryForReport.DepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientNick, dbo.vueAccountEmployeeTimeEntryForReport.AccountClientId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ApprovedOn, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateCurrencyCode, dbo.vueAccountEmployeeTimeEntryForReport.TeamLeader, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManager, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeManager, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate, 0) AS EstimatedCurrencyExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCost, dbo.vueAccountEmployeeTimeEntryForReport.AccountRoleId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Role, dbo.vueAccountEmployeeTimeEntryForReport.WeekDayName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Period, dbo.vueAccountEmployeeTimeEntryForReport.Year, dbo.vueAccountEmployeeTimeEntryForReport.WeekNo, 
                      dbo.vueAccountEmployeeTimeEntryForReport.MonthNo, dbo.vueAccountEmployeeTimeEntryForReport.DayNo, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 1 THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours ELSE 0 END AS BillableTotalHours,
                       CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable
                       IS NULL THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours ELSE 0 END AS NonBillableTotalHours, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCost / dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate
                       ELSE 0 END AS CurrencyEmployeeCost, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.Amount / dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate
                       ELSE 0 END AS CurrencyAmount, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCost / dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate
                       ELSE 0 END AS CurrencyEstimatedCost, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate / dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate
                       ELSE 0 END AS CurrencyBillingRate, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRate / dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate
                       ELSE 0 END AS CurrencyEmployeeRate, dbo.vueAccountEmployeeTimeEntryForReport.ProjectRole, dbo.vueAccountEmployeeTimeEntryForReport.ProjectType, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectDescription, dbo.vueAccountEmployeeTimeEntryForReport.TaskDescription, 
                      dbo.vueAccountEmployeeTimeEntryForReport.InvoiceNumber, dbo.vueAccountEmployeeTimeEntryForReport.InvoiceDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectTypeId, dbo.vueAccountEmployeeTimeEntryForReport.Billed, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientContactName, dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentName, dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentLocation, 
                      dbo.vueAccountEmployeeTimeEntryForReport.IsTimeOff, dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkTypeId, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 1 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate * dbo.vueAccountEmployeeTimeEntryForReport.TotalHours
                       ELSE 0 END AS BillableTotalAmount, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate * dbo.vueAccountEmployeeTimeEntryForReport.TotalHours
                       ELSE 0 END AS NonBillableTotalAmount, dbo.vueAccountEmployeeTimeEntryForReport.ProjectStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ParentTaskName, dbo.vueAccountEmployeeTimeEntryForReport.FirstName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.LastName, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeType, 
                      dbo.vueAccountEmployeeTimeEntryForReport.HolidayName, SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithLastStatus.Percentage, 0)) AS Percentage, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField1, dbo.vueAccountEmployeeTimeEntryForReport.CustomField2, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField3, dbo.vueAccountEmployeeTimeEntryForReport.CustomField4, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField5, dbo.vueAccountEmployeeTimeEntryForReport.CustomField6, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField7, dbo.vueAccountEmployeeTimeEntryForReport.CustomField8, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField9, dbo.vueAccountEmployeeTimeEntryForReport.CustomField10, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField11, dbo.vueAccountEmployeeTimeEntryForReport.CustomField12, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField13, dbo.vueAccountEmployeeTimeEntryForReport.CustomField14, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField15
FROM         dbo.vueAccountEmployeeTimeEntryForReport INNER JOIN
                      dbo.vueAccountEmployeeTimeEntryWithLastStatus ON 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryWithLastStatus.AccountEmployeeTimeEntryId
GROUP BY dbo.vueAccountEmployeeTimeEntryForReport.EmployeeName, dbo.vueAccountEmployeeTimeEntryForReport.ProjectName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskName, dbo.vueAccountEmployeeTimeEntryForReport.TotalTime, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeId, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeTimeEntryId, dbo.vueAccountEmployeeTimeEntryForReport.StartTime, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EndTime, dbo.vueAccountEmployeeTimeEntryForReport.TimeEntryDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Description, dbo.vueAccountEmployeeTimeEntryForReport.AccountId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TotalMinutes, dbo.vueAccountEmployeeTimeEntryForReport.WeekDay, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientName, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectTaskId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingType, dbo.vueAccountEmployeeTimeEntryForReport.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManagerEmployeeId, dbo.vueAccountEmployeeTimeEntryForReport.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ExpenseApprovalTypeId, dbo.vueAccountEmployeeTimeEntryForReport.BillingRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectBillingRateTypeId, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountDepartmentId, dbo.vueAccountEmployeeTimeEntryForReport.DepartmentName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCost, dbo.vueAccountEmployeeTimeEntryForReport.EstimatedHours, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkType, dbo.vueAccountEmployeeTimeEntryForReport.EMailAddress, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountLocation, dbo.vueAccountEmployeeTimeEntryForReport.AccountCostCenter, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountCostCenterCode, dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkTypeCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectCode, dbo.vueAccountEmployeeTimeEntryForReport.TaskCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountLocationId, dbo.vueAccountEmployeeTimeEntryForReport.ApproverComments, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Amount, dbo.vueAccountEmployeeTimeEntryForReport.BillingRateCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate, dbo.vueAccountEmployeeTimeEntryForReport.AccountBaseCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingRateCurrencyCode, dbo.vueAccountEmployeeTimeEntryForReport.AmountCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountTaskTypeId, dbo.vueAccountEmployeeTimeEntryForReport.TaskStatusId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountPriorityId, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectMilestoneId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskType, dbo.vueAccountEmployeeTimeEntryForReport.TaskStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.MilestoneDescription, dbo.vueAccountEmployeeTimeEntryForReport.Priority, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TotalHours, dbo.vueAccountEmployeeTimeEntryForReport.DepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientNick, dbo.vueAccountEmployeeTimeEntryForReport.AccountClientId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ApprovedOn, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateCurrencyCode, dbo.vueAccountEmployeeTimeEntryForReport.TeamLeader, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManager, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeManager, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate, 0), dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCost, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountRoleId, dbo.vueAccountEmployeeTimeEntryForReport.Role, 
                      dbo.vueAccountEmployeeTimeEntryForReport.WeekDayName, dbo.vueAccountEmployeeTimeEntryForReport.Period, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Year, dbo.vueAccountEmployeeTimeEntryForReport.WeekNo, dbo.vueAccountEmployeeTimeEntryForReport.MonthNo, 
                      dbo.vueAccountEmployeeTimeEntryForReport.DayNo, dbo.vueAccountEmployeeTimeEntryForReport.ProjectRole, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectType, dbo.vueAccountEmployeeTimeEntryForReport.ProjectDescription, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskDescription, dbo.vueAccountEmployeeTimeEntryForReport.InvoiceNumber, 
                      dbo.vueAccountEmployeeTimeEntryForReport.InvoiceDate, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectTypeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientContactName, dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentName, dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentLocation, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkTypeId, dbo.vueAccountEmployeeTimeEntryForReport.ProjectStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ParentTaskName, dbo.vueAccountEmployeeTimeEntryForReport.FirstName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.LastName, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeType, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Approved, dbo.vueAccountEmployeeTimeEntryForReport.TeamLeadApproved, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManagerApproved, dbo.vueAccountEmployeeTimeEntryForReport.AdministratorApproved, 
                      dbo.vueAccountEmployeeTimeEntryForReport.IsBillable, dbo.vueAccountEmployeeTimeEntryForReport.Rejected, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Submitted, dbo.vueAccountEmployeeTimeEntryForReport.Billed, 
                      dbo.vueAccountEmployeeTimeEntryForReport.IsTimeOff, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate * dbo.vueAccountEmployeeTimeEntryForReport.TotalHours
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 1 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate * dbo.vueAccountEmployeeTimeEntryForReport.TotalHours
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRate / dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate / dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCost / dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.Amount / dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCost / dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable
                       IS NULL THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 1 THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours ELSE 0 END, 
                      CASE WHEN vueAccountEmployeeTimeEntryForReport.Submitted = 1 AND 
                      vueAccountEmployeeTimeEntryForReport.Approved = 0 THEN ''Submitted'' WHEN vueAccountEmployeeTimeEntryForReport.Approved = 1 THEN ''Approved'' WHEN vueAccountEmployeeTimeEntryForReport.Rejected
                       = 1 THEN ''Rejected'' WHEN vueAccountEmployeeTimeEntryForReport.Submitted = 0 AND vueAccountEmployeeTimeEntryForReport.Approved = 0 AND 
                      vueAccountEmployeeTimeEntryForReport.Rejected = 0 THEN ''Not Submitted'' END, dbo.vueAccountEmployeeTimeEntryForReport.HolidayName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField1, dbo.vueAccountEmployeeTimeEntryForReport.CustomField2, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField3, dbo.vueAccountEmployeeTimeEntryForReport.CustomField4, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField5, dbo.vueAccountEmployeeTimeEntryForReport.CustomField6, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField7, dbo.vueAccountEmployeeTimeEntryForReport.CustomField8, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField9, dbo.vueAccountEmployeeTimeEntryForReport.CustomField10, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField11, dbo.vueAccountEmployeeTimeEntryForReport.CustomField12, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField13, dbo.vueAccountEmployeeTimeEntryForReport.CustomField14, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField15'

GO
-- Create View vueAccountEmployeeTimeEntry
Print 'Create View vueAccountEmployeeTimeEntry'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntry' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntry
AS
SELECT     CASE WHEN dbo.AccountEmployee.IsDisabled = 1 THEN dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE dbo.AccountEmployee.FirstName
                       + '' '' + dbo.AccountEmployee.LastName END AS EmployeeName, dbo.AccountProject.ProjectName, 
                      CASE WHEN dbo.AccountProjectTask.AccountProjectTaskId IS NOT NULL 
                      THEN dbo.AccountProjectTask.TaskName ELSE AccountTimeOffType.AccountTimeOffType END AS TaskName, dbo.AccountEmployeeTimeEntry.TotalTime, 
                      dbo.AccountEmployeeTimeEntry.Approved, dbo.AccountEmployee.AccountEmployeeId, dbo.AccountProject.AccountProjectId, 
                      dbo.AccountEmployeeTimeEntry.TeamLeadApproved, dbo.AccountEmployeeTimeEntry.ProjectManagerApproved, 
                      dbo.AccountEmployeeTimeEntry.AdministratorApproved, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, dbo.AccountEmployeeTimeEntry.StartTime, 
                      dbo.AccountEmployeeTimeEntry.EndTime, dbo.AccountEmployeeTimeEntry.TimeEntryDate, dbo.AccountEmployeeTimeEntry.Description, 
                      dbo.AccountEmployee.AccountId, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      AS TotalMinutes, DATEPART(dw, dbo.AccountEmployeeTimeEntry.TimeEntryDate) AS WeekDay, dbo.AccountParty.AccountPartyId, dbo.AccountParty.PartyName, 
                      dbo.AccountProjectTask.AccountProjectTaskId, dbo.AccountBillingType.BillingType, dbo.AccountProject.LeaderEmployeeId, 
                      dbo.AccountProject.ProjectManagerEmployeeId, dbo.AccountProject.TimeSheetApprovalTypeId, dbo.AccountProject.ExpenseApprovalTypeId, 
                      dbo.AccountProjectTask.IsBillable, dbo.AccountEmployeeTimeEntry.Rejected, dbo.AccountEmployeeTimeEntry.BillingRate, 
                      dbo.AccountProject.ProjectBillingRateTypeId, dbo.AccountEmployee.EmployeeCode, dbo.AccountEmployee.AccountDepartmentId, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountProjectTask.EstimatedCost, dbo.AccountProjectTask.EstimatedTimeSpent, 
                      dbo.AccountEmployeeTimeEntry.Submitted, dbo.AccountWorkType.AccountWorkType, dbo.AccountEmployee.EMailAddress, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountCostCenter.AccountCostCenter, dbo.AccountCostCenter.AccountCostCenterCode, dbo.AccountWorkType.AccountWorkTypeCode, 
                      dbo.AccountProject.ProjectCode, dbo.AccountProjectTask.TaskCode, dbo.AccountLocation.AccountLocationId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction.Comments, dbo.AccountEmployeeTimeEntry.BillingRateCurrencyId, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateCurrencyId, dbo.AccountEmployeeTimeEntry.BillingRateExchangeRate, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateExchangeRate, dbo.AccountEmployeeTimeEntry.AccountBaseCurrencyId, dbo.AccountProjectTask.AccountTaskTypeId, 
                      dbo.AccountProjectTask.TaskStatusId, dbo.AccountProjectTask.AccountPriorityId, dbo.AccountProjectTask.AccountProjectMilestoneId, 
                      dbo.AccountDepartment.DepartmentCode, dbo.AccountParty.PartyNick, dbo.AccountProjectTask.EstimatedCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction.ApprovedOn, dbo.AccountEmployeeTimeEntry.EmployeeRate, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountRole.Role, dbo.AccountProject.AccountProjectTypeId, dbo.AccountProject.ProjectDescription, dbo.AccountProjectTask.TaskDescription, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeExpenseBillingTimesheetId, dbo.AccountEmployeeTimeEntry.Billed, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Submitted = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS SubmittedHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Approved = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS ApprovedHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Rejected = 1 THEN ROUND(CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60, 2) END AS RejectedHours, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, 
                      dbo.AccountPartyContact.FirstName + N'' '' + dbo.AccountPartyContact.LastName AS ClientContactName, 
                      dbo.AccountPartyDepartment.PartyDepartmentCode AS ClientDepartmentCode, dbo.AccountPartyDepartment.PartyDepartmentName AS ClientDepartmentName, 
                      dbo.AccountPartyDepartment.PartyDepartmentLocation AS ClientDepartmentLocation, dbo.AccountWorkType.AccountWorkTypeId, 
                      dbo.AccountEmployeeTimeEntry.IsTimeOff, dbo.AccountEmployeeTimeEntry.Hours, dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeOffRequestId, dbo.AccountEmployeeTimeEntry.Percentage, dbo.AccountEmployeeTimeEntry.CustomField1, 
                      dbo.AccountEmployeeTimeEntry.CustomField2, dbo.AccountEmployeeTimeEntry.CustomField3, dbo.AccountEmployeeTimeEntry.CustomField4, 
                      dbo.AccountEmployeeTimeEntry.CustomField5, dbo.AccountEmployeeTimeEntry.CustomField6, dbo.AccountEmployeeTimeEntry.CustomField7, 
                      dbo.AccountEmployeeTimeEntry.CustomField8, dbo.AccountEmployeeTimeEntry.CustomField9, dbo.AccountEmployeeTimeEntry.CustomField10, 
                      dbo.AccountEmployeeTimeEntry.CustomField11, dbo.AccountEmployeeTimeEntry.CustomField12, dbo.AccountEmployeeTimeEntry.CustomField13, 
                      dbo.AccountEmployeeTimeEntry.CustomField14, dbo.AccountEmployeeTimeEntry.CustomField15
FROM         dbo.AccountEmployeeTimeEntry INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeEntry.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountTimeOffType ON dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId LEFT OUTER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountProjectTask ON dbo.AccountEmployeeTimeEntry.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId LEFT OUTER JOIN
                      dbo.AccountPartyDepartment ON dbo.AccountProject.AccountPartyDepartmentId = dbo.AccountPartyDepartment.AccountPartyDepartmentId LEFT OUTER JOIN
                      dbo.AccountPartyContact ON dbo.AccountProject.AccountPartyContactId = dbo.AccountPartyContact.AccountPartyContactId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryPeriod ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId LEFT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryApprovalLastAction.AccountEmployeeTimeEntryId LEFT OUTER JOIN
                      dbo.AccountCostCenter ON dbo.AccountEmployeeTimeEntry.AccountCostCenterId = dbo.AccountCostCenter.AccountCostCenterId LEFT OUTER JOIN
                      dbo.AccountWorkType ON dbo.AccountEmployeeTimeEntry.AccountWorkTypeId = dbo.AccountWorkType.AccountWorkTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId LEFT OUTER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId'

GO
-- Create View vueAccountClientForReport
Print 'Create View vueAccountClientForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountClientForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountClientForReport
AS
SELECT     dbo.AccountParty.AccountPartyId AS AccountClientId, dbo.AccountParty.PartyTypeId AS ClientTypeId, dbo.AccountParty.AccountId, 
                      dbo.AccountParty.PartyName AS ClientName, ISNULL(dbo.AccountParty.PartyNick, N'''') AS ClientNick, ISNULL(dbo.AccountParty.EMailAddress, N'''') AS EMailAddress, 
                      ISNULL(dbo.AccountParty.Address1, N'''') AS Address1, ISNULL(dbo.AccountParty.Address2, N'''') AS Address2, dbo.AccountParty.CountryId, 
                      ISNULL(dbo.AccountParty.State, N'''') AS State, ISNULL(dbo.AccountParty.City, N'''') AS City, ISNULL(dbo.AccountParty.ZipCode, N'''') AS ZipCode, 
                      ISNULL(dbo.AccountParty.Telephone1, N'''') AS Telephone1, ISNULL(dbo.AccountParty.Telephone2, N'''') AS Telephone2, ISNULL(dbo.AccountParty.Fax, N'''') AS Fax, 
                      dbo.AccountParty.DefaultCurrencyId, ISNULL(dbo.AccountParty.DefaultBillingRate, 0) AS DefaultBillingRate, ISNULL(dbo.AccountParty.Website, N'''') AS Website, 
                      ISNULL(dbo.AccountParty.Notes, N'''') AS Notes, dbo.AccountParty.IsDisabled, dbo.AccountParty.IsDeleted, dbo.AccountParty.CreatedOn, 
                      dbo.AccountParty.CreatedByEmployeeId, dbo.AccountParty.ModifiedOn, dbo.AccountParty.ModifiedByEmployeeId, ISNULL(dbo.SystemCountry.Country, N'''') 
                      AS Country, dbo.AccountParty.CustomField1, dbo.AccountParty.CustomField2, dbo.AccountParty.CustomField3, dbo.AccountParty.CustomField4, 
                      dbo.AccountParty.CustomField5, dbo.AccountParty.CustomField6, dbo.AccountParty.CustomField7, dbo.AccountParty.CustomField8, dbo.AccountParty.CustomField9, 
                      dbo.AccountParty.CustomField10, dbo.AccountParty.CustomField11, dbo.AccountParty.CustomField12, dbo.AccountParty.CustomField13, 
                      dbo.AccountParty.CustomField14, dbo.AccountParty.CustomField15
FROM         dbo.AccountParty INNER JOIN
                      dbo.Account ON dbo.AccountParty.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.SystemCountry ON dbo.AccountParty.CountryId = dbo.SystemCountry.CountryId'

GO
-- Create View vueAccountEmployeesForReport
Print 'Create View vueAccountEmployeesForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeesForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeesForReport
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.Password, dbo.AccountEmployee.Prefix, dbo.AccountEmployee.FirstName, 
                      dbo.AccountEmployee.LastName, ISNULL(dbo.AccountEmployee.MiddleName, N'''') AS MiddleName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountEmployee.AccountId, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountRoleId, dbo.AccountEmployee.AccountLocationId, 
                      ISNULL(dbo.AccountEmployee.Notes, N'''') AS Notes, ISNULL(dbo.AccountEmployee.AddressLine1, N'''') AS AddressLine1, ISNULL(dbo.AccountEmployee.AddressLine2, 
                      N'''') AS AddressLine2, ISNULL(dbo.AccountEmployee.State, N'''') AS State, ISNULL(dbo.AccountEmployee.City, N'''') AS City, ISNULL(dbo.AccountEmployee.Zip, N'''') 
                      AS Zip, dbo.AccountEmployee.CountryId, ISNULL(dbo.AccountEmployee.HomePhoneNo, N'''') AS HomePhoneNo, ISNULL(dbo.AccountEmployee.WorkPhoneNo, N'''') 
                      AS WorkPhoneNo, ISNULL(dbo.AccountEmployee.MobilePhoneNo, N'''') AS MobilePhoneNo, dbo.AccountEmployee.TimeEntryApprovalPathId, 
                      dbo.AccountEmployee.BillingRateStateDate, dbo.AccountEmployee.BillingTypeId, dbo.AccountEmployee.StartDate, dbo.AccountEmployee.TerminationDate, 
                      dbo.AccountEmployee.StatusId, dbo.AccountEmployee.IsDeleted, dbo.AccountEmployee.IsDisabled, dbo.AccountEmployee.DefaultProjectId, 
                      dbo.AccountEmployee.TimeZoneId, dbo.AccountEmployee.DefaultEmployee, dbo.AccountEmployee.CreatedOn, dbo.AccountEmployee.CreatedByEmployeeId, 
                      dbo.AccountEmployee.ModifiedOn, dbo.AccountEmployee.ModifiedByEmployeeId, dbo.AccountEmployee.AllowedAccessFromIP, 
                      dbo.AccountEmployee.ExternalUserClientId, dbo.AccountEmployee.EmployeeTypeId, dbo.AccountEmployee.AccountBillingRateId, dbo.AccountEmployee.Username, 
                      ISNULL(dbo.AccountEmployee.EmployeeCode, N'''') AS EmployeeCode, dbo.AccountEmployee.EmployeeManagerId, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, ISNULL(dbo.AccountDepartment.DepartmentCode, N'''') AS DepartmentCode, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountLocation.AccountLocation, ISNULL(dbo.SystemCountry.Country, N'''') AS Country, 
                      ISNULL(AccountEmployee_1.FirstName + N'' '' + AccountEmployee_1.LastName, N'''') AS EmployeeManager, 
                      ISNULL(dbo.vueAccountWorkTypeBillingRate.AccountWorkTypeCode, N'''') AS AccountWorkTypeCode, ISNULL(dbo.vueAccountWorkTypeBillingRate.AccountWorkType, 
                      N'''') AS AccountWorkType, ISNULL(dbo.vueAccountWorkTypeBillingRate.BillingRate, 0) AS BillingRate, ISNULL(dbo.vueAccountWorkTypeBillingRate.EmployeeRate, 0) 
                      AS EmployeeRate, dbo.vueAccountWorkTypeBillingRate.EmployeeRateCurrencyCode, dbo.vueAccountWorkTypeBillingRate.BillingRateCurrencyCode, 
                      dbo.AccountEmployee.HiredDate, ISNULL(dbo.AccountStatus.Status, N'''') AS EmployeeStatus, ISNULL(dbo.AccountEmployeeType.AccountEmployeeType, N'''') 
                      AS EmployeeType, dbo.AccountEmployee.CustomField1, dbo.AccountEmployee.CustomField2, dbo.AccountEmployee.CustomField3, 
                      dbo.AccountEmployee.CustomField4, dbo.AccountEmployee.CustomField5, dbo.AccountEmployee.CustomField6, dbo.AccountEmployee.CustomField7, 
                      dbo.AccountEmployee.CustomField8, dbo.AccountEmployee.CustomField9, dbo.AccountEmployee.CustomField10, dbo.AccountEmployee.CustomField11, 
                      dbo.AccountEmployee.CustomField12, dbo.AccountEmployee.CustomField13, dbo.AccountEmployee.CustomField14, dbo.AccountEmployee.CustomField15
FROM         dbo.AccountEmployee INNER JOIN
                      dbo.Account ON dbo.AccountEmployee.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId AND 
                      dbo.Account.AccountId = dbo.AccountDepartment.AccountId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId AND dbo.Account.AccountId = dbo.AccountRole.AccountId INNER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId AND 
                      dbo.Account.AccountId = dbo.AccountLocation.AccountId INNER JOIN
                      dbo.SystemCountry ON dbo.AccountEmployee.CountryId = dbo.SystemCountry.CountryId LEFT OUTER JOIN
                      dbo.AccountEmployeeType ON dbo.AccountEmployee.EmployeePayTypeId = dbo.AccountEmployeeType.AccountEmployeeTypeId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON dbo.Account.AccountId = AccountEmployee_1.AccountId AND 
                      dbo.AccountEmployee.EmployeeManagerId = AccountEmployee_1.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountStatus ON dbo.AccountEmployee.StatusId = dbo.AccountStatus.AccountStatusId AND 
                      dbo.Account.AccountId = dbo.AccountStatus.AccountId LEFT OUTER JOIN
                      dbo.vueAccountWorkTypeBillingRate ON dbo.Account.AccountId = dbo.vueAccountWorkTypeBillingRate.AccountId AND 
                      dbo.AccountEmployee.AccountEmployeeId = dbo.vueAccountWorkTypeBillingRate.AccountEmployeeId
WHERE     (dbo.AccountEmployee.EmployeeTypeId IS NULL)'

GO
-- Create View rptvueAccountClients
Print 'Create View rptvueAccountClients'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountClients' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountClients
AS
SELECT     AccountClientId, ClientTypeId, AccountId, ClientName, ClientNick, EMailAddress, Address1, Address2, CountryId, State, City, ZipCode, Telephone1, Telephone2, Fax, 
                      DefaultCurrencyId, DefaultBillingRate, Website, Notes, IsDisabled, IsDeleted, CreatedOn, CreatedByEmployeeId, ModifiedOn, ModifiedByEmployeeId, Country, 
                      CustomField1, CustomField2, CustomField3, CustomField4, CustomField5, CustomField6, CustomField7, CustomField8, CustomField9, CustomField10, CustomField11, 
                      CustomField12, CustomField13, CustomField14, CustomField15
FROM         dbo.vueAccountClientForReport'

GO
-- Create View rptvueAccountEmployees
Print 'Create View rptvueAccountEmployees'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployees' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountEmployees
AS
SELECT     AccountEmployeeId, Password, Prefix, FirstName, LastName, MiddleName, EMailAddress, AccountId, AccountDepartmentId, AccountRoleId, AccountLocationId, Notes, 
                      AddressLine1, AddressLine2, State, City, Zip, CountryId, HomePhoneNo, WorkPhoneNo, MobilePhoneNo, TimeEntryApprovalPathId, BillingRateStateDate, 
                      BillingTypeId, StartDate, TerminationDate, StatusId, IsDeleted, IsDisabled, DefaultProjectId, TimeZoneId, DefaultEmployee, CreatedOn, CreatedByEmployeeId, 
                      ModifiedOn, ModifiedByEmployeeId, AllowedAccessFromIP, ExternalUserClientId, EmployeeTypeId, AccountBillingRateId, Username, EmployeeCode, 
                      EmployeeManagerId, EmployeeName, DepartmentCode, DepartmentName, Role, AccountLocation, Country, ISNULL(EmployeeManager, '''') AS EmployeeManager, 
                      AccountWorkTypeCode, AccountWorkType, BillingRate, EmployeeRate, EmployeeRateCurrencyCode, BillingRateCurrencyCode, HiredDate, EmployeeStatus, 
                      EmployeeType, CustomField1, CustomField2, CustomField3, CustomField4, CustomField5, CustomField6, CustomField7, CustomField8, CustomField9, CustomField10, 
                      CustomField11, CustomField12, CustomField13, CustomField14, CustomField15
FROM         dbo.vueAccountEmployeesForReport
WHERE     (IsDeleted <> 1)'

GO
if not exists (select * from information_schema.routines where specific_name = 'timeToDecimal' and routine_type = 'FUNCTION') 
EXEC sp_executesql N'
CREATE FUNCTION dbo.timeToDecimal
(
@timeToConvert varchar(25)
)
RETURNS decimal(18, 2)
AS
BEGIN
DECLARE @Result decimal(18, 2)
DECLARE @t varchar(5)
SET @t = cast(datepart(hh,@timeToConvert) as varchar(2)) + '':'' + cast(datepart(n,@timeToConvert) as varchar(2))
SET @Result = CAST(DATEDIFF(N, ''00:00'', @t) AS decimal(18, 2))/60
RETURN @Result
END'

GO
If exists(Select * from SystemData where version = '4.0.3')
--Update SystemSecurityCategoryPage Record
BEGIN
Update AccountEmployeeTimeEntry
Set AccountEmployeeTimeEntry.Hours = dbo.timeToDecimal(TotalTime)
Where AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId = AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId
END
GO
Update SystemData Set Version = '4.0.4' Where Version = '4.0.3' And SystemDataId = 1

GO

-- Drop View vueAccountEmployeeTimeEntryWithTimeOffForReport
Print 'Drop View vueAccountEmployeeTimeEntryWithTimeOffForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithTimeOffForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryWithTimeOffForReport]

GO
-- Drop View rptvueAccountEmployeeTimeEntry
Print 'Drop View rptvueAccountEmployeeTimeEntry'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeEntry' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountEmployeeTimeEntry]

GO
-- Drop View vueAccountEmployeeTimeEntryForReport
Print 'Drop View vueAccountEmployeeTimeEntryForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryForReport]

GO
-- Create View vueAccountEmployeeTimeEntryWithTimeOffForReport
Print 'Create View vueAccountEmployeeTimeEntryWithTimeOffForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithTimeOffForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport
AS
SELECT     CASE WHEN dbo.AccountEmployee.IsDisabled = 1 THEN dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE dbo.AccountEmployee.FirstName
                       + '' '' + dbo.AccountEmployee.LastName END AS EmployeeName, dbo.AccountProject.ProjectName, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 1 THEN AccountProjectTask_1.TaskName ELSE dbo.AccountTimeOffType.AccountTimeOffType END AS TaskName,
                       dbo.AccountEmployeeTimeEntry.TotalTime, dbo.AccountEmployeeTimeEntry.Approved, dbo.AccountEmployee.AccountEmployeeId, 
                      dbo.AccountProject.AccountProjectId, dbo.AccountEmployeeTimeEntry.TeamLeadApproved, dbo.AccountEmployeeTimeEntry.ProjectManagerApproved, 
                      dbo.AccountEmployeeTimeEntry.AdministratorApproved, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, dbo.AccountEmployeeTimeEntry.StartTime, 
                      dbo.AccountEmployeeTimeEntry.EndTime, dbo.AccountEmployeeTimeEntry.TimeEntryDate, dbo.AccountEmployeeTimeEntry.Description, 
                      ISNULL(dbo.AccountProject.AccountId, dbo.AccountTimeOffType.AccountId) AS AccountId, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime) AS TotalMinutes, DATEPART(dw, dbo.AccountEmployeeTimeEntry.TimeEntryDate) AS WeekDay, 
                      dbo.AccountParty.AccountPartyId, dbo.AccountParty.PartyName, AccountProjectTask_1.AccountProjectTaskId, dbo.AccountBillingType.BillingType, 
                      dbo.AccountProject.LeaderEmployeeId, dbo.AccountProject.ProjectManagerEmployeeId, dbo.AccountProject.TimeSheetApprovalTypeId, 
                      dbo.AccountProject.ExpenseApprovalTypeId, AccountProjectTask_1.IsBillable, dbo.AccountEmployeeTimeEntry.Rejected, dbo.AccountEmployeeTimeEntry.BillingRate, 
                      dbo.AccountProject.ProjectBillingRateTypeId, dbo.AccountEmployee.EmployeeCode, dbo.AccountEmployee.AccountDepartmentId, 
                      dbo.AccountDepartment.DepartmentName, AccountProjectTask_1.EstimatedCost, AccountProjectTask_1.EstimatedTimeSpent, 
                      dbo.AccountEmployeeTimeEntry.Submitted, dbo.AccountWorkType.AccountWorkType, dbo.AccountEmployee.EMailAddress, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountCostCenter.AccountCostCenter, dbo.AccountCostCenter.AccountCostCenterCode, dbo.AccountWorkType.AccountWorkTypeCode, 
                      dbo.AccountProject.ProjectCode, AccountProjectTask_1.TaskCode, dbo.AccountLocation.AccountLocationId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction.Comments, dbo.AccountEmployeeTimeEntry.BillingRateCurrencyId, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateCurrencyId, dbo.AccountEmployeeTimeEntry.BillingRateExchangeRate, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateExchangeRate, dbo.AccountEmployeeTimeEntry.AccountBaseCurrencyId, AccountProjectTask_1.AccountTaskTypeId, 
                      AccountProjectTask_1.TaskStatusId, AccountProjectTask_1.AccountPriorityId, AccountProjectTask_1.AccountProjectMilestoneId, 
                      dbo.AccountDepartment.DepartmentCode, dbo.AccountParty.PartyNick, AccountProjectTask_1.EstimatedCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction.ApprovedOn, dbo.AccountEmployeeTimeEntry.EmployeeRate, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountRole.Role, dbo.AccountProject.AccountProjectTypeId, dbo.AccountProject.ProjectDescription, AccountProjectTask_1.TaskDescription, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeExpenseBillingTimesheetId, dbo.AccountEmployeeTimeEntry.Billed, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Submitted = 1 THEN (CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, 
                      dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS SubmittedHours, CASE WHEN dbo.AccountEmployeeTimeEntry.Approved = 1 THEN (CONVERT(float, 
                      DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS ApprovedHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Rejected = 1 THEN (CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, 
                      dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS RejectedHours, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, 
                      dbo.AccountPartyContact.FirstName + N'' '' + dbo.AccountPartyContact.LastName AS ClientContactName, 
                      dbo.AccountPartyDepartment.PartyDepartmentCode AS ClientDepartmentCode, dbo.AccountPartyDepartment.PartyDepartmentName AS ClientDepartmentName, 
                      dbo.AccountPartyDepartment.PartyDepartmentLocation AS ClientDepartmentLocation, dbo.AccountEmployeeTimeEntry.IsTimeOff, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId, CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 0 THEN (CONVERT(float, DATEPART(hh, 
                      dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS TimeOffHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 1 THEN (CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, 
                      dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS TimesheetHours, dbo.AccountWorkType.AccountWorkTypeId, dbo.AccountStatus.Status AS ProjectStatus, 
                      AccountProjectTask_1.ParentAccountProjectTaskId, dbo.AccountProjectTask.TaskName AS ParentTaskName, dbo.AccountEmployee.IsDisabled, 
                      dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, ISNULL(dbo.AccountEmployeeType.AccountEmployeeType, N'''') AS EmployeeType, 
                      ISNULL(dbo.AccountHolidayTypeDetail.HolidayName, N'''') AS HolidayName, dbo.AccountEmployeeTimeEntry.Percentage, 
                      dbo.AccountEmployeeTimeEntry.CustomField1, dbo.AccountEmployeeTimeEntry.CustomField2, dbo.AccountEmployeeTimeEntry.CustomField3, 
                      dbo.AccountEmployeeTimeEntry.CustomField4, dbo.AccountEmployeeTimeEntry.CustomField5, dbo.AccountEmployeeTimeEntry.CustomField6, 
                      dbo.AccountEmployeeTimeEntry.CustomField7, dbo.AccountEmployeeTimeEntry.CustomField8, dbo.AccountEmployeeTimeEntry.CustomField9, 
                      dbo.AccountEmployeeTimeEntry.CustomField10, dbo.AccountEmployeeTimeEntry.CustomField11, dbo.AccountEmployeeTimeEntry.CustomField12, 
                      dbo.AccountEmployeeTimeEntry.CustomField13, dbo.AccountEmployeeTimeEntry.CustomField14, dbo.AccountEmployeeTimeEntry.CustomField15, 
                      AccountProjectTask_1.StartDate AS TaskStartDate, AccountProjectTask_1.DeadlineDate AS TaskDeadlineDate
FROM         dbo.AccountHolidayTypeDetail RIGHT OUTER JOIN
                      dbo.AccountEmployeeTimeEntry INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeEntry.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId ON 
                      dbo.AccountHolidayTypeDetail.AccountHolidayTypeId = dbo.AccountEmployee.AccountHolidayTypeId AND 
                      dbo.AccountHolidayTypeDetail.AccountId = dbo.AccountEmployee.AccountId AND 
                      dbo.AccountHolidayTypeDetail.HolidayDate = dbo.AccountEmployeeTimeEntry.TimeEntryDate LEFT OUTER JOIN
                      dbo.AccountEmployeeType ON dbo.AccountEmployee.EmployeePayTypeId = dbo.AccountEmployeeType.AccountEmployeeTypeId LEFT OUTER JOIN
                      dbo.AccountProjectTask AS AccountProjectTask_1 LEFT OUTER JOIN
                      dbo.AccountProjectTask ON AccountProjectTask_1.ParentAccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId ON 
                      dbo.AccountEmployeeTimeEntry.AccountProjectTaskId = AccountProjectTask_1.AccountProjectTaskId LEFT OUTER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountStatus ON dbo.AccountProject.ProjectStatusId = dbo.AccountStatus.AccountStatusId LEFT OUTER JOIN
                      dbo.AccountTimeOffType ON dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId LEFT OUTER JOIN
                      dbo.AccountPartyDepartment ON dbo.AccountProject.AccountPartyDepartmentId = dbo.AccountPartyDepartment.AccountPartyDepartmentId LEFT OUTER JOIN
                      dbo.AccountPartyContact ON dbo.AccountProject.AccountPartyContactId = dbo.AccountPartyContact.AccountPartyContactId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryPeriod ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId LEFT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryApprovalLastAction.AccountEmployeeTimeEntryId LEFT OUTER JOIN
                      dbo.AccountCostCenter ON dbo.AccountEmployeeTimeEntry.AccountCostCenterId = dbo.AccountCostCenter.AccountCostCenterId LEFT OUTER JOIN
                      dbo.AccountWorkType ON dbo.AccountEmployeeTimeEntry.AccountWorkTypeId = dbo.AccountWorkType.AccountWorkTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId LEFT OUTER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId'
                      
GO
-- Create View vueAccountEmployeeTimeEntryForReport
Print 'Create View vueAccountEmployeeTimeEntryForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryForReport
AS
SELECT     dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeName, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskName, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalTime, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Approved, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TeamLeadApproved, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectManagerApproved, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AdministratorApproved, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeTimeEntryId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.StartTime, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EndTime, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Description, N'''') AS Description, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.WeekDay, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountPartyId AS AccountClientId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.PartyName AS ClientName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectTaskId, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingType, N'''') 
                      AS BillingType, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectManagerEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ExpenseApprovalTypeId, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.IsBillable, 0) 
                      AS IsBillable, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Rejected, 0) AS Rejected, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRate, 0) AS BillingRate, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectBillingRateTypeId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeCode, N'''') AS EmployeeCode, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountDepartmentId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.DepartmentName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedCost, 0) AS EstimatedCost, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedTimeSpent, 0) AS EstimatedHours, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Submitted, 0) AS Submitted, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountWorkType, N'''') AS AccountWorkType, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EMailAddress, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountLocation, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountCostCenter, N'''') AS AccountCostCenter, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountCostCenterCode, N'''') AS AccountCostCenterCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountWorkTypeCode, N'''') AS AccountWorkTypeCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectCode, N'''') AS ProjectCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCode, N'''') AS TaskCode, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountLocationId, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Comments, N'''') 
                      AS ApproverComments, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes * dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRate / 60, 0) 
                      AS Amount, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRateCurrencyId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateExchangeRate, 0) AS BillingRateExchangeRate, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRateExchangeRate, 0) AS EmployeeRateExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountBaseCurrencyId, dbo.vueAccountCurrency.CurrencyCode AS BillingRateCurrencyCode, 
                      dbo.vueAccountCurrency.CurrencyCode AS AmountCurrencyCode, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountTaskTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskStatusId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountPriorityId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectMilestoneId, dbo.AccountTaskType.TaskType, dbo.AccountStatus.Status AS TaskStatus, 
                      dbo.AccountProjectMilestone.MilestoneDescription, dbo.AccountPriority.Priority, CONVERT(float, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes) / 60 AS TotalHours, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.DepartmentCode, N'''') AS DepartmentCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.PartyNick, N'''') AS ClientNick, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedCurrencyId, vueAccountCurrency_1.CurrencyCode AS EstimatedCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ApprovedOn, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRate, 0) 
                      AS EmployeeRate, vueAccountCurrency_2.CurrencyCode AS EmployeeRateCurrencyCode, 
                      AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName AS TeamLeader, 
                      AccountEmployee_2.FirstName + '' '' + AccountEmployee_2.LastName AS ProjectManager, 
                      ISNULL(dbo.AccountEmployee.FirstName + N'' '' + dbo.AccountEmployee.LastName, N'''') AS EmployeeManager, 
                      vueAccountCurrency_1.ExchangeRate AS EstimatedCurrencyExchangeRate, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes * dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRate / 60, 0) 
                      AS EmployeeCost, { fn DAYOFMONTH(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) } AS DayNo, 
                      MONTH(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) AS MonthNo, DATEPART(week, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) - DATEPART(week, DATEADD(month, DATEDIFF(month, 0, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate), 0)) + 1 AS WeekNo, 
                      YEAR(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) AS Year, 
                      LEFT({ fn MONTHNAME(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) }, 3) + '' - '' + CONVERT(nvarchar(10), 
                      YEAR(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate)) AS Period, 
                      { fn DAYNAME(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) } AS WeekDayName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountRoleId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Role, 
                      dbo.AccountProjectType.ProjectType, dbo.AccountRole.Role AS ProjectRole, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectDescription, N'''') 
                      AS ProjectDescription, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskDescription, N'''') AS TaskDescription, 
                      dbo.AccountTimeExpenseBilling.InvoiceNumber, dbo.AccountTimeExpenseBilling.InvoiceDate, dbo.AccountProjectType.AccountProjectTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Billed, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeTimeEntryPeriodId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientContactName, N'''') AS ClientContactName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentCode, N'''') AS ClientDepartmentCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentName, N'''') AS ClientDepartmentName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentLocation, N'''') AS ClientDepartmentLocation, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.IsTimeOff, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountWorkTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectStatus, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ParentTaskName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.FirstName, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.LastName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeType, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.HolidayName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField1, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField2, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField3, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField4, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField5, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField6, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField7, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField8, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField9, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField10, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField11, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField12, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField13, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField14, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField15, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskStartDate, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskDeadlineDate
FROM         dbo.AccountRole INNER JOIN
                      dbo.AccountProjectEmployee ON dbo.AccountRole.AccountRoleId = dbo.AccountProjectEmployee.AccountRoleId RIGHT OUTER JOIN
                      dbo.AccountTimeExpenseBillingTimesheet INNER JOIN
                      dbo.AccountTimeExpenseBilling ON 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingId = dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId RIGHT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport LEFT OUTER JOIN
                      dbo.AccountProjectType ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectTypeId = dbo.AccountProjectType.AccountProjectTypeId LEFT OUTER JOIN
                      dbo.AccountProjectMilestone ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectMilestoneId = dbo.AccountProjectMilestone.AccountProjectMilestoneId LEFT OUTER JOIN
                      dbo.AccountStatus ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskStatusId = dbo.AccountStatus.AccountStatusId LEFT OUTER JOIN
                      dbo.AccountPriority ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountPriorityId = dbo.AccountPriority.AccountPriorityId LEFT OUTER JOIN
                      dbo.AccountTaskType ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountTaskTypeId = dbo.AccountTaskType.AccountTaskTypeId ON 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingTimesheetId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountTimeExpenseBillingTimesheetId
                       ON dbo.AccountProjectEmployee.AccountEmployeeId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeId AND 
                      dbo.AccountProjectEmployee.AccountProjectId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.LeaderEmployeeId = AccountEmployee_1.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_2 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectManagerEmployeeId = AccountEmployee_2.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.AccountEmployee AS AccountEmployee_3 ON dbo.AccountEmployee.AccountEmployeeId = AccountEmployee_3.EmployeeManagerId ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeId = AccountEmployee_3.AccountEmployeeId LEFT OUTER JOIN
                      dbo.vueAccountCurrency AS vueAccountCurrency_2 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRateCurrencyId = vueAccountCurrency_2.AccountCurrencyId LEFT OUTER JOIN
                      dbo.vueAccountCurrency AS vueAccountCurrency_1 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedCurrencyId = vueAccountCurrency_1.AccountCurrencyId LEFT OUTER JOIN
                      dbo.vueAccountCurrency ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateCurrencyId = dbo.vueAccountCurrency.AccountCurrencyId'

GO
-- Create View rptvueAccountEmployeeTimeEntry
Print 'Create View rptvueAccountEmployeeTimeEntry'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeEntry' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountEmployeeTimeEntry
AS
SELECT     dbo.vueAccountEmployeeTimeEntryForReport.EmployeeName, dbo.vueAccountEmployeeTimeEntryForReport.ProjectName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskName, dbo.vueAccountEmployeeTimeEntryForReport.TotalTime, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Approved, dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectId, dbo.vueAccountEmployeeTimeEntryForReport.TeamLeadApproved, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManagerApproved, dbo.vueAccountEmployeeTimeEntryForReport.AdministratorApproved, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeTimeEntryId, dbo.vueAccountEmployeeTimeEntryForReport.StartTime, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EndTime, dbo.vueAccountEmployeeTimeEntryForReport.TimeEntryDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Description, dbo.vueAccountEmployeeTimeEntryForReport.AccountId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TotalMinutes, dbo.vueAccountEmployeeTimeEntryForReport.WeekDay, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientName, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectTaskId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingType, dbo.vueAccountEmployeeTimeEntryForReport.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManagerEmployeeId, dbo.vueAccountEmployeeTimeEntryForReport.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ExpenseApprovalTypeId, dbo.vueAccountEmployeeTimeEntryForReport.IsBillable, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Rejected, dbo.vueAccountEmployeeTimeEntryForReport.BillingRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectBillingRateTypeId, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountDepartmentId, dbo.vueAccountEmployeeTimeEntryForReport.DepartmentName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCost, dbo.vueAccountEmployeeTimeEntryForReport.EstimatedHours, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Submitted, dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkType, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EMailAddress, dbo.vueAccountEmployeeTimeEntryForReport.AccountLocation, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountCostCenter, dbo.vueAccountEmployeeTimeEntryForReport.AccountCostCenterCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkTypeCode, dbo.vueAccountEmployeeTimeEntryForReport.ProjectCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCode, dbo.vueAccountEmployeeTimeEntryForReport.AccountLocationId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ApproverComments, dbo.vueAccountEmployeeTimeEntryForReport.Amount, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingRateCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountBaseCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.BillingRateCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AmountCurrencyCode, CASE WHEN vueAccountEmployeeTimeEntryForReport.Submitted = 1 AND 
                      vueAccountEmployeeTimeEntryForReport.Approved = 0 THEN ''Submitted'' WHEN vueAccountEmployeeTimeEntryForReport.Approved = 1 THEN ''Approved'' WHEN vueAccountEmployeeTimeEntryForReport.Rejected
                       = 1 THEN ''Rejected'' WHEN vueAccountEmployeeTimeEntryForReport.Submitted = 0 AND vueAccountEmployeeTimeEntryForReport.Approved = 0 AND 
                      vueAccountEmployeeTimeEntryForReport.Rejected = 0 THEN ''Not Submitted'' END AS ApprovalStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountTaskTypeId, dbo.vueAccountEmployeeTimeEntryForReport.TaskStatusId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountPriorityId, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectMilestoneId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskType, dbo.vueAccountEmployeeTimeEntryForReport.TaskStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.MilestoneDescription, dbo.vueAccountEmployeeTimeEntryForReport.Priority, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TotalHours, dbo.vueAccountEmployeeTimeEntryForReport.DepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientNick, dbo.vueAccountEmployeeTimeEntryForReport.AccountClientId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ApprovedOn, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateCurrencyCode, dbo.vueAccountEmployeeTimeEntryForReport.TeamLeader, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManager, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeManager, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate, 0) AS EstimatedCurrencyExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCost, dbo.vueAccountEmployeeTimeEntryForReport.AccountRoleId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Role, dbo.vueAccountEmployeeTimeEntryForReport.WeekDayName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Period, dbo.vueAccountEmployeeTimeEntryForReport.Year, dbo.vueAccountEmployeeTimeEntryForReport.WeekNo, 
                      dbo.vueAccountEmployeeTimeEntryForReport.MonthNo, dbo.vueAccountEmployeeTimeEntryForReport.DayNo, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 1 THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours ELSE 0 END AS BillableTotalHours,
                       CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable
                       IS NULL THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours ELSE 0 END AS NonBillableTotalHours, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCost / dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate
                       ELSE 0 END AS CurrencyEmployeeCost, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.Amount / dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate
                       ELSE 0 END AS CurrencyAmount, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCost / dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate
                       ELSE 0 END AS CurrencyEstimatedCost, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate / dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate
                       ELSE 0 END AS CurrencyBillingRate, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRate / dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate
                       ELSE 0 END AS CurrencyEmployeeRate, dbo.vueAccountEmployeeTimeEntryForReport.ProjectRole, dbo.vueAccountEmployeeTimeEntryForReport.ProjectType, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectDescription, dbo.vueAccountEmployeeTimeEntryForReport.TaskDescription, 
                      dbo.vueAccountEmployeeTimeEntryForReport.InvoiceNumber, dbo.vueAccountEmployeeTimeEntryForReport.InvoiceDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectTypeId, dbo.vueAccountEmployeeTimeEntryForReport.Billed, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientContactName, dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentName, dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentLocation, 
                      dbo.vueAccountEmployeeTimeEntryForReport.IsTimeOff, dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkTypeId, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 1 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate * dbo.vueAccountEmployeeTimeEntryForReport.TotalHours
                       ELSE 0 END AS BillableTotalAmount, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate * dbo.vueAccountEmployeeTimeEntryForReport.TotalHours
                       ELSE 0 END AS NonBillableTotalAmount, dbo.vueAccountEmployeeTimeEntryForReport.ProjectStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ParentTaskName, dbo.vueAccountEmployeeTimeEntryForReport.FirstName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.LastName, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeType, 
                      dbo.vueAccountEmployeeTimeEntryForReport.HolidayName, SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithLastStatus.Percentage, 0)) AS Percentage, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField1, dbo.vueAccountEmployeeTimeEntryForReport.CustomField2, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField3, dbo.vueAccountEmployeeTimeEntryForReport.CustomField4, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField5, dbo.vueAccountEmployeeTimeEntryForReport.CustomField6, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField7, dbo.vueAccountEmployeeTimeEntryForReport.CustomField8, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField9, dbo.vueAccountEmployeeTimeEntryForReport.CustomField10, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField11, dbo.vueAccountEmployeeTimeEntryForReport.CustomField12, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField13, dbo.vueAccountEmployeeTimeEntryForReport.CustomField14, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField15, dbo.vueAccountEmployeeTimeEntryForReport.TaskStartDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskDeadlineDate
FROM         dbo.vueAccountEmployeeTimeEntryForReport INNER JOIN
                      dbo.vueAccountEmployeeTimeEntryWithLastStatus ON 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryWithLastStatus.AccountEmployeeTimeEntryId
GROUP BY dbo.vueAccountEmployeeTimeEntryForReport.EmployeeName, dbo.vueAccountEmployeeTimeEntryForReport.ProjectName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskName, dbo.vueAccountEmployeeTimeEntryForReport.TotalTime, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeId, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeTimeEntryId, dbo.vueAccountEmployeeTimeEntryForReport.StartTime, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EndTime, dbo.vueAccountEmployeeTimeEntryForReport.TimeEntryDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Description, dbo.vueAccountEmployeeTimeEntryForReport.AccountId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TotalMinutes, dbo.vueAccountEmployeeTimeEntryForReport.WeekDay, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientName, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectTaskId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingType, dbo.vueAccountEmployeeTimeEntryForReport.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManagerEmployeeId, dbo.vueAccountEmployeeTimeEntryForReport.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ExpenseApprovalTypeId, dbo.vueAccountEmployeeTimeEntryForReport.BillingRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectBillingRateTypeId, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountDepartmentId, dbo.vueAccountEmployeeTimeEntryForReport.DepartmentName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCost, dbo.vueAccountEmployeeTimeEntryForReport.EstimatedHours, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkType, dbo.vueAccountEmployeeTimeEntryForReport.EMailAddress, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountLocation, dbo.vueAccountEmployeeTimeEntryForReport.AccountCostCenter, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountCostCenterCode, dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkTypeCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectCode, dbo.vueAccountEmployeeTimeEntryForReport.TaskCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountLocationId, dbo.vueAccountEmployeeTimeEntryForReport.ApproverComments, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Amount, dbo.vueAccountEmployeeTimeEntryForReport.BillingRateCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate, dbo.vueAccountEmployeeTimeEntryForReport.AccountBaseCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingRateCurrencyCode, dbo.vueAccountEmployeeTimeEntryForReport.AmountCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountTaskTypeId, dbo.vueAccountEmployeeTimeEntryForReport.TaskStatusId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountPriorityId, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectMilestoneId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskType, dbo.vueAccountEmployeeTimeEntryForReport.TaskStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.MilestoneDescription, dbo.vueAccountEmployeeTimeEntryForReport.Priority, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TotalHours, dbo.vueAccountEmployeeTimeEntryForReport.DepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientNick, dbo.vueAccountEmployeeTimeEntryForReport.AccountClientId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ApprovedOn, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateCurrencyCode, dbo.vueAccountEmployeeTimeEntryForReport.TeamLeader, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManager, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeManager, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate, 0), dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCost, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountRoleId, dbo.vueAccountEmployeeTimeEntryForReport.Role, 
                      dbo.vueAccountEmployeeTimeEntryForReport.WeekDayName, dbo.vueAccountEmployeeTimeEntryForReport.Period, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Year, dbo.vueAccountEmployeeTimeEntryForReport.WeekNo, dbo.vueAccountEmployeeTimeEntryForReport.MonthNo, 
                      dbo.vueAccountEmployeeTimeEntryForReport.DayNo, dbo.vueAccountEmployeeTimeEntryForReport.ProjectRole, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectType, dbo.vueAccountEmployeeTimeEntryForReport.ProjectDescription, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskDescription, dbo.vueAccountEmployeeTimeEntryForReport.InvoiceNumber, 
                      dbo.vueAccountEmployeeTimeEntryForReport.InvoiceDate, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectTypeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientContactName, dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentName, dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentLocation, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkTypeId, dbo.vueAccountEmployeeTimeEntryForReport.ProjectStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ParentTaskName, dbo.vueAccountEmployeeTimeEntryForReport.FirstName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.LastName, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeType, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Approved, dbo.vueAccountEmployeeTimeEntryForReport.TeamLeadApproved, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManagerApproved, dbo.vueAccountEmployeeTimeEntryForReport.AdministratorApproved, 
                      dbo.vueAccountEmployeeTimeEntryForReport.IsBillable, dbo.vueAccountEmployeeTimeEntryForReport.Rejected, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Submitted, dbo.vueAccountEmployeeTimeEntryForReport.Billed, 
                      dbo.vueAccountEmployeeTimeEntryForReport.IsTimeOff, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate * dbo.vueAccountEmployeeTimeEntryForReport.TotalHours
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 1 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate * dbo.vueAccountEmployeeTimeEntryForReport.TotalHours
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRate / dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate / dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCost / dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.Amount / dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCost / dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable
                       IS NULL THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 1 THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours ELSE 0 END, 
                      CASE WHEN vueAccountEmployeeTimeEntryForReport.Submitted = 1 AND 
                      vueAccountEmployeeTimeEntryForReport.Approved = 0 THEN ''Submitted'' WHEN vueAccountEmployeeTimeEntryForReport.Approved = 1 THEN ''Approved'' WHEN vueAccountEmployeeTimeEntryForReport.Rejected
                       = 1 THEN ''Rejected'' WHEN vueAccountEmployeeTimeEntryForReport.Submitted = 0 AND vueAccountEmployeeTimeEntryForReport.Approved = 0 AND 
                      vueAccountEmployeeTimeEntryForReport.Rejected = 0 THEN ''Not Submitted'' END, dbo.vueAccountEmployeeTimeEntryForReport.HolidayName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField1, dbo.vueAccountEmployeeTimeEntryForReport.CustomField2, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField3, dbo.vueAccountEmployeeTimeEntryForReport.CustomField4, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField5, dbo.vueAccountEmployeeTimeEntryForReport.CustomField6, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField7, dbo.vueAccountEmployeeTimeEntryForReport.CustomField8, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField9, dbo.vueAccountEmployeeTimeEntryForReport.CustomField10, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField11, dbo.vueAccountEmployeeTimeEntryForReport.CustomField12, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField13, dbo.vueAccountEmployeeTimeEntryForReport.CustomField14, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField15, dbo.vueAccountEmployeeTimeEntryForReport.TaskStartDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskDeadlineDate'

GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'
If Not Exists(Select * from [dbo].[SystemReportDataSourceField] Where [SystemReportDataSourceFieldId] = '06f5fdbc-7cad-40a0-a7c7-85688e6b4151')
BEGIN
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('06f5fdbc-7cad-40a0-a7c7-85688e6b4151', '3a080202-6842-4eca-8c79-a945978810b4', N'TaskDeadlineDate', 125, 0, NULL, NULL, 74, '48b9ef68-b4f6-4c75-b8de-c547939179ce', N'Task Deadline Date', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('4ae746f9-7ea1-4d53-8cdd-04916afd04f4', '3a080202-6842-4eca-8c79-a945978810b4', N'TaskStartDate', 125, 0, NULL, NULL, 73, '48b9ef68-b4f6-4c75-b8de-c547939179ce', N'Task Start Date', 0, 0)
END

GO
-- Drop View vueAccountEmployeeTimeEntryWithTimeOffForReport
Print 'Drop View vueAccountEmployeeTimeEntryWithTimeOffForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithTimeOffForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryWithTimeOffForReport]

GO
-- Drop View vueExternalAccountEmployee
Print 'Drop View vueExternalAccountEmployee'
GO
if exists (select * from information_schema.tables where table_name = 'vueExternalAccountEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueExternalAccountEmployee]

GO
-- Drop View vueAccountProjects
Print 'Drop View vueAccountProjects'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountProjects' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountProjects]

GO
-- Drop View vueAccountProjectEmployeFullJoin
Print 'Drop View vueAccountProjectEmployeFullJoin'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountProjectEmployeFullJoin' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountProjectEmployeFullJoin]

GO
-- Drop View vueAccountProjectTeamForReport
Print 'Drop View vueAccountProjectTeamForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountProjectTeamForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountProjectTeamForReport]

GO
-- Drop View VueAccountProjectTaskEmployeeForReport
Print 'Drop View VueAccountProjectTaskEmployeeForReport'
GO
if exists (select * from information_schema.tables where table_name = 'VueAccountProjectTaskEmployeeForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[VueAccountProjectTaskEmployeeForReport]

GO
-- Drop View vueAccountClientForReport
Print 'Drop View vueAccountClientForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountClientForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountClientForReport]

GO
-- Drop View vueAccountExpenseEntry
Print 'Drop View vueAccountExpenseEntry'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntry' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountExpenseEntry]

GO
-- Drop View vueAccountProjectTaskEmployee
Print 'Drop View vueAccountProjectTaskEmployee'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountProjectTaskEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountProjectTaskEmployee]

GO
-- Drop View vueAccountProjectsOnlyForReport
Print 'Drop View vueAccountProjectsOnlyForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountProjectsOnlyForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountProjectsOnlyForReport]

GO
-- Drop View vueAccountProjectTaskForReport
Print 'Drop View vueAccountProjectTaskForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountProjectTaskForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountProjectTaskForReport]

GO
-- Drop View vueAccountProjectTask
Print 'Drop View vueAccountProjectTask'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountProjectTask' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountProjectTask]

GO
-- Create View vueAccountProjectTask
Print 'Create View vueAccountProjectTask'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountProjectTask' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountProjectTask
AS
SELECT     dbo.AccountProjectTask.AccountProjectTaskId, dbo.AccountProjectTask.AccountProjectId, dbo.AccountProjectTask.ParentAccountProjectTaskId, 
                      dbo.AccountProjectTask.TaskName, dbo.AccountProjectTask.TaskDescription, dbo.AccountProjectTask.AccountTaskTypeId, dbo.AccountProjectTask.Duration, 
                      dbo.AccountProjectTask.DurationUnit, dbo.AccountProjectTask.DeadlineDate, dbo.AccountProjectTask.CompletedPercent, dbo.AccountProjectTask.Completed, 
                      dbo.AccountProjectTask.IsParentTask, dbo.AccountProjectTask.IsForAllEmployees, dbo.AccountProjectTask.AccountPriorityId, dbo.AccountProjectTask.TaskStatusId, 
                      dbo.AccountProjectTask.CreatedOn, dbo.AccountProjectTask.CreatedByEmployeeId, dbo.AccountProjectTask.ModifiedOn, 
                      dbo.AccountProjectTask.ModifiedByEmployeeId, dbo.AccountStatus.Status AS TaskStatus, dbo.AccountEmployee.FirstName AS CreatedByFirstName, 
                      dbo.AccountEmployee.LastName AS CreatedByLastName, dbo.AccountPriority.Priority, dbo.AccountProject.ProjectName, dbo.AccountProject.ProjectCode, 
                      dbo.AccountTaskType.TaskType, dbo.AccountProject.AccountId, dbo.AccountProjectTask.AccountProjectMilestoneId, 
                      dbo.AccountProjectMilestone.MilestoneDescription, dbo.AccountProjectTask.IsReOpen, AccountEmployee_1.FirstName AS ModifiedByFirstName, 
                      AccountEmployee_1.LastName AS ModifiedByLastName, dbo.AccountProjectTask.EstimatedCost, dbo.AccountProjectTask.EstimatedTimeSpent, 
                      dbo.AccountProjectTask.EstimatedTimeSpentUnit, dbo.AccountEmployee.AccountEmployeeId, dbo.AccountProjectTask.IsDisabled, dbo.AccountProjectTask.TaskCode, 
                      dbo.AccountProject.IsTemplate, dbo.AccountProjectTask.IsForAllProjectTask, dbo.AccountProjectTask.IsBillable, dbo.AccountProjectTask.EstimatedCurrencyId, 
                      dbo.AccountParty.PartyName, dbo.AccountParty.PartyNick, dbo.AccountProject.AccountClientId, dbo.AccountProject.ProjectDescription, 
                      dbo.AccountProjectMilestone.MilestoneDate, dbo.AccountProject.IsDeleted AS IsProjectDeleted, dbo.AccountProjectTask.StartDate, 
                      dbo.AccountParty.IsDeleted AS IsDeletedClient
FROM         dbo.AccountTaskType RIGHT OUTER JOIN
                      dbo.AccountProjectMilestone RIGHT OUTER JOIN
                      dbo.AccountProject INNER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId RIGHT OUTER JOIN
                      dbo.AccountProjectTask LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON dbo.AccountProjectTask.ModifiedByEmployeeId = AccountEmployee_1.AccountEmployeeId ON 
                      dbo.AccountProject.AccountProjectId = dbo.AccountProjectTask.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountEmployee ON dbo.AccountProjectTask.CreatedByEmployeeId = dbo.AccountEmployee.AccountEmployeeId ON 
                      dbo.AccountProjectMilestone.AccountProjectMilestoneId = dbo.AccountProjectTask.AccountProjectMilestoneId ON 
                      dbo.AccountTaskType.AccountTaskTypeId = dbo.AccountProjectTask.AccountTaskTypeId LEFT OUTER JOIN
                      dbo.AccountStatus ON dbo.AccountProjectTask.TaskStatusId = dbo.AccountStatus.AccountStatusId LEFT OUTER JOIN
                      dbo.AccountPriority ON dbo.AccountProjectTask.AccountPriorityId = dbo.AccountPriority.AccountPriorityId'

GO
-- Create View vueAccountProjectTaskForReport
Print 'Create View vueAccountProjectTaskForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountProjectTaskForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountProjectTaskForReport
AS
SELECT     dbo.vueAccountProjectTask.AccountProjectTaskId, dbo.vueAccountProjectTask.AccountProjectId, dbo.vueAccountProjectTask.ParentAccountProjectTaskId, 
                      dbo.vueAccountProjectTask.TaskName, dbo.vueAccountProjectTask.TaskDescription, dbo.vueAccountProjectTask.AccountTaskTypeId, 
                      dbo.vueAccountProjectTask.DeadlineDate, dbo.vueAccountProjectTask.CompletedPercent, dbo.vueAccountProjectTask.Completed, 
                      dbo.vueAccountProjectTask.IsParentTask, dbo.vueAccountProjectTask.IsForAllEmployees, dbo.vueAccountProjectTask.AccountPriorityId, 
                      dbo.vueAccountProjectTask.TaskStatusId, dbo.vueAccountProjectTask.CreatedOn, dbo.vueAccountProjectTask.CreatedByEmployeeId, 
                      dbo.vueAccountProjectTask.ModifiedOn, dbo.vueAccountProjectTask.ModifiedByEmployeeId, dbo.vueAccountProjectTask.TaskStatus, 
                      dbo.vueAccountProjectTask.CreatedByFirstName, dbo.vueAccountProjectTask.CreatedByLastName, dbo.vueAccountProjectTask.Priority, 
                      dbo.vueAccountProjectTask.ProjectName, dbo.vueAccountProjectTask.ProjectCode, dbo.vueAccountProjectTask.TaskType, dbo.vueAccountProjectTask.AccountId, 
                      dbo.vueAccountProjectTask.AccountProjectMilestoneId, dbo.vueAccountProjectTask.MilestoneDescription, dbo.vueAccountProjectTask.IsReOpen, 
                      dbo.vueAccountProjectTask.ModifiedByFirstName, dbo.vueAccountProjectTask.ModifiedByLastName, dbo.vueAccountProjectTask.EstimatedCost, 
                      dbo.vueAccountProjectTask.EstimatedTimeSpent AS EstimatedHours, dbo.vueAccountProjectTask.EstimatedTimeSpentUnit, 
                      dbo.vueAccountProjectTask.AccountEmployeeId, dbo.vueAccountProjectTask.IsDisabled, dbo.vueAccountProjectTask.TaskCode, 
                      dbo.vueAccountProjectTask.IsTemplate, dbo.vueAccountProjectTask.IsForAllProjectTask, dbo.vueAccountProjectTask.IsBillable, 
                      dbo.AccountParty.AccountPartyId AS AccountClientId, dbo.AccountParty.PartyNick AS ClientNick, dbo.AccountParty.PartyName AS ClientName, CONVERT(nvarchar(200), 
                      dbo.vueAccountProjectTask.Duration) + '' - '' + dbo.vueAccountProjectTask.DurationUnit AS Duration, dbo.AccountProjectTask.TaskName AS ParentTaskName, 
                      dbo.vueAccountProjectTask.EstimatedCurrencyId, dbo.vueAccountCurrency.CurrencyCode AS EstimatedCurrencyCode, dbo.vueAccountProjectTask.ProjectDescription, 
                      dbo.vueAccountProjectTask.MilestoneDate, dbo.vueAccountProjectTask.StartDate, dbo.AccountParty.IsDeleted
FROM         dbo.vueAccountProjectTask INNER JOIN
                      dbo.AccountProject ON dbo.vueAccountProjectTask.AccountProjectId = dbo.AccountProject.AccountProjectId INNER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId LEFT OUTER JOIN
                      dbo.vueAccountCurrency ON dbo.vueAccountProjectTask.EstimatedCurrencyId = dbo.vueAccountCurrency.AccountCurrencyId LEFT OUTER JOIN
                      dbo.AccountProjectTask ON dbo.vueAccountProjectTask.ParentAccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId
WHERE     (dbo.AccountParty.IsDeleted <> 1) OR
                      (dbo.AccountParty.IsDeleted IS NULL)'

GO
-- Create View vueAccountProjectsOnlyForReport
Print 'Create View vueAccountProjectsOnlyForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountProjectsOnlyForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountProjectsOnlyForReport
AS
SELECT     dbo.AccountProject.AccountProjectId, dbo.AccountProject.AccountId, dbo.AccountProject.AccountProjectTypeId, dbo.AccountProject.AccountClientId, 
                      dbo.AccountProject.ProjectBillingTypeId, dbo.AccountProject.ProjectName, dbo.AccountProject.ProjectDescription, dbo.AccountProject.StartDate, 
                      dbo.AccountProject.AccountMilestoneId, dbo.AccountProject.Deadline, dbo.AccountProject.LeaderEmployeeId, dbo.AccountProject.ProjectManagerEmployeeId, 
                      dbo.AccountProject.EstimatedTime, dbo.AccountProject.EstimatedDurationUnit, dbo.AccountProject.ProjectCode, dbo.AccountProject.DefaultBillingRate, 
                      dbo.AccountProject.IsActive, dbo.AccountProject.ProjectStatusId, dbo.AccountProject.AccountPriorityId, dbo.AccountProject.CreatedOn, 
                      dbo.AccountProject.CreatedByEmployeeId, dbo.AccountProject.ModifiedOn, dbo.AccountProject.ModifiedByEmployeeId, dbo.AccountProject.ProjectBillingRateTypeId, 
                      dbo.AccountProject.TimeSheetApprovalTypeId, dbo.AccountProject.ExpenseApprovalTypeId, dbo.AccountProject.AccountPartyContactId AS AccountClientContactId, 
                      dbo.AccountProject.AccountPartyDepartmentId AS AccountClientDepartmentId, dbo.AccountProject.IsDisabled, dbo.AccountProject.IsTemplate, 
                      dbo.AccountProject.IsProject, dbo.AccountProject.AccountProjectTemplateId, dbo.AccountParty.PartyNick AS ClientNick, dbo.AccountParty.PartyName AS ClientName, 
                      dbo.AccountProjectType.ProjectType, dbo.AccountBillingType.BillingType, dbo.AccountStatus.Status, CONVERT(nvarchar(200), dbo.AccountProject.EstimatedDuration) 
                      AS EstimatedDuration, dbo.AccountPartyDepartment.PartyDepartmentCode AS ClientDepartmentCode, 
                      dbo.AccountPartyDepartment.PartyDepartmentName AS ClientDepartmentName, dbo.AccountPartyDepartment.PartyDepartmentLocation AS ClientDepartmentLocation, 
                      dbo.AccountPartyContact.FirstName + '' '' + dbo.AccountPartyContact.LastName AS ClientContactName, 
                      AccountApprovalType_1.ApprovalTypeName AS ExpenseApprovalTypeName, dbo.AccountApprovalType.ApprovalTypeName AS TimesheetApprovalTypeName, 
                      AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName AS TeamLead, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS ProjectManager, 
                      dbo.SystemProjectBillingRateType.SystemProjectBillingRateType AS ProjectBillingRateType, dbo.AccountProject.CustomField1, dbo.AccountProject.CustomField2, 
                      dbo.AccountProject.CustomField3, dbo.AccountProject.CustomField4, dbo.AccountProject.CustomField5, dbo.AccountProject.CustomField6, 
                      dbo.AccountProject.CustomField7, dbo.AccountProject.CustomField8, dbo.AccountProject.CustomField9, dbo.AccountProject.CustomField10, 
                      dbo.AccountProject.CustomField11, dbo.AccountProject.CustomField12, dbo.AccountProject.CustomField13, dbo.AccountProject.CustomField14, 
                      dbo.AccountProject.CustomField15
FROM         dbo.AccountPartyContact RIGHT OUTER JOIN
                      dbo.AccountProject INNER JOIN
                      dbo.Account ON dbo.AccountProject.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId AND dbo.Account.AccountId = dbo.AccountParty.AccountId INNER JOIN
                      dbo.AccountProjectType ON dbo.AccountProject.AccountProjectTypeId = dbo.AccountProjectType.AccountProjectTypeId AND 
                      dbo.Account.AccountId = dbo.AccountProjectType.AccountId INNER JOIN
                      dbo.AccountBillingType ON dbo.AccountProject.ProjectBillingTypeId = dbo.AccountBillingType.AccountBillingTypeId AND 
                      dbo.Account.AccountId = dbo.AccountBillingType.AccountId INNER JOIN
                      dbo.AccountStatus ON dbo.AccountProject.ProjectStatusId = dbo.AccountStatus.AccountStatusId AND 
                      dbo.Account.AccountId = dbo.AccountStatus.AccountId LEFT OUTER JOIN
                      dbo.SystemProjectBillingRateType ON 
                      dbo.AccountProject.ProjectBillingRateTypeId = dbo.SystemProjectBillingRateType.SystemProjectBillingRateTypeId LEFT OUTER JOIN
                      dbo.AccountEmployee ON dbo.AccountProject.ProjectManagerEmployeeId = dbo.AccountEmployee.AccountEmployeeId AND 
                      dbo.Account.AccountId = dbo.AccountEmployee.AccountId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON dbo.AccountProject.LeaderEmployeeId = AccountEmployee_1.AccountEmployeeId AND 
                      dbo.Account.AccountId = AccountEmployee_1.AccountId LEFT OUTER JOIN
                      dbo.AccountApprovalType ON dbo.AccountProject.TimeSheetApprovalTypeId = dbo.AccountApprovalType.AccountApprovalTypeId AND 
                      dbo.Account.AccountId = dbo.AccountApprovalType.AccountId LEFT OUTER JOIN
                      dbo.AccountApprovalType AS AccountApprovalType_1 ON dbo.AccountProject.ExpenseApprovalTypeId = AccountApprovalType_1.AccountApprovalTypeId AND 
                      dbo.Account.AccountId = AccountApprovalType_1.AccountId LEFT OUTER JOIN
                      dbo.AccountPartyDepartment ON dbo.AccountProject.AccountPartyDepartmentId = dbo.AccountPartyDepartment.AccountPartyDepartmentId ON 
                      dbo.AccountPartyContact.AccountPartyContactId = dbo.AccountProject.AccountPartyContactId
WHERE     (dbo.AccountProject.IsTemplate <> 1) AND (dbo.AccountProject.IsDeleted IS NULL OR
                      dbo.AccountProject.IsDeleted <> 1) AND (dbo.AccountParty.IsDeleted IS NULL OR
                      dbo.AccountParty.IsDeleted <> 1)'

GO
-- Create View vueAccountProjectTaskEmployee
Print 'Create View vueAccountProjectTaskEmployee'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountProjectTaskEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountProjectTaskEmployee
AS
SELECT     dbo.AccountProjectTaskEmployee.AccountProjectTaskEmployeeId, dbo.AccountProjectTask.AccountProjectId, dbo.AccountProjectTask.AccountProjectTaskId, 
                      dbo.AccountProjectTask.TaskName, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.AccountEmployeeId, 
                      dbo.AccountProject.AccountId, dbo.AccountProject.ProjectCode, dbo.AccountProjectTask.TaskStatusId, dbo.AccountProjectTask.Completed, 
                      dbo.AccountEmployee.EMailAddress, dbo.AccountProject.ProjectName, dbo.AccountProject.IsDeleted AS IsDeletedProject, 
                      dbo.AccountParty.IsDeleted AS IsDeletedParty
FROM         dbo.AccountProject LEFT OUTER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId RIGHT OUTER JOIN
                      dbo.AccountEmployee RIGHT OUTER JOIN
                      dbo.AccountProjectTaskEmployee INNER JOIN
                      dbo.AccountProjectTask ON dbo.AccountProjectTaskEmployee.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId ON 
                      dbo.AccountEmployee.AccountEmployeeId = dbo.AccountProjectTaskEmployee.AccountEmployeeId ON 
                      dbo.AccountProject.AccountProjectId = dbo.AccountProjectTask.AccountProjectId'

GO
-- Create View vueAccountExpenseEntry
Print 'Create View vueAccountExpenseEntry'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntry' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountExpenseEntry
AS
SELECT     CASE WHEN dbo.AccountEmployee.IsDisabled = 1 THEN dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE dbo.AccountEmployee.FirstName
                       + '' '' + dbo.AccountEmployee.LastName END AS EmployeeName, dbo.AccountExpense.AccountExpenseName, dbo.AccountProject.ProjectName, 
                      dbo.AccountExpenseEntry.AccountExpenseEntryId, dbo.AccountExpenseEntry.AccountExpenseEntryDate, dbo.AccountExpenseEntry.AccountId, 
                      dbo.AccountExpenseEntry.AccountEmployeeId, dbo.AccountExpenseEntry.AccountProjectId, dbo.AccountExpenseEntry.AccountExpenseId, 
                      dbo.AccountExpenseEntry.Amount, dbo.AccountExpenseEntry.TeamLeadApproved, dbo.AccountExpenseEntry.ProjectManagerApproved, 
                      dbo.AccountExpenseEntry.AdministratorApproved, dbo.AccountExpenseEntry.Approved, dbo.AccountExpenseEntry.CreatedOn, 
                      dbo.AccountExpenseEntry.CreatedByEmployeeId, dbo.AccountExpenseEntry.ModifiedOn, dbo.AccountExpenseEntry.ModifiedByEmployeeId, 
                      dbo.AccountParty.PartyName, dbo.AccountProject.AccountClientId, dbo.AccountExpenseEntry.Description, dbo.AccountExpenseType.ExpenseType, 
                      dbo.AccountExpense.AccountExpenseTypeId, dbo.AccountProject.LeaderEmployeeId, dbo.AccountExpenseEntry.IsBillable, dbo.AccountExpenseEntry.Rejected, 
                      dbo.AccountEmployee.EmployeeCode, dbo.AccountExpenseEntry.Reimburse, dbo.AccountExpenseEntry.AccountCurrencyId, dbo.SystemCurrency.CurrencyCode, 
                      dbo.AccountExpenseType.IsQuantityField, dbo.AccountExpenseType.QuantityFieldCaption, dbo.AccountExpenseEntry.AccountBaseCurrencyId, 
                      dbo.AccountExpenseEntry.ExchangeRate, ISNULL(dbo.AccountExpenseEntry.TaxAmount, 0) AS TaxAmount, ISNULL(dbo.AccountExpenseEntry.AmountBeforeTax, 0) 
                      AS NetAmount, dbo.AccountExpenseEntry.Submitted, dbo.AccountProject.TimeSheetApprovalTypeId, dbo.AccountProject.ExpenseApprovalTypeId, 
                      dbo.AccountProject.ProjectManagerEmployeeId, dbo.AccountExpenseEntry.TimeSheetApprovalPathId, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountLocation.AccountLocation, dbo.AccountTaxZone.AccountTaxZone, dbo.AccountExpenseEntry.Quantity, 
                      dbo.AccountExpenseEntry.Rate, dbo.AccountPaymentMethod.PaymentMethod, dbo.AccountLocation.AccountLocationId, dbo.AccountParty.PartyNick, 
                      dbo.AccountProject.ProjectDescription, dbo.AccountProject.ProjectCode, dbo.AccountDepartment.DepartmentCode, 
                      dbo.vueAccountExpenseEntryApprovalLastAction.Comments, dbo.vueAccountExpenseEntryApprovalLastAction.ApprovedOn, 
                      dbo.AccountDepartment.AccountDepartmentId, dbo.AccountRole.Role, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountExpenseEntry.AccountTimeExpenseBillingExpenseId, dbo.AccountExpenseEntry.Billed, dbo.AccountTimeExpenseBilling.InvoiceNumber, 
                      dbo.AccountTimeExpenseBilling.InvoiceDate, dbo.AccountProjectType.AccountProjectTypeId, dbo.AccountProjectType.ProjectType, 
                      dbo.AccountExpenseEntry.AccountEmployeeExpenseSheetId, dbo.AccountEmployeeExpenseSheet.Description AS ExpenseSheetDescription, 
                      dbo.AccountEmployeeExpenseSheet.ExpenseSheetDate, dbo.AccountEmployeeExpenseSheet.SubmittedDate, 
                      dbo.AccountEmployeeExpenseSheet.Approved AS SheetApproved, dbo.AccountEmployeeExpenseSheet.Rejected AS SheetRejected, 
                      dbo.AccountEmployeeExpenseSheet.Submitted AS SheetSubmitted, dbo.AccountEmployeeExpenseSheet.InApproval AS SheetInApproval, 
                      dbo.AccountTaxCode.TaxCode, dbo.AccountTaxCode.Formula, dbo.AccountTaxCode.AccountTaxCodeId, dbo.AccountProjectTask.TaskName, 
                      dbo.AccountParty.IsDeleted
FROM         dbo.AccountLocation RIGHT OUTER JOIN
                      dbo.SystemCurrency RIGHT OUTER JOIN
                      dbo.AccountCurrency RIGHT OUTER JOIN
                      dbo.AccountPaymentMethod RIGHT OUTER JOIN
                      dbo.vueAccountExpenseEntryApprovalLastAction RIGHT OUTER JOIN
                      dbo.AccountTimeExpenseBillingExpense INNER JOIN
                      dbo.AccountTimeExpenseBilling ON 
                      dbo.AccountTimeExpenseBillingExpense.AccountTimeExpenseBillingId = dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId RIGHT OUTER JOIN
                      dbo.AccountEmployeeExpenseSheet RIGHT OUTER JOIN
                      dbo.AccountTaxCode RIGHT OUTER JOIN
                      dbo.AccountExpenseTypeTaxCode RIGHT OUTER JOIN
                      dbo.AccountExpenseType INNER JOIN
                      dbo.AccountExpenseEntry INNER JOIN
                      dbo.AccountExpense ON dbo.AccountExpenseEntry.AccountExpenseId = dbo.AccountExpense.AccountExpenseId ON 
                      dbo.AccountExpenseType.AccountExpenseTypeId = dbo.AccountExpense.AccountExpenseTypeId LEFT OUTER JOIN
                      dbo.AccountProjectTask ON dbo.AccountExpenseEntry.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId ON 
                      dbo.AccountExpenseTypeTaxCode.AccountTaxZoneId = dbo.AccountExpenseEntry.AccountTaxZoneId AND 
                      dbo.AccountExpenseTypeTaxCode.AccountExpenseTypeId = dbo.AccountExpenseType.AccountExpenseTypeId ON 
                      dbo.AccountTaxCode.AccountTaxCodeId = dbo.AccountExpenseTypeTaxCode.AccountTaxCodeId LEFT OUTER JOIN
                      dbo.AccountTaxZone ON dbo.AccountExpenseEntry.AccountTaxZoneId = dbo.AccountTaxZone.AccountTaxZoneId ON 
                      dbo.AccountEmployeeExpenseSheet.AccountEmployeeExpenseSheetId = dbo.AccountExpenseEntry.AccountEmployeeExpenseSheetId LEFT OUTER JOIN
                      dbo.AccountEmployee ON dbo.AccountExpenseEntry.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId ON 
                      dbo.AccountTimeExpenseBillingExpense.AccountTimeExpenseBillingExpenseId = dbo.AccountExpenseEntry.AccountTimeExpenseBillingExpenseId ON 
                      dbo.vueAccountExpenseEntryApprovalLastAction.AccountExpenseEntryId = dbo.AccountExpenseEntry.AccountExpenseEntryId ON 
                      dbo.AccountPaymentMethod.AccountPaymentMethodId = dbo.AccountExpenseEntry.AccountPaymentMethodId ON 
                      dbo.AccountCurrency.AccountCurrencyId = dbo.AccountExpenseEntry.AccountCurrencyId LEFT OUTER JOIN
                      dbo.AccountParty RIGHT OUTER JOIN
                      dbo.AccountProject LEFT OUTER JOIN
                      dbo.AccountProjectType ON dbo.AccountProject.AccountProjectTypeId = dbo.AccountProjectType.AccountProjectTypeId ON 
                      dbo.AccountParty.AccountPartyId = dbo.AccountProject.AccountClientId ON dbo.AccountExpenseEntry.AccountProjectId = dbo.AccountProject.AccountProjectId ON 
                      dbo.SystemCurrency.CurrencyId = dbo.AccountCurrency.SystemCurrencyId LEFT OUTER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId ON 
                      dbo.AccountLocation.AccountLocationId = dbo.AccountEmployee.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId
WHERE     (dbo.AccountParty.IsDeleted <> 1) OR
                      (dbo.AccountParty.IsDeleted IS NULL)'

GO
-- Create View vueAccountClientForReport
Print 'Create View vueAccountClientForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountClientForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountClientForReport
AS
SELECT     dbo.AccountParty.AccountPartyId AS AccountClientId, dbo.AccountParty.PartyTypeId AS ClientTypeId, dbo.AccountParty.AccountId, 
                      dbo.AccountParty.PartyName AS ClientName, ISNULL(dbo.AccountParty.PartyNick, N'''') AS ClientNick, ISNULL(dbo.AccountParty.EMailAddress, N'''') AS EMailAddress, 
                      ISNULL(dbo.AccountParty.Address1, N'''') AS Address1, ISNULL(dbo.AccountParty.Address2, N'''') AS Address2, dbo.AccountParty.CountryId, 
                      ISNULL(dbo.AccountParty.State, N'''') AS State, ISNULL(dbo.AccountParty.City, N'''') AS City, ISNULL(dbo.AccountParty.ZipCode, N'''') AS ZipCode, 
                      ISNULL(dbo.AccountParty.Telephone1, N'''') AS Telephone1, ISNULL(dbo.AccountParty.Telephone2, N'''') AS Telephone2, ISNULL(dbo.AccountParty.Fax, N'''') AS Fax, 
                      dbo.AccountParty.DefaultCurrencyId, ISNULL(dbo.AccountParty.DefaultBillingRate, 0) AS DefaultBillingRate, ISNULL(dbo.AccountParty.Website, N'''') AS Website, 
                      ISNULL(dbo.AccountParty.Notes, N'''') AS Notes, dbo.AccountParty.IsDisabled, dbo.AccountParty.IsDeleted, dbo.AccountParty.CreatedOn, 
                      dbo.AccountParty.CreatedByEmployeeId, dbo.AccountParty.ModifiedOn, dbo.AccountParty.ModifiedByEmployeeId, ISNULL(dbo.SystemCountry.Country, N'''') 
                      AS Country, dbo.AccountParty.CustomField1, dbo.AccountParty.CustomField2, dbo.AccountParty.CustomField3, dbo.AccountParty.CustomField4, 
                      dbo.AccountParty.CustomField5, dbo.AccountParty.CustomField6, dbo.AccountParty.CustomField7, dbo.AccountParty.CustomField8, dbo.AccountParty.CustomField9, 
                      dbo.AccountParty.CustomField10, dbo.AccountParty.CustomField11, dbo.AccountParty.CustomField12, dbo.AccountParty.CustomField13, 
                      dbo.AccountParty.CustomField14, dbo.AccountParty.CustomField15
FROM         dbo.AccountParty INNER JOIN
                      dbo.Account ON dbo.AccountParty.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.SystemCountry ON dbo.AccountParty.CountryId = dbo.SystemCountry.CountryId
WHERE     (dbo.AccountParty.IsDeleted <> 1) OR
                      (dbo.AccountParty.IsDeleted IS NULL)'



GO
-- Create View VueAccountProjectTaskEmployeeForReport
Print 'Create View VueAccountProjectTaskEmployeeForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'VueAccountProjectTaskEmployeeForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.VueAccountProjectTaskEmployeeForReport
AS
SELECT     dbo.AccountProjectTaskEmployee.AccountProjectTaskEmployeeId, dbo.AccountProjectTaskEmployee.AccountId, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, dbo.AccountProjectTaskEmployee.AccountProjectTaskId, 
                      dbo.AccountProjectTaskEmployee.AccountEmployeeId, dbo.AccountProjectTask.AccountProjectId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, 
                      dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountEmployee.AccountTimeOffPolicyId, dbo.AccountEmployee.TimeOffApprovalTypeId, 
                      dbo.AccountEmployee.AccountHolidayTypeId, dbo.AccountParty.PartyName AS ClientName, dbo.AccountProjectTask.TaskName, 
                      dbo.AccountProjectTask.TaskDescription, dbo.AccountProjectTask.Duration AS TaskDuration, dbo.AccountProjectTask.DurationUnit AS TaskDurationUnit, 
                      dbo.AccountProjectTask.DeadlineDate AS TaskDeadlineDate, dbo.AccountProjectTask.Completed AS TaskCompleted, dbo.AccountProjectTask.IsParentTask, 
                      dbo.AccountProjectTask.IsForAllEmployees, dbo.AccountProjectTask.EstimatedCost AS TaskEmployeeCost, 
                      dbo.AccountProjectTask.EstimatedTimeSpent AS TaskEstimatedTimeSpent, dbo.AccountProjectTask.EstimatedTimeSpentUnit AS TaskEstimatedTimeSpentUnit, 
                      dbo.AccountProjectTask.TaskCode, dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.State, dbo.AccountEmployee.City, dbo.AccountEmployee.Zip, dbo.AccountEmployee.HomePhoneNo, dbo.AccountEmployee.WorkPhoneNo, 
                      dbo.AccountEmployee.MobilePhoneNo, dbo.AccountEmployee.BillingRateStateDate, dbo.AccountEmployee.TerminationDate, dbo.AccountEmployee.EmployeeCode, 
                      dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.HiredDate, dbo.AccountEmployeeType.AccountEmployeeType, 
                      dbo.AccountWorkingDayType.AccountWorkingDayType, dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, dbo.AccountWorkingDayType.MinimumHoursPerWeek, 
                      dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountTimeOffPolicy.AccountTimeOffPolicy, dbo.AccountProject.ProjectName, 
                      dbo.AccountProject.ProjectDescription, dbo.AccountProject.StartDate AS ProjectStartDate, dbo.AccountProject.Deadline AS ProjectDeadlineDate, 
                      dbo.AccountProject.EstimatedTime AS ProjectEstimatedTime, dbo.AccountProject.EstimatedDuration AS ProjectEstimatedDuration, 
                      dbo.AccountProject.EstimatedDurationUnit AS ProjectEstimatedDurationUnit, dbo.AccountProject.ProjectCode, dbo.AccountProject.Completed AS ProjectCompleted, 
                      dbo.AccountStatus.Status AS TaskStatus, dbo.AccountPriority.Priority, dbo.AccountProjectTask.AccountPriorityId, dbo.AccountProjectTask.TaskStatusId, 
                      dbo.AccountProjectTask.AccountTaskTypeId, dbo.AccountTaskType.TaskType, dbo.AccountBillingRate.BillingRate, 
                      dbo.AccountBillingRate.StartDate AS BillingRateStartDate, dbo.AccountBillingRate.EndDate AS BillingRateEndDate, dbo.AccountBillingRate.EmployeeRate, 
                      SUM(DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) AS TotalMinutes, 
                      dbo.AccountProjectTask.StartDate AS TaskStartDate, dbo.AccountProject.AccountClientId
FROM         dbo.AccountBillingRate INNER JOIN
                      dbo.AccountTaskType INNER JOIN
                      dbo.AccountProjectTaskEmployee INNER JOIN
                      dbo.AccountParty INNER JOIN
                      dbo.AccountProject ON dbo.AccountParty.AccountPartyId = dbo.AccountProject.AccountClientId INNER JOIN
                      dbo.AccountStatus INNER JOIN
                      dbo.AccountProjectTask ON dbo.AccountStatus.AccountStatusId = dbo.AccountProjectTask.TaskStatusId INNER JOIN
                      dbo.AccountPriority ON dbo.AccountProjectTask.AccountPriorityId = dbo.AccountPriority.AccountPriorityId ON 
                      dbo.AccountProject.AccountProjectId = dbo.AccountProjectTask.AccountProjectId ON 
                      dbo.AccountProjectTaskEmployee.AccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountProjectTaskEmployee.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId ON 
                      dbo.AccountTaskType.AccountTaskTypeId = dbo.AccountProjectTask.AccountTaskTypeId ON 
                      dbo.AccountBillingRate.AccountBillingRateId = dbo.AccountProjectTask.AccountBillingRateId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntry ON dbo.AccountProject.AccountProjectId = dbo.AccountEmployeeTimeEntry.AccountProjectId AND 
                      dbo.AccountProjectTask.AccountProjectTaskId = dbo.AccountEmployeeTimeEntry.AccountProjectTaskId AND 
                      dbo.AccountEmployee.AccountEmployeeId = dbo.AccountEmployeeTimeEntry.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployeeType ON dbo.AccountEmployee.EmployeePayTypeId = dbo.AccountEmployeeType.AccountEmployeeTypeId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountWorkingDayType ON dbo.AccountEmployee.AccountWorkingDayTypeId = dbo.AccountWorkingDayType.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountTimeOffPolicy ON dbo.AccountEmployee.AccountTimeOffPolicyId = dbo.AccountTimeOffPolicy.AccountTimeOffPolicyId
WHERE     (dbo.AccountParty.IsDeleted <> 1) OR
                      (dbo.AccountParty.IsDeleted IS NULL)
GROUP BY dbo.AccountProjectTaskEmployee.AccountProjectTaskEmployeeId, dbo.AccountProjectTaskEmployee.AccountId, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END, dbo.AccountProjectTaskEmployee.AccountProjectTaskId, dbo.AccountProjectTaskEmployee.AccountEmployeeId, 
                      dbo.AccountProjectTask.AccountProjectId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.AccountWorkingDayTypeId, 
                      dbo.AccountEmployee.AccountTimeOffPolicyId, dbo.AccountEmployee.TimeOffApprovalTypeId, dbo.AccountEmployee.AccountHolidayTypeId, 
                      dbo.AccountParty.PartyName, dbo.AccountProjectTask.TaskName, dbo.AccountProjectTask.TaskDescription, dbo.AccountProjectTask.Duration, 
                      dbo.AccountProjectTask.DurationUnit, dbo.AccountProjectTask.DeadlineDate, dbo.AccountProjectTask.Completed, dbo.AccountProjectTask.IsParentTask, 
                      dbo.AccountProjectTask.IsForAllEmployees, dbo.AccountProjectTask.EstimatedCost, dbo.AccountProjectTask.EstimatedTimeSpent, 
                      dbo.AccountProjectTask.EstimatedTimeSpentUnit, dbo.AccountProjectTask.TaskCode, dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, 
                      dbo.AccountLocation.AccountLocation, dbo.AccountEmployee.State, dbo.AccountEmployee.City, dbo.AccountEmployee.Zip, dbo.AccountEmployee.HomePhoneNo, 
                      dbo.AccountEmployee.WorkPhoneNo, dbo.AccountEmployee.MobilePhoneNo, dbo.AccountEmployee.BillingRateStateDate, dbo.AccountEmployee.TerminationDate, 
                      dbo.AccountEmployee.EmployeeCode, dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.HiredDate, dbo.AccountEmployeeType.AccountEmployeeType, 
                      dbo.AccountWorkingDayType.AccountWorkingDayType, dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, dbo.AccountWorkingDayType.MinimumHoursPerWeek, 
                      dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountTimeOffPolicy.AccountTimeOffPolicy, dbo.AccountProject.ProjectName, 
                      dbo.AccountProject.ProjectDescription, dbo.AccountProject.StartDate, dbo.AccountProject.Deadline, dbo.AccountProject.EstimatedTime, 
                      dbo.AccountProject.EstimatedDuration, dbo.AccountProject.EstimatedDurationUnit, dbo.AccountProject.ProjectCode, dbo.AccountProject.Completed, 
                      dbo.AccountStatus.Status, dbo.AccountPriority.Priority, dbo.AccountProjectTask.AccountPriorityId, dbo.AccountProjectTask.TaskStatusId, 
                      dbo.AccountProjectTask.AccountTaskTypeId, dbo.AccountTaskType.TaskType, dbo.AccountBillingRate.BillingRate, dbo.AccountBillingRate.StartDate, 
                      dbo.AccountBillingRate.EndDate, dbo.AccountBillingRate.EmployeeRate, dbo.AccountProjectTask.StartDate, dbo.AccountProject.AccountClientId'

GO
-- Create View vueAccountProjectTeamForReport
Print 'Create View vueAccountProjectTeamForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountProjectTeamForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountProjectTeamForReport
AS
SELECT     dbo.AccountProjectEmployee.AccountProjectEmployeeId, dbo.AccountProjectEmployee.AccountId, dbo.AccountProjectEmployee.AccountProjectId, 
                      dbo.AccountProjectEmployee.AccountEmployeeId, dbo.AccountProjectEmployee.AccountRoleId, dbo.AccountProjectEmployee.AccountBillingRateId, 
                      dbo.AccountProjectEmployee.AccountProjectEmployeeTemplateId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, 
                      dbo.AccountProject.AccountClientId, dbo.AccountProject.ProjectName, dbo.AccountBillingType.BillingType AS ProjectBillingType, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountLocation.AccountLocation, dbo.AccountRole.Role, dbo.AccountEmployeeType.AccountEmployeeType, 
                      dbo.AccountParty.PartyName AS ClientName, dbo.AccountStatus.Status AS ProjectStatus, AccountStatus_1.Status AS EmployeeStatus, 
                      dbo.AccountWorkingDayType.AccountWorkingDayType, dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.MinimumHoursPerDay, 
                      dbo.AccountWorkingDayType.MaximumHoursPerDay, dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, 
                      dbo.AccountTimeOffPolicy.AccountTimeOffPolicy, AccountApprovalType_1.ApprovalTypeName AS TimeOffApprovalTypeName, 
                      dbo.AccountHolidayType.AccountHolidayType, AccountApprovalType_2.ApprovalTypeName AS ExpenseApprovalTypeName, 
                      dbo.AccountApprovalType.ApprovalTypeName AS TimesheetApprovalTypeName, dbo.AccountPartyContact.FirstName AS ClientContactFirstName, 
                      dbo.AccountPartyContact.LastName AS ClientContactLastName, dbo.AccountPartyDepartment.PartyDepartmentCode AS ClientDepartmentCode, 
                      dbo.AccountPartyDepartment.PartyDepartmentName AS ClientDepartmentName, dbo.AccountPartyDepartment.PartyDepartmentLocation AS ClientDepartmentLocation, 
                      dbo.AccountProject.ProjectStatusId, dbo.AccountProjectType.ProjectType, dbo.AccountProject.AccountProjectTypeId, dbo.AccountProject.ProjectDescription, 
                      dbo.AccountProject.StartDate AS ProjectStartDate, dbo.AccountProject.Deadline, dbo.AccountProject.EstimatedTime, dbo.AccountProject.EstimatedDuration, 
                      dbo.AccountProject.EstimatedDurationUnit, dbo.AccountProject.ProjectCode, dbo.AccountProject.DefaultBillingRate AS ProjectBillingRate, 
                      dbo.AccountProject.Completed, dbo.AccountProject.IsDisabled AS IsDisabledProject, dbo.AccountProject.IsDeleted AS IsDeletedProject, 
                      dbo.AccountParty.PartyNick AS ClientNick, dbo.AccountParty.EMailAddress AS ClientEMailAddress, dbo.AccountParty.Address1 AS ClientAddress1, 
                      dbo.AccountParty.Address2 AS ClientAddress2, dbo.AccountParty.State AS ClientState, dbo.AccountParty.City AS ClientCity, 
                      dbo.AccountParty.ZipCode AS ClientZipCode, dbo.AccountParty.Telephone1 AS ClientTelephone1, dbo.AccountParty.Telephone2 AS ClientTelephone2, 
                      dbo.AccountParty.Fax AS ClientFax, dbo.AccountEmployee.State AS EmployeeState, dbo.AccountEmployee.City AS EmployeeCity, 
                      dbo.AccountEmployee.Zip AS EmployeeZip, dbo.AccountEmployee.WorkPhoneNo AS EmployeeWorkPhoneNo, dbo.AccountEmployee.TerminationDate, 
                      dbo.AccountEmployee.EmployeeCode, dbo.AccountEmployee.HiredDate, dbo.AccountBillingRate.BillingRate, dbo.AccountBillingRate.StartDate AS BillingRateStartDate,
                       dbo.AccountBillingRate.EndDate AS BillingRateEndDate, dbo.AccountBillingRate.EmployeeRate, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, SUM(DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, 
                      dbo.AccountEmployeeTimeEntry.TotalTime)) AS TotalMinutes
FROM         dbo.AccountProjectEmployee INNER JOIN
                      dbo.AccountProject ON dbo.AccountProjectEmployee.AccountProjectId = dbo.AccountProject.AccountProjectId INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountProjectEmployee.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId INNER JOIN
                      dbo.AccountBillingType ON dbo.AccountProject.ProjectBillingTypeId = dbo.AccountBillingType.AccountBillingTypeId INNER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId INNER JOIN
                      dbo.AccountStatus ON dbo.AccountProject.ProjectStatusId = dbo.AccountStatus.AccountStatusId INNER JOIN
                      dbo.AccountApprovalType ON dbo.AccountProject.TimeSheetApprovalTypeId = dbo.AccountApprovalType.AccountApprovalTypeId INNER JOIN
                      dbo.AccountApprovalType AS AccountApprovalType_2 ON dbo.AccountProject.ExpenseApprovalTypeId = AccountApprovalType_2.AccountApprovalTypeId INNER JOIN
                      dbo.AccountProjectType ON dbo.AccountProject.AccountProjectTypeId = dbo.AccountProjectType.AccountProjectTypeId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntry ON dbo.AccountEmployee.AccountEmployeeId = dbo.AccountEmployeeTimeEntry.AccountEmployeeId AND 
                      dbo.AccountProject.AccountProjectId = dbo.AccountEmployeeTimeEntry.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountBillingRate ON dbo.AccountProjectEmployee.AccountBillingRateId = dbo.AccountBillingRate.AccountBillingRateId LEFT OUTER JOIN
                      dbo.AccountPartyDepartment ON dbo.AccountProject.AccountPartyDepartmentId = dbo.AccountPartyDepartment.AccountPartyDepartmentId LEFT OUTER JOIN
                      dbo.AccountPartyContact ON dbo.AccountProject.AccountPartyContactId = dbo.AccountPartyContact.AccountPartyContactId LEFT OUTER JOIN
                      dbo.AccountApprovalType AS AccountApprovalType_1 ON 
                      dbo.AccountEmployee.TimeOffApprovalTypeId = AccountApprovalType_1.AccountApprovalTypeId LEFT OUTER JOIN
                      dbo.AccountHolidayType ON dbo.AccountEmployee.AccountHolidayTypeId = dbo.AccountHolidayType.AccountHolidayTypeId LEFT OUTER JOIN
                      dbo.AccountWorkingDayType ON dbo.AccountEmployee.AccountWorkingDayTypeId = dbo.AccountWorkingDayType.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountTimeOffPolicy ON dbo.AccountEmployee.AccountTimeOffPolicyId = dbo.AccountTimeOffPolicy.AccountTimeOffPolicyId LEFT OUTER JOIN
                      dbo.AccountStatus AS AccountStatus_1 ON dbo.AccountEmployee.StatusId = AccountStatus_1.AccountStatusId LEFT OUTER JOIN
                      dbo.AccountEmployeeType ON dbo.AccountEmployee.EmployeePayTypeId = dbo.AccountEmployeeType.AccountEmployeeTypeId LEFT OUTER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId
WHERE     (dbo.AccountParty.IsDeleted <> 1) OR
                      (dbo.AccountParty.IsDeleted IS NULL)
GROUP BY dbo.AccountProjectEmployee.AccountProjectEmployeeId, dbo.AccountProjectEmployee.AccountId, dbo.AccountProjectEmployee.AccountProjectId, 
                      dbo.AccountProjectEmployee.AccountEmployeeId, dbo.AccountProjectEmployee.AccountRoleId, dbo.AccountProjectEmployee.AccountBillingRateId, 
                      dbo.AccountProjectEmployee.AccountProjectEmployeeTemplateId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, 
                      dbo.AccountProject.AccountClientId, dbo.AccountProject.ProjectName, dbo.AccountBillingType.BillingType, dbo.AccountDepartment.DepartmentName, 
                      dbo.AccountLocation.AccountLocation, dbo.AccountRole.Role, dbo.AccountEmployeeType.AccountEmployeeType, dbo.AccountParty.PartyName, 
                      dbo.AccountStatus.Status, AccountStatus_1.Status, dbo.AccountWorkingDayType.AccountWorkingDayType, dbo.AccountWorkingDayType.HoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, dbo.AccountWorkingDayType.MinimumHoursPerWeek, 
                      dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountTimeOffPolicy.AccountTimeOffPolicy, AccountApprovalType_1.ApprovalTypeName, 
                      dbo.AccountHolidayType.AccountHolidayType, AccountApprovalType_2.ApprovalTypeName, dbo.AccountApprovalType.ApprovalTypeName, 
                      dbo.AccountPartyContact.FirstName, dbo.AccountPartyContact.LastName, dbo.AccountPartyDepartment.PartyDepartmentCode, 
                      dbo.AccountPartyDepartment.PartyDepartmentName, dbo.AccountPartyDepartment.PartyDepartmentLocation, dbo.AccountProject.ProjectStatusId, 
                      dbo.AccountProjectType.ProjectType, dbo.AccountProject.AccountProjectTypeId, dbo.AccountProject.ProjectDescription, dbo.AccountProject.StartDate, 
                      dbo.AccountProject.Deadline, dbo.AccountProject.EstimatedTime, dbo.AccountProject.EstimatedDuration, dbo.AccountProject.EstimatedDurationUnit, 
                      dbo.AccountProject.ProjectCode, dbo.AccountProject.DefaultBillingRate, dbo.AccountProject.Completed, dbo.AccountProject.IsDisabled, dbo.AccountProject.IsDeleted, 
                      dbo.AccountParty.PartyNick, dbo.AccountParty.EMailAddress, dbo.AccountParty.Address1, dbo.AccountParty.Address2, dbo.AccountParty.State, dbo.AccountParty.City, 
                      dbo.AccountParty.ZipCode, dbo.AccountParty.Telephone1, dbo.AccountParty.Telephone2, dbo.AccountParty.Fax, dbo.AccountEmployee.State, 
                      dbo.AccountEmployee.City, dbo.AccountEmployee.Zip, dbo.AccountEmployee.WorkPhoneNo, dbo.AccountEmployee.TerminationDate, 
                      dbo.AccountEmployee.EmployeeCode, dbo.AccountEmployee.HiredDate, dbo.AccountBillingRate.BillingRate, dbo.AccountBillingRate.StartDate, 
                      dbo.AccountBillingRate.EndDate, dbo.AccountBillingRate.EmployeeRate, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END'

GO
-- Create View vueAccountProjects
Print 'Create View vueAccountProjects'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountProjects' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountProjects
AS
SELECT     dbo.AccountProject.AccountProjectId, dbo.AccountProject.ProjectName, dbo.AccountProject.StartDate, dbo.AccountProject.ProjectCode, dbo.AccountParty.PartyName, 
                      dbo.AccountProject.AccountClientId, dbo.AccountProject.LeaderEmployeeId, dbo.AccountProject.ProjectManagerEmployeeId, 
                      AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName AS LeaderName, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS ProjectManagerName, dbo.AccountProject.AccountId, dbo.AccountProject.IsActive, 
                      dbo.AccountProject.Deadline, dbo.AccountProject.EstimatedDuration, dbo.AccountProject.EstimatedDurationUnit, dbo.AccountProject.ProjectStatusId, 
                      dbo.AccountStatus.Status, dbo.AccountProject.IsDisabled, dbo.AccountProject.ProjectDescription, dbo.AccountProject.IsTemplate, dbo.AccountProject.IsProject, 
                      dbo.AccountProject.AccountProjectTemplateId, dbo.SystemProjectBillingRateType.SystemProjectBillingRateType, dbo.AccountProject.AccountProjectTypeId, 
                      dbo.AccountProjectType.ProjectType, dbo.AccountProjectType.MasterAccountProjectTypeId, dbo.AccountProject.IsDeleted, 
                      dbo.AccountPartyDepartment.PartyDepartmentName, dbo.AccountParty.IsDeleted AS IsDeletedClient
FROM         dbo.AccountStatus RIGHT OUTER JOIN
                      dbo.SystemProjectBillingRateType RIGHT OUTER JOIN
                      dbo.AccountProject INNER JOIN
                      dbo.AccountProjectType ON dbo.AccountProject.AccountProjectTypeId = dbo.AccountProjectType.AccountProjectTypeId INNER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId LEFT OUTER JOIN
                      dbo.AccountPartyDepartment ON dbo.AccountProject.AccountPartyDepartmentId = dbo.AccountPartyDepartment.AccountPartyDepartmentId ON 
                      dbo.SystemProjectBillingRateType.SystemProjectBillingRateTypeId = dbo.AccountProject.ProjectBillingRateTypeId ON 
                      dbo.AccountStatus.AccountStatusId = dbo.AccountProject.ProjectStatusId LEFT OUTER JOIN
                      dbo.AccountEmployee ON dbo.AccountProject.ProjectManagerEmployeeId = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON dbo.AccountProject.LeaderEmployeeId = AccountEmployee_1.AccountEmployeeId'

GO
-- Create View vueAccountProjectEmployeFullJoin
Print 'Create View vueAccountProjectEmployeFullJoin'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountProjectEmployeFullJoin' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountProjectEmployeFullJoin
AS
SELECT     dbo.AccountProject.AccountProjectId, dbo.AccountProject.ProjectName, dbo.AccountEmployee.Password, dbo.AccountEmployee.FirstName, 
                      dbo.AccountEmployee.LastName, dbo.AccountEmployee.AccountEmployeeId, dbo.AccountProjectEmployee.AccountProjectEmployeeId, 
                      dbo.AccountEmployee.AccountId, dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS FullName, dbo.AccountProject.LeaderEmployeeId, 
                      dbo.AccountProject.ProjectManagerEmployeeId, dbo.AccountEmployee.EMailAddress, dbo.AccountEmployee.IsDisabled, dbo.AccountEmployee.IsDeleted, 
                      dbo.AccountProject.IsDeleted AS IsDeletedProject, dbo.AccountParty.IsDeleted AS IsDeletedClient
FROM         dbo.AccountProject INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountProject.AccountId = dbo.AccountEmployee.AccountId INNER JOIN
                      dbo.AccountProjectEmployee ON dbo.AccountProject.AccountProjectId = dbo.AccountProjectEmployee.AccountProjectId AND 
                      dbo.AccountEmployee.AccountEmployeeId = dbo.AccountProjectEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId'

GO
-- Create View vueExternalAccountEmployee
Print 'Create View vueExternalAccountEmployee'
GO
if not exists (select * from information_schema.tables where table_name = 'vueExternalAccountEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueExternalAccountEmployee
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountEmployee.AccountId, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.Password, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountLocationId, dbo.AccountEmployee.BillingTypeId, 
                      dbo.AccountBillingType.BillingType, dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, 
                      dbo.AccountPreferences.ShowClockStartEnd, dbo.Account.TimeZoneId, dbo.AccountRole.MasterAccountRoleId, dbo.Account.DefaultCurrencyId, dbo.Account.CountryId, 
                      dbo.AccountPreferences.CultureInfoName, dbo.AccountPreferences.TimeEntryFormat, dbo.AccountEmployee.AllowedAccessFromIP, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountPreferences.AccountSessionTimeout, dbo.AccountPreferences.ShowCompletedTasksInTimeSheet, dbo.AccountPreferences.CurrencySymbol, 
                      dbo.AccountPreferences.IsCompanyOwnLogo, dbo.Account.AccountExpiryActivation, dbo.Account.LicenseActivation, dbo.AccountEmployee.EmployeeTypeId, 
                      dbo.AccountEmployee.ExternalUserClientId, dbo.AccountParty.PartyName, dbo.AccountParty.PartyNick, dbo.AccountEmployee.IsDisabled, 
                      dbo.AccountEmployee.IsDeleted, dbo.AccountParty.IsDeleted AS IsDeletedClient
FROM         dbo.AccountEmployee INNER JOIN
                      dbo.Account ON dbo.AccountEmployee.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId LEFT OUTER JOIN
                      dbo.AccountParty ON dbo.AccountEmployee.ExternalUserClientId = dbo.AccountParty.AccountPartyId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployee.AccountId = dbo.AccountPreferences.AccountId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId'

GO
-- Create View vueAccountEmployeeTimeEntryWithTimeOffForReport
Print 'Create View vueAccountEmployeeTimeEntryWithTimeOffForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithTimeOffForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport
AS
SELECT     CASE WHEN dbo.AccountEmployee.IsDisabled = 1 THEN dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE dbo.AccountEmployee.FirstName
                       + '' '' + dbo.AccountEmployee.LastName END AS EmployeeName, dbo.AccountProject.ProjectName, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 1 THEN AccountProjectTask_1.TaskName ELSE dbo.AccountTimeOffType.AccountTimeOffType END AS TaskName,
                       dbo.AccountEmployeeTimeEntry.TotalTime, dbo.AccountEmployeeTimeEntry.Approved, dbo.AccountEmployee.AccountEmployeeId, 
                      dbo.AccountProject.AccountProjectId, dbo.AccountEmployeeTimeEntry.TeamLeadApproved, dbo.AccountEmployeeTimeEntry.ProjectManagerApproved, 
                      dbo.AccountEmployeeTimeEntry.AdministratorApproved, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, dbo.AccountEmployeeTimeEntry.StartTime, 
                      dbo.AccountEmployeeTimeEntry.EndTime, dbo.AccountEmployeeTimeEntry.TimeEntryDate, dbo.AccountEmployeeTimeEntry.Description, 
                      ISNULL(dbo.AccountProject.AccountId, dbo.AccountTimeOffType.AccountId) AS AccountId, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime) AS TotalMinutes, DATEPART(dw, dbo.AccountEmployeeTimeEntry.TimeEntryDate) AS WeekDay, 
                      dbo.AccountParty.AccountPartyId, dbo.AccountParty.PartyName, AccountProjectTask_1.AccountProjectTaskId, dbo.AccountBillingType.BillingType, 
                      dbo.AccountProject.LeaderEmployeeId, dbo.AccountProject.ProjectManagerEmployeeId, dbo.AccountProject.TimeSheetApprovalTypeId, 
                      dbo.AccountProject.ExpenseApprovalTypeId, AccountProjectTask_1.IsBillable, dbo.AccountEmployeeTimeEntry.Rejected, dbo.AccountEmployeeTimeEntry.BillingRate, 
                      dbo.AccountProject.ProjectBillingRateTypeId, dbo.AccountEmployee.EmployeeCode, dbo.AccountEmployee.AccountDepartmentId, 
                      dbo.AccountDepartment.DepartmentName, AccountProjectTask_1.EstimatedCost, AccountProjectTask_1.EstimatedTimeSpent, 
                      dbo.AccountEmployeeTimeEntry.Submitted, dbo.AccountWorkType.AccountWorkType, dbo.AccountEmployee.EMailAddress, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountCostCenter.AccountCostCenter, dbo.AccountCostCenter.AccountCostCenterCode, dbo.AccountWorkType.AccountWorkTypeCode, 
                      dbo.AccountProject.ProjectCode, AccountProjectTask_1.TaskCode, dbo.AccountLocation.AccountLocationId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction.Comments, dbo.AccountEmployeeTimeEntry.BillingRateCurrencyId, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateCurrencyId, dbo.AccountEmployeeTimeEntry.BillingRateExchangeRate, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateExchangeRate, dbo.AccountEmployeeTimeEntry.AccountBaseCurrencyId, AccountProjectTask_1.AccountTaskTypeId, 
                      AccountProjectTask_1.TaskStatusId, AccountProjectTask_1.AccountPriorityId, AccountProjectTask_1.AccountProjectMilestoneId, 
                      dbo.AccountDepartment.DepartmentCode, dbo.AccountParty.PartyNick, AccountProjectTask_1.EstimatedCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction.ApprovedOn, dbo.AccountEmployeeTimeEntry.EmployeeRate, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountRole.Role, dbo.AccountProject.AccountProjectTypeId, dbo.AccountProject.ProjectDescription, AccountProjectTask_1.TaskDescription, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeExpenseBillingTimesheetId, dbo.AccountEmployeeTimeEntry.Billed, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Submitted = 1 THEN (CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, 
                      dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS SubmittedHours, CASE WHEN dbo.AccountEmployeeTimeEntry.Approved = 1 THEN (CONVERT(float, 
                      DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS ApprovedHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Rejected = 1 THEN (CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, 
                      dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS RejectedHours, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, 
                      dbo.AccountPartyContact.FirstName + N'' '' + dbo.AccountPartyContact.LastName AS ClientContactName, 
                      dbo.AccountPartyDepartment.PartyDepartmentCode AS ClientDepartmentCode, dbo.AccountPartyDepartment.PartyDepartmentName AS ClientDepartmentName, 
                      dbo.AccountPartyDepartment.PartyDepartmentLocation AS ClientDepartmentLocation, dbo.AccountEmployeeTimeEntry.IsTimeOff, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId, CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 0 THEN (CONVERT(float, DATEPART(hh, 
                      dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS TimeOffHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 1 THEN (CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, 
                      dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS TimesheetHours, dbo.AccountWorkType.AccountWorkTypeId, dbo.AccountStatus.Status AS ProjectStatus, 
                      AccountProjectTask_1.ParentAccountProjectTaskId, dbo.AccountProjectTask.TaskName AS ParentTaskName, dbo.AccountEmployee.IsDisabled, 
                      dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, ISNULL(dbo.AccountEmployeeType.AccountEmployeeType, N'''') AS EmployeeType, 
                      ISNULL(dbo.AccountHolidayTypeDetail.HolidayName, N'''') AS HolidayName, dbo.AccountEmployeeTimeEntry.Percentage, 
                      dbo.AccountEmployeeTimeEntry.CustomField1, dbo.AccountEmployeeTimeEntry.CustomField2, dbo.AccountEmployeeTimeEntry.CustomField3, 
                      dbo.AccountEmployeeTimeEntry.CustomField4, dbo.AccountEmployeeTimeEntry.CustomField5, dbo.AccountEmployeeTimeEntry.CustomField6, 
                      dbo.AccountEmployeeTimeEntry.CustomField7, dbo.AccountEmployeeTimeEntry.CustomField8, dbo.AccountEmployeeTimeEntry.CustomField9, 
                      dbo.AccountEmployeeTimeEntry.CustomField10, dbo.AccountEmployeeTimeEntry.CustomField11, dbo.AccountEmployeeTimeEntry.CustomField12, 
                      dbo.AccountEmployeeTimeEntry.CustomField13, dbo.AccountEmployeeTimeEntry.CustomField14, dbo.AccountEmployeeTimeEntry.CustomField15, 
                      AccountProjectTask_1.StartDate AS TaskStartDate, AccountProjectTask_1.DeadlineDate AS TaskDeadlineDate, dbo.AccountParty.IsDeleted
FROM         dbo.AccountHolidayTypeDetail RIGHT OUTER JOIN
                      dbo.AccountEmployeeTimeEntry INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeEntry.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId ON 
                      dbo.AccountHolidayTypeDetail.AccountHolidayTypeId = dbo.AccountEmployee.AccountHolidayTypeId AND 
                      dbo.AccountHolidayTypeDetail.AccountId = dbo.AccountEmployee.AccountId AND 
                      dbo.AccountHolidayTypeDetail.HolidayDate = dbo.AccountEmployeeTimeEntry.TimeEntryDate LEFT OUTER JOIN
                      dbo.AccountEmployeeType ON dbo.AccountEmployee.EmployeePayTypeId = dbo.AccountEmployeeType.AccountEmployeeTypeId LEFT OUTER JOIN
                      dbo.AccountProjectTask AS AccountProjectTask_1 LEFT OUTER JOIN
                      dbo.AccountProjectTask ON AccountProjectTask_1.ParentAccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId ON 
                      dbo.AccountEmployeeTimeEntry.AccountProjectTaskId = AccountProjectTask_1.AccountProjectTaskId LEFT OUTER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountStatus ON dbo.AccountProject.ProjectStatusId = dbo.AccountStatus.AccountStatusId LEFT OUTER JOIN
                      dbo.AccountTimeOffType ON dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId LEFT OUTER JOIN
                      dbo.AccountPartyDepartment ON dbo.AccountProject.AccountPartyDepartmentId = dbo.AccountPartyDepartment.AccountPartyDepartmentId LEFT OUTER JOIN
                      dbo.AccountPartyContact ON dbo.AccountProject.AccountPartyContactId = dbo.AccountPartyContact.AccountPartyContactId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryPeriod ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId LEFT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryApprovalLastAction.AccountEmployeeTimeEntryId LEFT OUTER JOIN
                      dbo.AccountCostCenter ON dbo.AccountEmployeeTimeEntry.AccountCostCenterId = dbo.AccountCostCenter.AccountCostCenterId LEFT OUTER JOIN
                      dbo.AccountWorkType ON dbo.AccountEmployeeTimeEntry.AccountWorkTypeId = dbo.AccountWorkType.AccountWorkTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId LEFT OUTER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId
WHERE     (dbo.AccountParty.IsDeleted <> 1) OR
                      (dbo.AccountParty.IsDeleted IS NULL)'

GO
-- Alter Column ProjectCode on AccountProject
Print 'Alter Column ProjectCode on AccountProject'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProject' AND TABLE_TYPE='BASE TABLE')) AND (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='ProjectCode' AND TABLE_NAME='AccountProject'))
ALTER TABLE [dbo].[AccountProject]
	 ALTER COLUMN [ProjectCode] nvarchar(100) NULL

GO
-- Add Column ShowProjectNameInTask to AccountPreferences
Print 'Add Column ShowProjectNameInTask to AccountPreferences'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountPreferences' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='ShowProjectNameInTask' AND TABLE_NAME='AccountPreferences'))
ALTER TABLE [dbo].[AccountPreferences]
	ADD [ShowProjectNameInTask] bit NULL
	
GO
-- Add Column ShowClientNameInTask to AccountPreferences
Print 'Add Column ShowClientNameInTask to AccountPreferences'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountPreferences' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='ShowClientNameInTask' AND TABLE_NAME='AccountPreferences'))
ALTER TABLE [dbo].[AccountPreferences]
	ADD [ShowClientNameInTask] bit NULL

GO
-- Drop View vueAccount
Print 'Drop View vueAccount'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccount' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccount]

GO
-- Drop View vueAccountEmployee
Print 'Drop View vueAccountEmployee'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployee]
	
GO
-- Drop View rptvueAccountExpenseEntry
Print 'Drop View rptvueAccountExpenseEntry'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountExpenseEntry' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountExpenseEntry]

GO
-- Create View vueAccountEmployee
Print 'Create View vueAccountEmployee'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployee
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountEmployee.AccountId, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.Password, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountLocationId, dbo.AccountEmployee.BillingTypeId, 
                      dbo.AccountBillingType.BillingType, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, dbo.AccountPreferences.ShowClockStartEnd, dbo.Account.TimeZoneId, 
                      dbo.AccountRole.MasterAccountRoleId, dbo.Account.DefaultCurrencyId, dbo.Account.CountryId, dbo.AccountPreferences.CultureInfoName, 
                      dbo.AccountPreferences.TimeEntryFormat, dbo.AccountEmployee.AllowedAccessFromIP, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountPreferences.AccountSessionTimeout, dbo.AccountPreferences.ShowCompletedTasksInTimeSheet, dbo.AccountPreferences.CurrencySymbol, 
                      dbo.AccountPreferences.IsCompanyOwnLogo, dbo.Account.AccountExpiryActivation, dbo.Account.LicenseActivation, dbo.AccountEmployee.EmployeeTypeId, 
                      dbo.AccountEmployee.ExternalUserClientId, dbo.AccountEmployee.AccountBillingRateId, dbo.AccountPreferences.ScheduledEmailSendTime, 
                      dbo.AccountEmployee.Username, dbo.AccountEmployee.IsDisabled, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.AccountEmployee.EmployeeCode, dbo.AccountPreferences.Version, 
                      dbo.AccountPreferences.LockSubmittedRecords, dbo.AccountPreferences.LockApprovedRecords, ISNULL(dbo.AccountEmployee.EmployeeCode + '' - '', '''') 
                      + dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeNameWithCode, dbo.AccountPreferences.ShowWorkTypeInTimeSheet, 
                      dbo.AccountPreferences.NumberOfBlankRowsInTimeEntry, dbo.AccountPreferences.ShowCostCenterInTimeSheet, dbo.AccountPreferences.WeekStartDay, 
                      dbo.AccountPreferences.AccountBaseCurrencyId, dbo.AccountPreferences.UserInterfaceLanguage, dbo.AccountEmployee.EmployeeManagerId, 
                      dbo.AccountPreferences.DefaultTimeEntryMode, dbo.AccountPreferences.PageSize, dbo.AccountEmployee.TimeZoneId AS EmployeeTimeZoneId, 
                      dbo.AccountEmployee.TerminationDate, dbo.AccountEmployee.StatusId, dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.EmployeePayTypeId, 
                      dbo.AccountEmployee.HiredDate, dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountWorkingDayType, 
                      dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay AS EmployeeWeekStartDay, 
                      dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountPreferences.ShowDescriptionInWeekView, 
                      dbo.AccountPreferences.InvoiceNoPrefix, dbo.AccountPreferences.ShowAdditionalTaskInformationType, 
                      dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, 
                      ISNULL(dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, 1) AS InitialDayOfTheMonth, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, 1) 
                      AS SystemInitialDayOfFirstPeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod, 16) AS SystemInitialDayOfLastPeriod, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountPreferences.TimesheetPrintFooter, dbo.AccountPreferences.ExpenseSheetPrintFooter, 
                      dbo.AccountPreferences.ShowCompletedProjectsInTimeSheet, dbo.AccountPreferences.ShowProjectForTimeOff, dbo.AccountPreferences.ShowTimeOffInTimesheet, 
                      dbo.AccountEmployee.IsDeleted, dbo.AccountEmployee.IsForcePasswordChange, dbo.AccountEmployee.PasswordChangedDate, 
                      dbo.AccountPreferences.PasswordExpiryPeriod, dbo.AccountPreferences.ShowAllInTimesheetReadOnly, dbo.AccountPreferences.ShowTaskInExpenseSheet, 
                      dbo.AccountPreferences.InvoiceBillingTypeId, dbo.AccountPreferences.ShowBillingRateInInvoiceReport, dbo.SystemInvoiceBillingType.InvoiceBillingType, 
                      dbo.AccountPreferences.InvoiceFooter, dbo.AccountPreferences.TimesheetOverduePeriods, dbo.AccountWorkingDayType.TimesheetOverdueAfterDays, 
                      dbo.AccountEmployee.CreatedOn, dbo.AccountEmployee.CreatedByEmployeeId, dbo.AccountEmployee.ModifiedOn, dbo.AccountEmployee.ModifiedByEmployeeId, 
                      dbo.AccountPreferences.ShowProjectNameInInvoiceReport, dbo.AccountPreferences.ProjectCodePrefix, dbo.AccountPreferences.AutoGenerateProjectCode, 
                      dbo.AccountPreferences.TimeEntryHoursFormatId, dbo.AccountPreferences.ShowPercentageInTimesheet, dbo.AccountPreferences.EnablePasswordComplexity, 
                      dbo.AccountPreferences.ShowClientDepartmentInProject, dbo.AccountPreferences.ShowEntryDateInInvoiceReport, dbo.AccountPreferences.TimesheetSort, 
                      dbo.AccountPreferences.ShowCostCenterInTimesheetBy, ShowCopyTimesheetButton, ShowCopyActivitiesButtonInTimesheet, ShowProjectNameInTask, ShowClientNameInTask
FROM         dbo.SystemInvoiceBillingType RIGHT OUTER JOIN
                      dbo.AccountPreferences ON dbo.SystemInvoiceBillingType.InvoiceBillingTypeId = dbo.AccountPreferences.InvoiceBillingTypeId RIGHT OUTER JOIN
                      dbo.vueAccountTimesheetPeriodType RIGHT OUTER JOIN
                      dbo.AccountWorkingDayType ON 
                      dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId = dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId RIGHT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.Account ON dbo.AccountEmployee.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId ON 
                      dbo.AccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId ON 
                      dbo.AccountPreferences.AccountId = dbo.AccountEmployee.AccountId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId'

GO
-- Create View vueAccount
Print 'Create View vueAccount'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccount' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccount
AS
SELECT     dbo.Account.AccountId, dbo.Account.AccountTypeId, dbo.Account.AccountName, dbo.Account.Address1, dbo.Account.Address2, dbo.Account.ZipCode, dbo.Account.State, 
                      dbo.Account.City, dbo.Account.CountryId, dbo.Account.EMailAddress, dbo.Account.Telephone, dbo.Account.Fax, dbo.Account.DefaultCurrencyId, 
                      dbo.Account.TimeZoneId, dbo.Account.IsDisabled, dbo.Account.IsDeleted, dbo.Account.StatusId, dbo.Account.CreatedOn, dbo.Account.ModifiedOn, 
                      dbo.Account.ModifiedByEmployeeId, dbo.AccountPreferences.ShowClockStartEnd, dbo.AccountPreferences.AccountPreferencesId, dbo.Account.LicenseKey, 
                      dbo.Account.SystemPackageTypeId, dbo.AccountPreferences.TimeEntryFormat, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.Account.MachineId, dbo.Account.ActivationLicenseKey, dbo.Account.ActivationMachineKey, 
                      dbo.Account.ActivationType, dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountPreferences.InvoiceBillingTypeId, 
                      dbo.AccountPreferences.ShowBillingRateInInvoiceReport, dbo.AccountPreferences.InvoiceFooter, dbo.AccountPreferences.ShowProjectNameInInvoiceReport, 
                      dbo.AccountPreferences.ProjectCodePrefix, dbo.AccountPreferences.AutoGenerateProjectCode, dbo.AccountPreferences.TimeEntryHoursFormatId, 
                      dbo.AccountPreferences.ShowPercentageInTimesheet, dbo.AccountPreferences.EnablePasswordComplexity, dbo.AccountPreferences.ShowClientDepartmentInProject, 
                      dbo.AccountPreferences.ShowEntryDateInInvoiceReport, dbo.AccountPreferences.TimesheetSort, dbo.AccountPreferences.ShowCostCenterInTimesheetBy,
					  dbo.AccountPreferences.ShowCopyTimesheetButton, dbo.AccountPreferences.ShowCopyActivitiesButtonInTimesheet,
					  ShowProjectNameInTask, ShowClientNameInTask	
FROM         dbo.Account INNER JOIN
                      dbo.AccountPreferences ON dbo.Account.AccountId = dbo.AccountPreferences.AccountId'

GO
-- Create View rptvueAccountExpenseEntry
Print 'Create View rptvueAccountExpenseEntry'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountExpenseEntry' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountExpenseEntry
AS
SELECT     dbo.vueAccountExpenseEntryForReport.EmployeeName, dbo.vueAccountExpenseEntryForReport.AccountExpenseName, 
                      dbo.vueAccountExpenseEntryForReport.ProjectName, dbo.vueAccountExpenseEntryForReport.AccountExpenseEntryId, 
                      dbo.vueAccountExpenseEntryForReport.AccountExpenseEntryDate, dbo.vueAccountExpenseEntryForReport.AccountId, 
                      dbo.vueAccountExpenseEntryForReport.AccountEmployeeId, dbo.vueAccountExpenseEntryForReport.AccountProjectId, 
                      dbo.vueAccountExpenseEntryForReport.AccountExpenseId, dbo.vueAccountExpenseEntryForReport.Amount, 
                      dbo.vueAccountExpenseEntryForReport.TeamLeadApproved, dbo.vueAccountExpenseEntryForReport.ProjectManagerApproved, 
                      dbo.vueAccountExpenseEntryForReport.AdministratorApproved, dbo.vueAccountExpenseEntryForReport.Approved, dbo.vueAccountExpenseEntryForReport.CreatedOn, 
                      dbo.vueAccountExpenseEntryForReport.CreatedByEmployeeId, dbo.vueAccountExpenseEntryForReport.ModifiedOn, 
                      dbo.vueAccountExpenseEntryForReport.ModifiedByEmployeeId, dbo.vueAccountExpenseEntryForReport.ClientName, 
                      dbo.vueAccountExpenseEntryForReport.AccountClientId, dbo.vueAccountExpenseEntryForReport.Description, dbo.vueAccountExpenseEntryForReport.ExpenseType, 
                      dbo.vueAccountExpenseEntryForReport.AccountExpenseTypeId, dbo.vueAccountExpenseEntryForReport.LeaderEmployeeId, 
                      dbo.vueAccountExpenseEntryForReport.IsBillable, dbo.vueAccountExpenseEntryForReport.Rejected, dbo.vueAccountExpenseEntryForReport.EmployeeCode, 
                      dbo.vueAccountExpenseEntryForReport.Reimburse, dbo.vueAccountExpenseEntryForReport.AccountCurrencyId, 
                      dbo.vueAccountExpenseEntryForReport.CurrencyCode, dbo.vueAccountExpenseEntryForReport.IsQuantityField, 
                      dbo.vueAccountExpenseEntryForReport.QuantityFieldCaption, dbo.vueAccountExpenseEntryForReport.AccountBaseCurrencyId, 
                      dbo.vueAccountExpenseEntryForReport.ExchangeRate, dbo.vueAccountExpenseEntryForReport.TaxAmount, dbo.vueAccountExpenseEntryForReport.NetAmount, 
                      dbo.vueAccountExpenseEntryForReport.Submitted, dbo.vueAccountExpenseEntryForReport.TimeSheetApprovalTypeId, 
                      dbo.vueAccountExpenseEntryForReport.ExpenseApprovalTypeId, dbo.vueAccountExpenseEntryForReport.ProjectManagerEmployeeId, 
                      dbo.vueAccountExpenseEntryForReport.TimeSheetApprovalPathId, dbo.vueAccountExpenseEntryForReport.EMailAddress, 
                      dbo.vueAccountExpenseEntryForReport.DepartmentName, dbo.vueAccountExpenseEntryForReport.AccountLocation, 
                      dbo.vueAccountExpenseEntryForReport.AccountTaxZone, dbo.vueAccountExpenseEntryForReport.Quantity, dbo.vueAccountExpenseEntryForReport.Rate, 
                      dbo.vueAccountExpenseEntryForReport.PaymentMethod, dbo.vueAccountExpenseEntryForReport.AccountLocationId, 
                      dbo.vueAccountExpenseEntryForReport.ClientNick, dbo.vueAccountExpenseEntryForReport.ProjectDescription, dbo.vueAccountExpenseEntryForReport.ProjectCode, 
                      dbo.vueAccountExpenseEntryForReport.DepartmentCode, CASE WHEN vueAccountExpenseEntryForReport.Submitted = 1 AND 
                      vueAccountExpenseEntryForReport.Approved = 0 THEN ''Submitted'' WHEN vueAccountExpenseEntryForReport.Approved = 1 THEN ''Approved'' WHEN vueAccountExpenseEntryForReport.Rejected
                       = 1 THEN ''Rejected'' WHEN vueAccountExpenseEntryForReport.Submitted = 0 AND vueAccountExpenseEntryForReport.Approved = 0 AND 
                      vueAccountExpenseEntryForReport.Rejected = 0 THEN ''Not Submitted'' END AS ApprovalStatus, 
                      dbo.vueAccountExpenseEntryForReport.Comments AS ApproverComments, dbo.vueAccountExpenseEntryForReport.ApprovedOn, 
                      dbo.vueAccountExpenseEntryForReport.AccountDepartmentId, dbo.vueAccountExpenseEntryForReport.Role, dbo.vueAccountExpenseEntryForReport.AccountRoleId, 
                      dbo.vueAccountExpenseEntryForReport.DayNo, dbo.vueAccountExpenseEntryForReport.MonthNo, dbo.vueAccountExpenseEntryForReport.WeekNo, 
                      dbo.vueAccountExpenseEntryForReport.Year, dbo.vueAccountExpenseEntryForReport.Period, dbo.vueAccountExpenseEntryForReport.WeekDayName, 
                      CASE WHEN dbo.vueAccountExpenseEntryForReport.ExchangeRate > 0 THEN dbo.vueAccountExpenseEntryForReport.NetAmount / dbo.vueAccountExpenseEntryForReport.ExchangeRate
                       ELSE 0 END AS CurrencyNetAmount, 
                      CASE WHEN dbo.vueAccountExpenseEntryForReport.ExchangeRate > 0 THEN dbo.vueAccountExpenseEntryForReport.Amount / dbo.vueAccountExpenseEntryForReport.ExchangeRate
                       ELSE 0 END AS CurrencyAmount, 
                      CASE WHEN dbo.vueAccountExpenseEntryForReport.ExchangeRate > 0 THEN dbo.vueAccountExpenseEntryForReport.TaxAmount / dbo.vueAccountExpenseEntryForReport.ExchangeRate
                       ELSE 0 END AS CurrencyTaxAmount, dbo.vueAccountExpenseEntryForReport.InvoiceNumber, dbo.vueAccountExpenseEntryForReport.InvoiceDate, 
                      dbo.vueAccountExpenseEntryForReport.AccountProjectTypeId, dbo.vueAccountExpenseEntryForReport.ProjectType, dbo.vueAccountExpenseEntryForReport.Billed, 
                      dbo.vueAccountExpenseEntryForReport.AccountEmployeeExpenseSheetId, dbo.vueAccountExpenseEntryForReport.ExpenseSheetDescription, 
                      dbo.vueAccountExpenseEntryForReport.ExpenseSheetDate, dbo.vueAccountExpenseEntryForReport.SubmittedDate, 
                      dbo.vueAccountExpenseEntryForReport.SheetApproved, dbo.vueAccountExpenseEntryForReport.SheetRejected, 
                      dbo.vueAccountExpenseEntryForReport.SheetSubmitted, dbo.vueAccountExpenseEntryForReport.SheetInApproval, dbo.vueAccountExpenseEntryForReport.TaskName, 
                      CASE WHEN dbo.vueAccountCurrency.ExchangeRate > 0 THEN dbo.vueAccountExpenseEntryForReport.CurrencyReimbursementAmount * dbo.vueAccountCurrency.ExchangeRate
                       ELSE 0 END AS ReimbursementAmount, dbo.vueAccountCurrency.ExchangeRate AS ReimbursementExchangeRate, 
                      dbo.vueAccountCurrency.CurrencyCode AS ReimbursementCurrencyCode, dbo.vueAccountExpenseEntryForReport.BillableAmount, dbo.vueAccountExpenseEntryForReport.CurrencyReimbursementAmount
FROM         dbo.vueAccountExpenseEntryForReport INNER JOIN
                      dbo.AccountPreferences ON dbo.vueAccountExpenseEntryForReport.AccountId = dbo.AccountPreferences.AccountId INNER JOIN
                      dbo.vueAccountCurrency ON dbo.AccountPreferences.AccountReimbursementCurrencyId = dbo.vueAccountCurrency.AccountCurrencyId'

GO

-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'
if not exists(Select * from [dbo].[SystemReportDataSourceField] where [SystemReportDataSourceFieldId] = '6b298375-0e59-4fa1-83cb-5358783371cd')
BEGIN
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('6b298375-0e59-4fa1-83cb-5358783371cd', '0f2d1d68-826d-400e-bf9f-95d4a9d6c4e0', N'BaseCurrencyReimbursementAmount', 110, 0, NULL, NULL, 54, '0da31ddc-9040-46fa-a33a-74e06a645050', N'Reimbursement Amount (BaseCurrency)', 1, 0)
END

GO
-- Drop View vueAccountProjectTask
Print 'Drop View vueAccountProjectTask'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountProjectTask' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountProjectTask]

GO
-- Create View vueAccountProjectTask
Print 'Create View vueAccountProjectTask'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountProjectTask' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountProjectTask
AS
SELECT     dbo.AccountProjectTask.AccountProjectTaskId, dbo.AccountProjectTask.AccountProjectId, dbo.AccountProjectTask.ParentAccountProjectTaskId, 
                      dbo.AccountProjectTask.TaskName, dbo.AccountProjectTask.TaskDescription, dbo.AccountProjectTask.AccountTaskTypeId, dbo.AccountProjectTask.Duration, 
                      dbo.AccountProjectTask.DurationUnit, dbo.AccountProjectTask.DeadlineDate, dbo.AccountProjectTask.CompletedPercent, dbo.AccountProjectTask.Completed, 
                      dbo.AccountProjectTask.IsParentTask, dbo.AccountProjectTask.IsForAllEmployees, dbo.AccountProjectTask.AccountPriorityId, dbo.AccountProjectTask.TaskStatusId, 
                      dbo.AccountProjectTask.CreatedOn, dbo.AccountProjectTask.CreatedByEmployeeId, dbo.AccountProjectTask.ModifiedOn, 
                      dbo.AccountProjectTask.ModifiedByEmployeeId, dbo.AccountStatus.Status AS TaskStatus, dbo.AccountEmployee.FirstName AS CreatedByFirstName, 
                      dbo.AccountEmployee.LastName AS CreatedByLastName, dbo.AccountPriority.Priority, dbo.AccountProject.ProjectName, dbo.AccountProject.ProjectCode, 
                      dbo.AccountTaskType.TaskType, dbo.AccountProject.AccountId, dbo.AccountProjectTask.AccountProjectMilestoneId, 
                      dbo.AccountProjectMilestone.MilestoneDescription, dbo.AccountProjectTask.IsReOpen, AccountEmployee_1.FirstName AS ModifiedByFirstName, 
                      AccountEmployee_1.LastName AS ModifiedByLastName, dbo.AccountProjectTask.EstimatedCost, dbo.AccountProjectTask.EstimatedTimeSpent, 
                      dbo.AccountProjectTask.EstimatedTimeSpentUnit, dbo.AccountEmployee.AccountEmployeeId, dbo.AccountProjectTask.IsDisabled, dbo.AccountProjectTask.TaskCode, 
                      dbo.AccountProject.IsTemplate, dbo.AccountProjectTask.IsForAllProjectTask, dbo.AccountProjectTask.IsBillable, dbo.AccountProjectTask.EstimatedCurrencyId, 
                      dbo.AccountParty.PartyName, dbo.AccountParty.PartyNick, dbo.AccountProject.AccountClientId, dbo.AccountProject.ProjectDescription, 
                      dbo.AccountProjectMilestone.MilestoneDate, dbo.AccountProject.IsDeleted AS IsProjectDeleted, dbo.AccountProjectTask.StartDate, 
                      dbo.AccountParty.IsDeleted AS IsDeletedClient
FROM         dbo.AccountTaskType RIGHT OUTER JOIN
                      dbo.AccountProjectMilestone RIGHT OUTER JOIN
                      dbo.AccountProject INNER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId RIGHT OUTER JOIN
                      dbo.AccountProjectTask LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON dbo.AccountProjectTask.ModifiedByEmployeeId = AccountEmployee_1.AccountEmployeeId ON 
                      dbo.AccountProject.AccountProjectId = dbo.AccountProjectTask.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountEmployee ON dbo.AccountProjectTask.CreatedByEmployeeId = dbo.AccountEmployee.AccountEmployeeId ON 
                      dbo.AccountProjectMilestone.AccountProjectMilestoneId = dbo.AccountProjectTask.AccountProjectMilestoneId ON 
                      dbo.AccountTaskType.AccountTaskTypeId = dbo.AccountProjectTask.AccountTaskTypeId LEFT OUTER JOIN
                      dbo.AccountStatus ON dbo.AccountProjectTask.TaskStatusId = dbo.AccountStatus.AccountStatusId LEFT OUTER JOIN
                      dbo.AccountPriority ON dbo.AccountProjectTask.AccountPriorityId = dbo.AccountPriority.AccountPriorityId
WHERE     (dbo.AccountProject.IsDeleted <> 1) OR
                      (dbo.AccountProject.IsDeleted IS NULL)'

GO
-- Drop View vueAccountEmployeeProject
Print 'Drop View vueAccountEmployeeProject'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeProject' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeProject]

GO
-- Create View vueAccountEmployeeProject
Print 'Create View vueAccountEmployeeProject'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeProject' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeProject
AS
SELECT     dbo.AccountProject.AccountProjectId, dbo.AccountProject.AccountId, dbo.AccountProject.ProjectName, dbo.AccountProjectEmployee.AccountProjectEmployeeId, 
                      dbo.AccountEmployee.AccountEmployeeId, dbo.AccountProject.IsDisabled, dbo.AccountProject.IsDeleted, dbo.AccountParty.IsDeleted AS IsDeletedClient
FROM         dbo.AccountProject INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountProject.AccountId = dbo.AccountEmployee.AccountId LEFT OUTER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId LEFT OUTER JOIN
                      dbo.AccountProjectEmployee ON dbo.AccountProject.AccountProjectId = dbo.AccountProjectEmployee.AccountProjectId AND 
                      dbo.AccountProject.AccountId = dbo.AccountProjectEmployee.AccountId AND 
                      dbo.AccountEmployee.AccountEmployeeId = dbo.AccountProjectEmployee.AccountEmployeeId'

GO
-- Drop View vueAccountProjects
Print 'Drop View vueAccountProjects'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountProjects' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountProjects]

GO
-- Create View vueAccountProjects
Print 'Create View vueAccountProjects'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountProjects' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountProjects
AS
SELECT     dbo.AccountProject.AccountProjectId, dbo.AccountProject.ProjectName, dbo.AccountProject.StartDate, dbo.AccountProject.ProjectCode, dbo.AccountParty.PartyName, 
                      dbo.AccountProject.AccountClientId, dbo.AccountProject.LeaderEmployeeId, dbo.AccountProject.ProjectManagerEmployeeId, 
                      AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName AS LeaderName, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS ProjectManagerName, dbo.AccountProject.AccountId, dbo.AccountProject.IsActive, 
                      dbo.AccountProject.Deadline, dbo.AccountProject.EstimatedDuration, dbo.AccountProject.EstimatedDurationUnit, dbo.AccountProject.ProjectStatusId, 
                      dbo.AccountStatus.Status, dbo.AccountProject.IsDisabled, dbo.AccountProject.ProjectDescription, dbo.AccountProject.IsTemplate, dbo.AccountProject.IsProject, 
                      dbo.AccountProject.AccountProjectTemplateId, dbo.SystemProjectBillingRateType.SystemProjectBillingRateType, dbo.AccountProject.AccountProjectTypeId, 
                      dbo.AccountProjectType.ProjectType, dbo.AccountProjectType.MasterAccountProjectTypeId, dbo.AccountProject.IsDeleted, 
                      dbo.AccountPartyDepartment.PartyDepartmentName, dbo.AccountParty.IsDeleted AS IsDeletedClient, dbo.AccountProject.Completed
FROM         dbo.AccountStatus RIGHT OUTER JOIN
                      dbo.SystemProjectBillingRateType RIGHT OUTER JOIN
                      dbo.AccountProject INNER JOIN
                      dbo.AccountProjectType ON dbo.AccountProject.AccountProjectTypeId = dbo.AccountProjectType.AccountProjectTypeId INNER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId LEFT OUTER JOIN
                      dbo.AccountPartyDepartment ON dbo.AccountProject.AccountPartyDepartmentId = dbo.AccountPartyDepartment.AccountPartyDepartmentId ON 
                      dbo.SystemProjectBillingRateType.SystemProjectBillingRateTypeId = dbo.AccountProject.ProjectBillingRateTypeId ON 
                      dbo.AccountStatus.AccountStatusId = dbo.AccountProject.ProjectStatusId LEFT OUTER JOIN
                      dbo.AccountEmployee ON dbo.AccountProject.ProjectManagerEmployeeId = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON dbo.AccountProject.LeaderEmployeeId = AccountEmployee_1.AccountEmployeeId'
GO
-- Drop View [dbo].[vueAccountExpenseEntryRejectedEmailToApprover]
Print 'Drop View [dbo].[vueAccountExpenseEntryRejectedEmailToApprover]'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryRejectedEmailToApprover' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountExpenseEntryRejectedEmailToApprover]
GO
-- Drop View [dbo].[vueAccountExpenseEntryApprovedEmailToApprover]
Print 'Drop View [dbo].[vueAccountExpenseEntryApprovedEmailToApprover]'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryApprovedEmailToApprover' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountExpenseEntryApprovedEmailToApprover]
GO
-- Create View [dbo].[vueAccountExpenseEntryApprovedForApproverEmployeeId]
Print 'Create View [dbo].[vueAccountExpenseEntryApprovedForApproverEmployeeId]'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryApprovedForApproverEmployeeId' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountExpenseEntryApprovedForApproverEmployeeId
AS
SELECT     dbo.AccountProject.AccountProjectId, dbo.AccountProject.LeaderEmployeeId, dbo.AccountProject.ProjectManagerEmployeeId, 
                      dbo.AccountApprovalType.ApprovalTypeName, dbo.AccountApprovalPath.AccountApprovalPathId, dbo.AccountApprovalPath.AccountApprovalTypeId, 
                      dbo.AccountApprovalPath.SystemApproverTypeId, dbo.AccountApprovalPath.AccountExternalUserId, dbo.AccountApprovalPath.AccountEmployeeId, 
                      dbo.AccountApprovalPath.ApprovalPathSequence, dbo.AccountExpenseEntry.AccountExpenseEntryId, dbo.AccountExpenseEntryApproval.ExpenseApprovalId, 
                      dbo.AccountExpenseEntryApproval.ExpenseApprovalPathId, dbo.AccountProject.ProjectName, dbo.AccountProject.ProjectDescription, dbo.AccountProject.ProjectCode, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountExpenseEntry.Approved, 
                      dbo.AccountProject.ExpenseApprovalTypeId, dbo.AccountExpenseEntry.AccountExpenseEntryDate, dbo.AccountExpenseEntryApproval.Comments, 
                      dbo.AccountExpenseEntryApproval.IsRejected, dbo.AccountExpenseEntryApproval.IsApproved, dbo.AccountExpenseEntry.Amount, 
                      dbo.AccountExpenseEntry.AccountEmployeeId AS ExpenseEntryAccountEmployeeId, dbo.AccountExpenseEntry.Description, dbo.AccountExpenseEntry.AccountId, 
                      dbo.AccountEmployee.EMailAddress, dbo.AccountExpenseEntry.Submitted, dbo.AccountEmployee.EmployeeManagerId, dbo.AccountExpenseEntry.Rejected, 
                      dbo.AccountExpenseEntry.AccountEmployeeExpenseSheetId, ISNULL(dbo.AccountExpenseEntry.ExchangeRate, 0) AS ExchangeRate, 
                      dbo.AccountEmployeeExpenseSheet.Description AS MasterDescription, dbo.AccountEmployeeExpenseSheet.ExpenseSheetDate, 
                      dbo.AccountEmployeeExpenseSheet.SubmittedDate, 
                      CASE WHEN dbo.AccountApprovalPath.systemapprovertypeid = 1 THEN dbo.AccountProject.LeaderEmployeeId WHEN dbo.AccountApprovalPath.systemapprovertypeid
                       = 2 THEN dbo.AccountProject.ProjectManagerEmployeeId WHEN dbo.AccountApprovalPath.systemapprovertypeid = 3 THEN dbo.AccountApprovalPath.AccountEmployeeId
                       WHEN dbo.AccountApprovalPath.systemapprovertypeid = 4 THEN dbo.AccountApprovalPath.AccountExternalUserId WHEN dbo.AccountApprovalPath.systemapprovertypeid
                       = 5 THEN dbo.AccountEmployee.EmployeeManagerId END AS ApproverEmployeeId
FROM         dbo.AccountExpenseEntryApproval RIGHT OUTER JOIN
                      dbo.AccountEmployeeExpenseSheet INNER JOIN
                      dbo.AccountProject INNER JOIN
                      dbo.AccountApprovalType ON dbo.AccountProject.ExpenseApprovalTypeId = dbo.AccountApprovalType.AccountApprovalTypeId INNER JOIN
                      dbo.AccountApprovalPath ON dbo.AccountApprovalType.AccountApprovalTypeId = dbo.AccountApprovalPath.AccountApprovalTypeId INNER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.AccountExpenseEntry ON dbo.AccountEmployee.AccountEmployeeId = dbo.AccountExpenseEntry.AccountEmployeeId ON 
                      dbo.AccountProject.AccountProjectId = dbo.AccountExpenseEntry.AccountProjectId ON 
                      dbo.AccountEmployeeExpenseSheet.AccountEmployeeExpenseSheetId = dbo.AccountExpenseEntry.AccountEmployeeExpenseSheetId ON 
                      dbo.AccountExpenseEntryApproval.ExpenseApprovalPathId = dbo.AccountApprovalPath.AccountApprovalPathId AND 
                      dbo.AccountExpenseEntryApproval.AccountExpenseEntryId = dbo.AccountExpenseEntry.AccountExpenseEntryId AND 
                      dbo.AccountExpenseEntryApproval.ApprovalPathSequence = dbo.AccountApprovalPath.ApprovalPathSequence'
GO

-- Create View [dbo].[vueAccountExpenseEntryRejectedEmailToApprover]
Print 'Create View [dbo].[vueAccountExpenseEntryRejectedEmailToApprover]'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryRejectedEmailToApprover' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountExpenseEntryRejectedEmailToApprover
AS
SELECT     dbo.AccountEmployee.EMailAddress, dbo.vueAccountExpenseEntry.EmployeeName, dbo.vueAccountExpenseEntry.AccountExpenseName, 
                      dbo.vueAccountExpenseEntry.ProjectName, dbo.vueAccountExpenseEntry.AccountExpenseEntryId, dbo.vueAccountExpenseEntry.AccountExpenseEntryDate, 
                      dbo.vueAccountExpenseEntry.AccountId, dbo.vueAccountExpenseEntry.AccountEmployeeId, dbo.vueAccountExpenseEntry.AccountProjectId, 
                      dbo.vueAccountExpenseEntry.AccountExpenseId, dbo.vueAccountExpenseEntry.Amount, dbo.vueAccountExpenseEntry.TeamLeadApproved, 
                      dbo.vueAccountExpenseEntry.ProjectManagerApproved, dbo.vueAccountExpenseEntry.AdministratorApproved, dbo.vueAccountExpenseEntry.Approved, 
                      dbo.vueAccountExpenseEntry.CreatedOn, dbo.vueAccountExpenseEntry.CreatedByEmployeeId, dbo.vueAccountExpenseEntry.ModifiedOn, 
                      dbo.vueAccountExpenseEntry.ModifiedByEmployeeId, dbo.vueAccountExpenseEntry.PartyName, dbo.vueAccountExpenseEntry.AccountClientId, 
                      dbo.vueAccountExpenseEntry.Description, dbo.vueAccountExpenseEntry.ExpenseType, dbo.vueAccountExpenseEntry.AccountExpenseTypeId, 
                      dbo.vueAccountExpenseEntry.LeaderEmployeeId, dbo.vueAccountExpenseEntry.IsBillable, dbo.vueAccountExpenseEntry.Rejected, 
                      dbo.vueAccountExpenseEntry.EmployeeCode, dbo.vueAccountExpenseEntry.Reimburse, dbo.vueAccountExpenseEntry.AccountCurrencyId, 
                      dbo.vueAccountExpenseEntry.CurrencyCode, dbo.vueAccountExpenseEntry.IsQuantityField, dbo.vueAccountExpenseEntry.QuantityFieldCaption, 
                      dbo.vueAccountExpenseEntry.AccountBaseCurrencyId, dbo.vueAccountExpenseEntry.ExchangeRate, dbo.vueAccountExpenseEntry.TaxAmount, 
                      dbo.vueAccountExpenseEntry.NetAmount, dbo.vueAccountExpenseEntry.Submitted, dbo.vueAccountExpenseEntry.TimeSheetApprovalTypeId, 
                      dbo.vueAccountExpenseEntry.ExpenseApprovalTypeId, dbo.vueAccountExpenseEntry.ProjectManagerEmployeeId, 
                      dbo.vueAccountExpenseEntry.TimeSheetApprovalPathId, dbo.vueAccountExpenseEntry.DepartmentName, dbo.vueAccountExpenseEntry.AccountLocation, 
                      dbo.vueAccountExpenseEntry.AccountTaxZone, dbo.vueAccountExpenseEntry.Quantity, dbo.vueAccountExpenseEntry.Rate, 
                      dbo.vueAccountExpenseEntry.PaymentMethod, dbo.vueAccountExpenseEntry.AccountLocationId, dbo.vueAccountExpenseEntry.PartyNick, 
                      dbo.vueAccountExpenseEntry.ProjectDescription, dbo.vueAccountExpenseEntry.ProjectCode, dbo.vueAccountExpenseEntry.DepartmentCode, 
                      dbo.vueAccountExpenseEntry.ApprovedOn, dbo.vueAccountExpenseEntry.AccountDepartmentId, dbo.vueAccountExpenseEntry.Role, 
                      dbo.vueAccountExpenseEntry.AccountRoleId, dbo.vueAccountExpenseEntry.AccountTimeExpenseBillingExpenseId, dbo.vueAccountExpenseEntry.Billed, 
                      dbo.vueAccountExpenseEntry.InvoiceNumber, dbo.vueAccountExpenseEntry.InvoiceDate, dbo.vueAccountExpenseEntry.AccountProjectTypeId, 
                      dbo.vueAccountExpenseEntry.ProjectType, dbo.vueAccountExpenseEntry.AccountEmployeeExpenseSheetId, dbo.vueAccountExpenseEntry.ExpenseSheetDescription, 
                      dbo.vueAccountExpenseEntry.ExpenseSheetDate, dbo.vueAccountExpenseEntry.SubmittedDate, 
                      dbo.vueAccountExpenseEntryApprovedForApproverEmployeeId.Comments, dbo.vueAccountExpenseEntryApprovedForApproverEmployeeId.ExpenseApprovalId, 
                      dbo.vueAccountBaseCurrency.BaseCurrency, dbo.vueAccountBaseCurrency.CurrencyCode AS BaseCurrencyCode, 
                      dbo.vueAccountExpenseEntryApprovedForApproverEmployeeId.ApproverEmployeeId
FROM         dbo.AccountEmployee INNER JOIN
                      dbo.vueAccountExpenseEntry ON dbo.AccountEmployee.AccountEmployeeId = dbo.vueAccountExpenseEntry.AccountEmployeeId INNER JOIN
                      dbo.vueAccountBaseCurrency ON dbo.vueAccountExpenseEntry.AccountId = dbo.vueAccountBaseCurrency.AccountId LEFT OUTER JOIN
                      dbo.vueAccountExpenseEntryApprovalLastAction INNER JOIN
                      dbo.vueAccountExpenseEntryApprovedForApproverEmployeeId ON 
                      dbo.vueAccountExpenseEntryApprovalLastAction.ExpenseApprovalId = dbo.vueAccountExpenseEntryApprovedForApproverEmployeeId.ExpenseApprovalId ON 
                      dbo.vueAccountExpenseEntry.AccountExpenseEntryId = dbo.vueAccountExpenseEntryApprovedForApproverEmployeeId.AccountExpenseEntryId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_1 ON 
                      dbo.vueAccountExpenseEntryApprovedForApproverEmployeeId.ApproverEmployeeId = AccountEMailNotificationPreference_1.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_2 ON 
                      dbo.vueAccountExpenseEntry.AccountId = AccountEMailNotificationPreference_2.AccountId
WHERE     (AccountEMailNotificationPreference_1.SystemEMailNotificationId = 56) AND (AccountEMailNotificationPreference_1.Enabled = 1) AND 
                      (AccountEMailNotificationPreference_2.SystemEMailNotificationId = 55) AND (AccountEMailNotificationPreference_2.Enabled = 1)'
GO
-- Create View [dbo].[vueAccountExpenseEntryApprovedEmailToApprover]
Print 'Create View [dbo].[vueAccountExpenseEntryApprovedEmailToApprover]'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryApprovedEmailToApprover' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountExpenseEntryApprovedEmailToApprover
AS
SELECT     dbo.AccountEmployee.EMailAddress, dbo.vueAccountExpenseEntry.EmployeeName, dbo.vueAccountExpenseEntry.AccountExpenseName, 
                      dbo.vueAccountExpenseEntry.ProjectName, dbo.vueAccountExpenseEntry.AccountExpenseEntryId, dbo.vueAccountExpenseEntry.AccountExpenseEntryDate, 
                      dbo.vueAccountExpenseEntry.AccountId, dbo.vueAccountExpenseEntry.AccountEmployeeId, dbo.vueAccountExpenseEntry.AccountProjectId, 
                      dbo.vueAccountExpenseEntry.AccountExpenseId, dbo.vueAccountExpenseEntry.Amount, dbo.vueAccountExpenseEntry.TeamLeadApproved, 
                      dbo.vueAccountExpenseEntry.ProjectManagerApproved, dbo.vueAccountExpenseEntry.AdministratorApproved, dbo.vueAccountExpenseEntry.Approved, 
                      dbo.vueAccountExpenseEntry.CreatedOn, dbo.vueAccountExpenseEntry.CreatedByEmployeeId, dbo.vueAccountExpenseEntry.ModifiedOn, 
                      dbo.vueAccountExpenseEntry.ModifiedByEmployeeId, dbo.vueAccountExpenseEntry.PartyName, dbo.vueAccountExpenseEntry.AccountClientId, 
                      dbo.vueAccountExpenseEntry.Description, dbo.vueAccountExpenseEntry.ExpenseType, dbo.vueAccountExpenseEntry.AccountExpenseTypeId, 
                      dbo.vueAccountExpenseEntry.LeaderEmployeeId, dbo.vueAccountExpenseEntry.IsBillable, dbo.vueAccountExpenseEntry.Rejected, 
                      dbo.vueAccountExpenseEntry.EmployeeCode, dbo.vueAccountExpenseEntry.Reimburse, dbo.vueAccountExpenseEntry.AccountCurrencyId, 
                      dbo.vueAccountExpenseEntry.CurrencyCode, dbo.vueAccountExpenseEntry.IsQuantityField, dbo.vueAccountExpenseEntry.QuantityFieldCaption, 
                      dbo.vueAccountExpenseEntry.AccountBaseCurrencyId, dbo.vueAccountExpenseEntry.ExchangeRate, dbo.vueAccountExpenseEntry.TaxAmount, 
                      dbo.vueAccountExpenseEntry.NetAmount, dbo.vueAccountExpenseEntry.Submitted, dbo.vueAccountExpenseEntry.TimeSheetApprovalTypeId, 
                      dbo.vueAccountExpenseEntry.ExpenseApprovalTypeId, dbo.vueAccountExpenseEntry.ProjectManagerEmployeeId, 
                      dbo.vueAccountExpenseEntry.TimeSheetApprovalPathId, dbo.vueAccountExpenseEntry.DepartmentName, dbo.vueAccountExpenseEntry.AccountLocation, 
                      dbo.vueAccountExpenseEntry.AccountTaxZone, dbo.vueAccountExpenseEntry.Quantity, dbo.vueAccountExpenseEntry.Rate, 
                      dbo.vueAccountExpenseEntry.PaymentMethod, dbo.vueAccountExpenseEntry.AccountLocationId, dbo.vueAccountExpenseEntry.PartyNick, 
                      dbo.vueAccountExpenseEntry.ProjectDescription, dbo.vueAccountExpenseEntry.ProjectCode, dbo.vueAccountExpenseEntry.DepartmentCode, 
                      dbo.vueAccountExpenseEntry.ApprovedOn, dbo.vueAccountExpenseEntry.AccountDepartmentId, dbo.vueAccountExpenseEntry.Role, 
                      dbo.vueAccountExpenseEntry.AccountRoleId, dbo.vueAccountExpenseEntry.AccountTimeExpenseBillingExpenseId, dbo.vueAccountExpenseEntry.Billed, 
                      dbo.vueAccountExpenseEntry.InvoiceNumber, dbo.vueAccountExpenseEntry.InvoiceDate, dbo.vueAccountExpenseEntry.AccountProjectTypeId, 
                      dbo.vueAccountExpenseEntry.ProjectType, dbo.vueAccountExpenseEntry.AccountEmployeeExpenseSheetId, dbo.vueAccountExpenseEntry.ExpenseSheetDescription, 
                      dbo.vueAccountExpenseEntry.ExpenseSheetDate, dbo.vueAccountExpenseEntry.SubmittedDate, 
                      dbo.vueAccountExpenseEntryApprovedForApproverEmployeeId.Comments, dbo.vueAccountExpenseEntryApprovedForApproverEmployeeId.ExpenseApprovalId, 
                      dbo.vueAccountBaseCurrency.BaseCurrency, dbo.vueAccountBaseCurrency.CurrencyCode AS BaseCurrencyCode, 
                      dbo.vueAccountExpenseEntryApprovedForApproverEmployeeId.ApproverEmployeeId
FROM         dbo.AccountEmployee INNER JOIN
                      dbo.vueAccountExpenseEntry ON dbo.AccountEmployee.AccountEmployeeId = dbo.vueAccountExpenseEntry.AccountEmployeeId INNER JOIN
                      dbo.vueAccountBaseCurrency ON dbo.vueAccountExpenseEntry.AccountId = dbo.vueAccountBaseCurrency.AccountId LEFT OUTER JOIN
                      dbo.vueAccountExpenseEntryApprovalLastAction INNER JOIN
                      dbo.vueAccountExpenseEntryApprovedForApproverEmployeeId ON 
                      dbo.vueAccountExpenseEntryApprovalLastAction.ExpenseApprovalId = dbo.vueAccountExpenseEntryApprovedForApproverEmployeeId.ExpenseApprovalId ON 
                      dbo.vueAccountExpenseEntry.AccountExpenseEntryId = dbo.vueAccountExpenseEntryApprovedForApproverEmployeeId.AccountExpenseEntryId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_1 ON 
                      dbo.vueAccountExpenseEntryApprovedForApproverEmployeeId.ApproverEmployeeId = AccountEMailNotificationPreference_1.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_2 ON 
                      dbo.vueAccountExpenseEntry.AccountId = AccountEMailNotificationPreference_2.AccountId
WHERE     (AccountEMailNotificationPreference_1.SystemEMailNotificationId = 54) AND (AccountEMailNotificationPreference_1.Enabled = 1) AND 
                      (AccountEMailNotificationPreference_2.SystemEMailNotificationId = 53) AND (AccountEMailNotificationPreference_2.Enabled = 1)'

GO
-- Add Column IsShowElectronicSign to AccountPreferences
Print 'Add Column IsShowElectronicSign to AccountPreferences'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountPreferences' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='IsShowElectronicSign' AND TABLE_NAME='AccountPreferences'))
ALTER TABLE [dbo].[AccountPreferences]
	ADD [IsShowElectronicSign] bit NULL

GO
-- Drop View vueAccountEmployee
Print 'Drop View vueAccountEmployee'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployee]

GO
-- Drop View vueAccount
Print 'Drop View vueAccount'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccount' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccount]

GO
-- Create View vueAccountEmployee
Print 'Create View vueAccountEmployee'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployee
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountEmployee.AccountId, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.Password, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountLocationId, dbo.AccountEmployee.BillingTypeId, 
                      dbo.AccountBillingType.BillingType, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, dbo.AccountPreferences.ShowClockStartEnd, dbo.Account.TimeZoneId, 
                      dbo.AccountRole.MasterAccountRoleId, dbo.Account.DefaultCurrencyId, dbo.Account.CountryId, dbo.AccountPreferences.CultureInfoName, 
                      dbo.AccountPreferences.TimeEntryFormat, dbo.AccountEmployee.AllowedAccessFromIP, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountPreferences.AccountSessionTimeout, dbo.AccountPreferences.ShowCompletedTasksInTimeSheet, dbo.AccountPreferences.CurrencySymbol, 
                      dbo.AccountPreferences.IsCompanyOwnLogo, dbo.Account.AccountExpiryActivation, dbo.Account.LicenseActivation, dbo.AccountEmployee.EmployeeTypeId, 
                      dbo.AccountEmployee.ExternalUserClientId, dbo.AccountEmployee.AccountBillingRateId, dbo.AccountPreferences.ScheduledEmailSendTime, 
                      dbo.AccountEmployee.Username, dbo.AccountEmployee.IsDisabled, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.AccountEmployee.EmployeeCode, dbo.AccountPreferences.Version, 
                      dbo.AccountPreferences.LockSubmittedRecords, dbo.AccountPreferences.LockApprovedRecords, ISNULL(dbo.AccountEmployee.EmployeeCode + '' - '', '''') 
                      + dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeNameWithCode, dbo.AccountPreferences.ShowWorkTypeInTimeSheet, 
                      dbo.AccountPreferences.NumberOfBlankRowsInTimeEntry, dbo.AccountPreferences.ShowCostCenterInTimeSheet, dbo.AccountPreferences.WeekStartDay, 
                      dbo.AccountPreferences.AccountBaseCurrencyId, dbo.AccountPreferences.UserInterfaceLanguage, dbo.AccountEmployee.EmployeeManagerId, 
                      dbo.AccountPreferences.DefaultTimeEntryMode, dbo.AccountPreferences.PageSize, dbo.AccountEmployee.TimeZoneId AS EmployeeTimeZoneId, 
                      dbo.AccountEmployee.TerminationDate, dbo.AccountEmployee.StatusId, dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.EmployeePayTypeId, 
                      dbo.AccountEmployee.HiredDate, dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountWorkingDayType, 
                      dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay AS EmployeeWeekStartDay, 
                      dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountPreferences.ShowDescriptionInWeekView, 
                      dbo.AccountPreferences.InvoiceNoPrefix, dbo.AccountPreferences.ShowAdditionalTaskInformationType, 
                      dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, 
                      ISNULL(dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, 1) AS InitialDayOfTheMonth, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, 1) 
                      AS SystemInitialDayOfFirstPeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod, 16) AS SystemInitialDayOfLastPeriod, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountPreferences.TimesheetPrintFooter, dbo.AccountPreferences.ExpenseSheetPrintFooter, 
                      dbo.AccountPreferences.ShowCompletedProjectsInTimeSheet, dbo.AccountPreferences.ShowProjectForTimeOff, dbo.AccountPreferences.ShowTimeOffInTimesheet, 
                      dbo.AccountEmployee.IsDeleted, dbo.AccountEmployee.IsForcePasswordChange, dbo.AccountEmployee.PasswordChangedDate, 
                      dbo.AccountPreferences.PasswordExpiryPeriod, dbo.AccountPreferences.ShowAllInTimesheetReadOnly, dbo.AccountPreferences.ShowTaskInExpenseSheet, 
                      dbo.AccountPreferences.InvoiceBillingTypeId, dbo.AccountPreferences.ShowBillingRateInInvoiceReport, dbo.SystemInvoiceBillingType.InvoiceBillingType, 
                      dbo.AccountPreferences.InvoiceFooter, dbo.AccountPreferences.TimesheetOverduePeriods, dbo.AccountWorkingDayType.TimesheetOverdueAfterDays, 
                      dbo.AccountEmployee.CreatedOn, dbo.AccountEmployee.CreatedByEmployeeId, dbo.AccountEmployee.ModifiedOn, dbo.AccountEmployee.ModifiedByEmployeeId, 
                      dbo.AccountPreferences.ShowProjectNameInInvoiceReport, dbo.AccountPreferences.ProjectCodePrefix, dbo.AccountPreferences.AutoGenerateProjectCode, 
                      dbo.AccountPreferences.TimeEntryHoursFormatId, dbo.AccountPreferences.ShowPercentageInTimesheet, dbo.AccountPreferences.EnablePasswordComplexity, 
                      dbo.AccountPreferences.ShowClientDepartmentInProject, dbo.AccountPreferences.ShowEntryDateInInvoiceReport, dbo.AccountPreferences.TimesheetSort, 
                      dbo.AccountPreferences.ShowCostCenterInTimesheetBy, ShowCopyTimesheetButton, ShowCopyActivitiesButtonInTimesheet, ShowProjectNameInTask, ShowClientNameInTask, IsShowElectronicSign
FROM         dbo.SystemInvoiceBillingType RIGHT OUTER JOIN
                      dbo.AccountPreferences ON dbo.SystemInvoiceBillingType.InvoiceBillingTypeId = dbo.AccountPreferences.InvoiceBillingTypeId RIGHT OUTER JOIN
                      dbo.vueAccountTimesheetPeriodType RIGHT OUTER JOIN
                      dbo.AccountWorkingDayType ON 
                      dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId = dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId RIGHT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.Account ON dbo.AccountEmployee.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId ON 
                      dbo.AccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId ON 
                      dbo.AccountPreferences.AccountId = dbo.AccountEmployee.AccountId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId'


GO
-- Create View vueAccount
Print 'Create View vueAccount'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccount' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccount
AS
SELECT     dbo.Account.AccountId, dbo.Account.AccountTypeId, dbo.Account.AccountName, dbo.Account.Address1, dbo.Account.Address2, dbo.Account.ZipCode, dbo.Account.State, 
                      dbo.Account.City, dbo.Account.CountryId, dbo.Account.EMailAddress, dbo.Account.Telephone, dbo.Account.Fax, dbo.Account.DefaultCurrencyId, 
                      dbo.Account.TimeZoneId, dbo.Account.IsDisabled, dbo.Account.IsDeleted, dbo.Account.StatusId, dbo.Account.CreatedOn, dbo.Account.ModifiedOn, 
                      dbo.Account.ModifiedByEmployeeId, dbo.AccountPreferences.ShowClockStartEnd, dbo.AccountPreferences.AccountPreferencesId, dbo.Account.LicenseKey, 
                      dbo.Account.SystemPackageTypeId, dbo.AccountPreferences.TimeEntryFormat, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.Account.MachineId, dbo.Account.ActivationLicenseKey, dbo.Account.ActivationMachineKey, 
                      dbo.Account.ActivationType, dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountPreferences.InvoiceBillingTypeId, 
                      dbo.AccountPreferences.ShowBillingRateInInvoiceReport, dbo.AccountPreferences.InvoiceFooter, dbo.AccountPreferences.ShowProjectNameInInvoiceReport, 
                      dbo.AccountPreferences.ProjectCodePrefix, dbo.AccountPreferences.AutoGenerateProjectCode, dbo.AccountPreferences.TimeEntryHoursFormatId, 
                      dbo.AccountPreferences.ShowPercentageInTimesheet, dbo.AccountPreferences.EnablePasswordComplexity, dbo.AccountPreferences.ShowClientDepartmentInProject, 
                      dbo.AccountPreferences.ShowEntryDateInInvoiceReport, dbo.AccountPreferences.TimesheetSort, dbo.AccountPreferences.ShowCostCenterInTimesheetBy,
					  dbo.AccountPreferences.ShowCopyTimesheetButton, dbo.AccountPreferences.ShowCopyActivitiesButtonInTimesheet,
					  ShowProjectNameInTask, ShowClientNameInTask, IsShowElectronicSign	
FROM         dbo.Account INNER JOIN
                      dbo.AccountPreferences ON dbo.Account.AccountId = dbo.AccountPreferences.AccountId'

GO

-- Drop View vueAccountEmployeeTimeEntryApprovalForReport
Print 'Drop View vueAccountEmployeeTimeEntryApprovalForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryApprovalForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryApprovalForReport]

GO
-- Create View vueAccountEmployeeTimeEntryApprovalForReport
Print 'Create View vueAccountEmployeeTimeEntryApprovalForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryApprovalForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryApprovalForReport
AS
SELECT     dbo.AccountEmployeeTimeEntryApproval.AccountProjectId, dbo.AccountProject.ProjectName, dbo.AccountProject.AccountId, 
                      dbo.AccountEmployeeTimeEntryApproval.ApprovedByEmployeeId, dbo.AccountProject.AccountClientId, dbo.AccountParty.PartyName, dbo.AccountParty.PartyNick, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, dbo.AccountEmployeeTimeEntry.AccountEmployeeId, 
                      AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName AS ApprovalEmployeeName, dbo.AccountEmployeeTimeEntryApproval.TimeSheetApprovalId, 
                      dbo.AccountEmployeeTimeEntryApproval.AccountEmployeeTimeEntryId, dbo.AccountEmployeeTimeEntryApproval.TimeSheetApprovalTypeId, 
                      dbo.AccountEmployeeTimeEntryApproval.TimeSheetApprovalPathId, dbo.AccountEmployeeTimeEntryApproval.ApprovedOn, 
                      dbo.AccountEmployeeTimeEntryApproval.Comments, dbo.AccountEmployeeTimeEntryApproval.IsReject, dbo.AccountEmployeeTimeEntryApproval.IsApproved, 
                      dbo.AccountEmployeeTimeEntryApproval.AccountEmployeeTimeEntryPeriodId, dbo.AccountEmployeeTimeEntryApproval.PreviousStatus, 
                      dbo.AccountEmployeeTimeEntryApproval.BatchId
FROM         dbo.AccountEmployee RIGHT OUTER JOIN
                      dbo.AccountEmployeeTimeEntry ON dbo.AccountEmployee.AccountEmployeeId = dbo.AccountEmployeeTimeEntry.AccountEmployeeId RIGHT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 INNER JOIN
                      dbo.AccountEmployeeTimeEntryApproval INNER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntryApproval.AccountProjectId = dbo.AccountProject.AccountProjectId INNER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId ON 
                      AccountEmployee_1.AccountEmployeeId = dbo.AccountEmployeeTimeEntryApproval.ApprovedByEmployeeId ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId = dbo.AccountEmployeeTimeEntryApproval.AccountEmployeeTimeEntryId'


GO
-- Drop View [dbo].[vueAccountEmployee]
Print 'Drop View [dbo].[vueAccountEmployee]'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployee]

GO
-- Drop View [dbo].[vueAccountWorkingDayType]
Print 'Drop View [dbo].[vueAccountWorkingDayType]'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountWorkingDayType' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountWorkingDayType]

GO
-- Add Column [MinimumPercentagePerDay] to [dbo].[MasterWorkingDayType]
Print 'Add Column [MinimumPercentagePerDay] to [dbo].[MasterWorkingDayType]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'MasterWorkingDayType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='MinimumPercentagePerDay' AND TABLE_NAME='MasterWorkingDayType'))
ALTER TABLE [dbo].[MasterWorkingDayType]
	ADD [MinimumPercentagePerDay] [int] NULL

GO
-- Add Column [MaximumPercentagePerDay] to [dbo].[MasterWorkingDayType]
Print 'Add Column [MaximumPercentagePerDay] to [dbo].[MasterWorkingDayType]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'MasterWorkingDayType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='MaximumPercentagePerDay' AND TABLE_NAME='MasterWorkingDayType'))
ALTER TABLE [dbo].[MasterWorkingDayType]
	ADD [MaximumPercentagePerDay] [int] NULL

GO
-- Add Column [MinimumPercentagePerWeek] to [dbo].[MasterWorkingDayType]
Print 'Add Column [MinimumPercentagePerWeek] to [dbo].[MasterWorkingDayType]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'MasterWorkingDayType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='MinimumPercentagePerWeek' AND TABLE_NAME='MasterWorkingDayType'))
ALTER TABLE [dbo].[MasterWorkingDayType]
	ADD [MinimumPercentagePerWeek] [int] NULL

GO
-- Add Column [MaximumPercentagePerWeek] to [dbo].[MasterWorkingDayType]
Print 'Add Column [MaximumPercentagePerWeek] to [dbo].[MasterWorkingDayType]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'MasterWorkingDayType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='MaximumPercentagePerWeek' AND TABLE_NAME='MasterWorkingDayType'))
ALTER TABLE [dbo].[MasterWorkingDayType]
	ADD [MaximumPercentagePerWeek] [int] NULL

GO
-- Add Column [MinimumPercentagePerDay] to [dbo].[AccountWorkingDayType]
Print 'Add Column [MinimumPercentagePerDay] to [dbo].[AccountWorkingDayType]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountWorkingDayType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='MinimumPercentagePerDay' AND TABLE_NAME='AccountWorkingDayType'))
ALTER TABLE [dbo].[AccountWorkingDayType]
	ADD [MinimumPercentagePerDay] [int] NULL

GO
-- Add Column [MaximumPercentagePerDay] to [dbo].[AccountWorkingDayType]
Print 'Add Column [MaximumPercentagePerDay] to [dbo].[AccountWorkingDayType]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountWorkingDayType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='MaximumPercentagePerDay' AND TABLE_NAME='AccountWorkingDayType'))
ALTER TABLE [dbo].[AccountWorkingDayType]
	ADD [MaximumPercentagePerDay] [int] NULL

GO
-- Add Column [MinimumPercentagePerWeek] to [dbo].[AccountWorkingDayType]
Print 'Add Column [MinimumPercentagePerWeek] to [dbo].[AccountWorkingDayType]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountWorkingDayType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='MinimumPercentagePerWeek' AND TABLE_NAME='AccountWorkingDayType'))
ALTER TABLE [dbo].[AccountWorkingDayType]
	ADD [MinimumPercentagePerWeek] [int] NULL

GO
-- Add Column [MaximumPercentagePerWeek] to [dbo].[AccountWorkingDayType]
Print 'Add Column [MaximumPercentagePerWeek] to [dbo].[AccountWorkingDayType]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountWorkingDayType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='MaximumPercentagePerWeek' AND TABLE_NAME='AccountWorkingDayType'))
ALTER TABLE [dbo].[AccountWorkingDayType]
	ADD [MaximumPercentagePerWeek] [int] NULL

GO
-- Create View [dbo].[vueAccountWorkingDayType]
Print 'Create View [dbo].[vueAccountWorkingDayType]'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountWorkingDayType' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountWorkingDayType
AS
SELECT     dbo.AccountWorkingDayType.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountId, dbo.AccountWorkingDayType.AccountWorkingDayType, 
                      dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay, dbo.AccountWorkingDayType.CreatedByEmployeeId, 
                      dbo.AccountWorkingDayType.CreatedOn, dbo.AccountWorkingDayType.ModifiedByEmployeeId, dbo.AccountWorkingDayType.ModifiedOn, 
                      dbo.AccountWorkingDayType.IsDisabled, dbo.SystemWorkingDay.WorkingDay, dbo.AccountWorkingDayType.MasterWorkingDayTypeId, 
                      dbo.SystemWorkingDay.SQLServerWeekDayNo, dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, 
                      dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, 
                      dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod, dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId, 
                      dbo.AccountWorkingDayType.TimesheetOverdueAfterDays, ISNULL(dbo.AccountWorkingDayType.MinimumPercentagePerDay, 0) AS MinimumPercentagePerDay, 
                      ISNULL(dbo.AccountWorkingDayType.MaximumPercentagePerDay, 100) AS MaximumPercentagePerDay, 
                      ISNULL(dbo.AccountWorkingDayType.MinimumPercentagePerWeek, 0) AS MinimumPercentagePerWeek, 
                      ISNULL(dbo.AccountWorkingDayType.MaximumPercentagePerWeek, 500) AS MaximumPercentagePerWeek
FROM         dbo.AccountWorkingDayType LEFT OUTER JOIN
                      dbo.vueAccountTimesheetPeriodType ON 
                      dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId = dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId LEFT OUTER JOIN
                      dbo.SystemWorkingDay ON dbo.AccountWorkingDayType.WeekStartDay = dbo.SystemWorkingDay.WorkingDayNo'

GO
-- Create View [dbo].[vueAccountEmployee]
Print 'Create View [dbo].[vueAccountEmployee]'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployee
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountEmployee.AccountId, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.Password, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountLocationId, dbo.AccountEmployee.BillingTypeId, 
                      dbo.AccountBillingType.BillingType, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, dbo.AccountPreferences.ShowClockStartEnd, dbo.Account.TimeZoneId, 
                      dbo.AccountRole.MasterAccountRoleId, dbo.Account.DefaultCurrencyId, dbo.Account.CountryId, dbo.AccountPreferences.CultureInfoName, 
                      dbo.AccountPreferences.TimeEntryFormat, dbo.AccountEmployee.AllowedAccessFromIP, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountPreferences.AccountSessionTimeout, dbo.AccountPreferences.ShowCompletedTasksInTimeSheet, dbo.AccountPreferences.CurrencySymbol, 
                      dbo.AccountPreferences.IsCompanyOwnLogo, dbo.Account.AccountExpiryActivation, dbo.Account.LicenseActivation, dbo.AccountEmployee.EmployeeTypeId, 
                      dbo.AccountEmployee.ExternalUserClientId, dbo.AccountEmployee.AccountBillingRateId, dbo.AccountPreferences.ScheduledEmailSendTime, 
                      dbo.AccountEmployee.Username, dbo.AccountEmployee.IsDisabled, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.AccountEmployee.EmployeeCode, dbo.AccountPreferences.Version, 
                      dbo.AccountPreferences.LockSubmittedRecords, dbo.AccountPreferences.LockApprovedRecords, ISNULL(dbo.AccountEmployee.EmployeeCode + '' - '', '''') 
                      + dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeNameWithCode, dbo.AccountPreferences.ShowWorkTypeInTimeSheet, 
                      dbo.AccountPreferences.NumberOfBlankRowsInTimeEntry, dbo.AccountPreferences.ShowCostCenterInTimeSheet, dbo.AccountPreferences.WeekStartDay, 
                      dbo.AccountPreferences.AccountBaseCurrencyId, dbo.AccountPreferences.UserInterfaceLanguage, dbo.AccountEmployee.EmployeeManagerId, 
                      dbo.AccountPreferences.DefaultTimeEntryMode, dbo.AccountPreferences.PageSize, dbo.AccountEmployee.TimeZoneId AS EmployeeTimeZoneId, 
                      dbo.AccountEmployee.TerminationDate, dbo.AccountEmployee.StatusId, dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.EmployeePayTypeId, 
                      dbo.AccountEmployee.HiredDate, dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountWorkingDayType, 
                      dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay AS EmployeeWeekStartDay, 
                      dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountPreferences.ShowDescriptionInWeekView, 
                      dbo.AccountPreferences.InvoiceNoPrefix, dbo.AccountPreferences.ShowAdditionalTaskInformationType, 
                      dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, 
                      ISNULL(dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, 1) AS InitialDayOfTheMonth, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, 1) 
                      AS SystemInitialDayOfFirstPeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod, 16) AS SystemInitialDayOfLastPeriod, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountPreferences.TimesheetPrintFooter, dbo.AccountPreferences.ExpenseSheetPrintFooter, 
                      dbo.AccountPreferences.ShowCompletedProjectsInTimeSheet, dbo.AccountPreferences.ShowProjectForTimeOff, dbo.AccountPreferences.ShowTimeOffInTimesheet, 
                      dbo.AccountEmployee.IsDeleted, dbo.AccountEmployee.IsForcePasswordChange, dbo.AccountEmployee.PasswordChangedDate, 
                      dbo.AccountPreferences.PasswordExpiryPeriod, dbo.AccountPreferences.ShowAllInTimesheetReadOnly, dbo.AccountPreferences.ShowTaskInExpenseSheet, 
                      dbo.AccountPreferences.InvoiceBillingTypeId, dbo.AccountPreferences.ShowBillingRateInInvoiceReport, dbo.SystemInvoiceBillingType.InvoiceBillingType, 
                      dbo.AccountPreferences.InvoiceFooter, dbo.AccountPreferences.TimesheetOverduePeriods, dbo.AccountWorkingDayType.TimesheetOverdueAfterDays, 
                      dbo.AccountEmployee.CreatedOn, dbo.AccountEmployee.CreatedByEmployeeId, dbo.AccountEmployee.ModifiedOn, dbo.AccountEmployee.ModifiedByEmployeeId, 
                      dbo.AccountPreferences.ShowProjectNameInInvoiceReport, dbo.AccountPreferences.ProjectCodePrefix, dbo.AccountPreferences.AutoGenerateProjectCode, 
                      dbo.AccountPreferences.TimeEntryHoursFormatId, dbo.AccountPreferences.ShowPercentageInTimesheet, dbo.AccountPreferences.EnablePasswordComplexity, 
                      dbo.AccountPreferences.ShowClientDepartmentInProject, dbo.AccountPreferences.ShowEntryDateInInvoiceReport, dbo.AccountPreferences.TimesheetSort, 
                      dbo.AccountPreferences.ShowCostCenterInTimesheetBy, dbo.AccountPreferences.ShowCopyTimesheetButton, 
                      dbo.AccountPreferences.ShowCopyActivitiesButtonInTimesheet, dbo.AccountPreferences.ShowProjectNameInTask, dbo.AccountPreferences.ShowClientNameInTask, 
                      dbo.AccountPreferences.IsShowElectronicSign, ISNULL(dbo.AccountWorkingDayType.MinimumPercentagePerDay, 0) AS MinimumPercentagePerDay, 
                      ISNULL(dbo.AccountWorkingDayType.MaximumPercentagePerDay, 100) AS MaximumPercentagePerDay, 
                      ISNULL(dbo.AccountWorkingDayType.MinimumPercentagePerWeek, 0) AS MinimumPercentagePerWeek, 
                      ISNULL(dbo.AccountWorkingDayType.MaximumPercentagePerWeek, 500) AS MaximumPercentagePerWeek
FROM         dbo.SystemInvoiceBillingType RIGHT OUTER JOIN
                      dbo.AccountPreferences ON dbo.SystemInvoiceBillingType.InvoiceBillingTypeId = dbo.AccountPreferences.InvoiceBillingTypeId RIGHT OUTER JOIN
                      dbo.vueAccountTimesheetPeriodType RIGHT OUTER JOIN
                      dbo.AccountWorkingDayType ON 
                      dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId = dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId RIGHT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.Account ON dbo.AccountEmployee.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId ON 
                      dbo.AccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId ON 
                      dbo.AccountPreferences.AccountId = dbo.AccountEmployee.AccountId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId'

GO
If exists(Select * from SystemData where version = '4.0.4')
--Update SystemSecurityCategoryPage Record
BEGIN           
Update MasterWorkingDayType set MinimumPercentagePerDay = 0, MaximumPercentagePerDay = 100, MinimumPercentagePerWeek = 0, MaximumPercentagePerWeek = 500
where MasterWorkingDayTypeId = '06ddc13d-7195-489d-a7e7-935567b7a285'
END
GO
Update SystemData Set Version = '4.0.5' Where Version = '4.0.4' And SystemDataId = 1

GO

-- Drop View [dbo].[vueTimesheetSummaryPendingForApproval]
Print 'Drop View [dbo].[vueTimesheetSummaryPendingForApproval]'
GO
DROP VIEW [dbo].[vueTimesheetSummaryPendingForApproval]

GO

-- Drop View [dbo].[vueAccountTimeExpenseBillingReport]
Print 'Drop View [dbo].[vueAccountTimeExpenseBillingReport]'
GO
DROP VIEW [dbo].[vueAccountTimeExpenseBillingReport]

GO

-- Drop View [dbo].[vueTimesheetSummaryForApproval]
Print 'Drop View [dbo].[vueTimesheetSummaryForApproval]'
GO
DROP VIEW [dbo].[vueTimesheetSummaryForApproval]


GO
-- Create View [dbo].[vueAccountTimeExpenseBillingReport]
Print 'Create View [dbo].[vueAccountTimeExpenseBillingReport]'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountTimeExpenseBillingReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountTimeExpenseBillingReport
AS
SELECT     dbo.AccountTimeExpenseBilling.InvoiceNumber, dbo.AccountTimeExpenseBilling.InvoiceDate, ISNULL(dbo.AccountTimeExpenseBilling.PONumber, 0) AS PONumber, 
                      ISNULL(dbo.AccountTimeExpenseBilling.SubTotal, 0) AS SubTotal, ISNULL(dbo.AccountTimeExpenseBilling.TaxCode1, 0) AS TaxCode1, 
                      ISNULL(dbo.AccountTimeExpenseBilling.TaxCode2, 0) AS TaxCode2, ISNULL(dbo.AccountTimeExpenseBilling.GrandTotal, 0) AS GrandTotal, 
                      dbo.AccountTimeExpenseBilling.AccountId, dbo.AccountTimeExpenseBillingTimesheet.Description AS [Detail Description], 
                      ISNULL(dbo.AccountTimeExpenseBillingTimesheet.ActualBillingRate, 0) AS ActualBillingRate, ISNULL(dbo.AccountTimeExpenseBillingTimesheet.BillHours, 0) 
                      AS BillHours, ISNULL(dbo.AccountTimeExpenseBillingTimesheet.TotalAmount, 0) AS TotalAmount, dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId, 
                      dbo.AccountParty.PartyName, dbo.AccountTimeExpenseBilling.Description AS [Master Description], dbo.AccountParty.Address1, dbo.AccountParty.Address2, 
                      dbo.Account.AccountName, dbo.Account.Address1 AS AccountAddress1, dbo.Account.ZipCode, dbo.Account.State, dbo.Account.City, dbo.Account.Telephone, 
                      dbo.Account.Address2 AS AccountAddress2, dbo.AccountTimeExpenseBilling.AccountCurrencyId, dbo.SystemCurrency.CurrencyCode, 
                      dbo.AccountPreferences.InvoiceNoPrefix, dbo.AccountParty.State AS ClientState, dbo.AccountParty.City AS ClientCity, dbo.AccountParty.ZipCode AS ClientZipcode, 
                      dbo.AccountParty.Telephone1 AS ClientTelephone, dbo.AccountParty.Fax AS ClientFax, SystemCountry_1.Country AS AccountCountry, 
                      dbo.SystemCountry.Country AS ClientCountry, dbo.AccountTimeExpenseBilling.Terms, dbo.AccountTimeExpenseBilling.BankDetails, dbo.AccountProject.ProjectName, 
                      AccountProject_1.ProjectName AS MasterProjectName, dbo.AccountEmployeeTimeEntry.TimeEntryDate, CONVERT(varchar, 
                      dbo.AccountTimeExpenseBilling.BillingCycleStartDate, 105) AS BillingCycleStartDate, CONVERT(varchar, dbo.AccountTimeExpenseBilling.BillingCycleEndDate, 105) 
                      AS BillingCycleEndDate
FROM         dbo.AccountProject RIGHT OUTER JOIN
                      dbo.SystemCountry RIGHT OUTER JOIN
                      dbo.AccountParty ON dbo.SystemCountry.CountryId = dbo.AccountParty.CountryId RIGHT OUTER JOIN
                      dbo.Account ON dbo.AccountParty.AccountId = dbo.Account.AccountId LEFT OUTER JOIN
                      dbo.SystemCountry AS SystemCountry_1 ON dbo.Account.CountryId = SystemCountry_1.CountryId LEFT OUTER JOIN
                      dbo.AccountPreferences ON dbo.Account.AccountId = dbo.AccountPreferences.AccountId RIGHT OUTER JOIN
                      dbo.AccountProject AS AccountProject_1 RIGHT OUTER JOIN
                      dbo.AccountCurrency INNER JOIN
                      dbo.AccountTimeExpenseBilling ON dbo.AccountCurrency.AccountCurrencyId = dbo.AccountTimeExpenseBilling.AccountCurrencyId INNER JOIN
                      dbo.SystemCurrency ON dbo.AccountCurrency.SystemCurrencyId = dbo.SystemCurrency.CurrencyId ON 
                      AccountProject_1.AccountProjectId = dbo.AccountTimeExpenseBilling.AccountProjectId ON 
                      dbo.AccountParty.AccountPartyId = dbo.AccountTimeExpenseBilling.AccountClientId LEFT OUTER JOIN
                      dbo.AccountTimeExpenseBillingTimesheet ON 
                      dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId = dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingId ON 
                      dbo.AccountProject.AccountProjectId = dbo.AccountTimeExpenseBillingTimesheet.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntry ON 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountEmployeeTimeEntryId = dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId'

GO
-- Create View [dbo].[vueTimesheetSummaryForApproval]
Print 'Create View [dbo].[vueTimesheetSummaryForApproval]'
GO
if not exists (select * from information_schema.tables where table_name = 'vueTimesheetSummaryForApproval' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueTimesheetSummaryForApproval
AS
SELECT     dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId, 
                      dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeId AS TimeEntryAccountEmployeeId, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, 
                      dbo.AccountEmployeeTimeEntryApproval.TimeSheetApprovalId, dbo.AccountApprovalPath.AccountApprovalPathId, dbo.AccountApprovalPath.SystemApproverTypeId, 
                      dbo.AccountApprovalPath.AccountExternalUserId, dbo.AccountApprovalPath.AccountEmployeeId, dbo.AccountApprovalPath.ApprovalPathSequence, 
                      dbo.AccountProject.LeaderEmployeeId, dbo.AccountProject.ProjectManagerEmployeeId, dbo.AccountApprovalType.AccountApprovalTypeId, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, dbo.AccountEmployee.EmployeeManagerId, 
                      dbo.AccountProject.AccountProjectId, dbo.AccountEmployeeTimeEntryApproval.IsApproved, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountEmployeeTimeEntryApprovalProject.AccountEmployeeTimeEntryApprovalProjectId, dbo.AccountEmployeeTimeEntryApproval.PreviousStatus, 
                      dbo.AccountEmployeeTimeEntryApproval.IsReject, dbo.AccountEmployeeTimeEntryApprovalProject.Submitted, 
                      dbo.AccountEmployeeTimeEntryApprovalProject.Approved, dbo.AccountEmployeeTimeEntryApprovalProject.Rejected, 
                      dbo.AccountEmployeeTimeEntryApprovalProject.IsEmailSend, dbo.AccountEmployeeTimeEntryPeriod.SubmittedDate, dbo.AccountEmployee.IsDisabled, 
                      dbo.AccountEmployee.IsDeleted
FROM         dbo.AccountApprovalType INNER JOIN
                      dbo.AccountEmployeeTimeEntryApprovalProject INNER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntryApprovalProject.AccountProjectId = dbo.AccountProject.AccountProjectId ON 
                      dbo.AccountApprovalType.AccountApprovalTypeId = dbo.AccountProject.TimeSheetApprovalTypeId INNER JOIN
                      dbo.AccountApprovalPath ON dbo.AccountApprovalType.AccountApprovalTypeId = dbo.AccountApprovalPath.AccountApprovalTypeId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryApproval ON dbo.AccountApprovalPath.ApprovalPathSequence = dbo.AccountEmployeeTimeEntryApproval.ApprovalPathSequence AND 
                      dbo.AccountEmployeeTimeEntryApproval.PreviousStatus <> 1 AND dbo.AccountEmployeeTimeEntryApproval.IsReject <> 1 AND 
                      dbo.AccountEmployeeTimeEntryApprovalProject.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntryApproval.AccountEmployeeTimeEntryPeriodId AND
                       dbo.AccountEmployeeTimeEntryApprovalProject.AccountProjectId = dbo.AccountEmployeeTimeEntryApproval.AccountProjectId RIGHT OUTER JOIN
                      dbo.AccountEmployee RIGHT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryPeriod ON dbo.AccountEmployee.AccountEmployeeId = dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeId ON 
                      dbo.AccountEmployeeTimeEntryApprovalProject.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId'


GO
-- Create View [dbo].[vueTimesheetSummaryPendingForApproval]
Print 'Create View [dbo].[vueTimesheetSummaryPendingForApproval]'
GO
if not exists (select * from information_schema.tables where table_name = 'vueTimesheetSummaryPendingForApproval' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueTimesheetSummaryPendingForApproval
AS
SELECT     AccountEmployeeTimeEntryPeriodId, TimeEntryAccountEmployeeId, TimeEntryStartDate, TimeEntryEndDate, TimeEntryViewType, Submitted, Approved, Rejected, 
                      MAX(TimeSheetApprovalId) AS TimeSheetApprovalId, AccountApprovalPathId, SystemApproverTypeId, AccountExternalUserId, AccountEmployeeId, 
                      ApprovalPathSequence, LeaderEmployeeId, ProjectManagerEmployeeId, AccountApprovalTypeId, EmployeeName, EmployeeManagerId, AccountProjectId, 
                      CASE WHEN systemapprovertypeid = 1 THEN LeaderEmployeeId WHEN systemapprovertypeid = 2 THEN ProjectManagerEmployeeId WHEN systemapprovertypeid = 3
                       THEN AccountEmployeeId WHEN systemapprovertypeid = 4 THEN AccountExternalUserId WHEN systemapprovertypeid = 5 THEN EmployeeManagerId END AS ApproverEmployeeId,
                       IsApproved, EMailAddress, AccountEmployeeTimeEntryApprovalProjectId, IsEmailSend, SubmittedDate, IsDisabled, IsDeleted
FROM         dbo.vueTimesheetSummaryForApproval
WHERE     (ApprovalPathSequence IN
                          (SELECT     TOP (1) ApprovalPathSequence
                            FROM          dbo.vueTimesheetSequenceForApproval
                            WHERE      (TimeSheetApprovalId IS NULL) AND (AccountProjectId = dbo.vueTimesheetSummaryForApproval.AccountProjectId) AND 
                                                   (AccountEmployeeTimeEntryPeriodId = dbo.vueTimesheetSummaryForApproval.AccountEmployeeTimeEntryPeriodId)))
GROUP BY AccountEmployeeTimeEntryPeriodId, TimeEntryAccountEmployeeId, TimeEntryStartDate, TimeEntryEndDate, TimeEntryViewType, Submitted, Approved, Rejected, 
                      AccountApprovalPathId, SystemApproverTypeId, AccountExternalUserId, AccountEmployeeId, ApprovalPathSequence, LeaderEmployeeId, ProjectManagerEmployeeId, 
                      AccountApprovalTypeId, EmployeeName, EmployeeManagerId, AccountProjectId, IsApproved, EMailAddress, AccountEmployeeTimeEntryApprovalProjectId, 
                      IsEmailSend, SubmittedDate, IsDisabled, IsDeleted'
                      
GO
-- Add Column [CustomField1] to [dbo].[AccountExpenseEntry]
Print 'Add Column [CustomField1] to [dbo].[AccountExpenseEntry]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountExpenseEntry' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField1' AND TABLE_NAME='AccountExpenseEntry'))
ALTER TABLE [dbo].[AccountExpenseEntry]
	ADD [CustomField1] nvarchar(2000) NULL

GO
-- Add Column [CustomField2] to [dbo].[AccountExpenseEntry]
Print 'Add Column [CustomField2] to [dbo].[AccountExpenseEntry]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountExpenseEntry' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField2' AND TABLE_NAME='AccountExpenseEntry'))
ALTER TABLE [dbo].[AccountExpenseEntry]
	ADD [CustomField2] nvarchar(2000) NULL

GO
-- Add Column [CustomField3] to [dbo].[AccountExpenseEntry]
Print 'Add Column [CustomField3] to [dbo].[AccountExpenseEntry]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountExpenseEntry' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField3' AND TABLE_NAME='AccountExpenseEntry'))
ALTER TABLE [dbo].[AccountExpenseEntry]
	ADD [CustomField3] nvarchar(2000) NULL

GO
-- Add Column [CustomField4] to [dbo].[AccountExpenseEntry]
Print 'Add Column [CustomField4] to [dbo].[AccountExpenseEntry]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountExpenseEntry' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField4' AND TABLE_NAME='AccountExpenseEntry'))
ALTER TABLE [dbo].[AccountExpenseEntry]
	ADD [CustomField4] nvarchar(2000) NULL

GO
-- Add Column [CustomField5] to [dbo].[AccountExpenseEntry]
Print 'Add Column [CustomField5] to [dbo].[AccountExpenseEntry]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountExpenseEntry' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField5' AND TABLE_NAME='AccountExpenseEntry'))
ALTER TABLE [dbo].[AccountExpenseEntry]
	ADD [CustomField5] nvarchar(2000) NULL

GO
-- Add Column [CustomField6] to [dbo].[AccountExpenseEntry]
Print 'Add Column [CustomField6] to [dbo].[AccountExpenseEntry]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountExpenseEntry' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField6' AND TABLE_NAME='AccountExpenseEntry'))
ALTER TABLE [dbo].[AccountExpenseEntry]
	ADD [CustomField6] nvarchar(2000) NULL

GO
-- Add Column [CustomField7] to [dbo].[AccountExpenseEntry]
Print 'Add Column [CustomField7] to [dbo].[AccountExpenseEntry]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountExpenseEntry' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField7' AND TABLE_NAME='AccountExpenseEntry'))
ALTER TABLE [dbo].[AccountExpenseEntry]
	ADD [CustomField7] nvarchar(2000) NULL

GO
-- Add Column [CustomField8] to [dbo].[AccountExpenseEntry]
Print 'Add Column [CustomField8] to [dbo].[AccountExpenseEntry]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountExpenseEntry' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField8' AND TABLE_NAME='AccountExpenseEntry'))
ALTER TABLE [dbo].[AccountExpenseEntry]
	ADD [CustomField8] nvarchar(2000) NULL

GO
-- Add Column [CustomField9] to [dbo].[AccountExpenseEntry]
Print 'Add Column [CustomField9] to [dbo].[AccountExpenseEntry]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountExpenseEntry' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField9' AND TABLE_NAME='AccountExpenseEntry'))
ALTER TABLE [dbo].[AccountExpenseEntry]
	ADD [CustomField9] nvarchar(2000) NULL

GO
-- Add Column [CustomField10] to [dbo].[AccountExpenseEntry]
Print 'Add Column [CustomField10] to [dbo].[AccountExpenseEntry]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountExpenseEntry' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField10' AND TABLE_NAME='AccountExpenseEntry'))
ALTER TABLE [dbo].[AccountExpenseEntry]
	ADD [CustomField10] nvarchar(2000) NULL

GO
-- Add Column [CustomField11] to [dbo].[AccountExpenseEntry]
Print 'Add Column [CustomField11] to [dbo].[AccountExpenseEntry]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountExpenseEntry' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField11' AND TABLE_NAME='AccountExpenseEntry'))
ALTER TABLE [dbo].[AccountExpenseEntry]
	ADD [CustomField11] nvarchar(2000) NULL

GO
-- Add Column [CustomField12] to [dbo].[AccountExpenseEntry]
Print 'Add Column [CustomField12] to [dbo].[AccountExpenseEntry]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountExpenseEntry' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField12' AND TABLE_NAME='AccountExpenseEntry'))
ALTER TABLE [dbo].[AccountExpenseEntry]
	ADD [CustomField12] nvarchar(2000) NULL

GO
-- Add Column [CustomField13] to [dbo].[AccountExpenseEntry]
Print 'Add Column [CustomField13] to [dbo].[AccountExpenseEntry]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountExpenseEntry' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField13' AND TABLE_NAME='AccountExpenseEntry'))
ALTER TABLE [dbo].[AccountExpenseEntry]
	ADD [CustomField13] nvarchar(2000) NULL

GO
-- Add Column [CustomField14] to [dbo].[AccountExpenseEntry]
Print 'Add Column [CustomField14] to [dbo].[AccountExpenseEntry]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountExpenseEntry' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField14' AND TABLE_NAME='AccountExpenseEntry'))
ALTER TABLE [dbo].[AccountExpenseEntry]
		ADD [CustomField14] nvarchar(2000) NULL

GO
-- Add Column [CustomField15] to [dbo].[AccountExpenseEntry]
Print 'Add Column [CustomField15] to [dbo].[AccountExpenseEntry]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountExpenseEntry' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField15' AND TABLE_NAME='AccountExpenseEntry'))
ALTER TABLE [dbo].[AccountExpenseEntry]
	ADD [CustomField15] nvarchar(2000) NULL

GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[MasterEntityType]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[MasterEntityType]'
If Not Exists(Select * from [dbo].[MasterEntityType] Where [MasterEntityTypeId] = '756e4460-a713-4bee-b3f0-708fc5be21bd')
Begin
INSERT INTO [dbo].[MasterEntityType] ([MasterEntityTypeId], [MasterEntityTypeName]) VALUES ('756e4460-a713-4bee-b3f0-708fc5be21bd', N'Expense Sheet')
End	  

GO
-- Add Column ShowCompletedProjectInProjectGrid to AccountPreferences
Print 'Add Column ShowCompletedProjectInProjectGrid to AccountPreferences'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountPreferences' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='ShowCompletedProjectInProjectGrid' AND TABLE_NAME='AccountPreferences'))
ALTER TABLE [dbo].[AccountPreferences]
	ADD [ShowCompletedProjectInProjectGrid] bit NULL

GO
-- Add Column ShowEmployeeNameInInvoiceReport to AccountPreferences
Print 'Add Column ShowEmployeeNameInInvoiceReport to AccountPreferences'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountPreferences' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='ShowEmployeeNameInInvoiceReport' AND TABLE_NAME='AccountPreferences'))
ALTER TABLE [dbo].[AccountPreferences]
	ADD [ShowEmployeeNameInInvoiceReport] bit NULL
	
GO
-- Drop View [dbo].[vueAccountEmployee]
Print 'Drop View [dbo].[vueAccountEmployee]'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployee]

GO
-- Drop View vueAccount
Print 'Drop View vueAccount'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccount' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccount]

GO
-- Create View [dbo].[vueAccountEmployee]
Print 'Create View [dbo].[vueAccountEmployee]'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployee
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountEmployee.AccountId, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.Password, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountLocationId, dbo.AccountEmployee.BillingTypeId, 
                      dbo.AccountBillingType.BillingType, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, dbo.AccountPreferences.ShowClockStartEnd, dbo.Account.TimeZoneId, 
                      dbo.AccountRole.MasterAccountRoleId, dbo.Account.DefaultCurrencyId, dbo.Account.CountryId, dbo.AccountPreferences.CultureInfoName, 
                      dbo.AccountPreferences.TimeEntryFormat, dbo.AccountEmployee.AllowedAccessFromIP, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountPreferences.AccountSessionTimeout, dbo.AccountPreferences.ShowCompletedTasksInTimeSheet, dbo.AccountPreferences.CurrencySymbol, 
                      dbo.AccountPreferences.IsCompanyOwnLogo, dbo.Account.AccountExpiryActivation, dbo.Account.LicenseActivation, dbo.AccountEmployee.EmployeeTypeId, 
                      dbo.AccountEmployee.ExternalUserClientId, dbo.AccountEmployee.AccountBillingRateId, dbo.AccountPreferences.ScheduledEmailSendTime, 
                      dbo.AccountEmployee.Username, dbo.AccountEmployee.IsDisabled, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.AccountEmployee.EmployeeCode, dbo.AccountPreferences.Version, 
                      dbo.AccountPreferences.LockSubmittedRecords, dbo.AccountPreferences.LockApprovedRecords, ISNULL(dbo.AccountEmployee.EmployeeCode + '' - '', '''') 
                      + dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeNameWithCode, dbo.AccountPreferences.ShowWorkTypeInTimeSheet, 
                      dbo.AccountPreferences.NumberOfBlankRowsInTimeEntry, dbo.AccountPreferences.ShowCostCenterInTimeSheet, dbo.AccountPreferences.WeekStartDay, 
                      dbo.AccountPreferences.AccountBaseCurrencyId, dbo.AccountPreferences.UserInterfaceLanguage, dbo.AccountEmployee.EmployeeManagerId, 
                      dbo.AccountPreferences.DefaultTimeEntryMode, dbo.AccountPreferences.PageSize, dbo.AccountEmployee.TimeZoneId AS EmployeeTimeZoneId, 
                      dbo.AccountEmployee.TerminationDate, dbo.AccountEmployee.StatusId, dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.EmployeePayTypeId, 
                      dbo.AccountEmployee.HiredDate, dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountWorkingDayType, 
                      dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay AS EmployeeWeekStartDay, 
                      dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountPreferences.ShowDescriptionInWeekView, 
                      dbo.AccountPreferences.InvoiceNoPrefix, dbo.AccountPreferences.ShowAdditionalTaskInformationType, 
                      dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, 
                      ISNULL(dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, 1) AS InitialDayOfTheMonth, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, 1) 
                      AS SystemInitialDayOfFirstPeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod, 16) AS SystemInitialDayOfLastPeriod, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountPreferences.TimesheetPrintFooter, dbo.AccountPreferences.ExpenseSheetPrintFooter, 
                      dbo.AccountPreferences.ShowCompletedProjectsInTimeSheet, dbo.AccountPreferences.ShowProjectForTimeOff, dbo.AccountPreferences.ShowTimeOffInTimesheet, 
                      dbo.AccountEmployee.IsDeleted, dbo.AccountEmployee.IsForcePasswordChange, dbo.AccountEmployee.PasswordChangedDate, 
                      dbo.AccountPreferences.PasswordExpiryPeriod, dbo.AccountPreferences.ShowAllInTimesheetReadOnly, dbo.AccountPreferences.ShowTaskInExpenseSheet, 
                      dbo.AccountPreferences.InvoiceBillingTypeId, dbo.AccountPreferences.ShowBillingRateInInvoiceReport, dbo.SystemInvoiceBillingType.InvoiceBillingType, 
                      dbo.AccountPreferences.InvoiceFooter, dbo.AccountPreferences.TimesheetOverduePeriods, dbo.AccountWorkingDayType.TimesheetOverdueAfterDays, 
                      dbo.AccountEmployee.CreatedOn, dbo.AccountEmployee.CreatedByEmployeeId, dbo.AccountEmployee.ModifiedOn, dbo.AccountEmployee.ModifiedByEmployeeId, 
                      dbo.AccountPreferences.ShowProjectNameInInvoiceReport, dbo.AccountPreferences.ProjectCodePrefix, dbo.AccountPreferences.AutoGenerateProjectCode, 
                      dbo.AccountPreferences.TimeEntryHoursFormatId, dbo.AccountPreferences.ShowPercentageInTimesheet, dbo.AccountPreferences.EnablePasswordComplexity, 
                      dbo.AccountPreferences.ShowClientDepartmentInProject, dbo.AccountPreferences.ShowEntryDateInInvoiceReport, dbo.AccountPreferences.TimesheetSort, 
                      dbo.AccountPreferences.ShowCostCenterInTimesheetBy, dbo.AccountPreferences.ShowCopyTimesheetButton, 
                      dbo.AccountPreferences.ShowCopyActivitiesButtonInTimesheet, dbo.AccountPreferences.ShowProjectNameInTask, dbo.AccountPreferences.ShowClientNameInTask, 
                      dbo.AccountPreferences.IsShowElectronicSign, ISNULL(dbo.AccountWorkingDayType.MinimumPercentagePerDay, 0) AS MinimumPercentagePerDay, 
                      ISNULL(dbo.AccountWorkingDayType.MaximumPercentagePerDay, 100) AS MaximumPercentagePerDay, 
                      ISNULL(dbo.AccountWorkingDayType.MinimumPercentagePerWeek, 0) AS MinimumPercentagePerWeek, 
                      ISNULL(dbo.AccountWorkingDayType.MaximumPercentagePerWeek, 500) AS MaximumPercentagePerWeek, ShowCompletedProjectInProjectGrid, ShowEmployeeNameInInvoiceReport
FROM         dbo.SystemInvoiceBillingType RIGHT OUTER JOIN
                      dbo.AccountPreferences ON dbo.SystemInvoiceBillingType.InvoiceBillingTypeId = dbo.AccountPreferences.InvoiceBillingTypeId RIGHT OUTER JOIN
                      dbo.vueAccountTimesheetPeriodType RIGHT OUTER JOIN
                      dbo.AccountWorkingDayType ON 
                      dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId = dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId RIGHT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.Account ON dbo.AccountEmployee.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId ON 
                      dbo.AccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId ON 
                      dbo.AccountPreferences.AccountId = dbo.AccountEmployee.AccountId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId'


GO
-- Create View vueAccount
Print 'Create View vueAccount'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccount' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccount
AS
SELECT     dbo.Account.AccountId, dbo.Account.AccountTypeId, dbo.Account.AccountName, dbo.Account.Address1, dbo.Account.Address2, dbo.Account.ZipCode, dbo.Account.State, 
                      dbo.Account.City, dbo.Account.CountryId, dbo.Account.EMailAddress, dbo.Account.Telephone, dbo.Account.Fax, dbo.Account.DefaultCurrencyId, 
                      dbo.Account.TimeZoneId, dbo.Account.IsDisabled, dbo.Account.IsDeleted, dbo.Account.StatusId, dbo.Account.CreatedOn, dbo.Account.ModifiedOn, 
                      dbo.Account.ModifiedByEmployeeId, dbo.AccountPreferences.ShowClockStartEnd, dbo.AccountPreferences.AccountPreferencesId, dbo.Account.LicenseKey, 
                      dbo.Account.SystemPackageTypeId, dbo.AccountPreferences.TimeEntryFormat, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.Account.MachineId, dbo.Account.ActivationLicenseKey, dbo.Account.ActivationMachineKey, 
                      dbo.Account.ActivationType, dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountPreferences.InvoiceBillingTypeId, 
                      dbo.AccountPreferences.ShowBillingRateInInvoiceReport, dbo.AccountPreferences.InvoiceFooter, dbo.AccountPreferences.ShowProjectNameInInvoiceReport, 
                      dbo.AccountPreferences.ProjectCodePrefix, dbo.AccountPreferences.AutoGenerateProjectCode, dbo.AccountPreferences.TimeEntryHoursFormatId, 
                      dbo.AccountPreferences.ShowPercentageInTimesheet, dbo.AccountPreferences.EnablePasswordComplexity, dbo.AccountPreferences.ShowClientDepartmentInProject, 
                      dbo.AccountPreferences.ShowEntryDateInInvoiceReport, dbo.AccountPreferences.TimesheetSort, dbo.AccountPreferences.ShowCostCenterInTimesheetBy,
					  dbo.AccountPreferences.ShowCopyTimesheetButton, dbo.AccountPreferences.ShowCopyActivitiesButtonInTimesheet,
					  ShowProjectNameInTask, ShowClientNameInTask, IsShowElectronicSign, ShowCompletedProjectInProjectGrid, ShowEmployeeNameInInvoiceReport
FROM         dbo.Account INNER JOIN
                      dbo.AccountPreferences ON dbo.Account.AccountId = dbo.AccountPreferences.AccountId'

GO
-- Drop View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForEmployeeManager
Print 'Drop View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForEmployeeManager'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForEmployeeManager' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForEmployeeManager]
GO
-- Drop View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForProjectManager
Print 'Drop View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForProjectManager'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForProjectManager' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForProjectManager]
GO
-- Drop View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForTeamLead
Print 'Drop View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForTeamLead'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForTeamLead' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForTeamLead]
GO
-- Drop View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForAdministrator
Print 'Drop View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForAdministrator'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForAdministrator' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForAdministrator]

GO
-- Create View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForTeamLead
Print 'Create View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForTeamLead'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForTeamLead' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForTeamLead
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, MAX(dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName) AS EmployeeName, 
                      MAX(dbo.AccountEmployee.EMailAddress) AS EMailAddress, dbo.AccountEmployee.LastScheduledEmailSentTime, 
                      dbo.AccountPreferences.ScheduledEmailSendTime, dbo.AccountEmployee.AccountId, CASE WHEN MAX(dbo.AccountPreferences.CultureInfoName) 
                      IS NULL THEN ''en-us'' WHEN MAX(dbo.AccountPreferences.CultureInfoName) 
                      = ''auto'' THEN ''en-us'' ELSE MAX(dbo.AccountPreferences.CultureInfoName) END AS CultureInfoName, dbo.AccountEMailNotificationPreference.Monday, 
                      dbo.AccountEMailNotificationPreference.Tuesday, dbo.AccountEMailNotificationPreference.Wednesday, 
                      dbo.AccountEMailNotificationPreference.Thursday, dbo.AccountEMailNotificationPreference.Friday, dbo.AccountEMailNotificationPreference.Saturday, 
                      dbo.AccountEMailNotificationPreference.Sunday
FROM         dbo.AccountProject INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountProject.LeaderEmployeeId = dbo.AccountEmployee.AccountEmployeeId INNER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployee.AccountId = dbo.AccountPreferences.AccountId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference ON dbo.AccountEmployee.AccountId = dbo.AccountEMailNotificationPreference.AccountId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_1 ON 
                      dbo.AccountEmployee.AccountEmployeeId = AccountEMailNotificationPreference_1.AccountEmployeeId
WHERE     (dbo.AccountEmployee.EmployeeTypeId <> 2 OR
                      dbo.AccountEmployee.EmployeeTypeId IS NULL) AND (dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = 37) AND 
                      (dbo.AccountEMailNotificationPreference.Enabled = 1) AND (AccountEMailNotificationPreference_1.SystemEMailNotificationId = 38) AND 
                      (AccountEMailNotificationPreference_1.Enabled = 1) AND (dbo.AccountEmployee.IsDeleted <> 1) AND (dbo.AccountEmployee.IsDisabled <> 1)
GROUP BY dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountPreferences.ScheduledEmailSendTime, 
                      dbo.AccountEmployee.AccountId, dbo.AccountEMailNotificationPreference.Monday, dbo.AccountEMailNotificationPreference.Tuesday, 
                      dbo.AccountEMailNotificationPreference.Wednesday, dbo.AccountEMailNotificationPreference.Thursday, 
                      dbo.AccountEMailNotificationPreference.Friday, dbo.AccountEMailNotificationPreference.Saturday, dbo.AccountEMailNotificationPreference.Sunday'



GO
-- Create View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForProjectManager
Print 'Create View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForProjectManager'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForProjectManager' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForProjectManager
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, MAX(dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName) AS EmployeeName, 
                      MAX(dbo.AccountEmployee.EMailAddress) AS EMailAddress, dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountEmployee.AccountId, 
                      dbo.AccountPreferences.ScheduledEmailSendTime, CASE WHEN MAX(dbo.AccountPreferences.CultureInfoName) IS NULL 
                      THEN ''en-us'' WHEN MAX(dbo.AccountPreferences.CultureInfoName) = ''auto'' THEN ''en-us'' ELSE MAX(dbo.AccountPreferences.CultureInfoName) 
                      END AS CultureInfoName, AccountEMailNotificationPreference_1.Monday, AccountEMailNotificationPreference_1.Tuesday, 
                      AccountEMailNotificationPreference_1.Wednesday, AccountEMailNotificationPreference_1.Thursday, AccountEMailNotificationPreference_1.Friday, 
                      AccountEMailNotificationPreference_1.Saturday, AccountEMailNotificationPreference_1.Sunday
FROM         dbo.AccountProject INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountProject.ProjectManagerEmployeeId = dbo.AccountEmployee.AccountEmployeeId INNER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployee.AccountId = dbo.AccountPreferences.AccountId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference ON 
                      dbo.AccountEmployee.AccountEmployeeId = dbo.AccountEMailNotificationPreference.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_1 ON 
                      dbo.AccountEmployee.AccountId = AccountEMailNotificationPreference_1.AccountId
WHERE     (dbo.AccountEmployee.EmployeeTypeId <> 2 OR
                      dbo.AccountEmployee.EmployeeTypeId IS NULL) AND (dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = 36) AND 
                      (dbo.AccountEMailNotificationPreference.Enabled = 1) AND (AccountEMailNotificationPreference_1.SystemEMailNotificationId = 35) AND 
                      (AccountEMailNotificationPreference_1.Enabled = 1) AND (dbo.AccountEmployee.IsDeleted <> 1) AND (dbo.AccountEmployee.IsDisabled <> 1)
GROUP BY dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountEmployee.AccountId, 
                      dbo.AccountPreferences.ScheduledEmailSendTime, AccountEMailNotificationPreference_1.Monday, AccountEMailNotificationPreference_1.Tuesday, 
                      AccountEMailNotificationPreference_1.Wednesday, AccountEMailNotificationPreference_1.Thursday, AccountEMailNotificationPreference_1.Friday, 
                      AccountEMailNotificationPreference_1.Saturday, AccountEMailNotificationPreference_1.Sunday'


GO
-- Create View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForEmployeeManager
Print 'Create View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForEmployeeManager'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForEmployeeManager' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForEmployeeManager
AS
SELECT     dbo.AccountPreferences.ScheduledEmailSendTime, MAX(dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName) AS EmployeeName, 
                      AccountEmployee_1.AccountId, dbo.AccountEmployee.LastScheduledEmailSentTime, MAX(dbo.AccountEmployee.EMailAddress) AS EMailAddress, 
                      dbo.AccountEmployee.AccountEmployeeId, CASE WHEN MAX(dbo.AccountPreferences.CultureInfoName) IS NULL 
                      THEN ''en-us'' WHEN MAX(dbo.AccountPreferences.CultureInfoName) = ''auto'' THEN ''en-us'' ELSE MAX(dbo.AccountPreferences.CultureInfoName) 
                      END AS CultureInfoName, dbo.AccountEMailNotificationPreference.Monday, dbo.AccountEMailNotificationPreference.Tuesday, 
                      dbo.AccountEMailNotificationPreference.Wednesday, dbo.AccountEMailNotificationPreference.Thursday, 
                      dbo.AccountEMailNotificationPreference.Friday, dbo.AccountEMailNotificationPreference.Saturday, 
                      dbo.AccountEMailNotificationPreference.Sunday
FROM         dbo.AccountEmployee INNER JOIN
                      dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_2 INNER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON 
                      AccountEMailNotificationPreference_2.AccountEmployeeId = AccountEmployee_1.EmployeeManagerId ON 
                      dbo.AccountEmployee.AccountEmployeeId = AccountEmployee_1.EmployeeManagerId RIGHT OUTER JOIN
                      dbo.AccountEMailNotificationPreference ON AccountEmployee_1.AccountId = dbo.AccountEMailNotificationPreference.AccountId LEFT OUTER JOIN
                      dbo.AccountPreferences ON AccountEmployee_1.AccountId = dbo.AccountPreferences.AccountId
WHERE     (AccountEMailNotificationPreference_2.SystemEMailNotificationId = 32) AND (AccountEMailNotificationPreference_2.Enabled = 1) AND 
                      (dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = 31) AND (dbo.AccountEMailNotificationPreference.Enabled = 1) AND 
                      (AccountEmployee_1.EmployeeTypeId <> 2 OR
                      AccountEmployee_1.EmployeeTypeId IS NULL) AND (dbo.AccountEmployee.IsDeleted <> 1) AND (dbo.AccountEmployee.IsDisabled <> 1)
GROUP BY dbo.AccountPreferences.ScheduledEmailSendTime, AccountEmployee_1.AccountId, dbo.AccountEmployee.LastScheduledEmailSentTime, 
                      dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEMailNotificationPreference.Monday, dbo.AccountEMailNotificationPreference.Tuesday, 
                      dbo.AccountEMailNotificationPreference.Wednesday, dbo.AccountEMailNotificationPreference.Thursday, 
                      dbo.AccountEMailNotificationPreference.Friday, dbo.AccountEMailNotificationPreference.Saturday, dbo.AccountEMailNotificationPreference.Sunday'

GO
-- Create View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForAdministrator
Print 'Create View vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForAdministrator'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForAdministrator' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryPendingNotificationEmailWithPreferenceForAdministrator
AS
SELECT     dbo.AccountPreferences.ScheduledEmailSendTime, dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, 
                      dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.AccountId, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountRole.Role, dbo.AccountRole.MasterAccountRoleId, 
                      CASE WHEN dbo.AccountPreferences.CultureInfoName IS NULL 
                      THEN ''en-us'' WHEN dbo.AccountPreferences.CultureInfoName = ''auto'' THEN ''en-us'' ELSE CultureInfoName END AS CultureInfoName, 
                      dbo.AccountEMailNotificationPreference.Monday, dbo.AccountEMailNotificationPreference.Tuesday, 
                      dbo.AccountEMailNotificationPreference.Wednesday, dbo.AccountEMailNotificationPreference.Thursday, 
                      dbo.AccountEMailNotificationPreference.Friday, dbo.AccountEMailNotificationPreference.Saturday, 
                      dbo.AccountEMailNotificationPreference.Sunday
FROM         dbo.AccountEMailNotificationPreference AS AccountEMailNotificationPreference_2 RIGHT OUTER JOIN
                      dbo.AccountRole INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountRole.AccountRoleId = dbo.AccountEmployee.AccountRoleId ON 
                      AccountEMailNotificationPreference_2.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEMailNotificationPreference ON dbo.AccountEmployee.AccountId = dbo.AccountEMailNotificationPreference.AccountId LEFT OUTER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployee.AccountId = dbo.AccountPreferences.AccountId
WHERE     (AccountEMailNotificationPreference_2.SystemEMailNotificationId = 34) AND (AccountEMailNotificationPreference_2.Enabled = 1) AND 
                      (dbo.AccountEMailNotificationPreference.SystemEMailNotificationId = 33) AND (dbo.AccountEMailNotificationPreference.Enabled = 1) AND 
                      (dbo.AccountEmployee.EmployeeTypeId <> 2 OR
                      dbo.AccountEmployee.EmployeeTypeId IS NULL) AND (dbo.AccountRole.MasterAccountRoleId = 1) AND (dbo.AccountEmployee.IsDeleted <> 1) AND (dbo.AccountEmployee.IsDisabled <> 1)'

GO

-- Drop View [dbo].[vueAccountTimeExpenseBillingReport]
Print 'Drop View [dbo].[vueAccountTimeExpenseBillingReport]'
GO
DROP VIEW [dbo].[vueAccountTimeExpenseBillingReport]

GO
-- Create View [dbo].[vueAccountTimeExpenseBillingReport]
Print 'Create View [dbo].[vueAccountTimeExpenseBillingReport]'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountTimeExpenseBillingReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountTimeExpenseBillingReport
AS
SELECT     dbo.AccountTimeExpenseBilling.InvoiceNumber, dbo.AccountTimeExpenseBilling.InvoiceDate, ISNULL(dbo.AccountTimeExpenseBilling.PONumber, 0) AS PONumber, 
                      ISNULL(dbo.AccountTimeExpenseBilling.SubTotal, 0) AS SubTotal, ISNULL(dbo.AccountTimeExpenseBilling.TaxCode1, 0) AS TaxCode1, 
                      ISNULL(dbo.AccountTimeExpenseBilling.TaxCode2, 0) AS TaxCode2, ISNULL(dbo.AccountTimeExpenseBilling.GrandTotal, 0) AS GrandTotal, 
                      dbo.AccountTimeExpenseBilling.AccountId, dbo.AccountTimeExpenseBillingTimesheet.Description AS [Detail Description], 
                      ISNULL(dbo.AccountTimeExpenseBillingTimesheet.ActualBillingRate, 0) AS ActualBillingRate, ISNULL(dbo.AccountTimeExpenseBillingTimesheet.BillHours, 0) 
                      AS BillHours, ISNULL(dbo.AccountTimeExpenseBillingTimesheet.TotalAmount, 0) AS TotalAmount, dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId, 
                      dbo.AccountParty.PartyName, dbo.AccountTimeExpenseBilling.Description AS [Master Description], dbo.AccountParty.Address1, dbo.AccountParty.Address2, 
                      dbo.Account.AccountName, dbo.Account.Address1 AS AccountAddress1, dbo.Account.ZipCode, dbo.Account.State, dbo.Account.City, dbo.Account.Telephone, 
                      dbo.Account.Address2 AS AccountAddress2, dbo.AccountTimeExpenseBilling.AccountCurrencyId, dbo.SystemCurrency.CurrencyCode, 
                      dbo.AccountPreferences.InvoiceNoPrefix, dbo.AccountParty.State AS ClientState, dbo.AccountParty.City AS ClientCity, dbo.AccountParty.ZipCode AS ClientZipcode, 
                      dbo.AccountParty.Telephone1 AS ClientTelephone, dbo.AccountParty.Fax AS ClientFax, SystemCountry_1.Country AS AccountCountry, 
                      dbo.SystemCountry.Country AS ClientCountry, dbo.AccountTimeExpenseBilling.Terms, dbo.AccountTimeExpenseBilling.BankDetails, dbo.AccountProject.ProjectName, 
                      AccountProject_1.ProjectName AS MasterProjectName, dbo.AccountEmployeeTimeEntry.TimeEntryDate, dbo.AccountTimeExpenseBilling.BillingCycleStartDate, 
                      dbo.AccountTimeExpenseBilling.BillingCycleEndDate, dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeName, 
                      AccountProject_1.ProjectCode AS MasterProjectCode
FROM         dbo.AccountProject RIGHT OUTER JOIN
                      dbo.SystemCountry RIGHT OUTER JOIN
                      dbo.AccountParty ON dbo.SystemCountry.CountryId = dbo.AccountParty.CountryId RIGHT OUTER JOIN
                      dbo.Account ON dbo.AccountParty.AccountId = dbo.Account.AccountId LEFT OUTER JOIN
                      dbo.SystemCountry AS SystemCountry_1 ON dbo.Account.CountryId = SystemCountry_1.CountryId LEFT OUTER JOIN
                      dbo.AccountPreferences ON dbo.Account.AccountId = dbo.AccountPreferences.AccountId RIGHT OUTER JOIN
                      dbo.AccountProject AS AccountProject_1 RIGHT OUTER JOIN
                      dbo.AccountCurrency INNER JOIN
                      dbo.AccountTimeExpenseBilling ON dbo.AccountCurrency.AccountCurrencyId = dbo.AccountTimeExpenseBilling.AccountCurrencyId INNER JOIN
                      dbo.SystemCurrency ON dbo.AccountCurrency.SystemCurrencyId = dbo.SystemCurrency.CurrencyId ON 
                      AccountProject_1.AccountProjectId = dbo.AccountTimeExpenseBilling.AccountProjectId ON 
                      dbo.AccountParty.AccountPartyId = dbo.AccountTimeExpenseBilling.AccountClientId LEFT OUTER JOIN
                      dbo.AccountTimeExpenseBillingTimesheet ON 
                      dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId = dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingId ON 
                      dbo.AccountProject.AccountProjectId = dbo.AccountTimeExpenseBillingTimesheet.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntry ON 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountEmployeeTimeEntryId = dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId LEFT OUTER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployee.AccountEmployeeId = dbo.AccountEmployeeTimeEntry.AccountEmployeeId'

GO
-- Add Column UserInterfaceLanguage to AccountEmployee
Print 'Add Column UserInterfaceLanguage to AccountEmployee'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployee' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='UserInterfaceLanguage' AND TABLE_NAME='AccountEmployee'))
ALTER TABLE [dbo].[AccountEmployee]
	ADD [UserInterfaceLanguage] nvarchar(40) NULL

GO
-- Add Column CalculateTaskPercentageAutomatically to AccountPreferences
Print 'Add Column CalculateTaskPercentageAutomatically to AccountPreferences'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountPreferences' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CalculateTaskPercentageAutomatically' AND TABLE_NAME='AccountPreferences'))
ALTER TABLE [dbo].[AccountPreferences]
	ADD [CalculateTaskPercentageAutomatically] bit NULL
		
GO
-- Drop View vueAccount
Print 'Drop View vueAccount'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccount' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccount]

GO
-- Drop View [dbo].[vueAccountEmployee]
Print 'Drop View [dbo].[vueAccountEmployee]'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployee]


GO
-- Create View vueAccount
Print 'Create View vueAccount'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccount' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccount
AS
SELECT     dbo.Account.AccountId, dbo.Account.AccountTypeId, dbo.Account.AccountName, dbo.Account.Address1, dbo.Account.Address2, dbo.Account.ZipCode, dbo.Account.State, 
                      dbo.Account.City, dbo.Account.CountryId, dbo.Account.EMailAddress, dbo.Account.Telephone, dbo.Account.Fax, dbo.Account.DefaultCurrencyId, 
                      dbo.Account.TimeZoneId, dbo.Account.IsDisabled, dbo.Account.IsDeleted, dbo.Account.StatusId, dbo.Account.CreatedOn, dbo.Account.ModifiedOn, 
                      dbo.Account.ModifiedByEmployeeId, dbo.AccountPreferences.ShowClockStartEnd, dbo.AccountPreferences.AccountPreferencesId, dbo.Account.LicenseKey, 
                      dbo.Account.SystemPackageTypeId, dbo.AccountPreferences.TimeEntryFormat, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.Account.MachineId, dbo.Account.ActivationLicenseKey, dbo.Account.ActivationMachineKey, 
                      dbo.Account.ActivationType, dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountPreferences.InvoiceBillingTypeId, 
                      dbo.AccountPreferences.ShowBillingRateInInvoiceReport, dbo.AccountPreferences.InvoiceFooter, dbo.AccountPreferences.ShowProjectNameInInvoiceReport, 
                      dbo.AccountPreferences.ProjectCodePrefix, dbo.AccountPreferences.AutoGenerateProjectCode, dbo.AccountPreferences.TimeEntryHoursFormatId, 
                      dbo.AccountPreferences.ShowPercentageInTimesheet, dbo.AccountPreferences.EnablePasswordComplexity, dbo.AccountPreferences.ShowClientDepartmentInProject, 
                      dbo.AccountPreferences.ShowEntryDateInInvoiceReport, dbo.AccountPreferences.TimesheetSort, dbo.AccountPreferences.ShowCostCenterInTimesheetBy,
					  dbo.AccountPreferences.ShowCopyTimesheetButton, dbo.AccountPreferences.ShowCopyActivitiesButtonInTimesheet,
					  ShowProjectNameInTask, ShowClientNameInTask, IsShowElectronicSign, ShowCompletedProjectInProjectGrid, ShowEmployeeNameInInvoiceReport
					  , CalculateTaskPercentageAutomatically
FROM         dbo.Account INNER JOIN
                      dbo.AccountPreferences ON dbo.Account.AccountId = dbo.AccountPreferences.AccountId'
                    
GO
-- Create View [dbo].[vueAccountEmployee]
Print 'Create View [dbo].[vueAccountEmployee]'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployee
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountEmployee.AccountId, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.Password, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountLocationId, dbo.AccountEmployee.BillingTypeId, 
                      dbo.AccountBillingType.BillingType, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, dbo.AccountPreferences.ShowClockStartEnd, dbo.Account.TimeZoneId, 
                      dbo.AccountRole.MasterAccountRoleId, dbo.Account.DefaultCurrencyId, dbo.Account.CountryId, dbo.AccountPreferences.CultureInfoName, 
                      dbo.AccountPreferences.TimeEntryFormat, dbo.AccountEmployee.AllowedAccessFromIP, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountPreferences.AccountSessionTimeout, dbo.AccountPreferences.ShowCompletedTasksInTimeSheet, dbo.AccountPreferences.CurrencySymbol, 
                      dbo.AccountPreferences.IsCompanyOwnLogo, dbo.Account.AccountExpiryActivation, dbo.Account.LicenseActivation, dbo.AccountEmployee.EmployeeTypeId, 
                      dbo.AccountEmployee.ExternalUserClientId, dbo.AccountEmployee.AccountBillingRateId, dbo.AccountPreferences.ScheduledEmailSendTime, 
                      dbo.AccountEmployee.Username, dbo.AccountEmployee.IsDisabled, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.AccountEmployee.EmployeeCode, dbo.AccountPreferences.Version, 
                      dbo.AccountPreferences.LockSubmittedRecords, dbo.AccountPreferences.LockApprovedRecords, ISNULL(dbo.AccountEmployee.EmployeeCode + '' - '', '''') 
                      + dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeNameWithCode, dbo.AccountPreferences.ShowWorkTypeInTimeSheet, 
                      dbo.AccountPreferences.NumberOfBlankRowsInTimeEntry, dbo.AccountPreferences.ShowCostCenterInTimeSheet, dbo.AccountPreferences.WeekStartDay, 
                      dbo.AccountPreferences.AccountBaseCurrencyId, dbo.AccountEmployee.UserInterfaceLanguage, dbo.AccountEmployee.EmployeeManagerId, 
                      dbo.AccountPreferences.DefaultTimeEntryMode, dbo.AccountPreferences.PageSize, dbo.AccountEmployee.TimeZoneId AS EmployeeTimeZoneId, 
                      dbo.AccountEmployee.TerminationDate, dbo.AccountEmployee.StatusId, dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.EmployeePayTypeId, 
                      dbo.AccountEmployee.HiredDate, dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountWorkingDayType, 
                      dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay AS EmployeeWeekStartDay, 
                      dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountPreferences.ShowDescriptionInWeekView, 
                      dbo.AccountPreferences.InvoiceNoPrefix, dbo.AccountPreferences.ShowAdditionalTaskInformationType, 
                      dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, 
                      ISNULL(dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, 1) AS InitialDayOfTheMonth, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, 1) 
                      AS SystemInitialDayOfFirstPeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod, 16) AS SystemInitialDayOfLastPeriod, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountPreferences.TimesheetPrintFooter, dbo.AccountPreferences.ExpenseSheetPrintFooter, 
                      dbo.AccountPreferences.ShowCompletedProjectsInTimeSheet, dbo.AccountPreferences.ShowProjectForTimeOff, dbo.AccountPreferences.ShowTimeOffInTimesheet, 
                      dbo.AccountEmployee.IsDeleted, dbo.AccountEmployee.IsForcePasswordChange, dbo.AccountEmployee.PasswordChangedDate, 
                      dbo.AccountPreferences.PasswordExpiryPeriod, dbo.AccountPreferences.ShowAllInTimesheetReadOnly, dbo.AccountPreferences.ShowTaskInExpenseSheet, 
                      dbo.AccountPreferences.InvoiceBillingTypeId, dbo.AccountPreferences.ShowBillingRateInInvoiceReport, dbo.SystemInvoiceBillingType.InvoiceBillingType, 
                      dbo.AccountPreferences.InvoiceFooter, dbo.AccountPreferences.TimesheetOverduePeriods, dbo.AccountWorkingDayType.TimesheetOverdueAfterDays, 
                      dbo.AccountEmployee.CreatedOn, dbo.AccountEmployee.CreatedByEmployeeId, dbo.AccountEmployee.ModifiedOn, dbo.AccountEmployee.ModifiedByEmployeeId, 
                      dbo.AccountPreferences.ShowProjectNameInInvoiceReport, dbo.AccountPreferences.ProjectCodePrefix, dbo.AccountPreferences.AutoGenerateProjectCode, 
                      dbo.AccountPreferences.TimeEntryHoursFormatId, dbo.AccountPreferences.ShowPercentageInTimesheet, dbo.AccountPreferences.EnablePasswordComplexity, 
                      dbo.AccountPreferences.ShowClientDepartmentInProject, dbo.AccountPreferences.ShowEntryDateInInvoiceReport, dbo.AccountPreferences.TimesheetSort, 
                      dbo.AccountPreferences.ShowCostCenterInTimesheetBy, dbo.AccountPreferences.ShowCopyTimesheetButton, 
                      dbo.AccountPreferences.ShowCopyActivitiesButtonInTimesheet, dbo.AccountPreferences.ShowProjectNameInTask, dbo.AccountPreferences.ShowClientNameInTask, 
                      dbo.AccountPreferences.IsShowElectronicSign, ISNULL(dbo.AccountWorkingDayType.MinimumPercentagePerDay, 0) AS MinimumPercentagePerDay, 
                      ISNULL(dbo.AccountWorkingDayType.MaximumPercentagePerDay, 100) AS MaximumPercentagePerDay, 
                      ISNULL(dbo.AccountWorkingDayType.MinimumPercentagePerWeek, 0) AS MinimumPercentagePerWeek, 
                      ISNULL(dbo.AccountWorkingDayType.MaximumPercentagePerWeek, 500) AS MaximumPercentagePerWeek, ShowCompletedProjectInProjectGrid, 
                      ShowEmployeeNameInInvoiceReport, CalculateTaskPercentageAutomatically
FROM         dbo.SystemInvoiceBillingType RIGHT OUTER JOIN
                      dbo.AccountPreferences ON dbo.SystemInvoiceBillingType.InvoiceBillingTypeId = dbo.AccountPreferences.InvoiceBillingTypeId RIGHT OUTER JOIN
                      dbo.vueAccountTimesheetPeriodType RIGHT OUTER JOIN
                      dbo.AccountWorkingDayType ON 
                      dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId = dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId RIGHT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.Account ON dbo.AccountEmployee.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId ON 
                      dbo.AccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId ON 
                      dbo.AccountPreferences.AccountId = dbo.AccountEmployee.AccountId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId'

GO
If exists(Select * from SystemData Where version = '4.0.5')
--Update SystemSecurityCategoryPage Record
BEGIN
      
Update AccountEmployee  Set UserInterfaceLanguage = 
(Select a.UserInterfaceLanguage from AccountPreferences a
Where AccountEmployee.AccountId = a.AccountId)


Update AccountEmployee Set UserInterfaceLanguage = 'en-US'
Where UserInterfaceLanguage is Null


update AccountEmployeeTimeEntryPeriod set AccountEmployeeId  = AccountEmployeeTimeEntry.AccountEmployeeId from 
accountemployeeTimeEntry inner join AccountEmployeeTimeEntryPeriod on AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId = AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId 
where AccountEmployeeTimeEntryPeriod.AccountEmployeeId <> AccountEmployeeTimeEntry.AccountEmployeeId



Update AccountEmployeeTimeEntry Set AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId =
(Select top 1 AccountEmployeeTimeEntryApprovalProject.AccountEmployeeTimeEntryApprovalProjectId From AccountEmployeeTimeEntryApprovalProject
Where AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId = AccountEmployeeTimeEntryApprovalProject.AccountEmployeeTimeEntryPeriodId
And AccountEmployeeTimeEntry.AccountEmployeeId = AccountEmployeeTimeEntryApprovalProject.TimeEntryAccountEmployeeId
And AccountEmployeeTimeEntry.AccountProjectId = AccountEmployeeTimeEntryApprovalProject.AccountProjectId)



Delete From AccountEmployeeTimeEntryApprovalProject
Where AccountEmployeeTimeEntryApprovalProjectId Not In 
(Select AccountEmployeeTimeEntryApprovalProjectId From AccountEmployeeTimeEntry
Where AccountEmployeeTimeEntryApprovalProjectId Is Not NULL)



Delete From AccountEmployeeTimeEntryPeriod
Where AccountEmployeeTimeEntryPeriodId Not In (Select AccountEmployeeTimeEntryPeriodId From AccountEmployeeTimeEntry
Where AccountEmployeeTimeEntryPeriodId Is Not NULL) 
And AccountEmployeeTimeEntryPeriodId Not In (Select AccountEmployeeTimeEntryPeriodId
From AccountEmployeeTimeEntryApprovalProject)



Update AccountEmployeeTimeEntry Set AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId =
(Select Top 1 AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId From AccountEmployeeTimeEntryPeriod
Where AccountEmployeeTimeEntry.TimeEntryDate >= AccountEmployeeTimeEntryPeriod.TimeEntryStartDate 
And AccountEmployeeTimeEntry.TimeEntryDate <= AccountEmployeeTimeEntryPeriod.TimeEntryEndDate
And AccountEmployeeTimeEntry.AccountEmployeeId = AccountEmployeeTimeEntryPeriod.AccountEmployeeId)


Update AccountEmployeeTimeEntry Set AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId =
(Select top 1 AccountEmployeeTimeEntryApprovalProject.AccountEmployeeTimeEntryApprovalProjectId From AccountEmployeeTimeEntryApprovalProject
Where AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId = AccountEmployeeTimeEntryApprovalProject.AccountEmployeeTimeEntryPeriodId
And AccountEmployeeTimeEntry.AccountEmployeeId = AccountEmployeeTimeEntryApprovalProject.TimeEntryAccountEmployeeId
And AccountEmployeeTimeEntry.AccountProjectId = AccountEmployeeTimeEntryApprovalProject.AccountProjectId)



Update AccountEmployeeTimeEntryApproval Set AccountEmployeeTimeEntryApproval.AccountEmployeeTimeEntryPeriodId =
(Select Top 1 AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId From AccountEmployeeTimeEntry
Where AccountEmployeeTimeEntryApproval.AccountEmployeeTimeEntryId = AccountEmployeetimeentry.AccountEmployeeTimeEntryId
)



Delete From AccountEmployeeTimeEntryApprovalProject
Where AccountEmployeeTimeEntryApprovalProjectId Not In 
(Select AccountEmployeeTimeEntryApprovalProjectId From AccountEmployeeTimeEntry
Where AccountEmployeeTimeEntryApprovalProjectId Is Not NULL)



Delete From AccountEmployeeTimeEntryPeriod
Where AccountEmployeeTimeEntryPeriodId Not In (Select AccountEmployeeTimeEntryPeriodId From AccountEmployeeTimeEntry
Where AccountEmployeeTimeEntryPeriodId Is Not NULL) 
And AccountEmployeeTimeEntryPeriodId Not In (Select AccountEmployeeTimeEntryPeriodId
From AccountEmployeeTimeEntryApprovalProject)
END

GO
Update SystemData Set Version = '4.0.6' Where Version = '4.0.5' And SystemDataId = 1

GO
-- Add Column [LockAllPreviousTimesheets] to [dbo].[AccountWorkingDayType]
Print 'Add Column [LockAllPreviousTimesheets] to [dbo].[AccountWorkingDayType]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountWorkingDayType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='LockAllPreviousTimesheets' AND TABLE_NAME='AccountWorkingDayType'))
ALTER TABLE [dbo].[AccountWorkingDayType]
	ADD [LockAllPreviousTimesheets] [bit] NULL
	
GO
-- Add Column [LockAllFutureTimesheets] to [dbo].[AccountWorkingDayType]
Print 'Add Column [LockAllFutureTimesheets] to [dbo].[AccountWorkingDayType]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountWorkingDayType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='LockAllFutureTimesheets' AND TABLE_NAME='AccountWorkingDayType'))
ALTER TABLE [dbo].[AccountWorkingDayType]
	ADD [LockAllFutureTimesheets] [bit] NULL
	
GO
-- Add Column [LockPreviousTimesheetPeriods] to [dbo].[AccountWorkingDayType]
Print 'Add Column [LockPreviousTimesheetPeriods] to [dbo].[AccountWorkingDayType]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountWorkingDayType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='LockPreviousTimesheetPeriods' AND TABLE_NAME='AccountWorkingDayType'))
ALTER TABLE [dbo].[AccountWorkingDayType]
	ADD [LockPreviousTimesheetPeriods] [int] NULL
	
GO
-- Add Column [LockFutureTimsheetPeriods] to [dbo].[AccountWorkingDayType]
Print 'Add Column [LockFutureTimsheetPeriods] to [dbo].[AccountWorkingDayType]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountWorkingDayType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='LockFutureTimsheetPeriods' AND TABLE_NAME='AccountWorkingDayType'))
ALTER TABLE [dbo].[AccountWorkingDayType]
	ADD [LockFutureTimsheetPeriods] [int] NULL
	
GO
-- Add Column [LockPreviousNextMonthTimesheetOn] to [dbo].[AccountWorkingDayType]
Print 'Add Column [LockPreviousNextMonthTimesheetOn] to [dbo].[AccountWorkingDayType]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountWorkingDayType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='LockPreviousNextMonthTimesheetOn' AND TABLE_NAME='AccountWorkingDayType'))
ALTER TABLE [dbo].[AccountWorkingDayType]
	ADD [LockPreviousNextMonthTimesheetOn] [int] NULL

GO
-- Drop View [dbo].[vueAccountEmployee]
Print 'Drop View [dbo].[vueAccountEmployee]'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployee]

GO
-- Drop View [dbo].[vueAccountWorkingDayType]
Print 'Drop View [dbo].[vueAccountWorkingDayType]'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountWorkingDayType' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountWorkingDayType]

GO
-- Create View [dbo].[vueAccountEmployee]
Print 'Create View [dbo].[vueAccountEmployee]'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployee
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountEmployee.AccountId, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.Password, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountLocationId, dbo.AccountEmployee.BillingTypeId, 
                      dbo.AccountBillingType.BillingType, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, dbo.AccountPreferences.ShowClockStartEnd, dbo.Account.TimeZoneId, 
                      dbo.AccountRole.MasterAccountRoleId, dbo.Account.DefaultCurrencyId, dbo.Account.CountryId, dbo.AccountPreferences.CultureInfoName, 
                      dbo.AccountPreferences.TimeEntryFormat, dbo.AccountEmployee.AllowedAccessFromIP, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountPreferences.AccountSessionTimeout, dbo.AccountPreferences.ShowCompletedTasksInTimeSheet, dbo.AccountPreferences.CurrencySymbol, 
                      dbo.AccountPreferences.IsCompanyOwnLogo, dbo.Account.AccountExpiryActivation, dbo.Account.LicenseActivation, dbo.AccountEmployee.EmployeeTypeId, 
                      dbo.AccountEmployee.ExternalUserClientId, dbo.AccountEmployee.AccountBillingRateId, dbo.AccountPreferences.ScheduledEmailSendTime, 
                      dbo.AccountEmployee.Username, dbo.AccountEmployee.IsDisabled, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.AccountEmployee.EmployeeCode, dbo.AccountPreferences.Version, 
                      dbo.AccountPreferences.LockSubmittedRecords, dbo.AccountPreferences.LockApprovedRecords, ISNULL(dbo.AccountEmployee.EmployeeCode + '' - '', '''') 
                      + dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeNameWithCode, dbo.AccountPreferences.ShowWorkTypeInTimeSheet, 
                      dbo.AccountPreferences.NumberOfBlankRowsInTimeEntry, dbo.AccountPreferences.ShowCostCenterInTimeSheet, dbo.AccountPreferences.WeekStartDay, 
                      dbo.AccountPreferences.AccountBaseCurrencyId, dbo.AccountEmployee.UserInterfaceLanguage, dbo.AccountEmployee.EmployeeManagerId, 
                      dbo.AccountPreferences.DefaultTimeEntryMode, dbo.AccountPreferences.PageSize, dbo.AccountEmployee.TimeZoneId AS EmployeeTimeZoneId, 
                      dbo.AccountEmployee.TerminationDate, dbo.AccountEmployee.StatusId, dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.EmployeePayTypeId, 
                      dbo.AccountEmployee.HiredDate, dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountWorkingDayType, 
                      dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay AS EmployeeWeekStartDay, 
                      dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountPreferences.ShowDescriptionInWeekView, 
                      dbo.AccountPreferences.InvoiceNoPrefix, dbo.AccountPreferences.ShowAdditionalTaskInformationType, 
                      dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, 
                      ISNULL(dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, 1) AS InitialDayOfTheMonth, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, 1) 
                      AS SystemInitialDayOfFirstPeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod, 16) AS SystemInitialDayOfLastPeriod, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountPreferences.TimesheetPrintFooter, dbo.AccountPreferences.ExpenseSheetPrintFooter, 
                      dbo.AccountPreferences.ShowCompletedProjectsInTimeSheet, dbo.AccountPreferences.ShowProjectForTimeOff, dbo.AccountPreferences.ShowTimeOffInTimesheet, 
                      dbo.AccountEmployee.IsDeleted, dbo.AccountEmployee.IsForcePasswordChange, dbo.AccountEmployee.PasswordChangedDate, 
                      dbo.AccountPreferences.PasswordExpiryPeriod, dbo.AccountPreferences.ShowAllInTimesheetReadOnly, dbo.AccountPreferences.ShowTaskInExpenseSheet, 
                      dbo.AccountPreferences.InvoiceBillingTypeId, dbo.AccountPreferences.ShowBillingRateInInvoiceReport, dbo.SystemInvoiceBillingType.InvoiceBillingType, 
                      dbo.AccountPreferences.InvoiceFooter, dbo.AccountPreferences.TimesheetOverduePeriods, dbo.AccountWorkingDayType.TimesheetOverdueAfterDays, 
                      dbo.AccountEmployee.CreatedOn, dbo.AccountEmployee.CreatedByEmployeeId, dbo.AccountEmployee.ModifiedOn, dbo.AccountEmployee.ModifiedByEmployeeId, 
                      dbo.AccountPreferences.ShowProjectNameInInvoiceReport, dbo.AccountPreferences.ProjectCodePrefix, dbo.AccountPreferences.AutoGenerateProjectCode, 
                      dbo.AccountPreferences.TimeEntryHoursFormatId, dbo.AccountPreferences.ShowPercentageInTimesheet, dbo.AccountPreferences.EnablePasswordComplexity, 
                      dbo.AccountPreferences.ShowClientDepartmentInProject, dbo.AccountPreferences.ShowEntryDateInInvoiceReport, dbo.AccountPreferences.TimesheetSort, 
                      dbo.AccountPreferences.ShowCostCenterInTimesheetBy, dbo.AccountPreferences.ShowCopyTimesheetButton, 
                      dbo.AccountPreferences.ShowCopyActivitiesButtonInTimesheet, dbo.AccountPreferences.ShowProjectNameInTask, dbo.AccountPreferences.ShowClientNameInTask, 
                      dbo.AccountPreferences.IsShowElectronicSign, ISNULL(dbo.AccountWorkingDayType.MinimumPercentagePerDay, 0) AS MinimumPercentagePerDay, 
                      ISNULL(dbo.AccountWorkingDayType.MaximumPercentagePerDay, 100) AS MaximumPercentagePerDay, 
                      ISNULL(dbo.AccountWorkingDayType.MinimumPercentagePerWeek, 0) AS MinimumPercentagePerWeek, 
                      ISNULL(dbo.AccountWorkingDayType.MaximumPercentagePerWeek, 500) AS MaximumPercentagePerWeek, ShowCompletedProjectInProjectGrid, 
                      ShowEmployeeNameInInvoiceReport, CalculateTaskPercentageAutomatically, LockAllPreviousTimesheets, LockAllFutureTimesheets, 
                      LockPreviousTimesheetPeriods, LockFutureTimsheetPeriods, LockPreviousNextMonthTimesheetOn
FROM         dbo.SystemInvoiceBillingType RIGHT OUTER JOIN
                      dbo.AccountPreferences ON dbo.SystemInvoiceBillingType.InvoiceBillingTypeId = dbo.AccountPreferences.InvoiceBillingTypeId RIGHT OUTER JOIN
                      dbo.vueAccountTimesheetPeriodType RIGHT OUTER JOIN
                      dbo.AccountWorkingDayType ON 
                      dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId = dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId RIGHT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.Account ON dbo.AccountEmployee.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId ON 
                      dbo.AccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId ON 
                      dbo.AccountPreferences.AccountId = dbo.AccountEmployee.AccountId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId'

GO
-- Create View [dbo].[vueAccountWorkingDayType]
Print 'Create View [dbo].[vueAccountWorkingDayType]'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountWorkingDayType' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountWorkingDayType
AS
SELECT     dbo.AccountWorkingDayType.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountId, dbo.AccountWorkingDayType.AccountWorkingDayType, 
                      dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay, dbo.AccountWorkingDayType.CreatedByEmployeeId, 
                      dbo.AccountWorkingDayType.CreatedOn, dbo.AccountWorkingDayType.ModifiedByEmployeeId, dbo.AccountWorkingDayType.ModifiedOn, 
                      dbo.AccountWorkingDayType.IsDisabled, dbo.SystemWorkingDay.WorkingDay, dbo.AccountWorkingDayType.MasterWorkingDayTypeId, 
                      dbo.SystemWorkingDay.SQLServerWeekDayNo, dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, 
                      dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, 
                      dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod, dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId, 
                      dbo.AccountWorkingDayType.TimesheetOverdueAfterDays, ISNULL(dbo.AccountWorkingDayType.MinimumPercentagePerDay, 0) AS MinimumPercentagePerDay, 
                      ISNULL(dbo.AccountWorkingDayType.MaximumPercentagePerDay, 100) AS MaximumPercentagePerDay, 
                      ISNULL(dbo.AccountWorkingDayType.MinimumPercentagePerWeek, 0) AS MinimumPercentagePerWeek, 
                      ISNULL(dbo.AccountWorkingDayType.MaximumPercentagePerWeek, 500) AS MaximumPercentagePerWeek, LockAllPreviousTimesheets, 
                      LockAllFutureTimesheets, LockPreviousTimesheetPeriods, LockFutureTimsheetPeriods, LockPreviousNextMonthTimesheetOn
FROM         dbo.AccountWorkingDayType LEFT OUTER JOIN
                      dbo.vueAccountTimesheetPeriodType ON 
                      dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId = dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId LEFT OUTER JOIN
                      dbo.SystemWorkingDay ON dbo.AccountWorkingDayType.WeekStartDay = dbo.SystemWorkingDay.WorkingDayNo'


GO
-- Add Column [CustomField1] to [dbo].[AccountEmployeeExpenseSheet]
Print 'Add Column [CustomField1] to [dbo].[AccountEmployeeExpenseSheet]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeExpenseSheet' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField1' AND TABLE_NAME='AccountEmployeeExpenseSheet'))
ALTER TABLE [dbo].[AccountEmployeeExpenseSheet]
	ADD [CustomField1] nvarchar(2000) NULL

GO
-- Add Column [CustomField2] to [dbo].[AccountEmployeeExpenseSheet]
Print 'Add Column [CustomField2] to [dbo].[AccountEmployeeExpenseSheet]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeExpenseSheet' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField2' AND TABLE_NAME='AccountEmployeeExpenseSheet'))
ALTER TABLE [dbo].[AccountEmployeeExpenseSheet]
	ADD [CustomField2] nvarchar(2000) NULL

GO
-- Add Column [CustomField3] to [dbo].[AccountEmployeeExpenseSheet]
Print 'Add Column [CustomField3] to [dbo].[AccountEmployeeExpenseSheet]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeExpenseSheet' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField3' AND TABLE_NAME='AccountEmployeeExpenseSheet'))
ALTER TABLE [dbo].[AccountEmployeeExpenseSheet]
	ADD [CustomField3] nvarchar(2000) NULL

GO
-- Add Column [CustomField4] to [dbo].[AccountEmployeeExpenseSheet]
Print 'Add Column [CustomField4] to [dbo].[AccountEmployeeExpenseSheet]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeExpenseSheet' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField4' AND TABLE_NAME='AccountEmployeeExpenseSheet'))
ALTER TABLE [dbo].[AccountEmployeeExpenseSheet]
	ADD [CustomField4] nvarchar(2000) NULL

GO
-- Add Column [CustomField5] to [dbo].[AccountEmployeeExpenseSheet]
Print 'Add Column [CustomField5] to [dbo].[AccountEmployeeExpenseSheet]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeExpenseSheet' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField5' AND TABLE_NAME='AccountEmployeeExpenseSheet'))
ALTER TABLE [dbo].[AccountEmployeeExpenseSheet]
	ADD [CustomField5] nvarchar(2000) NULL

GO
-- Add Column [CustomField6] to [dbo].[AccountEmployeeExpenseSheet]
Print 'Add Column [CustomField6] to [dbo].[AccountEmployeeExpenseSheet]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeExpenseSheet' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField6' AND TABLE_NAME='AccountEmployeeExpenseSheet'))
ALTER TABLE [dbo].[AccountEmployeeExpenseSheet]
	ADD [CustomField6] nvarchar(2000) NULL

GO
-- Add Column [CustomField7] to [dbo].[AccountEmployeeExpenseSheet]
Print 'Add Column [CustomField7] to [dbo].[AccountEmployeeExpenseSheet]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeExpenseSheet' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField7' AND TABLE_NAME='AccountEmployeeExpenseSheet'))
ALTER TABLE [dbo].[AccountEmployeeExpenseSheet]
	ADD [CustomField7] nvarchar(2000) NULL

GO
-- Add Column [CustomField8] to [dbo].[AccountEmployeeExpenseSheet]
Print 'Add Column [CustomField8] to [dbo].[AccountEmployeeExpenseSheet]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeExpenseSheet' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField8' AND TABLE_NAME='AccountEmployeeExpenseSheet'))
ALTER TABLE [dbo].[AccountEmployeeExpenseSheet]
	ADD [CustomField8] nvarchar(2000) NULL

GO
-- Add Column [CustomField9] to [dbo].[AccountEmployeeExpenseSheet]
Print 'Add Column [CustomField9] to [dbo].[AccountEmployeeExpenseSheet]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeExpenseSheet' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField9' AND TABLE_NAME='AccountEmployeeExpenseSheet'))
ALTER TABLE [dbo].[AccountEmployeeExpenseSheet]
	ADD [CustomField9] nvarchar(2000) NULL

GO
-- Add Column [CustomField10] to [dbo].[AccountEmployeeExpenseSheet]
Print 'Add Column [CustomField10] to [dbo].[AccountEmployeeExpenseSheet]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeExpenseSheet' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField10' AND TABLE_NAME='AccountEmployeeExpenseSheet'))
ALTER TABLE [dbo].[AccountEmployeeExpenseSheet]
	ADD [CustomField10] nvarchar(2000) NULL

GO
-- Add Column [CustomField11] to [dbo].[AccountEmployeeExpenseSheet]
Print 'Add Column [CustomField11] to [dbo].[AccountEmployeeExpenseSheet]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeExpenseSheet' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField11' AND TABLE_NAME='AccountEmployeeExpenseSheet'))
ALTER TABLE [dbo].[AccountEmployeeExpenseSheet]
	ADD [CustomField11] nvarchar(2000) NULL

GO
-- Add Column [CustomField12] to [dbo].[AccountEmployeeExpenseSheet]
Print 'Add Column [CustomField12] to [dbo].[AccountEmployeeExpenseSheet]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeExpenseSheet' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField12' AND TABLE_NAME='AccountEmployeeExpenseSheet'))
ALTER TABLE [dbo].[AccountEmployeeExpenseSheet]
	ADD [CustomField12] nvarchar(2000) NULL

GO
-- Add Column [CustomField13] to [dbo].[AccountEmployeeExpenseSheet]
Print 'Add Column [CustomField13] to [dbo].[AccountEmployeeExpenseSheet]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeExpenseSheet' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField13' AND TABLE_NAME='AccountEmployeeExpenseSheet'))
ALTER TABLE [dbo].[AccountEmployeeExpenseSheet]
	ADD [CustomField13] nvarchar(2000) NULL

GO
-- Add Column [CustomField14] to [dbo].[AccountEmployeeExpenseSheet]
Print 'Add Column [CustomField14] to [dbo].[AccountEmployeeExpenseSheet]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeExpenseSheet' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField14' AND TABLE_NAME='AccountEmployeeExpenseSheet'))
ALTER TABLE [dbo].[AccountEmployeeExpenseSheet]
		ADD [CustomField14] nvarchar(2000) NULL

GO
-- Add Column [CustomField15] to [dbo].[AccountEmployeeExpenseSheet]
Print 'Add Column [CustomField15] to [dbo].[AccountEmployeeExpenseSheet]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountEmployeeExpenseSheet' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField15' AND TABLE_NAME='AccountEmployeeExpenseSheet'))
ALTER TABLE [dbo].[AccountEmployeeExpenseSheet]
	ADD [CustomField15] nvarchar(2000) NULL

GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[MasterEntityType]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[MasterEntityType]'
If Not Exists(Select * from [dbo].[MasterEntityType] Where [MasterEntityTypeId] = 'a55df02b-fbfb-4873-b582-6968fbaee589')
Begin
INSERT INTO [dbo].[MasterEntityType] ([MasterEntityTypeId], [MasterEntityTypeName]) VALUES ('a55df02b-fbfb-4873-b582-6968fbaee589', N'Expense Sheet')

Update MasterEntityType Set MasterEntityTypeName = 'Expense Entry' 
Where MasterEntityTypeId = '756e4460-a713-4bee-b3f0-708fc5be21bd'
END  

GO
-- Drop View vueAccountEmployeeExpenseSheet
Print 'Drop View vueAccountEmployeeExpenseSheet'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeExpenseSheet' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeExpenseSheet]

GO
-- Create View vueAccountEmployeeExpenseSheet
Print 'Create View vueAccountEmployeeExpenseSheet'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeExpenseSheet' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeExpenseSheet
AS
SELECT     dbo.AccountEmployeeExpenseSheet.AccountEmployeeExpenseSheetId, dbo.AccountEmployeeExpenseSheet.AccountId, 
                      dbo.AccountEmployeeExpenseSheet.AccountEmployeeId, dbo.AccountEmployeeExpenseSheet.Description, dbo.AccountEmployeeExpenseSheet.ExpenseSheetDate, 
                      MAX(dbo.vueAccountCurrency.Currency) AS Currency, MAX(dbo.vueAccountCurrency.CurrencyCode) AS CurrencyCode, 
                      MAX(dbo.vueAccountCurrency.AccountCurrencyId) AS AccountCurrencyId, CASE WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 0 AND dbo.AccountEmployeeExpenseSheet.Rejected = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.InApproval = 0 THEN ''Not Submitted'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Rejected = 0 THEN ''Approved'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.Rejected = 1 THEN ''Rejected'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 0 AND dbo.AccountEmployeeExpenseSheet.Rejected = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.InApproval = 1 THEN ''Submitted'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 0 AND dbo.AccountEmployeeExpenseSheet.Rejected = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.InApproval = 0 THEN ''Submitted'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 1 THEN ''Not Submitted'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.InApproval = 1 THEN ''Not Submitted'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 1 AND dbo.AccountEmployeeExpenseSheet.Rejected = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.InApproval = 1 THEN ''Approved'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Rejected = 1 THEN ''Submitted'' END AS Status, dbo.AccountEmployeeExpenseSheet.InApproval, 
                      dbo.AccountEmployeeExpenseSheet.Submitted, dbo.AccountEmployeeExpenseSheet.Rejected, dbo.AccountEmployeeExpenseSheet.Approved, 
                      dbo.AccountEmployeeExpenseSheet.SubmittedDate, 
                      CASE WHEN dbo.AccountEmployee.IsDisabled = 1 THEN dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE dbo.AccountEmployee.FirstName
                       + '' '' + dbo.AccountEmployee.LastName END AS EmployeeName, dbo.AccountEmployee.EMailAddress, MAX(dbo.vueAccountCurrency.ExchangeRate) 
                      AS ExchangeRate, dbo.AccountEmployeeExpenseSheet.ApprovedOn, dbo.AccountEmployeeExpenseSheet.ApprovedByEmployeeId, 
                      dbo.AccountEmployeeExpenseSheet.RejectedOn, dbo.AccountEmployeeExpenseSheet.RejectedByEmployeeId, 
                      SUM(ISNULL(dbo.vueAccountEmployeeExpenseSheetOnlyAmount.Amount * dbo.vueAccountCurrency.ExchangeRate, 0)) AS Amount
FROM         dbo.AccountExpenseEntry INNER JOIN
                      dbo.vueAccountEmployeeExpenseSheetOnlyAmount ON 
                      dbo.AccountExpenseEntry.AccountEmployeeExpenseSheetId = dbo.vueAccountEmployeeExpenseSheetOnlyAmount.AccountEmployeeExpenseSheetId AND 
                      dbo.AccountExpenseEntry.AccountExpenseEntryId = dbo.vueAccountEmployeeExpenseSheetOnlyAmount.AccountExpenseEntryId RIGHT OUTER JOIN
                      dbo.AccountEmployeeExpenseSheet INNER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployeeExpenseSheet.AccountId = dbo.AccountPreferences.AccountId INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeExpenseSheet.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId ON 
                      dbo.AccountExpenseEntry.AccountEmployeeExpenseSheetId = dbo.AccountEmployeeExpenseSheet.AccountEmployeeExpenseSheetId LEFT OUTER JOIN
                      dbo.vueAccountCurrency ON dbo.AccountPreferences.AccountBaseCurrencyId = dbo.vueAccountCurrency.AccountCurrencyId
GROUP BY dbo.AccountEmployeeExpenseSheet.AccountEmployeeExpenseSheetId, dbo.AccountEmployeeExpenseSheet.AccountId, 
                      dbo.AccountEmployeeExpenseSheet.AccountEmployeeId, dbo.AccountEmployeeExpenseSheet.Description, dbo.AccountEmployeeExpenseSheet.ExpenseSheetDate, 
                      dbo.AccountEmployeeExpenseSheet.InApproval, dbo.AccountEmployeeExpenseSheet.Submitted, dbo.AccountEmployeeExpenseSheet.Rejected, 
                      dbo.AccountEmployeeExpenseSheet.Approved, dbo.AccountEmployeeExpenseSheet.SubmittedDate, dbo.AccountEmployee.FirstName, 
                      dbo.AccountEmployee.LastName, dbo.AccountEmployee.EMailAddress, dbo.AccountEmployeeExpenseSheet.ApprovedOn, 
                      dbo.AccountEmployeeExpenseSheet.ApprovedByEmployeeId, dbo.AccountEmployeeExpenseSheet.RejectedOn, 
                      dbo.AccountEmployeeExpenseSheet.RejectedByEmployeeId, dbo.AccountEmployee.IsDisabled'

GO
-- Add Column Predecessors to AccountProjectTask
Print 'Add Column Predecessors to AccountProjectTask'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProjectTask' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='Predecessors' AND TABLE_NAME='AccountProjectTask'))
ALTER TABLE [dbo].[AccountProjectTask]
	ADD [Predecessors] nvarchar(50) NULL

GO
-- Add Column AllocationUnits to AccountProjectTaskEmployee
Print 'Add Column AllocationUnits to AccountProjectTaskEmployee'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProjectTaskEmployee' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='AllocationUnits' AND TABLE_NAME='AccountProjectTaskEmployee'))
ALTER TABLE [dbo].[AccountProjectTaskEmployee]
	ADD [AllocationUnits] decimal(18,2) NULL
	
GO
-- Drop View vueAccountProjectTask
Print 'Drop View vueAccountProjectTask'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountProjectTask' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountProjectTask]

GO
-- Drop View vueAccountEmployeeWorkingDays
Print 'Drop View vueAccountEmployeeWorkingDays'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeWorkingDays' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeWorkingDays]

GO
-- Create View vueAccountProjectTask
Print 'Create View vueAccountProjectTask'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountProjectTask' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountProjectTask
AS
SELECT     dbo.AccountProjectTask.AccountProjectTaskId, dbo.AccountProjectTask.AccountProjectId, dbo.AccountProjectTask.ParentAccountProjectTaskId, 
                      dbo.AccountProjectTask.TaskName, dbo.AccountProjectTask.TaskDescription, dbo.AccountProjectTask.AccountTaskTypeId, dbo.AccountProjectTask.Duration, 
                      dbo.AccountProjectTask.DurationUnit, dbo.AccountProjectTask.DeadlineDate, dbo.AccountProjectTask.CompletedPercent, dbo.AccountProjectTask.Completed, 
                      dbo.AccountProjectTask.IsParentTask, dbo.AccountProjectTask.IsForAllEmployees, dbo.AccountProjectTask.AccountPriorityId, dbo.AccountProjectTask.TaskStatusId, 
                      dbo.AccountProjectTask.CreatedOn, dbo.AccountProjectTask.CreatedByEmployeeId, dbo.AccountProjectTask.ModifiedOn, 
                      dbo.AccountProjectTask.ModifiedByEmployeeId, dbo.AccountStatus.Status AS TaskStatus, dbo.AccountEmployee.FirstName AS CreatedByFirstName, 
                      dbo.AccountEmployee.LastName AS CreatedByLastName, dbo.AccountPriority.Priority, dbo.AccountProject.ProjectName, dbo.AccountProject.ProjectCode, 
                      dbo.AccountTaskType.TaskType, dbo.AccountProject.AccountId, dbo.AccountProjectTask.AccountProjectMilestoneId, 
                      dbo.AccountProjectMilestone.MilestoneDescription, dbo.AccountProjectTask.IsReOpen, AccountEmployee_1.FirstName AS ModifiedByFirstName, 
                      AccountEmployee_1.LastName AS ModifiedByLastName, dbo.AccountProjectTask.EstimatedCost, dbo.AccountProjectTask.EstimatedTimeSpent, 
                      dbo.AccountProjectTask.EstimatedTimeSpentUnit, dbo.AccountEmployee.AccountEmployeeId, dbo.AccountProjectTask.IsDisabled, dbo.AccountProjectTask.TaskCode, 
                      dbo.AccountProject.IsTemplate, dbo.AccountProjectTask.IsForAllProjectTask, dbo.AccountProjectTask.IsBillable, dbo.AccountProjectTask.EstimatedCurrencyId, 
                      dbo.AccountParty.PartyName, dbo.AccountParty.PartyNick, dbo.AccountProject.AccountClientId, dbo.AccountProject.ProjectDescription, 
                      dbo.AccountProjectMilestone.MilestoneDate, dbo.AccountProject.IsDeleted AS IsProjectDeleted, dbo.AccountProjectTask.StartDate, 
                      dbo.AccountParty.IsDeleted AS IsDeletedClient, dbo.AccountProjectTask.Predecessors
FROM         dbo.AccountTaskType RIGHT OUTER JOIN
                      dbo.AccountProjectMilestone RIGHT OUTER JOIN
                      dbo.AccountProject INNER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId RIGHT OUTER JOIN
                      dbo.AccountProjectTask LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON dbo.AccountProjectTask.ModifiedByEmployeeId = AccountEmployee_1.AccountEmployeeId ON 
                      dbo.AccountProject.AccountProjectId = dbo.AccountProjectTask.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountEmployee ON dbo.AccountProjectTask.CreatedByEmployeeId = dbo.AccountEmployee.AccountEmployeeId ON 
                      dbo.AccountProjectMilestone.AccountProjectMilestoneId = dbo.AccountProjectTask.AccountProjectMilestoneId ON 
                      dbo.AccountTaskType.AccountTaskTypeId = dbo.AccountProjectTask.AccountTaskTypeId LEFT OUTER JOIN
                      dbo.AccountStatus ON dbo.AccountProjectTask.TaskStatusId = dbo.AccountStatus.AccountStatusId LEFT OUTER JOIN
                      dbo.AccountPriority ON dbo.AccountProjectTask.AccountPriorityId = dbo.AccountPriority.AccountPriorityId
WHERE     (dbo.AccountProject.IsDeleted <> 1) OR
                      (dbo.AccountProject.IsDeleted IS NULL)'

GO
-- Create View vueAccountEmployeeWorkingDays
Print 'Create View vueAccountEmployeeWorkingDays'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeWorkingDays' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeWorkingDays
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountWorkingDay.WorkingDayNo, dbo.SystemWorkingDay.WorkingDay, 
                      dbo.AccountWorkingDayType.HoursPerDay
FROM         dbo.AccountEmployee INNER JOIN
                      dbo.AccountWorkingDayType ON dbo.AccountEmployee.AccountWorkingDayTypeId = dbo.AccountWorkingDayType.AccountWorkingDayTypeId INNER JOIN
                      dbo.AccountWorkingDay ON dbo.AccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountWorkingDay.AccountWorkingDayTypeId INNER JOIN
                      dbo.SystemWorkingDay ON dbo.AccountWorkingDay.WorkingDayNo = dbo.SystemWorkingDay.WorkingDayNo'

GO
If Not Exists(Select * from [dbo].[SystemSecurityCategoryPage] where [SystemSecurityCategoryPageId] = 156)
BEGIN

-- Drop constraints from [dbo].[SystemSecurityCategoryPage]
ALTER TABLE [dbo].[SystemSecurityCategoryPage] DROP CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory]
ALTER TABLE [dbo].[SystemSecurityCategoryPage] DROP CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory1]

-- Add row to [dbo].[SystemSecurityCategoryPage]
INSERT INTO [dbo].[SystemSecurityCategoryPage] ([SystemSecurityCategoryPageId], [SystemSecurityCategoryId], [SequenceNumber], [Folder], [SystemCategoryPage], [SystemCategoryPageDescription], [ParentSystemSecurityCateogoryPageId], [IsSiteMapPage], [IsCustomizeable], [IsAllowAdd], [IsAllowEdit], [IsAllowDelete], [IsAllowList], [IsShowDataOptions], [IsShowTillOptions], [IsSystemPage], [ControlLevelPermission], [NotShowInPermission], [NotShowInStartupPage], [SystemFeatureId]) VALUES (156, 3, N'218544570', N'ProjectAdmin', 'AccountProjectTaskGantt.aspx', 'Interactive Gantt', 27, 1, 1, 1, 1, 1, 1, NULL, NULL, NULL, NULL, 1, NULL, NULL)

-- Add constraints to [dbo].[SystemSecurityCategoryPage]
ALTER TABLE [dbo].[SystemSecurityCategoryPage] WITH NOCHECK ADD CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory] FOREIGN KEY ([SystemSecurityCategoryId]) REFERENCES [dbo].[SystemSecurityCategory] ([SystemSecurityCategoryId])
ALTER TABLE [dbo].[SystemSecurityCategoryPage] WITH NOCHECK ADD CONSTRAINT [FK_SystemSecurityCategoryPage_SystemSecurityCategory1] FOREIGN KEY ([SystemSecurityCategoryId]) REFERENCES [dbo].[SystemSecurityCategory] ([SystemSecurityCategoryId])
END

GO
PRINT N'Creating [dbo].[AccountProjectAttachment]'
GO
IF NOT EXISTS (select * from information_schema.tables where table_name = 'AccountProjectAttachment' and table_type = 'BASE TABLE') 
CREATE TABLE [dbo].[AccountProjectAttachment]
(
[AccountProjectAttachmentId] [uniqueidentifier] NOT NULL CONSTRAINT [DF_AccountProjectAttachment_AccountProjectAttachmentId] DEFAULT (newid()),
[AccountProjectId] [int] NOT NULL,
[AttachmentName] [nvarchar] (1000) NOT NULL,
[AttachmentLocalPath] [nvarchar] (1000) NOT NULL,
[CreatedOn] [datetime] NOT NULL,
[CreatedByEmployeeId] [int] NOT NULL,
[ModifiedOn] [datetime] NOT NULL,
[ModifiedByEmployeeId] [int] NOT NULL
)

GO
-- Add Primary Key PK_AccountProjectAttachment to AccountCustomField
PRINT N'Creating primary key [PK_AccountProjectAttachment] on [dbo].[AccountProjectAttachment]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProjectAttachment' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS WHERE CONSTRAINT_NAME='PK_AccountProjectAttachment' AND TABLE_NAME='AccountProjectAttachment'))
ALTER TABLE [dbo].[AccountProjectAttachment]
	ADD
	CONSTRAINT [PK_AccountProjectAttachment]
	PRIMARY KEY
	([AccountProjectAttachmentId])
GO
-- Alter Column Duration on AccountProjectTask
Print 'Alter Column Duration on AccountProjectTask'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProjectTask' AND TABLE_TYPE='BASE TABLE')) AND (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='Duration' AND TABLE_NAME='AccountProjectTask'))
ALTER TABLE [dbo].[AccountProjectTask]
	 ALTER COLUMN [Duration] decimal(18, 2) NULL   	
	 

GO
-- Add Column [LockPreviousNextMonthTimesheetOn] to [dbo].[AccountWorkingDayType]
Print 'Add Column [LockPreviousNextMonthTimesheetOn] to [dbo].[AccountWorkingDayType]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountWorkingDayType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='EnableBalanceValidationForTimeOff' AND TABLE_NAME='AccountWorkingDayType'))
ALTER TABLE [dbo].[AccountWorkingDayType]
	ADD [EnableBalanceValidationForTimeOff] [bit] NULL
	
GO
-- Drop View vueAccountEmployeeProject
Print 'Drop View vueAccountEmployeeProject'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeProject' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeProject]

GO
-- Create View vueAccountEmployeeProject
Print 'Create View vueAccountEmployeeProject'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeProject' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeProject
AS
SELECT     dbo.AccountProject.AccountProjectId, dbo.AccountProject.AccountId, dbo.AccountProject.ProjectName, dbo.AccountProjectEmployee.AccountProjectEmployeeId, 
                      dbo.AccountEmployee.AccountEmployeeId, dbo.AccountProject.IsDisabled, dbo.AccountProject.IsDeleted, dbo.AccountParty.IsDeleted AS IsDeletedClient, 
                      dbo.AccountPartyDepartment.PartyDepartmentName AS ClientDepartment
FROM         dbo.AccountPartyDepartment LEFT OUTER JOIN
                      dbo.AccountParty ON dbo.AccountPartyDepartment.AccountPartyId = dbo.AccountParty.AccountPartyId RIGHT OUTER JOIN
                      dbo.AccountProject INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountProject.AccountId = dbo.AccountEmployee.AccountId ON 
                      dbo.AccountParty.AccountPartyId = dbo.AccountProject.AccountClientId LEFT OUTER JOIN
                      dbo.AccountProjectEmployee ON dbo.AccountProject.AccountProjectId = dbo.AccountProjectEmployee.AccountProjectId AND 
                      dbo.AccountProject.AccountId = dbo.AccountProjectEmployee.AccountId AND 
                      dbo.AccountEmployee.AccountEmployeeId = dbo.AccountProjectEmployee.AccountEmployeeId'
                      
GO
-- Drop View [dbo].[vueAccountWorkingDayType]
Print 'Drop View [dbo].[vueAccountWorkingDayType]'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountWorkingDayType' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountWorkingDayType]
                      
GO
-- Create View [dbo].[vueAccountWorkingDayType]
Print 'Create View [dbo].[vueAccountWorkingDayType]'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountWorkingDayType' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountWorkingDayType
AS
SELECT     dbo.AccountWorkingDayType.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountId, dbo.AccountWorkingDayType.AccountWorkingDayType, 
                      dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay, dbo.AccountWorkingDayType.CreatedByEmployeeId, 
                      dbo.AccountWorkingDayType.CreatedOn, dbo.AccountWorkingDayType.ModifiedByEmployeeId, dbo.AccountWorkingDayType.ModifiedOn, 
                      dbo.AccountWorkingDayType.IsDisabled, dbo.SystemWorkingDay.WorkingDay, dbo.AccountWorkingDayType.MasterWorkingDayTypeId, 
                      dbo.SystemWorkingDay.SQLServerWeekDayNo, dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, 
                      dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, 
                      dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod, dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId, 
                      dbo.AccountWorkingDayType.TimesheetOverdueAfterDays, ISNULL(dbo.AccountWorkingDayType.MinimumPercentagePerDay, 0) AS MinimumPercentagePerDay, 
                      ISNULL(dbo.AccountWorkingDayType.MaximumPercentagePerDay, 100) AS MaximumPercentagePerDay, 
                      ISNULL(dbo.AccountWorkingDayType.MinimumPercentagePerWeek, 0) AS MinimumPercentagePerWeek, 
                      ISNULL(dbo.AccountWorkingDayType.MaximumPercentagePerWeek, 500) AS MaximumPercentagePerWeek, 
                      dbo.AccountWorkingDayType.LockAllPreviousTimesheets, dbo.AccountWorkingDayType.LockAllFutureTimesheets, 
                      dbo.AccountWorkingDayType.LockPreviousTimesheetPeriods, dbo.AccountWorkingDayType.LockFutureTimsheetPeriods, 
                      dbo.AccountWorkingDayType.LockPreviousNextMonthTimesheetOn, dbo.AccountWorkingDayType.EnableBalanceValidationForTimeOff
FROM         dbo.AccountWorkingDayType LEFT OUTER JOIN
                      dbo.vueAccountTimesheetPeriodType ON 
                      dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId = dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId LEFT OUTER JOIN
                      dbo.SystemWorkingDay ON dbo.AccountWorkingDayType.WeekStartDay = dbo.SystemWorkingDay.WorkingDayNo'


GO
-- Drop View [dbo].[vueAccountEmployee]
Print 'Drop View [dbo].[vueAccountEmployee]'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployee]


GO
-- Create View [dbo].[vueAccountEmployee]
Print 'Create View [dbo].[vueAccountEmployee]'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployee
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountEmployee.AccountId, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.Password, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountLocationId, dbo.AccountEmployee.BillingTypeId, 
                      dbo.AccountBillingType.BillingType, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, dbo.AccountPreferences.ShowClockStartEnd, dbo.Account.TimeZoneId, 
                      dbo.AccountRole.MasterAccountRoleId, dbo.Account.DefaultCurrencyId, dbo.Account.CountryId, dbo.AccountPreferences.CultureInfoName, 
                      dbo.AccountPreferences.TimeEntryFormat, dbo.AccountEmployee.AllowedAccessFromIP, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountPreferences.AccountSessionTimeout, dbo.AccountPreferences.ShowCompletedTasksInTimeSheet, dbo.AccountPreferences.CurrencySymbol, 
                      dbo.AccountPreferences.IsCompanyOwnLogo, dbo.Account.AccountExpiryActivation, dbo.Account.LicenseActivation, dbo.AccountEmployee.EmployeeTypeId, 
                      dbo.AccountEmployee.ExternalUserClientId, dbo.AccountEmployee.AccountBillingRateId, dbo.AccountPreferences.ScheduledEmailSendTime, 
                      dbo.AccountEmployee.Username, dbo.AccountEmployee.IsDisabled, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.AccountEmployee.EmployeeCode, dbo.AccountPreferences.Version, 
                      dbo.AccountPreferences.LockSubmittedRecords, dbo.AccountPreferences.LockApprovedRecords, ISNULL(dbo.AccountEmployee.EmployeeCode + '' - '', '''') 
                      + dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeNameWithCode, dbo.AccountPreferences.ShowWorkTypeInTimeSheet, 
                      dbo.AccountPreferences.NumberOfBlankRowsInTimeEntry, dbo.AccountPreferences.ShowCostCenterInTimeSheet, dbo.AccountPreferences.WeekStartDay, 
                      dbo.AccountPreferences.AccountBaseCurrencyId, dbo.AccountEmployee.UserInterfaceLanguage, dbo.AccountEmployee.EmployeeManagerId, 
                      dbo.AccountPreferences.DefaultTimeEntryMode, dbo.AccountPreferences.PageSize, dbo.AccountEmployee.TimeZoneId AS EmployeeTimeZoneId, 
                      dbo.AccountEmployee.TerminationDate, dbo.AccountEmployee.StatusId, dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.EmployeePayTypeId, 
                      dbo.AccountEmployee.HiredDate, dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountWorkingDayType, 
                      dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay AS EmployeeWeekStartDay, 
                      dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountPreferences.ShowDescriptionInWeekView, 
                      dbo.AccountPreferences.InvoiceNoPrefix, dbo.AccountPreferences.ShowAdditionalTaskInformationType, 
                      dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, 
                      ISNULL(dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, 1) AS InitialDayOfTheMonth, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, 1) 
                      AS SystemInitialDayOfFirstPeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod, 16) AS SystemInitialDayOfLastPeriod, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountPreferences.TimesheetPrintFooter, dbo.AccountPreferences.ExpenseSheetPrintFooter, 
                      dbo.AccountPreferences.ShowCompletedProjectsInTimeSheet, dbo.AccountPreferences.ShowProjectForTimeOff, dbo.AccountPreferences.ShowTimeOffInTimesheet, 
                      dbo.AccountEmployee.IsDeleted, dbo.AccountEmployee.IsForcePasswordChange, dbo.AccountEmployee.PasswordChangedDate, 
                      dbo.AccountPreferences.PasswordExpiryPeriod, dbo.AccountPreferences.ShowAllInTimesheetReadOnly, dbo.AccountPreferences.ShowTaskInExpenseSheet, 
                      dbo.AccountPreferences.InvoiceBillingTypeId, dbo.AccountPreferences.ShowBillingRateInInvoiceReport, dbo.SystemInvoiceBillingType.InvoiceBillingType, 
                      dbo.AccountPreferences.InvoiceFooter, dbo.AccountPreferences.TimesheetOverduePeriods, dbo.AccountWorkingDayType.TimesheetOverdueAfterDays, 
                      dbo.AccountEmployee.CreatedOn, dbo.AccountEmployee.CreatedByEmployeeId, dbo.AccountEmployee.ModifiedOn, dbo.AccountEmployee.ModifiedByEmployeeId, 
                      dbo.AccountPreferences.ShowProjectNameInInvoiceReport, dbo.AccountPreferences.ProjectCodePrefix, dbo.AccountPreferences.AutoGenerateProjectCode, 
                      dbo.AccountPreferences.TimeEntryHoursFormatId, dbo.AccountPreferences.ShowPercentageInTimesheet, dbo.AccountPreferences.EnablePasswordComplexity, 
                      dbo.AccountPreferences.ShowClientDepartmentInProject, dbo.AccountPreferences.ShowEntryDateInInvoiceReport, dbo.AccountPreferences.TimesheetSort, 
                      dbo.AccountPreferences.ShowCostCenterInTimesheetBy, dbo.AccountPreferences.ShowCopyTimesheetButton, 
                      dbo.AccountPreferences.ShowCopyActivitiesButtonInTimesheet, dbo.AccountPreferences.ShowProjectNameInTask, dbo.AccountPreferences.ShowClientNameInTask, 
                      dbo.AccountPreferences.IsShowElectronicSign, ISNULL(dbo.AccountWorkingDayType.MinimumPercentagePerDay, 0) AS MinimumPercentagePerDay, 
                      ISNULL(dbo.AccountWorkingDayType.MaximumPercentagePerDay, 100) AS MaximumPercentagePerDay, 
                      ISNULL(dbo.AccountWorkingDayType.MinimumPercentagePerWeek, 0) AS MinimumPercentagePerWeek, 
                      ISNULL(dbo.AccountWorkingDayType.MaximumPercentagePerWeek, 500) AS MaximumPercentagePerWeek, 
                      dbo.AccountPreferences.ShowCompletedProjectInProjectGrid, dbo.AccountPreferences.ShowEmployeeNameInInvoiceReport, 
                      dbo.AccountPreferences.CalculateTaskPercentageAutomatically, dbo.AccountWorkingDayType.LockAllPreviousTimesheets, 
                      dbo.AccountWorkingDayType.LockAllFutureTimesheets, dbo.AccountWorkingDayType.LockPreviousTimesheetPeriods, 
                      dbo.AccountWorkingDayType.LockFutureTimsheetPeriods, dbo.AccountWorkingDayType.LockPreviousNextMonthTimesheetOn, 
                      dbo.AccountWorkingDayType.EnableBalanceValidationForTimeOff
FROM         dbo.SystemInvoiceBillingType RIGHT OUTER JOIN
                      dbo.AccountPreferences ON dbo.SystemInvoiceBillingType.InvoiceBillingTypeId = dbo.AccountPreferences.InvoiceBillingTypeId RIGHT OUTER JOIN
                      dbo.vueAccountTimesheetPeriodType RIGHT OUTER JOIN
                      dbo.AccountWorkingDayType ON 
                      dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId = dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId RIGHT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.Account ON dbo.AccountEmployee.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId ON 
                      dbo.AccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId ON 
                      dbo.AccountPreferences.AccountId = dbo.AccountEmployee.AccountId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId'

GO
-- Drop View vueAccountEmployeeProject
Print 'Drop View vueAccountEmployeeProject'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeProject' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeProject]

GO
-- Create View vueAccountEmployeeProject
Print 'Create View vueAccountEmployeeProject'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeProject' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeProject
AS
SELECT     dbo.AccountProject.AccountProjectId, dbo.AccountProject.AccountId, dbo.AccountProject.ProjectName, dbo.AccountProjectEmployee.AccountProjectEmployeeId, 
                      dbo.AccountEmployee.AccountEmployeeId, dbo.AccountProject.IsDisabled, dbo.AccountProject.IsDeleted, dbo.AccountParty.IsDeleted AS IsDeletedClient, 
                      dbo.AccountPartyDepartment.PartyDepartmentName AS ClientDepartment, dbo.AccountParty.PartyName AS ClientName
FROM         dbo.AccountProjectEmployee RIGHT OUTER JOIN
                      dbo.AccountParty INNER JOIN
                      dbo.AccountProject INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountProject.AccountId = dbo.AccountEmployee.AccountId ON 
                      dbo.AccountParty.AccountPartyId = dbo.AccountProject.AccountClientId LEFT OUTER JOIN
                      dbo.AccountPartyDepartment ON dbo.AccountProject.AccountPartyDepartmentId = dbo.AccountPartyDepartment.AccountPartyDepartmentId ON 
                      dbo.AccountProjectEmployee.AccountProjectId = dbo.AccountProject.AccountProjectId AND dbo.AccountProjectEmployee.AccountId = dbo.AccountProject.AccountId AND 
                      dbo.AccountProjectEmployee.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId'

GO
-- Drop View vueAccountEmployeeTimeEntryWithTimeOffForReport
Print 'Drop View vueAccountEmployeeTimeEntryWithTimeOffForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithTimeOffForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryWithTimeOffForReport]

GO
-- Drop View vueAccountEmployeeTimeEntryForReport
Print 'Drop View vueAccountEmployeeTimeEntryForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryForReport]

GO
-- Create View vueAccountEmployeeTimeEntryWithTimeOffForReport
Print 'Create View vueAccountEmployeeTimeEntryWithTimeOffForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithTimeOffForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport
AS
SELECT     CASE WHEN dbo.AccountEmployee.IsDisabled = 1 THEN dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE dbo.AccountEmployee.FirstName
                       + '' '' + dbo.AccountEmployee.LastName END AS EmployeeName, dbo.AccountProject.ProjectName, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 1 THEN AccountProjectTask_1.TaskName ELSE dbo.AccountTimeOffType.AccountTimeOffType END AS TaskName,
                       dbo.AccountEmployeeTimeEntry.TotalTime, dbo.AccountEmployeeTimeEntry.Approved, dbo.AccountEmployee.AccountEmployeeId, 
                      dbo.AccountProject.AccountProjectId, dbo.AccountEmployeeTimeEntry.TeamLeadApproved, dbo.AccountEmployeeTimeEntry.ProjectManagerApproved, 
                      dbo.AccountEmployeeTimeEntry.AdministratorApproved, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, dbo.AccountEmployeeTimeEntry.StartTime, 
                      dbo.AccountEmployeeTimeEntry.EndTime, dbo.AccountEmployeeTimeEntry.TimeEntryDate, dbo.AccountEmployeeTimeEntry.Description, 
                      ISNULL(dbo.AccountProject.AccountId, dbo.AccountTimeOffType.AccountId) AS AccountId, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime) AS TotalMinutes, DATEPART(dw, dbo.AccountEmployeeTimeEntry.TimeEntryDate) AS WeekDay, 
                      dbo.AccountParty.AccountPartyId, dbo.AccountParty.PartyName, AccountProjectTask_1.AccountProjectTaskId, dbo.AccountBillingType.BillingType, 
                      dbo.AccountProject.LeaderEmployeeId, dbo.AccountProject.ProjectManagerEmployeeId, dbo.AccountProject.TimeSheetApprovalTypeId, 
                      dbo.AccountProject.ExpenseApprovalTypeId, AccountProjectTask_1.IsBillable, dbo.AccountEmployeeTimeEntry.Rejected, dbo.AccountEmployeeTimeEntry.BillingRate, 
                      dbo.AccountProject.ProjectBillingRateTypeId, dbo.AccountEmployee.EmployeeCode, dbo.AccountEmployee.AccountDepartmentId, 
                      dbo.AccountDepartment.DepartmentName, AccountProjectTask_1.EstimatedCost, AccountProjectTask_1.EstimatedTimeSpent, 
                      dbo.AccountEmployeeTimeEntry.Submitted, dbo.AccountWorkType.AccountWorkType, dbo.AccountEmployee.EMailAddress, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountCostCenter.AccountCostCenter, dbo.AccountCostCenter.AccountCostCenterCode, dbo.AccountWorkType.AccountWorkTypeCode, 
                      dbo.AccountProject.ProjectCode, AccountProjectTask_1.TaskCode, dbo.AccountLocation.AccountLocationId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction.Comments, dbo.AccountEmployeeTimeEntry.BillingRateCurrencyId, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateCurrencyId, dbo.AccountEmployeeTimeEntry.BillingRateExchangeRate, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateExchangeRate, dbo.AccountEmployeeTimeEntry.AccountBaseCurrencyId, AccountProjectTask_1.AccountTaskTypeId, 
                      AccountProjectTask_1.TaskStatusId, AccountProjectTask_1.AccountPriorityId, AccountProjectTask_1.AccountProjectMilestoneId, 
                      dbo.AccountDepartment.DepartmentCode, dbo.AccountParty.PartyNick, AccountProjectTask_1.EstimatedCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction.ApprovedOn, dbo.AccountEmployeeTimeEntry.EmployeeRate, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountRole.Role, dbo.AccountProject.AccountProjectTypeId, dbo.AccountProject.ProjectDescription, AccountProjectTask_1.TaskDescription, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeExpenseBillingTimesheetId, dbo.AccountEmployeeTimeEntry.Billed, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Submitted = 1 THEN (CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, 
                      dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS SubmittedHours, CASE WHEN dbo.AccountEmployeeTimeEntry.Approved = 1 THEN (CONVERT(float, 
                      DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS ApprovedHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Rejected = 1 THEN (CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, 
                      dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS RejectedHours, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, 
                      dbo.AccountPartyContact.FirstName + N'' '' + dbo.AccountPartyContact.LastName AS ClientContactName, 
                      dbo.AccountPartyDepartment.PartyDepartmentCode AS ClientDepartmentCode, dbo.AccountPartyDepartment.PartyDepartmentName AS ClientDepartmentName, 
                      dbo.AccountPartyDepartment.PartyDepartmentLocation AS ClientDepartmentLocation, dbo.AccountEmployeeTimeEntry.IsTimeOff, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId, CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 0 THEN (CONVERT(float, DATEPART(hh, 
                      dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS TimeOffHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 1 THEN (CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, 
                      dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS TimesheetHours, dbo.AccountWorkType.AccountWorkTypeId, dbo.AccountStatus.Status AS ProjectStatus, 
                      AccountProjectTask_1.ParentAccountProjectTaskId, dbo.AccountProjectTask.TaskName AS ParentTaskName, dbo.AccountEmployee.IsDisabled, 
                      dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, ISNULL(dbo.AccountEmployeeType.AccountEmployeeType, N'''') AS EmployeeType, 
                      ISNULL(dbo.AccountHolidayTypeDetail.HolidayName, N'''') AS HolidayName, dbo.AccountEmployeeTimeEntry.Percentage, 
                      dbo.AccountEmployeeTimeEntry.CustomField1, dbo.AccountEmployeeTimeEntry.CustomField2, dbo.AccountEmployeeTimeEntry.CustomField3, 
                      dbo.AccountEmployeeTimeEntry.CustomField4, dbo.AccountEmployeeTimeEntry.CustomField5, dbo.AccountEmployeeTimeEntry.CustomField6, 
                      dbo.AccountEmployeeTimeEntry.CustomField7, dbo.AccountEmployeeTimeEntry.CustomField8, dbo.AccountEmployeeTimeEntry.CustomField9, 
                      dbo.AccountEmployeeTimeEntry.CustomField10, dbo.AccountEmployeeTimeEntry.CustomField11, dbo.AccountEmployeeTimeEntry.CustomField12, 
                      dbo.AccountEmployeeTimeEntry.CustomField13, dbo.AccountEmployeeTimeEntry.CustomField14, dbo.AccountEmployeeTimeEntry.CustomField15, 
                      AccountProjectTask_1.StartDate AS TaskStartDate, AccountProjectTask_1.DeadlineDate AS TaskDeadlineDate, dbo.AccountEmployeeTimeEntry.Hours
FROM         dbo.AccountHolidayTypeDetail RIGHT OUTER JOIN
                      dbo.AccountEmployeeTimeEntry INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeEntry.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId ON 
                      dbo.AccountHolidayTypeDetail.AccountHolidayTypeId = dbo.AccountEmployee.AccountHolidayTypeId AND 
                      dbo.AccountHolidayTypeDetail.AccountId = dbo.AccountEmployee.AccountId AND 
                      dbo.AccountHolidayTypeDetail.HolidayDate = dbo.AccountEmployeeTimeEntry.TimeEntryDate LEFT OUTER JOIN
                      dbo.AccountEmployeeType ON dbo.AccountEmployee.EmployeePayTypeId = dbo.AccountEmployeeType.AccountEmployeeTypeId LEFT OUTER JOIN
                      dbo.AccountProjectTask AS AccountProjectTask_1 LEFT OUTER JOIN
                      dbo.AccountProjectTask ON AccountProjectTask_1.ParentAccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId ON 
                      dbo.AccountEmployeeTimeEntry.AccountProjectTaskId = AccountProjectTask_1.AccountProjectTaskId LEFT OUTER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountStatus ON dbo.AccountProject.ProjectStatusId = dbo.AccountStatus.AccountStatusId LEFT OUTER JOIN
                      dbo.AccountTimeOffType ON dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId LEFT OUTER JOIN
                      dbo.AccountPartyDepartment ON dbo.AccountProject.AccountPartyDepartmentId = dbo.AccountPartyDepartment.AccountPartyDepartmentId LEFT OUTER JOIN
                      dbo.AccountPartyContact ON dbo.AccountProject.AccountPartyContactId = dbo.AccountPartyContact.AccountPartyContactId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryPeriod ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId LEFT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryApprovalLastAction.AccountEmployeeTimeEntryId LEFT OUTER JOIN
                      dbo.AccountCostCenter ON dbo.AccountEmployeeTimeEntry.AccountCostCenterId = dbo.AccountCostCenter.AccountCostCenterId LEFT OUTER JOIN
                      dbo.AccountWorkType ON dbo.AccountEmployeeTimeEntry.AccountWorkTypeId = dbo.AccountWorkType.AccountWorkTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId LEFT OUTER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId'
                      
GO
-- Create View vueAccountEmployeeTimeEntryForReport
Print 'Create View vueAccountEmployeeTimeEntryForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryForReport
AS
SELECT     dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeName, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskName, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalTime, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Approved, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TeamLeadApproved, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectManagerApproved, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AdministratorApproved, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeTimeEntryId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.StartTime, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EndTime, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Description, N'''') AS Description, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.WeekDay, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountPartyId AS AccountClientId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.PartyName AS ClientName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectTaskId, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingType, N'''') 
                      AS BillingType, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectManagerEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ExpenseApprovalTypeId, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.IsBillable, 0) 
                      AS IsBillable, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Rejected, 0) AS Rejected, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRate, 0) AS BillingRate, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectBillingRateTypeId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeCode, N'''') AS EmployeeCode, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountDepartmentId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.DepartmentName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedCost, 0) AS EstimatedCost, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedTimeSpent, 0) AS EstimatedHours, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Submitted, 0) AS Submitted, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountWorkType, N'''') AS AccountWorkType, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EMailAddress, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountLocation, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountCostCenter, N'''') AS AccountCostCenter, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountCostCenterCode, N'''') AS AccountCostCenterCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountWorkTypeCode, N'''') AS AccountWorkTypeCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectCode, N'''') AS ProjectCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCode, N'''') AS TaskCode, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountLocationId, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Comments, N'''') 
                      AS ApproverComments, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes * dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRate / 60, 0) 
                      AS Amount, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRateCurrencyId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateExchangeRate, 0) AS BillingRateExchangeRate, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRateExchangeRate, 0) AS EmployeeRateExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountBaseCurrencyId, dbo.vueAccountCurrency.CurrencyCode AS BillingRateCurrencyCode, 
                      dbo.vueAccountCurrency.CurrencyCode AS AmountCurrencyCode, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountTaskTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskStatusId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountPriorityId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectMilestoneId, dbo.AccountTaskType.TaskType, dbo.AccountStatus.Status AS TaskStatus, 
                      dbo.AccountProjectMilestone.MilestoneDescription, dbo.AccountPriority.Priority, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Hours AS TotalHours, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.DepartmentCode, N'''') AS DepartmentCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.PartyNick, N'''') AS ClientNick, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedCurrencyId, vueAccountCurrency_1.CurrencyCode AS EstimatedCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ApprovedOn, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRate, 0) 
                      AS EmployeeRate, vueAccountCurrency_2.CurrencyCode AS EmployeeRateCurrencyCode, 
                      AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName AS TeamLeader, 
                      AccountEmployee_2.FirstName + '' '' + AccountEmployee_2.LastName AS ProjectManager, 
                      ISNULL(dbo.AccountEmployee.FirstName + N'' '' + dbo.AccountEmployee.LastName, N'''') AS EmployeeManager, 
                      vueAccountCurrency_1.ExchangeRate AS EstimatedCurrencyExchangeRate, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes * dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRate / 60, 0) 
                      AS EmployeeCost, { fn DAYOFMONTH(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) } AS DayNo, 
                      MONTH(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) AS MonthNo, DATEPART(week, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) - DATEPART(week, DATEADD(month, DATEDIFF(month, 0, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate), 0)) + 1 AS WeekNo, 
                      YEAR(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) AS Year, 
                      LEFT({ fn MONTHNAME(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) }, 3) + '' - '' + CONVERT(nvarchar(10), 
                      YEAR(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate)) AS Period, 
                      { fn DAYNAME(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) } AS WeekDayName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountRoleId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Role, 
                      dbo.AccountProjectType.ProjectType, dbo.AccountRole.Role AS ProjectRole, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectDescription, N'''') 
                      AS ProjectDescription, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskDescription, N'''') AS TaskDescription, 
                      dbo.AccountTimeExpenseBilling.InvoiceNumber, dbo.AccountTimeExpenseBilling.InvoiceDate, dbo.AccountProjectType.AccountProjectTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Billed, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeTimeEntryPeriodId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientContactName, N'''') AS ClientContactName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentCode, N'''') AS ClientDepartmentCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentName, N'''') AS ClientDepartmentName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentLocation, N'''') AS ClientDepartmentLocation, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.IsTimeOff, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountWorkTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectStatus, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ParentTaskName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.FirstName, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.LastName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeType, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.HolidayName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField1, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField2, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField3, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField4, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField5, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField6, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField7, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField8, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField9, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField10, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField11, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField12, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField13, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField14, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField15, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskStartDate, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskDeadlineDate
FROM         dbo.AccountRole INNER JOIN
                      dbo.AccountProjectEmployee ON dbo.AccountRole.AccountRoleId = dbo.AccountProjectEmployee.AccountRoleId RIGHT OUTER JOIN
                      dbo.AccountTimeExpenseBillingTimesheet INNER JOIN
                      dbo.AccountTimeExpenseBilling ON 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingId = dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId RIGHT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport LEFT OUTER JOIN
                      dbo.AccountProjectType ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectTypeId = dbo.AccountProjectType.AccountProjectTypeId LEFT OUTER JOIN
                      dbo.AccountProjectMilestone ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectMilestoneId = dbo.AccountProjectMilestone.AccountProjectMilestoneId LEFT OUTER JOIN
                      dbo.AccountStatus ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskStatusId = dbo.AccountStatus.AccountStatusId LEFT OUTER JOIN
                      dbo.AccountPriority ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountPriorityId = dbo.AccountPriority.AccountPriorityId LEFT OUTER JOIN
                      dbo.AccountTaskType ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountTaskTypeId = dbo.AccountTaskType.AccountTaskTypeId ON 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingTimesheetId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountTimeExpenseBillingTimesheetId
                       ON dbo.AccountProjectEmployee.AccountEmployeeId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeId AND 
                      dbo.AccountProjectEmployee.AccountProjectId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.LeaderEmployeeId = AccountEmployee_1.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_2 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectManagerEmployeeId = AccountEmployee_2.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.AccountEmployee AS AccountEmployee_3 ON dbo.AccountEmployee.AccountEmployeeId = AccountEmployee_3.EmployeeManagerId ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeId = AccountEmployee_3.AccountEmployeeId LEFT OUTER JOIN
                      dbo.vueAccountCurrency AS vueAccountCurrency_2 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRateCurrencyId = vueAccountCurrency_2.AccountCurrencyId LEFT OUTER JOIN
                      dbo.vueAccountCurrency AS vueAccountCurrency_1 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedCurrencyId = vueAccountCurrency_1.AccountCurrencyId LEFT OUTER JOIN
                      dbo.vueAccountCurrency ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateCurrencyId = dbo.vueAccountCurrency.AccountCurrencyId'

GO
-- Drop View rptvueAccountEmployeeTimeEntryPeriod
Print 'Drop View rptvueAccountEmployeeTimeEntryPeriod'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeEntryPeriod' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountEmployeeTimeEntryPeriod]

GO
-- Drop View vueAccountEmployeeTimeEntryPeriodForReport
Print 'Drop View vueAccountEmployeeTimeEntryPeriodForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPeriodForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryPeriodForReport]

GO
-- Create View vueAccountEmployeeTimeEntryPeriodForReport
Print 'Create View vueAccountEmployeeTimeEntryPeriodForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPeriodForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryPeriodForReport
AS
SELECT     dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId, dbo.AccountEmployeeTimeEntryPeriod.AccountId, 
                      dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeId, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, 
                      dbo.AccountEmployeeTimeEntryPeriod.Submitted, dbo.AccountEmployeeTimeEntryPeriod.Approved, dbo.AccountEmployeeTimeEntryPeriod.Rejected, 
                      dbo.AccountEmployeeTimeEntryPeriod.InApproval, dbo.AccountEmployeeTimeEntryPeriod.SubmittedDate, dbo.vueAccountEmployee.EmployeeName, 
                      dbo.vueAccountEmployee.AccountLocationId, dbo.vueAccountEmployee.AccountDepartmentId, dbo.vueAccountEmployee.AccountLocation, 
                      dbo.vueAccountEmployee.Role, dbo.vueAccountEmployee.DepartmentName, dbo.vueAccountEmployee.EMailAddress, dbo.vueAccountEmployee.AccountRoleId, 
                      CASE WHEN AccountEmployeeTimeEntryPeriod.Submitted = 1 AND 
                      AccountEmployeeTimeEntryPeriod.Approved = 0 THEN ''Submitted'' WHEN AccountEmployeeTimeEntryPeriod.Approved = 1 THEN ''Approved'' WHEN AccountEmployeeTimeEntryPeriod.Rejected
                       = 1 THEN ''Rejected'' WHEN AccountEmployeeTimeEntryPeriod.Submitted = 0 AND AccountEmployeeTimeEntryPeriod.Approved = 0 AND 
                      AccountEmployeeTimeEntryPeriod.Rejected = 0 THEN ''Not Submitted'' END AS ApprovalStatus, 
                      { fn DAYOFMONTH(dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate) } AS DayNo, MONTH(dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate) 
                      AS MonthNo, DATEPART(week, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate) - DATEPART(week, DATEADD(month, DATEDIFF(month, 0, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate), 0)) + 1 AS WeekNo, YEAR(dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate) AS Year, 
                      LEFT({ fn MONTHNAME(dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate) }, 3) + '' - '' + CONVERT(nvarchar(10), 
                      YEAR(dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate)) AS Period, { fn DAYNAME(dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate) 
                      } AS WeekDayName, SUM(CONVERT(float, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes) / 60) AS TotalHours, 
                      SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes * dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRate / 60, 0)) 
                      AS Amount, SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRate, 0)) AS BillingRate, 
                      SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.SubmittedHours, 0)) AS SubmittedHours, 
                      SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ApprovedHours, 0)) AS ApprovedHours, 
                      SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.RejectedHours, 0)) AS RejectedHours, ISNULL(dbo.vueAccountEmployee.EmployeeCode, '''') 
                      AS EmployeeCode, SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateExchangeRate, 0)) AS BillingRateExchangeRate, 
                      dbo.AccountEmployeeTimeEntryPeriod.ApprovedOn, dbo.AccountEmployeeTimeEntryPeriod.RejectedOn, 
                      dbo.AccountEmployeeTimeEntryPeriod.ApprovedByEmployeeId, dbo.AccountEmployeeTimeEntryPeriod.RejectedByEmployeeId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientContactName, N'''') AS ClientContactName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentCode, N'''') AS ClientDepartmentCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentName, N'''') AS ClientDepartmentName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentLocation, N'''') AS ClientDepartmentLocation, 
                      SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeOffHours, 0)) AS TimeOffHours, 
                      SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimesheetHours, 0)) AS TimesheetHours, 
                      SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Percentage, 0)) AS Percentage, dbo.vueAccountEmployee.HoursPerDay, 
                      dbo.vueAccountEmployee.MinimumHoursPerDay, dbo.vueAccountEmployee.MaximumHoursPerDay, dbo.vueAccountEmployee.MinimumHoursPerWeek, 
                      dbo.vueAccountEmployee.MaximumHoursPerWeek, dbo.vueAccountEmployee.EmployeeWeekStartDay AS WeekStartDay
FROM         dbo.AccountEmployeeTimeEntryPeriod INNER JOIN
                      dbo.vueAccountEmployee ON dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeId = dbo.vueAccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport ON 
                      dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeTimeEntryPeriodId
GROUP BY dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId, dbo.AccountEmployeeTimeEntryPeriod.AccountId, 
                      dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeId, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, 
                      dbo.AccountEmployeeTimeEntryPeriod.Submitted, dbo.AccountEmployeeTimeEntryPeriod.Approved, dbo.AccountEmployeeTimeEntryPeriod.Rejected, 
                      dbo.AccountEmployeeTimeEntryPeriod.InApproval, dbo.AccountEmployeeTimeEntryPeriod.SubmittedDate, dbo.vueAccountEmployee.EmployeeName, 
                      dbo.vueAccountEmployee.AccountLocationId, dbo.vueAccountEmployee.AccountDepartmentId, dbo.vueAccountEmployee.AccountLocation, 
                      dbo.vueAccountEmployee.Role, dbo.vueAccountEmployee.DepartmentName, dbo.vueAccountEmployee.EMailAddress, dbo.vueAccountEmployee.AccountRoleId, 
                      dbo.vueAccountEmployee.EmployeeCode, dbo.AccountEmployeeTimeEntryPeriod.ApprovedOn, dbo.AccountEmployeeTimeEntryPeriod.RejectedOn, 
                      dbo.AccountEmployeeTimeEntryPeriod.ApprovedByEmployeeId, dbo.AccountEmployeeTimeEntryPeriod.RejectedByEmployeeId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientContactName, N''''), 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentCode, N''''), 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentName, N''''), 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentLocation, N''''), dbo.vueAccountEmployee.HoursPerDay, 
                      dbo.vueAccountEmployee.MinimumHoursPerDay, dbo.vueAccountEmployee.MaximumHoursPerDay, dbo.vueAccountEmployee.MinimumHoursPerWeek, 
                      dbo.vueAccountEmployee.MaximumHoursPerWeek, dbo.vueAccountEmployee.EmployeeWeekStartDay'

GO
-- Create View rptvueAccountEmployeeTimeEntryPeriod
Print 'Create View rptvueAccountEmployeeTimeEntryPeriod'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeEntryPeriod' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountEmployeeTimeEntryPeriod
AS
SELECT     dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountEmployeeTimeEntryPeriodId, dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountId, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountEmployeeId, dbo.vueAccountEmployeeTimeEntryPeriodForReport.TimeEntryStartDate, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.TimeEntryEndDate, dbo.vueAccountEmployeeTimeEntryPeriodForReport.TimeEntryViewType, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.Submitted, dbo.vueAccountEmployeeTimeEntryPeriodForReport.Approved, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.Rejected, dbo.vueAccountEmployeeTimeEntryPeriodForReport.InApproval, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.SubmittedDate, dbo.vueAccountEmployeeTimeEntryPeriodForReport.EmployeeName, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountLocationId, dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountDepartmentId, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountLocation, dbo.vueAccountEmployeeTimeEntryPeriodForReport.Role, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.DepartmentName, dbo.vueAccountEmployeeTimeEntryPeriodForReport.EMailAddress, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountRoleId, dbo.vueAccountEmployeeTimeEntryPeriodForReport.ApprovalStatus, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.DayNo, dbo.vueAccountEmployeeTimeEntryPeriodForReport.MonthNo, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.WeekNo, dbo.vueAccountEmployeeTimeEntryPeriodForReport.Year, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.Period, dbo.vueAccountEmployeeTimeEntryPeriodForReport.WeekDayName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryPeriodForReport.TotalHours, 0) AS TotalHours, dbo.vueAccountEmployeeTimeEntryPeriodForReport.Amount, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.BillingRate, dbo.vueAccountEmployeeTimeEntryPeriodForReport.SubmittedHours, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.ApprovedHours, dbo.vueAccountEmployeeTimeEntryPeriodForReport.RejectedHours, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.EmployeeCode, 
                      CASE WHEN BillingRateExchangeRate > 0 THEN Amount / BillingRateExchangeRate ELSE 0 END AS CurrencyAmount, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryPeriodForReport.Approved = 1 THEN dbo.vueAccountEmployeeTimeEntryPeriodForReport.ApprovedOn ELSE NULL 
                      END AS ApprovedDate, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryPeriodForReport.Rejected = 1 THEN dbo.vueAccountEmployeeTimeEntryPeriodForReport.RejectedOn ELSE NULL 
                      END AS RejectedDate, AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName AS ApprovedByEmployeeName, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS RejectedByEmployeeName, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.ClientContactName, dbo.vueAccountEmployeeTimeEntryPeriodForReport.ClientDepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.ClientDepartmentName, dbo.vueAccountEmployeeTimeEntryPeriodForReport.ClientDepartmentLocation, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.TimeOffHours, dbo.vueAccountEmployeeTimeEntryPeriodForReport.TimesheetHours, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.Percentage, dbo.vueAccountEmployeeTimeEntryPeriodForReport.HoursPerDay, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.MinimumHoursPerDay, dbo.vueAccountEmployeeTimeEntryPeriodForReport.MaximumHoursPerDay, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.MinimumHoursPerWeek, dbo.vueAccountEmployeeTimeEntryPeriodForReport.MaximumHoursPerWeek, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.WeekStartDay
FROM         dbo.AccountEmployee AS AccountEmployee_1 RIGHT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport ON 
                      AccountEmployee_1.AccountEmployeeId = dbo.vueAccountEmployeeTimeEntryPeriodForReport.ApprovedByEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee ON dbo.vueAccountEmployeeTimeEntryPeriodForReport.RejectedByEmployeeId = dbo.AccountEmployee.AccountEmployeeId'

GO
If exists(Select * from SystemData where version = '4.0.6')
--Update SystemSecurityCategoryPage Record
BEGIN           
update AccountEmployeeTimeEntryPeriod set AccountEmployeeId  = AccountEmployeeTimeEntry.AccountEmployeeId from 
accountemployeeTimeEntry inner join AccountEmployeeTimeEntryPeriod on AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId = AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId 
where AccountEmployeeTimeEntryPeriod.AccountEmployeeId <> AccountEmployeeTimeEntry.AccountEmployeeId


Update AccountEmployeeTimeEntry Set AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId =
(Select top 1 AccountEmployeeTimeEntryApprovalProject.AccountEmployeeTimeEntryApprovalProjectId From AccountEmployeeTimeEntryApprovalProject
Where AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId = AccountEmployeeTimeEntryApprovalProject.AccountEmployeeTimeEntryPeriodId
And AccountEmployeeTimeEntry.AccountEmployeeId = AccountEmployeeTimeEntryApprovalProject.TimeEntryAccountEmployeeId
And AccountEmployeeTimeEntry.AccountProjectId = AccountEmployeeTimeEntryApprovalProject.AccountProjectId)


Delete From AccountEmployeeTimeEntryApprovalProject
Where AccountEmployeeTimeEntryApprovalProjectId Not In 
(Select AccountEmployeeTimeEntryApprovalProjectId From AccountEmployeeTimeEntry
Where AccountEmployeeTimeEntryApprovalProjectId Is Not NULL)


Delete From AccountEmployeeTimeEntryPeriod
Where AccountEmployeeTimeEntryPeriodId Not In (Select AccountEmployeeTimeEntryPeriodId From AccountEmployeeTimeEntry
Where AccountEmployeeTimeEntryPeriodId Is Not NULL) 
And AccountEmployeeTimeEntryPeriodId Not In (Select AccountEmployeeTimeEntryPeriodId
From AccountEmployeeTimeEntryApprovalProject)


Update AccountEmployeeTimeEntry Set AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId =
(Select Top 1 AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId From AccountEmployeeTimeEntryPeriod
Where AccountEmployeeTimeEntry.TimeEntryDate >= AccountEmployeeTimeEntryPeriod.TimeEntryStartDate 
And AccountEmployeeTimeEntry.TimeEntryDate <= AccountEmployeeTimeEntryPeriod.TimeEntryEndDate
And AccountEmployeeTimeEntry.AccountEmployeeId = AccountEmployeeTimeEntryPeriod.AccountEmployeeId)


Update AccountEmployeeTimeEntry Set AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId =
(Select top 1 AccountEmployeeTimeEntryApprovalProject.AccountEmployeeTimeEntryApprovalProjectId From AccountEmployeeTimeEntryApprovalProject
Where AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId = AccountEmployeeTimeEntryApprovalProject.AccountEmployeeTimeEntryPeriodId
And AccountEmployeeTimeEntry.AccountEmployeeId = AccountEmployeeTimeEntryApprovalProject.TimeEntryAccountEmployeeId
And AccountEmployeeTimeEntry.AccountProjectId = AccountEmployeeTimeEntryApprovalProject.AccountProjectId)


Update AccountEmployeeTimeEntryApproval Set AccountEmployeeTimeEntryApproval.AccountEmployeeTimeEntryPeriodId =
(Select Top 1 AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId From AccountEmployeeTimeEntry
Where AccountEmployeeTimeEntryApproval.AccountEmployeeTimeEntryId = AccountEmployeetimeentry.AccountEmployeeTimeEntryId
)


Delete From AccountEmployeeTimeEntryApprovalProject
Where AccountEmployeeTimeEntryApprovalProjectId Not In 
(Select AccountEmployeeTimeEntryApprovalProjectId From AccountEmployeeTimeEntry
Where AccountEmployeeTimeEntryApprovalProjectId Is Not NULL)


Delete From AccountEmployeeTimeEntryPeriod
Where AccountEmployeeTimeEntryPeriodId Not In (Select AccountEmployeeTimeEntryPeriodId From AccountEmployeeTimeEntry
Where AccountEmployeeTimeEntryPeriodId Is Not NULL) 
And AccountEmployeeTimeEntryPeriodId Not In (Select AccountEmployeeTimeEntryPeriodId
From AccountEmployeeTimeEntryApprovalProject)
END
GO
Update SystemData Set Version = '4.0.7' Where Version = '4.0.6' And SystemDataId = 1

GO
-- Add Column IncludeCurrentYearInProjectCode to AccountPreferences
Print 'Add Column IncludeCurrentYearInProjectCode to AccountPreferences'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountPreferences' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='IncludeCurrentYearInProjectCode' AND TABLE_NAME='AccountPreferences'))
ALTER TABLE [dbo].[AccountPreferences]
	ADD [IncludeCurrentYearInProjectCode] bit NULL
	
GO
-- Add Column ShowAdditionalProjectInformationType to AccountPreferences
Print 'Add Column ShowAdditionalProjectInformationType to AccountPreferences'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountPreferences' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='ShowAdditionalProjectInformationType' AND TABLE_NAME='AccountPreferences'))
ALTER TABLE [dbo].[AccountPreferences]
	ADD [ShowAdditionalProjectInformationType] Int NULL
	
GO
-- Add Column IsLock to Account
Print 'Add Column IsLock to Account'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'Account' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='IsLock' AND TABLE_NAME='Account'))
ALTER TABLE [dbo].[Account]
	ADD [IsLock] bit NULL		                                                                  
	

GO
-- Drop View vueAccount
Print 'Drop View vueAccount'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccount' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccount]

GO
-- Drop View [dbo].[vueAccountEmployee]
Print 'Drop View [dbo].[vueAccountEmployee]'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployee]


GO
-- Create View vueAccount
Print 'Create View vueAccount'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccount' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccount
AS
SELECT     dbo.Account.AccountId, dbo.Account.AccountTypeId, dbo.Account.AccountName, dbo.Account.Address1, dbo.Account.Address2, dbo.Account.ZipCode, dbo.Account.State, 
                      dbo.Account.City, dbo.Account.CountryId, dbo.Account.EMailAddress, dbo.Account.Telephone, dbo.Account.Fax, dbo.Account.DefaultCurrencyId, 
                      dbo.Account.TimeZoneId, dbo.Account.IsDisabled, dbo.Account.IsDeleted, dbo.Account.StatusId, dbo.Account.CreatedOn, dbo.Account.ModifiedOn, 
                      dbo.Account.ModifiedByEmployeeId, dbo.AccountPreferences.ShowClockStartEnd, dbo.AccountPreferences.AccountPreferencesId, dbo.Account.LicenseKey, 
                      dbo.Account.SystemPackageTypeId, dbo.AccountPreferences.TimeEntryFormat, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.Account.MachineId, dbo.Account.ActivationLicenseKey, dbo.Account.ActivationMachineKey, 
                      dbo.Account.ActivationType, dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountPreferences.InvoiceBillingTypeId, 
                      dbo.AccountPreferences.ShowBillingRateInInvoiceReport, dbo.AccountPreferences.InvoiceFooter, dbo.AccountPreferences.ShowProjectNameInInvoiceReport, 
                      dbo.AccountPreferences.ProjectCodePrefix, dbo.AccountPreferences.AutoGenerateProjectCode, dbo.AccountPreferences.TimeEntryHoursFormatId, 
                      dbo.AccountPreferences.ShowPercentageInTimesheet, dbo.AccountPreferences.EnablePasswordComplexity, dbo.AccountPreferences.ShowClientDepartmentInProject, 
                      dbo.AccountPreferences.ShowEntryDateInInvoiceReport, dbo.AccountPreferences.TimesheetSort, dbo.AccountPreferences.ShowCostCenterInTimesheetBy, 
                      dbo.AccountPreferences.ShowCopyTimesheetButton, dbo.AccountPreferences.ShowCopyActivitiesButtonInTimesheet, 
                      dbo.AccountPreferences.ShowProjectNameInTask, dbo.AccountPreferences.ShowClientNameInTask, dbo.AccountPreferences.IsShowElectronicSign, 
                      dbo.AccountPreferences.ShowCompletedProjectInProjectGrid, dbo.AccountPreferences.ShowEmployeeNameInInvoiceReport, 
                      dbo.AccountPreferences.CalculateTaskPercentageAutomatically, dbo.Account.IsLock, dbo.AccountPreferences.IncludeCurrentYearInProjectCode, 
                      dbo.AccountPreferences.ShowAdditionalProjectInformationType
FROM         dbo.Account INNER JOIN
                      dbo.AccountPreferences ON dbo.Account.AccountId = dbo.AccountPreferences.AccountId'
                    
GO
-- Create View [dbo].[vueAccountEmployee]
Print 'Create View [dbo].[vueAccountEmployee]'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployee
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountEmployee.AccountId, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.Password, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountLocationId, dbo.AccountEmployee.BillingTypeId, 
                      dbo.AccountBillingType.BillingType, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, dbo.AccountPreferences.ShowClockStartEnd, dbo.Account.TimeZoneId, 
                      dbo.AccountRole.MasterAccountRoleId, dbo.Account.DefaultCurrencyId, dbo.Account.CountryId, dbo.AccountPreferences.CultureInfoName, 
                      dbo.AccountPreferences.TimeEntryFormat, dbo.AccountEmployee.AllowedAccessFromIP, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountPreferences.AccountSessionTimeout, dbo.AccountPreferences.ShowCompletedTasksInTimeSheet, dbo.AccountPreferences.CurrencySymbol, 
                      dbo.AccountPreferences.IsCompanyOwnLogo, dbo.Account.AccountExpiryActivation, dbo.Account.LicenseActivation, dbo.AccountEmployee.EmployeeTypeId, 
                      dbo.AccountEmployee.ExternalUserClientId, dbo.AccountEmployee.AccountBillingRateId, dbo.AccountPreferences.ScheduledEmailSendTime, 
                      dbo.AccountEmployee.Username, dbo.AccountEmployee.IsDisabled, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.AccountEmployee.EmployeeCode, dbo.AccountPreferences.Version, 
                      dbo.AccountPreferences.LockSubmittedRecords, dbo.AccountPreferences.LockApprovedRecords, ISNULL(dbo.AccountEmployee.EmployeeCode + '' - '', '''') 
                      + dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeNameWithCode, dbo.AccountPreferences.ShowWorkTypeInTimeSheet, 
                      dbo.AccountPreferences.NumberOfBlankRowsInTimeEntry, dbo.AccountPreferences.ShowCostCenterInTimeSheet, dbo.AccountPreferences.WeekStartDay, 
                      dbo.AccountPreferences.AccountBaseCurrencyId, dbo.AccountEmployee.UserInterfaceLanguage, dbo.AccountEmployee.EmployeeManagerId, 
                      dbo.AccountPreferences.DefaultTimeEntryMode, dbo.AccountPreferences.PageSize, dbo.AccountEmployee.TimeZoneId AS EmployeeTimeZoneId, 
                      dbo.AccountEmployee.TerminationDate, dbo.AccountEmployee.StatusId, dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.EmployeePayTypeId, 
                      dbo.AccountEmployee.HiredDate, dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountWorkingDayType, 
                      dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay AS EmployeeWeekStartDay, 
                      dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountPreferences.ShowDescriptionInWeekView, 
                      dbo.AccountPreferences.InvoiceNoPrefix, dbo.AccountPreferences.ShowAdditionalTaskInformationType, 
                      dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, 
                      ISNULL(dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, 1) AS InitialDayOfTheMonth, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, 1) 
                      AS SystemInitialDayOfFirstPeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod, 16) AS SystemInitialDayOfLastPeriod, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountPreferences.TimesheetPrintFooter, dbo.AccountPreferences.ExpenseSheetPrintFooter, 
                      dbo.AccountPreferences.ShowCompletedProjectsInTimeSheet, dbo.AccountPreferences.ShowProjectForTimeOff, dbo.AccountPreferences.ShowTimeOffInTimesheet, 
                      dbo.AccountEmployee.IsDeleted, dbo.AccountEmployee.IsForcePasswordChange, dbo.AccountEmployee.PasswordChangedDate, 
                      dbo.AccountPreferences.PasswordExpiryPeriod, dbo.AccountPreferences.ShowAllInTimesheetReadOnly, dbo.AccountPreferences.ShowTaskInExpenseSheet, 
                      dbo.AccountPreferences.InvoiceBillingTypeId, dbo.AccountPreferences.ShowBillingRateInInvoiceReport, dbo.SystemInvoiceBillingType.InvoiceBillingType, 
                      dbo.AccountPreferences.InvoiceFooter, dbo.AccountPreferences.TimesheetOverduePeriods, dbo.AccountWorkingDayType.TimesheetOverdueAfterDays, 
                      dbo.AccountEmployee.CreatedOn, dbo.AccountEmployee.CreatedByEmployeeId, dbo.AccountEmployee.ModifiedOn, dbo.AccountEmployee.ModifiedByEmployeeId, 
                      dbo.AccountPreferences.ShowProjectNameInInvoiceReport, dbo.AccountPreferences.ProjectCodePrefix, dbo.AccountPreferences.AutoGenerateProjectCode, 
                      dbo.AccountPreferences.TimeEntryHoursFormatId, dbo.AccountPreferences.ShowPercentageInTimesheet, dbo.AccountPreferences.EnablePasswordComplexity, 
                      dbo.AccountPreferences.ShowClientDepartmentInProject, dbo.AccountPreferences.ShowEntryDateInInvoiceReport, dbo.AccountPreferences.TimesheetSort, 
                      dbo.AccountPreferences.ShowCostCenterInTimesheetBy, dbo.AccountPreferences.ShowCopyTimesheetButton, 
                      dbo.AccountPreferences.ShowCopyActivitiesButtonInTimesheet, dbo.AccountPreferences.ShowProjectNameInTask, dbo.AccountPreferences.ShowClientNameInTask, 
                      dbo.AccountPreferences.IsShowElectronicSign, ISNULL(dbo.AccountWorkingDayType.MinimumPercentagePerDay, 0) AS MinimumPercentagePerDay, 
                      ISNULL(dbo.AccountWorkingDayType.MaximumPercentagePerDay, 100) AS MaximumPercentagePerDay, 
                      ISNULL(dbo.AccountWorkingDayType.MinimumPercentagePerWeek, 0) AS MinimumPercentagePerWeek, 
                      ISNULL(dbo.AccountWorkingDayType.MaximumPercentagePerWeek, 500) AS MaximumPercentagePerWeek, 
                      dbo.AccountPreferences.ShowCompletedProjectInProjectGrid, dbo.AccountPreferences.ShowEmployeeNameInInvoiceReport, 
                      dbo.AccountPreferences.CalculateTaskPercentageAutomatically, dbo.AccountWorkingDayType.LockAllPreviousTimesheets, 
                      dbo.AccountWorkingDayType.LockAllFutureTimesheets, dbo.AccountWorkingDayType.LockPreviousTimesheetPeriods, 
                      dbo.AccountWorkingDayType.LockFutureTimsheetPeriods, dbo.AccountWorkingDayType.LockPreviousNextMonthTimesheetOn, 
                      dbo.AccountWorkingDayType.EnableBalanceValidationForTimeOff, dbo.Account.IsLock, dbo.AccountPreferences.IncludeCurrentYearInProjectCode, 
                      dbo.AccountPreferences.ShowAdditionalProjectInformationType
FROM         dbo.SystemInvoiceBillingType RIGHT OUTER JOIN
                      dbo.AccountPreferences ON dbo.SystemInvoiceBillingType.InvoiceBillingTypeId = dbo.AccountPreferences.InvoiceBillingTypeId RIGHT OUTER JOIN
                      dbo.vueAccountTimesheetPeriodType RIGHT OUTER JOIN
                      dbo.AccountWorkingDayType ON 
                      dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId = dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId RIGHT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.Account ON dbo.AccountEmployee.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId ON 
                      dbo.AccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId ON 
                      dbo.AccountPreferences.AccountId = dbo.AccountEmployee.AccountId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId'
                      
GO
-- Drop View vueAccountProjects
Print 'Drop View vueAccountProjects'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountProjects' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountProjects]

GO
-- Create View vueAccountProjects
Print 'Create View vueAccountProjects'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountProjects' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountProjects
AS
SELECT     dbo.AccountProject.AccountProjectId, dbo.AccountProject.ProjectName, dbo.AccountProject.StartDate, dbo.AccountProject.ProjectCode, dbo.AccountParty.PartyName, 
                      dbo.AccountProject.AccountClientId, dbo.AccountProject.LeaderEmployeeId, dbo.AccountProject.ProjectManagerEmployeeId, 
                      AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName AS LeaderName, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS ProjectManagerName, dbo.AccountProject.AccountId, dbo.AccountProject.IsActive, 
                      dbo.AccountProject.Deadline, dbo.AccountProject.EstimatedDuration, dbo.AccountProject.EstimatedDurationUnit, dbo.AccountProject.ProjectStatusId, 
                      dbo.AccountStatus.Status, dbo.AccountProject.IsDisabled, dbo.AccountProject.ProjectDescription, dbo.AccountProject.IsTemplate, dbo.AccountProject.IsProject, 
                      dbo.AccountProject.AccountProjectTemplateId, dbo.SystemProjectBillingRateType.SystemProjectBillingRateType, dbo.AccountProject.AccountProjectTypeId, 
                      dbo.AccountProjectType.ProjectType, dbo.AccountProjectType.MasterAccountProjectTypeId, dbo.AccountProject.IsDeleted, 
                      dbo.AccountPartyDepartment.PartyDepartmentName, dbo.AccountParty.IsDeleted AS IsDeletedClient, dbo.AccountProject.Completed, dbo.Account.IsLock
FROM         dbo.AccountStatus RIGHT OUTER JOIN
                      dbo.AccountEmployee RIGHT OUTER JOIN
                      dbo.Account INNER JOIN
                      dbo.AccountProject INNER JOIN
                      dbo.AccountProjectType ON dbo.AccountProject.AccountProjectTypeId = dbo.AccountProjectType.AccountProjectTypeId INNER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId ON dbo.Account.AccountId = dbo.AccountProject.AccountId ON 
                      dbo.AccountEmployee.AccountEmployeeId = dbo.AccountProject.ProjectManagerEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON dbo.AccountProject.LeaderEmployeeId = AccountEmployee_1.AccountEmployeeId ON 
                      dbo.AccountStatus.AccountStatusId = dbo.AccountProject.ProjectStatusId LEFT OUTER JOIN
                      dbo.AccountPartyDepartment ON dbo.AccountProject.AccountPartyDepartmentId = dbo.AccountPartyDepartment.AccountPartyDepartmentId LEFT OUTER JOIN
                      dbo.SystemProjectBillingRateType ON dbo.AccountProject.ProjectBillingRateTypeId = dbo.SystemProjectBillingRateType.SystemProjectBillingRateTypeId'

GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[MasterEntityType]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[MasterEntityType]'
If Not Exists(Select * from [dbo].[MasterEntityType] Where [MasterEntityTypeId] = 'c9a8f7f1-1b2d-48da-aae9-74f92892a896')
Begin
INSERT INTO [dbo].[MasterEntityType] ([MasterEntityTypeId], [MasterEntityTypeName]) VALUES ('c9a8f7f1-1b2d-48da-aae9-74f92892a896', N'Project Task')
-- Add rows to [dbo].[SystemReportDataSourceField]
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('b3d4b776-0c50-474f-a83a-383c0ff12056', '1e657f0a-881b-4f50-839a-c3a962c9a460', N'CustomField15', 100, 0, NULL, NULL, 314, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 15', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('c88d51e3-da97-47c9-a09b-4344695b1ef7', '1e657f0a-881b-4f50-839a-c3a962c9a460', N'CustomField10', 100, 0, NULL, NULL, 309, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 10', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('6c2b4c7b-7b20-4ac5-9a9a-4893824113e7', '1e657f0a-881b-4f50-839a-c3a962c9a460', N'CustomField3', 100, 0, NULL, NULL, 302, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 3', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('a9826f31-ac59-484d-8e2c-6d8a3532c781', '1e657f0a-881b-4f50-839a-c3a962c9a460', N'CustomField2', 100, 0, NULL, NULL, 301, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 2', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('41509c22-4de8-4073-aa5f-74d3c88dffb6', '18966956-9937-4da0-a6f3-465e6066d433', N'BillableTotalHours', 125, 0, NULL, NULL, 32, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Billable Total Hours', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('70fe9330-6657-4def-b9f1-81c2e7200a79', '1e657f0a-881b-4f50-839a-c3a962c9a460', N'CustomField6', 100, 0, NULL, NULL, 305, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custon Field 6', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('7df4be6f-826e-4e78-905d-8abfeeed1bb5', '1e657f0a-881b-4f50-839a-c3a962c9a460', N'CustomField1', 100, 0, NULL, NULL, 300, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 1', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('6ae3ba67-0801-4211-9cef-8f1f2a5bccee', '1e657f0a-881b-4f50-839a-c3a962c9a460', N'CustomField14', 100, 0, NULL, NULL, 313, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 14', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('fd1ca34b-b009-4b98-a63b-9c11747002e8', '1e657f0a-881b-4f50-839a-c3a962c9a460', N'CustomField11', 100, 0, NULL, NULL, 310, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 11', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('ca70f64b-318a-4661-9661-ca83cfbec394', '1e657f0a-881b-4f50-839a-c3a962c9a460', N'CustomField12', 100, 0, NULL, NULL, 311, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 12', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('22ed75f4-681e-4677-837a-d26bcaa19d70', '1e657f0a-881b-4f50-839a-c3a962c9a460', N'CustomField5', 100, 0, NULL, NULL, 304, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 5', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('11f8565f-a214-43e9-950f-d592b614e0c2', '1e657f0a-881b-4f50-839a-c3a962c9a460', N'CustomField9', 100, 0, NULL, NULL, 308, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 9', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('750ae719-b03c-4dc0-a776-eafcf765732e', '1e657f0a-881b-4f50-839a-c3a962c9a460', N'CustomField8', 100, 0, NULL, NULL, 307, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custiom Field 8', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('e7794532-7132-4d6a-a12e-ed1837f20430', '1e657f0a-881b-4f50-839a-c3a962c9a460', N'CustomField13', 100, 0, NULL, NULL, 312, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 13', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('d3d58194-8a70-4f4f-b01d-f6e84174f18d', '1e657f0a-881b-4f50-839a-c3a962c9a460', N'CustomField4', 100, 0, NULL, NULL, 303, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 4', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('9c8eec16-864d-490b-9045-fbc3c3aac11b', '1e657f0a-881b-4f50-839a-c3a962c9a460', N'CustomField7', 100, 0, NULL, NULL, 306, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Custom Field 7', 0, 0)

END

GO
-- Add Column [CustomField1] to [dbo].[AccountProjectTask]
Print 'Add Column [CustomField1] to [dbo].[AccountProjectTask]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProjectTask' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField1' AND TABLE_NAME='AccountProjectTask'))
ALTER TABLE [dbo].[AccountProjectTask]
	ADD [CustomField1] nvarchar(2000) NULL

GO
-- Add Column [CustomField2] to [dbo].[AccountProjectTask]
Print 'Add Column [CustomField2] to [dbo].[AccountProjectTask]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProjectTask' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField2' AND TABLE_NAME='AccountProjectTask'))
ALTER TABLE [dbo].[AccountProjectTask]
	ADD [CustomField2] nvarchar(2000) NULL

GO
-- Add Column [CustomField3] to [dbo].[AccountProjectTask]
Print 'Add Column [CustomField3] to [dbo].[AccountProjectTask]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProjectTask' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField3' AND TABLE_NAME='AccountProjectTask'))
ALTER TABLE [dbo].[AccountProjectTask]
	ADD [CustomField3] nvarchar(2000) NULL

GO
-- Add Column [CustomField4] to [dbo].[AccountProjectTask]
Print 'Add Column [CustomField4] to [dbo].[AccountProjectTask]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProjectTask' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField4' AND TABLE_NAME='AccountProjectTask'))
ALTER TABLE [dbo].[AccountProjectTask]
	ADD [CustomField4] nvarchar(2000) NULL

GO
-- Add Column [CustomField5] to [dbo].[AccountProjectTask]
Print 'Add Column [CustomField5] to [dbo].[AccountProjectTask]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProjectTask' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField5' AND TABLE_NAME='AccountProjectTask'))
ALTER TABLE [dbo].[AccountProjectTask]
	ADD [CustomField5] nvarchar(2000) NULL

GO
-- Add Column [CustomField6] to [dbo].[AccountProjectTask]
Print 'Add Column [CustomField6] to [dbo].[AccountProjectTask]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProjectTask' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField6' AND TABLE_NAME='AccountProjectTask'))
ALTER TABLE [dbo].[AccountProjectTask]
	ADD [CustomField6] nvarchar(2000) NULL

GO
-- Add Column [CustomField7] to [dbo].[AccountProjectTask]
Print 'Add Column [CustomField7] to [dbo].[AccountProjectTask]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProjectTask' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField7' AND TABLE_NAME='AccountProjectTask'))
ALTER TABLE [dbo].[AccountProjectTask]
	ADD [CustomField7] nvarchar(2000) NULL

GO
-- Add Column [CustomField8] to [dbo].[AccountProjectTask]
Print 'Add Column [CustomField8] to [dbo].[AccountProjectTask]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProjectTask' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField8' AND TABLE_NAME='AccountProjectTask'))
ALTER TABLE [dbo].[AccountProjectTask]
	ADD [CustomField8] nvarchar(2000) NULL

GO
-- Add Column [CustomField9] to [dbo].[AccountProjectTask]
Print 'Add Column [CustomField9] to [dbo].[AccountProjectTask]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProjectTask' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField9' AND TABLE_NAME='AccountProjectTask'))
ALTER TABLE [dbo].[AccountProjectTask]
	ADD [CustomField9] nvarchar(2000) NULL

GO
-- Add Column [CustomField10] to [dbo].[AccountProjectTask]
Print 'Add Column [CustomField10] to [dbo].[AccountProjectTask]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProjectTask' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField10' AND TABLE_NAME='AccountProjectTask'))
ALTER TABLE [dbo].[AccountProjectTask]
	ADD [CustomField10] nvarchar(2000) NULL

GO
-- Add Column [CustomField11] to [dbo].[AccountProjectTask]
Print 'Add Column [CustomField11] to [dbo].[AccountProjectTask]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProjectTask' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField11' AND TABLE_NAME='AccountProjectTask'))
ALTER TABLE [dbo].[AccountProjectTask]
	ADD [CustomField11] nvarchar(2000) NULL

GO
-- Add Column [CustomField12] to [dbo].[AccountProjectTask]
Print 'Add Column [CustomField12] to [dbo].[AccountProjectTask]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProjectTask' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField12' AND TABLE_NAME='AccountProjectTask'))
ALTER TABLE [dbo].[AccountProjectTask]
	ADD [CustomField12] nvarchar(2000) NULL

GO
-- Add Column [CustomField13] to [dbo].[AccountProjectTask]
Print 'Add Column [CustomField13] to [dbo].[AccountProjectTask]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProjectTask' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField13' AND TABLE_NAME='AccountProjectTask'))
ALTER TABLE [dbo].[AccountProjectTask]
	ADD [CustomField13] nvarchar(2000) NULL

GO
-- Add Column [CustomField14] to [dbo].[AccountProjectTask]
Print 'Add Column [CustomField14] to [dbo].[AccountProjectTask]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProjectTask' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField14' AND TABLE_NAME='AccountProjectTask'))
ALTER TABLE [dbo].[AccountProjectTask]
		ADD [CustomField14] nvarchar(2000) NULL

GO
-- Add Column [CustomField15] to [dbo].[AccountProjectTask]
Print 'Add Column [CustomField15] to [dbo].[AccountProjectTask]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountProjectTask' AND TABLE_TYPE='BASE TABLE')) 
AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='CustomField15' AND TABLE_NAME='AccountProjectTask'))
ALTER TABLE [dbo].[AccountProjectTask]
	ADD [CustomField15] nvarchar(2000) NULL
	
	
GO
-- Drop View vueAccountProjectTask
Print 'Drop View vueAccountProjectTask'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountProjectTask' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountProjectTask]


GO
-- Create View vueAccountProjectTask
Print 'Create View vueAccountProjectTask'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountProjectTask' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountProjectTask
AS
SELECT     dbo.AccountProjectTask.AccountProjectTaskId, dbo.AccountProjectTask.AccountProjectId, dbo.AccountProjectTask.ParentAccountProjectTaskId, 
                      dbo.AccountProjectTask.TaskName, dbo.AccountProjectTask.TaskDescription, dbo.AccountProjectTask.AccountTaskTypeId, dbo.AccountProjectTask.Duration, 
                      dbo.AccountProjectTask.DurationUnit, dbo.AccountProjectTask.DeadlineDate, dbo.AccountProjectTask.CompletedPercent, dbo.AccountProjectTask.Completed, 
                      dbo.AccountProjectTask.IsParentTask, dbo.AccountProjectTask.IsForAllEmployees, dbo.AccountProjectTask.AccountPriorityId, dbo.AccountProjectTask.TaskStatusId, 
                      dbo.AccountProjectTask.CreatedOn, dbo.AccountProjectTask.CreatedByEmployeeId, dbo.AccountProjectTask.ModifiedOn, 
                      dbo.AccountProjectTask.ModifiedByEmployeeId, dbo.AccountStatus.Status AS TaskStatus, dbo.AccountEmployee.FirstName AS CreatedByFirstName, 
                      dbo.AccountEmployee.LastName AS CreatedByLastName, dbo.AccountPriority.Priority, dbo.AccountProject.ProjectName, dbo.AccountProject.ProjectCode, 
                      dbo.AccountTaskType.TaskType, dbo.AccountProject.AccountId, dbo.AccountProjectTask.AccountProjectMilestoneId, 
                      dbo.AccountProjectMilestone.MilestoneDescription, dbo.AccountProjectTask.IsReOpen, AccountEmployee_1.FirstName AS ModifiedByFirstName, 
                      AccountEmployee_1.LastName AS ModifiedByLastName, dbo.AccountProjectTask.EstimatedCost, dbo.AccountProjectTask.EstimatedTimeSpent, 
                      dbo.AccountProjectTask.EstimatedTimeSpentUnit, dbo.AccountEmployee.AccountEmployeeId, dbo.AccountProjectTask.IsDisabled, dbo.AccountProjectTask.TaskCode, 
                      dbo.AccountProject.IsTemplate, dbo.AccountProjectTask.IsForAllProjectTask, dbo.AccountProjectTask.IsBillable, dbo.AccountProjectTask.EstimatedCurrencyId, 
                      dbo.AccountParty.PartyName, dbo.AccountParty.PartyNick, dbo.AccountProject.AccountClientId, dbo.AccountProject.ProjectDescription, 
                      dbo.AccountProjectMilestone.MilestoneDate, dbo.AccountProject.IsDeleted AS IsProjectDeleted, dbo.AccountProjectTask.StartDate, 
                      dbo.AccountParty.IsDeleted AS IsDeletedClient, dbo.AccountProjectTask.Predecessors, dbo.AccountProjectTask.CustomField1, dbo.AccountProjectTask.CustomField2, 
                      dbo.AccountProjectTask.CustomField3, dbo.AccountProjectTask.CustomField4, dbo.AccountProjectTask.CustomField5, dbo.AccountProjectTask.CustomField6, 
                      dbo.AccountProjectTask.CustomField7, dbo.AccountProjectTask.CustomField8, dbo.AccountProjectTask.CustomField9, dbo.AccountProjectTask.CustomField10, 
                      dbo.AccountProjectTask.CustomField11, dbo.AccountProjectTask.CustomField12, dbo.AccountProjectTask.CustomField13, dbo.AccountProjectTask.CustomField14, 
                      dbo.AccountProjectTask.CustomField15
FROM         dbo.AccountTaskType RIGHT OUTER JOIN
                      dbo.AccountProjectMilestone RIGHT OUTER JOIN
                      dbo.AccountProject INNER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId RIGHT OUTER JOIN
                      dbo.AccountProjectTask LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON dbo.AccountProjectTask.ModifiedByEmployeeId = AccountEmployee_1.AccountEmployeeId ON 
                      dbo.AccountProject.AccountProjectId = dbo.AccountProjectTask.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountEmployee ON dbo.AccountProjectTask.CreatedByEmployeeId = dbo.AccountEmployee.AccountEmployeeId ON 
                      dbo.AccountProjectMilestone.AccountProjectMilestoneId = dbo.AccountProjectTask.AccountProjectMilestoneId ON 
                      dbo.AccountTaskType.AccountTaskTypeId = dbo.AccountProjectTask.AccountTaskTypeId LEFT OUTER JOIN
                      dbo.AccountStatus ON dbo.AccountProjectTask.TaskStatusId = dbo.AccountStatus.AccountStatusId LEFT OUTER JOIN
                      dbo.AccountPriority ON dbo.AccountProjectTask.AccountPriorityId = dbo.AccountPriority.AccountPriorityId
WHERE     (dbo.AccountProject.IsDeleted <> 1) OR
                      (dbo.AccountProject.IsDeleted IS NULL)'

GO
-- Drop View vueAccountEmployeeExpenseSheet
Print 'Drop View vueAccountEmployeeExpenseSheet'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeExpenseSheet' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeExpenseSheet]

GO
-- Create View vueAccountEmployeeExpenseSheet
Print 'Create View vueAccountEmployeeExpenseSheet'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeExpenseSheet' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeExpenseSheet
AS
SELECT     dbo.AccountEmployeeExpenseSheet.AccountEmployeeExpenseSheetId, dbo.AccountEmployeeExpenseSheet.AccountId, 
                      dbo.AccountEmployeeExpenseSheet.AccountEmployeeId, dbo.AccountEmployeeExpenseSheet.Description, dbo.AccountEmployeeExpenseSheet.ExpenseSheetDate, 
                      MAX(dbo.vueAccountCurrency.Currency) AS Currency, MAX(dbo.vueAccountCurrency.CurrencyCode) AS CurrencyCode, 
                      MAX(dbo.vueAccountCurrency.AccountCurrencyId) AS AccountCurrencyId, CASE WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 0 AND dbo.AccountEmployeeExpenseSheet.Rejected = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.InApproval = 0 THEN ''Not Submitted'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Rejected = 0 THEN ''Approved'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.Rejected = 1 THEN ''Rejected'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 0 AND dbo.AccountEmployeeExpenseSheet.Rejected = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.InApproval = 1 THEN ''Submitted'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 0 AND dbo.AccountEmployeeExpenseSheet.Rejected = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.InApproval = 0 THEN ''Submitted'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 1 THEN ''Not Submitted'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 0 AND 
                      dbo.AccountEmployeeExpenseSheet.InApproval = 1 THEN ''Not Submitted'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Approved = 1 AND dbo.AccountEmployeeExpenseSheet.Rejected = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.InApproval = 1 THEN ''Approved'' WHEN dbo.AccountEmployeeExpenseSheet.Submitted = 1 AND 
                      dbo.AccountEmployeeExpenseSheet.Rejected = 1 THEN ''Submitted'' END AS Status, dbo.AccountEmployeeExpenseSheet.InApproval, 
                      dbo.AccountEmployeeExpenseSheet.Submitted, dbo.AccountEmployeeExpenseSheet.Rejected, dbo.AccountEmployeeExpenseSheet.Approved, 
                      dbo.AccountEmployeeExpenseSheet.SubmittedDate, 
                      CASE WHEN dbo.AccountEmployee.IsDisabled = 1 THEN dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE dbo.AccountEmployee.FirstName
                       + '' '' + dbo.AccountEmployee.LastName END AS EmployeeName, dbo.AccountEmployee.EMailAddress, MAX(dbo.vueAccountCurrency.ExchangeRate) 
                      AS ExchangeRate, dbo.AccountEmployeeExpenseSheet.ApprovedOn, dbo.AccountEmployeeExpenseSheet.ApprovedByEmployeeId, 
                      dbo.AccountEmployeeExpenseSheet.RejectedOn, dbo.AccountEmployeeExpenseSheet.RejectedByEmployeeId, 
                      SUM(ISNULL(dbo.vueAccountEmployeeExpenseSheetOnlyAmount.Amount * dbo.vueAccountCurrency.ExchangeRate, 0)) AS Amount, 
                      dbo.AccountEmployeeExpenseSheet.CustomField1, dbo.AccountEmployeeExpenseSheet.CustomField2, dbo.AccountEmployeeExpenseSheet.CustomField3, 
                      dbo.AccountEmployeeExpenseSheet.CustomField4, dbo.AccountEmployeeExpenseSheet.CustomField5, dbo.AccountEmployeeExpenseSheet.CustomField6, 
                      dbo.AccountEmployeeExpenseSheet.CustomField7, dbo.AccountEmployeeExpenseSheet.CustomField8, dbo.AccountEmployeeExpenseSheet.CustomField9, 
                      dbo.AccountEmployeeExpenseSheet.CustomField10, dbo.AccountEmployeeExpenseSheet.CustomField11, dbo.AccountEmployeeExpenseSheet.CustomField12, 
                      dbo.AccountEmployeeExpenseSheet.CustomField13, dbo.AccountEmployeeExpenseSheet.CustomField14, dbo.AccountEmployeeExpenseSheet.CustomField15
FROM         dbo.AccountExpenseEntry INNER JOIN
                      dbo.vueAccountEmployeeExpenseSheetOnlyAmount ON 
                      dbo.AccountExpenseEntry.AccountEmployeeExpenseSheetId = dbo.vueAccountEmployeeExpenseSheetOnlyAmount.AccountEmployeeExpenseSheetId AND 
                      dbo.AccountExpenseEntry.AccountExpenseEntryId = dbo.vueAccountEmployeeExpenseSheetOnlyAmount.AccountExpenseEntryId RIGHT OUTER JOIN
                      dbo.AccountEmployeeExpenseSheet INNER JOIN
                      dbo.AccountPreferences ON dbo.AccountEmployeeExpenseSheet.AccountId = dbo.AccountPreferences.AccountId INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeExpenseSheet.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId ON 
                      dbo.AccountExpenseEntry.AccountEmployeeExpenseSheetId = dbo.AccountEmployeeExpenseSheet.AccountEmployeeExpenseSheetId LEFT OUTER JOIN
                      dbo.vueAccountCurrency ON dbo.AccountPreferences.AccountBaseCurrencyId = dbo.vueAccountCurrency.AccountCurrencyId
GROUP BY dbo.AccountEmployeeExpenseSheet.AccountEmployeeExpenseSheetId, dbo.AccountEmployeeExpenseSheet.AccountId, 
                      dbo.AccountEmployeeExpenseSheet.AccountEmployeeId, dbo.AccountEmployeeExpenseSheet.Description, dbo.AccountEmployeeExpenseSheet.ExpenseSheetDate, 
                      dbo.AccountEmployeeExpenseSheet.InApproval, dbo.AccountEmployeeExpenseSheet.Submitted, dbo.AccountEmployeeExpenseSheet.Rejected, 
                      dbo.AccountEmployeeExpenseSheet.Approved, dbo.AccountEmployeeExpenseSheet.SubmittedDate, dbo.AccountEmployee.FirstName, 
                      dbo.AccountEmployee.LastName, dbo.AccountEmployee.EMailAddress, dbo.AccountEmployeeExpenseSheet.ApprovedOn, 
                      dbo.AccountEmployeeExpenseSheet.ApprovedByEmployeeId, dbo.AccountEmployeeExpenseSheet.RejectedOn, 
                      dbo.AccountEmployeeExpenseSheet.RejectedByEmployeeId, dbo.AccountEmployee.IsDisabled, dbo.AccountEmployeeExpenseSheet.CustomField1, 
                      dbo.AccountEmployeeExpenseSheet.CustomField2, dbo.AccountEmployeeExpenseSheet.CustomField3, dbo.AccountEmployeeExpenseSheet.CustomField4, 
                      dbo.AccountEmployeeExpenseSheet.CustomField5, dbo.AccountEmployeeExpenseSheet.CustomField6, dbo.AccountEmployeeExpenseSheet.CustomField7, 
                      dbo.AccountEmployeeExpenseSheet.CustomField8, dbo.AccountEmployeeExpenseSheet.CustomField9, dbo.AccountEmployeeExpenseSheet.CustomField10, 
                      dbo.AccountEmployeeExpenseSheet.CustomField11, dbo.AccountEmployeeExpenseSheet.CustomField12, dbo.AccountEmployeeExpenseSheet.CustomField13, 
                      dbo.AccountEmployeeExpenseSheet.CustomField14, dbo.AccountEmployeeExpenseSheet.CustomField15'
                      

GO
-- Drop View vueAccountEmployeeTimeEntryWithTimeOffForReport
Print 'Drop View vueAccountEmployeeTimeEntryWithTimeOffForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithTimeOffForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryWithTimeOffForReport]

GO
-- Drop View vueAccountEmployeeTimeEntryForReport
Print 'Drop View vueAccountEmployeeTimeEntryForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryForReport]

GO
-- Drop View vueAccountEmployeeTimeEntryPeriodForReport
Print 'Drop View vueAccountEmployeeTimeEntryPeriodForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPeriodForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryPeriodForReport]

GO
-- Drop View rptvueAccountEmployeeTimeEntryPeriod
Print 'Drop View rptvueAccountEmployeeTimeEntryPeriod'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeEntryPeriod' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountEmployeeTimeEntryPeriod]

GO
-- Drop View rptvueAccountEmployeeTimeEntry
Print 'Drop View rptvueAccountEmployeeTimeEntry'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeEntry' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountEmployeeTimeEntry]

GO
-- Drop View vueAccountEmployeeTimeEntryWithTimeOffForReport
Print 'Drop View vueAccountEmployeeTimeEntryWithTimeOffForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithTimeOffForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryWithTimeOffForReport]

GO
-- Create View vueAccountEmployeeTimeEntryWithTimeOffForReport
Print 'Create View vueAccountEmployeeTimeEntryWithTimeOffForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithTimeOffForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport
AS
SELECT     CASE WHEN dbo.AccountEmployee.IsDisabled = 1 THEN dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE dbo.AccountEmployee.FirstName
                       + '' '' + dbo.AccountEmployee.LastName END AS EmployeeName, dbo.AccountProject.ProjectName, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 1 THEN AccountProjectTask_1.TaskName ELSE dbo.AccountTimeOffType.AccountTimeOffType END AS TaskName,
                       dbo.AccountEmployeeTimeEntry.TotalTime, dbo.AccountEmployeeTimeEntry.Approved, dbo.AccountEmployee.AccountEmployeeId, 
                      dbo.AccountProject.AccountProjectId, dbo.AccountEmployeeTimeEntry.TeamLeadApproved, dbo.AccountEmployeeTimeEntry.ProjectManagerApproved, 
                      dbo.AccountEmployeeTimeEntry.AdministratorApproved, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, dbo.AccountEmployeeTimeEntry.StartTime, 
                      dbo.AccountEmployeeTimeEntry.EndTime, dbo.AccountEmployeeTimeEntry.TimeEntryDate, dbo.AccountEmployeeTimeEntry.Description, 
                      ISNULL(dbo.AccountProject.AccountId, dbo.AccountTimeOffType.AccountId) AS AccountId, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime) AS TotalMinutes, DATEPART(dw, dbo.AccountEmployeeTimeEntry.TimeEntryDate) AS WeekDay, 
                      dbo.AccountParty.AccountPartyId, dbo.AccountParty.PartyName, AccountProjectTask_1.AccountProjectTaskId, dbo.AccountBillingType.BillingType, 
                      dbo.AccountProject.LeaderEmployeeId, dbo.AccountProject.ProjectManagerEmployeeId, dbo.AccountProject.TimeSheetApprovalTypeId, 
                      dbo.AccountProject.ExpenseApprovalTypeId, AccountProjectTask_1.IsBillable, dbo.AccountEmployeeTimeEntry.Rejected, dbo.AccountEmployeeTimeEntry.BillingRate, 
                      dbo.AccountProject.ProjectBillingRateTypeId, dbo.AccountEmployee.EmployeeCode, dbo.AccountEmployee.AccountDepartmentId, 
                      dbo.AccountDepartment.DepartmentName, AccountProjectTask_1.EstimatedCost, AccountProjectTask_1.EstimatedTimeSpent, 
                      dbo.AccountEmployeeTimeEntry.Submitted, dbo.AccountWorkType.AccountWorkType, dbo.AccountEmployee.EMailAddress, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountCostCenter.AccountCostCenter, dbo.AccountCostCenter.AccountCostCenterCode, dbo.AccountWorkType.AccountWorkTypeCode, 
                      dbo.AccountProject.ProjectCode, AccountProjectTask_1.TaskCode, dbo.AccountLocation.AccountLocationId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction.Comments, dbo.AccountEmployeeTimeEntry.BillingRateCurrencyId, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateCurrencyId, dbo.AccountEmployeeTimeEntry.BillingRateExchangeRate, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateExchangeRate, dbo.AccountEmployeeTimeEntry.AccountBaseCurrencyId, AccountProjectTask_1.AccountTaskTypeId, 
                      AccountProjectTask_1.TaskStatusId, AccountProjectTask_1.AccountPriorityId, AccountProjectTask_1.AccountProjectMilestoneId, 
                      dbo.AccountDepartment.DepartmentCode, dbo.AccountParty.PartyNick, AccountProjectTask_1.EstimatedCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction.ApprovedOn, dbo.AccountEmployeeTimeEntry.EmployeeRate, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountRole.Role, dbo.AccountProject.AccountProjectTypeId, dbo.AccountProject.ProjectDescription, AccountProjectTask_1.TaskDescription, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeExpenseBillingTimesheetId, dbo.AccountEmployeeTimeEntry.Billed, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Submitted = 1 THEN (CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, 
                      dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS SubmittedHours, CASE WHEN dbo.AccountEmployeeTimeEntry.Approved = 1 THEN (CONVERT(float, 
                      DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS ApprovedHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Rejected = 1 THEN (CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, 
                      dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS RejectedHours, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, 
                      dbo.AccountPartyContact.FirstName + N'' '' + dbo.AccountPartyContact.LastName AS ClientContactName, 
                      dbo.AccountPartyDepartment.PartyDepartmentCode AS ClientDepartmentCode, dbo.AccountPartyDepartment.PartyDepartmentName AS ClientDepartmentName, 
                      dbo.AccountPartyDepartment.PartyDepartmentLocation AS ClientDepartmentLocation, dbo.AccountEmployeeTimeEntry.IsTimeOff, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId, CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 0 THEN (CONVERT(float, DATEPART(hh, 
                      dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS TimeOffHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 1 THEN (CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, 
                      dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS TimesheetHours, dbo.AccountWorkType.AccountWorkTypeId, dbo.AccountStatus.Status AS ProjectStatus, 
                      AccountProjectTask_1.ParentAccountProjectTaskId, dbo.AccountProjectTask.TaskName AS ParentTaskName, dbo.AccountEmployee.IsDisabled, 
                      dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, ISNULL(dbo.AccountEmployeeType.AccountEmployeeType, N'''') AS EmployeeType, 
                      ISNULL(dbo.AccountHolidayTypeDetail.HolidayName, N'''') AS HolidayName, dbo.AccountEmployeeTimeEntry.Percentage, 
                      dbo.AccountEmployeeTimeEntry.CustomField1, dbo.AccountEmployeeTimeEntry.CustomField2, dbo.AccountEmployeeTimeEntry.CustomField3, 
                      dbo.AccountEmployeeTimeEntry.CustomField4, dbo.AccountEmployeeTimeEntry.CustomField5, dbo.AccountEmployeeTimeEntry.CustomField6, 
                      dbo.AccountEmployeeTimeEntry.CustomField7, dbo.AccountEmployeeTimeEntry.CustomField8, dbo.AccountEmployeeTimeEntry.CustomField9, 
                      dbo.AccountEmployeeTimeEntry.CustomField10, dbo.AccountEmployeeTimeEntry.CustomField11, dbo.AccountEmployeeTimeEntry.CustomField12, 
                      dbo.AccountEmployeeTimeEntry.CustomField13, dbo.AccountEmployeeTimeEntry.CustomField14, dbo.AccountEmployeeTimeEntry.CustomField15, 
                      AccountProjectTask_1.StartDate AS TaskStartDate, AccountProjectTask_1.DeadlineDate AS TaskDeadlineDate, dbo.AccountParty.IsDeleted, 
                      CASE WHEN AccountProjectTask_1.IsBillable = 1 THEN (CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, 
                      dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) ELSE 0 END AS BillableHours, AccountProjectTask_1.CustomField1 AS TaskCustomField1, 
                      AccountProjectTask_1.CustomField2 AS TaskCustomField2, AccountProjectTask_1.CustomField3 AS TaskCustomField3, 
                      AccountProjectTask_1.CustomField4 AS TaskCustomField4, AccountProjectTask_1.CustomField5 AS TaskCustomField5, 
                      AccountProjectTask_1.CustomField6 AS TaskCustomField6, AccountProjectTask_1.CustomField7 AS TaskCustomField7, 
                      AccountProjectTask_1.CustomField8 AS TaskCustomField8, AccountProjectTask_1.CustomField9 AS TaskCustomField9, 
                      AccountProjectTask_1.CustomField10 AS TaskCustomField10, AccountProjectTask_1.CustomField11 AS TaskCustomField11, 
                      AccountProjectTask_1.CustomField12 AS TaskCustomField12, AccountProjectTask_1.CustomField13 AS TaskCustomField13, 
                      AccountProjectTask_1.CustomField14 AS TaskCustomField14, AccountProjectTask_1.CustomField15 AS TaskCustomField15
FROM         dbo.AccountHolidayTypeDetail RIGHT OUTER JOIN
                      dbo.AccountEmployeeTimeEntry INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeEntry.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId ON 
                      dbo.AccountHolidayTypeDetail.AccountHolidayTypeId = dbo.AccountEmployee.AccountHolidayTypeId AND 
                      dbo.AccountHolidayTypeDetail.AccountId = dbo.AccountEmployee.AccountId AND 
                      dbo.AccountHolidayTypeDetail.HolidayDate = dbo.AccountEmployeeTimeEntry.TimeEntryDate LEFT OUTER JOIN
                      dbo.AccountEmployeeType ON dbo.AccountEmployee.EmployeePayTypeId = dbo.AccountEmployeeType.AccountEmployeeTypeId LEFT OUTER JOIN
                      dbo.AccountProjectTask AS AccountProjectTask_1 LEFT OUTER JOIN
                      dbo.AccountProjectTask ON AccountProjectTask_1.ParentAccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId ON 
                      dbo.AccountEmployeeTimeEntry.AccountProjectTaskId = AccountProjectTask_1.AccountProjectTaskId LEFT OUTER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountStatus ON dbo.AccountProject.ProjectStatusId = dbo.AccountStatus.AccountStatusId LEFT OUTER JOIN
                      dbo.AccountTimeOffType ON dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId LEFT OUTER JOIN
                      dbo.AccountPartyDepartment ON dbo.AccountProject.AccountPartyDepartmentId = dbo.AccountPartyDepartment.AccountPartyDepartmentId LEFT OUTER JOIN
                      dbo.AccountPartyContact ON dbo.AccountProject.AccountPartyContactId = dbo.AccountPartyContact.AccountPartyContactId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryPeriod ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId LEFT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryApprovalLastAction.AccountEmployeeTimeEntryId LEFT OUTER JOIN
                      dbo.AccountCostCenter ON dbo.AccountEmployeeTimeEntry.AccountCostCenterId = dbo.AccountCostCenter.AccountCostCenterId LEFT OUTER JOIN
                      dbo.AccountWorkType ON dbo.AccountEmployeeTimeEntry.AccountWorkTypeId = dbo.AccountWorkType.AccountWorkTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId LEFT OUTER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId
                      WHERE (dbo.AccountParty.IsDeleted <> 1) OR (dbo.AccountParty.IsDeleted IS NULL)'

GO
-- Create View vueAccountEmployeeTimeEntryForReport
Print 'Create View vueAccountEmployeeTimeEntryForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryForReport
AS
SELECT     dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeName, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskName, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalTime, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Approved, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TeamLeadApproved, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectManagerApproved, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AdministratorApproved, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeTimeEntryId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.StartTime, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EndTime, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Description, N'''') AS Description, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.WeekDay, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountPartyId AS AccountClientId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.PartyName AS ClientName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectTaskId, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingType, N'''') 
                      AS BillingType, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectManagerEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ExpenseApprovalTypeId, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.IsBillable, 0) 
                      AS IsBillable, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Rejected, 0) AS Rejected, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRate, 0) AS BillingRate, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectBillingRateTypeId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeCode, N'''') AS EmployeeCode, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountDepartmentId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.DepartmentName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedCost, 0) AS EstimatedCost, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedTimeSpent, 0) AS EstimatedHours, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Submitted, 0) AS Submitted, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountWorkType, N'''') AS AccountWorkType, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EMailAddress, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountLocation, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountCostCenter, N'''') AS AccountCostCenter, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountCostCenterCode, N'''') AS AccountCostCenterCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountWorkTypeCode, N'''') AS AccountWorkTypeCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectCode, N'''') AS ProjectCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCode, N'''') AS TaskCode, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountLocationId, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Comments, N'''') 
                      AS ApproverComments, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes * dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRate / 60, 0) 
                      AS Amount, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRateCurrencyId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateExchangeRate, 0) AS BillingRateExchangeRate, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRateExchangeRate, 0) AS EmployeeRateExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountBaseCurrencyId, dbo.vueAccountCurrency.CurrencyCode AS BillingRateCurrencyCode, 
                      dbo.vueAccountCurrency.CurrencyCode AS AmountCurrencyCode, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountTaskTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskStatusId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountPriorityId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectMilestoneId, dbo.AccountTaskType.TaskType, dbo.AccountStatus.Status AS TaskStatus, 
                      dbo.AccountProjectMilestone.MilestoneDescription, dbo.AccountPriority.Priority, CONVERT(float, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes) / 60 AS TotalHours, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.DepartmentCode, N'''') AS DepartmentCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.PartyNick, N'''') AS ClientNick, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedCurrencyId, vueAccountCurrency_1.CurrencyCode AS EstimatedCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ApprovedOn, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRate, 0) 
                      AS EmployeeRate, vueAccountCurrency_2.CurrencyCode AS EmployeeRateCurrencyCode, 
                      AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName AS TeamLeader, 
                      AccountEmployee_2.FirstName + '' '' + AccountEmployee_2.LastName AS ProjectManager, 
                      ISNULL(dbo.AccountEmployee.FirstName + N'' '' + dbo.AccountEmployee.LastName, N'''') AS EmployeeManager, 
                      vueAccountCurrency_1.ExchangeRate AS EstimatedCurrencyExchangeRate, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes * dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRate / 60, 0) 
                      AS EmployeeCost, { fn DAYOFMONTH(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) } AS DayNo, 
                      MONTH(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) AS MonthNo, DATEPART(week, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) - DATEPART(week, DATEADD(month, DATEDIFF(month, 0, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate), 0)) + 1 AS WeekNo, 
                      YEAR(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) AS Year, 
                      LEFT({ fn MONTHNAME(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) }, 3) + '' - '' + CONVERT(nvarchar(10), 
                      YEAR(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate)) AS Period, 
                      { fn DAYNAME(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) } AS WeekDayName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountRoleId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Role, 
                      dbo.AccountProjectType.ProjectType, dbo.AccountRole.Role AS ProjectRole, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectDescription, N'''') 
                      AS ProjectDescription, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskDescription, N'''') AS TaskDescription, 
                      dbo.AccountTimeExpenseBilling.InvoiceNumber, dbo.AccountTimeExpenseBilling.InvoiceDate, dbo.AccountProjectType.AccountProjectTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Billed, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeTimeEntryPeriodId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientContactName, N'''') AS ClientContactName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentCode, N'''') AS ClientDepartmentCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentName, N'''') AS ClientDepartmentName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentLocation, N'''') AS ClientDepartmentLocation, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.IsTimeOff, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountWorkTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectStatus, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ParentTaskName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.FirstName, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.LastName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeType, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.HolidayName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField1, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField2, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField3, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField4, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField5, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField6, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField7, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField8, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField9, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField10, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField11, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField12, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField13, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField14, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField15, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskStartDate, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskDeadlineDate, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField1, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField2, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField3, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField4, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField5, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField6, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField7, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField8, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField9, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField10, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField11, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField12, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField13, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField14, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField15
FROM         dbo.AccountRole INNER JOIN
                      dbo.AccountProjectEmployee ON dbo.AccountRole.AccountRoleId = dbo.AccountProjectEmployee.AccountRoleId RIGHT OUTER JOIN
                      dbo.AccountTimeExpenseBillingTimesheet INNER JOIN
                      dbo.AccountTimeExpenseBilling ON 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingId = dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId RIGHT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport LEFT OUTER JOIN
                      dbo.AccountProjectType ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectTypeId = dbo.AccountProjectType.AccountProjectTypeId LEFT OUTER JOIN
                      dbo.AccountProjectMilestone ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectMilestoneId = dbo.AccountProjectMilestone.AccountProjectMilestoneId LEFT OUTER JOIN
                      dbo.AccountStatus ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskStatusId = dbo.AccountStatus.AccountStatusId LEFT OUTER JOIN
                      dbo.AccountPriority ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountPriorityId = dbo.AccountPriority.AccountPriorityId LEFT OUTER JOIN
                      dbo.AccountTaskType ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountTaskTypeId = dbo.AccountTaskType.AccountTaskTypeId ON 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingTimesheetId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountTimeExpenseBillingTimesheetId
                       ON dbo.AccountProjectEmployee.AccountEmployeeId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeId AND 
                      dbo.AccountProjectEmployee.AccountProjectId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.LeaderEmployeeId = AccountEmployee_1.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_2 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectManagerEmployeeId = AccountEmployee_2.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.AccountEmployee AS AccountEmployee_3 ON dbo.AccountEmployee.AccountEmployeeId = AccountEmployee_3.EmployeeManagerId ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeId = AccountEmployee_3.AccountEmployeeId LEFT OUTER JOIN
                      dbo.vueAccountCurrency AS vueAccountCurrency_2 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRateCurrencyId = vueAccountCurrency_2.AccountCurrencyId LEFT OUTER JOIN
                      dbo.vueAccountCurrency AS vueAccountCurrency_1 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedCurrencyId = vueAccountCurrency_1.AccountCurrencyId LEFT OUTER JOIN
                      dbo.vueAccountCurrency ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateCurrencyId = dbo.vueAccountCurrency.AccountCurrencyId'




GO
-- Create View vueAccountEmployeeTimeEntryPeriodForReport
Print 'Create View vueAccountEmployeeTimeEntryPeriodForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryPeriodForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryPeriodForReport
AS
SELECT     dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId, dbo.AccountEmployeeTimeEntryPeriod.AccountId, 
                      dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeId, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, 
                      dbo.AccountEmployeeTimeEntryPeriod.Submitted, dbo.AccountEmployeeTimeEntryPeriod.Approved, dbo.AccountEmployeeTimeEntryPeriod.Rejected, 
                      dbo.AccountEmployeeTimeEntryPeriod.InApproval, dbo.AccountEmployeeTimeEntryPeriod.SubmittedDate, dbo.vueAccountEmployee.EmployeeName, 
                      dbo.vueAccountEmployee.AccountLocationId, dbo.vueAccountEmployee.AccountDepartmentId, dbo.vueAccountEmployee.AccountLocation, 
                      dbo.vueAccountEmployee.Role, dbo.vueAccountEmployee.DepartmentName, dbo.vueAccountEmployee.EMailAddress, dbo.vueAccountEmployee.AccountRoleId, 
                      CASE WHEN AccountEmployeeTimeEntryPeriod.Submitted = 1 AND 
                      AccountEmployeeTimeEntryPeriod.Approved = 0 THEN ''Submitted'' WHEN AccountEmployeeTimeEntryPeriod.Approved = 1 THEN ''Approved'' WHEN AccountEmployeeTimeEntryPeriod.Rejected
                       = 1 THEN ''Rejected'' WHEN AccountEmployeeTimeEntryPeriod.Submitted = 0 AND AccountEmployeeTimeEntryPeriod.Approved = 0 AND 
                      AccountEmployeeTimeEntryPeriod.Rejected = 0 THEN ''Not Submitted'' END AS ApprovalStatus, 
                      { fn DAYOFMONTH(dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate) } AS DayNo, MONTH(dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate) 
                      AS MonthNo, DATEPART(week, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate) - DATEPART(week, DATEADD(month, DATEDIFF(month, 0, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate), 0)) + 1 AS WeekNo, YEAR(dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate) AS Year, 
                      LEFT({ fn MONTHNAME(dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate) }, 3) + '' - '' + CONVERT(nvarchar(10), 
                      YEAR(dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate)) AS Period, { fn DAYNAME(dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate) 
                      } AS WeekDayName, SUM(CONVERT(float, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes) / 60) AS TotalHours, 
                      SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes * dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRate / 60, 0)) 
                      AS Amount, SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRate, 0)) AS BillingRate, 
                      SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.SubmittedHours, 0)) AS SubmittedHours, 
                      SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ApprovedHours, 0)) AS ApprovedHours, 
                      SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.RejectedHours, 0)) AS RejectedHours, ISNULL(dbo.vueAccountEmployee.EmployeeCode, '''') 
                      AS EmployeeCode, SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateExchangeRate, 0)) AS BillingRateExchangeRate, 
                      dbo.AccountEmployeeTimeEntryPeriod.ApprovedOn, dbo.AccountEmployeeTimeEntryPeriod.RejectedOn, 
                      dbo.AccountEmployeeTimeEntryPeriod.ApprovedByEmployeeId, dbo.AccountEmployeeTimeEntryPeriod.RejectedByEmployeeId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientContactName, N'''') AS ClientContactName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentCode, N'''') AS ClientDepartmentCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentName, N'''') AS ClientDepartmentName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentLocation, N'''') AS ClientDepartmentLocation, 
                      SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeOffHours, 0)) AS TimeOffHours, 
                      SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimesheetHours, 0)) AS TimesheetHours, 
                      SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Percentage, 0)) AS Percentage, 
                      SUM(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillableHours) AS BillableTotalHours
FROM         dbo.AccountEmployeeTimeEntryPeriod INNER JOIN
                      dbo.vueAccountEmployee ON dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeId = dbo.vueAccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport ON 
                      dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeTimeEntryPeriodId
GROUP BY dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId, dbo.AccountEmployeeTimeEntryPeriod.AccountId, 
                      dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeId, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, 
                      dbo.AccountEmployeeTimeEntryPeriod.Submitted, dbo.AccountEmployeeTimeEntryPeriod.Approved, dbo.AccountEmployeeTimeEntryPeriod.Rejected, 
                      dbo.AccountEmployeeTimeEntryPeriod.InApproval, dbo.AccountEmployeeTimeEntryPeriod.SubmittedDate, dbo.vueAccountEmployee.EmployeeName, 
                      dbo.vueAccountEmployee.AccountLocationId, dbo.vueAccountEmployee.AccountDepartmentId, dbo.vueAccountEmployee.AccountLocation, 
                      dbo.vueAccountEmployee.Role, dbo.vueAccountEmployee.DepartmentName, dbo.vueAccountEmployee.EMailAddress, dbo.vueAccountEmployee.AccountRoleId, 
                      dbo.vueAccountEmployee.EmployeeCode, dbo.AccountEmployeeTimeEntryPeriod.ApprovedOn, dbo.AccountEmployeeTimeEntryPeriod.RejectedOn, 
                      dbo.AccountEmployeeTimeEntryPeriod.ApprovedByEmployeeId, dbo.AccountEmployeeTimeEntryPeriod.RejectedByEmployeeId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientContactName, N''''), 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentCode, N''''), 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentName, N''''), 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentLocation, N'''')'

GO
-- Create View rptvueAccountEmployeeTimeEntryPeriod
Print 'Create View rptvueAccountEmployeeTimeEntryPeriod'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeEntryPeriod' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountEmployeeTimeEntryPeriod
AS
SELECT     dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountEmployeeTimeEntryPeriodId, dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountId, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountEmployeeId, dbo.vueAccountEmployeeTimeEntryPeriodForReport.TimeEntryStartDate, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.TimeEntryEndDate, dbo.vueAccountEmployeeTimeEntryPeriodForReport.TimeEntryViewType, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.Submitted, dbo.vueAccountEmployeeTimeEntryPeriodForReport.Approved, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.Rejected, dbo.vueAccountEmployeeTimeEntryPeriodForReport.InApproval, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.SubmittedDate, dbo.vueAccountEmployeeTimeEntryPeriodForReport.EmployeeName, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountLocationId, dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountDepartmentId, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountLocation, dbo.vueAccountEmployeeTimeEntryPeriodForReport.Role, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.DepartmentName, dbo.vueAccountEmployeeTimeEntryPeriodForReport.EMailAddress, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountRoleId, dbo.vueAccountEmployeeTimeEntryPeriodForReport.ApprovalStatus, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.DayNo, dbo.vueAccountEmployeeTimeEntryPeriodForReport.MonthNo, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.WeekNo, dbo.vueAccountEmployeeTimeEntryPeriodForReport.Year, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.Period, dbo.vueAccountEmployeeTimeEntryPeriodForReport.WeekDayName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryPeriodForReport.TotalHours, 0) AS TotalHours, dbo.vueAccountEmployeeTimeEntryPeriodForReport.Amount, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.BillingRate, dbo.vueAccountEmployeeTimeEntryPeriodForReport.SubmittedHours, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.ApprovedHours, dbo.vueAccountEmployeeTimeEntryPeriodForReport.RejectedHours, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.EmployeeCode, 
                      CASE WHEN BillingRateExchangeRate > 0 THEN Amount / BillingRateExchangeRate ELSE 0 END AS CurrencyAmount, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryPeriodForReport.Approved = 1 THEN dbo.vueAccountEmployeeTimeEntryPeriodForReport.ApprovedOn ELSE NULL 
                      END AS ApprovedDate, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryPeriodForReport.Rejected = 1 THEN dbo.vueAccountEmployeeTimeEntryPeriodForReport.RejectedOn ELSE NULL 
                      END AS RejectedDate, AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName AS ApprovedByEmployeeName, 
                      dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS RejectedByEmployeeName, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.ClientContactName, dbo.vueAccountEmployeeTimeEntryPeriodForReport.ClientDepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.ClientDepartmentName, dbo.vueAccountEmployeeTimeEntryPeriodForReport.ClientDepartmentLocation, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.TimeOffHours, dbo.vueAccountEmployeeTimeEntryPeriodForReport.TimesheetHours, 
                      dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, dbo.AccountWorkingDayType.MinimumHoursPerWeek, 
                      dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay, 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.Percentage, dbo.vueAccountEmployeeTimeEntryPeriodForReport.BillableTotalHours
FROM         dbo.AccountWorkingDayType RIGHT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport ON 
                      dbo.AccountWorkingDayType.AccountId = dbo.vueAccountEmployeeTimeEntryPeriodForReport.AccountId LEFT OUTER JOIN
                      dbo.AccountEmployee ON dbo.vueAccountEmployeeTimeEntryPeriodForReport.RejectedByEmployeeId = dbo.AccountEmployee.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON 
                      dbo.vueAccountEmployeeTimeEntryPeriodForReport.ApprovedByEmployeeId = AccountEmployee_1.AccountEmployeeId'


GO
-- Create View rptvueAccountEmployeeTimeEntry
Print 'Create View rptvueAccountEmployeeTimeEntry'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeEntry' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountEmployeeTimeEntry
AS
SELECT     dbo.vueAccountEmployeeTimeEntryForReport.EmployeeName, dbo.vueAccountEmployeeTimeEntryForReport.ProjectName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskName, dbo.vueAccountEmployeeTimeEntryForReport.TotalTime, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Approved, dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectId, dbo.vueAccountEmployeeTimeEntryForReport.TeamLeadApproved, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManagerApproved, dbo.vueAccountEmployeeTimeEntryForReport.AdministratorApproved, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeTimeEntryId, dbo.vueAccountEmployeeTimeEntryForReport.StartTime, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EndTime, dbo.vueAccountEmployeeTimeEntryForReport.TimeEntryDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Description, dbo.vueAccountEmployeeTimeEntryForReport.AccountId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TotalMinutes, dbo.vueAccountEmployeeTimeEntryForReport.WeekDay, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientName, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectTaskId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingType, dbo.vueAccountEmployeeTimeEntryForReport.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManagerEmployeeId, dbo.vueAccountEmployeeTimeEntryForReport.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ExpenseApprovalTypeId, dbo.vueAccountEmployeeTimeEntryForReport.IsBillable, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Rejected, dbo.vueAccountEmployeeTimeEntryForReport.BillingRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectBillingRateTypeId, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountDepartmentId, dbo.vueAccountEmployeeTimeEntryForReport.DepartmentName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCost, dbo.vueAccountEmployeeTimeEntryForReport.EstimatedHours, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Submitted, dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkType, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EMailAddress, dbo.vueAccountEmployeeTimeEntryForReport.AccountLocation, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountCostCenter, dbo.vueAccountEmployeeTimeEntryForReport.AccountCostCenterCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkTypeCode, dbo.vueAccountEmployeeTimeEntryForReport.ProjectCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCode, dbo.vueAccountEmployeeTimeEntryForReport.AccountLocationId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ApproverComments, dbo.vueAccountEmployeeTimeEntryForReport.Amount, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingRateCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountBaseCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.BillingRateCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AmountCurrencyCode, CASE WHEN vueAccountEmployeeTimeEntryForReport.Submitted = 1 AND 
                      vueAccountEmployeeTimeEntryForReport.Approved = 0 THEN ''Submitted'' WHEN vueAccountEmployeeTimeEntryForReport.Approved = 1 THEN ''Approved'' WHEN vueAccountEmployeeTimeEntryForReport.Rejected
                       = 1 THEN ''Rejected'' WHEN vueAccountEmployeeTimeEntryForReport.Submitted = 0 AND vueAccountEmployeeTimeEntryForReport.Approved = 0 AND 
                      vueAccountEmployeeTimeEntryForReport.Rejected = 0 THEN ''Not Submitted'' END AS ApprovalStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountTaskTypeId, dbo.vueAccountEmployeeTimeEntryForReport.TaskStatusId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountPriorityId, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectMilestoneId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskType, dbo.vueAccountEmployeeTimeEntryForReport.TaskStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.MilestoneDescription, dbo.vueAccountEmployeeTimeEntryForReport.Priority, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TotalHours, dbo.vueAccountEmployeeTimeEntryForReport.DepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientNick, dbo.vueAccountEmployeeTimeEntryForReport.AccountClientId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ApprovedOn, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateCurrencyCode, dbo.vueAccountEmployeeTimeEntryForReport.TeamLeader, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManager, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeManager, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate, 0) AS EstimatedCurrencyExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCost, dbo.vueAccountEmployeeTimeEntryForReport.AccountRoleId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Role, dbo.vueAccountEmployeeTimeEntryForReport.WeekDayName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Period, dbo.vueAccountEmployeeTimeEntryForReport.Year, dbo.vueAccountEmployeeTimeEntryForReport.WeekNo, 
                      dbo.vueAccountEmployeeTimeEntryForReport.MonthNo, dbo.vueAccountEmployeeTimeEntryForReport.DayNo, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 1 THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours ELSE 0 END AS BillableTotalHours,
                       CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable
                       IS NULL THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours ELSE 0 END AS NonBillableTotalHours, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCost / dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate
                       ELSE 0 END AS CurrencyEmployeeCost, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.Amount / dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate
                       ELSE 0 END AS CurrencyAmount, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCost / dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate
                       ELSE 0 END AS CurrencyEstimatedCost, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate / dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate
                       ELSE 0 END AS CurrencyBillingRate, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRate / dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate
                       ELSE 0 END AS CurrencyEmployeeRate, dbo.vueAccountEmployeeTimeEntryForReport.ProjectRole, dbo.vueAccountEmployeeTimeEntryForReport.ProjectType, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectDescription, dbo.vueAccountEmployeeTimeEntryForReport.TaskDescription, 
                      dbo.vueAccountEmployeeTimeEntryForReport.InvoiceNumber, dbo.vueAccountEmployeeTimeEntryForReport.InvoiceDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectTypeId, dbo.vueAccountEmployeeTimeEntryForReport.Billed, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientContactName, dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentName, dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentLocation, 
                      dbo.vueAccountEmployeeTimeEntryForReport.IsTimeOff, dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkTypeId, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 1 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate * dbo.vueAccountEmployeeTimeEntryForReport.TotalHours
                       ELSE 0 END AS BillableTotalAmount, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate * dbo.vueAccountEmployeeTimeEntryForReport.TotalHours
                       ELSE 0 END AS NonBillableTotalAmount, dbo.vueAccountEmployeeTimeEntryForReport.ProjectStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ParentTaskName, dbo.vueAccountEmployeeTimeEntryForReport.FirstName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.LastName, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeType, 
                      dbo.vueAccountEmployeeTimeEntryForReport.HolidayName, SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithLastStatus.Percentage, 0)) AS Percentage, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField1, dbo.vueAccountEmployeeTimeEntryForReport.CustomField2, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField3, dbo.vueAccountEmployeeTimeEntryForReport.CustomField4, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField5, dbo.vueAccountEmployeeTimeEntryForReport.CustomField6, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField7, dbo.vueAccountEmployeeTimeEntryForReport.CustomField8, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField9, dbo.vueAccountEmployeeTimeEntryForReport.CustomField10, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField11, dbo.vueAccountEmployeeTimeEntryForReport.CustomField12, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField13, dbo.vueAccountEmployeeTimeEntryForReport.CustomField14, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField15, dbo.vueAccountEmployeeTimeEntryForReport.TaskStartDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskDeadlineDate, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField1, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField2, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField3, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField4, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField5, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField6, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField7, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField8, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField9, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField10, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField11, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField12, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField13, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField14, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField15
FROM         dbo.vueAccountEmployeeTimeEntryForReport INNER JOIN
                      dbo.vueAccountEmployeeTimeEntryWithLastStatus ON 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryWithLastStatus.AccountEmployeeTimeEntryId
GROUP BY dbo.vueAccountEmployeeTimeEntryForReport.EmployeeName, dbo.vueAccountEmployeeTimeEntryForReport.ProjectName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskName, dbo.vueAccountEmployeeTimeEntryForReport.TotalTime, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeId, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeTimeEntryId, dbo.vueAccountEmployeeTimeEntryForReport.StartTime, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EndTime, dbo.vueAccountEmployeeTimeEntryForReport.TimeEntryDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Description, dbo.vueAccountEmployeeTimeEntryForReport.AccountId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TotalMinutes, dbo.vueAccountEmployeeTimeEntryForReport.WeekDay, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientName, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectTaskId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingType, dbo.vueAccountEmployeeTimeEntryForReport.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManagerEmployeeId, dbo.vueAccountEmployeeTimeEntryForReport.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ExpenseApprovalTypeId, dbo.vueAccountEmployeeTimeEntryForReport.BillingRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectBillingRateTypeId, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountDepartmentId, dbo.vueAccountEmployeeTimeEntryForReport.DepartmentName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCost, dbo.vueAccountEmployeeTimeEntryForReport.EstimatedHours, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkType, dbo.vueAccountEmployeeTimeEntryForReport.EMailAddress, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountLocation, dbo.vueAccountEmployeeTimeEntryForReport.AccountCostCenter, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountCostCenterCode, dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkTypeCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectCode, dbo.vueAccountEmployeeTimeEntryForReport.TaskCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountLocationId, dbo.vueAccountEmployeeTimeEntryForReport.ApproverComments, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Amount, dbo.vueAccountEmployeeTimeEntryForReport.BillingRateCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate, dbo.vueAccountEmployeeTimeEntryForReport.AccountBaseCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingRateCurrencyCode, dbo.vueAccountEmployeeTimeEntryForReport.AmountCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountTaskTypeId, dbo.vueAccountEmployeeTimeEntryForReport.TaskStatusId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountPriorityId, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectMilestoneId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskType, dbo.vueAccountEmployeeTimeEntryForReport.TaskStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.MilestoneDescription, dbo.vueAccountEmployeeTimeEntryForReport.Priority, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TotalHours, dbo.vueAccountEmployeeTimeEntryForReport.DepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientNick, dbo.vueAccountEmployeeTimeEntryForReport.AccountClientId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ApprovedOn, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateCurrencyCode, dbo.vueAccountEmployeeTimeEntryForReport.TeamLeader, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManager, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeManager, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate, 0), dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCost, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountRoleId, dbo.vueAccountEmployeeTimeEntryForReport.Role, 
                      dbo.vueAccountEmployeeTimeEntryForReport.WeekDayName, dbo.vueAccountEmployeeTimeEntryForReport.Period, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Year, dbo.vueAccountEmployeeTimeEntryForReport.WeekNo, dbo.vueAccountEmployeeTimeEntryForReport.MonthNo, 
                      dbo.vueAccountEmployeeTimeEntryForReport.DayNo, dbo.vueAccountEmployeeTimeEntryForReport.ProjectRole, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectType, dbo.vueAccountEmployeeTimeEntryForReport.ProjectDescription, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskDescription, dbo.vueAccountEmployeeTimeEntryForReport.InvoiceNumber, 
                      dbo.vueAccountEmployeeTimeEntryForReport.InvoiceDate, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectTypeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientContactName, dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentName, dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentLocation, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkTypeId, dbo.vueAccountEmployeeTimeEntryForReport.ProjectStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ParentTaskName, dbo.vueAccountEmployeeTimeEntryForReport.FirstName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.LastName, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeType, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Approved, dbo.vueAccountEmployeeTimeEntryForReport.TeamLeadApproved, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManagerApproved, dbo.vueAccountEmployeeTimeEntryForReport.AdministratorApproved, 
                      dbo.vueAccountEmployeeTimeEntryForReport.IsBillable, dbo.vueAccountEmployeeTimeEntryForReport.Rejected, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Submitted, dbo.vueAccountEmployeeTimeEntryForReport.Billed, 
                      dbo.vueAccountEmployeeTimeEntryForReport.IsTimeOff, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate * dbo.vueAccountEmployeeTimeEntryForReport.TotalHours
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 1 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate * dbo.vueAccountEmployeeTimeEntryForReport.TotalHours
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRate / dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate / dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCost / dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.Amount / dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCost / dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable
                       IS NULL THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 1 THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours ELSE 0 END, 
                      CASE WHEN vueAccountEmployeeTimeEntryForReport.Submitted = 1 AND 
                      vueAccountEmployeeTimeEntryForReport.Approved = 0 THEN ''Submitted'' WHEN vueAccountEmployeeTimeEntryForReport.Approved = 1 THEN ''Approved'' WHEN vueAccountEmployeeTimeEntryForReport.Rejected
                       = 1 THEN ''Rejected'' WHEN vueAccountEmployeeTimeEntryForReport.Submitted = 0 AND vueAccountEmployeeTimeEntryForReport.Approved = 0 AND 
                      vueAccountEmployeeTimeEntryForReport.Rejected = 0 THEN ''Not Submitted'' END, dbo.vueAccountEmployeeTimeEntryForReport.HolidayName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField1, dbo.vueAccountEmployeeTimeEntryForReport.CustomField2, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField3, dbo.vueAccountEmployeeTimeEntryForReport.CustomField4, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField5, dbo.vueAccountEmployeeTimeEntryForReport.CustomField6, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField7, dbo.vueAccountEmployeeTimeEntryForReport.CustomField8, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField9, dbo.vueAccountEmployeeTimeEntryForReport.CustomField10, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField11, dbo.vueAccountEmployeeTimeEntryForReport.CustomField12, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField13, dbo.vueAccountEmployeeTimeEntryForReport.CustomField14, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField15, dbo.vueAccountEmployeeTimeEntryForReport.TaskStartDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskDeadlineDate, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField1, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField2, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField3, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField4, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField5, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField6, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField7, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField8, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField9, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField10, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField11, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField12, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField13, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField14, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField15'
                      
GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'
If Not Exists(Select * from [dbo].[SystemReportDataSourceField] Where [SystemReportDataSourceFieldId] = '8e77de39-dbae-44b1-89be-0688196b1520')
BEGIN
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('8e77de39-dbae-44b1-89be-0688196b1520', '3a080202-6842-4eca-8c79-a945978810b4', N'TaskCustomField15', 100, 0, NULL, NULL, 314, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Task Custom Field 15', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('0f4937c7-50e7-4e04-bc92-45230417ffe8', '3a080202-6842-4eca-8c79-a945978810b4', N'TaskCustomField10', 100, 0, NULL, NULL, 309, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Task Custom Field 10', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('b7c7615e-2d26-46f3-af11-0dda8e413787', '3a080202-6842-4eca-8c79-a945978810b4', N'TaskCustomField3', 100, 0, NULL, NULL, 302, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Task Custom Field 3', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('cd7b93bf-663a-4aab-a663-101af1dc6743', '3a080202-6842-4eca-8c79-a945978810b4', N'TaskCustomField2', 100, 0, NULL, NULL, 301, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Task Custom Field 2', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('38e4a891-814f-4af5-bd81-fa55ddc729b2', '3a080202-6842-4eca-8c79-a945978810b4', N'TaskCustomField6', 100, 0, NULL, NULL, 305, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Task Custon Field 6', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('a923fdb0-cc3f-4a9b-b861-776011d1e5f3', '3a080202-6842-4eca-8c79-a945978810b4', N'TaskCustomField1', 100, 0, NULL, NULL, 300, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Task Custom Field 1', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('b78828f1-64c8-4a96-a264-a1f07d125506', '3a080202-6842-4eca-8c79-a945978810b4', N'TaskCustomField14', 100, 0, NULL, NULL, 313, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Task Custom Field 14', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('48bd9e59-acd1-4da9-9a33-6cae03bd1108', '3a080202-6842-4eca-8c79-a945978810b4', N'TaskCustomField11', 100, 0, NULL, NULL, 310, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Task Custom Field 11', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('11fb9870-62af-4d07-9c61-4a65c8766b56', '3a080202-6842-4eca-8c79-a945978810b4', N'TaskCustomField12', 100, 0, NULL, NULL, 311, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Task Custom Field 12', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('eded696a-174b-4ae5-af39-85bf526d387d', '3a080202-6842-4eca-8c79-a945978810b4', N'TaskCustomField5', 100, 0, NULL, NULL, 304, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Task Custom Field 5', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('af1adeb4-77da-4347-ba00-03146c8c7c44', '3a080202-6842-4eca-8c79-a945978810b4', N'TaskCustomField9', 100, 0, NULL, NULL, 308, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Task Custom Field 9', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('bc685a64-991d-44d0-98cf-08d3222f4b4e', '3a080202-6842-4eca-8c79-a945978810b4', N'TaskCustomField8', 100, 0, NULL, NULL, 307, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Task Custiom Field 8', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('6d9585bb-8f1c-4575-956d-3dfc4f780cb9', '3a080202-6842-4eca-8c79-a945978810b4', N'TaskCustomField13', 100, 0, NULL, NULL, 312, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Task Custom Field 13', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('c381751a-7877-465e-a5ea-49a43fdbf4d1', '3a080202-6842-4eca-8c79-a945978810b4', N'TaskCustomField4', 100, 0, NULL, NULL, 303, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Task Custom Field 4', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('a249b4cf-6ea0-4c16-a811-7f1bf6b47e5c', '3a080202-6842-4eca-8c79-a945978810b4', N'TaskCustomField7', 100, 0, NULL, NULL, 306, '91402610-eef0-4dd0-aca3-0080f53389fa', N'Task Custom Field 7', 0, 0)
END


GO
-- Drop View vueAccountProjectTaskForReport
Print 'Drop View vueAccountProjectTaskForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountProjectTaskForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountProjectTaskForReport]

GO
-- Drop View vueAccountProjectTaskOnlyForReport
Print 'Drop View vueAccountProjectTaskOnlyForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountProjectTaskOnlyForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountProjectTaskOnlyForReport]

GO
-- Drop View rptvueAccountProjectTasks
Print 'Drop View rptvueAccountProjectTasks'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectTasks' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountProjectTasks]

GO
-- Create View vueAccountProjectTaskForReport
Print 'Create View vueAccountProjectTaskForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountProjectTaskForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountProjectTaskForReport
AS
SELECT     dbo.vueAccountProjectTask.AccountProjectTaskId, dbo.vueAccountProjectTask.AccountProjectId, dbo.vueAccountProjectTask.ParentAccountProjectTaskId, 
                      dbo.vueAccountProjectTask.TaskName, dbo.vueAccountProjectTask.TaskDescription, dbo.vueAccountProjectTask.AccountTaskTypeId, 
                      dbo.vueAccountProjectTask.DeadlineDate, dbo.vueAccountProjectTask.CompletedPercent, dbo.vueAccountProjectTask.Completed, 
                      dbo.vueAccountProjectTask.IsParentTask, dbo.vueAccountProjectTask.IsForAllEmployees, dbo.vueAccountProjectTask.AccountPriorityId, 
                      dbo.vueAccountProjectTask.TaskStatusId, dbo.vueAccountProjectTask.CreatedOn, dbo.vueAccountProjectTask.CreatedByEmployeeId, 
                      dbo.vueAccountProjectTask.ModifiedOn, dbo.vueAccountProjectTask.ModifiedByEmployeeId, dbo.vueAccountProjectTask.TaskStatus, 
                      dbo.vueAccountProjectTask.CreatedByFirstName, dbo.vueAccountProjectTask.CreatedByLastName, dbo.vueAccountProjectTask.Priority, 
                      dbo.vueAccountProjectTask.ProjectName, dbo.vueAccountProjectTask.ProjectCode, dbo.vueAccountProjectTask.TaskType, dbo.vueAccountProjectTask.AccountId, 
                      dbo.vueAccountProjectTask.AccountProjectMilestoneId, dbo.vueAccountProjectTask.MilestoneDescription, dbo.vueAccountProjectTask.IsReOpen, 
                      dbo.vueAccountProjectTask.ModifiedByFirstName, dbo.vueAccountProjectTask.ModifiedByLastName, dbo.vueAccountProjectTask.EstimatedCost, 
                      dbo.vueAccountProjectTask.EstimatedTimeSpent AS EstimatedHours, dbo.vueAccountProjectTask.EstimatedTimeSpentUnit, 
                      dbo.vueAccountProjectTask.AccountEmployeeId, dbo.vueAccountProjectTask.IsDisabled, dbo.vueAccountProjectTask.TaskCode, 
                      dbo.vueAccountProjectTask.IsTemplate, dbo.vueAccountProjectTask.IsForAllProjectTask, dbo.vueAccountProjectTask.IsBillable, 
                      dbo.AccountParty.AccountPartyId AS AccountClientId, dbo.AccountParty.PartyNick AS ClientNick, dbo.AccountParty.PartyName AS ClientName, CONVERT(nvarchar(200), 
                      dbo.vueAccountProjectTask.Duration) + '' - '' + dbo.vueAccountProjectTask.DurationUnit AS Duration, dbo.AccountProjectTask.TaskName AS ParentTaskName, 
                      dbo.vueAccountProjectTask.EstimatedCurrencyId, dbo.vueAccountCurrency.CurrencyCode AS EstimatedCurrencyCode, dbo.vueAccountProjectTask.ProjectDescription, 
                      dbo.vueAccountProjectTask.MilestoneDate, dbo.vueAccountProjectTask.StartDate, dbo.AccountParty.IsDeleted, dbo.vueAccountProjectTask.CustomField1, 
                      dbo.vueAccountProjectTask.CustomField2, dbo.vueAccountProjectTask.CustomField3, dbo.vueAccountProjectTask.CustomField4, 
                      dbo.vueAccountProjectTask.CustomField5, dbo.vueAccountProjectTask.CustomField6, dbo.vueAccountProjectTask.CustomField7, 
                      dbo.vueAccountProjectTask.CustomField8, dbo.vueAccountProjectTask.CustomField9, dbo.vueAccountProjectTask.CustomField10, 
                      dbo.vueAccountProjectTask.CustomField11, dbo.vueAccountProjectTask.CustomField12, dbo.vueAccountProjectTask.CustomField13, 
                      dbo.vueAccountProjectTask.CustomField14, dbo.vueAccountProjectTask.CustomField15
FROM         dbo.vueAccountProjectTask INNER JOIN
                      dbo.AccountProject ON dbo.vueAccountProjectTask.AccountProjectId = dbo.AccountProject.AccountProjectId INNER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId LEFT OUTER JOIN
                      dbo.vueAccountCurrency ON dbo.vueAccountProjectTask.EstimatedCurrencyId = dbo.vueAccountCurrency.AccountCurrencyId LEFT OUTER JOIN
                      dbo.AccountProjectTask ON dbo.vueAccountProjectTask.ParentAccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId
WHERE     (dbo.AccountParty.IsDeleted <> 1) OR
                      (dbo.AccountParty.IsDeleted IS NULL)'
                      

GO
-- Create View vueAccountProjectTaskOnlyForReport
Print 'Create View vueAccountProjectTaskOnlyForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountProjectTaskOnlyForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountProjectTaskOnlyForReport
AS
SELECT     dbo.vueAccountProjectTaskForReport.AccountProjectTaskId, dbo.vueAccountProjectTaskForReport.AccountProjectId, 
                      dbo.vueAccountProjectTaskForReport.ParentAccountProjectTaskId, dbo.vueAccountProjectTaskForReport.TaskName, 
                      dbo.vueAccountProjectTaskForReport.TaskDescription, dbo.vueAccountProjectTaskForReport.AccountTaskTypeId, dbo.vueAccountProjectTaskForReport.DeadlineDate, 
                      dbo.vueAccountProjectTaskForReport.CompletedPercent, dbo.vueAccountProjectTaskForReport.Completed, dbo.vueAccountProjectTaskForReport.IsParentTask, 
                      dbo.vueAccountProjectTaskForReport.IsForAllEmployees, dbo.vueAccountProjectTaskForReport.AccountPriorityId, dbo.vueAccountProjectTaskForReport.TaskStatusId, 
                      dbo.vueAccountProjectTaskForReport.CreatedOn, dbo.vueAccountProjectTaskForReport.CreatedByEmployeeId, dbo.vueAccountProjectTaskForReport.ModifiedOn, 
                      dbo.vueAccountProjectTaskForReport.ModifiedByEmployeeId, dbo.vueAccountProjectTaskForReport.TaskStatus, 
                      dbo.vueAccountProjectTaskForReport.CreatedByFirstName, dbo.vueAccountProjectTaskForReport.CreatedByLastName, dbo.vueAccountProjectTaskForReport.Priority, 
                      dbo.vueAccountProjectTaskForReport.ProjectName, ISNULL(dbo.vueAccountProjectTaskForReport.ProjectCode, N'''') AS ProjectCode, 
                      dbo.vueAccountProjectTaskForReport.TaskType, dbo.vueAccountProjectTaskForReport.AccountId, dbo.vueAccountProjectTaskForReport.AccountProjectMilestoneId, 
                      dbo.vueAccountProjectTaskForReport.MilestoneDescription, dbo.vueAccountProjectTaskForReport.IsReOpen, 
                      dbo.vueAccountProjectTaskForReport.ModifiedByFirstName, dbo.vueAccountProjectTaskForReport.ModifiedByLastName, 
                      ISNULL(dbo.vueAccountProjectTaskForReport.EstimatedCost, 0) AS EstimatedCost, ISNULL(dbo.vueAccountProjectTaskForReport.EstimatedHours, 0) 
                      AS EstimatedHours, dbo.vueAccountProjectTaskForReport.EstimatedTimeSpentUnit, dbo.vueAccountProjectTaskForReport.AccountEmployeeId, 
                      dbo.vueAccountProjectTaskForReport.IsDisabled, ISNULL(dbo.vueAccountProjectTaskForReport.TaskCode, N'''') AS TaskCode, 
                      dbo.vueAccountProjectTaskForReport.IsTemplate, ISNULL(dbo.vueAccountProjectTaskForReport.IsForAllProjectTask, 0) AS IsForAllProjectTask, 
                      ISNULL(dbo.vueAccountProjectTaskForReport.IsBillable, 0) AS IsBillable, dbo.vueAccountProjectTaskForReport.AccountClientId, 
                      ISNULL(dbo.vueAccountProjectTaskForReport.ClientNick, N'''') AS ClientNick, dbo.vueAccountProjectTaskForReport.ClientName, 
                      dbo.vueAccountProjectTaskForReport.Duration, ISNULL(dbo.vueAccountProjectTaskForReport.ParentTaskName, N'''') AS ParentTaskName, 
                      SUM(ISNULL(dbo.rptvueAccountEmployeeTimeEntry.BillableTotalHours, 0)) AS BillableTotalHours, 
                      SUM(ISNULL(dbo.rptvueAccountEmployeeTimeEntry.NonBillableTotalHours, 0)) AS NonBillableTotalHours, dbo.vueAccountProjectTaskForReport.EstimatedCurrencyId, 
                      dbo.vueAccountProjectTaskForReport.EstimatedCurrencyCode, SUM(ISNULL(dbo.rptvueAccountEmployeeTimeEntry.TotalHours, 0)) AS TotalHours, 
                      SUM(ISNULL(dbo.rptvueAccountEmployeeTimeEntry.CurrencyEmployeeCost, 0)) AS CurrencyEmployeeCost, ISNULL(dbo.vueAccountCurrency.ExchangeRate, 0) 
                      AS EstimatedCurrencyExchangeRate, SUM(ISNULL(dbo.rptvueAccountEmployeeTimeEntry.CurrencyAmount, 0)) AS CurrencyAmount, 
                      ISNULL(dbo.vueAccountProjectTaskForReport.ProjectDescription, N'''') AS ProjectDescription, dbo.vueAccountProjectTaskForReport.MilestoneDate, 
                      dbo.vueAccountProjectTaskForReport.StartDate, dbo.vueAccountProjectTaskForReport.CustomField1, dbo.vueAccountProjectTaskForReport.CustomField2, 
                      dbo.vueAccountProjectTaskForReport.CustomField3, dbo.vueAccountProjectTaskForReport.CustomField4, dbo.vueAccountProjectTaskForReport.CustomField5, 
                      dbo.vueAccountProjectTaskForReport.CustomField6, dbo.vueAccountProjectTaskForReport.CustomField7, dbo.vueAccountProjectTaskForReport.CustomField8, 
                      dbo.vueAccountProjectTaskForReport.CustomField9, dbo.vueAccountProjectTaskForReport.CustomField10, dbo.vueAccountProjectTaskForReport.CustomField11, 
                      dbo.vueAccountProjectTaskForReport.CustomField12, dbo.vueAccountProjectTaskForReport.CustomField13, dbo.vueAccountProjectTaskForReport.CustomField14, 
                      dbo.vueAccountProjectTaskForReport.CustomField15
FROM         dbo.vueAccountProjectTaskForReport LEFT OUTER JOIN
                      dbo.vueAccountCurrency ON dbo.vueAccountProjectTaskForReport.EstimatedCurrencyId = dbo.vueAccountCurrency.AccountCurrencyId LEFT OUTER JOIN
                      dbo.rptvueAccountEmployeeTimeEntry ON 
                      dbo.vueAccountProjectTaskForReport.AccountProjectTaskId = dbo.rptvueAccountEmployeeTimeEntry.AccountProjectTaskId
WHERE     (dbo.vueAccountProjectTaskForReport.IsParentTask <> 1)
GROUP BY dbo.vueAccountProjectTaskForReport.AccountProjectTaskId, dbo.vueAccountProjectTaskForReport.AccountProjectId, 
                      dbo.vueAccountProjectTaskForReport.ParentAccountProjectTaskId, dbo.vueAccountProjectTaskForReport.TaskName, 
                      dbo.vueAccountProjectTaskForReport.TaskDescription, dbo.vueAccountProjectTaskForReport.AccountTaskTypeId, dbo.vueAccountProjectTaskForReport.DeadlineDate, 
                      dbo.vueAccountProjectTaskForReport.CompletedPercent, dbo.vueAccountProjectTaskForReport.Completed, dbo.vueAccountProjectTaskForReport.IsParentTask, 
                      dbo.vueAccountProjectTaskForReport.IsForAllEmployees, dbo.vueAccountProjectTaskForReport.AccountPriorityId, dbo.vueAccountProjectTaskForReport.CreatedOn, 
                      dbo.vueAccountProjectTaskForReport.TaskStatusId, dbo.vueAccountProjectTaskForReport.CreatedByEmployeeId, 
                      dbo.vueAccountProjectTaskForReport.ModifiedByEmployeeId, dbo.vueAccountProjectTaskForReport.ModifiedOn, dbo.vueAccountProjectTaskForReport.TaskStatus, 
                      dbo.vueAccountProjectTaskForReport.CreatedByFirstName, dbo.vueAccountProjectTaskForReport.CreatedByLastName, dbo.vueAccountProjectTaskForReport.Priority, 
                      dbo.vueAccountProjectTaskForReport.ProjectName, ISNULL(dbo.vueAccountProjectTaskForReport.ProjectCode, N''''), dbo.vueAccountProjectTaskForReport.TaskType, 
                      dbo.vueAccountProjectTaskForReport.AccountId, dbo.vueAccountProjectTaskForReport.AccountProjectMilestoneId, dbo.vueAccountProjectTaskForReport.IsReOpen, 
                      dbo.vueAccountProjectTaskForReport.MilestoneDescription, dbo.vueAccountProjectTaskForReport.ModifiedByFirstName, 
                      dbo.vueAccountProjectTaskForReport.ModifiedByLastName, ISNULL(dbo.vueAccountProjectTaskForReport.EstimatedCost, 0), 
                      ISNULL(dbo.vueAccountProjectTaskForReport.EstimatedHours, 0), dbo.vueAccountProjectTaskForReport.EstimatedTimeSpentUnit, 
                      dbo.vueAccountProjectTaskForReport.AccountEmployeeId, dbo.vueAccountProjectTaskForReport.IsDisabled, ISNULL(dbo.vueAccountProjectTaskForReport.TaskCode, 
                      N''''), dbo.vueAccountProjectTaskForReport.IsTemplate, ISNULL(dbo.vueAccountProjectTaskForReport.IsForAllProjectTask, 0), 
                      ISNULL(dbo.vueAccountProjectTaskForReport.IsBillable, 0), dbo.vueAccountProjectTaskForReport.AccountClientId, 
                      ISNULL(dbo.vueAccountProjectTaskForReport.ClientNick, N''''), dbo.vueAccountProjectTaskForReport.ClientName, dbo.vueAccountProjectTaskForReport.Duration, 
                      ISNULL(dbo.vueAccountProjectTaskForReport.ParentTaskName, N''''), dbo.vueAccountProjectTaskForReport.EstimatedCurrencyId, 
                      dbo.vueAccountProjectTaskForReport.EstimatedCurrencyCode, dbo.vueAccountCurrency.ExchangeRate, 
                      ISNULL(dbo.vueAccountProjectTaskForReport.ProjectDescription, N''''), dbo.vueAccountProjectTaskForReport.MilestoneDate, 
                      dbo.vueAccountProjectTaskForReport.StartDate, dbo.vueAccountProjectTaskForReport.CustomField1, dbo.vueAccountProjectTaskForReport.CustomField2, 
                      dbo.vueAccountProjectTaskForReport.CustomField3, dbo.vueAccountProjectTaskForReport.CustomField4, dbo.vueAccountProjectTaskForReport.CustomField5, 
                      dbo.vueAccountProjectTaskForReport.CustomField6, dbo.vueAccountProjectTaskForReport.CustomField7, dbo.vueAccountProjectTaskForReport.CustomField8, 
                      dbo.vueAccountProjectTaskForReport.CustomField9, dbo.vueAccountProjectTaskForReport.CustomField10, dbo.vueAccountProjectTaskForReport.CustomField11, 
                      dbo.vueAccountProjectTaskForReport.CustomField12, dbo.vueAccountProjectTaskForReport.CustomField13, dbo.vueAccountProjectTaskForReport.CustomField14, 
                      dbo.vueAccountProjectTaskForReport.CustomField15'



GO
-- Create View rptvueAccountProjectTasks
Print 'Create View rptvueAccountProjectTasks'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectTasks' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountProjectTasks
AS
SELECT     AccountProjectTaskId, AccountProjectId, ParentAccountProjectTaskId, TaskName, TaskDescription, AccountTaskTypeId, DeadlineDate, CompletedPercent, Completed, 
                      IsParentTask, IsForAllEmployees, AccountPriorityId, TaskStatusId, CreatedOn, CreatedByEmployeeId, ModifiedOn, ModifiedByEmployeeId, TaskStatus, 
                      CreatedByFirstName, CreatedByLastName, Priority, ProjectName, ProjectCode, TaskType, AccountId, AccountProjectMilestoneId, MilestoneDescription, IsReOpen, 
                      ModifiedByFirstName, ModifiedByLastName, ISNULL(EstimatedCost, 0) AS EstimatedCost, EstimatedHours, EstimatedTimeSpentUnit, AccountEmployeeId, IsDisabled, 
                      TaskCode, IsTemplate, IsForAllProjectTask, IsBillable, AccountClientId, ClientNick, ClientName, Duration, ParentTaskName, EstimatedCurrencyId, 
                      EstimatedCurrencyCode, BillableTotalHours, NonBillableTotalHours, TotalHours, CurrencyEmployeeCost, EstimatedCurrencyExchangeRate, 
                      CASE WHEN dbo.vueAccountProjectTaskOnlyForReport.EstimatedCurrencyExchangeRate > 0 THEN dbo.vueAccountProjectTaskOnlyForReport.EstimatedCost / dbo.vueAccountProjectTaskOnlyForReport.EstimatedCurrencyExchangeRate
                       ELSE 0 END AS CurrencyEstimatedCost, CurrencyAmount, ProjectDescription, MilestoneDate, StartDate, CustomField1, CustomField2, CustomField3, CustomField4, 
                      CustomField5, CustomField6, CustomField7, CustomField8, CustomField9, CustomField10, CustomField11, CustomField12, CustomField13, CustomField14, 
                      CustomField15
FROM         dbo.vueAccountProjectTaskOnlyForReport'
GO
-- Create View vueAccountExpenseEntryApprovalPendingSummaryReadOnly
Print 'Create View vueAccountExpenseEntryApprovalPendingSummaryReadOnly'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountExpenseEntryApprovalPendingSummaryReadOnly' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountExpenseEntryApprovalPendingSummaryReadOnly
AS
SELECT     AccountProjectId, 
                      LeaderEmployeeId, ProjectManagerEmployeeId, AccountEmployeeId, 
                      AccountExternalUserId, EmployeeManagerId, 
                       SystemApproverTypeId
FROM         dbo.vueAccountExpenseEntryApprovalSummary'


GO
-- Add Column [LockAllPeriodExceptPrevious] to [dbo].[AccountWorkingDayType]
Print 'Add Column [LockAllPeriodExceptPrevious] to [dbo].[AccountWorkingDayType]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountWorkingDayType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='LockAllPeriodExceptPrevious' AND TABLE_NAME='AccountWorkingDayType'))
ALTER TABLE [dbo].[AccountWorkingDayType]
	ADD [LockAllPeriodExceptPrevious] [bit] NULL
	
GO
-- Add Column [LockAllPeriodExceptNext] to [dbo].[AccountWorkingDayType]
Print 'Add Column [LockAllPeriodExceptNext] to [dbo].[AccountWorkingDayType]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountWorkingDayType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='LockAllPeriodExceptNext' AND TABLE_NAME='AccountWorkingDayType'))
ALTER TABLE [dbo].[AccountWorkingDayType]
	ADD [LockAllPeriodExceptNext] [bit] NULL

GO
-- Drop View [dbo].[vueAccountWorkingDayType]
Print 'Drop View [dbo].[vueAccountWorkingDayType]'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountWorkingDayType' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountWorkingDayType]

GO
-- Drop View [dbo].[vueAccountEmployee]
Print 'Drop View [dbo].[vueAccountEmployee]'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployee]
                      
GO
-- Create View [dbo].[vueAccountWorkingDayType]
Print 'Create View [dbo].[vueAccountWorkingDayType]'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountWorkingDayType' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountWorkingDayType
AS
SELECT     dbo.AccountWorkingDayType.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountId, dbo.AccountWorkingDayType.AccountWorkingDayType, 
                      dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay, dbo.AccountWorkingDayType.CreatedByEmployeeId, 
                      dbo.AccountWorkingDayType.CreatedOn, dbo.AccountWorkingDayType.ModifiedByEmployeeId, dbo.AccountWorkingDayType.ModifiedOn, 
                      dbo.AccountWorkingDayType.IsDisabled, dbo.SystemWorkingDay.WorkingDay, dbo.AccountWorkingDayType.MasterWorkingDayTypeId, 
                      dbo.SystemWorkingDay.SQLServerWeekDayNo, dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, 
                      dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, 
                      dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod, dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId, 
                      dbo.AccountWorkingDayType.TimesheetOverdueAfterDays, ISNULL(dbo.AccountWorkingDayType.MinimumPercentagePerDay, 0) AS MinimumPercentagePerDay, 
                      ISNULL(dbo.AccountWorkingDayType.MaximumPercentagePerDay, 100) AS MaximumPercentagePerDay, 
                      ISNULL(dbo.AccountWorkingDayType.MinimumPercentagePerWeek, 0) AS MinimumPercentagePerWeek, 
                      ISNULL(dbo.AccountWorkingDayType.MaximumPercentagePerWeek, 500) AS MaximumPercentagePerWeek, 
                      dbo.AccountWorkingDayType.LockAllPreviousTimesheets, dbo.AccountWorkingDayType.LockAllFutureTimesheets, 
                      dbo.AccountWorkingDayType.LockPreviousTimesheetPeriods, dbo.AccountWorkingDayType.LockFutureTimsheetPeriods, 
                      dbo.AccountWorkingDayType.LockPreviousNextMonthTimesheetOn, dbo.AccountWorkingDayType.EnableBalanceValidationForTimeOff,
                      dbo.AccountWorkingDayType.LockAllPeriodExceptPrevious, dbo.AccountWorkingDayType.LockAllPeriodExceptNext
FROM         dbo.AccountWorkingDayType LEFT OUTER JOIN
                      dbo.vueAccountTimesheetPeriodType ON 
                      dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId = dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId LEFT OUTER JOIN
                      dbo.SystemWorkingDay ON dbo.AccountWorkingDayType.WeekStartDay = dbo.SystemWorkingDay.WorkingDayNo'                                                                                                                                                                       	

GO
-- Create View [dbo].[vueAccountEmployee]
Print 'Create View [dbo].[vueAccountEmployee]'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployee
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountEmployee.AccountId, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.Password, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountLocationId, dbo.AccountEmployee.BillingTypeId, 
                      dbo.AccountBillingType.BillingType, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, dbo.AccountPreferences.ShowClockStartEnd, dbo.Account.TimeZoneId, 
                      dbo.AccountRole.MasterAccountRoleId, dbo.Account.DefaultCurrencyId, dbo.Account.CountryId, dbo.AccountPreferences.CultureInfoName, 
                      dbo.AccountPreferences.TimeEntryFormat, dbo.AccountEmployee.AllowedAccessFromIP, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountPreferences.AccountSessionTimeout, dbo.AccountPreferences.ShowCompletedTasksInTimeSheet, dbo.AccountPreferences.CurrencySymbol, 
                      dbo.AccountPreferences.IsCompanyOwnLogo, dbo.Account.AccountExpiryActivation, dbo.Account.LicenseActivation, dbo.AccountEmployee.EmployeeTypeId, 
                      dbo.AccountEmployee.ExternalUserClientId, dbo.AccountEmployee.AccountBillingRateId, dbo.AccountPreferences.ScheduledEmailSendTime, 
                      dbo.AccountEmployee.Username, dbo.AccountEmployee.IsDisabled, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.AccountEmployee.EmployeeCode, dbo.AccountPreferences.Version, 
                      dbo.AccountPreferences.LockSubmittedRecords, dbo.AccountPreferences.LockApprovedRecords, ISNULL(dbo.AccountEmployee.EmployeeCode + '' - '', '''') 
                      + dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeNameWithCode, dbo.AccountPreferences.ShowWorkTypeInTimeSheet, 
                      dbo.AccountPreferences.NumberOfBlankRowsInTimeEntry, dbo.AccountPreferences.ShowCostCenterInTimeSheet, dbo.AccountPreferences.WeekStartDay, 
                      dbo.AccountPreferences.AccountBaseCurrencyId, dbo.AccountEmployee.UserInterfaceLanguage, dbo.AccountEmployee.EmployeeManagerId, 
                      dbo.AccountPreferences.DefaultTimeEntryMode, dbo.AccountPreferences.PageSize, dbo.AccountEmployee.TimeZoneId AS EmployeeTimeZoneId, 
                      dbo.AccountEmployee.TerminationDate, dbo.AccountEmployee.StatusId, dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.EmployeePayTypeId, 
                      dbo.AccountEmployee.HiredDate, dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountWorkingDayType, 
                      dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay AS EmployeeWeekStartDay, 
                      dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountPreferences.ShowDescriptionInWeekView, 
                      dbo.AccountPreferences.InvoiceNoPrefix, dbo.AccountPreferences.ShowAdditionalTaskInformationType, 
                      dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, 
                      ISNULL(dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, 1) AS InitialDayOfTheMonth, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, 1) 
                      AS SystemInitialDayOfFirstPeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod, 16) AS SystemInitialDayOfLastPeriod, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountPreferences.TimesheetPrintFooter, dbo.AccountPreferences.ExpenseSheetPrintFooter, 
                      dbo.AccountPreferences.ShowCompletedProjectsInTimeSheet, dbo.AccountPreferences.ShowProjectForTimeOff, dbo.AccountPreferences.ShowTimeOffInTimesheet, 
                      dbo.AccountEmployee.IsDeleted, dbo.AccountEmployee.IsForcePasswordChange, dbo.AccountEmployee.PasswordChangedDate, 
                      dbo.AccountPreferences.PasswordExpiryPeriod, dbo.AccountPreferences.ShowAllInTimesheetReadOnly, dbo.AccountPreferences.ShowTaskInExpenseSheet, 
                      dbo.AccountPreferences.InvoiceBillingTypeId, dbo.AccountPreferences.ShowBillingRateInInvoiceReport, dbo.SystemInvoiceBillingType.InvoiceBillingType, 
                      dbo.AccountPreferences.InvoiceFooter, dbo.AccountPreferences.TimesheetOverduePeriods, dbo.AccountWorkingDayType.TimesheetOverdueAfterDays, 
                      dbo.AccountEmployee.CreatedOn, dbo.AccountEmployee.CreatedByEmployeeId, dbo.AccountEmployee.ModifiedOn, dbo.AccountEmployee.ModifiedByEmployeeId, 
                      dbo.AccountPreferences.ShowProjectNameInInvoiceReport, dbo.AccountPreferences.ProjectCodePrefix, dbo.AccountPreferences.AutoGenerateProjectCode, 
                      dbo.AccountPreferences.TimeEntryHoursFormatId, dbo.AccountPreferences.ShowPercentageInTimesheet, dbo.AccountPreferences.EnablePasswordComplexity, 
                      dbo.AccountPreferences.ShowClientDepartmentInProject, dbo.AccountPreferences.ShowEntryDateInInvoiceReport, dbo.AccountPreferences.TimesheetSort, 
                      dbo.AccountPreferences.ShowCostCenterInTimesheetBy, dbo.AccountPreferences.ShowCopyTimesheetButton, 
                      dbo.AccountPreferences.ShowCopyActivitiesButtonInTimesheet, dbo.AccountPreferences.ShowProjectNameInTask, dbo.AccountPreferences.ShowClientNameInTask, 
                      dbo.AccountPreferences.IsShowElectronicSign, ISNULL(dbo.AccountWorkingDayType.MinimumPercentagePerDay, 0) AS MinimumPercentagePerDay, 
                      ISNULL(dbo.AccountWorkingDayType.MaximumPercentagePerDay, 100) AS MaximumPercentagePerDay, 
                      ISNULL(dbo.AccountWorkingDayType.MinimumPercentagePerWeek, 0) AS MinimumPercentagePerWeek, 
                      ISNULL(dbo.AccountWorkingDayType.MaximumPercentagePerWeek, 500) AS MaximumPercentagePerWeek, 
                      dbo.AccountPreferences.ShowCompletedProjectInProjectGrid, dbo.AccountPreferences.ShowEmployeeNameInInvoiceReport, 
                      dbo.AccountPreferences.CalculateTaskPercentageAutomatically, dbo.AccountWorkingDayType.LockAllPreviousTimesheets, 
                      dbo.AccountWorkingDayType.LockAllFutureTimesheets, dbo.AccountWorkingDayType.LockPreviousTimesheetPeriods, 
                      dbo.AccountWorkingDayType.LockFutureTimsheetPeriods, dbo.AccountWorkingDayType.LockPreviousNextMonthTimesheetOn, 
                      dbo.AccountWorkingDayType.EnableBalanceValidationForTimeOff, dbo.Account.IsLock, dbo.AccountPreferences.IncludeCurrentYearInProjectCode, 
                      dbo.AccountPreferences.ShowAdditionalProjectInformationType,
                      dbo.AccountWorkingDayType.LockAllPeriodExceptPrevious, dbo.AccountWorkingDayType.LockAllPeriodExceptNext
FROM         dbo.SystemInvoiceBillingType RIGHT OUTER JOIN
                      dbo.AccountPreferences ON dbo.SystemInvoiceBillingType.InvoiceBillingTypeId = dbo.AccountPreferences.InvoiceBillingTypeId RIGHT OUTER JOIN
                      dbo.vueAccountTimesheetPeriodType RIGHT OUTER JOIN
                      dbo.AccountWorkingDayType ON 
                      dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId = dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId RIGHT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.Account ON dbo.AccountEmployee.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId ON 
                      dbo.AccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId ON 
                      dbo.AccountPreferences.AccountId = dbo.AccountEmployee.AccountId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId'

GO
-- Drop View rptvueAccountProjectTeam
Print 'Drop View rptvueAccountProjectTeam'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectTeam' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountProjectTeam]

GO
-- Drop View vueAccountProjectTeamForReport
Print 'Drop View vueAccountProjectTeamForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountProjectTeamForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountProjectTeamForReport]

GO
-- Create View vueAccountProjectTeamForReport
Print 'Create View vueAccountProjectTeamForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountProjectTeamForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountProjectTeamForReport
AS
SELECT     dbo.AccountProjectEmployee.AccountProjectEmployeeId, dbo.AccountProjectEmployee.AccountId, dbo.AccountProjectEmployee.AccountProjectId,
					  dbo.AccountProjectEmployee.AccountEmployeeId, dbo.AccountProjectEmployee.AccountRoleId, dbo.AccountProjectEmployee.AccountBillingRateId,
					  dbo.AccountProjectEmployee.AccountProjectEmployeeTemplateId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName,
					  dbo.AccountProject.AccountClientId, dbo.AccountProject.ProjectName, dbo.AccountBillingType.BillingType AS ProjectBillingType,
					  dbo.AccountDepartment.DepartmentName, dbo.AccountLocation.AccountLocation, dbo.AccountRole.Role, dbo.AccountEmployeeType.AccountEmployeeType,
					  dbo.AccountParty.PartyName AS ClientName, dbo.AccountStatus.Status AS ProjectStatus, AccountStatus_1.Status AS EmployeeStatus,
					  dbo.AccountWorkingDayType.AccountWorkingDayType, dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.MinimumHoursPerDay,
					  dbo.AccountWorkingDayType.MaximumHoursPerDay, dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek,
					  dbo.AccountTimeOffPolicy.AccountTimeOffPolicy, dbo.AccountHolidayType.AccountHolidayType, dbo.AccountPartyContact.FirstName AS ClientContactFirstName,
					  dbo.AccountPartyContact.LastName AS ClientContactLastName, dbo.AccountPartyDepartment.PartyDepartmentCode AS ClientDepartmentCode,
					  dbo.AccountPartyDepartment.PartyDepartmentName AS ClientDepartmentName, dbo.AccountPartyDepartment.PartyDepartmentLocation AS ClientDepartmentLocation,
					  dbo.AccountProject.ProjectStatusId, dbo.AccountProjectType.ProjectType, dbo.AccountProject.AccountProjectTypeId, dbo.AccountProject.ProjectDescription,
					  dbo.AccountProject.StartDate AS ProjectStartDate, dbo.AccountProject.Deadline, dbo.AccountProject.EstimatedTime, dbo.AccountProject.EstimatedDuration,
					  dbo.AccountProject.EstimatedDurationUnit, dbo.AccountProject.ProjectCode, dbo.AccountProject.DefaultBillingRate AS ProjectBillingRate,
					  dbo.AccountProject.Completed, dbo.AccountProject.IsDisabled AS IsDisabledProject, dbo.AccountProject.IsDeleted AS IsDeletedProject,
					  dbo.AccountParty.PartyNick AS ClientNick, dbo.AccountParty.EMailAddress AS ClientEMailAddress, dbo.AccountParty.Address1 AS ClientAddress1,
					  dbo.AccountParty.Address2 AS ClientAddress2, dbo.AccountParty.State AS ClientState, dbo.AccountParty.City AS ClientCity,
					  dbo.AccountParty.ZipCode AS ClientZipCode, dbo.AccountParty.Telephone1 AS ClientTelephone1, dbo.AccountParty.Telephone2 AS ClientTelephone2,
					  dbo.AccountParty.Fax AS ClientFax, dbo.AccountEmployee.State AS EmployeeState, dbo.AccountEmployee.City AS EmployeeCity,
					  dbo.AccountEmployee.Zip AS EmployeeZip, dbo.AccountEmployee.WorkPhoneNo AS EmployeeWorkPhoneNo, dbo.AccountEmployee.TerminationDate,
					  dbo.AccountEmployee.EmployeeCode, dbo.AccountEmployee.HiredDate, dbo.AccountBillingRate.BillingRate, dbo.AccountBillingRate.StartDate AS BillingRateStartDate,
					  dbo.AccountBillingRate.EndDate AS BillingRateEndDate, dbo.AccountBillingRate.EmployeeRate,
					  CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
					  + '' '' + AccountEmployee.LastName END AS EmployeeName, SUM(DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n,
					  dbo.AccountEmployeeTimeEntry.TotalTime)) AS TotalMinutes
					  FROM dbo.AccountProjectEmployee INNER JOIN
					  dbo.AccountProject ON dbo.AccountProjectEmployee.AccountProjectId = dbo.AccountProject.AccountProjectId INNER JOIN
					  dbo.AccountEmployee ON dbo.AccountProjectEmployee.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId INNER JOIN
					  dbo.AccountBillingType ON dbo.AccountProject.ProjectBillingTypeId = dbo.AccountBillingType.AccountBillingTypeId INNER JOIN
					  dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId INNER JOIN
					  dbo.AccountStatus ON dbo.AccountProject.ProjectStatusId = dbo.AccountStatus.AccountStatusId INNER JOIN
					  dbo.AccountProjectType ON dbo.AccountProject.AccountProjectTypeId = dbo.AccountProjectType.AccountProjectTypeId LEFT OUTER JOIN
					  dbo.AccountEmployeeTimeEntry ON dbo.AccountEmployee.AccountEmployeeId = dbo.AccountEmployeeTimeEntry.AccountEmployeeId AND
					  dbo.AccountProject.AccountProjectId = dbo.AccountEmployeeTimeEntry.AccountProjectId LEFT OUTER JOIN
					  dbo.AccountBillingRate ON dbo.AccountProjectEmployee.AccountBillingRateId = dbo.AccountBillingRate.AccountBillingRateId LEFT OUTER JOIN
					  dbo.AccountPartyDepartment ON dbo.AccountProject.AccountPartyDepartmentId = dbo.AccountPartyDepartment.AccountPartyDepartmentId LEFT OUTER JOIN
					  dbo.AccountPartyContact ON dbo.AccountProject.AccountPartyContactId = dbo.AccountPartyContact.AccountPartyContactId LEFT OUTER JOIN
					  dbo.AccountHolidayType ON dbo.AccountEmployee.AccountHolidayTypeId = dbo.AccountHolidayType.AccountHolidayTypeId LEFT OUTER JOIN
					  dbo.AccountWorkingDayType ON dbo.AccountEmployee.AccountWorkingDayTypeId = dbo.AccountWorkingDayType.AccountWorkingDayTypeId LEFT OUTER JOIN
					  dbo.AccountTimeOffPolicy ON dbo.AccountEmployee.AccountTimeOffPolicyId = dbo.AccountTimeOffPolicy.AccountTimeOffPolicyId LEFT OUTER JOIN
					  dbo.AccountStatus AS AccountStatus_1 ON dbo.AccountEmployee.StatusId = AccountStatus_1.AccountStatusId LEFT OUTER JOIN
					  dbo.AccountEmployeeType ON dbo.AccountEmployee.EmployeePayTypeId = dbo.AccountEmployeeType.AccountEmployeeTypeId LEFT OUTER JOIN
					  dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId LEFT OUTER JOIN
					  dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
					  dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId
					  WHERE (dbo.AccountParty.IsDeleted <> 1) OR
					  (dbo.AccountParty.IsDeleted IS NULL)
					  GROUP BY dbo.AccountProjectEmployee.AccountProjectEmployeeId, dbo.AccountProjectEmployee.AccountId, dbo.AccountProjectEmployee.AccountProjectId,
					  dbo.AccountProjectEmployee.AccountEmployeeId, dbo.AccountProjectEmployee.AccountRoleId, dbo.AccountProjectEmployee.AccountBillingRateId,
					  dbo.AccountProjectEmployee.AccountProjectEmployeeTemplateId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName,
					  dbo.AccountProject.AccountClientId, dbo.AccountProject.ProjectName, dbo.AccountBillingType.BillingType, dbo.AccountDepartment.DepartmentName,
  					  dbo.AccountLocation.AccountLocation, dbo.AccountRole.Role, dbo.AccountEmployeeType.AccountEmployeeType, dbo.AccountParty.PartyName,
					  dbo.AccountStatus.Status, AccountStatus_1.Status, dbo.AccountWorkingDayType.AccountWorkingDayType, dbo.AccountWorkingDayType.HoursPerDay,
					  dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, dbo.AccountWorkingDayType.MinimumHoursPerWeek,
					  dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountTimeOffPolicy.AccountTimeOffPolicy, dbo.AccountHolidayType.AccountHolidayType,
					  dbo.AccountPartyContact.FirstName, dbo.AccountPartyContact.LastName, dbo.AccountPartyDepartment.PartyDepartmentCode,
					  dbo.AccountPartyDepartment.PartyDepartmentName, dbo.AccountPartyDepartment.PartyDepartmentLocation, dbo.AccountProject.ProjectStatusId,
					  dbo.AccountProjectType.ProjectType, dbo.AccountProject.AccountProjectTypeId, dbo.AccountProject.ProjectDescription, dbo.AccountProject.StartDate,
					  dbo.AccountProject.Deadline, dbo.AccountProject.EstimatedTime, dbo.AccountProject.EstimatedDuration, dbo.AccountProject.EstimatedDurationUnit,
					  dbo.AccountProject.ProjectCode, dbo.AccountProject.DefaultBillingRate, dbo.AccountProject.Completed, dbo.AccountProject.IsDisabled, dbo.AccountProject.IsDeleted,
					  dbo.AccountParty.PartyNick, dbo.AccountParty.EMailAddress, dbo.AccountParty.Address1, dbo.AccountParty.Address2, dbo.AccountParty.State, dbo.AccountParty.City,
					  dbo.AccountParty.ZipCode, dbo.AccountParty.Telephone1, dbo.AccountParty.Telephone2, dbo.AccountParty.Fax, dbo.AccountEmployee.State,
					  dbo.AccountEmployee.City, dbo.AccountEmployee.Zip, dbo.AccountEmployee.WorkPhoneNo, dbo.AccountEmployee.TerminationDate,
					  dbo.AccountEmployee.EmployeeCode, dbo.AccountEmployee.HiredDate, dbo.AccountBillingRate.BillingRate, dbo.AccountBillingRate.StartDate,
					  dbo.AccountBillingRate.EndDate, dbo.AccountBillingRate.EmployeeRate,
					  CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
					  + '' '' + AccountEmployee.LastName END'
                      
                       
GO
-- Create View rptvueAccountProjectTeam
Print 'Create View rptvueAccountProjectTeam'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectTeam' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountProjectTeam
AS
SELECT AccountProjectEmployeeId, AccountId, AccountProjectId, AccountEmployeeId, AccountRoleId, AccountBillingRateId, AccountProjectEmployeeTemplateId, FirstName,
					  LastName, AccountClientId, ProjectName, ProjectBillingType, DepartmentName, AccountLocation, Role, AccountEmployeeType, ClientName, ProjectStatus,
					  EmployeeStatus, AccountWorkingDayType, HoursPerDay, MinimumHoursPerDay, MaximumHoursPerDay, MinimumHoursPerWeek, MaximumHoursPerWeek,
					  AccountTimeOffPolicy, AccountHolidayType, ClientContactFirstName, ClientContactLastName, ClientDepartmentCode, ClientDepartmentName,
					  ClientDepartmentLocation, ProjectStatusId, ProjectType, AccountProjectTypeId, ProjectDescription, ProjectStartDate, Deadline, EstimatedTime, EstimatedDuration,
					  EstimatedDurationUnit, ProjectCode, ProjectBillingRate, Completed, IsDisabledProject, IsDeletedProject, ClientNick, ClientEMailAddress, ClientAddress1,
					  ClientAddress2, ClientState, ClientCity, ClientZipCode, ClientTelephone1, ClientTelephone2, ClientFax, EmployeeState, EmployeeCity, EmployeeZip,
					  EmployeeWorkPhoneNo, TerminationDate, EmployeeCode, HiredDate, BillingRate, BillingRateStartDate, BillingRateEndDate, EmployeeRate, EmployeeName,
					  ROUND(CONVERT(float, TotalMinutes) / 60, 2) AS TotalHours, REPLACE(TotalMinutes / 60, '''', ''.00'') + '':'' + RIGHT(''0'' + REPLACE(TotalMinutes - TotalMinutes / 60 * 60, '''',
					  ''.00''), 2) AS TotalTime
FROM dbo.vueAccountProjectTeamForReport'


GO
-- Drop View vueAccountEmployeeTimeEntryWithTimeOffForReport
Print 'Drop View vueAccountEmployeeTimeEntryWithTimeOffForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithTimeOffForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryWithTimeOffForReport]

GO
-- Drop View [dbo].[rptvueAccountEmployeeTimeEntry]
Print 'Drop View [dbo].[rptvueAccountEmployeeTimeEntry]'
GO
DROP VIEW [dbo].[rptvueAccountEmployeeTimeEntry]

GO
-- Drop View [dbo].[vueAccountEmployeeTimeEntryForReport]
Print 'Drop View [dbo].[vueAccountEmployeeTimeEntryForReport]'
GO
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryForReport]


GO
-- Create View vueAccountEmployeeTimeEntryWithTimeOffForReport
Print 'Create View vueAccountEmployeeTimeEntryWithTimeOffForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithTimeOffForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport
AS
SELECT     CASE WHEN dbo.AccountEmployee.IsDisabled = 1 THEN dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE dbo.AccountEmployee.FirstName
                       + '' '' + dbo.AccountEmployee.LastName END AS EmployeeName, dbo.AccountProject.ProjectName, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 1 THEN AccountProjectTask_1.TaskName ELSE dbo.AccountTimeOffType.AccountTimeOffType END AS TaskName,
                       dbo.AccountEmployeeTimeEntry.TotalTime, dbo.AccountEmployeeTimeEntry.Approved, dbo.AccountEmployee.AccountEmployeeId, 
                      dbo.AccountProject.AccountProjectId, dbo.AccountEmployeeTimeEntry.TeamLeadApproved, dbo.AccountEmployeeTimeEntry.ProjectManagerApproved, 
                      dbo.AccountEmployeeTimeEntry.AdministratorApproved, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, dbo.AccountEmployeeTimeEntry.StartTime, 
                      dbo.AccountEmployeeTimeEntry.EndTime, dbo.AccountEmployeeTimeEntry.TimeEntryDate, dbo.AccountEmployeeTimeEntry.Description, 
                      ISNULL(dbo.AccountProject.AccountId, dbo.AccountTimeOffType.AccountId) AS AccountId, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime) AS TotalMinutes, DATEPART(dw, dbo.AccountEmployeeTimeEntry.TimeEntryDate) AS WeekDay, 
                      dbo.AccountParty.AccountPartyId, dbo.AccountParty.PartyName, AccountProjectTask_1.AccountProjectTaskId, dbo.AccountBillingType.BillingType, 
                      dbo.AccountProject.LeaderEmployeeId, dbo.AccountProject.ProjectManagerEmployeeId, dbo.AccountProject.TimeSheetApprovalTypeId, 
                      dbo.AccountProject.ExpenseApprovalTypeId, AccountProjectTask_1.IsBillable, dbo.AccountEmployeeTimeEntry.Rejected, dbo.AccountEmployeeTimeEntry.BillingRate, 
                      dbo.AccountProject.ProjectBillingRateTypeId, dbo.AccountEmployee.EmployeeCode, dbo.AccountEmployee.AccountDepartmentId, 
                      dbo.AccountDepartment.DepartmentName, AccountProjectTask_1.EstimatedCost, AccountProjectTask_1.EstimatedTimeSpent, 
                      dbo.AccountEmployeeTimeEntry.Submitted, dbo.AccountWorkType.AccountWorkType, dbo.AccountEmployee.EMailAddress, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountCostCenter.AccountCostCenter, dbo.AccountCostCenter.AccountCostCenterCode, dbo.AccountWorkType.AccountWorkTypeCode, 
                      dbo.AccountProject.ProjectCode, AccountProjectTask_1.TaskCode, dbo.AccountLocation.AccountLocationId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction.Comments, dbo.AccountEmployeeTimeEntry.BillingRateCurrencyId, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateCurrencyId, dbo.AccountEmployeeTimeEntry.BillingRateExchangeRate, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateExchangeRate, dbo.AccountEmployeeTimeEntry.AccountBaseCurrencyId, AccountProjectTask_1.AccountTaskTypeId, 
                      AccountProjectTask_1.TaskStatusId, AccountProjectTask_1.AccountPriorityId, AccountProjectTask_1.AccountProjectMilestoneId, 
                      dbo.AccountDepartment.DepartmentCode, dbo.AccountParty.PartyNick, AccountProjectTask_1.EstimatedCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction.ApprovedOn, dbo.AccountEmployeeTimeEntry.EmployeeRate, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountRole.Role, dbo.AccountProject.AccountProjectTypeId, dbo.AccountProject.ProjectDescription, AccountProjectTask_1.TaskDescription, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeExpenseBillingTimesheetId, dbo.AccountEmployeeTimeEntry.Billed, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Submitted = 1 THEN (CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, 
                      dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS SubmittedHours, CASE WHEN dbo.AccountEmployeeTimeEntry.Approved = 1 THEN (CONVERT(float, 
                      DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS ApprovedHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Rejected = 1 THEN (CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, 
                      dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS RejectedHours, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, 
                      dbo.AccountPartyContact.FirstName + N'' '' + dbo.AccountPartyContact.LastName AS ClientContactName, 
                      dbo.AccountPartyDepartment.PartyDepartmentCode AS ClientDepartmentCode, dbo.AccountPartyDepartment.PartyDepartmentName AS ClientDepartmentName, 
                      dbo.AccountPartyDepartment.PartyDepartmentLocation AS ClientDepartmentLocation, dbo.AccountEmployeeTimeEntry.IsTimeOff, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId, CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 0 THEN (CONVERT(float, DATEPART(hh, 
                      dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS TimeOffHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 1 THEN (CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, 
                      dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS TimesheetHours, dbo.AccountWorkType.AccountWorkTypeId, dbo.AccountStatus.Status AS ProjectStatus, 
                      AccountProjectTask_1.ParentAccountProjectTaskId, dbo.AccountProjectTask.TaskName AS ParentTaskName, dbo.AccountEmployee.IsDisabled, 
                      dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, ISNULL(dbo.AccountEmployeeType.AccountEmployeeType, N'''') AS EmployeeType, 
                      ISNULL(dbo.AccountHolidayTypeDetail.HolidayName, N'''') AS HolidayName, dbo.AccountEmployeeTimeEntry.Percentage, 
                      dbo.AccountEmployeeTimeEntry.CustomField1, dbo.AccountEmployeeTimeEntry.CustomField2, dbo.AccountEmployeeTimeEntry.CustomField3, 
                      dbo.AccountEmployeeTimeEntry.CustomField4, dbo.AccountEmployeeTimeEntry.CustomField5, dbo.AccountEmployeeTimeEntry.CustomField6, 
                      dbo.AccountEmployeeTimeEntry.CustomField7, dbo.AccountEmployeeTimeEntry.CustomField8, dbo.AccountEmployeeTimeEntry.CustomField9, 
                      dbo.AccountEmployeeTimeEntry.CustomField10, dbo.AccountEmployeeTimeEntry.CustomField11, dbo.AccountEmployeeTimeEntry.CustomField12, 
                      dbo.AccountEmployeeTimeEntry.CustomField13, dbo.AccountEmployeeTimeEntry.CustomField14, dbo.AccountEmployeeTimeEntry.CustomField15, 
                      AccountProjectTask_1.StartDate AS TaskStartDate, AccountProjectTask_1.DeadlineDate AS TaskDeadlineDate, dbo.AccountParty.IsDeleted, 
                      CASE WHEN AccountProjectTask_1.IsBillable = 1 THEN (CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, 
                      dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) ELSE 0 END AS BillableHours, AccountProjectTask_1.CustomField1 AS TaskCustomField1, 
                      AccountProjectTask_1.CustomField2 AS TaskCustomField2, AccountProjectTask_1.CustomField3 AS TaskCustomField3, 
                      AccountProjectTask_1.CustomField4 AS TaskCustomField4, AccountProjectTask_1.CustomField5 AS TaskCustomField5, 
                      AccountProjectTask_1.CustomField6 AS TaskCustomField6, AccountProjectTask_1.CustomField7 AS TaskCustomField7, 
                      AccountProjectTask_1.CustomField8 AS TaskCustomField8, AccountProjectTask_1.CustomField9 AS TaskCustomField9, 
                      AccountProjectTask_1.CustomField10 AS TaskCustomField10, AccountProjectTask_1.CustomField11 AS TaskCustomField11, 
                      AccountProjectTask_1.CustomField12 AS TaskCustomField12, AccountProjectTask_1.CustomField13 AS TaskCustomField13, 
                      AccountProjectTask_1.CustomField14 AS TaskCustomField14, AccountProjectTask_1.CustomField15 AS TaskCustomField15, dbo.AccountEmployee.JobTitle
FROM         dbo.AccountHolidayTypeDetail RIGHT OUTER JOIN
                      dbo.AccountEmployeeTimeEntry INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeEntry.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId ON 
                      dbo.AccountHolidayTypeDetail.AccountHolidayTypeId = dbo.AccountEmployee.AccountHolidayTypeId AND 
                      dbo.AccountHolidayTypeDetail.AccountId = dbo.AccountEmployee.AccountId AND 
                      dbo.AccountHolidayTypeDetail.HolidayDate = dbo.AccountEmployeeTimeEntry.TimeEntryDate LEFT OUTER JOIN
                      dbo.AccountEmployeeType ON dbo.AccountEmployee.EmployeePayTypeId = dbo.AccountEmployeeType.AccountEmployeeTypeId LEFT OUTER JOIN
                      dbo.AccountProjectTask AS AccountProjectTask_1 LEFT OUTER JOIN
                      dbo.AccountProjectTask ON AccountProjectTask_1.ParentAccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId ON 
                      dbo.AccountEmployeeTimeEntry.AccountProjectTaskId = AccountProjectTask_1.AccountProjectTaskId LEFT OUTER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountStatus ON dbo.AccountProject.ProjectStatusId = dbo.AccountStatus.AccountStatusId LEFT OUTER JOIN
                      dbo.AccountTimeOffType ON dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId LEFT OUTER JOIN
                      dbo.AccountPartyDepartment ON dbo.AccountProject.AccountPartyDepartmentId = dbo.AccountPartyDepartment.AccountPartyDepartmentId LEFT OUTER JOIN
                      dbo.AccountPartyContact ON dbo.AccountProject.AccountPartyContactId = dbo.AccountPartyContact.AccountPartyContactId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryPeriod ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId LEFT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryApprovalLastAction.AccountEmployeeTimeEntryId LEFT OUTER JOIN
                      dbo.AccountCostCenter ON dbo.AccountEmployeeTimeEntry.AccountCostCenterId = dbo.AccountCostCenter.AccountCostCenterId LEFT OUTER JOIN
                      dbo.AccountWorkType ON dbo.AccountEmployeeTimeEntry.AccountWorkTypeId = dbo.AccountWorkType.AccountWorkTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId LEFT OUTER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId
                      WHERE (dbo.AccountParty.IsDeleted <> 1) OR (dbo.AccountParty.IsDeleted IS NULL)'
                      
                      
GO
-- Create View vueAccountEmployeeTimeEntryForReport
Print 'Create View vueAccountEmployeeTimeEntryForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryForReport
AS
SELECT     dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeName, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskName, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalTime, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Approved, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TeamLeadApproved, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectManagerApproved, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AdministratorApproved, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeTimeEntryId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.StartTime, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EndTime, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Description, N'''') AS Description, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.WeekDay, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountPartyId AS AccountClientId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.PartyName AS ClientName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectTaskId, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingType, N'''') 
                      AS BillingType, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectManagerEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ExpenseApprovalTypeId, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.IsBillable, 0) 
                      AS IsBillable, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Rejected, 0) AS Rejected, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRate, 0) AS BillingRate, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectBillingRateTypeId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeCode, N'''') AS EmployeeCode, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountDepartmentId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.DepartmentName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedCost, 0) AS EstimatedCost, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedTimeSpent, 0) AS EstimatedHours, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Submitted, 0) AS Submitted, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountWorkType, N'''') AS AccountWorkType, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EMailAddress, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountLocation, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountCostCenter, N'''') AS AccountCostCenter, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountCostCenterCode, N'''') AS AccountCostCenterCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountWorkTypeCode, N'''') AS AccountWorkTypeCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectCode, N'''') AS ProjectCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCode, N'''') AS TaskCode, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountLocationId, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Comments, N'''') 
                      AS ApproverComments, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes * dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRate / 60, 0) 
                      AS Amount, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRateCurrencyId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateExchangeRate, 0) AS BillingRateExchangeRate, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRateExchangeRate, 0) AS EmployeeRateExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountBaseCurrencyId, dbo.vueAccountCurrency.CurrencyCode AS BillingRateCurrencyCode, 
                      dbo.vueAccountCurrency.CurrencyCode AS AmountCurrencyCode, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountTaskTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskStatusId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountPriorityId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectMilestoneId, dbo.AccountTaskType.TaskType, dbo.AccountStatus.Status AS TaskStatus, 
                      dbo.AccountProjectMilestone.MilestoneDescription, dbo.AccountPriority.Priority, CONVERT(float, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes) / 60 AS TotalHours, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.DepartmentCode, N'''') AS DepartmentCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.PartyNick, N'''') AS ClientNick, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedCurrencyId, vueAccountCurrency_1.CurrencyCode AS EstimatedCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ApprovedOn, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRate, 0) 
                      AS EmployeeRate, vueAccountCurrency_2.CurrencyCode AS EmployeeRateCurrencyCode, 
                      AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName AS TeamLeader, 
                      AccountEmployee_2.FirstName + '' '' + AccountEmployee_2.LastName AS ProjectManager, 
                      ISNULL(dbo.AccountEmployee.FirstName + N'' '' + dbo.AccountEmployee.LastName, N'''') AS EmployeeManager, 
                      vueAccountCurrency_1.ExchangeRate AS EstimatedCurrencyExchangeRate, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes * dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRate / 60, 0) 
                      AS EmployeeCost, { fn DAYOFMONTH(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) } AS DayNo, 
                      MONTH(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) AS MonthNo, DATEPART(week, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) - DATEPART(week, DATEADD(month, DATEDIFF(month, 0, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate), 0)) + 1 AS WeekNo, 
                      YEAR(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) AS Year, 
                      LEFT({ fn MONTHNAME(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) }, 3) + '' - '' + CONVERT(nvarchar(10), 
                      YEAR(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate)) AS Period, 
                      { fn DAYNAME(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) } AS WeekDayName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountRoleId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Role, 
                      dbo.AccountProjectType.ProjectType, dbo.AccountRole.Role AS ProjectRole, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectDescription, N'''') 
                      AS ProjectDescription, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskDescription, N'''') AS TaskDescription, 
                      dbo.AccountTimeExpenseBilling.InvoiceNumber, dbo.AccountTimeExpenseBilling.InvoiceDate, dbo.AccountProjectType.AccountProjectTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Billed, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeTimeEntryPeriodId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientContactName, N'''') AS ClientContactName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentCode, N'''') AS ClientDepartmentCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentName, N'''') AS ClientDepartmentName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentLocation, N'''') AS ClientDepartmentLocation, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.IsTimeOff, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountWorkTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectStatus, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ParentTaskName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.FirstName, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.LastName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeType, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.HolidayName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField1, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField2, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField3, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField4, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField5, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField6, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField7, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField8, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField9, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField10, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField11, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField12, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField13, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField14, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField15, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskStartDate, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskDeadlineDate, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField1, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField2, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField3, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField4, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField5, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField6, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField7, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField8, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField9, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField10, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField11, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField12, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField13, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField14, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField15,
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.JobTitle
FROM         dbo.AccountRole INNER JOIN
                      dbo.AccountProjectEmployee ON dbo.AccountRole.AccountRoleId = dbo.AccountProjectEmployee.AccountRoleId RIGHT OUTER JOIN
                      dbo.AccountTimeExpenseBillingTimesheet INNER JOIN
                      dbo.AccountTimeExpenseBilling ON 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingId = dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId RIGHT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport LEFT OUTER JOIN
                      dbo.AccountProjectType ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectTypeId = dbo.AccountProjectType.AccountProjectTypeId LEFT OUTER JOIN
                      dbo.AccountProjectMilestone ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectMilestoneId = dbo.AccountProjectMilestone.AccountProjectMilestoneId LEFT OUTER JOIN
                      dbo.AccountStatus ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskStatusId = dbo.AccountStatus.AccountStatusId LEFT OUTER JOIN
                      dbo.AccountPriority ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountPriorityId = dbo.AccountPriority.AccountPriorityId LEFT OUTER JOIN
                      dbo.AccountTaskType ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountTaskTypeId = dbo.AccountTaskType.AccountTaskTypeId ON 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingTimesheetId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountTimeExpenseBillingTimesheetId
                       ON dbo.AccountProjectEmployee.AccountEmployeeId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeId AND 
                      dbo.AccountProjectEmployee.AccountProjectId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.LeaderEmployeeId = AccountEmployee_1.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_2 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectManagerEmployeeId = AccountEmployee_2.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.AccountEmployee AS AccountEmployee_3 ON dbo.AccountEmployee.AccountEmployeeId = AccountEmployee_3.EmployeeManagerId ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeId = AccountEmployee_3.AccountEmployeeId LEFT OUTER JOIN
                      dbo.vueAccountCurrency AS vueAccountCurrency_2 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRateCurrencyId = vueAccountCurrency_2.AccountCurrencyId LEFT OUTER JOIN
                      dbo.vueAccountCurrency AS vueAccountCurrency_1 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedCurrencyId = vueAccountCurrency_1.AccountCurrencyId LEFT OUTER JOIN
                      dbo.vueAccountCurrency ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateCurrencyId = dbo.vueAccountCurrency.AccountCurrencyId'

GO
-- Create View rptvueAccountEmployeeTimeEntry
Print 'Create View rptvueAccountEmployeeTimeEntry'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeEntry' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountEmployeeTimeEntry
AS
SELECT     dbo.vueAccountEmployeeTimeEntryForReport.EmployeeName, dbo.vueAccountEmployeeTimeEntryForReport.ProjectName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskName, dbo.vueAccountEmployeeTimeEntryForReport.TotalTime, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Approved, dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectId, dbo.vueAccountEmployeeTimeEntryForReport.TeamLeadApproved, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManagerApproved, dbo.vueAccountEmployeeTimeEntryForReport.AdministratorApproved, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeTimeEntryId, dbo.vueAccountEmployeeTimeEntryForReport.StartTime, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EndTime, dbo.vueAccountEmployeeTimeEntryForReport.TimeEntryDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Description, dbo.vueAccountEmployeeTimeEntryForReport.AccountId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TotalMinutes, dbo.vueAccountEmployeeTimeEntryForReport.WeekDay, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientName, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectTaskId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingType, dbo.vueAccountEmployeeTimeEntryForReport.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManagerEmployeeId, dbo.vueAccountEmployeeTimeEntryForReport.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ExpenseApprovalTypeId, dbo.vueAccountEmployeeTimeEntryForReport.IsBillable, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Rejected, dbo.vueAccountEmployeeTimeEntryForReport.BillingRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectBillingRateTypeId, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountDepartmentId, dbo.vueAccountEmployeeTimeEntryForReport.DepartmentName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCost, dbo.vueAccountEmployeeTimeEntryForReport.EstimatedHours, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Submitted, dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkType, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EMailAddress, dbo.vueAccountEmployeeTimeEntryForReport.AccountLocation, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountCostCenter, dbo.vueAccountEmployeeTimeEntryForReport.AccountCostCenterCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkTypeCode, dbo.vueAccountEmployeeTimeEntryForReport.ProjectCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCode, dbo.vueAccountEmployeeTimeEntryForReport.AccountLocationId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ApproverComments, dbo.vueAccountEmployeeTimeEntryForReport.Amount, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingRateCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountBaseCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.BillingRateCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AmountCurrencyCode, CASE WHEN vueAccountEmployeeTimeEntryForReport.Submitted = 1 AND 
                      vueAccountEmployeeTimeEntryForReport.Approved = 0 THEN ''Submitted'' WHEN vueAccountEmployeeTimeEntryForReport.Approved = 1 THEN ''Approved'' WHEN vueAccountEmployeeTimeEntryForReport.Rejected
                       = 1 THEN ''Rejected'' WHEN vueAccountEmployeeTimeEntryForReport.Submitted = 0 AND vueAccountEmployeeTimeEntryForReport.Approved = 0 AND 
                      vueAccountEmployeeTimeEntryForReport.Rejected = 0 THEN ''Not Submitted'' END AS ApprovalStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountTaskTypeId, dbo.vueAccountEmployeeTimeEntryForReport.TaskStatusId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountPriorityId, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectMilestoneId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskType, dbo.vueAccountEmployeeTimeEntryForReport.TaskStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.MilestoneDescription, dbo.vueAccountEmployeeTimeEntryForReport.Priority, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TotalHours, dbo.vueAccountEmployeeTimeEntryForReport.DepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientNick, dbo.vueAccountEmployeeTimeEntryForReport.AccountClientId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ApprovedOn, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateCurrencyCode, dbo.vueAccountEmployeeTimeEntryForReport.TeamLeader, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManager, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeManager, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate, 0) AS EstimatedCurrencyExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCost, dbo.vueAccountEmployeeTimeEntryForReport.AccountRoleId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Role, dbo.vueAccountEmployeeTimeEntryForReport.WeekDayName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Period, dbo.vueAccountEmployeeTimeEntryForReport.Year, dbo.vueAccountEmployeeTimeEntryForReport.WeekNo, 
                      dbo.vueAccountEmployeeTimeEntryForReport.MonthNo, dbo.vueAccountEmployeeTimeEntryForReport.DayNo, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 1 THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours ELSE 0 END AS BillableTotalHours,
                       CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable
                       IS NULL THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours ELSE 0 END AS NonBillableTotalHours, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCost / dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate
                       ELSE 0 END AS CurrencyEmployeeCost, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.Amount / dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate
                       ELSE 0 END AS CurrencyAmount, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCost / dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate
                       ELSE 0 END AS CurrencyEstimatedCost, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate / dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate
                       ELSE 0 END AS CurrencyBillingRate, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRate / dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate
                       ELSE 0 END AS CurrencyEmployeeRate, dbo.vueAccountEmployeeTimeEntryForReport.ProjectRole, dbo.vueAccountEmployeeTimeEntryForReport.ProjectType, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectDescription, dbo.vueAccountEmployeeTimeEntryForReport.TaskDescription, 
                      dbo.vueAccountEmployeeTimeEntryForReport.InvoiceNumber, dbo.vueAccountEmployeeTimeEntryForReport.InvoiceDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectTypeId, dbo.vueAccountEmployeeTimeEntryForReport.Billed, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientContactName, dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentName, dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentLocation, 
                      dbo.vueAccountEmployeeTimeEntryForReport.IsTimeOff, dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkTypeId, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 1 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate * dbo.vueAccountEmployeeTimeEntryForReport.TotalHours
                       ELSE 0 END AS BillableTotalAmount, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate * dbo.vueAccountEmployeeTimeEntryForReport.TotalHours
                       ELSE 0 END AS NonBillableTotalAmount, dbo.vueAccountEmployeeTimeEntryForReport.ProjectStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ParentTaskName, dbo.vueAccountEmployeeTimeEntryForReport.FirstName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.LastName, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeType, 
                      dbo.vueAccountEmployeeTimeEntryForReport.HolidayName, SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithLastStatus.Percentage, 0)) AS Percentage, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField1, dbo.vueAccountEmployeeTimeEntryForReport.CustomField2, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField3, dbo.vueAccountEmployeeTimeEntryForReport.CustomField4, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField5, dbo.vueAccountEmployeeTimeEntryForReport.CustomField6, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField7, dbo.vueAccountEmployeeTimeEntryForReport.CustomField8, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField9, dbo.vueAccountEmployeeTimeEntryForReport.CustomField10, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField11, dbo.vueAccountEmployeeTimeEntryForReport.CustomField12, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField13, dbo.vueAccountEmployeeTimeEntryForReport.CustomField14, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField15, dbo.vueAccountEmployeeTimeEntryForReport.TaskStartDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskDeadlineDate, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField1, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField2, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField3, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField4, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField5, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField6, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField7, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField8, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField9, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField10, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField11, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField12, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField13, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField14, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField15,
                      dbo.vueAccountEmployeeTimeEntryForReport.JobTitle
FROM         dbo.vueAccountEmployeeTimeEntryForReport INNER JOIN
                      dbo.vueAccountEmployeeTimeEntryWithLastStatus ON 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryWithLastStatus.AccountEmployeeTimeEntryId
GROUP BY dbo.vueAccountEmployeeTimeEntryForReport.EmployeeName, dbo.vueAccountEmployeeTimeEntryForReport.ProjectName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskName, dbo.vueAccountEmployeeTimeEntryForReport.TotalTime, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeId, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeTimeEntryId, dbo.vueAccountEmployeeTimeEntryForReport.StartTime, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EndTime, dbo.vueAccountEmployeeTimeEntryForReport.TimeEntryDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Description, dbo.vueAccountEmployeeTimeEntryForReport.AccountId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TotalMinutes, dbo.vueAccountEmployeeTimeEntryForReport.WeekDay, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientName, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectTaskId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingType, dbo.vueAccountEmployeeTimeEntryForReport.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManagerEmployeeId, dbo.vueAccountEmployeeTimeEntryForReport.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ExpenseApprovalTypeId, dbo.vueAccountEmployeeTimeEntryForReport.BillingRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectBillingRateTypeId, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountDepartmentId, dbo.vueAccountEmployeeTimeEntryForReport.DepartmentName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCost, dbo.vueAccountEmployeeTimeEntryForReport.EstimatedHours, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkType, dbo.vueAccountEmployeeTimeEntryForReport.EMailAddress, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountLocation, dbo.vueAccountEmployeeTimeEntryForReport.AccountCostCenter, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountCostCenterCode, dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkTypeCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectCode, dbo.vueAccountEmployeeTimeEntryForReport.TaskCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountLocationId, dbo.vueAccountEmployeeTimeEntryForReport.ApproverComments, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Amount, dbo.vueAccountEmployeeTimeEntryForReport.BillingRateCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate, dbo.vueAccountEmployeeTimeEntryForReport.AccountBaseCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingRateCurrencyCode, dbo.vueAccountEmployeeTimeEntryForReport.AmountCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountTaskTypeId, dbo.vueAccountEmployeeTimeEntryForReport.TaskStatusId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountPriorityId, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectMilestoneId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskType, dbo.vueAccountEmployeeTimeEntryForReport.TaskStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.MilestoneDescription, dbo.vueAccountEmployeeTimeEntryForReport.Priority, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TotalHours, dbo.vueAccountEmployeeTimeEntryForReport.DepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientNick, dbo.vueAccountEmployeeTimeEntryForReport.AccountClientId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ApprovedOn, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateCurrencyCode, dbo.vueAccountEmployeeTimeEntryForReport.TeamLeader, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManager, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeManager, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate, 0), dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCost, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountRoleId, dbo.vueAccountEmployeeTimeEntryForReport.Role, 
                      dbo.vueAccountEmployeeTimeEntryForReport.WeekDayName, dbo.vueAccountEmployeeTimeEntryForReport.Period, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Year, dbo.vueAccountEmployeeTimeEntryForReport.WeekNo, dbo.vueAccountEmployeeTimeEntryForReport.MonthNo, 
                      dbo.vueAccountEmployeeTimeEntryForReport.DayNo, dbo.vueAccountEmployeeTimeEntryForReport.ProjectRole, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectType, dbo.vueAccountEmployeeTimeEntryForReport.ProjectDescription, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskDescription, dbo.vueAccountEmployeeTimeEntryForReport.InvoiceNumber, 
                      dbo.vueAccountEmployeeTimeEntryForReport.InvoiceDate, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectTypeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientContactName, dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentName, dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentLocation, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkTypeId, dbo.vueAccountEmployeeTimeEntryForReport.ProjectStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ParentTaskName, dbo.vueAccountEmployeeTimeEntryForReport.FirstName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.LastName, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeType, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Approved, dbo.vueAccountEmployeeTimeEntryForReport.TeamLeadApproved, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManagerApproved, dbo.vueAccountEmployeeTimeEntryForReport.AdministratorApproved, 
                      dbo.vueAccountEmployeeTimeEntryForReport.IsBillable, dbo.vueAccountEmployeeTimeEntryForReport.Rejected, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Submitted, dbo.vueAccountEmployeeTimeEntryForReport.Billed, 
                      dbo.vueAccountEmployeeTimeEntryForReport.IsTimeOff, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate * dbo.vueAccountEmployeeTimeEntryForReport.TotalHours
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 1 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate * dbo.vueAccountEmployeeTimeEntryForReport.TotalHours
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRate / dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate / dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCost / dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.Amount / dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCost / dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable
                       IS NULL THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 1 THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours ELSE 0 END, 
                      CASE WHEN vueAccountEmployeeTimeEntryForReport.Submitted = 1 AND 
                      vueAccountEmployeeTimeEntryForReport.Approved = 0 THEN ''Submitted'' WHEN vueAccountEmployeeTimeEntryForReport.Approved = 1 THEN ''Approved'' WHEN vueAccountEmployeeTimeEntryForReport.Rejected
                       = 1 THEN ''Rejected'' WHEN vueAccountEmployeeTimeEntryForReport.Submitted = 0 AND vueAccountEmployeeTimeEntryForReport.Approved = 0 AND 
                      vueAccountEmployeeTimeEntryForReport.Rejected = 0 THEN ''Not Submitted'' END, dbo.vueAccountEmployeeTimeEntryForReport.HolidayName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField1, dbo.vueAccountEmployeeTimeEntryForReport.CustomField2, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField3, dbo.vueAccountEmployeeTimeEntryForReport.CustomField4, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField5, dbo.vueAccountEmployeeTimeEntryForReport.CustomField6, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField7, dbo.vueAccountEmployeeTimeEntryForReport.CustomField8, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField9, dbo.vueAccountEmployeeTimeEntryForReport.CustomField10, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField11, dbo.vueAccountEmployeeTimeEntryForReport.CustomField12, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField13, dbo.vueAccountEmployeeTimeEntryForReport.CustomField14, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField15, dbo.vueAccountEmployeeTimeEntryForReport.TaskStartDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskDeadlineDate, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField1, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField2, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField3, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField4, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField5, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField6, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField7, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField8, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField9, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField10, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField11, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField12, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField13, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField14, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField15,
                      dbo.vueAccountEmployeeTimeEntryForReport.JobTitle'                                            

GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'
If Not Exists(Select * from [dbo].[SystemReportDataSourceField] Where [SystemReportDataSourceFieldId] = '27F7F13E-3197-403C-8465-A907AE81D942')
BEGIN
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('27F7F13E-3197-403C-8465-A907AE81D942', '3A080202-6842-4ECA-8C79-A945978810B4', N'JobTitle', 100, 0, NULL, NULL, 150, '91402610-EEF0-4DD0-ACA3-0080F53389FA', N'Job Title', 0, 0)
END

GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'
If Not Exists(Select * from [dbo].[SystemReportDataSourceField] Where [SystemReportDataSourceFieldId] = '13109f5c-ae60-4754-ac14-cc63780fd4ec')
BEGIN
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('13109f5c-ae60-4754-ac14-cc63780fd4ec', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', N'FormulaField2', 125, 0, NULL, NULL, 97, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Formula Field 2', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('6f8aa581-ea99-48d5-bcb4-55115889c2a4', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', N'FormulaField1', 125, 0, NULL, NULL, 96, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Formula Field 1', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('b33085ab-0550-4a44-9265-5173cf1946ba', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', N'FormulaField3', 125, 0, NULL, NULL, 98, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Formula Field 3', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('58641b01-c9f8-40bd-9751-01be546bf2bd', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', N'FormulaField4', 125, 0, NULL, NULL, 99, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Formula Field 4', 0, 0)
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('f25bbba1-52ae-4d56-94c1-6ddfb4f06f49', '5ad7c2ee-4cbd-42a7-a4ff-394beaa47cf8', N'FormulaField5', 125, 0, NULL, NULL, 100, 'f29d78e1-2a29-47b3-84b5-aee49740dce6', N'Formula Field 5', 0, 0)
END


GO
-- Add Column EnableOfflineTimesheet to AccountPreferences
Print 'Add Column EnableOfflineTimesheet to AccountPreferences'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountPreferences' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='EnableOfflineTimesheet' AND TABLE_NAME='AccountPreferences'))
ALTER TABLE [dbo].[AccountPreferences]
	ADD [EnableOfflineTimesheet] bit NULL
	
	
GO
-- Drop View vueAccount
Print 'Drop View vueAccount'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccount' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccount]

GO
-- Drop View [dbo].[vueAccountEmployee]
Print 'Drop View [dbo].[vueAccountEmployee]'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployee]


GO
-- Create View vueAccount
Print 'Create View vueAccount'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccount' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccount
AS
SELECT     dbo.Account.AccountId, dbo.Account.AccountTypeId, dbo.Account.AccountName, dbo.Account.Address1, dbo.Account.Address2, dbo.Account.ZipCode, dbo.Account.State, 
                      dbo.Account.City, dbo.Account.CountryId, dbo.Account.EMailAddress, dbo.Account.Telephone, dbo.Account.Fax, dbo.Account.DefaultCurrencyId, 
                      dbo.Account.TimeZoneId, dbo.Account.IsDisabled, dbo.Account.IsDeleted, dbo.Account.StatusId, dbo.Account.CreatedOn, dbo.Account.ModifiedOn, 
                      dbo.Account.ModifiedByEmployeeId, dbo.AccountPreferences.ShowClockStartEnd, dbo.AccountPreferences.AccountPreferencesId, dbo.Account.LicenseKey, 
                      dbo.Account.SystemPackageTypeId, dbo.AccountPreferences.TimeEntryFormat, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.Account.MachineId, dbo.Account.ActivationLicenseKey, dbo.Account.ActivationMachineKey, 
                      dbo.Account.ActivationType, dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountPreferences.InvoiceBillingTypeId, 
                      dbo.AccountPreferences.ShowBillingRateInInvoiceReport, dbo.AccountPreferences.InvoiceFooter, dbo.AccountPreferences.ShowProjectNameInInvoiceReport, 
                      dbo.AccountPreferences.ProjectCodePrefix, dbo.AccountPreferences.AutoGenerateProjectCode, dbo.AccountPreferences.TimeEntryHoursFormatId, 
                      dbo.AccountPreferences.ShowPercentageInTimesheet, dbo.AccountPreferences.EnablePasswordComplexity, dbo.AccountPreferences.ShowClientDepartmentInProject, 
                      dbo.AccountPreferences.ShowEntryDateInInvoiceReport, dbo.AccountPreferences.TimesheetSort, dbo.AccountPreferences.ShowCostCenterInTimesheetBy, 
                      dbo.AccountPreferences.ShowCopyTimesheetButton, dbo.AccountPreferences.ShowCopyActivitiesButtonInTimesheet, 
                      dbo.AccountPreferences.ShowProjectNameInTask, dbo.AccountPreferences.ShowClientNameInTask, dbo.AccountPreferences.IsShowElectronicSign, 
                      dbo.AccountPreferences.ShowCompletedProjectInProjectGrid, dbo.AccountPreferences.ShowEmployeeNameInInvoiceReport, 
                      dbo.AccountPreferences.CalculateTaskPercentageAutomatically, dbo.Account.IsLock, dbo.AccountPreferences.IncludeCurrentYearInProjectCode, 
                      dbo.AccountPreferences.ShowAdditionalProjectInformationType, dbo.AccountPreferences.EnableOfflineTimesheet
FROM         dbo.Account INNER JOIN
                      dbo.AccountPreferences ON dbo.Account.AccountId = dbo.AccountPreferences.AccountId'
                    
GO
-- Create View [dbo].[vueAccountEmployee]
Print 'Create View [dbo].[vueAccountEmployee]'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployee
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountEmployee.AccountId, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.Password, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountLocationId, dbo.AccountEmployee.BillingTypeId, 
                      dbo.AccountBillingType.BillingType, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, dbo.AccountPreferences.ShowClockStartEnd, dbo.Account.TimeZoneId, 
                      dbo.AccountRole.MasterAccountRoleId, dbo.Account.DefaultCurrencyId, dbo.Account.CountryId, dbo.AccountPreferences.CultureInfoName, 
                      dbo.AccountPreferences.TimeEntryFormat, dbo.AccountEmployee.AllowedAccessFromIP, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountPreferences.AccountSessionTimeout, dbo.AccountPreferences.ShowCompletedTasksInTimeSheet, dbo.AccountPreferences.CurrencySymbol, 
                      dbo.AccountPreferences.IsCompanyOwnLogo, dbo.Account.AccountExpiryActivation, dbo.Account.LicenseActivation, dbo.AccountEmployee.EmployeeTypeId, 
                      dbo.AccountEmployee.ExternalUserClientId, dbo.AccountEmployee.AccountBillingRateId, dbo.AccountPreferences.ScheduledEmailSendTime, 
                      dbo.AccountEmployee.Username, dbo.AccountEmployee.IsDisabled, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.AccountEmployee.EmployeeCode, dbo.AccountPreferences.Version, 
                      dbo.AccountPreferences.LockSubmittedRecords, dbo.AccountPreferences.LockApprovedRecords, ISNULL(dbo.AccountEmployee.EmployeeCode + '' - '', '''') 
                      + dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeNameWithCode, dbo.AccountPreferences.ShowWorkTypeInTimeSheet, 
                      dbo.AccountPreferences.NumberOfBlankRowsInTimeEntry, dbo.AccountPreferences.ShowCostCenterInTimeSheet, dbo.AccountPreferences.WeekStartDay, 
                      dbo.AccountPreferences.AccountBaseCurrencyId, dbo.AccountEmployee.UserInterfaceLanguage, dbo.AccountEmployee.EmployeeManagerId, 
                      dbo.AccountPreferences.DefaultTimeEntryMode, dbo.AccountPreferences.PageSize, dbo.AccountEmployee.TimeZoneId AS EmployeeTimeZoneId, 
                      dbo.AccountEmployee.TerminationDate, dbo.AccountEmployee.StatusId, dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.EmployeePayTypeId, 
                      dbo.AccountEmployee.HiredDate, dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountWorkingDayType, 
                      dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay AS EmployeeWeekStartDay, 
                      dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountPreferences.ShowDescriptionInWeekView, 
                      dbo.AccountPreferences.InvoiceNoPrefix, dbo.AccountPreferences.ShowAdditionalTaskInformationType, 
                      dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, 
                      ISNULL(dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, 1) AS InitialDayOfTheMonth, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, 1) 
                      AS SystemInitialDayOfFirstPeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod, 16) AS SystemInitialDayOfLastPeriod, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountPreferences.TimesheetPrintFooter, dbo.AccountPreferences.ExpenseSheetPrintFooter, 
                      dbo.AccountPreferences.ShowCompletedProjectsInTimeSheet, dbo.AccountPreferences.ShowProjectForTimeOff, dbo.AccountPreferences.ShowTimeOffInTimesheet, 
                      dbo.AccountEmployee.IsDeleted, dbo.AccountEmployee.IsForcePasswordChange, dbo.AccountEmployee.PasswordChangedDate, 
                      dbo.AccountPreferences.PasswordExpiryPeriod, dbo.AccountPreferences.ShowAllInTimesheetReadOnly, dbo.AccountPreferences.ShowTaskInExpenseSheet, 
                      dbo.AccountPreferences.InvoiceBillingTypeId, dbo.AccountPreferences.ShowBillingRateInInvoiceReport, dbo.SystemInvoiceBillingType.InvoiceBillingType, 
                      dbo.AccountPreferences.InvoiceFooter, dbo.AccountPreferences.TimesheetOverduePeriods, dbo.AccountWorkingDayType.TimesheetOverdueAfterDays, 
                      dbo.AccountEmployee.CreatedOn, dbo.AccountEmployee.CreatedByEmployeeId, dbo.AccountEmployee.ModifiedOn, dbo.AccountEmployee.ModifiedByEmployeeId, 
                      dbo.AccountPreferences.ShowProjectNameInInvoiceReport, dbo.AccountPreferences.ProjectCodePrefix, dbo.AccountPreferences.AutoGenerateProjectCode, 
                      dbo.AccountPreferences.TimeEntryHoursFormatId, dbo.AccountPreferences.ShowPercentageInTimesheet, dbo.AccountPreferences.EnablePasswordComplexity, 
                      dbo.AccountPreferences.ShowClientDepartmentInProject, dbo.AccountPreferences.ShowEntryDateInInvoiceReport, dbo.AccountPreferences.TimesheetSort, 
                      dbo.AccountPreferences.ShowCostCenterInTimesheetBy, dbo.AccountPreferences.ShowCopyTimesheetButton, 
                      dbo.AccountPreferences.ShowCopyActivitiesButtonInTimesheet, dbo.AccountPreferences.ShowProjectNameInTask, dbo.AccountPreferences.ShowClientNameInTask, 
                      dbo.AccountPreferences.IsShowElectronicSign, ISNULL(dbo.AccountWorkingDayType.MinimumPercentagePerDay, 0) AS MinimumPercentagePerDay, 
                      ISNULL(dbo.AccountWorkingDayType.MaximumPercentagePerDay, 100) AS MaximumPercentagePerDay, 
                      ISNULL(dbo.AccountWorkingDayType.MinimumPercentagePerWeek, 0) AS MinimumPercentagePerWeek, 
                      ISNULL(dbo.AccountWorkingDayType.MaximumPercentagePerWeek, 500) AS MaximumPercentagePerWeek, 
                      dbo.AccountPreferences.ShowCompletedProjectInProjectGrid, dbo.AccountPreferences.ShowEmployeeNameInInvoiceReport, 
                      dbo.AccountPreferences.CalculateTaskPercentageAutomatically, dbo.AccountWorkingDayType.LockAllPreviousTimesheets, 
                      dbo.AccountWorkingDayType.LockAllFutureTimesheets, dbo.AccountWorkingDayType.LockPreviousTimesheetPeriods, 
                      dbo.AccountWorkingDayType.LockFutureTimsheetPeriods, dbo.AccountWorkingDayType.LockPreviousNextMonthTimesheetOn, 
                      dbo.AccountWorkingDayType.EnableBalanceValidationForTimeOff, dbo.Account.IsLock, dbo.AccountPreferences.IncludeCurrentYearInProjectCode, 
                      dbo.AccountPreferences.ShowAdditionalProjectInformationType, dbo.AccountPreferences.EnableOfflineTimesheet
FROM         dbo.SystemInvoiceBillingType RIGHT OUTER JOIN
                      dbo.AccountPreferences ON dbo.SystemInvoiceBillingType.InvoiceBillingTypeId = dbo.AccountPreferences.InvoiceBillingTypeId RIGHT OUTER JOIN
                      dbo.vueAccountTimesheetPeriodType RIGHT OUTER JOIN
                      dbo.AccountWorkingDayType ON 
                      dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId = dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId RIGHT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.Account ON dbo.AccountEmployee.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId ON 
                      dbo.AccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId ON 
                      dbo.AccountPreferences.AccountId = dbo.AccountEmployee.AccountId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId'

GO
-- Add Column [LockAllPeriodExceptPrevious] to [dbo].[AccountWorkingDayType]
Print 'Add Column [LockAllPeriodExceptPrevious] to [dbo].[AccountWorkingDayType]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountWorkingDayType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='LockAllPeriodExceptPrevious' AND TABLE_NAME='AccountWorkingDayType'))
ALTER TABLE [dbo].[AccountWorkingDayType]
	ADD [LockAllPeriodExceptPrevious] [int] NULL
	
GO
-- Add Column [LockAllPeriodExceptNext] to [dbo].[AccountWorkingDayType]
Print 'Add Column [LockAllPeriodExceptNext] to [dbo].[AccountWorkingDayType]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountWorkingDayType' AND TABLE_TYPE='BASE TABLE')) AND NOT (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='LockAllPeriodExceptNext' AND TABLE_NAME='AccountWorkingDayType'))
ALTER TABLE [dbo].[AccountWorkingDayType]
	ADD [LockAllPeriodExceptNext] [Int] NULL

GO
-- Drop View [dbo].[vueAccountWorkingDayType]
Print 'Drop View [dbo].[vueAccountWorkingDayType]'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountWorkingDayType' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountWorkingDayType]

GO
-- Drop View [dbo].[vueAccountEmployee]
Print 'Drop View [dbo].[vueAccountEmployee]'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployee]
                      
GO
-- Create View [dbo].[vueAccountWorkingDayType]
Print 'Create View [dbo].[vueAccountWorkingDayType]'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountWorkingDayType' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountWorkingDayType
AS
SELECT     dbo.AccountWorkingDayType.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountId, dbo.AccountWorkingDayType.AccountWorkingDayType, 
                      dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay, dbo.AccountWorkingDayType.CreatedByEmployeeId, 
                      dbo.AccountWorkingDayType.CreatedOn, dbo.AccountWorkingDayType.ModifiedByEmployeeId, dbo.AccountWorkingDayType.ModifiedOn, 
                      dbo.AccountWorkingDayType.IsDisabled, dbo.SystemWorkingDay.WorkingDay, dbo.AccountWorkingDayType.MasterWorkingDayTypeId, 
                      dbo.SystemWorkingDay.SQLServerWeekDayNo, dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, 
                      dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, 
                      dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod, dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId, 
                      dbo.AccountWorkingDayType.TimesheetOverdueAfterDays, ISNULL(dbo.AccountWorkingDayType.MinimumPercentagePerDay, 0) AS MinimumPercentagePerDay, 
                      ISNULL(dbo.AccountWorkingDayType.MaximumPercentagePerDay, 100) AS MaximumPercentagePerDay, 
                      ISNULL(dbo.AccountWorkingDayType.MinimumPercentagePerWeek, 0) AS MinimumPercentagePerWeek, 
                      ISNULL(dbo.AccountWorkingDayType.MaximumPercentagePerWeek, 500) AS MaximumPercentagePerWeek, 
                      dbo.AccountWorkingDayType.LockAllPreviousTimesheets, dbo.AccountWorkingDayType.LockAllFutureTimesheets, 
                      dbo.AccountWorkingDayType.LockPreviousTimesheetPeriods, dbo.AccountWorkingDayType.LockFutureTimsheetPeriods, 
                      dbo.AccountWorkingDayType.LockPreviousNextMonthTimesheetOn, dbo.AccountWorkingDayType.EnableBalanceValidationForTimeOff,
                      dbo.AccountWorkingDayType.LockAllPeriodExceptPrevious, dbo.AccountWorkingDayType.LockAllPeriodExceptNext
FROM         dbo.AccountWorkingDayType LEFT OUTER JOIN
                      dbo.vueAccountTimesheetPeriodType ON 
                      dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId = dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId LEFT OUTER JOIN
                      dbo.SystemWorkingDay ON dbo.AccountWorkingDayType.WeekStartDay = dbo.SystemWorkingDay.WorkingDayNo'                                                                                                                                                                       	

GO
-- Create View [dbo].[vueAccountEmployee]
Print 'Create View [dbo].[vueAccountEmployee]'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployee' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployee
AS
SELECT     dbo.AccountEmployee.AccountEmployeeId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, dbo.AccountEmployee.EMailAddress, 
                      dbo.AccountDepartment.DepartmentName, dbo.AccountRole.Role, dbo.AccountEmployee.AccountId, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountEmployee.Password, dbo.AccountEmployee.AccountDepartmentId, dbo.AccountEmployee.AccountLocationId, dbo.AccountEmployee.BillingTypeId, 
                      dbo.AccountBillingType.BillingType, 
                      CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
                       + '' '' + AccountEmployee.LastName END AS EmployeeName, dbo.AccountPreferences.ShowClockStartEnd, dbo.Account.TimeZoneId, 
                      dbo.AccountRole.MasterAccountRoleId, dbo.Account.DefaultCurrencyId, dbo.Account.CountryId, dbo.AccountPreferences.CultureInfoName, 
                      dbo.AccountPreferences.TimeEntryFormat, dbo.AccountEmployee.AllowedAccessFromIP, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountPreferences.AccountSessionTimeout, dbo.AccountPreferences.ShowCompletedTasksInTimeSheet, dbo.AccountPreferences.CurrencySymbol, 
                      dbo.AccountPreferences.IsCompanyOwnLogo, dbo.Account.AccountExpiryActivation, dbo.Account.LicenseActivation, dbo.AccountEmployee.EmployeeTypeId, 
                      dbo.AccountEmployee.ExternalUserClientId, dbo.AccountEmployee.AccountBillingRateId, dbo.AccountPreferences.ScheduledEmailSendTime, 
                      dbo.AccountEmployee.Username, dbo.AccountEmployee.IsDisabled, dbo.AccountPreferences.FromEmailAddress, 
                      dbo.AccountPreferences.FromEmailAddressDisplayName, dbo.AccountEmployee.EmployeeCode, dbo.AccountPreferences.Version, 
                      dbo.AccountPreferences.LockSubmittedRecords, dbo.AccountPreferences.LockApprovedRecords, ISNULL(dbo.AccountEmployee.EmployeeCode + '' - '', '''') 
                      + dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName AS EmployeeNameWithCode, dbo.AccountPreferences.ShowWorkTypeInTimeSheet, 
                      dbo.AccountPreferences.NumberOfBlankRowsInTimeEntry, dbo.AccountPreferences.ShowCostCenterInTimeSheet, dbo.AccountPreferences.WeekStartDay, 
                      dbo.AccountPreferences.AccountBaseCurrencyId, dbo.AccountEmployee.UserInterfaceLanguage, dbo.AccountEmployee.EmployeeManagerId, 
                      dbo.AccountPreferences.DefaultTimeEntryMode, dbo.AccountPreferences.PageSize, dbo.AccountEmployee.TimeZoneId AS EmployeeTimeZoneId, 
                      dbo.AccountEmployee.TerminationDate, dbo.AccountEmployee.StatusId, dbo.AccountEmployee.JobTitle, dbo.AccountEmployee.EmployeePayTypeId, 
                      dbo.AccountEmployee.HiredDate, dbo.AccountEmployee.AccountWorkingDayTypeId, dbo.AccountWorkingDayType.AccountWorkingDayType, 
                      dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.WeekStartDay AS EmployeeWeekStartDay, 
                      dbo.AccountPreferences.ShowClientInTimesheet, dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, 
                      dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountPreferences.ShowDescriptionInWeekView, 
                      dbo.AccountPreferences.InvoiceNoPrefix, dbo.AccountPreferences.ShowAdditionalTaskInformationType, 
                      dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodTypeId, dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriodId, 
                      ISNULL(dbo.vueAccountTimesheetPeriodType.InitialDayOfTheMonth, 1) AS InitialDayOfTheMonth, dbo.vueAccountTimesheetPeriodType.SystemTimesheetPeriodType, 
                      dbo.vueAccountTimesheetPeriodType.SystemInitialDaysOfThePeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfFirstPeriod, 1) 
                      AS SystemInitialDayOfFirstPeriod, ISNULL(dbo.vueAccountTimesheetPeriodType.SystemInitialDayOfLastPeriod, 16) AS SystemInitialDayOfLastPeriod, 
                      dbo.AccountEmployee.LastScheduledEmailSentTime, dbo.AccountPreferences.TimesheetPrintFooter, dbo.AccountPreferences.ExpenseSheetPrintFooter, 
                      dbo.AccountPreferences.ShowCompletedProjectsInTimeSheet, dbo.AccountPreferences.ShowProjectForTimeOff, dbo.AccountPreferences.ShowTimeOffInTimesheet, 
                      dbo.AccountEmployee.IsDeleted, dbo.AccountEmployee.IsForcePasswordChange, dbo.AccountEmployee.PasswordChangedDate, 
                      dbo.AccountPreferences.PasswordExpiryPeriod, dbo.AccountPreferences.ShowAllInTimesheetReadOnly, dbo.AccountPreferences.ShowTaskInExpenseSheet, 
                      dbo.AccountPreferences.InvoiceBillingTypeId, dbo.AccountPreferences.ShowBillingRateInInvoiceReport, dbo.SystemInvoiceBillingType.InvoiceBillingType, 
                      dbo.AccountPreferences.InvoiceFooter, dbo.AccountPreferences.TimesheetOverduePeriods, dbo.AccountWorkingDayType.TimesheetOverdueAfterDays, 
                      dbo.AccountEmployee.CreatedOn, dbo.AccountEmployee.CreatedByEmployeeId, dbo.AccountEmployee.ModifiedOn, dbo.AccountEmployee.ModifiedByEmployeeId, 
                      dbo.AccountPreferences.ShowProjectNameInInvoiceReport, dbo.AccountPreferences.ProjectCodePrefix, dbo.AccountPreferences.AutoGenerateProjectCode, 
                      dbo.AccountPreferences.TimeEntryHoursFormatId, dbo.AccountPreferences.ShowPercentageInTimesheet, dbo.AccountPreferences.EnablePasswordComplexity, 
                      dbo.AccountPreferences.ShowClientDepartmentInProject, dbo.AccountPreferences.ShowEntryDateInInvoiceReport, dbo.AccountPreferences.TimesheetSort, 
                      dbo.AccountPreferences.ShowCostCenterInTimesheetBy, dbo.AccountPreferences.ShowCopyTimesheetButton, 
                      dbo.AccountPreferences.ShowCopyActivitiesButtonInTimesheet, dbo.AccountPreferences.ShowProjectNameInTask, dbo.AccountPreferences.ShowClientNameInTask, 
                      dbo.AccountPreferences.IsShowElectronicSign, ISNULL(dbo.AccountWorkingDayType.MinimumPercentagePerDay, 0) AS MinimumPercentagePerDay, 
                      ISNULL(dbo.AccountWorkingDayType.MaximumPercentagePerDay, 100) AS MaximumPercentagePerDay, 
                      ISNULL(dbo.AccountWorkingDayType.MinimumPercentagePerWeek, 0) AS MinimumPercentagePerWeek, 
                      ISNULL(dbo.AccountWorkingDayType.MaximumPercentagePerWeek, 500) AS MaximumPercentagePerWeek, 
                      dbo.AccountPreferences.ShowCompletedProjectInProjectGrid, dbo.AccountPreferences.ShowEmployeeNameInInvoiceReport, 
                      dbo.AccountPreferences.CalculateTaskPercentageAutomatically, dbo.AccountWorkingDayType.LockAllPreviousTimesheets, 
                      dbo.AccountWorkingDayType.LockAllFutureTimesheets, dbo.AccountWorkingDayType.LockPreviousTimesheetPeriods, 
                      dbo.AccountWorkingDayType.LockFutureTimsheetPeriods, dbo.AccountWorkingDayType.LockPreviousNextMonthTimesheetOn, 
                      dbo.AccountWorkingDayType.EnableBalanceValidationForTimeOff, dbo.Account.IsLock, dbo.AccountPreferences.IncludeCurrentYearInProjectCode, 
                      dbo.AccountPreferences.ShowAdditionalProjectInformationType,
                      dbo.AccountWorkingDayType.LockAllPeriodExceptPrevious, dbo.AccountWorkingDayType.LockAllPeriodExceptNext, dbo.AccountPreferences.EnableOfflineTimesheet
FROM         dbo.SystemInvoiceBillingType RIGHT OUTER JOIN
                      dbo.AccountPreferences ON dbo.SystemInvoiceBillingType.InvoiceBillingTypeId = dbo.AccountPreferences.InvoiceBillingTypeId RIGHT OUTER JOIN
                      dbo.vueAccountTimesheetPeriodType RIGHT OUTER JOIN
                      dbo.AccountWorkingDayType ON 
                      dbo.vueAccountTimesheetPeriodType.AccountTimesheetPeriodTypeId = dbo.AccountWorkingDayType.AccountTimesheetPeriodTypeId RIGHT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.Account ON dbo.AccountEmployee.AccountId = dbo.Account.AccountId INNER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId ON 
                      dbo.AccountWorkingDayType.AccountWorkingDayTypeId = dbo.AccountEmployee.AccountWorkingDayTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId ON 
                      dbo.AccountPreferences.AccountId = dbo.AccountEmployee.AccountId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId'

GO
-- Drop View rptvueAccountProjectTeam
Print 'Drop View rptvueAccountProjectTeam'
GO
if exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectTeam' and table_type = 'VIEW')
DROP VIEW [dbo].[rptvueAccountProjectTeam]

GO
-- Drop View vueAccountProjectTeamForReport
Print 'Drop View vueAccountProjectTeamForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountProjectTeamForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountProjectTeamForReport]

GO
-- Create View vueAccountProjectTeamForReport
Print 'Create View vueAccountProjectTeamForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountProjectTeamForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountProjectTeamForReport
AS
SELECT     dbo.AccountProjectEmployee.AccountProjectEmployeeId, dbo.AccountProjectEmployee.AccountId, dbo.AccountProjectEmployee.AccountProjectId,
					  dbo.AccountProjectEmployee.AccountEmployeeId, dbo.AccountProjectEmployee.AccountRoleId, dbo.AccountProjectEmployee.AccountBillingRateId,
					  dbo.AccountProjectEmployee.AccountProjectEmployeeTemplateId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName,
					  dbo.AccountProject.AccountClientId, dbo.AccountProject.ProjectName, dbo.AccountBillingType.BillingType AS ProjectBillingType,
					  dbo.AccountDepartment.DepartmentName, dbo.AccountLocation.AccountLocation, dbo.AccountRole.Role, dbo.AccountEmployeeType.AccountEmployeeType,
					  dbo.AccountParty.PartyName AS ClientName, dbo.AccountStatus.Status AS ProjectStatus, AccountStatus_1.Status AS EmployeeStatus,
					  dbo.AccountWorkingDayType.AccountWorkingDayType, dbo.AccountWorkingDayType.HoursPerDay, dbo.AccountWorkingDayType.MinimumHoursPerDay,
					  dbo.AccountWorkingDayType.MaximumHoursPerDay, dbo.AccountWorkingDayType.MinimumHoursPerWeek, dbo.AccountWorkingDayType.MaximumHoursPerWeek,
					  dbo.AccountTimeOffPolicy.AccountTimeOffPolicy, dbo.AccountHolidayType.AccountHolidayType, dbo.AccountPartyContact.FirstName AS ClientContactFirstName,
					  dbo.AccountPartyContact.LastName AS ClientContactLastName, dbo.AccountPartyDepartment.PartyDepartmentCode AS ClientDepartmentCode,
					  dbo.AccountPartyDepartment.PartyDepartmentName AS ClientDepartmentName, dbo.AccountPartyDepartment.PartyDepartmentLocation AS ClientDepartmentLocation,
					  dbo.AccountProject.ProjectStatusId, dbo.AccountProjectType.ProjectType, dbo.AccountProject.AccountProjectTypeId, dbo.AccountProject.ProjectDescription,
					  dbo.AccountProject.StartDate AS ProjectStartDate, dbo.AccountProject.Deadline, dbo.AccountProject.EstimatedTime, dbo.AccountProject.EstimatedDuration,
					  dbo.AccountProject.EstimatedDurationUnit, dbo.AccountProject.ProjectCode, dbo.AccountProject.DefaultBillingRate AS ProjectBillingRate,
					  dbo.AccountProject.Completed, dbo.AccountProject.IsDisabled AS IsDisabledProject, dbo.AccountProject.IsDeleted AS IsDeletedProject,
					  dbo.AccountParty.PartyNick AS ClientNick, dbo.AccountParty.EMailAddress AS ClientEMailAddress, dbo.AccountParty.Address1 AS ClientAddress1,
					  dbo.AccountParty.Address2 AS ClientAddress2, dbo.AccountParty.State AS ClientState, dbo.AccountParty.City AS ClientCity,
					  dbo.AccountParty.ZipCode AS ClientZipCode, dbo.AccountParty.Telephone1 AS ClientTelephone1, dbo.AccountParty.Telephone2 AS ClientTelephone2,
					  dbo.AccountParty.Fax AS ClientFax, dbo.AccountEmployee.State AS EmployeeState, dbo.AccountEmployee.City AS EmployeeCity,
					  dbo.AccountEmployee.Zip AS EmployeeZip, dbo.AccountEmployee.WorkPhoneNo AS EmployeeWorkPhoneNo, dbo.AccountEmployee.TerminationDate,
					  dbo.AccountEmployee.EmployeeCode, dbo.AccountEmployee.HiredDate, dbo.AccountBillingRate.BillingRate, dbo.AccountBillingRate.StartDate AS BillingRateStartDate,
					  dbo.AccountBillingRate.EndDate AS BillingRateEndDate, dbo.AccountBillingRate.EmployeeRate,
					  CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
					  + '' '' + AccountEmployee.LastName END AS EmployeeName, SUM(DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n,
					  dbo.AccountEmployeeTimeEntry.TotalTime)) AS TotalMinutes
					  FROM dbo.AccountProjectEmployee INNER JOIN
					  dbo.AccountProject ON dbo.AccountProjectEmployee.AccountProjectId = dbo.AccountProject.AccountProjectId INNER JOIN
					  dbo.AccountEmployee ON dbo.AccountProjectEmployee.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId INNER JOIN
					  dbo.AccountBillingType ON dbo.AccountProject.ProjectBillingTypeId = dbo.AccountBillingType.AccountBillingTypeId INNER JOIN
					  dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId INNER JOIN
					  dbo.AccountStatus ON dbo.AccountProject.ProjectStatusId = dbo.AccountStatus.AccountStatusId INNER JOIN
					  dbo.AccountProjectType ON dbo.AccountProject.AccountProjectTypeId = dbo.AccountProjectType.AccountProjectTypeId LEFT OUTER JOIN
					  dbo.AccountEmployeeTimeEntry ON dbo.AccountEmployee.AccountEmployeeId = dbo.AccountEmployeeTimeEntry.AccountEmployeeId AND
					  dbo.AccountProject.AccountProjectId = dbo.AccountEmployeeTimeEntry.AccountProjectId LEFT OUTER JOIN
					  dbo.AccountBillingRate ON dbo.AccountProjectEmployee.AccountBillingRateId = dbo.AccountBillingRate.AccountBillingRateId LEFT OUTER JOIN
					  dbo.AccountPartyDepartment ON dbo.AccountProject.AccountPartyDepartmentId = dbo.AccountPartyDepartment.AccountPartyDepartmentId LEFT OUTER JOIN
					  dbo.AccountPartyContact ON dbo.AccountProject.AccountPartyContactId = dbo.AccountPartyContact.AccountPartyContactId LEFT OUTER JOIN
					  dbo.AccountHolidayType ON dbo.AccountEmployee.AccountHolidayTypeId = dbo.AccountHolidayType.AccountHolidayTypeId LEFT OUTER JOIN
					  dbo.AccountWorkingDayType ON dbo.AccountEmployee.AccountWorkingDayTypeId = dbo.AccountWorkingDayType.AccountWorkingDayTypeId LEFT OUTER JOIN
					  dbo.AccountTimeOffPolicy ON dbo.AccountEmployee.AccountTimeOffPolicyId = dbo.AccountTimeOffPolicy.AccountTimeOffPolicyId LEFT OUTER JOIN
					  dbo.AccountStatus AS AccountStatus_1 ON dbo.AccountEmployee.StatusId = AccountStatus_1.AccountStatusId LEFT OUTER JOIN
					  dbo.AccountEmployeeType ON dbo.AccountEmployee.EmployeePayTypeId = dbo.AccountEmployeeType.AccountEmployeeTypeId LEFT OUTER JOIN
					  dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId LEFT OUTER JOIN
					  dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
					  dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId
					  WHERE (dbo.AccountParty.IsDeleted <> 1) OR
					  (dbo.AccountParty.IsDeleted IS NULL)
					  GROUP BY dbo.AccountProjectEmployee.AccountProjectEmployeeId, dbo.AccountProjectEmployee.AccountId, dbo.AccountProjectEmployee.AccountProjectId,
					  dbo.AccountProjectEmployee.AccountEmployeeId, dbo.AccountProjectEmployee.AccountRoleId, dbo.AccountProjectEmployee.AccountBillingRateId,
					  dbo.AccountProjectEmployee.AccountProjectEmployeeTemplateId, dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName,
					  dbo.AccountProject.AccountClientId, dbo.AccountProject.ProjectName, dbo.AccountBillingType.BillingType, dbo.AccountDepartment.DepartmentName,
  					  dbo.AccountLocation.AccountLocation, dbo.AccountRole.Role, dbo.AccountEmployeeType.AccountEmployeeType, dbo.AccountParty.PartyName,
					  dbo.AccountStatus.Status, AccountStatus_1.Status, dbo.AccountWorkingDayType.AccountWorkingDayType, dbo.AccountWorkingDayType.HoursPerDay,
					  dbo.AccountWorkingDayType.MinimumHoursPerDay, dbo.AccountWorkingDayType.MaximumHoursPerDay, dbo.AccountWorkingDayType.MinimumHoursPerWeek,
					  dbo.AccountWorkingDayType.MaximumHoursPerWeek, dbo.AccountTimeOffPolicy.AccountTimeOffPolicy, dbo.AccountHolidayType.AccountHolidayType,
					  dbo.AccountPartyContact.FirstName, dbo.AccountPartyContact.LastName, dbo.AccountPartyDepartment.PartyDepartmentCode,
					  dbo.AccountPartyDepartment.PartyDepartmentName, dbo.AccountPartyDepartment.PartyDepartmentLocation, dbo.AccountProject.ProjectStatusId,
					  dbo.AccountProjectType.ProjectType, dbo.AccountProject.AccountProjectTypeId, dbo.AccountProject.ProjectDescription, dbo.AccountProject.StartDate,
					  dbo.AccountProject.Deadline, dbo.AccountProject.EstimatedTime, dbo.AccountProject.EstimatedDuration, dbo.AccountProject.EstimatedDurationUnit,
					  dbo.AccountProject.ProjectCode, dbo.AccountProject.DefaultBillingRate, dbo.AccountProject.Completed, dbo.AccountProject.IsDisabled, dbo.AccountProject.IsDeleted,
					  dbo.AccountParty.PartyNick, dbo.AccountParty.EMailAddress, dbo.AccountParty.Address1, dbo.AccountParty.Address2, dbo.AccountParty.State, dbo.AccountParty.City,
					  dbo.AccountParty.ZipCode, dbo.AccountParty.Telephone1, dbo.AccountParty.Telephone2, dbo.AccountParty.Fax, dbo.AccountEmployee.State,
					  dbo.AccountEmployee.City, dbo.AccountEmployee.Zip, dbo.AccountEmployee.WorkPhoneNo, dbo.AccountEmployee.TerminationDate,
					  dbo.AccountEmployee.EmployeeCode, dbo.AccountEmployee.HiredDate, dbo.AccountBillingRate.BillingRate, dbo.AccountBillingRate.StartDate,
					  dbo.AccountBillingRate.EndDate, dbo.AccountBillingRate.EmployeeRate,
					  CASE WHEN AccountEmployee.IsDisabled = 1 THEN AccountEmployee.FirstName + '' '' + AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE AccountEmployee.FirstName
					  + '' '' + AccountEmployee.LastName END'
                      
                       
GO
-- Create View rptvueAccountProjectTeam
Print 'Create View rptvueAccountProjectTeam'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountProjectTeam' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountProjectTeam
AS
SELECT AccountProjectEmployeeId, AccountId, AccountProjectId, AccountEmployeeId, AccountRoleId, AccountBillingRateId, AccountProjectEmployeeTemplateId, FirstName,
					  LastName, AccountClientId, ProjectName, ProjectBillingType, DepartmentName, AccountLocation, Role, AccountEmployeeType, ClientName, ProjectStatus,
					  EmployeeStatus, AccountWorkingDayType, HoursPerDay, MinimumHoursPerDay, MaximumHoursPerDay, MinimumHoursPerWeek, MaximumHoursPerWeek,
					  AccountTimeOffPolicy, AccountHolidayType, ClientContactFirstName, ClientContactLastName, ClientDepartmentCode, ClientDepartmentName,
					  ClientDepartmentLocation, ProjectStatusId, ProjectType, AccountProjectTypeId, ProjectDescription, ProjectStartDate, Deadline, EstimatedTime, EstimatedDuration,
					  EstimatedDurationUnit, ProjectCode, ProjectBillingRate, Completed, IsDisabledProject, IsDeletedProject, ClientNick, ClientEMailAddress, ClientAddress1,
					  ClientAddress2, ClientState, ClientCity, ClientZipCode, ClientTelephone1, ClientTelephone2, ClientFax, EmployeeState, EmployeeCity, EmployeeZip,
					  EmployeeWorkPhoneNo, TerminationDate, EmployeeCode, HiredDate, BillingRate, BillingRateStartDate, BillingRateEndDate, EmployeeRate, EmployeeName,
					  ROUND(CONVERT(float, TotalMinutes) / 60, 2) AS TotalHours, REPLACE(TotalMinutes / 60, '''', ''.00'') + '':'' + RIGHT(''0'' + REPLACE(TotalMinutes - TotalMinutes / 60 * 60, '''',
					  ''.00''), 2) AS TotalTime
FROM dbo.vueAccountProjectTeamForReport'


GO
-- Drop View vueAccountEmployeeTimeEntryWithTimeOffForReport
Print 'Drop View vueAccountEmployeeTimeEntryWithTimeOffForReport'
GO
if exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithTimeOffForReport' and table_type = 'VIEW')
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryWithTimeOffForReport]

GO
-- Drop View [dbo].[rptvueAccountEmployeeTimeEntry]
Print 'Drop View [dbo].[rptvueAccountEmployeeTimeEntry]'
GO
DROP VIEW [dbo].[rptvueAccountEmployeeTimeEntry]

GO
-- Drop View [dbo].[vueAccountEmployeeTimeEntryForReport]
Print 'Drop View [dbo].[vueAccountEmployeeTimeEntryForReport]'
GO
DROP VIEW [dbo].[vueAccountEmployeeTimeEntryForReport]


GO
-- Create View vueAccountEmployeeTimeEntryWithTimeOffForReport
Print 'Create View vueAccountEmployeeTimeEntryWithTimeOffForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryWithTimeOffForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport
AS
SELECT     CASE WHEN dbo.AccountEmployee.IsDisabled = 1 THEN dbo.AccountEmployee.FirstName + '' '' + dbo.AccountEmployee.LastName + '' '' + ''(Disabled)'' ELSE dbo.AccountEmployee.FirstName
                       + '' '' + dbo.AccountEmployee.LastName END AS EmployeeName, dbo.AccountProject.ProjectName, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 1 THEN AccountProjectTask_1.TaskName ELSE dbo.AccountTimeOffType.AccountTimeOffType END AS TaskName,
                       dbo.AccountEmployeeTimeEntry.TotalTime, dbo.AccountEmployeeTimeEntry.Approved, dbo.AccountEmployee.AccountEmployeeId, 
                      dbo.AccountProject.AccountProjectId, dbo.AccountEmployeeTimeEntry.TeamLeadApproved, dbo.AccountEmployeeTimeEntry.ProjectManagerApproved, 
                      dbo.AccountEmployeeTimeEntry.AdministratorApproved, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId, dbo.AccountEmployeeTimeEntry.StartTime, 
                      dbo.AccountEmployeeTimeEntry.EndTime, dbo.AccountEmployeeTimeEntry.TimeEntryDate, dbo.AccountEmployeeTimeEntry.Description, 
                      ISNULL(dbo.AccountProject.AccountId, dbo.AccountTimeOffType.AccountId) AS AccountId, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) 
                      * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime) AS TotalMinutes, DATEPART(dw, dbo.AccountEmployeeTimeEntry.TimeEntryDate) AS WeekDay, 
                      dbo.AccountParty.AccountPartyId, dbo.AccountParty.PartyName, AccountProjectTask_1.AccountProjectTaskId, dbo.AccountBillingType.BillingType, 
                      dbo.AccountProject.LeaderEmployeeId, dbo.AccountProject.ProjectManagerEmployeeId, dbo.AccountProject.TimeSheetApprovalTypeId, 
                      dbo.AccountProject.ExpenseApprovalTypeId, AccountProjectTask_1.IsBillable, dbo.AccountEmployeeTimeEntry.Rejected, dbo.AccountEmployeeTimeEntry.BillingRate, 
                      dbo.AccountProject.ProjectBillingRateTypeId, dbo.AccountEmployee.EmployeeCode, dbo.AccountEmployee.AccountDepartmentId, 
                      dbo.AccountDepartment.DepartmentName, AccountProjectTask_1.EstimatedCost, AccountProjectTask_1.EstimatedTimeSpent, 
                      dbo.AccountEmployeeTimeEntry.Submitted, dbo.AccountWorkType.AccountWorkType, dbo.AccountEmployee.EMailAddress, dbo.AccountLocation.AccountLocation, 
                      dbo.AccountCostCenter.AccountCostCenter, dbo.AccountCostCenter.AccountCostCenterCode, dbo.AccountWorkType.AccountWorkTypeCode, 
                      dbo.AccountProject.ProjectCode, AccountProjectTask_1.TaskCode, dbo.AccountLocation.AccountLocationId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction.Comments, dbo.AccountEmployeeTimeEntry.BillingRateCurrencyId, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateCurrencyId, dbo.AccountEmployeeTimeEntry.BillingRateExchangeRate, 
                      dbo.AccountEmployeeTimeEntry.EmployeeRateExchangeRate, dbo.AccountEmployeeTimeEntry.AccountBaseCurrencyId, AccountProjectTask_1.AccountTaskTypeId, 
                      AccountProjectTask_1.TaskStatusId, AccountProjectTask_1.AccountPriorityId, AccountProjectTask_1.AccountProjectMilestoneId, 
                      dbo.AccountDepartment.DepartmentCode, dbo.AccountParty.PartyNick, AccountProjectTask_1.EstimatedCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction.ApprovedOn, dbo.AccountEmployeeTimeEntry.EmployeeRate, dbo.AccountRole.AccountRoleId, 
                      dbo.AccountRole.Role, dbo.AccountProject.AccountProjectTypeId, dbo.AccountProject.ProjectDescription, AccountProjectTask_1.TaskDescription, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeExpenseBillingTimesheetId, dbo.AccountEmployeeTimeEntry.Billed, 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryApprovalProjectId, dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Submitted = 1 THEN (CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, 
                      dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS SubmittedHours, CASE WHEN dbo.AccountEmployeeTimeEntry.Approved = 1 THEN (CONVERT(float, 
                      DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS ApprovedHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.Rejected = 1 THEN (CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, 
                      dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS RejectedHours, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryStartDate, 
                      dbo.AccountEmployeeTimeEntryPeriod.TimeEntryEndDate, dbo.AccountEmployeeTimeEntryPeriod.TimeEntryViewType, 
                      dbo.AccountPartyContact.FirstName + N'' '' + dbo.AccountPartyContact.LastName AS ClientContactName, 
                      dbo.AccountPartyDepartment.PartyDepartmentCode AS ClientDepartmentCode, dbo.AccountPartyDepartment.PartyDepartmentName AS ClientDepartmentName, 
                      dbo.AccountPartyDepartment.PartyDepartmentLocation AS ClientDepartmentLocation, dbo.AccountEmployeeTimeEntry.IsTimeOff, 
                      dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId, CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 0 THEN (CONVERT(float, DATEPART(hh, 
                      dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS TimeOffHours, 
                      CASE WHEN dbo.AccountEmployeeTimeEntry.IsTimeOff <> 1 THEN (CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, 
                      dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) END AS TimesheetHours, dbo.AccountWorkType.AccountWorkTypeId, dbo.AccountStatus.Status AS ProjectStatus, 
                      AccountProjectTask_1.ParentAccountProjectTaskId, dbo.AccountProjectTask.TaskName AS ParentTaskName, dbo.AccountEmployee.IsDisabled, 
                      dbo.AccountEmployee.FirstName, dbo.AccountEmployee.LastName, ISNULL(dbo.AccountEmployeeType.AccountEmployeeType, N'''') AS EmployeeType, 
                      ISNULL(dbo.AccountHolidayTypeDetail.HolidayName, N'''') AS HolidayName, dbo.AccountEmployeeTimeEntry.Percentage, 
                      dbo.AccountEmployeeTimeEntry.CustomField1, dbo.AccountEmployeeTimeEntry.CustomField2, dbo.AccountEmployeeTimeEntry.CustomField3, 
                      dbo.AccountEmployeeTimeEntry.CustomField4, dbo.AccountEmployeeTimeEntry.CustomField5, dbo.AccountEmployeeTimeEntry.CustomField6, 
                      dbo.AccountEmployeeTimeEntry.CustomField7, dbo.AccountEmployeeTimeEntry.CustomField8, dbo.AccountEmployeeTimeEntry.CustomField9, 
                      dbo.AccountEmployeeTimeEntry.CustomField10, dbo.AccountEmployeeTimeEntry.CustomField11, dbo.AccountEmployeeTimeEntry.CustomField12, 
                      dbo.AccountEmployeeTimeEntry.CustomField13, dbo.AccountEmployeeTimeEntry.CustomField14, dbo.AccountEmployeeTimeEntry.CustomField15, 
                      AccountProjectTask_1.StartDate AS TaskStartDate, AccountProjectTask_1.DeadlineDate AS TaskDeadlineDate, dbo.AccountParty.IsDeleted, 
                      CASE WHEN AccountProjectTask_1.IsBillable = 1 THEN (CONVERT(float, DATEPART(hh, dbo.AccountEmployeeTimeEntry.TotalTime) * 60 + DATEPART(n, 
                      dbo.AccountEmployeeTimeEntry.TotalTime)) / 60) ELSE 0 END AS BillableHours, AccountProjectTask_1.CustomField1 AS TaskCustomField1, 
                      AccountProjectTask_1.CustomField2 AS TaskCustomField2, AccountProjectTask_1.CustomField3 AS TaskCustomField3, 
                      AccountProjectTask_1.CustomField4 AS TaskCustomField4, AccountProjectTask_1.CustomField5 AS TaskCustomField5, 
                      AccountProjectTask_1.CustomField6 AS TaskCustomField6, AccountProjectTask_1.CustomField7 AS TaskCustomField7, 
                      AccountProjectTask_1.CustomField8 AS TaskCustomField8, AccountProjectTask_1.CustomField9 AS TaskCustomField9, 
                      AccountProjectTask_1.CustomField10 AS TaskCustomField10, AccountProjectTask_1.CustomField11 AS TaskCustomField11, 
                      AccountProjectTask_1.CustomField12 AS TaskCustomField12, AccountProjectTask_1.CustomField13 AS TaskCustomField13, 
                      AccountProjectTask_1.CustomField14 AS TaskCustomField14, AccountProjectTask_1.CustomField15 AS TaskCustomField15, dbo.AccountEmployee.JobTitle
FROM         dbo.AccountHolidayTypeDetail RIGHT OUTER JOIN
                      dbo.AccountEmployeeTimeEntry INNER JOIN
                      dbo.AccountEmployee ON dbo.AccountEmployeeTimeEntry.AccountEmployeeId = dbo.AccountEmployee.AccountEmployeeId ON 
                      dbo.AccountHolidayTypeDetail.AccountHolidayTypeId = dbo.AccountEmployee.AccountHolidayTypeId AND 
                      dbo.AccountHolidayTypeDetail.AccountId = dbo.AccountEmployee.AccountId AND 
                      dbo.AccountHolidayTypeDetail.HolidayDate = dbo.AccountEmployeeTimeEntry.TimeEntryDate LEFT OUTER JOIN
                      dbo.AccountEmployeeType ON dbo.AccountEmployee.EmployeePayTypeId = dbo.AccountEmployeeType.AccountEmployeeTypeId LEFT OUTER JOIN
                      dbo.AccountProjectTask AS AccountProjectTask_1 LEFT OUTER JOIN
                      dbo.AccountProjectTask ON AccountProjectTask_1.ParentAccountProjectTaskId = dbo.AccountProjectTask.AccountProjectTaskId ON 
                      dbo.AccountEmployeeTimeEntry.AccountProjectTaskId = AccountProjectTask_1.AccountProjectTaskId LEFT OUTER JOIN
                      dbo.AccountProject ON dbo.AccountEmployeeTimeEntry.AccountProjectId = dbo.AccountProject.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountStatus ON dbo.AccountProject.ProjectStatusId = dbo.AccountStatus.AccountStatusId LEFT OUTER JOIN
                      dbo.AccountTimeOffType ON dbo.AccountEmployeeTimeEntry.AccountTimeOffTypeId = dbo.AccountTimeOffType.AccountTimeOffTypeId LEFT OUTER JOIN
                      dbo.AccountPartyDepartment ON dbo.AccountProject.AccountPartyDepartmentId = dbo.AccountPartyDepartment.AccountPartyDepartmentId LEFT OUTER JOIN
                      dbo.AccountPartyContact ON dbo.AccountProject.AccountPartyContactId = dbo.AccountPartyContact.AccountPartyContactId LEFT OUTER JOIN
                      dbo.AccountEmployeeTimeEntryPeriod ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryPeriodId = dbo.AccountEmployeeTimeEntryPeriod.AccountEmployeeTimeEntryPeriodId LEFT OUTER JOIN
                      dbo.AccountLocation ON dbo.AccountEmployee.AccountLocationId = dbo.AccountLocation.AccountLocationId LEFT OUTER JOIN
                      dbo.AccountRole ON dbo.AccountEmployee.AccountRoleId = dbo.AccountRole.AccountRoleId LEFT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryApprovalLastAction ON 
                      dbo.AccountEmployeeTimeEntry.AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryApprovalLastAction.AccountEmployeeTimeEntryId LEFT OUTER JOIN
                      dbo.AccountCostCenter ON dbo.AccountEmployeeTimeEntry.AccountCostCenterId = dbo.AccountCostCenter.AccountCostCenterId LEFT OUTER JOIN
                      dbo.AccountWorkType ON dbo.AccountEmployeeTimeEntry.AccountWorkTypeId = dbo.AccountWorkType.AccountWorkTypeId LEFT OUTER JOIN
                      dbo.AccountDepartment ON dbo.AccountEmployee.AccountDepartmentId = dbo.AccountDepartment.AccountDepartmentId LEFT OUTER JOIN
                      dbo.AccountBillingType ON dbo.AccountEmployee.BillingTypeId = dbo.AccountBillingType.AccountBillingTypeId LEFT OUTER JOIN
                      dbo.AccountParty ON dbo.AccountProject.AccountClientId = dbo.AccountParty.AccountPartyId
                      WHERE (dbo.AccountParty.IsDeleted <> 1) OR (dbo.AccountParty.IsDeleted IS NULL)'
                      
                      
GO
-- Create View vueAccountEmployeeTimeEntryForReport
Print 'Create View vueAccountEmployeeTimeEntryForReport'
GO
if not exists (select * from information_schema.tables where table_name = 'vueAccountEmployeeTimeEntryForReport' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.vueAccountEmployeeTimeEntryForReport
AS
SELECT     dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeName, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskName, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalTime, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Approved, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TeamLeadApproved, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectManagerApproved, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AdministratorApproved, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeTimeEntryId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.StartTime, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EndTime, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Description, N'''') AS Description, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.WeekDay, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountPartyId AS AccountClientId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.PartyName AS ClientName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectTaskId, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingType, N'''') 
                      AS BillingType, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectManagerEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ExpenseApprovalTypeId, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.IsBillable, 0) 
                      AS IsBillable, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Rejected, 0) AS Rejected, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRate, 0) AS BillingRate, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectBillingRateTypeId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeCode, N'''') AS EmployeeCode, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountDepartmentId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.DepartmentName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedCost, 0) AS EstimatedCost, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedTimeSpent, 0) AS EstimatedHours, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Submitted, 0) AS Submitted, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountWorkType, N'''') AS AccountWorkType, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EMailAddress, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountLocation, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountCostCenter, N'''') AS AccountCostCenter, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountCostCenterCode, N'''') AS AccountCostCenterCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountWorkTypeCode, N'''') AS AccountWorkTypeCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectCode, N'''') AS ProjectCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCode, N'''') AS TaskCode, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountLocationId, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Comments, N'''') 
                      AS ApproverComments, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes * dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRate / 60, 0) 
                      AS Amount, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRateCurrencyId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateExchangeRate, 0) AS BillingRateExchangeRate, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRateExchangeRate, 0) AS EmployeeRateExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountBaseCurrencyId, dbo.vueAccountCurrency.CurrencyCode AS BillingRateCurrencyCode, 
                      dbo.vueAccountCurrency.CurrencyCode AS AmountCurrencyCode, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountTaskTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskStatusId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountPriorityId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectMilestoneId, dbo.AccountTaskType.TaskType, dbo.AccountStatus.Status AS TaskStatus, 
                      dbo.AccountProjectMilestone.MilestoneDescription, dbo.AccountPriority.Priority, CONVERT(float, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes) / 60 AS TotalHours, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.DepartmentCode, N'''') AS DepartmentCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.PartyNick, N'''') AS ClientNick, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedCurrencyId, vueAccountCurrency_1.CurrencyCode AS EstimatedCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ApprovedOn, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRate, 0) 
                      AS EmployeeRate, vueAccountCurrency_2.CurrencyCode AS EmployeeRateCurrencyCode, 
                      AccountEmployee_1.FirstName + '' '' + AccountEmployee_1.LastName AS TeamLeader, 
                      AccountEmployee_2.FirstName + '' '' + AccountEmployee_2.LastName AS ProjectManager, 
                      ISNULL(dbo.AccountEmployee.FirstName + N'' '' + dbo.AccountEmployee.LastName, N'''') AS EmployeeManager, 
                      vueAccountCurrency_1.ExchangeRate AS EstimatedCurrencyExchangeRate, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TotalMinutes * dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRate / 60, 0) 
                      AS EmployeeCost, { fn DAYOFMONTH(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) } AS DayNo, 
                      MONTH(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) AS MonthNo, DATEPART(week, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) - DATEPART(week, DATEADD(month, DATEDIFF(month, 0, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate), 0)) + 1 AS WeekNo, 
                      YEAR(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) AS Year, 
                      LEFT({ fn MONTHNAME(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) }, 3) + '' - '' + CONVERT(nvarchar(10), 
                      YEAR(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate)) AS Period, 
                      { fn DAYNAME(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TimeEntryDate) } AS WeekDayName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountRoleId, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Role, 
                      dbo.AccountProjectType.ProjectType, dbo.AccountRole.Role AS ProjectRole, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectDescription, N'''') 
                      AS ProjectDescription, ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskDescription, N'''') AS TaskDescription, 
                      dbo.AccountTimeExpenseBilling.InvoiceNumber, dbo.AccountTimeExpenseBilling.InvoiceDate, dbo.AccountProjectType.AccountProjectTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.Billed, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeTimeEntryPeriodId, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientContactName, N'''') AS ClientContactName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentCode, N'''') AS ClientDepartmentCode, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentName, N'''') AS ClientDepartmentName, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ClientDepartmentLocation, N'''') AS ClientDepartmentLocation, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.IsTimeOff, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountWorkTypeId, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectStatus, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ParentTaskName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.FirstName, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.LastName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeType, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.HolidayName, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField1, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField2, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField3, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField4, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField5, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField6, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField7, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField8, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField9, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField10, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField11, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField12, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField13, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField14, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.CustomField15, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskStartDate, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskDeadlineDate, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField1, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField2, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField3, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField4, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField5, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField6, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField7, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField8, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField9, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField10, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField11, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField12, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField13, 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField14, dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskCustomField15,
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.JobTitle
FROM         dbo.AccountRole INNER JOIN
                      dbo.AccountProjectEmployee ON dbo.AccountRole.AccountRoleId = dbo.AccountProjectEmployee.AccountRoleId RIGHT OUTER JOIN
                      dbo.AccountTimeExpenseBillingTimesheet INNER JOIN
                      dbo.AccountTimeExpenseBilling ON 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingId = dbo.AccountTimeExpenseBilling.AccountTimeExpenseBillingId RIGHT OUTER JOIN
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport LEFT OUTER JOIN
                      dbo.AccountProjectType ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectTypeId = dbo.AccountProjectType.AccountProjectTypeId LEFT OUTER JOIN
                      dbo.AccountProjectMilestone ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectMilestoneId = dbo.AccountProjectMilestone.AccountProjectMilestoneId LEFT OUTER JOIN
                      dbo.AccountStatus ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.TaskStatusId = dbo.AccountStatus.AccountStatusId LEFT OUTER JOIN
                      dbo.AccountPriority ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountPriorityId = dbo.AccountPriority.AccountPriorityId LEFT OUTER JOIN
                      dbo.AccountTaskType ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountTaskTypeId = dbo.AccountTaskType.AccountTaskTypeId ON 
                      dbo.AccountTimeExpenseBillingTimesheet.AccountTimeExpenseBillingTimesheetId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountTimeExpenseBillingTimesheetId
                       ON dbo.AccountProjectEmployee.AccountEmployeeId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeId AND 
                      dbo.AccountProjectEmployee.AccountProjectId = dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountProjectId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_1 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.LeaderEmployeeId = AccountEmployee_1.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee AS AccountEmployee_2 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.ProjectManagerEmployeeId = AccountEmployee_2.AccountEmployeeId LEFT OUTER JOIN
                      dbo.AccountEmployee INNER JOIN
                      dbo.AccountEmployee AS AccountEmployee_3 ON dbo.AccountEmployee.AccountEmployeeId = AccountEmployee_3.EmployeeManagerId ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.AccountEmployeeId = AccountEmployee_3.AccountEmployeeId LEFT OUTER JOIN
                      dbo.vueAccountCurrency AS vueAccountCurrency_2 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EmployeeRateCurrencyId = vueAccountCurrency_2.AccountCurrencyId LEFT OUTER JOIN
                      dbo.vueAccountCurrency AS vueAccountCurrency_1 ON 
                      dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.EstimatedCurrencyId = vueAccountCurrency_1.AccountCurrencyId LEFT OUTER JOIN
                      dbo.vueAccountCurrency ON dbo.vueAccountEmployeeTimeEntryWithTimeOffForReport.BillingRateCurrencyId = dbo.vueAccountCurrency.AccountCurrencyId'

GO
-- Create View rptvueAccountEmployeeTimeEntry
Print 'Create View rptvueAccountEmployeeTimeEntry'
GO
if not exists (select * from information_schema.tables where table_name = 'rptvueAccountEmployeeTimeEntry' and table_type = 'VIEW') 
EXEC sp_executesql N'
CREATE VIEW dbo.rptvueAccountEmployeeTimeEntry
AS
SELECT     dbo.vueAccountEmployeeTimeEntryForReport.EmployeeName, dbo.vueAccountEmployeeTimeEntryForReport.ProjectName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskName, dbo.vueAccountEmployeeTimeEntryForReport.TotalTime, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Approved, dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectId, dbo.vueAccountEmployeeTimeEntryForReport.TeamLeadApproved, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManagerApproved, dbo.vueAccountEmployeeTimeEntryForReport.AdministratorApproved, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeTimeEntryId, dbo.vueAccountEmployeeTimeEntryForReport.StartTime, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EndTime, dbo.vueAccountEmployeeTimeEntryForReport.TimeEntryDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Description, dbo.vueAccountEmployeeTimeEntryForReport.AccountId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TotalMinutes, dbo.vueAccountEmployeeTimeEntryForReport.WeekDay, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientName, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectTaskId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingType, dbo.vueAccountEmployeeTimeEntryForReport.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManagerEmployeeId, dbo.vueAccountEmployeeTimeEntryForReport.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ExpenseApprovalTypeId, dbo.vueAccountEmployeeTimeEntryForReport.IsBillable, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Rejected, dbo.vueAccountEmployeeTimeEntryForReport.BillingRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectBillingRateTypeId, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountDepartmentId, dbo.vueAccountEmployeeTimeEntryForReport.DepartmentName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCost, dbo.vueAccountEmployeeTimeEntryForReport.EstimatedHours, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Submitted, dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkType, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EMailAddress, dbo.vueAccountEmployeeTimeEntryForReport.AccountLocation, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountCostCenter, dbo.vueAccountEmployeeTimeEntryForReport.AccountCostCenterCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkTypeCode, dbo.vueAccountEmployeeTimeEntryForReport.ProjectCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCode, dbo.vueAccountEmployeeTimeEntryForReport.AccountLocationId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ApproverComments, dbo.vueAccountEmployeeTimeEntryForReport.Amount, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingRateCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountBaseCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.BillingRateCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AmountCurrencyCode, CASE WHEN vueAccountEmployeeTimeEntryForReport.Submitted = 1 AND 
                      vueAccountEmployeeTimeEntryForReport.Approved = 0 THEN ''Submitted'' WHEN vueAccountEmployeeTimeEntryForReport.Approved = 1 THEN ''Approved'' WHEN vueAccountEmployeeTimeEntryForReport.Rejected
                       = 1 THEN ''Rejected'' WHEN vueAccountEmployeeTimeEntryForReport.Submitted = 0 AND vueAccountEmployeeTimeEntryForReport.Approved = 0 AND 
                      vueAccountEmployeeTimeEntryForReport.Rejected = 0 THEN ''Not Submitted'' END AS ApprovalStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountTaskTypeId, dbo.vueAccountEmployeeTimeEntryForReport.TaskStatusId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountPriorityId, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectMilestoneId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskType, dbo.vueAccountEmployeeTimeEntryForReport.TaskStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.MilestoneDescription, dbo.vueAccountEmployeeTimeEntryForReport.Priority, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TotalHours, dbo.vueAccountEmployeeTimeEntryForReport.DepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientNick, dbo.vueAccountEmployeeTimeEntryForReport.AccountClientId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ApprovedOn, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateCurrencyCode, dbo.vueAccountEmployeeTimeEntryForReport.TeamLeader, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManager, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeManager, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate, 0) AS EstimatedCurrencyExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCost, dbo.vueAccountEmployeeTimeEntryForReport.AccountRoleId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Role, dbo.vueAccountEmployeeTimeEntryForReport.WeekDayName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Period, dbo.vueAccountEmployeeTimeEntryForReport.Year, dbo.vueAccountEmployeeTimeEntryForReport.WeekNo, 
                      dbo.vueAccountEmployeeTimeEntryForReport.MonthNo, dbo.vueAccountEmployeeTimeEntryForReport.DayNo, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 1 THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours ELSE 0 END AS BillableTotalHours,
                       CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable
                       IS NULL THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours ELSE 0 END AS NonBillableTotalHours, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCost / dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate
                       ELSE 0 END AS CurrencyEmployeeCost, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.Amount / dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate
                       ELSE 0 END AS CurrencyAmount, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCost / dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate
                       ELSE 0 END AS CurrencyEstimatedCost, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate / dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate
                       ELSE 0 END AS CurrencyBillingRate, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRate / dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate
                       ELSE 0 END AS CurrencyEmployeeRate, dbo.vueAccountEmployeeTimeEntryForReport.ProjectRole, dbo.vueAccountEmployeeTimeEntryForReport.ProjectType, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectDescription, dbo.vueAccountEmployeeTimeEntryForReport.TaskDescription, 
                      dbo.vueAccountEmployeeTimeEntryForReport.InvoiceNumber, dbo.vueAccountEmployeeTimeEntryForReport.InvoiceDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectTypeId, dbo.vueAccountEmployeeTimeEntryForReport.Billed, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientContactName, dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentName, dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentLocation, 
                      dbo.vueAccountEmployeeTimeEntryForReport.IsTimeOff, dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkTypeId, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 1 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate * dbo.vueAccountEmployeeTimeEntryForReport.TotalHours
                       ELSE 0 END AS BillableTotalAmount, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate * dbo.vueAccountEmployeeTimeEntryForReport.TotalHours
                       ELSE 0 END AS NonBillableTotalAmount, dbo.vueAccountEmployeeTimeEntryForReport.ProjectStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ParentTaskName, dbo.vueAccountEmployeeTimeEntryForReport.FirstName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.LastName, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeType, 
                      dbo.vueAccountEmployeeTimeEntryForReport.HolidayName, SUM(ISNULL(dbo.vueAccountEmployeeTimeEntryWithLastStatus.Percentage, 0)) AS Percentage, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField1, dbo.vueAccountEmployeeTimeEntryForReport.CustomField2, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField3, dbo.vueAccountEmployeeTimeEntryForReport.CustomField4, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField5, dbo.vueAccountEmployeeTimeEntryForReport.CustomField6, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField7, dbo.vueAccountEmployeeTimeEntryForReport.CustomField8, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField9, dbo.vueAccountEmployeeTimeEntryForReport.CustomField10, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField11, dbo.vueAccountEmployeeTimeEntryForReport.CustomField12, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField13, dbo.vueAccountEmployeeTimeEntryForReport.CustomField14, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField15, dbo.vueAccountEmployeeTimeEntryForReport.TaskStartDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskDeadlineDate, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField1, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField2, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField3, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField4, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField5, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField6, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField7, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField8, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField9, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField10, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField11, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField12, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField13, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField14, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField15,
                      dbo.vueAccountEmployeeTimeEntryForReport.JobTitle
FROM         dbo.vueAccountEmployeeTimeEntryForReport INNER JOIN
                      dbo.vueAccountEmployeeTimeEntryWithLastStatus ON 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeTimeEntryId = dbo.vueAccountEmployeeTimeEntryWithLastStatus.AccountEmployeeTimeEntryId
GROUP BY dbo.vueAccountEmployeeTimeEntryForReport.EmployeeName, dbo.vueAccountEmployeeTimeEntryForReport.ProjectName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskName, dbo.vueAccountEmployeeTimeEntryForReport.TotalTime, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeId, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountEmployeeTimeEntryId, dbo.vueAccountEmployeeTimeEntryForReport.StartTime, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EndTime, dbo.vueAccountEmployeeTimeEntryForReport.TimeEntryDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Description, dbo.vueAccountEmployeeTimeEntryForReport.AccountId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TotalMinutes, dbo.vueAccountEmployeeTimeEntryForReport.WeekDay, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientName, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectTaskId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingType, dbo.vueAccountEmployeeTimeEntryForReport.LeaderEmployeeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManagerEmployeeId, dbo.vueAccountEmployeeTimeEntryForReport.TimeSheetApprovalTypeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ExpenseApprovalTypeId, dbo.vueAccountEmployeeTimeEntryForReport.BillingRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectBillingRateTypeId, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountDepartmentId, dbo.vueAccountEmployeeTimeEntryForReport.DepartmentName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCost, dbo.vueAccountEmployeeTimeEntryForReport.EstimatedHours, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkType, dbo.vueAccountEmployeeTimeEntryForReport.EMailAddress, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountLocation, dbo.vueAccountEmployeeTimeEntryForReport.AccountCostCenter, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountCostCenterCode, dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkTypeCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectCode, dbo.vueAccountEmployeeTimeEntryForReport.TaskCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountLocationId, dbo.vueAccountEmployeeTimeEntryForReport.ApproverComments, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Amount, dbo.vueAccountEmployeeTimeEntryForReport.BillingRateCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate, dbo.vueAccountEmployeeTimeEntryForReport.AccountBaseCurrencyId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.BillingRateCurrencyCode, dbo.vueAccountEmployeeTimeEntryForReport.AmountCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountTaskTypeId, dbo.vueAccountEmployeeTimeEntryForReport.TaskStatusId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountPriorityId, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectMilestoneId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskType, dbo.vueAccountEmployeeTimeEntryForReport.TaskStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.MilestoneDescription, dbo.vueAccountEmployeeTimeEntryForReport.Priority, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TotalHours, dbo.vueAccountEmployeeTimeEntryForReport.DepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientNick, dbo.vueAccountEmployeeTimeEntryForReport.AccountClientId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyId, dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ApprovedOn, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateCurrencyCode, dbo.vueAccountEmployeeTimeEntryForReport.TeamLeader, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManager, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeManager, 
                      ISNULL(dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate, 0), dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCost, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountRoleId, dbo.vueAccountEmployeeTimeEntryForReport.Role, 
                      dbo.vueAccountEmployeeTimeEntryForReport.WeekDayName, dbo.vueAccountEmployeeTimeEntryForReport.Period, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Year, dbo.vueAccountEmployeeTimeEntryForReport.WeekNo, dbo.vueAccountEmployeeTimeEntryForReport.MonthNo, 
                      dbo.vueAccountEmployeeTimeEntryForReport.DayNo, dbo.vueAccountEmployeeTimeEntryForReport.ProjectRole, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectType, dbo.vueAccountEmployeeTimeEntryForReport.ProjectDescription, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskDescription, dbo.vueAccountEmployeeTimeEntryForReport.InvoiceNumber, 
                      dbo.vueAccountEmployeeTimeEntryForReport.InvoiceDate, dbo.vueAccountEmployeeTimeEntryForReport.AccountProjectTypeId, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientContactName, dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentCode, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentName, dbo.vueAccountEmployeeTimeEntryForReport.ClientDepartmentLocation, 
                      dbo.vueAccountEmployeeTimeEntryForReport.AccountWorkTypeId, dbo.vueAccountEmployeeTimeEntryForReport.ProjectStatus, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ParentTaskName, dbo.vueAccountEmployeeTimeEntryForReport.FirstName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.LastName, dbo.vueAccountEmployeeTimeEntryForReport.EmployeeType, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Approved, dbo.vueAccountEmployeeTimeEntryForReport.TeamLeadApproved, 
                      dbo.vueAccountEmployeeTimeEntryForReport.ProjectManagerApproved, dbo.vueAccountEmployeeTimeEntryForReport.AdministratorApproved, 
                      dbo.vueAccountEmployeeTimeEntryForReport.IsBillable, dbo.vueAccountEmployeeTimeEntryForReport.Rejected, 
                      dbo.vueAccountEmployeeTimeEntryForReport.Submitted, dbo.vueAccountEmployeeTimeEntryForReport.Billed, 
                      dbo.vueAccountEmployeeTimeEntryForReport.IsTimeOff, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate * dbo.vueAccountEmployeeTimeEntryForReport.TotalHours
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 1 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate * dbo.vueAccountEmployeeTimeEntryForReport.TotalHours
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRate / dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRate / dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCost / dbo.vueAccountEmployeeTimeEntryForReport.EstimatedCurrencyExchangeRate
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.Amount / dbo.vueAccountEmployeeTimeEntryForReport.BillingRateExchangeRate
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate > 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.EmployeeCost / dbo.vueAccountEmployeeTimeEntryForReport.EmployeeRateExchangeRate
                       ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 0 THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable
                       IS NULL THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours ELSE 0 END, 
                      CASE WHEN dbo.vueAccountEmployeeTimeEntryForReport.IsBillable = 1 THEN dbo.vueAccountEmployeeTimeEntryForReport.TotalHours ELSE 0 END, 
                      CASE WHEN vueAccountEmployeeTimeEntryForReport.Submitted = 1 AND 
                      vueAccountEmployeeTimeEntryForReport.Approved = 0 THEN ''Submitted'' WHEN vueAccountEmployeeTimeEntryForReport.Approved = 1 THEN ''Approved'' WHEN vueAccountEmployeeTimeEntryForReport.Rejected
                       = 1 THEN ''Rejected'' WHEN vueAccountEmployeeTimeEntryForReport.Submitted = 0 AND vueAccountEmployeeTimeEntryForReport.Approved = 0 AND 
                      vueAccountEmployeeTimeEntryForReport.Rejected = 0 THEN ''Not Submitted'' END, dbo.vueAccountEmployeeTimeEntryForReport.HolidayName, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField1, dbo.vueAccountEmployeeTimeEntryForReport.CustomField2, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField3, dbo.vueAccountEmployeeTimeEntryForReport.CustomField4, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField5, dbo.vueAccountEmployeeTimeEntryForReport.CustomField6, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField7, dbo.vueAccountEmployeeTimeEntryForReport.CustomField8, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField9, dbo.vueAccountEmployeeTimeEntryForReport.CustomField10, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField11, dbo.vueAccountEmployeeTimeEntryForReport.CustomField12, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField13, dbo.vueAccountEmployeeTimeEntryForReport.CustomField14, 
                      dbo.vueAccountEmployeeTimeEntryForReport.CustomField15, dbo.vueAccountEmployeeTimeEntryForReport.TaskStartDate, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskDeadlineDate, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField1, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField2, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField3, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField4, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField5, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField6, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField7, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField8, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField9, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField10, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField11, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField12, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField13, 
                      dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField14, dbo.vueAccountEmployeeTimeEntryForReport.TaskCustomField15,
                      dbo.vueAccountEmployeeTimeEntryForReport.JobTitle'                                            

GO
-- =======================================================
-- Synchronization Script for Table: [dbo].[SystemReportDataSourceField]
-- =======================================================
Print 'Synchronization Script for Table: [dbo].[SystemReportDataSourceField]'
If Not Exists(Select * from [dbo].[SystemReportDataSourceField] Where [SystemReportDataSourceFieldId] = '27F7F13E-3197-403C-8465-A907AE81D942')
BEGIN
INSERT INTO [dbo].[SystemReportDataSourceField] ([SystemReportDataSourceFieldId], [SystemReportDataSourceId], [SystemReportDataSourceField], [SystemReportDataSourceFieldWidth], [DefaultAvailable], [CurrencyField], [Formula], [SystemReportDataSourceFieldColumnOrder], [SystemReportFieldTypeId], [SystemReportDataSourceFieldCaption], [ShowCurrencyCodeInSummary], [IsFormulaField]) VALUES ('27F7F13E-3197-403C-8465-A907AE81D942', '3A080202-6842-4ECA-8C79-A945978810B4', N'JobTitle', 100, 0, NULL, NULL, 150, '91402610-EEF0-4DD0-ACA3-0080F53389FA', N'Job Title', 0, 0)
END        

GO
-- Alter Column LockAllPeriodExceptNext on [dbo].[AccountWorkingDayType]
Print 'Alter Column LockAllPeriodExceptNext on [dbo].[AccountWorkingDayType]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountWorkingDayType' AND TABLE_TYPE='BASE TABLE')) AND (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='LockAllPeriodExceptNext' AND TABLE_NAME='AccountWorkingDayType'))
ALTER TABLE [dbo].[AccountWorkingDayType]
	 ALTER COLUMN [LockAllPeriodExceptNext] [int] NULL

GO
-- Alter Column LockAllPeriodExceptPrevious on [dbo].[AccountWorkingDayType]
Print 'Alter Column LockAllPeriodExceptPrevious on [dbo].[AccountWorkingDayType]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountWorkingDayType' AND TABLE_TYPE='BASE TABLE')) AND (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='LockAllPeriodExceptPrevious' AND TABLE_NAME='AccountWorkingDayType'))
ALTER TABLE [dbo].[AccountWorkingDayType]
	 ALTER COLUMN [LockAllPeriodExceptPrevious] [int] NULL
GO


GO
-- Alter Column LockAllPeriodExceptNext on [dbo].[AccountWorkingDayType]
Print 'Alter Column LockAllPeriodExceptNext on [dbo].[AccountWorkingDayType]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountWorkingDayType' AND TABLE_TYPE='BASE TABLE')) AND (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='LockAllPeriodExceptNext' AND TABLE_NAME='AccountWorkingDayType'))
ALTER TABLE [dbo].[AccountWorkingDayType]
	 ALTER COLUMN [LockAllPeriodExceptNext] [int] NULL

GO
-- Alter Column LockAllPeriodExceptPrevious on [dbo].[AccountWorkingDayType]
Print 'Alter Column LockAllPeriodExceptPrevious on [dbo].[AccountWorkingDayType]'
GO
IF (EXISTS(SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'AccountWorkingDayType' AND TABLE_TYPE='BASE TABLE')) AND (EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME='LockAllPeriodExceptPrevious' AND TABLE_NAME='AccountWorkingDayType'))
ALTER TABLE [dbo].[AccountWorkingDayType]
	 ALTER COLUMN [LockAllPeriodExceptPrevious] [int] NULL

                                                                             	                                                                                     
--END 4.2.1